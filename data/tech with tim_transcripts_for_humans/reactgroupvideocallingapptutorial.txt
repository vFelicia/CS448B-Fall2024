With timestamps:

00:02 - [Music]
00:08 - hello everybody and welcome to a brand
00:10 - new youtube video so in this video i'm
00:13 - going to be showing you how to create a
00:14 - group video calling web application
00:18 - using react and using an awesome
00:19 - platform called agora so that's a g o r
00:22 - a dot io i'll be discussing that more in
00:25 - this video anyways i'm sorry if my faces
00:27 - are freaking you out here just wanted to
00:29 - give you a quick demo of what this
00:30 - application is going to look like you
00:32 - can see here that we can stop the camera
00:34 - we can start or stop the microphone i'm
00:36 - not going to do that because it's going
00:37 - to echo a bunch of times and yeah that's
00:40 - kind of how this works i'm going to keep
00:42 - it pretty simple with the ui i'm just
00:43 - going to show you how to set up this
00:44 - grid system how to get everything
00:46 - connected how to allow video streams to
00:48 - be sent between obviously different
00:50 - machines or different computers i'm also
00:52 - going to show you how you can host this
00:53 - on the web not permanently but
00:55 - temporarily so you can test it out you
00:57 - can see here i'm connected to an actual
00:59 - url if someone that was not on my local
01:01 - network type in this url they would be
01:03 - able to join this group video call so
01:06 - theoretically you can use this with
01:08 - anyone who has access to the link that
01:09 - i'm going to show you how to set up
01:11 - again all of this is free i hope you
01:13 - guys are excited now let me get all my
01:14 - faces off of the screen and we'll dive
01:16 - in alright so hopefully you guys enjoyed
01:18 - that demo there and are excited to get
01:20 - started this is a really cool
01:22 - application that we're going to be
01:23 - creating and the first thing i will
01:25 - mention is that although this does look
01:27 - really complicated right creating a
01:28 - group video calling application this
01:30 - actually is not that difficult to do
01:32 - there are quite a few steps in this
01:34 - tutorial but none of them are extremely
01:36 - challenging or difficult to follow along
01:38 - with however i will mention that it's
01:40 - probably a good idea that you have some
01:42 - familiarity with react with javascript
01:44 - and just with programming in general to
01:47 - follow along with this i'm not designing
01:49 - this for absolute beginners you should
01:51 - have a little bit of experience doing
01:52 - this and at the end of this tutorial you
01:55 - will have a really good kind of starting
01:56 - place for a group video calling
01:58 - application that you can then go extend
02:00 - work on implement in other projects
02:02 - whatever it is you may want to do now i
02:05 - do need to mention that this video is
02:06 - sponsored by agora agora is the platform
02:09 - we are going to use to implement this
02:11 - video calling and they make it super
02:13 - simple to do this so you're thinking of
02:15 - a group video calling application this
02:17 - seems like a really complicated thing
02:18 - but it's actually not that hard to do
02:21 - because of the work that a lot of
02:22 - talented developers at agora have done
02:25 - so you can see that agora is the
02:26 - real-time engagement platform for
02:28 - meaningful human connections and
02:30 - although we'll be using it to create a
02:31 - group video calling app you can do voice
02:33 - calls on it you can record your calls
02:35 - you can have real-time messaging you can
02:37 - do live streaming you can do analytics
02:39 - there's a ton of stuff that you can do
02:41 - here with agora and what i'm going to
02:42 - show you in this tutorial doesn't even
02:44 - scratch the surface of what is possible
02:46 - but hopefully it will give you an idea
02:48 - of kind of how to get started using this
02:50 - platform and this technology so just to
02:52 - give you a few more examples of things
02:53 - that you can create with agora that are
02:55 - actually concrete real applications i
02:57 - have the following list you could create
02:59 - online yoga classes with ai for form
03:02 - correction of participants you could
03:03 - create a speed dating video chat
03:05 - application you could create vr dj
03:08 - classes you could make an online poker
03:10 - with video chat that would be cool so
03:12 - you could actually see people's faces
03:13 - when you're playing there's all kinds of
03:15 - applications you can create with agora
03:17 - and as i was mentioning we're really
03:18 - just scratching the surface of what's
03:20 - possible in this video now i believe i
03:22 - mentioned this a few times now but this
03:24 - is free you do not need to pay for this
03:26 - the first 10 000 hours you use of video
03:29 - calling is completely free and as you
03:31 - can see here agora powers an average of
03:32 - over 50 billion minutes of human
03:35 - connections per month anyways that's all
03:37 - i really need to mention about this
03:38 - platform obviously we're going to be
03:39 - using it throughout this entire video to
03:41 - actually implement this and the first
03:43 - thing we're going to do here to get
03:44 - started is we're going to press start
03:46 - building today on the agora website i
03:48 - will link the website in the description
03:50 - but this is the link right here and then
03:52 - this will bring you to a page where
03:53 - you're asked to create an account now
03:55 - you can see i'm brought right here into
03:57 - this kind of console or dashboard just
03:59 - because i've already created my account
04:00 - but please go create your account first
04:02 - and then what we're going to need to do
04:04 - is create an agora project all right so
04:06 - once you have created your account what
04:07 - you're going to do is go over to project
04:10 - management and then you're going to
04:12 - press create so project management and
04:14 - kind of the left bar here you can see i
04:15 - already have a project that i was
04:17 - working on previously but what we'll do
04:19 - is press create we're going to give this
04:21 - a name so the name i will give for this
04:23 - project will just be react and then this
04:25 - will be
04:26 - video calling if i could spell calling
04:29 - correctly
04:30 - app and i'm going to press the secure
04:32 - mode app id plus token now you'll see
04:35 - why we're using this mode in a minute we
04:38 - could use just the app id mode
04:40 - essentially what you're selecting here
04:41 - is the way you want to authenticate your
04:43 - users with agora it's recommended that
04:45 - you use the secure mode that's what
04:47 - we'll use but we're going to be using
04:49 - what's known as a temporary token to do
04:51 - this so we won't have to deal with all
04:53 - this really complicated authentication
04:55 - uh that if you were actually going to
04:57 - deploy this to be a real live
04:59 - application you would definitely want to
05:00 - look at anyways let's just press submit
05:02 - here oh it says my project name already
05:04 - exists okay i think i might have created
05:06 - one previously anyways let me just
05:07 - change this now instead of saying react
05:09 - we can change this to say group so group
05:12 - video calling app
05:13 - all right so now i've created this
05:15 - project what we're going to do is set up
05:16 - our development environment so as i was
05:18 - saying we are going to be using react
05:20 - but specifically the code editor i'm
05:22 - going to use for this video is visual
05:23 - studio code so you can download that if
05:25 - you want you can use whatever editor
05:27 - doesn't matter i just prefer vs code
05:29 - we're also going to need node.js so this
05:31 - will allow us to use npm and you know
05:33 - work with our react development server
05:35 - and all that so download node.js all
05:37 - these links will be in the description
05:39 - and then finally we're going to use this
05:40 - thing called ngrok you can download it
05:42 - right now but when we get to that step
05:43 - i'll remind you and again this link will
05:45 - be in the description what ngrok will
05:46 - allow us to do is actually have a
05:48 - temporary public url that we can test
05:50 - our website on so you saw in that demo i
05:52 - was on my phone i was on my ipad well
05:54 - what we can do is actually set up this
05:56 - public url that anyone around the world
05:59 - can use to kind of test out our
06:01 - application now this url will actually
06:03 - expire after about two hours but this
06:05 - will allow people that are not on your
06:07 - current local area network to access
06:09 - your development server without you
06:11 - having to go through all the tedious
06:12 - steps of actually deploying this out to
06:14 - aws or whatever that may be anyways
06:17 - ngrok is really cool you'll see how that
06:18 - works much later in video
06:21 - okay so once we've done all that what
06:22 - we're going to do is we're going to open
06:24 - up visual studio code and we're going to
06:25 - create a new folder wherever you want
06:27 - that's going to store our application so
06:29 - let me open vs code here alright so vs
06:31 - code is now loaded i'm going to go to
06:33 - the explorer tab right here i'm going to
06:35 - press open folder but i also go to file
06:37 - and then open folder and then in my kind
06:40 - of windows explorer here what i'm going
06:42 - to do is go to my desktop go to my
06:44 - folder called agora you can see i have a
06:46 - folder here already that i was using for
06:47 - kind of the demo that i showed you so
06:49 - i'm gonna make a new folder i will call
06:51 - this tutorial and then inside of here is
06:54 - where i will actually put my react
06:56 - application
06:58 - okay so we're now inside of this
06:59 - tutorial folder what i'm gonna do now is
07:01 - open up my vs code terminal i did that
07:03 - by just scrolling up from the bottom of
07:05 - the screen and i'm going to use the npx
07:08 - create and then react
07:11 - app command to actually create a sample
07:13 - or kind of start a react application so
07:15 - we don't have to go through that tedious
07:16 - process of setting up the servers and
07:18 - the scripts and all that annoying stuff
07:20 - that we shouldn't have to do now you're
07:22 - only able to use this command if you've
07:23 - installed node.js so make sure node.js
07:25 - is on your system first and if for some
07:27 - reason it's not working you need to make
07:29 - sure that node.js is in your system path
07:32 - so that you can run the command npx and
07:34 - npm and hopefully the command yarn as
07:36 - well which you'll see in a minute
07:38 - anyways let's make this full screen and
07:39 - let's now type mpx create react app
07:42 - followed by the name of your react
07:44 - application so what i'm going to put my
07:46 - name as is actually let's just go
07:49 - group
07:50 - video
07:52 - calling app
07:53 - okay i'm going to press enter and then
07:55 - it should start generating a folder here
07:57 - inside of this tutorial folder it's
07:59 - going to have all of our react kind of
08:01 - starter code now we're not going to need
08:03 - all of the code that's in here so after
08:04 - this is done we're going to clean up a
08:06 - bunch of stuff delete a bunch of files
08:08 - then hopefully by the time that's
08:09 - finished our agora application will be
08:12 - synced and we'll be ready to set up our
08:13 - tokens and authentication and all of
08:15 - that stuff that we need alright so you
08:16 - can see we have now initialized our
08:18 - react application we have some folder
08:20 - group video calling app i'm just going
08:21 - to go through a few of the files here
08:23 - briefly discuss what they are and then
08:24 - delete a bunch of the ones that we don't
08:26 - need so first of all just make sure that
08:28 - if you want to start this dev server you
08:30 - are in the directory called group video
08:32 - calling app so i'm not going to explain
08:34 - really how to you know navigate
08:35 - directories and stuff in windows but you
08:37 - can use cd and then group video calling
08:41 - app you can see that now i'm in the
08:42 - correct path and well now i would be
08:44 - able to start my development server it
08:46 - shows you the instructions right here
08:47 - but just wanted to quickly mention that
08:49 - anyways inside this folder you see we
08:50 - have our node modules our public folder
08:52 - and our src folder the rest of the files
08:54 - you don't really need to concern
08:55 - yourself with
08:56 - the node modules folder is what's going
08:58 - to store all of our dependencies for the
09:00 - project the public folder stores some
09:02 - well public stuff i mean that's the
09:04 - extent of the explanation i will get
09:06 - into and what we're actually going to
09:07 - start by doing is deleting a few files
09:09 - that we don't need
09:10 - so we're going to delete these two logos
09:11 - here delete both that 192 and 512. we're
09:15 - then going to go in our manifest and see
09:17 - how in the manifest we're referencing
09:19 - these two files here so logo 192 and
09:21 - logo 512 the ones we just deleted we're
09:23 - going to delete the two references to
09:24 - this here so from line 10 to line 19.
09:28 - all right we're going to save that
09:28 - manifest we're now going to go into
09:30 - index.html
09:32 - we're going to remove the reference to
09:33 - this logo 192. so on line 12 we have
09:36 - this apple touch icon thing
09:38 - just delete that and by the way your
09:40 - stuff should look identical to mine
09:41 - because that's what the kind of starter
09:43 - code template does when you run create
09:45 - react app
09:47 - and what we can do here is we can change
09:48 - the title of our application if we want
09:50 - to i'll just change mine and say oops if
09:52 - my caplocks is toggled correctly group
09:56 - video and then this will be calling app
09:58 - like that
09:59 - i will now save this index.html file and
10:02 - there's no more changes we need to make
10:04 - here unless you want to change the
10:05 - description of your app
10:07 - okay so that's it for the public folder
10:09 - we can leave this fav icon thing i mean
10:11 - you can delete it if you want or change
10:12 - it but i won't worry about that for
10:13 - right now now we're going to go into src
10:15 - and we're just going to delete a bunch
10:16 - of files i won't really explain why
10:18 - we're deleting them but essentially we
10:19 - just don't need them there's a bunch of
10:21 - junk that comes with this that we can
10:22 - delete so we're going to delete app.css
10:25 - app.test.js
10:26 - logo to svg report web vitals and setup
10:30 - tests so i'm going to select all of
10:31 - those
10:32 - delete them
10:34 - and there you go very good all right now
10:36 - what we're going to do is just go inside
10:37 - of these three files here and do a few
10:39 - minor modifications so i'm going to go
10:41 - inside of index.css first and all i'm
10:43 - going to do is delete this margin colon
10:45 - zero
10:46 - this means that now we will have a
10:48 - margin around some of the tags
10:49 - specifically our body tag and so all of
10:51 - our content will no longer be kind of
10:53 - hugging the border it will be slightly
10:55 - offset it just looks a little bit nicer
10:56 - so i'm removing that margin and then you
10:58 - could remove this if you want as well
11:00 - but i'll just leave this here because it
11:01 - makes our font look a bit nicer uh in
11:04 - our you know what do you call it
11:05 - application or on our screen okay so
11:07 - let's delete that or not delete that
11:09 - close that
11:10 - now i'm going to go to index.js i'm
11:12 - going to remove the reference or the
11:14 - call to web vitals here i'm going to
11:16 - remove the import of web vitals and i
11:20 - think that's all i need to do in this
11:21 - file okay so i'm going to save index.js
11:24 - your index.js should look like this now
11:26 - i'm going to go to app.js and what i'm
11:28 - going to do is remove both of these
11:30 - imports because we've deleted these
11:31 - files that we're trying to import and
11:33 - now i'm going to delete everything
11:34 - inside of here except for this diff so
11:38 - this is what your app.js should look
11:40 - like i mean you could delete the entire
11:41 - thing and type this out if you want uh
11:43 - but yeah not a big deal and also i
11:44 - should mention that all of the code that
11:45 - i write here will be linked in the
11:46 - description uh via a github repository
11:49 - so for some reason i'm going too fast or
11:51 - you missed something or you just want to
11:52 - copy the code you can go to that github
11:54 - repository and have a look at it
11:56 - okay so there we are going to close
11:59 - these files now and that's all we kind
12:01 - of need to do to actually clean up our
12:02 - react app
12:04 - now what we can do is run this react
12:05 - application and make sure that it's
12:07 - working so what you're going to do is
12:08 - make sure you're in that correct
12:09 - directory so group video calling app and
12:12 - you're going to run the command yarn
12:13 - start
12:14 - now for some reason yarn start doesn't
12:16 - work for you just run the command npm
12:18 - start they do the same thing i'm not
12:20 - really going to explain you know the
12:21 - difference between npm and yarn
12:23 - yeah just run yarn start or npm start
12:25 - depending on which one works for you and
12:26 - then give it a second it's going to
12:27 - start running a development server and
12:29 - it should automatically open in google
12:32 - chrome or whatever your default browser
12:33 - is the actual localhost colon 3000 which
12:36 - is going to be the url of your video
12:39 - calling apps you can see here the title
12:41 - of this tab is group video calling app
12:43 - that means this is indeed working we can
12:45 - right click here press inspect we can
12:47 - view you know the console and all of the
12:49 - details see how there's no errors here
12:51 - that's good that means our react app is
12:53 - now working all right so that's all i
12:55 - need to show you in terms of the setup
12:56 - of the react application obviously we're
12:58 - going to be putting some content on the
12:59 - screen for now it's blank but i'll close
13:02 - that and now we're going to go back to
13:03 - our gorek dashboard here we're going to
13:06 - set up a temporary token that we can use
13:08 - for authentication looks like we are
13:10 - good to go you can see there's actually
13:12 - a web demo
13:13 - and so if you press on this web demo it
13:15 - will open up this thing it says you know
13:16 - reseca my last name invites you to join
13:18 - a video call you could press join
13:21 - channel and then you can see my webcam
13:23 - is popping up here
13:25 - anyways you can you know have a look at
13:26 - this demo if you want
13:28 - i'm not going to do that what i'm going
13:29 - to do though is go here and press temp
13:31 - token for audio video call
13:34 - so this thing that looks like a key
13:36 - press on that it's going to bring you to
13:38 - this thing it says app id app secret and
13:40 - channel name and what you're going to do
13:42 - is type in the name of the channel that
13:44 - you want to use for users to connect to
13:47 - and chat with each other
13:48 - so in agora you have these different
13:50 - channels now a channel you can think of
13:52 - as kind of a room where users can join
13:54 - in there and chat with each other so you
13:56 - can name this channel whatever you want
13:58 - i'll just name this channel main and you
14:00 - can make as many channels as you want
14:01 - that will have different tokens
14:03 - associated with them so i have my
14:04 - channel name main then what i'm going to
14:06 - do is generate my temporary token like
14:08 - that you can see it expires at 12 24 am
14:11 - i think it expires uh four hours after
14:14 - you create it because for me right now
14:15 - it's 8 24 pm and anyways you can copy
14:17 - this token but we'll use it in one
14:19 - minute okay so now we have our token
14:21 - generated what we're going to do is go
14:22 - back to our react app and we're going to
14:24 - create a few files we're going to go
14:26 - inside of src this is where all of our
14:27 - source code is going to be this is
14:29 - really where all of the files that we're
14:30 - going to be working with are from now on
14:31 - so you don't need to worry about the
14:32 - rest of the files or folders what we're
14:35 - going to do inside of here is we're
14:36 - going to create a file
14:38 - we're going to call this file settings
14:39 - dot pi or sorry not pi.js i'm used to my
14:43 - python coding and inside of here we're
14:45 - going to put a few pieces of information
14:46 - that we need to kind of initialize our
14:48 - agora application or initialize our
14:50 - agora api connection whatever you want
14:52 - to call
14:53 - okay so inside of here what we need to
14:55 - do is define two variables the first
14:57 - variable that we're going to have is our
14:58 - app id so we're going to say const app
15:01 - id and this is going to be equal to a
15:03 - string and then what we're going to do
15:04 - is go back to our agora app here or a
15:07 - gore dashboard whatever you want to call
15:09 - it and we're going to copy this app id
15:12 - so copy the app id
15:14 - come here paste it inside of this
15:16 - variable obviously make sure it's all on
15:18 - one line all right the next thing we
15:20 - want here is our token so we're going to
15:21 - say const token is equal to and then you
15:24 - guessed it
15:25 - we're going to go here to agora and
15:26 - we're going to copy this token all right
15:29 - so copy the token
15:30 - paste it in there
15:32 - that's all good and now we will continue
15:35 - all right so now that we have these two
15:36 - pieces of information that we need the
15:38 - app id and the token we're going to
15:40 - install a few dependencies that we need
15:42 - in our react application so what i've
15:44 - just done is i've stopped my development
15:46 - server i did that by pressing ctrl c and
15:48 - now we need to install three npm
15:50 - packages actually so the first thing
15:52 - we're going to install is material ui
15:54 - this is just the component library
15:56 - that's going to make it so our app looks
15:57 - a little bit nicer we can style things
15:59 - have a nice grid to lay out stuff in and
16:01 - anyways the way we do this is we say npm
16:03 - install and then app
16:04 - material hyphen ui
16:07 - core all right so we're going to install
16:09 - that this will take a second to install
16:11 - once we'll be back i will show you the
16:12 - next two things we need to install all
16:14 - right so material ui core has now been
16:16 - installed now what we're going to do is
16:18 - install material ui
16:20 - lab so run that command same thing once
16:22 - this is done only back for our last
16:24 - dependency all right so now we've
16:26 - installed all of the stuff we need
16:28 - related to material ui the next thing we
16:30 - need to install is the agora sdk so
16:33 - there's a lot of different ways that you
16:34 - can go about doing this i'm just going
16:36 - to quickly show you
16:37 - actually how you would do this for a
16:39 - different project if you weren't going
16:41 - to do this in react so if you go here to
16:43 - agora and you go to developers and we go
16:46 - to documentation so i'm here in the
16:48 - documentation i'm going to show you how
16:50 - we can download and use the agora sdk so
16:53 - we're going to go to the downloads tab
16:55 - right here it's going to bring us to
16:56 - this page and the first thing i want you
16:58 - to notice that agora is available for
17:00 - all kinds of different platforms so in
17:02 - this case we can see android ios mac web
17:05 - windows electron unity flutter so on and
17:08 - so forth a ton of different platforms
17:09 - that you can use agora on and if you
17:11 - look here we have the voice sdk the
17:13 - video sdk this is the older web sdk
17:16 - real-time messaging sdk all kinds of
17:19 - different sdks that we can use and the
17:21 - one we're actually going to be using is
17:22 - the web sdk so we want sorry not the
17:25 - voice sdk we want the video sdk for the
17:27 - web so we would click on this one right
17:29 - here and this would actually download
17:31 - the entire folder now for the web sdk we
17:34 - don't need to download the entire folder
17:36 - we could actually use a cdn which is
17:38 - just a link that we could include in our
17:39 - html file but in our case instead of
17:42 - that we're actually going to be using a
17:44 - react wrapper for agora so i'll show you
17:47 - that in one second but i do want to
17:48 - mention that for all of these different
17:50 - sdks and platforms there's all kinds of
17:52 - tutorials on the agora website and
17:54 - sample applications so check those out
17:57 - if you're trying to do this on a
17:58 - different platform but as i mentioned
18:00 - we're going to use the react wrapper so
18:01 - let's go to that now
18:03 - so this is a wrapper that's created by
18:05 - the agora i o community
18:07 - so this is an open source wrapper and
18:09 - what this actually does is just make our
18:11 - life easier so it has all of the agora
18:14 - sdk in it and it comes with a few hooks
18:16 - for react that we can use if you don't
18:18 - know what that is don't worry about it
18:19 - we'll look at those later and just kind
18:21 - of simplifies the sdk for us and wraps a
18:24 - bunch of these functions so you can see
18:25 - right here it's showing us the usage way
18:28 - simpler than if we were to actually try
18:29 - to you know bring in the sdk ourself and
18:31 - then work with all those functions that
18:33 - still is not super complicated but just
18:35 - trust me here this is good to use so
18:37 - what we're going to do is install this
18:39 - wrapper and again this wrapper will have
18:41 - all of this stuff with the agor sdk all
18:44 - it's kind of doing is just wrapping some
18:46 - of these functions and just making them
18:47 - a little bit simpler for us to use
18:49 - specifically in react again if you were
18:52 - not going to use this in react if you
18:53 - were going to use this somewhere else
18:55 - there's all kinds of tutorials on the
18:56 - agora website it is pretty intuitive and
18:59 - simple to do
19:00 - but i found as i was experimenting with
19:02 - this that this wrapper is just going to
19:03 - make our life a bit easier and so we're
19:05 - going to go ahead and use this wrap all
19:06 - right so i'll leave this link in the
19:08 - description but what we're going to need
19:09 - to do to install this wrapper is we're
19:11 - going to go here to our console and
19:13 - we're going to say npm
19:14 - install and actually i'm just going to
19:16 - paste in this command because i have it
19:17 - copied to my clipboard npm install and
19:20 - then git colon
19:22 - and then the link to that repository
19:23 - that i just showed you but this is going
19:25 - to be a little bit different so i'll
19:26 - leave this line in the description of
19:28 - course you can also just type it out
19:30 - here it'll be on the screen for long
19:31 - enough you could pause the video but
19:33 - again this will be in the description
19:34 - type this in
19:36 - press enter and then it's going to
19:37 - install a bunch of stuff now this will
19:38 - probably take a few minutes to run just
19:40 - because there's a ton of modules this is
19:42 - installing the entire agora sdk and then
19:45 - a few other things as well so once this
19:47 - is done i will be right back all right
19:49 - so now everything is installed our dev
19:51 - environment is set up we have our tokens
19:53 - we've set up our agora project we
19:55 - understand briefly what agora does now
19:57 - we can start actually writing some of
19:59 - our react code and setting up this
20:00 - application now this part's not too
20:02 - complicated but we will have to create a
20:04 - few different components have some
20:05 - buttons like turning off the camera
20:07 - turning on the microphone all of that
20:08 - kind of stuff and well anyways we're
20:10 - going to get started here in settings.js
20:12 - so what we're going to do right now is
20:14 - we're going to initialize our kind of
20:15 - agora application so we're going to set
20:17 - up a configuration and we're just going
20:19 - to create what's known as a hook so that
20:20 - anywhere in our react application we're
20:22 - able to access this client object that
20:25 - we need i understand this might seem a
20:27 - little bit confusing if any of you are
20:28 - relatively beginner in react or in just
20:31 - programming in general but just follow
20:32 - along it will start to all come together
20:34 - so we're going to say import and then
20:36 - what we're going to import is create
20:38 - client and
20:40 - create and then this is going to be
20:41 - microphone
20:44 - and
20:46 - camera tracks like that and this is
20:49 - going to be from and this is agora
20:52 - hyphen rtc
20:54 - and i have to spell agora correctly
20:56 - obviously agora hyphen rtc hyphen react
20:59 - now let me make sure i spelt this
21:00 - correctly microphone and camera tracks
21:03 - looks like that is correct okay so we've
21:05 - now imported these two things that we
21:06 - need from agora rtx react okay what
21:09 - we're going to do next here is we are
21:11 - going to export three variables we're
21:13 - going to say export
21:14 - const and then we're going to create a
21:16 - config variable
21:18 - now this is going to store the
21:18 - configuration for our agora application
21:21 - so we're going to say mode
21:24 - is equal to rtc i believe this stands
21:27 - for real-time communication you can also
21:29 - set the mode to like a live stream mode
21:31 - you'd have to look at the agora
21:32 - documentation to see all the different
21:34 - stuff for this config i'll just tell you
21:36 - what the ones are that we're using here
21:38 - the next thing we need is the codec so
21:39 - this is what we're using to actually
21:41 - encode our video we're going to use vp8
21:44 - now small note here for some reason
21:46 - you're using a really old version of
21:48 - safari or internet explorer or something
21:50 - you probably want to use h.264 i believe
21:53 - the codec here is
21:54 - h264 if that doesn't work i think you
21:56 - can type in just h.264 anyways vp8 is
22:00 - what we're going to use if you don't
22:01 - know what that is don't worry it's just
22:03 - kind of the algorithm that's used to
22:04 - actually encode the video that's going
22:06 - to be displayed we then need to pass our
22:08 - app id so we're going to pass the app id
22:11 - equal to the app id the variable we have
22:13 - up here and then we need the token so
22:15 - we're going to say token colon token
22:17 - okay so we now have our config
22:19 - next what we're going to do is say
22:20 - export
22:21 - const and then this is going to be use
22:24 - client and this is going to be equal to
22:26 - that create client function there that
22:28 - we imported and we're going to pass
22:30 - inside of here config so we're going to
22:33 - create an agora client using the
22:35 - configuration that we just defined up
22:37 - here next what we're going to do is say
22:39 - export
22:40 - const and it's going to be use
22:43 - micro phone
22:45 - and
22:46 - camera
22:48 - tracks like that and then this is equal
22:50 - to create
22:52 - microphone and camera tracks
22:54 - and we're just going to call that
22:55 - function
22:56 - so what these two things actually are
22:58 - right here are hooks now if you're
23:00 - unfamiliar with hooks essentially these
23:02 - are functions that we can call to get
23:05 - access to something now that's a really
23:07 - poor explanation of what a hook actually
23:08 - is but for our context right here what
23:11 - we're defining is this used client and
23:13 - this used microphone and camera tracks
23:15 - hook and so we're going to be able to
23:16 - actually use these hooks from any
23:18 - component that we want to get access to
23:21 - the client and get access to the
23:23 - microphone and camera tracks now this is
23:26 - important because we need access to both
23:28 - of these things from a bunch of
23:29 - different files so rather than passing
23:31 - them through the props of all of our
23:33 - react components or you know kind of
23:35 - messily handling them around and
23:37 - throwing them around our program we put
23:38 - them in one file the settings.js file
23:41 - and then we can access them whenever we
23:42 - want you'll see how we use them
23:43 - obviously as we start using different
23:45 - components but understand that's the
23:47 - point of the settings.pi file so now we
23:49 - can access the config the use client and
23:51 - use microphone and camera tracks from
23:53 - any component without having to kind of
23:54 - pass them around through props and all
23:56 - that messy stuff we'd normally have to
23:57 - do okay we're done with settings.js now
24:00 - we don't need to look at that anymore
24:01 - unless something doesn't work what we're
24:03 - going to do now is go into app.js all
24:06 - right so i'm actually going to stop here
24:07 - for a second and just backtrack a bit i
24:09 - realized that the order i was about to
24:10 - go in for creating stuff doesn't really
24:12 - make much sense so let's do it in the
24:13 - proper order actually what i'm going to
24:15 - do here is go to settings.js to start
24:18 - i'm going to export one more thing so i
24:19 - lied we are going to need to touch this
24:20 - file again i'm going to export const
24:23 - i'm going to export the channel name so
24:25 - i'm going to say channel name is equal
24:27 - to and then this is going to be the name
24:28 - of the channel that we set up which in
24:30 - this case is main
24:31 - so the reason why i'm doing this is
24:33 - because i realize that i forgot to
24:35 - mention this token here is associated
24:38 - with this channel main so if we go back
24:41 - here
24:42 - we go to
24:43 - gora we go to token you can see that we
24:46 - have our channel name main we have our
24:48 - app id and we have our temporary token
24:51 - so as i was saying this token only
24:54 - allows you to join the main channel so
24:57 - it doesn't make sense for us to maybe
24:59 - say ask the user to type in a channel
25:00 - because if we're hard coding our token
25:02 - then we need to hard code the channel
25:04 - the users are going to join in so what's
25:06 - going to happen when we load our app is
25:07 - users are automatically going to be put
25:09 - in the main channel there won't be a
25:10 - choice they'll just go right into one
25:11 - channel but if you wanted to allow users
25:14 - to join different channels what you
25:15 - would need to do is make different
25:17 - channels here in this console there's
25:19 - also a way to do it from code but i'm
25:20 - not going to explain that it's a little
25:22 - bit beyond the scope of this tutorial
25:24 - and then you would ask the user to type
25:26 - in the token and the channel that they
25:28 - want to join once you've created
25:29 - different channels here right
25:31 - so you could say okay type in the
25:32 - channel name type in the token and
25:34 - assuming that token is associated with
25:36 - the channel they would be able to join
25:38 - hopefully that makes sense but just
25:39 - understand that again this token only
25:41 - works for this channel and so we'll have
25:43 - one channel anyone who kind of goes to
25:45 - our application will just automatically
25:47 - be brought into that channel so now that
25:48 - we understand that let me close this i
25:50 - don't know like get ignore is open
25:51 - what we can do is we can just set
25:53 - a few things here in app.js
25:56 - so i'm going to go to app and i'm going
25:57 - to import
25:59 - use state
26:01 - from react
26:03 - all right so we've got you state now and
26:05 - if you're looking at you state and
26:06 - you're like i don't know what this is
26:08 - i'm going to highly recommend that you
26:09 - go and brush up on your react maybe
26:11 - watch a react tutorial because this is
26:14 - probably going to be very difficult to
26:15 - follow along with if you're not familiar
26:17 - with something as basic and react as
26:19 - something like use state so not to
26:21 - discourage you i just want to make sure
26:22 - i don't waste anybody's time if you are
26:24 - a beginner please go brush up on react
26:26 - make sure you're familiar with some of
26:28 - these things because i can't really
26:29 - explain them in this tutorial okay so
26:31 - we've got use state and what i want to
26:32 - do here just set one piece of state that
26:35 - tells me whether or not my user is in a
26:37 - call already now we're going to try to
26:39 - just automatically join the user into a
26:41 - call as soon as they come to our web
26:43 - page but we might not be in there
26:44 - immediately and so we need a piece of
26:46 - state that's telling us are we in the
26:47 - call or are we kind of waiting to join
26:49 - so we're going to say
26:50 - const in call and then set
26:54 - in call and this will be equal to use
26:57 - state and we'll set this equal to false
26:59 - by default
27:00 - now we're going to go inside of here
27:02 - inside of our return so this is the
27:04 - stuff that's actually going to show up
27:05 - on the screen and we're going to check
27:06 - if we're in the call so in call question
27:08 - mark if we are in the call what we'll do
27:10 - is just render some text that says we
27:13 - are in
27:14 - the call otherwise we'll say
27:17 - waiting
27:18 - to if we spell waiting correctly waiting
27:21 - to join
27:22 - call
27:23 - okay now we're going to replace this
27:24 - text here with the thing that's actually
27:26 - going to display the call we haven't
27:28 - created that component yet so let's
27:29 - actually go ahead and do that now i'm
27:31 - going to make a new component and i'm
27:32 - going to call this video call
27:35 - now this is where a lot of the logic for
27:37 - our program will lie you know what while
27:39 - we're at it let's create all of the
27:40 - components that we're going to need so
27:41 - we need video call this will display all
27:43 - of the actual videos all the video feeds
27:46 - we then need our controls
27:48 - so this is like okay we need to mute the
27:50 - microphone we need to stop the camera we
27:52 - need to leave the call that's what
27:53 - controls are
27:55 - and then finally we need a component to
27:57 - actually display all of our video so
27:58 - video.js so video call will render our
28:02 - controls
28:03 - and all of our videos so video
28:06 - represents all the video feeds control
28:08 - is obviously the control and then video
28:09 - call will kind of render both of them
28:10 - and before it renders them it will make
28:12 - sure that we have you know joined the
28:14 - call and all of that kind of stuff okay
28:15 - so let's go inside a video call and
28:17 - let's say export
28:19 - default and then let's make a function
28:21 - and let's call this video call so just
28:23 - making a component this will take in
28:25 - some props and inside of here we're
28:27 - going to start by just decomposing this
28:29 - props so we're going to say const and
28:31 - the one prop that we're actually going
28:32 - to get here is going to be set in call
28:35 - and this will be equal to props so if
28:37 - you're unfamiliar with this syntax what
28:38 - this does is look at props which is an
28:40 - object grabs out the prop called set in
28:43 - call that allows us to use that in here
28:45 - and the idea is that we're going to kind
28:46 - of join the call from this component so
28:49 - once we've joined we will then use this
28:51 - function here to tell our app component
28:53 - that hey we are in the call and so then
28:55 - it can actually render this component
28:57 - fully
28:58 - perfect okay now what we want to do is
29:00 - set a few pieces of state so to set some
29:02 - state we need to import use state
29:04 - so we're going to say import
29:06 - use state
29:08 - and then this will be from
29:09 - react
29:11 - okay so the pieces of state that we want
29:12 - first of all is the users so we want to
29:14 - know what users are currently in our
29:16 - call right so we're going to say const
29:18 - users
29:19 - set users is equal to and then this will
29:21 - just be use state
29:23 - and this will be a list or an array all
29:26 - right
29:27 - next we're going to have our start state
29:29 - so start
29:31 - set start this is kind of similar to in
29:33 - call this is telling us if we can start
29:36 - our video
29:37 - so
29:38 - we'll see how that works again in a
29:39 - minute but actually we're going to set
29:40 - this equal to false to start just
29:42 - another variable that's kind of telling
29:43 - us hey are we ready to go have we
29:45 - initialized everything we'll use this a
29:47 - little bit differently than set and call
29:49 - i can't really show you how it works
29:50 - until we actually get into the logic of
29:52 - joining the call okay then what we're
29:54 - going to do
29:55 - is we're going to import a bunch of
29:56 - stuff
29:57 - from our settings so we're going to say
30:00 - import
30:01 - config we're going to import our
30:04 - use client we're going to import our use
30:06 - microphone come on give me the
30:08 - autocomplete here so i don't have to
30:09 - type at all uh okay let me just go from
30:13 - settings.js and then maybe it will give
30:14 - me my autocompletion because i don't
30:16 - really want to type
30:18 - use microphone
30:20 - and
30:21 - camera
30:23 - tracks okay too bad i did have to type
30:24 - it did i spell this correctly use
30:26 - microphone and camera tracks i think so
30:28 - and then the last thing that we will do
30:30 - actually we don't need to import
30:31 - anything else from this that's all we
30:32 - need
30:33 - okay sweet so we've got all that next
30:35 - we're going to say import and we're
30:37 - going to import
30:39 - grid
30:40 - from this can be app material hyphen ui
30:45 - core now this is what we use to actually
30:47 - kind of lay out a few things that we
30:48 - need here okay so now we have our state
30:52 - for start and for users the next thing
30:54 - we need to do is grab our clients we're
30:56 - going to say const client is equal to
30:58 - and this will be use client now notice
31:00 - we're actually calling this we're
31:02 - calling it as if it's a function what
31:03 - this is going to do is return to us the
31:05 - client object which we can use to
31:07 - connect to the video call
31:09 - next we're going to say const
31:11 - ready
31:13 - and then tracks
31:14 - is equal to
31:16 - and this will be use microphone and
31:18 - camera tracks we're going to call that
31:19 - again just like we called use client and
31:22 - what this will give us is our audio and
31:23 - video track and whether or not they're
31:25 - ready to go ready to be used so when we
31:27 - call this what it will try to do is
31:29 - initialize our audio and video track so
31:31 - we have two tracks here this is actually
31:32 - going to be a list of tracks again one
31:35 - for audio one for video and then we can
31:37 - use these tracks like we can disable the
31:39 - audio we can disable the video or we can
31:41 - show the audio or display the video or
31:42 - whatever right and then this is telling
31:44 - us hey are we ready and the reason we
31:46 - need that is because we have to get
31:47 - permission from the user to use their
31:49 - video and use their audio this handles
31:51 - all of that for us we don't have to you
31:52 - know pop up a dialogue or anything it
31:54 - will automatically ask the user to allow
31:56 - the camera all right so next what we're
31:58 - going to do is we're going to import use
31:59 - effect
32:00 - so essentially as soon as we render this
32:02 - component
32:04 - what we want to do is we want to have an
32:06 - effect here and this effect is going to
32:08 - do all of our kind of initialization so
32:09 - we're going to say use effect
32:11 - this is just going to be a function and
32:13 - then we are going to
32:14 - do this effect whenever
32:17 - the channel name changes which i'm
32:19 - actually going to import from up here
32:20 - that's the thing i was thinking about
32:22 - importing but didn't
32:24 - whenever the client changes whenever the
32:27 - ready variable changes or whenever the
32:30 - tracks change
32:31 - okay so if you're unfamiliar with this
32:34 - when you put a list here this says okay
32:36 - only do this effect so only run this
32:38 - function when one of these things
32:40 - changes so when one of these four values
32:42 - changes then we will actually call
32:43 - whatever's inside of this function for
32:45 - use effect
32:47 - now what i'm going to do here is i'm
32:48 - going to define a variable i'm going to
32:49 - say let knit equal async we're going to
32:52 - take in a name this is going to be the
32:54 - channel name and then this is going to
32:56 - point to a function
32:58 - so we have an asynchronous function
33:00 - again i can't really explain async but
33:02 - this means not based on the clock tick
33:03 - of your computer this has some delay
33:06 - essentially we're waiting on a network
33:07 - operation and inside of here what we
33:10 - need to do is we actually need to define
33:12 - some event listeners so we have our
33:14 - client object we have clients right and
33:17 - what we do with client is we can have
33:19 - some different events that are going to
33:20 - be triggered and that we're going to
33:21 - listen for so there's a bunch of
33:23 - different events here i'm going to go to
33:24 - the agora documentation to show you what
33:26 - some of these events are so let's go to
33:29 - developers let's go to documentation and
33:32 - i'll start walking you through some of
33:33 - the events that we want so let's press
33:35 - on video call here
33:36 - and
33:37 - let's just see what can we look at maybe
33:40 - quick start okay let's go to quick start
33:42 - see what it brings us to we're going to
33:43 - change the platform here to be web
33:47 - all right okay so let's scroll down and
33:49 - let's look for if there isn't a list of
33:51 - events okay so this is actually what i
33:52 - wanted to show you i believe this is i
33:54 - think they call this a sequence diagram
33:56 - i forget what this is actually called
33:57 - maybe an activity diagram or something
33:59 - regardless you can kind of see the flow
34:01 - of what needs to happen here but we need
34:03 - to create the client which we've already
34:04 - done and then we need to initialize the
34:06 - client now when you initialize the
34:08 - client what you need to do is join a
34:09 - channel that sends a channel request to
34:11 - this is kind of like the back end for
34:13 - agora essentially and then after that
34:15 - what's going to happen is we need to
34:16 - create a local stream
34:18 - initialize the stream play the stream
34:20 - and publish it so what we're going to be
34:22 - doing as a client is we're creating a
34:24 - stream of our webcam and of our audio
34:26 - and then what people can do is they can
34:28 - publish or sorry they can subscribe to
34:30 - that stream which means that they can
34:33 - access it they can view it so once we
34:34 - create the stream we publish a stream
34:36 - that's what i mean and then that's going
34:37 - to send the stream data here to the sd
34:40 - rtn then what happens is you can
34:42 - subscribe to a remote stream so people
34:44 - can subscribe to our stream it will then
34:46 - kind of add it to say their react
34:49 - application their video calling app
34:50 - whatever and then they'll start seeing
34:52 - our video stream and so whenever someone
34:54 - joins the room we want them to
34:56 - automatically subscribe to all of the
34:58 - other user streams and we want those
35:00 - users to subscribe to their stream right
35:02 - but we need to handle different events
35:04 - like what happens when someone
35:05 - unsubscribes subscribes from a stream
35:07 - what happens when someone leaves the
35:08 - channel
35:09 - so on and so forth and so that's all the
35:11 - events that we're going to be kind of
35:13 - hooking up right now there's a lot more
35:15 - events that can happen i mean you can
35:17 - read through this the documentation is
35:18 - really good for this but i will just
35:20 - show you the events that we need to kind
35:22 - of set up here so the first event that
35:24 - we're going to have so we're going to
35:24 - have client.on is going to be a user
35:28 - published a stream so if a user has
35:30 - published a stream then what we want to
35:32 - do is we want to call the following
35:34 - asynchronous function now this
35:36 - asynchronous function is going to take
35:37 - in a user it's going to take in a media
35:39 - type now the media type is going to be
35:42 - audio or video so did the user publish
35:44 - an audio stream or a video stream and
35:47 - the reason why this is kind of important
35:48 - here is because users can enable and
35:50 - disable their video streams right so if
35:52 - a user disables their video stream
35:54 - they're going to be kind of unpublishing
35:56 - it whereas if they re-enable it they'll
35:57 - be publishing it and so we need all of
35:59 - these events to look for all of that
36:01 - kind of stuff that's going to happen
36:03 - i get that this is really probably
36:05 - confusing for a lot of you but just bear
36:06 - with me we'll get through it and you'll
36:08 - see how it works okay so we're going to
36:09 - say client.on user published we have an
36:12 - asynchronous function and what we are
36:13 - going to do is we are going to await the
36:15 - phone we're going to say client
36:18 - dot subscribe and we're going to
36:19 - subscribe user
36:21 - and media type
36:23 - so we're going to subscribe the current
36:25 - client
36:26 - to the stream that a user just published
36:29 - so a user publishes stream this does not
36:31 - mean we are automatically subscribed to
36:33 - it but now we are aware of the fact they
36:35 - published it we have the user and we
36:37 - have the media type now we can subscribe
36:39 - to it so that's what we're doing here
36:40 - we're awaiting the fact that we
36:42 - subscribe to the stream then we need to
36:44 - check what type this stream was so we're
36:46 - going to say okay if the media type
36:49 - is equal to video we should do three
36:51 - equal signs here
36:53 - then what we're going to do is we're
36:54 - going to change some state here
36:56 - so we're going to say
36:57 - set the users that are in this video
36:59 - call
37:00 - and we're going to get the previous
37:02 - users so we're going to say prev users
37:04 - like that
37:05 - we're going to have a little function
37:06 - that we run and inside of here we're
37:08 - going to return
37:10 - dot dot so the spread operator prev
37:12 - users and then user
37:15 - so what this is doing is this is getting
37:17 - the previous users so whatever was
37:19 - currently in the user's state that's
37:21 - kind of how this works and react when
37:22 - you use an arrow function inside of a
37:25 - state or inside of setting a state story
37:27 - so this gets whatever the previous state
37:29 - was then what we do is we return a new
37:32 - list that has all of the users that were
37:34 - currently there plus the new user that's
37:36 - kind of what this is doing that's what
37:38 - we're returning
37:39 - okay so that's good
37:40 - then what we're going to do after this
37:42 - is we're going to say if
37:44 - the media type
37:46 - is equal to audio
37:48 - like that we can make this an l if two
37:51 - if we want but it's fine we'll just
37:52 - leave it as an if so if media type is
37:54 - equal to audio then what we're going to
37:56 - do is say user dot and then audio track
37:59 - so let's go audio track like that dot
38:02 - play
38:03 - so we don't need to subscribe to the
38:05 - audio track because it's just kind of
38:07 - given us the audio track we have the
38:08 - user the audio track is associated with
38:10 - the user and so we're going to start
38:12 - playing it in the web browser which
38:13 - means now we'll be able to hear whatever
38:15 - the user is saying so again all the
38:17 - stuff you find from the documentation
38:19 - like i said at the beginning this video
38:20 - is just meant to get you up and running
38:22 - as fast as possible and hopefully give
38:23 - you you know some piece of information
38:25 - that are useful
38:26 - okay so we've done that we've now done
38:28 - our first event now there's a few more
38:30 - events that we need to do so the next
38:32 - event we're going to do here is say
38:33 - client.on
38:35 - and we just checked if the user
38:36 - published an event so what happens if
38:38 - the user unpublished or non-event uh
38:40 - streams right so user and then this is
38:43 - unpublished like that now similarly
38:46 - we're going to have actually not an asic
38:48 - async function this time because we're
38:49 - not waiting on a network operation we're
38:51 - just going to say user
38:53 - type
38:54 - is equal to
38:55 - and then inside of here we'll do kind of
38:57 - the same thing except this time we're
38:59 - going to unsubscribe the user right or
39:00 - we're going to yeah unsubscribe the user
39:02 - so rather than doing type just to keep
39:03 - it consistent i'm going to say media
39:05 - type
39:06 - and i will say if
39:09 - type or media
39:12 - type like that is equal to audio we need
39:16 - three equal signs so if the media type
39:18 - is equal to audio then we want to stop
39:20 - playing the audio so we're first going
39:21 - to just make sure that the audio is
39:23 - playing we're going to say if the user
39:25 - dot audio track then what we will do
39:28 - here is say user
39:29 - dot audio track and then dot stop
39:32 - now the reason we need this little if
39:34 - statement before is because a user could
39:36 - technically leave the web browser or
39:38 - they could have disabled their mic
39:40 - something could happen where we didn't
39:41 - hit this event and the audio track has
39:43 - stopped playing already and so we can't
39:45 - stop the audio track if it doesn't
39:47 - already exist so we just need to make
39:49 - sure it exists before we try to do this
39:51 - just to prevent any potential errors
39:52 - from coming this is kind of good
39:54 - practice to do just always check if
39:56 - something exists before you go ahead and
39:58 - try to stop it or start it or whatever
39:59 - whereas here we don't need to do that
40:01 - because we know if the type is audio
40:03 - we're going to have an audio track and
40:05 - so we can play
40:06 - okay
40:07 - otherwise we're going to check if the
40:08 - type is video so if the media type
40:12 - is equal to video
40:14 - i always do two equal signs that needs
40:16 - to be three
40:17 - then we want to unsubscribe and we also
40:19 - want to remove the user so we're gonna
40:21 - say set
40:22 - users like that
40:24 - we're going to say prev
40:27 - users and then here
40:29 - we're going to return it's going to seem
40:32 - a little bit unnecessary but this is the
40:34 - way we'll do it
40:35 - prevusers.filter
40:37 - we're going to have a function here
40:39 - we're going to take an uppercase user
40:42 - and we're going to say if the user.uid
40:45 - this is their unique identifier i
40:46 - believe that's what uid stands for does
40:49 - not equal user.uid
40:52 - then we will go ahead and keep that in
40:54 - our array okay so i lied here we
40:56 - actually don't need to unsubscribe i
40:58 - believe when a user unpublishes their
41:01 - video stream you are automatically going
41:03 - to be unsubscribed from it because well
41:04 - there's nothing more to look at and so
41:06 - you don't need to manually say
41:07 - unsubscribe you can just remove this
41:10 - user from the user state so keep in mind
41:13 - here there's kind of two pieces of state
41:15 - right we have the state in our front end
41:16 - which is allowing us to display all
41:18 - these different video feeds then there's
41:20 - going to be a state kind of in the back
41:22 - end api or sdk
41:24 - that represents what users are in the
41:26 - room and you know what users have video
41:28 - feeds what streams are published all of
41:30 - that we don't need to deal with that
41:31 - because obviously that's handled by the
41:33 - sdk but here we do need to be able to
41:35 - keep track of what users are in our room
41:37 - or not so we know what streams we should
41:38 - be displaying hopefully that kind of
41:40 - makes sense but at minimum we want to
41:41 - know how many users are in a room and so
41:43 - we want to have this user's array that's
41:45 - storing all those users and so we can
41:47 - get access to their different streams
41:48 - and so what happens is when a user
41:50 - unpublishes their stream well they may
41:52 - have been automatically unsubscribed we
41:54 - may have auto unsubscribed but we need
41:56 - to change the state on the react front
41:58 - end to kind of remove that user and so
42:00 - what this does here is it takes whatever
42:01 - our previous users were from this user
42:03 - state and then it filters this array so
42:06 - what this will do is now create a new
42:08 - array that has all the users in it
42:10 - except for this user right here the one
42:13 - that unpublished their stream okay so
42:16 - that's it for that now we have a few
42:19 - more events that we need to handle so
42:20 - client dot on and this is going to be
42:23 - user left so user hyphen left like that
42:27 - this doesn't need to be async because
42:28 - we're not waiting on a network operation
42:30 - we're going to take in the user and then
42:32 - same thing we're just going to run this
42:33 - set users kind of set state function
42:36 - whatever you want to call so if a user
42:38 - left or if a user unpublished their
42:40 - stream these are kind of the same thing
42:42 - like if a user leaves they do unpublish
42:43 - their stream but it's just a different
42:44 - event that occurs so we need to look for
42:46 - both of them to make sure that we are
42:48 - you know removing the users from our
42:49 - front-end state
42:51 - okay so now we have all of our event
42:53 - handlers kind of configured here so
42:55 - those are configured the next thing that
42:57 - we need to do here
42:58 - is we need to try the follow so we've
43:01 - set our event handlers we're going to
43:02 - say try
43:04 - catch
43:05 - will catch an error and we'll just
43:08 - console.log error
43:11 - just so we can see if an error occurs
43:13 - and inside of here what we're going to
43:14 - try is the following we're going to say
43:15 - try await client dot join
43:20 - what do we want to join well we're going
43:22 - to join config.app id
43:25 - we are going to pass in the name of our
43:26 - channel so name which we'll pass to this
43:29 - asynchronous function right here
43:32 - and then we're going to say config.token
43:36 - and we're going to pass no
43:38 - now uh let me just explain what all
43:40 - these parameters are here i mean all of
43:42 - them are pretty straightforward but
43:43 - we're passing the app id we're passing
43:44 - the name of the channel we want to join
43:46 - we're passing the token to join that
43:47 - channel and then this is the uid of the
43:51 - user that's joining the channel so
43:53 - uid unique identifier you can see we
43:55 - have a unique identifier for all of our
43:57 - users if you leave this null it's going
43:59 - to automatically generate that for you
44:01 - which is what we want but you could
44:03 - manually define the id of the user
44:05 - joining
44:06 - maybe there's some reasons why you'd
44:07 - want to do that but for now we just
44:08 - leave this no but this parameter here is
44:11 - really the uid now it's required so we
44:13 - have to pass something so we pass null
44:15 - but when you pass no it will
44:16 - automatically generate the uid of the
44:17 - user don't have to worry about it too
44:19 - much again it's just kind of the id of
44:20 - the user we could set it if we want but
44:22 - we're not going to do that
44:24 - okay so we've tried that we've logged
44:26 - the error the reason we're trying it is
44:27 - because something could go wrong here we
44:28 - don't want to crash our program
44:30 - and so now what we're going to do
44:32 - is we're going to say if
44:34 - tracks we're going to await
44:37 - client
44:39 - dot publish
44:40 - and what we're going to publish is the
44:42 - following
44:43 - tracks
44:45 - 0
44:47 - and tracks
44:48 - 1.
44:49 - now we could if we wanted to clean this
44:51 - up just use the spread operator i'll
44:52 - just leave it like this so it's very
44:53 - explicit on exactly what we are doing
44:56 - what we're checking here is okay
44:58 - do we have any tracks
45:00 - if we have any tracks this means that
45:03 - our audio and video has been initialized
45:06 - and so what we can do
45:07 - is we can uh what is it let's see here
45:10 - where am i we can publish it so this is
45:13 - publishing a stream so what we've done
45:15 - is we set up all our event listeners
45:17 - and now
45:18 - once all those are done and we've joined
45:20 - the channel we are going to publish our
45:22 - stream to the channel so anyone else in
45:24 - the channel now
45:25 - that has these event listeners and every
45:27 - client will have them because well
45:28 - that's what we're coding out here
45:29 - they're going to automatically subscribe
45:31 - to our stream that has been published
45:33 - and then they will see our stream so
45:34 - hopefully that kind of makes sense but
45:36 - at the end of setting up all this stuff
45:37 - doing all the configurations here and
45:39 - all our event listeners then we're going
45:41 - to publish the stream
45:43 - then after we publish the stream what
45:45 - we're going to do is we're going to say
45:47 - set
45:48 - ready or not set ready sorry set start
45:51 - equal to true so we're saying okay we've
45:53 - done everything we need to do here we've
45:54 - set up the event listeners we've
45:56 - published the stream and so now we
45:57 - indicate that hey we are ready to start
45:59 - so we say set start now let me just go
46:02 - here and make sure okay i just wanted to
46:05 - look at something quickly to make sure i
46:06 - wasn't going off course here it looks
46:08 - like we're good now inside of use effect
46:11 - but outside of this init right here
46:14 - because this init is a function right
46:16 - what we're going to do is we're going to
46:17 - call this init function so we're going
46:19 - to say if
46:21 - ready
46:22 - and
46:23 - tracks
46:24 - then what we'll do is we will try
46:27 - the follow so we're going to try
46:30 - to init
46:31 - with the channel name
46:34 - otherwise we're going to catch
46:37 - an error we're just going to
46:38 - console.logging
46:40 - so constant log error and sorry we need
46:42 - to constantly log the error message uh
46:45 - actually we can just log the error it's
46:46 - an object but we can look at the object
46:50 - in our console
46:51 - okay
46:52 - so what we've just done right is we've
46:54 - set up this kind of a knit asynchronous
46:56 - function
46:57 - then what we're doing is we're waiting
46:59 - for ready to be equal to true and for
47:01 - our tracks to be there so we have some
47:04 - tracks essentially so really what that
47:06 - means is we're waiting for the user to
47:07 - give us permission to access their
47:09 - microphone in their camera
47:10 - once we have that we're going to try to
47:12 - initialize our kind of video stream with
47:15 - the channel name now the reason we're
47:17 - putting in a try again is just to be
47:18 - extra safe and to make sure that
47:20 - something goes wrong we are good and we
47:22 - have caught that and actually what i
47:23 - realized here is that we could remove
47:25 - this try because technically we're
47:26 - trying this entire thing
47:28 - but i think it's good to have this
47:30 - because this will catch a specific error
47:31 - that happens just when we try to join
47:33 - the channel so we'll leave that in for
47:35 - right now and this effect is going to be
47:37 - called right whenever ready changes
47:40 - and whenever uh what do you call client
47:42 - changes channel name changes or track
47:44 - changes but we're only going to call
47:45 - this huge kind of function that we made
47:47 - here so let a net equal async
47:49 - when ready and tracks have both been
47:51 - initialized
47:52 - okay
47:53 - so we've done all that
47:54 - now what we're going to do is we're
47:56 - going to set up what we're actually
47:57 - rendering on the screen so we're going
47:59 - to return
48:00 - and what we will return here is a grid
48:02 - so we're using material ui this is going
48:05 - to be a container the direction of our
48:07 - grid is going to be a
48:10 - column and we just need to make sure
48:12 - that we set the height of this we're
48:13 - going to say style is equal to
48:16 - and then this is going to be height
48:18 - and we just need to manually set this to
48:19 - 100
48:21 - okay so we now need to close the grid so
48:23 - slash grid
48:25 - now inside of this grid what do we want
48:27 - to do well we want two grid items here
48:30 - so we're going to say grid
48:32 - and then this is going to be an item
48:33 - that is inside of our grid we're going
48:34 - to say style is equal to and then we're
48:37 - going to again manually set the height
48:38 - of this so we're going to say height
48:40 - colon and then 15 now if any of you guys
48:43 - know some better css than this to you
48:44 - know set heights and do dynamic sizing
48:46 - and all of that please do let me know
48:48 - i'm not very good at css so i'm just
48:50 - using what i can to make this look half
48:52 - decent so sorry the height of this is
48:54 - going to be five percent and the height
48:55 - is going to be 95 now you're probably
48:57 - like what the heck are you doing tim
48:58 - well what i'm doing is i'm going to be
49:00 - rendering the controls and then actually
49:03 - the video right so remember i told you
49:04 - this component handles all of this kind
49:06 - of annoying connection related stuff but
49:08 - then what we are going to do is we are
49:10 - going to render alt videos and we're
49:11 - going to render all of the controls
49:13 - which are going to be in two separate
49:14 - components and so that's what we're
49:15 - going to do here all right so inside of
49:17 - this five percent this is where we're
49:19 - going to put our controls so we're going
49:21 - to check if ready
49:23 - and
49:24 - tracks
49:26 - and and then what we're going to do is
49:27 - render the following if both of those
49:29 - are true so we're going to say ready and
49:30 - tracks and and then we're going to
49:32 - render the component
49:34 - controls we've not defined this yet but
49:35 - we will define this later i'm just going
49:37 - to hard code in for now i'm going to say
49:38 - tracks
49:40 - is equal to
49:42 - tracks we're going to say set
49:45 - start
49:46 - is equal to
49:48 - start and then we're going to say set
49:50 - in call
49:52 - is equal to set
49:54 - in call
49:55 - all right i don't think there's anything
49:56 - else we need to pass there those are the
49:58 - props for that component all right so
50:00 - ready and tracks and done this so
50:02 - essentially just saying okay when we're
50:03 - ready and we have our tracks we'll
50:05 - display the controls
50:07 - then inside of here we're gonna do a
50:08 - similar thing i'm gonna copy this paste
50:11 - it but rather than ready we're going to
50:12 - put start
50:14 - so we're going to say start
50:16 - and then rather than having controls
50:17 - what we're going to have is simply our
50:20 - videos so we're just going to say videos
50:22 - we're going to pass the tracks but we're
50:24 - also going to pass the users
50:26 - so we're going to say users like that
50:30 - is equal to users and then i think
50:32 - that's actually all we need here so
50:33 - let's close that
50:34 - okay so i know again
50:36 - probably confusing i'm even confusing
50:38 - myself there's a lot of code that we
50:39 - need to write here
50:40 - but we're just going to only show the
50:42 - controls and then the video when the
50:45 - corresponding variables are true right
50:47 - so once we're ready and once we are
50:49 - starting okay so just because we have
50:50 - two variables here ready and started i'm
50:52 - just going to stop and explain what
50:53 - these are just to make sure this is
50:54 - clear so what's the difference between
50:56 - ready and start okay so start
50:57 - essentially is telling us we can now
51:00 - view
51:01 - other people's videos
51:03 - so we have these events set up so once
51:06 - we set up these events
51:08 - what we can do is we can view other
51:10 - people's uh videos right once we've
51:11 - joined the channel
51:13 - however
51:14 - we may not have published our video yet
51:18 - so it seems a little bit confusing the
51:20 - thing is we're setting start equal to
51:22 - true regardless of the fact that we
51:24 - publish the video or not because if we
51:26 - do not have any tracks if we have not
51:28 - given permission to our camera or
51:30 - whatever or for some reason we just
51:31 - don't have any tracks to display then we
51:33 - can still view other people's videos
51:35 - but we are not going to publish ours and
51:37 - so that's why we're setting start
51:38 - however we should only show controls for
51:41 - our video
51:42 - if we have a video right so once our
51:44 - video is ready and we have our tracks
51:47 - then we can disable and enable our video
51:49 - but we want to still be able to view
51:51 - other people's videos before that point
51:52 - is ready so hopefully that kind of makes
51:54 - sense but that's the difference like
51:56 - ready is telling us our video is good
51:58 - started saying okay we can now view
51:59 - other people's videos so yeah that's the
52:02 - core difference there i get that that's
52:03 - probably a bit confusing but
52:05 - anyways that's the way that we're going
52:06 - to do this here and a lot of this code
52:08 - i've just taken from official
52:09 - documentation from agora just to make
52:11 - that crystal clear i did not come up
52:13 - with all this stuff off the top of my
52:15 - head
52:15 - okay so now that we have that we need to
52:17 - code out these two components controls
52:19 - and videos right so let's start with
52:21 - controls because i feel like that's the
52:23 - most intimidating one so we'll get the
52:24 - easy stuff f uh done after we do this
52:27 - okay so let's make a new file here and
52:29 - let's call this one controls dot
52:33 - js oh i already have sorry i already
52:35 - made controls.js one step ahead of
52:37 - myself now we're gonna do is import a
52:39 - few things that we need so we're gonna
52:40 - say import it's gonna be
52:42 - used
52:44 - this will be from
52:45 - and react
52:47 - then we want to import
52:49 - use client
52:51 - and this will be from
52:53 - and then dot slash settings like that
52:56 - perfect
52:57 - then we want to import grid so we're
53:00 - going to say import
53:01 - grid
53:03 - button
53:04 - and icon
53:06 - from and this is going to be
53:08 - at material hyphen ui
53:11 - core
53:12 - okay perfect and then what we actually
53:15 - need to do now is we need to import a
53:16 - bunch of icons now i'm going to copy all
53:18 - of these so let's copy them all right
53:21 - now okay so mic icon mic off icon video
53:23 - cam icon video cam off icon exit to app
53:26 - icon i don't think i need to explain why
53:28 - we need these icons i mean they're going
53:29 - to just be the icons we have for our
53:31 - different buttons and now i realize that
53:33 - we need to install the material ui
53:35 - icons package
53:37 - so what we're going to do is just type
53:38 - npm
53:40 - install material ui
53:42 - icons app material ui icons okay this is
53:45 - going to take a second once it is done i
53:46 - will be right back all right so now we
53:48 - have material ui icons installed now
53:51 - we're going to start coding out this
53:52 - component so export
53:54 - default
53:56 - function
53:59 - controls
54:01 - take in some props like that okay we're
54:04 - going to use our client so const client
54:07 - is equal
54:09 - to use client like that
54:11 - const
54:13 - and then tracks
54:15 - set
54:16 - start
54:17 - and set
54:19 - in
54:20 - call
54:21 - is equal to props perfect
54:24 - and then const
54:26 - track
54:27 - state
54:28 - set track
54:30 - state
54:31 - is equal
54:32 - to u state and this is going to have two
54:34 - things it's gonna have video
54:37 - true
54:38 - and audio
54:40 - true
54:42 - okay perfect let me make sure that's
54:43 - correct i think that's all we need nice
54:45 - okay now we have all those things
54:46 - initialized
54:47 - what i'm going to do now is just code
54:49 - out what this is actually going to look
54:50 - like right so we're going to say return
54:53 - and now it's going to be a little bit of
54:54 - html madness going on here where we make
54:56 - a grid and we place some buttons and
54:58 - some icons essentially i want three
54:59 - buttons right i want the button to turn
55:01 - off the mic the button to turn off the
55:02 - camera and the button to leave the call
55:04 - so i'm going to say grid
55:05 - container spacing equals 2. if you're
55:08 - unfamiliar with this you can reference
55:10 - the material ui documentation but what
55:12 - this does for us is set up a nice grid
55:15 - using i believe it's called flexbox so
55:18 - this just kind of has some default css
55:20 - classes for us so rather than me having
55:21 - to go through and write all the css we
55:23 - can just use this grid so you know it's
55:25 - kind of as it explains by default a grid
55:28 - is going to be in a row size so we're
55:30 - going to have things showing up
55:32 - horizontally on the screen but i think
55:34 - you saw previously i think i did it here
55:36 - i set up a grid that was the direction
55:39 - column so things were going vertical in
55:40 - the screen
55:41 - anyways that's the difference column is
55:43 - vertical grid is horizontal okay now
55:46 - we're going to set up some grid items so
55:48 - we're going to say grid item
55:50 - notice that items go inside of
55:51 - containers right so we'll have two grid
55:54 - items actually we'll have three grid
55:55 - items sorry so three grid items and
55:57 - inside of each of these items we're
55:58 - going to have some buttons now of course
56:00 - align item center it's going to put all
56:02 - our items in the center of the grid
56:03 - which is what we want
56:05 - now we're going to have a button
56:07 - this is going to be the variant
56:10 - which is equal to contained there's a
56:12 - few other variants again you can find
56:14 - all this stuff in the material ui
56:16 - documentation
56:17 - uh it's not super important so i won't
56:19 - really cover it
56:20 - we're going to have the color the color
56:22 - is going to be equal to
56:24 - dynamically
56:25 - red or blue depending on if the audio is
56:29 - on or off right so this button the first
56:30 - button here is going to be for our mic
56:32 - so we'll have the color that is equal to
56:34 - track
56:36 - state oops
56:38 - dot audio
56:39 - and if the track state dot audio is on
56:41 - so if that's true then we're going to
56:43 - show the color primary which means blue
56:46 - right
56:47 - and then we're going to show the color
56:49 - secondary which is kind of like a red
56:51 - color
56:52 - again look at material ui documentation
56:55 - if you want to see all of this
56:57 - okay so we have our button now this
57:00 - button is going to be called i guess
57:01 - actually we're not going to have a name
57:02 - for this button so we're just going to
57:03 - put an icon for it so we have two icons
57:06 - right we have mic icon and mic off icon
57:08 - so depending on the same condition here
57:11 - if the audio is on then we want to show
57:13 - that the audio is on otherwise we want
57:15 - to show that it's off so there's two
57:16 - icons we can show here
57:18 - the first icon we'll show is the mic
57:20 - icon
57:22 - if the audio is on
57:24 - otherwise we will show i'll just copy
57:26 - this and change it to i think it's
57:27 - called the mic off icon
57:30 - mic off icon let's see yeah that looks
57:33 - like that is what it's called okay sweet
57:34 - so we're going to show the mic on
57:37 - if the audio is on otherwise mic off
57:40 - all right so now what i need to do is
57:41 - add an on click here so i'm going to say
57:43 - on click
57:45 - and this is going to be an arrow
57:46 - function so on click is equal to an
57:48 - arrow function and this is going to call
57:50 - another function that we've yet to
57:51 - define called mute it's going to pass in
57:53 - audio
57:54 - now what mute is going to take is audio
57:56 - or video so the string audio or video if
57:58 - you pass it audio uh then it will mute
58:00 - the audio otherwise it'll mute the video
58:02 - right pretty straightforward okay so
58:03 - let's copy this button because the next
58:05 - ones are going to be almost identical
58:07 - let's put two more here
58:09 - and this time rather than having audio
58:10 - we're going to do video so we'll just
58:12 - change all of this to say video like
58:15 - that
58:16 - and the icons need to change too
58:18 - this all got got to change to video
58:20 - now we're going to use video cam icon
58:23 - and video cam off icon
58:25 - okay so let's change this
58:27 - to video cam icon
58:30 - and this will be video cam
58:32 - off icon
58:34 - sweet just notice i changed everything
58:35 - to video
58:36 - okay so now our last button is going to
58:38 - be the leave button so what this is
58:41 - going to have is it's just going to say
58:43 - leave
58:44 - like that and then we will actually have
58:46 - an icon beside leave i think that the
58:48 - leave icon is not super intuitive and so
58:50 - i want to add some text there as well
58:53 - okay
58:54 - now we will just use the
58:57 - uh exit to app icon that's like a little
59:00 - you'll see what it looks like but it
59:01 - just looks like you're leaving that's
59:03 - why i picked it
59:05 - okay so now for the color for this one
59:07 - it's not going to be dynamic it'll just
59:09 - be the same because once you press that
59:10 - button you're going to leave it we're
59:11 - going to call this default and then it's
59:13 - going to call a function
59:15 - called
59:16 - leave
59:17 - channel like that now we actually need
59:19 - to call it so there you go
59:21 - okay so now we have all of our buttons
59:22 - so again contained default we're calling
59:25 - the leave channel function which we'll
59:28 - define in a minute and i realize that we
59:30 - no longer need this icon i thought we
59:32 - were going to use that but i guess you
59:33 - can just define the icon like this
59:35 - okay so now let's write out those two
59:37 - functions so we need that mute function
59:38 - and we need that leave channel leave
59:40 - channels easiest so we'll start with
59:41 - that so we'll say const
59:43 - leave channel
59:44 - is equal to async
59:46 - and then yeah that will be brackets
59:49 - like that and inside of here we're going
59:51 - to say await
59:52 - client dot can you guess what it is
59:55 - it's leave
59:56 - pretty straightforward just leaves the
59:57 - chat
59:58 - then what we want to do after this we
59:59 - need to remove all the event listeners
60:01 - so we're going to say remove all
60:02 - listeners so if we go back to video call
60:05 - see how we set up all these on whatever
60:08 - event listeners what this does is it
60:10 - just removes them to make sure that we
60:11 - don't have all of these kind of
60:12 - lingering event listeners and we've
60:14 - already left the channel
60:15 - okay then what we want to do is we want
60:17 - to close our audio and video tracks so
60:19 - we're going to say tracks 0
60:21 - dot close and
60:23 - tracks 1 dot close or one of these will
60:25 - be audio one of them will be video i
60:27 - can't remember which one's which but it
60:28 - doesn't really matter because we kind of
60:30 - do the same thing for both of them
60:31 - and then we're going to say set start is
60:33 - equal to false
60:35 - and set
60:37 - in call
60:39 - equal
60:40 - to false perfect okay so now we've done
60:43 - the leave channel next thing we want to
60:45 - do is mute so we're going to say
60:48 - const
60:49 - mute
60:50 - is equal to async
60:52 - this needs to be asynchronous because
60:53 - you're going to wait on a network
60:55 - operation here just like this one was
60:57 - async as well right so we're going to
60:58 - take in a type so the type is going to
61:00 - be either audio
61:01 - or video then depending on what it is
61:03 - we'll disable that audio track or video
61:05 - track so we're going to say if
61:07 - type
61:08 - is equal to audio
61:11 - then what we want to do is say await and
61:13 - it's going to be tracks
61:15 - zero so there you go zero is going to be
61:17 - the audio track dot
61:19 - set enabled and we're just going to set
61:21 - equal to our set enabled sorry to
61:23 - whatever the opposite of its current
61:25 - state is so we're going to say track
61:26 - state
61:27 - dot audio not track state audio so
61:29 - essentially you know if this is true if
61:31 - audio is playing then we're going to set
61:32 - it to false otherwise set it to true i
61:34 - think you guys get the idea then after
61:37 - that we're going to say set
61:39 - oops set
61:41 - track state like that
61:43 - and we're going to take in whatever the
61:44 - previous state was so that's ps previous
61:47 - state and
61:49 - we are going to
61:51 - return a new object
61:53 - with the previous state but this time
61:55 - with audio equal to and this will be not
61:57 - ps dot audio
62:00 - okay we're going to do almost the exact
62:01 - same thing for video so let's just copy
62:03 - it
62:04 - go down here
62:05 - we could change this one to elsif if
62:07 - we're feeling uh feeling creative here
62:08 - so it goes to else if now this can go
62:11 - to video
62:13 - make this tracks one rather than
62:15 - trackstate.audio you guessed it it's
62:17 - going to be video
62:19 - now rather than
62:20 - audio this is going to be video so not
62:23 - ps stop video
62:25 - okay there we go we are now finished the
62:28 - mute function finish the leave channel
62:30 - function and we are done with this
62:32 - component okay so this component is good
62:35 - now we need to do the video component
62:36 - this one is a little bit simpler than
62:38 - the other one yeah it's actually not too
62:40 - much that we need to do here i'm just
62:42 - going to take a quick break here and
62:44 - review some of this code to make sure we
62:45 - haven't made any major flaws or mistakes
62:47 - and i'll be right back all right so we
62:48 - are all good we are now going to do the
62:50 - video component now i apologize that we
62:52 - can't really run the app right now we
62:54 - just have to code a ton because we can't
62:56 - really see anything functioning until
62:58 - all of this stuff is done kind of sucks
63:00 - but at the same time it's fine let's
63:02 - just scale the code done and then we can
63:03 - enjoy the application after
63:05 - all right so what we're going to do now
63:06 - is we're going to import the agora
63:10 - and this is going to be the video player
63:14 - from the wrapper we installed so agora
63:18 - hyphen rtc hyphen react
63:21 - wonderful then we are going to import
63:24 - the grid
63:25 - from and this can be at material hyphen
63:28 - ui slash core and then we're going to
63:31 - import oops let's go
63:34 - next line here
63:36 - going to import
63:38 - use state
63:41 - and use effect
63:42 - from react
63:45 - nice okay let's make our component
63:47 - export
63:49 - default
63:50 - function
63:52 - video
63:53 - props
63:54 - and let's define some state or sorry
63:57 - let's grab some stuff from our props so
63:58 - we want users and we want tracks
64:00 - remember we pass these through the props
64:02 - to video this is equal to props
64:04 - we're then going to say const
64:06 - this is going to be
64:08 - grid
64:10 - spacing
64:12 - set grid
64:14 - spacing you'll see why we need this in a
64:15 - second but the idea here is that
64:17 - in our grid in our material ui grid we
64:20 - have 12
64:21 - potential positions four items in the
64:23 - grid so
64:24 - if you're looking at the grid in terms
64:26 - of uh horizontally right so like width
64:28 - of the screen you can have 12 items in a
64:31 - grid so the thing is we can define how
64:34 - much space an item uses in our grid out
64:37 - of 12. so to start when it's just one
64:39 - person in the room they'll take up the
64:41 - entire grid right they'll take up all 12
64:43 - squares in the grid
64:44 - but as more people join we need to
64:46 - shrink them so we need something
64:48 - representing our grid spacing and we'll
64:51 - have this set to 12 to start and then
64:53 - we'll divide it so we'll divide 12 by
64:56 - the number of users in our room
64:58 - to define how much space each person the
65:00 - grid is taking up now as soon as someone
65:02 - starts taking up like less than a
65:04 - certain amount of space we will increase
65:06 - the size of the grid vertically so we'll
65:08 - fill up specifically
65:10 - three people in one row and then as soon
65:12 - as three people are in one row we'll
65:14 - automatically move down to the next row
65:16 - and that's why we're using this grid
65:17 - because grid is really easy to do this
65:19 - in
65:20 - and you'll see it's not super
65:21 - complicated but we just need to define
65:23 - you know how much space each person's
65:24 - taken up okay so we're gonna define use
65:26 - effect now
65:28 - inside of use effect we're gonna say set
65:30 - grid spacing and we're gonna set the
65:32 - grid spacing equal to the math dot
65:34 - maximum of the math
65:37 - dot floor this is just to avoid any what
65:40 - is it floating point division and we're
65:42 - gonna say 12 divided by our users
65:46 - dot length plus one now the reason we're
65:48 - doing this is because we are a user and
65:50 - technically our users uh does not define
65:53 - ourselves so we have users.length plus
65:55 - one to represent that hey we're in the
65:56 - grid two
65:58 - and then after this
65:59 - what we do is we're gonna define in the
66:02 - max function right 4. so we're going to
66:04 - say okay if we have 12 users we don't
66:07 - want each user only taking up one grid
66:08 - square we want them taking up 4. so if
66:10 - we have actually less than 3 users here
66:13 - then we'll take whatever this division
66:14 - is otherwise we're going to take 4. so
66:17 - hopefully you guys can understand that
66:18 - math there but this is just a dynamic
66:19 - way to do it and then we're only going
66:21 - to do this effect whenever the users
66:24 - change
66:25 - or the tracks change so if we disable a
66:28 - track right then we'll stop showing
66:30 - ourself in the grid actually sorry we're
66:32 - not going to stop showing ourselves but
66:33 - someone else will stop seeing us
66:36 - and anyways you'll see how it works but
66:38 - technically a user could disable their
66:40 - mic without leaving the chat right and
66:43 - so if or sorry not not mic video so if
66:45 - they disable their video but they
66:46 - haven't left the room yet or left the
66:48 - channel then we want to stop showing
66:50 - them in the grid we could show them with
66:51 - the black screen
66:53 - if you wanted to do that then you would
66:54 - just remove tracks from right here but i
66:56 - don't want to do that so i'm going to do
66:57 - it this way okay so now all we have to
66:58 - do is just return whatever we're going
67:00 - to render here so i'm going to return
67:02 - i can make my grid and say grid this is
67:05 - going to be item and container actually
67:06 - sorry this should just be container grid
67:09 - container
67:10 - this is going to be
67:11 - style
67:13 - equal to and we need to set the height
67:15 - of this as well
67:16 - so i'm going to say height
67:18 - 100 now any of you guys that are better
67:20 - at me at css like why are you setting
67:21 - the height to 100
67:22 - well unfortunately this agora video
67:24 - player here i was having some
67:26 - difficulties with it i'm sure some of
67:27 - you guys are smarter than me can figure
67:28 - this out but
67:30 - pretty much i realized that i just need
67:31 - to set the height of everything to be a
67:33 - hundred percent otherwise this has a
67:35 - height of zero so
67:37 - my limited knowledge of css tells me
67:39 - that the parent of this is what the size
67:43 - of this thing is going to be and so if
67:44 - the parent doesn't have a defined height
67:47 - if it's not set to some specific height
67:50 - then this is just going to be a height
67:51 - of 0 because usually what happens
67:54 - is your container will take up the
67:55 - amount of space that the children are
67:57 - taking up right if the child's a height
67:58 - 100 then the container here will be
68:01 - height 100
68:02 - but in this case the agora video player
68:05 - gets its height from the height of the
68:08 - container that it's in and so we need to
68:10 - set the height of the container which is
68:11 - annoying but we can figure it out and
68:13 - that's actually the reason why here we
68:15 - have the root being equal to 100
68:16 - vertical height the reason i had to do
68:18 - that is because we need to have
68:20 - somewhere
68:21 - some absolute height in this case
68:24 - hundred vh is actually going to kind of
68:27 - stand for a pixel value so vh is like
68:30 - the number of pixels the vertical height
68:32 - of the screen right and so we're saying
68:33 - 100 of the vertical height and so really
68:35 - this will be equal to some pixel value
68:38 - and so that means that when we set all
68:40 - of the divs going down to 100 height
68:42 - they'll all be equal to that height as
68:44 - well and so eventually when we get to
68:46 - video
68:47 - our containers that are storing these
68:48 - videos
68:49 - will be able to actually have a height
68:52 - i'm sure
68:53 - no one understands what i just said
68:55 - there
68:56 - but that's my rationale just want to
68:57 - explain that so you guys don't think i'm
68:59 - too crazy okay now we're going to make
69:00 - our grid items so this item is going to
69:02 - have spacing which is equal to
69:05 - grid spacing
69:06 - so in case you're unfamiliar with how
69:07 - you do this
69:08 - xs stands for extra small you have md i
69:12 - think or m or something that stands for
69:14 - medium you have lg which stands for
69:15 - large i think you have like xlg or
69:18 - yes something like that you'd have to
69:20 - look it up exactly on the material ui
69:22 - documentation but what i'm doing right
69:23 - here is saying okay when the screen is
69:25 - size extra small or larger we are going
69:28 - to have this item taking up this number
69:32 - of grid spacing squares and we're
69:34 - setting that in this state variable
69:35 - right so whatever we get from this math
69:37 - here that's how much space is going to
69:40 - be taken up by this grid item
69:43 - so anyways that's
69:44 - the rationale there xs is just saying
69:46 - okay take up this much space in the grid
69:48 - now you could define like when the grid
69:50 - is larger take up less space or take up
69:53 - more space but when you just set xs this
69:56 - automatically sets it for all the other
69:58 - ones too so if you set xs for a medium
70:00 - size screen or for a small size screen
70:02 - for a large size screen it will set the
70:05 - spacing the same but you can
70:06 - individually define what you want the
70:08 - spacing to be for all different types of
70:10 - screens
70:11 - okay so again reference the material ui
70:13 - documentation i'm going to keep saying
70:14 - that but if you guys have made it this
70:16 - far i think you'll be able to look
70:17 - through the documentation and figure
70:18 - that out pretty easily okay we're gonna
70:19 - have two great items here
70:21 - so we have this grid item and then we're
70:23 - gonna have another grid item now the
70:24 - first grid item here
70:26 - inside of here we're gonna put an agora
70:28 - video player
70:29 - now this is going to be us so we're
70:30 - going to say agora
70:32 - video player when i say us i mean like
70:34 - whoever is the client it's going to be
70:36 - their video the other stuff that i'll
70:38 - show you in a second will be everyone
70:39 - else's video so be agora video player
70:42 - and then we need to define a few things
70:44 - in here so we're going to say that the
70:46 - video
70:47 - track is equal to and then this is going
70:49 - to be tracks one our video track right
70:51 - so tracks one and then we're going to
70:53 - say that the style is equal to and this
70:55 - is mandatory you need to put this if you
70:57 - don't put this it's not going to work
70:58 - height
70:59 - 100
71:01 - width
71:02 - 100 now if you want this to be smaller
71:04 - of course you know adjust these values
71:05 - you can make them pixels too uh but to
71:07 - make it dynamic you want to be a
71:08 - percentage so we're going to say height
71:09 - 100 with 100
71:11 - so fill the entire size of this grid
71:13 - container
71:14 - okay so now we have another grid but
71:16 - what i want to do is i want to generate
71:19 - a grid item
71:21 - for every single user's video feed so
71:25 - what i need to do here is i need to map
71:27 - all of my users to a grid item so i'm
71:29 - going to say users
71:31 - dot length is greater than zero
71:34 - and and
71:36 - users.map
71:38 - and i'm going to take in
71:40 - a
71:41 - user
71:43 - and then what i'm going to do is return
71:45 - if the user has a video track so if
71:48 - user dot
71:50 - video track like that
71:52 - i am going to
71:55 - return the following now i realize i
71:56 - need i uh what is it curly bracket here
71:59 - so put a curly bracket there
72:01 - put another one here
72:02 - and we are going to return a grid item
72:05 - so lets grab that grid item let's put it
72:08 - here
72:08 - let's save let me see what it's showing
72:11 - us is wrong here
72:13 - okay so i just have my bracket in the
72:14 - wrong order here just got to put a
72:16 - bracket there
72:17 - and i think that's good now yeah okay
72:20 - there you go so now we're good so now
72:21 - inside of this grid item we can put what
72:22 - we want
72:23 - so it's going to again be an agora video
72:25 - player so let's copy that
72:27 - it's gonna have to have the height
72:28 - of a hundred and hundred and then what
72:30 - we're gonna have is the video track
72:32 - which is equal to rather than tracks one
72:35 - user dot video track okay so it's equal
72:39 - to user.video track and then what we
72:41 - want to do here is we want to also have
72:43 - a key now whenever you use like a map
72:46 - which is what we're doing here in react
72:48 - every child object is supposed to have a
72:50 - unique key so in this case the key is
72:52 - going to be user.uid this is just so
72:54 - that you don't get screamed out in the
72:55 - console okay now otherwise though
72:58 - because we have this if right we need to
72:59 - have something else so we're going to
73:00 - say else
73:02 - return
73:03 - no so just don't do anything so
73:05 - essentially if we have no users just
73:06 - don't do anything you can just stop now
73:09 - why what is wrong here what is this
73:11 - saying
73:12 - um i think this should be good
73:15 - okay yeah so i don't know i think vs
73:16 - code is glitching out because this is
73:18 - fine okay so that
73:20 - in theory is all we need to do except
73:22 - for a few very small things in app.js so
73:25 - let me zoom out here just so you guys
73:26 - can see this i'll go through the files
73:28 - for one second so you guys can look at
73:29 - all of them but again i have all this
73:31 - stuff in a github repo so feel free to
73:32 - check that out from the link in the
73:33 - description okay so this is video
73:36 - this is
73:38 - controls although it's kind of large so
73:40 - i can like scroll through it a little
73:42 - bit so you guys can see it this is
73:45 - video call
73:47 - okay
73:48 - and this is app.js
73:52 - all right so let's continue here we're
73:53 - going to nap dot js now we need some way
73:55 - to actually enter into our video call
73:57 - room so what we are going to do is we're
74:00 - going to make a button here so we're
74:01 - just going to say
74:03 - import
74:04 - and we're going to import a button
74:08 - from
74:09 - and this is going to be at
74:12 - material ui
74:14 - core we're just going to put a button
74:16 - above this we're going to change this
74:17 - right so that's something else we're
74:18 - going to put a button
74:20 - and this button will be a variant
74:24 - equal to
74:27 - contained
74:28 - its color will be equal to
74:30 - primary and then we'll have an on click
74:33 - say on click
74:35 - is equal to
74:36 - this will be an arrow function
74:38 - what the arrow function is going to do
74:40 - is it's going to call set
74:42 - in call
74:44 - equal to tr okay and then here we're
74:46 - going to say
74:48 - join
74:49 - call
74:50 - like that and then if we are in the call
74:54 - what we are going to do is we're going
74:55 - to render the video call components
74:58 - we're going to say video
75:00 - call
75:00 - like that and then we need to pass
75:02 - through this video called component
75:04 - set in call as a prop so setting call is
75:07 - equal to
75:09 - set
75:11 - in call
75:12 - okay
75:13 - we need to import this video call
75:14 - component so we're going to say import
75:17 - video call from
75:20 - dot slash
75:22 - video call and now we're going to run
75:25 - the app and we're going to see how many
75:26 - errors we made now
75:28 - i'm not super optimistic just because
75:30 - it's a lot of code we wrote without
75:31 - testing it but let's start the
75:32 - application and let's see if this
75:34 - actually works all right so as i
75:37 - suspected we have a few errors first
75:39 - error is a go to video call.js
75:42 - we have to put dot before this
75:44 - settings.js import it was saying we
75:46 - couldn't find it because we didn't have
75:48 - that dot now you can see there's other
75:49 - errors popping up
75:51 - in video call which is right here we
75:52 - forgot to import controls and videos so
75:54 - let's do that we're going to import
75:57 - videos
75:58 - from
76:00 - dot slash videos make sure you have dot
76:01 - slash then we're going to import
76:04 - uh what's the other one we needed
76:05 - controls
76:07 - from
76:09 - dot slash controls
76:10 - uh controls not control
76:12 - okay
76:13 - let's see what air we get now okay uh
76:15 - cannot resolve videos
76:17 - ah so this is video
76:19 - not videos
76:21 - nice just messing up the players okay
76:24 - videos is not defined yes that would
76:26 - make sense if we go down here
76:28 - i've called this videos when this is
76:30 - actually just called video
76:32 - okay compiled with warnings
76:34 - that's good warnings are always good
76:36 - because they're not errors okay so now
76:38 - let's go here
76:39 - and let's refresh okay so it says join
76:41 - call waiting to join call uh one of the
76:43 - prettiest uis you've seen i know okay so
76:45 - let's press join call
76:47 - and now look it says use your camera
76:49 - wants to use your camera so we'll press
76:51 - a lot
76:52 - should ask me for the microphone too
76:54 - okay so now it's showing me
76:56 - all of the controls but it's not showing
76:59 - the video now i think i know why but
77:01 - let's go to the console here and see
77:03 - so failed prop type align items of grid
77:06 - must be used on container okay failed
77:08 - prop type spacing of grid
77:10 - warning receive true for a non-boolean
77:12 - attribute container
77:13 - okay and we go through here everything
77:15 - else actually looks like it's kind of
77:16 - working now the video i believe we're
77:19 - just not seeing right now i'm going to
77:21 - show you how we can see that in one
77:22 - second this is actually a decent start
77:24 - considering the amount of code that we
77:25 - wrote okay so let's go back here and
77:27 - let's fix a few things now actually
77:29 - let's just press these buttons and see
77:30 - if they work okay they do work you can
77:32 - see that they toggle back and forth and
77:34 - then if you press leave
77:35 - set start is not a function that's fine
77:38 - we'll fix that in one second okay okay
77:40 - so i'm not necessarily tackling these
77:41 - errors in the order in which we saw them
77:43 - but first error here line 73 in video
77:46 - call this needs to say set start
77:49 - not start so i'm not sure if uh if we
77:51 - saw this but when you press the leave
77:52 - button it didn't work because we
77:54 - apparently could not set start because
77:56 - well we didn't have said start so it's
77:57 - in video call.js line 73 make this set
78:01 - start now the other error we were
78:02 - getting here
78:04 - was related to the fact of our grid so
78:07 - it said align items and spacing are not
78:09 - valid things here for our grid
78:12 - oh maybe i have container equals true i
78:16 - don't know where i would have done that
78:18 - container equals true let's try this
78:21 - container
78:24 - equals true can we just look for
78:26 - container
78:27 - okay container here container here
78:30 - hmm okay it's saying something about
78:32 - container equal true let me look into
78:34 - this and then i will be right back all
78:36 - right so very silly error here just a
78:38 - typo so if you go to line 39 you see i
78:40 - had cannot tinner it should be container
78:44 - like that and then that should fix
78:46 - our ui so again line 39
78:48 - change that to container rather than the
78:51 - typo that i made although i'm sure you
78:52 - guys would have fixed that anyways okay
78:54 - so let's press join call
78:56 - and now notice that it joins now the
78:58 - join uh button is not disappearing which
79:00 - we need to fix but we can see that our
79:02 - menu buttons or whatever you want to
79:04 - call them controls at least they're
79:05 - they're showing up nicely now if we
79:06 - press leave that does work because we
79:08 - fixed that so let's do a few more
79:10 - changes here so let's go to app.js and
79:13 - let's make it so we only see this button
79:15 - if we're not in the call right so rather
79:16 - than saying waiting to join call let's
79:18 - just put the button right there
79:20 - there we go that will have fixed that
79:22 - error for us now what we need to do is
79:24 - make it so we actually see our videos
79:26 - now i am actually certain that the video
79:27 - is appearing i know that seems like a
79:29 - lie because you can't see it but it's
79:31 - because we haven't set the height of one
79:32 - of the divs that i remember i forgot to
79:34 - do so if we go actually i don't think
79:37 - it's here no it wouldn't be in controls
79:39 - i believe will be in video call we have
79:41 - the container height equal to 100 we
79:43 - have this height equal to 95 but if we
79:45 - go to app.js notice how we did not set
79:48 - the height of this div so what we
79:50 - actually need to do here is to say style
79:53 - equals
79:54 - and then height
79:55 - colon and then this should be
79:58 - 100
80:00 - okay so if i do this now i believe this
80:03 - should work for us could be incorrect
80:04 - but let's try this so if i press join
80:07 - call
80:07 - let's see okay i can see my webcam
80:09 - turning on and there we go i can now see
80:11 - myself on the screen so notice how i'm
80:13 - taking up the entire screen when it's
80:15 - just me in the call right so this is
80:17 - very good we've actually done a lot of
80:19 - what we need to do now if i stop the
80:21 - video notice it it turns off right and
80:23 - if i stop the mic then you would stop
80:25 - hearing it now the thing is uh you can
80:27 - actually test if the mic is working by
80:29 - joining in another tab which is exactly
80:30 - what i'm going to do so what i'm going
80:32 - to do here is just copy this
80:34 - go to another tab here and paste it
80:36 - local host colon 3000 and you'll see now
80:39 - when i join this that another thing will
80:41 - pop up so when i press join a call
80:43 - you'll see now there's two of me right
80:45 - and notice that the one on the left is
80:47 - mirrored in a different way than the one
80:49 - on the right
80:50 - the reason for that is when it's showing
80:52 - you yourself it's different than when
80:54 - it's showing it to someone else right
80:55 - kind of like looking in a mirror so you
80:56 - can see like how it's it's all kind of
80:58 - you know wonky and weird and like you
81:00 - can do stuff like that anyways that's
81:01 - because the one on the left is you like
81:03 - if i do this notice how it shows a black
81:04 - screen
81:06 - but then if you go over here then we can
81:08 - see
81:09 - other two people okay so now what i'm
81:11 - going to do is just show you if i stop
81:12 - the camera here and i go back here
81:14 - notice it's just showing me now the
81:16 - reason it's just showing me is because
81:18 - here i stopped the camera and so since i
81:20 - stopped the camera it's not showing the
81:21 - other person because their camera is off
81:23 - so let's join from another tab
81:25 - so when i join another tab just press
81:26 - join call notice now it's going to show
81:29 - two people because one person's camera's
81:31 - off if i go here it's showing three
81:33 - though the reason it's showing three is
81:34 - because there's three people in the call
81:36 - and this is my camera which is off now
81:37 - if i turn this back on and i go here you
81:39 - can see there's three people now let's
81:41 - see what happens if i join again
81:43 - so if i join one more time so we join a
81:46 - fourth time uh okay it's showing up
81:48 - still in the grid this isn't what i
81:50 - wanted to happen actually i'm gonna see
81:52 - how to fix this in one second
81:54 - um okay let's join one more time though
81:57 - just test this out okay so if we join a
81:59 - fifth time
82:00 - now it's showing five people okay so
82:03 - something is going wrong a little bit
82:05 - that we need to fix so let's leave the
82:07 - call you don't actually have to press
82:09 - leave call you can just you know
82:10 - manually leave
82:11 - and it should work
82:13 - but regardless hopefully you guys are
82:14 - happy with this at least so far because
82:16 - that's pretty cool and that took us a
82:17 - long time to make okay so let's fix this
82:20 - let's go
82:22 - to
82:23 - video.js
82:25 - and let's fix our spacing here for this
82:28 - grid so i am
82:30 - a little bit confused why it's not
82:32 - showing us the correct spacing here i
82:33 - think i may have messed something up
82:35 - here so i'm just going to reference some
82:37 - of my other code have a look at this and
82:39 - i'll be right back ah okay so i have
82:41 - found the issue here
82:43 - one missing bracket always seems to do
82:45 - it okay so i need to put this bracket
82:47 - here at the very end so i had i had
82:49 - three brackets here when there's
82:50 - supposed to be another one here and so
82:52 - like the math which is incorrect here on
82:54 - set grid spacing so that's why the grid
82:55 - spacing was all messed up
82:57 - okay so i think that was all i needed to
82:59 - fix actually trying to think if there
83:02 - was anything else uh but i think that's
83:04 - it for now okay so let's go back here
83:06 - and let's join the call
83:08 - okay give it a second shows me okay
83:11 - let's
83:12 - join again
83:14 - uh oh press join call
83:16 - okay there we go now we see two people
83:19 - we're just gonna have to test it with
83:21 - four people let's see if it works okay
83:23 - join there's three of us
83:25 - okay join
83:27 - and
83:29 - always we gotta have to press join call
83:30 - and now notice how the grid goes down
83:32 - right so now notice how it's showing
83:33 - more people and obviously as you expand
83:35 - this you're going to see more of each
83:36 - person because it's cropping the camera
83:39 - as you're like resizing the window right
83:40 - if i go really small you can see
83:42 - obviously not the most responsive design
83:44 - in the world but at least it shows
83:45 - everybody okay let's just join one more
83:47 - time just because i know you guys want
83:48 - to see my face again in the grid here
83:51 - okay there you go
83:54 - all right let's join a sixth time and
83:57 - boom there you go now you can see six of
83:58 - me
83:59 - and obviously you know you can stop your
84:01 - camera right and then if you go here
84:02 - there's only five people in the grid and
84:04 - while you guys can mess around with this
84:05 - as you please okay so let's close all of
84:07 - these just leave leave
84:10 - leave leave and leave
84:13 - beautiful okay so now that we've done
84:14 - that i want to show you how we can
84:16 - connect this application to a public url
84:18 - that anyone can access because right now
84:20 - we can only do this on our local area
84:21 - network if i'm not connected to this
84:23 - network and i try to access that well
84:25 - it's not going to work okay so remember
84:27 - i was telling you that we need to
84:28 - download ngrok that's what we're going
84:29 - to do now so go to the internet search
84:33 - ngrok link will be in the description by
84:34 - the way and just download this now if
84:36 - you already download this that's great
84:37 - but you're going to press get started
84:38 - for free it's going to obviously
84:40 - download for your operating system this
84:42 - is going to download a zip folder now
84:43 - what you need to do is you need to take
84:45 - the file out of the zip folder there's
84:47 - going to be a file it's called ngrok.exe
84:49 - inside of the zip folder take it out
84:51 - drag it somewhere else easiest place to
84:54 - put it to your desktop you can put it
84:55 - wherever you want okay then what you
84:56 - need to do is you need to navigate to
84:58 - the directory that you have this file in
85:01 - from your terminal or from your command
85:02 - prompt so a little shortcut on windows
85:04 - here if you open up windows explorer and
85:07 - you type cmd
85:09 - into the path that you want to open so
85:11 - see i'm on my desktop right i'm on my
85:13 - desktop if i go here and i type cmd it's
85:16 - going to open up a command prompt
85:18 - that is in my desktop so you can see
85:20 - that i have i'm on desktop right users
85:22 - tam desktop that's the path obviously
85:24 - you guys probably know how to change
85:25 - directories using cd so you can do it
85:26 - that way too but anyways what you want
85:28 - to do is just get into the directory
85:29 - where you have this ngrok file not the
85:31 - zip folder the file it could be the same
85:33 - directory but you got to take that file
85:35 - out of the zip folder so now what i'm
85:37 - going to do is i'm going to cd into
85:38 - agora
85:39 - because my file is somewhere else and
85:40 - now inside of here i think i can do this
85:43 - you can see that i have the ngrok.exe
85:45 - file now dur just tells you all the
85:47 - files and directories that are in the
85:48 - current directory and so i have
85:50 - ngrok.exe so what you're going to do
85:52 - here is you're going to type ngrok
85:54 - dot exe but before you type dot slash
85:57 - actually yeah we'll see if that works
85:59 - dot slash ngrak.exe you're going to type
86:01 - http
86:02 - and then you're going to type 3000. now
86:05 - what this is going to do is it's going
86:06 - to give you a public url that points to
86:09 - your computer's port 3000 and so that
86:11 - means that anyone else can access your
86:13 - web server which is running on port 3000
86:15 - that's why i'm typing 3000 because
86:16 - that's where react is running uh from
86:19 - this url so let's press enter and okay
86:22 - dot slash is not recognized as an
86:23 - internal external command if you're on
86:25 - mac or linux you can do that if you're
86:26 - on windows you just type ngrok.exe http
86:30 - space 3000 or whatever port your react
86:32 - apps running on and then what you're
86:34 - going to see here is it's going to give
86:34 - you these two forwarding addresses right
86:36 - i think they're actually just the exact
86:37 - same so what you can do now is you can
86:39 - copy this url
86:41 - okay and make sure you take the https
86:43 - one actually you need to do this on
86:45 - https if you do this on http it's not
86:47 - going to work you need https uh just
86:50 - remember that see how this expires in
86:51 - two hours that's what i was talking
86:53 - about the expiry you can just restart
86:54 - the command after two hours and you'll
86:56 - get a new url but this one's gonna you
86:58 - know expire after that mount so what i'm
87:00 - gonna do now is go to my web browser
87:03 - and i'm going to paste this
87:05 - okay so when i paste this you can see
87:07 - brings me to my website right so this is
87:09 - a public url anyone can access this give
87:11 - this to anyone friends family whatever
87:12 - do it from your phone and press join
87:15 - call
87:16 - it's going to ask you to allow this
87:17 - because it's a new url so i'm going to
87:18 - allow it
87:20 - and
87:21 - there you go see working totally fine
87:22 - now even if i go to localhost so i go
87:24 - localhost colon3000 and i join the call
87:26 - here you're going to see that this works
87:28 - so even though they're on two different
87:29 - urls it's the exact same thing because
87:32 - this url is just pointing to localhost
87:34 - so that's what ngrok does and that's
87:36 - really all i need to show you that's
87:38 - pretty much going to conclude this video
87:39 - so obviously here you can disable the
87:41 - microphone turn on the camera blah blah
87:44 - and yeah i guess that's really all i
87:46 - needed to say okay so yeah that's going
87:48 - to conclude this video right here i
87:50 - apologize that this was kind of all over
87:52 - the place but that's just you know what
87:54 - happens when you work on a really large
87:55 - project like this hopefully this got you
87:58 - guys up and running with agora and got
88:00 - your react video webcalling application
88:03 - working this was a really fun project
88:05 - for me to work on and i'm happy i was
88:06 - able to share it with you guys so one
88:08 - last thank you to agora for sponsoring
88:10 - this video let's actually head over to
88:12 - their website here this is a really cool
88:14 - platform as you guys saw we're able to
88:15 - do all of this stuff for free i didn't
88:17 - pay for this they didn't give me like a
88:18 - higher level account or anything like
88:20 - that uh the documentation is actually
88:22 - really good and as i was saying you can
88:23 - create so many different cool things
88:25 - right live streaming video call voice
88:26 - call recording real-time messaging you
88:28 - can look at all the analytics so if i go
88:30 - to my dashboard here which i'm on and i
88:31 - go to products and usage
88:34 - you'll see that you can see exactly how
88:35 - many minutes you've used uh your hd full
88:37 - hd 2k 2k plus resolution video whatever
88:40 - and then you can see in like what
88:42 - channels and stuff and there's more um
88:44 - what do you call it analytics that you
88:45 - can look at as well just kind of giving
88:46 - you an idea that this is what you can do
88:48 - on the platform all right so that is
88:49 - going to conclude this video i hope you
88:51 - guys found this helpful if you did make
88:53 - sure to leave a like subscribe to the
88:55 - channel and one last thank you to agora
88:56 - for sponsoring this video
89:00 - [Music]

Cleaned transcript:

hello everybody and welcome to a brand new youtube video so in this video i'm going to be showing you how to create a group video calling web application using react and using an awesome platform called agora so that's a g o r a dot io i'll be discussing that more in this video anyways i'm sorry if my faces are freaking you out here just wanted to give you a quick demo of what this application is going to look like you can see here that we can stop the camera we can start or stop the microphone i'm not going to do that because it's going to echo a bunch of times and yeah that's kind of how this works i'm going to keep it pretty simple with the ui i'm just going to show you how to set up this grid system how to get everything connected how to allow video streams to be sent between obviously different machines or different computers i'm also going to show you how you can host this on the web not permanently but temporarily so you can test it out you can see here i'm connected to an actual url if someone that was not on my local network type in this url they would be able to join this group video call so theoretically you can use this with anyone who has access to the link that i'm going to show you how to set up again all of this is free i hope you guys are excited now let me get all my faces off of the screen and we'll dive in alright so hopefully you guys enjoyed that demo there and are excited to get started this is a really cool application that we're going to be creating and the first thing i will mention is that although this does look really complicated right creating a group video calling application this actually is not that difficult to do there are quite a few steps in this tutorial but none of them are extremely challenging or difficult to follow along with however i will mention that it's probably a good idea that you have some familiarity with react with javascript and just with programming in general to follow along with this i'm not designing this for absolute beginners you should have a little bit of experience doing this and at the end of this tutorial you will have a really good kind of starting place for a group video calling application that you can then go extend work on implement in other projects whatever it is you may want to do now i do need to mention that this video is sponsored by agora agora is the platform we are going to use to implement this video calling and they make it super simple to do this so you're thinking of a group video calling application this seems like a really complicated thing but it's actually not that hard to do because of the work that a lot of talented developers at agora have done so you can see that agora is the realtime engagement platform for meaningful human connections and although we'll be using it to create a group video calling app you can do voice calls on it you can record your calls you can have realtime messaging you can do live streaming you can do analytics there's a ton of stuff that you can do here with agora and what i'm going to show you in this tutorial doesn't even scratch the surface of what is possible but hopefully it will give you an idea of kind of how to get started using this platform and this technology so just to give you a few more examples of things that you can create with agora that are actually concrete real applications i have the following list you could create online yoga classes with ai for form correction of participants you could create a speed dating video chat application you could create vr dj classes you could make an online poker with video chat that would be cool so you could actually see people's faces when you're playing there's all kinds of applications you can create with agora and as i was mentioning we're really just scratching the surface of what's possible in this video now i believe i mentioned this a few times now but this is free you do not need to pay for this the first 10 000 hours you use of video calling is completely free and as you can see here agora powers an average of over 50 billion minutes of human connections per month anyways that's all i really need to mention about this platform obviously we're going to be using it throughout this entire video to actually implement this and the first thing we're going to do here to get started is we're going to press start building today on the agora website i will link the website in the description but this is the link right here and then this will bring you to a page where you're asked to create an account now you can see i'm brought right here into this kind of console or dashboard just because i've already created my account but please go create your account first and then what we're going to need to do is create an agora project all right so once you have created your account what you're going to do is go over to project management and then you're going to press create so project management and kind of the left bar here you can see i already have a project that i was working on previously but what we'll do is press create we're going to give this a name so the name i will give for this project will just be react and then this will be video calling if i could spell calling correctly app and i'm going to press the secure mode app id plus token now you'll see why we're using this mode in a minute we could use just the app id mode essentially what you're selecting here is the way you want to authenticate your users with agora it's recommended that you use the secure mode that's what we'll use but we're going to be using what's known as a temporary token to do this so we won't have to deal with all this really complicated authentication uh that if you were actually going to deploy this to be a real live application you would definitely want to look at anyways let's just press submit here oh it says my project name already exists okay i think i might have created one previously anyways let me just change this now instead of saying react we can change this to say group so group video calling app all right so now i've created this project what we're going to do is set up our development environment so as i was saying we are going to be using react but specifically the code editor i'm going to use for this video is visual studio code so you can download that if you want you can use whatever editor doesn't matter i just prefer vs code we're also going to need node.js so this will allow us to use npm and you know work with our react development server and all that so download node.js all these links will be in the description and then finally we're going to use this thing called ngrok you can download it right now but when we get to that step i'll remind you and again this link will be in the description what ngrok will allow us to do is actually have a temporary public url that we can test our website on so you saw in that demo i was on my phone i was on my ipad well what we can do is actually set up this public url that anyone around the world can use to kind of test out our application now this url will actually expire after about two hours but this will allow people that are not on your current local area network to access your development server without you having to go through all the tedious steps of actually deploying this out to aws or whatever that may be anyways ngrok is really cool you'll see how that works much later in video okay so once we've done all that what we're going to do is we're going to open up visual studio code and we're going to create a new folder wherever you want that's going to store our application so let me open vs code here alright so vs code is now loaded i'm going to go to the explorer tab right here i'm going to press open folder but i also go to file and then open folder and then in my kind of windows explorer here what i'm going to do is go to my desktop go to my folder called agora you can see i have a folder here already that i was using for kind of the demo that i showed you so i'm gonna make a new folder i will call this tutorial and then inside of here is where i will actually put my react application okay so we're now inside of this tutorial folder what i'm gonna do now is open up my vs code terminal i did that by just scrolling up from the bottom of the screen and i'm going to use the npx create and then react app command to actually create a sample or kind of start a react application so we don't have to go through that tedious process of setting up the servers and the scripts and all that annoying stuff that we shouldn't have to do now you're only able to use this command if you've installed node.js so make sure node.js is on your system first and if for some reason it's not working you need to make sure that node.js is in your system path so that you can run the command npx and npm and hopefully the command yarn as well which you'll see in a minute anyways let's make this full screen and let's now type mpx create react app followed by the name of your react application so what i'm going to put my name as is actually let's just go group video calling app okay i'm going to press enter and then it should start generating a folder here inside of this tutorial folder it's going to have all of our react kind of starter code now we're not going to need all of the code that's in here so after this is done we're going to clean up a bunch of stuff delete a bunch of files then hopefully by the time that's finished our agora application will be synced and we'll be ready to set up our tokens and authentication and all of that stuff that we need alright so you can see we have now initialized our react application we have some folder group video calling app i'm just going to go through a few of the files here briefly discuss what they are and then delete a bunch of the ones that we don't need so first of all just make sure that if you want to start this dev server you are in the directory called group video calling app so i'm not going to explain really how to you know navigate directories and stuff in windows but you can use cd and then group video calling app you can see that now i'm in the correct path and well now i would be able to start my development server it shows you the instructions right here but just wanted to quickly mention that anyways inside this folder you see we have our node modules our public folder and our src folder the rest of the files you don't really need to concern yourself with the node modules folder is what's going to store all of our dependencies for the project the public folder stores some well public stuff i mean that's the extent of the explanation i will get into and what we're actually going to start by doing is deleting a few files that we don't need so we're going to delete these two logos here delete both that 192 and 512. we're then going to go in our manifest and see how in the manifest we're referencing these two files here so logo 192 and logo 512 the ones we just deleted we're going to delete the two references to this here so from line 10 to line 19. all right we're going to save that manifest we're now going to go into index.html we're going to remove the reference to this logo 192. so on line 12 we have this apple touch icon thing just delete that and by the way your stuff should look identical to mine because that's what the kind of starter code template does when you run create react app and what we can do here is we can change the title of our application if we want to i'll just change mine and say oops if my caplocks is toggled correctly group video and then this will be calling app like that i will now save this index.html file and there's no more changes we need to make here unless you want to change the description of your app okay so that's it for the public folder we can leave this fav icon thing i mean you can delete it if you want or change it but i won't worry about that for right now now we're going to go into src and we're just going to delete a bunch of files i won't really explain why we're deleting them but essentially we just don't need them there's a bunch of junk that comes with this that we can delete so we're going to delete app.css app.test.js logo to svg report web vitals and setup tests so i'm going to select all of those delete them and there you go very good all right now what we're going to do is just go inside of these three files here and do a few minor modifications so i'm going to go inside of index.css first and all i'm going to do is delete this margin colon zero this means that now we will have a margin around some of the tags specifically our body tag and so all of our content will no longer be kind of hugging the border it will be slightly offset it just looks a little bit nicer so i'm removing that margin and then you could remove this if you want as well but i'll just leave this here because it makes our font look a bit nicer uh in our you know what do you call it application or on our screen okay so let's delete that or not delete that close that now i'm going to go to index.js i'm going to remove the reference or the call to web vitals here i'm going to remove the import of web vitals and i think that's all i need to do in this file okay so i'm going to save index.js your index.js should look like this now i'm going to go to app.js and what i'm going to do is remove both of these imports because we've deleted these files that we're trying to import and now i'm going to delete everything inside of here except for this diff so this is what your app.js should look like i mean you could delete the entire thing and type this out if you want uh but yeah not a big deal and also i should mention that all of the code that i write here will be linked in the description uh via a github repository so for some reason i'm going too fast or you missed something or you just want to copy the code you can go to that github repository and have a look at it okay so there we are going to close these files now and that's all we kind of need to do to actually clean up our react app now what we can do is run this react application and make sure that it's working so what you're going to do is make sure you're in that correct directory so group video calling app and you're going to run the command yarn start now for some reason yarn start doesn't work for you just run the command npm start they do the same thing i'm not really going to explain you know the difference between npm and yarn yeah just run yarn start or npm start depending on which one works for you and then give it a second it's going to start running a development server and it should automatically open in google chrome or whatever your default browser is the actual localhost colon 3000 which is going to be the url of your video calling apps you can see here the title of this tab is group video calling app that means this is indeed working we can right click here press inspect we can view you know the console and all of the details see how there's no errors here that's good that means our react app is now working all right so that's all i need to show you in terms of the setup of the react application obviously we're going to be putting some content on the screen for now it's blank but i'll close that and now we're going to go back to our gorek dashboard here we're going to set up a temporary token that we can use for authentication looks like we are good to go you can see there's actually a web demo and so if you press on this web demo it will open up this thing it says you know reseca my last name invites you to join a video call you could press join channel and then you can see my webcam is popping up here anyways you can you know have a look at this demo if you want i'm not going to do that what i'm going to do though is go here and press temp token for audio video call so this thing that looks like a key press on that it's going to bring you to this thing it says app id app secret and channel name and what you're going to do is type in the name of the channel that you want to use for users to connect to and chat with each other so in agora you have these different channels now a channel you can think of as kind of a room where users can join in there and chat with each other so you can name this channel whatever you want i'll just name this channel main and you can make as many channels as you want that will have different tokens associated with them so i have my channel name main then what i'm going to do is generate my temporary token like that you can see it expires at 12 24 am i think it expires uh four hours after you create it because for me right now it's 8 24 pm and anyways you can copy this token but we'll use it in one minute okay so now we have our token generated what we're going to do is go back to our react app and we're going to create a few files we're going to go inside of src this is where all of our source code is going to be this is really where all of the files that we're going to be working with are from now on so you don't need to worry about the rest of the files or folders what we're going to do inside of here is we're going to create a file we're going to call this file settings dot pi or sorry not pi.js i'm used to my python coding and inside of here we're going to put a few pieces of information that we need to kind of initialize our agora application or initialize our agora api connection whatever you want to call okay so inside of here what we need to do is define two variables the first variable that we're going to have is our app id so we're going to say const app id and this is going to be equal to a string and then what we're going to do is go back to our agora app here or a gore dashboard whatever you want to call it and we're going to copy this app id so copy the app id come here paste it inside of this variable obviously make sure it's all on one line all right the next thing we want here is our token so we're going to say const token is equal to and then you guessed it we're going to go here to agora and we're going to copy this token all right so copy the token paste it in there that's all good and now we will continue all right so now that we have these two pieces of information that we need the app id and the token we're going to install a few dependencies that we need in our react application so what i've just done is i've stopped my development server i did that by pressing ctrl c and now we need to install three npm packages actually so the first thing we're going to install is material ui this is just the component library that's going to make it so our app looks a little bit nicer we can style things have a nice grid to lay out stuff in and anyways the way we do this is we say npm install and then app material hyphen ui core all right so we're going to install that this will take a second to install once we'll be back i will show you the next two things we need to install all right so material ui core has now been installed now what we're going to do is install material ui lab so run that command same thing once this is done only back for our last dependency all right so now we've installed all of the stuff we need related to material ui the next thing we need to install is the agora sdk so there's a lot of different ways that you can go about doing this i'm just going to quickly show you actually how you would do this for a different project if you weren't going to do this in react so if you go here to agora and you go to developers and we go to documentation so i'm here in the documentation i'm going to show you how we can download and use the agora sdk so we're going to go to the downloads tab right here it's going to bring us to this page and the first thing i want you to notice that agora is available for all kinds of different platforms so in this case we can see android ios mac web windows electron unity flutter so on and so forth a ton of different platforms that you can use agora on and if you look here we have the voice sdk the video sdk this is the older web sdk realtime messaging sdk all kinds of different sdks that we can use and the one we're actually going to be using is the web sdk so we want sorry not the voice sdk we want the video sdk for the web so we would click on this one right here and this would actually download the entire folder now for the web sdk we don't need to download the entire folder we could actually use a cdn which is just a link that we could include in our html file but in our case instead of that we're actually going to be using a react wrapper for agora so i'll show you that in one second but i do want to mention that for all of these different sdks and platforms there's all kinds of tutorials on the agora website and sample applications so check those out if you're trying to do this on a different platform but as i mentioned we're going to use the react wrapper so let's go to that now so this is a wrapper that's created by the agora i o community so this is an open source wrapper and what this actually does is just make our life easier so it has all of the agora sdk in it and it comes with a few hooks for react that we can use if you don't know what that is don't worry about it we'll look at those later and just kind of simplifies the sdk for us and wraps a bunch of these functions so you can see right here it's showing us the usage way simpler than if we were to actually try to you know bring in the sdk ourself and then work with all those functions that still is not super complicated but just trust me here this is good to use so what we're going to do is install this wrapper and again this wrapper will have all of this stuff with the agor sdk all it's kind of doing is just wrapping some of these functions and just making them a little bit simpler for us to use specifically in react again if you were not going to use this in react if you were going to use this somewhere else there's all kinds of tutorials on the agora website it is pretty intuitive and simple to do but i found as i was experimenting with this that this wrapper is just going to make our life a bit easier and so we're going to go ahead and use this wrap all right so i'll leave this link in the description but what we're going to need to do to install this wrapper is we're going to go here to our console and we're going to say npm install and actually i'm just going to paste in this command because i have it copied to my clipboard npm install and then git colon and then the link to that repository that i just showed you but this is going to be a little bit different so i'll leave this line in the description of course you can also just type it out here it'll be on the screen for long enough you could pause the video but again this will be in the description type this in press enter and then it's going to install a bunch of stuff now this will probably take a few minutes to run just because there's a ton of modules this is installing the entire agora sdk and then a few other things as well so once this is done i will be right back all right so now everything is installed our dev environment is set up we have our tokens we've set up our agora project we understand briefly what agora does now we can start actually writing some of our react code and setting up this application now this part's not too complicated but we will have to create a few different components have some buttons like turning off the camera turning on the microphone all of that kind of stuff and well anyways we're going to get started here in settings.js so what we're going to do right now is we're going to initialize our kind of agora application so we're going to set up a configuration and we're just going to create what's known as a hook so that anywhere in our react application we're able to access this client object that we need i understand this might seem a little bit confusing if any of you are relatively beginner in react or in just programming in general but just follow along it will start to all come together so we're going to say import and then what we're going to import is create client and create and then this is going to be microphone and camera tracks like that and this is going to be from and this is agora hyphen rtc and i have to spell agora correctly obviously agora hyphen rtc hyphen react now let me make sure i spelt this correctly microphone and camera tracks looks like that is correct okay so we've now imported these two things that we need from agora rtx react okay what we're going to do next here is we are going to export three variables we're going to say export const and then we're going to create a config variable now this is going to store the configuration for our agora application so we're going to say mode is equal to rtc i believe this stands for realtime communication you can also set the mode to like a live stream mode you'd have to look at the agora documentation to see all the different stuff for this config i'll just tell you what the ones are that we're using here the next thing we need is the codec so this is what we're using to actually encode our video we're going to use vp8 now small note here for some reason you're using a really old version of safari or internet explorer or something you probably want to use h.264 i believe the codec here is h264 if that doesn't work i think you can type in just h.264 anyways vp8 is what we're going to use if you don't know what that is don't worry it's just kind of the algorithm that's used to actually encode the video that's going to be displayed we then need to pass our app id so we're going to pass the app id equal to the app id the variable we have up here and then we need the token so we're going to say token colon token okay so we now have our config next what we're going to do is say export const and then this is going to be use client and this is going to be equal to that create client function there that we imported and we're going to pass inside of here config so we're going to create an agora client using the configuration that we just defined up here next what we're going to do is say export const and it's going to be use micro phone and camera tracks like that and then this is equal to create microphone and camera tracks and we're just going to call that function so what these two things actually are right here are hooks now if you're unfamiliar with hooks essentially these are functions that we can call to get access to something now that's a really poor explanation of what a hook actually is but for our context right here what we're defining is this used client and this used microphone and camera tracks hook and so we're going to be able to actually use these hooks from any component that we want to get access to the client and get access to the microphone and camera tracks now this is important because we need access to both of these things from a bunch of different files so rather than passing them through the props of all of our react components or you know kind of messily handling them around and throwing them around our program we put them in one file the settings.js file and then we can access them whenever we want you'll see how we use them obviously as we start using different components but understand that's the point of the settings.pi file so now we can access the config the use client and use microphone and camera tracks from any component without having to kind of pass them around through props and all that messy stuff we'd normally have to do okay we're done with settings.js now we don't need to look at that anymore unless something doesn't work what we're going to do now is go into app.js all right so i'm actually going to stop here for a second and just backtrack a bit i realized that the order i was about to go in for creating stuff doesn't really make much sense so let's do it in the proper order actually what i'm going to do here is go to settings.js to start i'm going to export one more thing so i lied we are going to need to touch this file again i'm going to export const i'm going to export the channel name so i'm going to say channel name is equal to and then this is going to be the name of the channel that we set up which in this case is main so the reason why i'm doing this is because i realize that i forgot to mention this token here is associated with this channel main so if we go back here we go to gora we go to token you can see that we have our channel name main we have our app id and we have our temporary token so as i was saying this token only allows you to join the main channel so it doesn't make sense for us to maybe say ask the user to type in a channel because if we're hard coding our token then we need to hard code the channel the users are going to join in so what's going to happen when we load our app is users are automatically going to be put in the main channel there won't be a choice they'll just go right into one channel but if you wanted to allow users to join different channels what you would need to do is make different channels here in this console there's also a way to do it from code but i'm not going to explain that it's a little bit beyond the scope of this tutorial and then you would ask the user to type in the token and the channel that they want to join once you've created different channels here right so you could say okay type in the channel name type in the token and assuming that token is associated with the channel they would be able to join hopefully that makes sense but just understand that again this token only works for this channel and so we'll have one channel anyone who kind of goes to our application will just automatically be brought into that channel so now that we understand that let me close this i don't know like get ignore is open what we can do is we can just set a few things here in app.js so i'm going to go to app and i'm going to import use state from react all right so we've got you state now and if you're looking at you state and you're like i don't know what this is i'm going to highly recommend that you go and brush up on your react maybe watch a react tutorial because this is probably going to be very difficult to follow along with if you're not familiar with something as basic and react as something like use state so not to discourage you i just want to make sure i don't waste anybody's time if you are a beginner please go brush up on react make sure you're familiar with some of these things because i can't really explain them in this tutorial okay so we've got use state and what i want to do here just set one piece of state that tells me whether or not my user is in a call already now we're going to try to just automatically join the user into a call as soon as they come to our web page but we might not be in there immediately and so we need a piece of state that's telling us are we in the call or are we kind of waiting to join so we're going to say const in call and then set in call and this will be equal to use state and we'll set this equal to false by default now we're going to go inside of here inside of our return so this is the stuff that's actually going to show up on the screen and we're going to check if we're in the call so in call question mark if we are in the call what we'll do is just render some text that says we are in the call otherwise we'll say waiting to if we spell waiting correctly waiting to join call okay now we're going to replace this text here with the thing that's actually going to display the call we haven't created that component yet so let's actually go ahead and do that now i'm going to make a new component and i'm going to call this video call now this is where a lot of the logic for our program will lie you know what while we're at it let's create all of the components that we're going to need so we need video call this will display all of the actual videos all the video feeds we then need our controls so this is like okay we need to mute the microphone we need to stop the camera we need to leave the call that's what controls are and then finally we need a component to actually display all of our video so video.js so video call will render our controls and all of our videos so video represents all the video feeds control is obviously the control and then video call will kind of render both of them and before it renders them it will make sure that we have you know joined the call and all of that kind of stuff okay so let's go inside a video call and let's say export default and then let's make a function and let's call this video call so just making a component this will take in some props and inside of here we're going to start by just decomposing this props so we're going to say const and the one prop that we're actually going to get here is going to be set in call and this will be equal to props so if you're unfamiliar with this syntax what this does is look at props which is an object grabs out the prop called set in call that allows us to use that in here and the idea is that we're going to kind of join the call from this component so once we've joined we will then use this function here to tell our app component that hey we are in the call and so then it can actually render this component fully perfect okay now what we want to do is set a few pieces of state so to set some state we need to import use state so we're going to say import use state and then this will be from react okay so the pieces of state that we want first of all is the users so we want to know what users are currently in our call right so we're going to say const users set users is equal to and then this will just be use state and this will be a list or an array all right next we're going to have our start state so start set start this is kind of similar to in call this is telling us if we can start our video so we'll see how that works again in a minute but actually we're going to set this equal to false to start just another variable that's kind of telling us hey are we ready to go have we initialized everything we'll use this a little bit differently than set and call i can't really show you how it works until we actually get into the logic of joining the call okay then what we're going to do is we're going to import a bunch of stuff from our settings so we're going to say import config we're going to import our use client we're going to import our use microphone come on give me the autocomplete here so i don't have to type at all uh okay let me just go from settings.js and then maybe it will give me my autocompletion because i don't really want to type use microphone and camera tracks okay too bad i did have to type it did i spell this correctly use microphone and camera tracks i think so and then the last thing that we will do actually we don't need to import anything else from this that's all we need okay sweet so we've got all that next we're going to say import and we're going to import grid from this can be app material hyphen ui core now this is what we use to actually kind of lay out a few things that we need here okay so now we have our state for start and for users the next thing we need to do is grab our clients we're going to say const client is equal to and this will be use client now notice we're actually calling this we're calling it as if it's a function what this is going to do is return to us the client object which we can use to connect to the video call next we're going to say const ready and then tracks is equal to and this will be use microphone and camera tracks we're going to call that again just like we called use client and what this will give us is our audio and video track and whether or not they're ready to go ready to be used so when we call this what it will try to do is initialize our audio and video track so we have two tracks here this is actually going to be a list of tracks again one for audio one for video and then we can use these tracks like we can disable the audio we can disable the video or we can show the audio or display the video or whatever right and then this is telling us hey are we ready and the reason we need that is because we have to get permission from the user to use their video and use their audio this handles all of that for us we don't have to you know pop up a dialogue or anything it will automatically ask the user to allow the camera all right so next what we're going to do is we're going to import use effect so essentially as soon as we render this component what we want to do is we want to have an effect here and this effect is going to do all of our kind of initialization so we're going to say use effect this is just going to be a function and then we are going to do this effect whenever the channel name changes which i'm actually going to import from up here that's the thing i was thinking about importing but didn't whenever the client changes whenever the ready variable changes or whenever the tracks change okay so if you're unfamiliar with this when you put a list here this says okay only do this effect so only run this function when one of these things changes so when one of these four values changes then we will actually call whatever's inside of this function for use effect now what i'm going to do here is i'm going to define a variable i'm going to say let knit equal async we're going to take in a name this is going to be the channel name and then this is going to point to a function so we have an asynchronous function again i can't really explain async but this means not based on the clock tick of your computer this has some delay essentially we're waiting on a network operation and inside of here what we need to do is we actually need to define some event listeners so we have our client object we have clients right and what we do with client is we can have some different events that are going to be triggered and that we're going to listen for so there's a bunch of different events here i'm going to go to the agora documentation to show you what some of these events are so let's go to developers let's go to documentation and i'll start walking you through some of the events that we want so let's press on video call here and let's just see what can we look at maybe quick start okay let's go to quick start see what it brings us to we're going to change the platform here to be web all right okay so let's scroll down and let's look for if there isn't a list of events okay so this is actually what i wanted to show you i believe this is i think they call this a sequence diagram i forget what this is actually called maybe an activity diagram or something regardless you can kind of see the flow of what needs to happen here but we need to create the client which we've already done and then we need to initialize the client now when you initialize the client what you need to do is join a channel that sends a channel request to this is kind of like the back end for agora essentially and then after that what's going to happen is we need to create a local stream initialize the stream play the stream and publish it so what we're going to be doing as a client is we're creating a stream of our webcam and of our audio and then what people can do is they can publish or sorry they can subscribe to that stream which means that they can access it they can view it so once we create the stream we publish a stream that's what i mean and then that's going to send the stream data here to the sd rtn then what happens is you can subscribe to a remote stream so people can subscribe to our stream it will then kind of add it to say their react application their video calling app whatever and then they'll start seeing our video stream and so whenever someone joins the room we want them to automatically subscribe to all of the other user streams and we want those users to subscribe to their stream right but we need to handle different events like what happens when someone unsubscribes subscribes from a stream what happens when someone leaves the channel so on and so forth and so that's all the events that we're going to be kind of hooking up right now there's a lot more events that can happen i mean you can read through this the documentation is really good for this but i will just show you the events that we need to kind of set up here so the first event that we're going to have so we're going to have client.on is going to be a user published a stream so if a user has published a stream then what we want to do is we want to call the following asynchronous function now this asynchronous function is going to take in a user it's going to take in a media type now the media type is going to be audio or video so did the user publish an audio stream or a video stream and the reason why this is kind of important here is because users can enable and disable their video streams right so if a user disables their video stream they're going to be kind of unpublishing it whereas if they reenable it they'll be publishing it and so we need all of these events to look for all of that kind of stuff that's going to happen i get that this is really probably confusing for a lot of you but just bear with me we'll get through it and you'll see how it works okay so we're going to say client.on user published we have an asynchronous function and what we are going to do is we are going to await the phone we're going to say client dot subscribe and we're going to subscribe user and media type so we're going to subscribe the current client to the stream that a user just published so a user publishes stream this does not mean we are automatically subscribed to it but now we are aware of the fact they published it we have the user and we have the media type now we can subscribe to it so that's what we're doing here we're awaiting the fact that we subscribe to the stream then we need to check what type this stream was so we're going to say okay if the media type is equal to video we should do three equal signs here then what we're going to do is we're going to change some state here so we're going to say set the users that are in this video call and we're going to get the previous users so we're going to say prev users like that we're going to have a little function that we run and inside of here we're going to return dot dot so the spread operator prev users and then user so what this is doing is this is getting the previous users so whatever was currently in the user's state that's kind of how this works and react when you use an arrow function inside of a state or inside of setting a state story so this gets whatever the previous state was then what we do is we return a new list that has all of the users that were currently there plus the new user that's kind of what this is doing that's what we're returning okay so that's good then what we're going to do after this is we're going to say if the media type is equal to audio like that we can make this an l if two if we want but it's fine we'll just leave it as an if so if media type is equal to audio then what we're going to do is say user dot and then audio track so let's go audio track like that dot play so we don't need to subscribe to the audio track because it's just kind of given us the audio track we have the user the audio track is associated with the user and so we're going to start playing it in the web browser which means now we'll be able to hear whatever the user is saying so again all the stuff you find from the documentation like i said at the beginning this video is just meant to get you up and running as fast as possible and hopefully give you you know some piece of information that are useful okay so we've done that we've now done our first event now there's a few more events that we need to do so the next event we're going to do here is say client.on and we just checked if the user published an event so what happens if the user unpublished or nonevent uh streams right so user and then this is unpublished like that now similarly we're going to have actually not an asic async function this time because we're not waiting on a network operation we're just going to say user type is equal to and then inside of here we'll do kind of the same thing except this time we're going to unsubscribe the user right or we're going to yeah unsubscribe the user so rather than doing type just to keep it consistent i'm going to say media type and i will say if type or media type like that is equal to audio we need three equal signs so if the media type is equal to audio then we want to stop playing the audio so we're first going to just make sure that the audio is playing we're going to say if the user dot audio track then what we will do here is say user dot audio track and then dot stop now the reason we need this little if statement before is because a user could technically leave the web browser or they could have disabled their mic something could happen where we didn't hit this event and the audio track has stopped playing already and so we can't stop the audio track if it doesn't already exist so we just need to make sure it exists before we try to do this just to prevent any potential errors from coming this is kind of good practice to do just always check if something exists before you go ahead and try to stop it or start it or whatever whereas here we don't need to do that because we know if the type is audio we're going to have an audio track and so we can play okay otherwise we're going to check if the type is video so if the media type is equal to video i always do two equal signs that needs to be three then we want to unsubscribe and we also want to remove the user so we're gonna say set users like that we're going to say prev users and then here we're going to return it's going to seem a little bit unnecessary but this is the way we'll do it prevusers.filter we're going to have a function here we're going to take an uppercase user and we're going to say if the user.uid this is their unique identifier i believe that's what uid stands for does not equal user.uid then we will go ahead and keep that in our array okay so i lied here we actually don't need to unsubscribe i believe when a user unpublishes their video stream you are automatically going to be unsubscribed from it because well there's nothing more to look at and so you don't need to manually say unsubscribe you can just remove this user from the user state so keep in mind here there's kind of two pieces of state right we have the state in our front end which is allowing us to display all these different video feeds then there's going to be a state kind of in the back end api or sdk that represents what users are in the room and you know what users have video feeds what streams are published all of that we don't need to deal with that because obviously that's handled by the sdk but here we do need to be able to keep track of what users are in our room or not so we know what streams we should be displaying hopefully that kind of makes sense but at minimum we want to know how many users are in a room and so we want to have this user's array that's storing all those users and so we can get access to their different streams and so what happens is when a user unpublishes their stream well they may have been automatically unsubscribed we may have auto unsubscribed but we need to change the state on the react front end to kind of remove that user and so what this does here is it takes whatever our previous users were from this user state and then it filters this array so what this will do is now create a new array that has all the users in it except for this user right here the one that unpublished their stream okay so that's it for that now we have a few more events that we need to handle so client dot on and this is going to be user left so user hyphen left like that this doesn't need to be async because we're not waiting on a network operation we're going to take in the user and then same thing we're just going to run this set users kind of set state function whatever you want to call so if a user left or if a user unpublished their stream these are kind of the same thing like if a user leaves they do unpublish their stream but it's just a different event that occurs so we need to look for both of them to make sure that we are you know removing the users from our frontend state okay so now we have all of our event handlers kind of configured here so those are configured the next thing that we need to do here is we need to try the follow so we've set our event handlers we're going to say try catch will catch an error and we'll just console.log error just so we can see if an error occurs and inside of here what we're going to try is the following we're going to say try await client dot join what do we want to join well we're going to join config.app id we are going to pass in the name of our channel so name which we'll pass to this asynchronous function right here and then we're going to say config.token and we're going to pass no now uh let me just explain what all these parameters are here i mean all of them are pretty straightforward but we're passing the app id we're passing the name of the channel we want to join we're passing the token to join that channel and then this is the uid of the user that's joining the channel so uid unique identifier you can see we have a unique identifier for all of our users if you leave this null it's going to automatically generate that for you which is what we want but you could manually define the id of the user joining maybe there's some reasons why you'd want to do that but for now we just leave this no but this parameter here is really the uid now it's required so we have to pass something so we pass null but when you pass no it will automatically generate the uid of the user don't have to worry about it too much again it's just kind of the id of the user we could set it if we want but we're not going to do that okay so we've tried that we've logged the error the reason we're trying it is because something could go wrong here we don't want to crash our program and so now what we're going to do is we're going to say if tracks we're going to await client dot publish and what we're going to publish is the following tracks 0 and tracks 1. now we could if we wanted to clean this up just use the spread operator i'll just leave it like this so it's very explicit on exactly what we are doing what we're checking here is okay do we have any tracks if we have any tracks this means that our audio and video has been initialized and so what we can do is we can uh what is it let's see here where am i we can publish it so this is publishing a stream so what we've done is we set up all our event listeners and now once all those are done and we've joined the channel we are going to publish our stream to the channel so anyone else in the channel now that has these event listeners and every client will have them because well that's what we're coding out here they're going to automatically subscribe to our stream that has been published and then they will see our stream so hopefully that kind of makes sense but at the end of setting up all this stuff doing all the configurations here and all our event listeners then we're going to publish the stream then after we publish the stream what we're going to do is we're going to say set ready or not set ready sorry set start equal to true so we're saying okay we've done everything we need to do here we've set up the event listeners we've published the stream and so now we indicate that hey we are ready to start so we say set start now let me just go here and make sure okay i just wanted to look at something quickly to make sure i wasn't going off course here it looks like we're good now inside of use effect but outside of this init right here because this init is a function right what we're going to do is we're going to call this init function so we're going to say if ready and tracks then what we'll do is we will try the follow so we're going to try to init with the channel name otherwise we're going to catch an error we're just going to console.logging so constant log error and sorry we need to constantly log the error message uh actually we can just log the error it's an object but we can look at the object in our console okay so what we've just done right is we've set up this kind of a knit asynchronous function then what we're doing is we're waiting for ready to be equal to true and for our tracks to be there so we have some tracks essentially so really what that means is we're waiting for the user to give us permission to access their microphone in their camera once we have that we're going to try to initialize our kind of video stream with the channel name now the reason we're putting in a try again is just to be extra safe and to make sure that something goes wrong we are good and we have caught that and actually what i realized here is that we could remove this try because technically we're trying this entire thing but i think it's good to have this because this will catch a specific error that happens just when we try to join the channel so we'll leave that in for right now and this effect is going to be called right whenever ready changes and whenever uh what do you call client changes channel name changes or track changes but we're only going to call this huge kind of function that we made here so let a net equal async when ready and tracks have both been initialized okay so we've done all that now what we're going to do is we're going to set up what we're actually rendering on the screen so we're going to return and what we will return here is a grid so we're using material ui this is going to be a container the direction of our grid is going to be a column and we just need to make sure that we set the height of this we're going to say style is equal to and then this is going to be height and we just need to manually set this to 100 okay so we now need to close the grid so slash grid now inside of this grid what do we want to do well we want two grid items here so we're going to say grid and then this is going to be an item that is inside of our grid we're going to say style is equal to and then we're going to again manually set the height of this so we're going to say height colon and then 15 now if any of you guys know some better css than this to you know set heights and do dynamic sizing and all of that please do let me know i'm not very good at css so i'm just using what i can to make this look half decent so sorry the height of this is going to be five percent and the height is going to be 95 now you're probably like what the heck are you doing tim well what i'm doing is i'm going to be rendering the controls and then actually the video right so remember i told you this component handles all of this kind of annoying connection related stuff but then what we are going to do is we are going to render alt videos and we're going to render all of the controls which are going to be in two separate components and so that's what we're going to do here all right so inside of this five percent this is where we're going to put our controls so we're going to check if ready and tracks and and then what we're going to do is render the following if both of those are true so we're going to say ready and tracks and and then we're going to render the component controls we've not defined this yet but we will define this later i'm just going to hard code in for now i'm going to say tracks is equal to tracks we're going to say set start is equal to start and then we're going to say set in call is equal to set in call all right i don't think there's anything else we need to pass there those are the props for that component all right so ready and tracks and done this so essentially just saying okay when we're ready and we have our tracks we'll display the controls then inside of here we're gonna do a similar thing i'm gonna copy this paste it but rather than ready we're going to put start so we're going to say start and then rather than having controls what we're going to have is simply our videos so we're just going to say videos we're going to pass the tracks but we're also going to pass the users so we're going to say users like that is equal to users and then i think that's actually all we need here so let's close that okay so i know again probably confusing i'm even confusing myself there's a lot of code that we need to write here but we're just going to only show the controls and then the video when the corresponding variables are true right so once we're ready and once we are starting okay so just because we have two variables here ready and started i'm just going to stop and explain what these are just to make sure this is clear so what's the difference between ready and start okay so start essentially is telling us we can now view other people's videos so we have these events set up so once we set up these events what we can do is we can view other people's uh videos right once we've joined the channel however we may not have published our video yet so it seems a little bit confusing the thing is we're setting start equal to true regardless of the fact that we publish the video or not because if we do not have any tracks if we have not given permission to our camera or whatever or for some reason we just don't have any tracks to display then we can still view other people's videos but we are not going to publish ours and so that's why we're setting start however we should only show controls for our video if we have a video right so once our video is ready and we have our tracks then we can disable and enable our video but we want to still be able to view other people's videos before that point is ready so hopefully that kind of makes sense but that's the difference like ready is telling us our video is good started saying okay we can now view other people's videos so yeah that's the core difference there i get that that's probably a bit confusing but anyways that's the way that we're going to do this here and a lot of this code i've just taken from official documentation from agora just to make that crystal clear i did not come up with all this stuff off the top of my head okay so now that we have that we need to code out these two components controls and videos right so let's start with controls because i feel like that's the most intimidating one so we'll get the easy stuff f uh done after we do this okay so let's make a new file here and let's call this one controls dot js oh i already have sorry i already made controls.js one step ahead of myself now we're gonna do is import a few things that we need so we're gonna say import it's gonna be used this will be from and react then we want to import use client and this will be from and then dot slash settings like that perfect then we want to import grid so we're going to say import grid button and icon from and this is going to be at material hyphen ui core okay perfect and then what we actually need to do now is we need to import a bunch of icons now i'm going to copy all of these so let's copy them all right now okay so mic icon mic off icon video cam icon video cam off icon exit to app icon i don't think i need to explain why we need these icons i mean they're going to just be the icons we have for our different buttons and now i realize that we need to install the material ui icons package so what we're going to do is just type npm install material ui icons app material ui icons okay this is going to take a second once it is done i will be right back all right so now we have material ui icons installed now we're going to start coding out this component so export default function controls take in some props like that okay we're going to use our client so const client is equal to use client like that const and then tracks set start and set in call is equal to props perfect and then const track state set track state is equal to u state and this is going to have two things it's gonna have video true and audio true okay perfect let me make sure that's correct i think that's all we need nice okay now we have all those things initialized what i'm going to do now is just code out what this is actually going to look like right so we're going to say return and now it's going to be a little bit of html madness going on here where we make a grid and we place some buttons and some icons essentially i want three buttons right i want the button to turn off the mic the button to turn off the camera and the button to leave the call so i'm going to say grid container spacing equals 2. if you're unfamiliar with this you can reference the material ui documentation but what this does for us is set up a nice grid using i believe it's called flexbox so this just kind of has some default css classes for us so rather than me having to go through and write all the css we can just use this grid so you know it's kind of as it explains by default a grid is going to be in a row size so we're going to have things showing up horizontally on the screen but i think you saw previously i think i did it here i set up a grid that was the direction column so things were going vertical in the screen anyways that's the difference column is vertical grid is horizontal okay now we're going to set up some grid items so we're going to say grid item notice that items go inside of containers right so we'll have two grid items actually we'll have three grid items sorry so three grid items and inside of each of these items we're going to have some buttons now of course align item center it's going to put all our items in the center of the grid which is what we want now we're going to have a button this is going to be the variant which is equal to contained there's a few other variants again you can find all this stuff in the material ui documentation uh it's not super important so i won't really cover it we're going to have the color the color is going to be equal to dynamically red or blue depending on if the audio is on or off right so this button the first button here is going to be for our mic so we'll have the color that is equal to track state oops dot audio and if the track state dot audio is on so if that's true then we're going to show the color primary which means blue right and then we're going to show the color secondary which is kind of like a red color again look at material ui documentation if you want to see all of this okay so we have our button now this button is going to be called i guess actually we're not going to have a name for this button so we're just going to put an icon for it so we have two icons right we have mic icon and mic off icon so depending on the same condition here if the audio is on then we want to show that the audio is on otherwise we want to show that it's off so there's two icons we can show here the first icon we'll show is the mic icon if the audio is on otherwise we will show i'll just copy this and change it to i think it's called the mic off icon mic off icon let's see yeah that looks like that is what it's called okay sweet so we're going to show the mic on if the audio is on otherwise mic off all right so now what i need to do is add an on click here so i'm going to say on click and this is going to be an arrow function so on click is equal to an arrow function and this is going to call another function that we've yet to define called mute it's going to pass in audio now what mute is going to take is audio or video so the string audio or video if you pass it audio uh then it will mute the audio otherwise it'll mute the video right pretty straightforward okay so let's copy this button because the next ones are going to be almost identical let's put two more here and this time rather than having audio we're going to do video so we'll just change all of this to say video like that and the icons need to change too this all got got to change to video now we're going to use video cam icon and video cam off icon okay so let's change this to video cam icon and this will be video cam off icon sweet just notice i changed everything to video okay so now our last button is going to be the leave button so what this is going to have is it's just going to say leave like that and then we will actually have an icon beside leave i think that the leave icon is not super intuitive and so i want to add some text there as well okay now we will just use the uh exit to app icon that's like a little you'll see what it looks like but it just looks like you're leaving that's why i picked it okay so now for the color for this one it's not going to be dynamic it'll just be the same because once you press that button you're going to leave it we're going to call this default and then it's going to call a function called leave channel like that now we actually need to call it so there you go okay so now we have all of our buttons so again contained default we're calling the leave channel function which we'll define in a minute and i realize that we no longer need this icon i thought we were going to use that but i guess you can just define the icon like this okay so now let's write out those two functions so we need that mute function and we need that leave channel leave channels easiest so we'll start with that so we'll say const leave channel is equal to async and then yeah that will be brackets like that and inside of here we're going to say await client dot can you guess what it is it's leave pretty straightforward just leaves the chat then what we want to do after this we need to remove all the event listeners so we're going to say remove all listeners so if we go back to video call see how we set up all these on whatever event listeners what this does is it just removes them to make sure that we don't have all of these kind of lingering event listeners and we've already left the channel okay then what we want to do is we want to close our audio and video tracks so we're going to say tracks 0 dot close and tracks 1 dot close or one of these will be audio one of them will be video i can't remember which one's which but it doesn't really matter because we kind of do the same thing for both of them and then we're going to say set start is equal to false and set in call equal to false perfect okay so now we've done the leave channel next thing we want to do is mute so we're going to say const mute is equal to async this needs to be asynchronous because you're going to wait on a network operation here just like this one was async as well right so we're going to take in a type so the type is going to be either audio or video then depending on what it is we'll disable that audio track or video track so we're going to say if type is equal to audio then what we want to do is say await and it's going to be tracks zero so there you go zero is going to be the audio track dot set enabled and we're just going to set equal to our set enabled sorry to whatever the opposite of its current state is so we're going to say track state dot audio not track state audio so essentially you know if this is true if audio is playing then we're going to set it to false otherwise set it to true i think you guys get the idea then after that we're going to say set oops set track state like that and we're going to take in whatever the previous state was so that's ps previous state and we are going to return a new object with the previous state but this time with audio equal to and this will be not ps dot audio okay we're going to do almost the exact same thing for video so let's just copy it go down here we could change this one to elsif if we're feeling uh feeling creative here so it goes to else if now this can go to video make this tracks one rather than trackstate.audio you guessed it it's going to be video now rather than audio this is going to be video so not ps stop video okay there we go we are now finished the mute function finish the leave channel function and we are done with this component okay so this component is good now we need to do the video component this one is a little bit simpler than the other one yeah it's actually not too much that we need to do here i'm just going to take a quick break here and review some of this code to make sure we haven't made any major flaws or mistakes and i'll be right back all right so we are all good we are now going to do the video component now i apologize that we can't really run the app right now we just have to code a ton because we can't really see anything functioning until all of this stuff is done kind of sucks but at the same time it's fine let's just scale the code done and then we can enjoy the application after all right so what we're going to do now is we're going to import the agora and this is going to be the video player from the wrapper we installed so agora hyphen rtc hyphen react wonderful then we are going to import the grid from and this can be at material hyphen ui slash core and then we're going to import oops let's go next line here going to import use state and use effect from react nice okay let's make our component export default function video props and let's define some state or sorry let's grab some stuff from our props so we want users and we want tracks remember we pass these through the props to video this is equal to props we're then going to say const this is going to be grid spacing set grid spacing you'll see why we need this in a second but the idea here is that in our grid in our material ui grid we have 12 potential positions four items in the grid so if you're looking at the grid in terms of uh horizontally right so like width of the screen you can have 12 items in a grid so the thing is we can define how much space an item uses in our grid out of 12. so to start when it's just one person in the room they'll take up the entire grid right they'll take up all 12 squares in the grid but as more people join we need to shrink them so we need something representing our grid spacing and we'll have this set to 12 to start and then we'll divide it so we'll divide 12 by the number of users in our room to define how much space each person the grid is taking up now as soon as someone starts taking up like less than a certain amount of space we will increase the size of the grid vertically so we'll fill up specifically three people in one row and then as soon as three people are in one row we'll automatically move down to the next row and that's why we're using this grid because grid is really easy to do this in and you'll see it's not super complicated but we just need to define you know how much space each person's taken up okay so we're gonna define use effect now inside of use effect we're gonna say set grid spacing and we're gonna set the grid spacing equal to the math dot maximum of the math dot floor this is just to avoid any what is it floating point division and we're gonna say 12 divided by our users dot length plus one now the reason we're doing this is because we are a user and technically our users uh does not define ourselves so we have users.length plus one to represent that hey we're in the grid two and then after this what we do is we're gonna define in the max function right 4. so we're going to say okay if we have 12 users we don't want each user only taking up one grid square we want them taking up 4. so if we have actually less than 3 users here then we'll take whatever this division is otherwise we're going to take 4. so hopefully you guys can understand that math there but this is just a dynamic way to do it and then we're only going to do this effect whenever the users change or the tracks change so if we disable a track right then we'll stop showing ourself in the grid actually sorry we're not going to stop showing ourselves but someone else will stop seeing us and anyways you'll see how it works but technically a user could disable their mic without leaving the chat right and so if or sorry not not mic video so if they disable their video but they haven't left the room yet or left the channel then we want to stop showing them in the grid we could show them with the black screen if you wanted to do that then you would just remove tracks from right here but i don't want to do that so i'm going to do it this way okay so now all we have to do is just return whatever we're going to render here so i'm going to return i can make my grid and say grid this is going to be item and container actually sorry this should just be container grid container this is going to be style equal to and we need to set the height of this as well so i'm going to say height 100 now any of you guys that are better at me at css like why are you setting the height to 100 well unfortunately this agora video player here i was having some difficulties with it i'm sure some of you guys are smarter than me can figure this out but pretty much i realized that i just need to set the height of everything to be a hundred percent otherwise this has a height of zero so my limited knowledge of css tells me that the parent of this is what the size of this thing is going to be and so if the parent doesn't have a defined height if it's not set to some specific height then this is just going to be a height of 0 because usually what happens is your container will take up the amount of space that the children are taking up right if the child's a height 100 then the container here will be height 100 but in this case the agora video player gets its height from the height of the container that it's in and so we need to set the height of the container which is annoying but we can figure it out and that's actually the reason why here we have the root being equal to 100 vertical height the reason i had to do that is because we need to have somewhere some absolute height in this case hundred vh is actually going to kind of stand for a pixel value so vh is like the number of pixels the vertical height of the screen right and so we're saying 100 of the vertical height and so really this will be equal to some pixel value and so that means that when we set all of the divs going down to 100 height they'll all be equal to that height as well and so eventually when we get to video our containers that are storing these videos will be able to actually have a height i'm sure no one understands what i just said there but that's my rationale just want to explain that so you guys don't think i'm too crazy okay now we're going to make our grid items so this item is going to have spacing which is equal to grid spacing so in case you're unfamiliar with how you do this xs stands for extra small you have md i think or m or something that stands for medium you have lg which stands for large i think you have like xlg or yes something like that you'd have to look it up exactly on the material ui documentation but what i'm doing right here is saying okay when the screen is size extra small or larger we are going to have this item taking up this number of grid spacing squares and we're setting that in this state variable right so whatever we get from this math here that's how much space is going to be taken up by this grid item so anyways that's the rationale there xs is just saying okay take up this much space in the grid now you could define like when the grid is larger take up less space or take up more space but when you just set xs this automatically sets it for all the other ones too so if you set xs for a medium size screen or for a small size screen for a large size screen it will set the spacing the same but you can individually define what you want the spacing to be for all different types of screens okay so again reference the material ui documentation i'm going to keep saying that but if you guys have made it this far i think you'll be able to look through the documentation and figure that out pretty easily okay we're gonna have two great items here so we have this grid item and then we're gonna have another grid item now the first grid item here inside of here we're gonna put an agora video player now this is going to be us so we're going to say agora video player when i say us i mean like whoever is the client it's going to be their video the other stuff that i'll show you in a second will be everyone else's video so be agora video player and then we need to define a few things in here so we're going to say that the video track is equal to and then this is going to be tracks one our video track right so tracks one and then we're going to say that the style is equal to and this is mandatory you need to put this if you don't put this it's not going to work height 100 width 100 now if you want this to be smaller of course you know adjust these values you can make them pixels too uh but to make it dynamic you want to be a percentage so we're going to say height 100 with 100 so fill the entire size of this grid container okay so now we have another grid but what i want to do is i want to generate a grid item for every single user's video feed so what i need to do here is i need to map all of my users to a grid item so i'm going to say users dot length is greater than zero and and users.map and i'm going to take in a user and then what i'm going to do is return if the user has a video track so if user dot video track like that i am going to return the following now i realize i need i uh what is it curly bracket here so put a curly bracket there put another one here and we are going to return a grid item so lets grab that grid item let's put it here let's save let me see what it's showing us is wrong here okay so i just have my bracket in the wrong order here just got to put a bracket there and i think that's good now yeah okay there you go so now we're good so now inside of this grid item we can put what we want so it's going to again be an agora video player so let's copy that it's gonna have to have the height of a hundred and hundred and then what we're gonna have is the video track which is equal to rather than tracks one user dot video track okay so it's equal to user.video track and then what we want to do here is we want to also have a key now whenever you use like a map which is what we're doing here in react every child object is supposed to have a unique key so in this case the key is going to be user.uid this is just so that you don't get screamed out in the console okay now otherwise though because we have this if right we need to have something else so we're going to say else return no so just don't do anything so essentially if we have no users just don't do anything you can just stop now why what is wrong here what is this saying um i think this should be good okay yeah so i don't know i think vs code is glitching out because this is fine okay so that in theory is all we need to do except for a few very small things in app.js so let me zoom out here just so you guys can see this i'll go through the files for one second so you guys can look at all of them but again i have all this stuff in a github repo so feel free to check that out from the link in the description okay so this is video this is controls although it's kind of large so i can like scroll through it a little bit so you guys can see it this is video call okay and this is app.js all right so let's continue here we're going to nap dot js now we need some way to actually enter into our video call room so what we are going to do is we're going to make a button here so we're just going to say import and we're going to import a button from and this is going to be at material ui core we're just going to put a button above this we're going to change this right so that's something else we're going to put a button and this button will be a variant equal to contained its color will be equal to primary and then we'll have an on click say on click is equal to this will be an arrow function what the arrow function is going to do is it's going to call set in call equal to tr okay and then here we're going to say join call like that and then if we are in the call what we are going to do is we're going to render the video call components we're going to say video call like that and then we need to pass through this video called component set in call as a prop so setting call is equal to set in call okay we need to import this video call component so we're going to say import video call from dot slash video call and now we're going to run the app and we're going to see how many errors we made now i'm not super optimistic just because it's a lot of code we wrote without testing it but let's start the application and let's see if this actually works all right so as i suspected we have a few errors first error is a go to video call.js we have to put dot before this settings.js import it was saying we couldn't find it because we didn't have that dot now you can see there's other errors popping up in video call which is right here we forgot to import controls and videos so let's do that we're going to import videos from dot slash videos make sure you have dot slash then we're going to import uh what's the other one we needed controls from dot slash controls uh controls not control okay let's see what air we get now okay uh cannot resolve videos ah so this is video not videos nice just messing up the players okay videos is not defined yes that would make sense if we go down here i've called this videos when this is actually just called video okay compiled with warnings that's good warnings are always good because they're not errors okay so now let's go here and let's refresh okay so it says join call waiting to join call uh one of the prettiest uis you've seen i know okay so let's press join call and now look it says use your camera wants to use your camera so we'll press a lot should ask me for the microphone too okay so now it's showing me all of the controls but it's not showing the video now i think i know why but let's go to the console here and see so failed prop type align items of grid must be used on container okay failed prop type spacing of grid warning receive true for a nonboolean attribute container okay and we go through here everything else actually looks like it's kind of working now the video i believe we're just not seeing right now i'm going to show you how we can see that in one second this is actually a decent start considering the amount of code that we wrote okay so let's go back here and let's fix a few things now actually let's just press these buttons and see if they work okay they do work you can see that they toggle back and forth and then if you press leave set start is not a function that's fine we'll fix that in one second okay okay so i'm not necessarily tackling these errors in the order in which we saw them but first error here line 73 in video call this needs to say set start not start so i'm not sure if uh if we saw this but when you press the leave button it didn't work because we apparently could not set start because well we didn't have said start so it's in video call.js line 73 make this set start now the other error we were getting here was related to the fact of our grid so it said align items and spacing are not valid things here for our grid oh maybe i have container equals true i don't know where i would have done that container equals true let's try this container equals true can we just look for container okay container here container here hmm okay it's saying something about container equal true let me look into this and then i will be right back all right so very silly error here just a typo so if you go to line 39 you see i had cannot tinner it should be container like that and then that should fix our ui so again line 39 change that to container rather than the typo that i made although i'm sure you guys would have fixed that anyways okay so let's press join call and now notice that it joins now the join uh button is not disappearing which we need to fix but we can see that our menu buttons or whatever you want to call them controls at least they're they're showing up nicely now if we press leave that does work because we fixed that so let's do a few more changes here so let's go to app.js and let's make it so we only see this button if we're not in the call right so rather than saying waiting to join call let's just put the button right there there we go that will have fixed that error for us now what we need to do is make it so we actually see our videos now i am actually certain that the video is appearing i know that seems like a lie because you can't see it but it's because we haven't set the height of one of the divs that i remember i forgot to do so if we go actually i don't think it's here no it wouldn't be in controls i believe will be in video call we have the container height equal to 100 we have this height equal to 95 but if we go to app.js notice how we did not set the height of this div so what we actually need to do here is to say style equals and then height colon and then this should be 100 okay so if i do this now i believe this should work for us could be incorrect but let's try this so if i press join call let's see okay i can see my webcam turning on and there we go i can now see myself on the screen so notice how i'm taking up the entire screen when it's just me in the call right so this is very good we've actually done a lot of what we need to do now if i stop the video notice it it turns off right and if i stop the mic then you would stop hearing it now the thing is uh you can actually test if the mic is working by joining in another tab which is exactly what i'm going to do so what i'm going to do here is just copy this go to another tab here and paste it local host colon 3000 and you'll see now when i join this that another thing will pop up so when i press join a call you'll see now there's two of me right and notice that the one on the left is mirrored in a different way than the one on the right the reason for that is when it's showing you yourself it's different than when it's showing it to someone else right kind of like looking in a mirror so you can see like how it's it's all kind of you know wonky and weird and like you can do stuff like that anyways that's because the one on the left is you like if i do this notice how it shows a black screen but then if you go over here then we can see other two people okay so now what i'm going to do is just show you if i stop the camera here and i go back here notice it's just showing me now the reason it's just showing me is because here i stopped the camera and so since i stopped the camera it's not showing the other person because their camera is off so let's join from another tab so when i join another tab just press join call notice now it's going to show two people because one person's camera's off if i go here it's showing three though the reason it's showing three is because there's three people in the call and this is my camera which is off now if i turn this back on and i go here you can see there's three people now let's see what happens if i join again so if i join one more time so we join a fourth time uh okay it's showing up still in the grid this isn't what i wanted to happen actually i'm gonna see how to fix this in one second um okay let's join one more time though just test this out okay so if we join a fifth time now it's showing five people okay so something is going wrong a little bit that we need to fix so let's leave the call you don't actually have to press leave call you can just you know manually leave and it should work but regardless hopefully you guys are happy with this at least so far because that's pretty cool and that took us a long time to make okay so let's fix this let's go to video.js and let's fix our spacing here for this grid so i am a little bit confused why it's not showing us the correct spacing here i think i may have messed something up here so i'm just going to reference some of my other code have a look at this and i'll be right back ah okay so i have found the issue here one missing bracket always seems to do it okay so i need to put this bracket here at the very end so i had i had three brackets here when there's supposed to be another one here and so like the math which is incorrect here on set grid spacing so that's why the grid spacing was all messed up okay so i think that was all i needed to fix actually trying to think if there was anything else uh but i think that's it for now okay so let's go back here and let's join the call okay give it a second shows me okay let's join again uh oh press join call okay there we go now we see two people we're just gonna have to test it with four people let's see if it works okay join there's three of us okay join and always we gotta have to press join call and now notice how the grid goes down right so now notice how it's showing more people and obviously as you expand this you're going to see more of each person because it's cropping the camera as you're like resizing the window right if i go really small you can see obviously not the most responsive design in the world but at least it shows everybody okay let's just join one more time just because i know you guys want to see my face again in the grid here okay there you go all right let's join a sixth time and boom there you go now you can see six of me and obviously you know you can stop your camera right and then if you go here there's only five people in the grid and while you guys can mess around with this as you please okay so let's close all of these just leave leave leave leave and leave beautiful okay so now that we've done that i want to show you how we can connect this application to a public url that anyone can access because right now we can only do this on our local area network if i'm not connected to this network and i try to access that well it's not going to work okay so remember i was telling you that we need to download ngrok that's what we're going to do now so go to the internet search ngrok link will be in the description by the way and just download this now if you already download this that's great but you're going to press get started for free it's going to obviously download for your operating system this is going to download a zip folder now what you need to do is you need to take the file out of the zip folder there's going to be a file it's called ngrok.exe inside of the zip folder take it out drag it somewhere else easiest place to put it to your desktop you can put it wherever you want okay then what you need to do is you need to navigate to the directory that you have this file in from your terminal or from your command prompt so a little shortcut on windows here if you open up windows explorer and you type cmd into the path that you want to open so see i'm on my desktop right i'm on my desktop if i go here and i type cmd it's going to open up a command prompt that is in my desktop so you can see that i have i'm on desktop right users tam desktop that's the path obviously you guys probably know how to change directories using cd so you can do it that way too but anyways what you want to do is just get into the directory where you have this ngrok file not the zip folder the file it could be the same directory but you got to take that file out of the zip folder so now what i'm going to do is i'm going to cd into agora because my file is somewhere else and now inside of here i think i can do this you can see that i have the ngrok.exe file now dur just tells you all the files and directories that are in the current directory and so i have ngrok.exe so what you're going to do here is you're going to type ngrok dot exe but before you type dot slash actually yeah we'll see if that works dot slash ngrak.exe you're going to type http and then you're going to type 3000. now what this is going to do is it's going to give you a public url that points to your computer's port 3000 and so that means that anyone else can access your web server which is running on port 3000 that's why i'm typing 3000 because that's where react is running uh from this url so let's press enter and okay dot slash is not recognized as an internal external command if you're on mac or linux you can do that if you're on windows you just type ngrok.exe http space 3000 or whatever port your react apps running on and then what you're going to see here is it's going to give you these two forwarding addresses right i think they're actually just the exact same so what you can do now is you can copy this url okay and make sure you take the https one actually you need to do this on https if you do this on http it's not going to work you need https uh just remember that see how this expires in two hours that's what i was talking about the expiry you can just restart the command after two hours and you'll get a new url but this one's gonna you know expire after that mount so what i'm gonna do now is go to my web browser and i'm going to paste this okay so when i paste this you can see brings me to my website right so this is a public url anyone can access this give this to anyone friends family whatever do it from your phone and press join call it's going to ask you to allow this because it's a new url so i'm going to allow it and there you go see working totally fine now even if i go to localhost so i go localhost colon3000 and i join the call here you're going to see that this works so even though they're on two different urls it's the exact same thing because this url is just pointing to localhost so that's what ngrok does and that's really all i need to show you that's pretty much going to conclude this video so obviously here you can disable the microphone turn on the camera blah blah and yeah i guess that's really all i needed to say okay so yeah that's going to conclude this video right here i apologize that this was kind of all over the place but that's just you know what happens when you work on a really large project like this hopefully this got you guys up and running with agora and got your react video webcalling application working this was a really fun project for me to work on and i'm happy i was able to share it with you guys so one last thank you to agora for sponsoring this video let's actually head over to their website here this is a really cool platform as you guys saw we're able to do all of this stuff for free i didn't pay for this they didn't give me like a higher level account or anything like that uh the documentation is actually really good and as i was saying you can create so many different cool things right live streaming video call voice call recording realtime messaging you can look at all the analytics so if i go to my dashboard here which i'm on and i go to products and usage you'll see that you can see exactly how many minutes you've used uh your hd full hd 2k 2k plus resolution video whatever and then you can see in like what channels and stuff and there's more um what do you call it analytics that you can look at as well just kind of giving you an idea that this is what you can do on the platform all right so that is going to conclude this video i hope you guys found this helpful if you did make sure to leave a like subscribe to the channel and one last thank you to agora for sponsoring this video
