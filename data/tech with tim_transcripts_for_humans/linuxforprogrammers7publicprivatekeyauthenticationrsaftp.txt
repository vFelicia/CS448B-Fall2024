With timestamps:

00:00 - hello everybody and welcome to another
00:01 - video in this linux for programmers
00:03 - tutorial series
00:04 - in this video what we'll be doing is
00:06 - talking about public and private key
00:08 - authentication for our server
00:10 - so making it so we no longer need to
00:12 - type in the password for
00:13 - our user but instead we are
00:15 - automatically authenticated using this
00:17 - special method which is kind of a
00:19 - key pairing which i'll discuss more as
00:21 - we get into that we'll also be talking
00:22 - about how to access our file from ftp
00:25 - so how we can use the file transfer
00:27 - protocol to transfer files to
00:29 - and from our server so that's what we're
00:31 - going to be going through in this video
00:32 - let's get into it after a quick word
00:34 - from lenode which is the sponsor of this
00:36 - video and this series
00:38 - now as i've said many times now lenode
00:40 - is one of the best companies to use when
00:41 - hosting a website domain or personal
00:44 - project they have all kinds of
00:45 - integrations specifically for
00:47 - programmers like deep support for
00:49 - kubernetes and other developer things
00:51 - like
00:51 - docker the node just makes it really
00:53 - easy to spin up servers i've been using
00:55 - them for about two years
00:57 - i have literally zero complaints and
00:59 - whenever anything goes wrong or i need
01:01 - help i reach out to their customer
01:02 - support team which is active 24 hours a
01:04 - day
01:05 - seven days a week 365 days a year
01:08 - so claim your 100 free credit towards
01:10 - the node by clicking that link in the
01:12 - description
01:13 - now before we move forward a reminder to
01:14 - sign up for the last five videos in this
01:16 - tutorial series
01:17 - you know where to go but there is a link
01:19 - in the description you can register with
01:20 - your name and email and then you will be
01:22 - notified when these videos are available
01:24 - on this platform
01:25 - lastly there is a guide for this video
01:27 - this is actually a very helpful guide
01:29 - especially if you just want more
01:30 - information about the stuff that i'm
01:31 - talking about here
01:33 - link will be in the description
01:43 - all right so let's dive in the first
01:44 - thing that i'm going to do is i'm
01:45 - actually going to show you how to on
01:47 - mac set up this rsa key pair and log
01:50 - into your server
01:51 - using public and private key
01:52 - authentication we'll talk about this
01:54 - more after i hop onto the mac
01:56 - then after that we'll go through windows
01:58 - then we'll talk about the ftp
02:00 - there'll be some time stamps in the
02:01 - description so you can kind of fast
02:03 - forward and look at the relevant
02:04 - sections for you
02:05 - anyways let's go over to the mac so i'm
02:07 - here on the mac what we're going to do
02:08 - now is set up an
02:09 - rsa key pair which is simply a public
02:12 - and private key
02:13 - now in case you're confused what's going
02:14 - to happen here is we're going to
02:15 - generate the public and private key
02:17 - we're going to store the public key on
02:19 - our server we're going to store the
02:20 - private key on this machine
02:22 - now what's going to happen is when we
02:23 - sign into our linux machine
02:25 - after we set up this public and private
02:27 - key all we'll need to do is pass the
02:29 - private key to our machine
02:31 - and in fact we won't have to do this our
02:33 - like operating system will just
02:34 - automatically do this for us
02:36 - and then it will compare the public key
02:37 - and the private key together
02:39 - and if there is a match then it will
02:40 - authenticate us and let us sign in
02:42 - this is typically a more secure way to
02:44 - do things because if you have just a
02:46 - standard passphrase to sign into your
02:48 - computer
02:48 - or sign into your machine that is
02:50 - vulnerable to brute force attacks i can
02:52 - say personally one of my servers was
02:54 - actually hacked with the brute force
02:56 - approach
02:56 - so typically after you do this what you
02:58 - will do is you will disable password
03:00 - login
03:00 - so you can only log in with a public and
03:03 - private key pair
03:04 - i'm not going to show you how to disable
03:05 - the login in this video it's pretty easy
03:07 - to do so i'll let you look that up if
03:09 - that's something that you want to do
03:10 - but this will at least show you how to
03:12 - set up the public and private key
03:13 - authentication
03:14 - and just make your life a little bit
03:15 - easier when signing into your server
03:17 - anyways
03:18 - i've gone through a lot here but let's
03:19 - just dive in so the first thing we're
03:21 - going to do is see if we already have a
03:23 - public and private key pairing on this
03:24 - machine
03:25 - now the reason we need to do this is
03:26 - because if we do we don't want to
03:28 - override this so we're going to type
03:30 - ls and then tilde slash then dot
03:33 - ssh and then slash and after that
03:36 - id under rs sorry not under but
03:39 - underscore
03:40 - rsa and then an asterisk what this is
03:42 - going to do
03:43 - is search for all of the private and
03:44 - public key pairings on our machine
03:46 - we're looking in the home directory of
03:48 - our user and again this is specific to
03:50 - mac this isn't going to work on windows
03:51 - and we see the dot ssh folder and then
03:53 - we have two files id
03:55 - underscore rsa and id underscore rsa.pub
03:58 - for you chances are you don't have any
04:00 - of these files if you don't just
04:02 - continue on with the rest of the video
04:04 - now if you do have these two files do
04:07 - not do the following step that i'm like
04:09 - don't write the next line that i'm going
04:11 - to write
04:11 - the reason you don't want to write this
04:13 - line is because this line is going to
04:14 - generate
04:15 - these two files now if you generate
04:18 - these two files and two already exist
04:20 - you're going to override them
04:22 - if you override them you're going to
04:23 - lose your private and public key
04:25 - which means you will lose access to any
04:27 - machine that requires this public and
04:28 - private key
04:29 - so again do not write this line if you
04:32 - have any
04:32 - ids here or any public and private key
04:34 - already installed on your machine
04:36 - if you don't have anything so you type
04:38 - this command and you don't see anything
04:39 - popping up
04:40 - then you can write the following line i
04:41 - just want to make sure that's really
04:42 - clear because i don't want any of you
04:44 - guys to lose access
04:45 - to any of your linux machines so what
04:47 - we're going to type after this
04:48 - assuming that we don't have these two
04:50 - files again is ssh
04:52 - hyphen and then key gen and then hyphen
04:55 - b
04:56 - and then 4096. what this is going to do
04:59 - is generate these two files the private
05:01 - and public key
05:02 - it's going to store them in our ssh
05:04 - directory and then with the two
05:06 - following file names you can see right
05:07 - here
05:08 - by adding this hyphen b 4096 we're
05:11 - increasing the amount of bits or the
05:13 - amount of bytes that we're going to use
05:14 - for our keys just so that it's more
05:16 - secure so we bumped it up to 4096
05:19 - as opposed to i believe the default
05:21 - which is 2048.
05:22 - anyways we're going to press enter what
05:24 - this is going to do is generate the
05:26 - public and private key
05:27 - and now we have the option to encrypt
05:29 - our private key or to save it to a
05:30 - different file
05:31 - so if you want to save it to a different
05:33 - file then that's fine you're not going
05:35 - to override these two files right here
05:36 - so you could say id
05:38 - underscore rsa1 or id underscore rsa
05:41 - whatever you don't even have to call it
05:42 - id rsa you can call it whatever you want
05:44 - if you just hit enter which is what i'm
05:45 - going to do
05:46 - by default it's going to tell you do you
05:48 - want to override the file that already
05:50 - exists
05:50 - if it exists if it doesn't it will just
05:52 - save to this file name id underscore rsa
05:55 - so i'm going to override my file because
05:57 - i actually don't care about these ones
05:58 - this was just testing before the video
06:00 - and then it's going to ask me if i want
06:01 - to enter a passphrase
06:03 - now a passphrase is different than a
06:05 - password what the passphrase will do
06:07 - is decrypt your key so that it can be
06:09 - sent to the server
06:10 - so typically you want to have a
06:11 - passphrase just so that if someone gets
06:13 - access to your private key
06:15 - they're not able to access your server
06:16 - unless they know the passphrase so i'm
06:18 - just going to make my passphrase like
06:19 - one two three four
06:21 - something really basic but again you
06:22 - would obviously make this more secure
06:24 - all right so now our passphrase is in
06:26 - and we've generated our key
06:28 - now again to check where this key is
06:29 - well it's just going to be in your dot
06:31 - ssh folder
06:32 - and then you can run this command and
06:33 - well you'll see it pop up you also could
06:35 - just cd into the dot ssh folder
06:37 - in the user's home directory and on mac
06:40 - tilde again represents the home
06:41 - directory just like on linux
06:43 - now if you already had a key file stored
06:45 - so you already had your id underscore
06:47 - rsa and iot underscore rsa.pub
06:50 - you don't need to generate a new one you
06:52 - can just use that same key file
06:54 - for your server so you can use the same
06:55 - key file for multiple machines
06:57 - now is that recommended i'm not quite
07:00 - sure that's up to you do you want to use
07:01 - the same one or not
07:02 - i mean that's kind of your preference
07:03 - but if you want to use the same one you
07:05 - don't need to generate a new one if you
07:07 - want to use a different one when you
07:08 - type that command
07:09 - just be very careful and make sure you
07:11 - select a different file name for the key
07:13 - and you know what that file name is
07:14 - because that's going to be important in
07:16 - this step
07:17 - okay so now that we have this we're
07:18 - actually going to ssh into our machine
07:21 - and add this key to it so to add this
07:24 - key
07:24 - to our linux machine we're going to type
07:25 - the following ssh
07:27 - hyphen copy and then hyphen id
07:30 - and then we're going to put the username
07:32 - at and then the server ip address so i'm
07:34 - going to say root
07:35 - at and then 172.105.25.135.
07:40 - now your ip address is obviously going
07:42 - to be different but you're probably
07:43 - going to sign in as the root user unless
07:44 - you want to use one of the other users
07:46 - you've created
07:47 - so anyways we'll say ssh copy id and
07:49 - then the user that you want to add this
07:51 - key for so i'm going to add this for the
07:53 - root user but typically you add this
07:55 - for a other user on your machine you
07:57 - don't usually add
07:58 - these public private keys for the root
08:00 - user but we're just going to do it for
08:01 - this video
08:02 - and then you press enter now what this
08:04 - is going to do is it's going to copy
08:05 - your public key
08:06 - to your linux machine so it's going to
08:09 - ask you for the password for the root
08:10 - user so type in your root user password
08:12 - or whatever other user you use to sign
08:14 - in here press enter
08:16 - and after you do that all of a sudden uh
08:19 - the
08:19 - private and public key will be active on
08:22 - this machine
08:22 - so you will now be able to sign into
08:24 - your linux machine without entering a
08:26 - password
08:27 - rather you'll enter the passphrase to
08:29 - decrypt your private key
08:31 - now i know this is a lot of information
08:33 - just to reiterate here
08:34 - typically you don't do this for the root
08:36 - user i'm just doing it for the root user
08:38 - for this video just because it's easier
08:39 - and
08:40 - i forget the other users that i've
08:41 - created to be honest with you but
08:43 - usually you would create a new user it
08:44 - would be a
08:45 - pseudo user so you would add it to the
08:47 - sudo group then you would do this for
08:49 - that user
08:50 - anyways i just wanted to make sure
08:51 - that's clear that traditionally this is
08:53 - not done for the root user
08:54 - so anyways now we've added that key so
08:57 - what we're going to do next is we're
08:58 - going to see how we actually
08:59 - sign into the machine now so now on mac
09:02 - to actually get into this device we're
09:03 - going to say ssh
09:05 - and then our username so root and then
09:07 - whatever the server i p address is so
09:09 - actually i'll just copy this right here
09:11 - and remove the copy id
09:13 - so ssh root and then at and when we do
09:16 - this
09:16 - it's going to ask us for the passphrase
09:18 - for our private key which is stored in
09:20 - this file so you type in the passphrase
09:21 - to decrypt it
09:22 - and then it should just automatically
09:24 - log you in to the server
09:26 - so now notice i didn't have to type in a
09:28 - password i used the public and private
09:30 - key pair
09:30 - to sign it so that's how that works and
09:33 - that's the point of using this public
09:34 - private key
09:35 - is now you don't need a password to sign
09:37 - into the device you simply just have
09:38 - this key stored locally on your machine
09:40 - and that's automatically passed to the
09:42 - linux machine when you sign in
09:44 - then what you would do after this is you
09:46 - would remove the ability to sign in with
09:48 - a password from this machine
09:50 - so that the only way you can get access
09:52 - to this linux device is if you have that
09:54 - private key
09:55 - anyways again i'm not going to show you
09:56 - how to deactivate that but that is what
09:58 - you would traditionally do
10:00 - now let's head over to the windows
10:01 - machine and i'll show you how to do this
10:03 - there now we'll move on in one second
10:04 - but i need to quickly thank the other
10:06 - sponsor of this video which is algo
10:08 - expert algo expert is the best platform
10:10 - to use when preparing for your software
10:11 - engineering coding interviews
10:13 - they have a data structures crash course
10:15 - a mock interviews feature
10:16 - and over 115 coding interview questions
10:19 - some of which are taught by me
10:21 - get started using algox for today by
10:22 - hitting the link in the description and
10:24 - using the code tech with tim for a
10:25 - discount on the platform
10:27 - all right so now i'm back here on
10:29 - windows i'm going to show you how we can
10:30 - do the same thing except on windows
10:32 - unfortunately windows doesn't have as
10:34 - nice of commands to do this so it's a
10:36 - little bit more involved
10:37 - but still not too complicated anyways
10:39 - there's gonna be a link in the
10:40 - description for this software called
10:41 - puttygen
10:42 - now what this software is going to allow
10:44 - us to do is generate a public and
10:46 - private key pair
10:47 - that is specific for putty so we're
10:49 - going to use putty to sign in obviously
10:51 - as we've been doing this whole time and
10:53 - specifically we're going to use a putty
10:55 - private and public key pair so putty gen
10:58 - generates this for us so go to the link
10:59 - in the description and just scroll down
11:01 - to kind of the middle of the page
11:03 - and you should see an msi installer for
11:05 - putty and then if you keep going
11:07 - you should see puttygen a piece of
11:09 - software popping up right here
11:11 - so where you see puttygen you're going
11:13 - to download the 64-bit or 32-bit uh
11:15 - depending on what operating system
11:17 - you're on
11:18 - and again it's only going to work on
11:19 - windows this method all right so now i'm
11:20 - just going to download this
11:22 - to my desktop and then we'll run
11:24 - puttygen.exe
11:26 - so we run puttygen.exe and we can see
11:29 - that it says no key and there's a button
11:31 - called
11:31 - generate so what we're going to do first
11:32 - is we're going to change the size of our
11:34 - private key
11:35 - or our key in general sorry to be 4096.
11:39 - so let's change this to 4096
11:41 - and make sure that rsa is selected
11:42 - that's the type of key that we want
11:44 - now what we're going to do is we're
11:45 - going to press generate and when we
11:47 - press generate it's going to say
11:48 - generate some randomness by moving the
11:50 - mouse around the blank area
11:52 - so literally just move your mouse around
11:54 - and that's how you're going to generate
11:56 - the random key which i think is
11:57 - hilarious
11:58 - but that's how you do it just move the
12:00 - key around so now it says
12:02 - that we have our public key and we
12:04 - should also have a private key as well
12:06 - what we can do is enter our passphrase
12:08 - so again this is just to encrypt the key
12:10 - so i believe this has to be at minimum
12:12 - five digits so i'm going to
12:14 - enter one two three four five and then
12:16 - what we're going to do is save the
12:18 - public key
12:18 - and save the private key so i'm going to
12:20 - save the public key it's going to ask me
12:22 - where i want to save it
12:23 - now it's important that when we save
12:25 - what is this the public key we save this
12:27 - as a dot
12:28 - txt file now you'll see why in a second
12:31 - but anyways just save this as a
12:33 - txt file so we're going to say public
12:35 - hyphen key
12:36 - or whatever we want to call it and then
12:38 - dot txt
12:40 - i'm just going to save this on my
12:41 - desktop and in fact you know let me make
12:42 - a folder here and i'll just call this
12:45 - tutorial and there we go we'll save it
12:48 - inside of here
12:48 - okay so there we go we have our public
12:50 - key saved and now we want to save our
12:52 - private key
12:53 - so when we save the private key notice
12:55 - that the file extension is ppk
12:57 - make sure you keep the ppk we need that
12:59 - as the file extension for this now we
13:01 - can again name this whatever we want
13:03 - i'll just say private hyphen key and
13:06 - click
13:06 - save all right so now that all that's
13:08 - done i've saved the two keys what i'm
13:10 - going to do is i'm going to first
13:10 - navigate to those so desktop and then
13:13 - tutorial and i have my keys right here
13:15 - so we'll just leave this kind of open on
13:17 - the side of our screen
13:18 - and now i'm going to open up putty so
13:19 - let's open up putty and what we're going
13:21 - to do is we're going to
13:22 - load our session so we'll load tutorial
13:25 - like this
13:26 - and then we're going to go to the
13:27 - connection tab in putty we're going to
13:29 - go to
13:30 - ssh we're going to expand ssh and go to
13:33 - auth and then inside of auth we are
13:35 - going to select our private key file
13:37 - so where it says private key file for
13:39 - authentication we're going to press
13:40 - browse
13:41 - we're going to look for it on our
13:42 - machine so this is in desktop
13:44 - tutorial private key so we're going to
13:47 - press open
13:47 - now this is why we have to have the ppk
13:49 - extension because this is specific for
13:51 - putty
13:52 - a putty private key is what that stands
13:54 - for all right so now that we've done
13:55 - that we're going to go back to our
13:57 - session
13:57 - we're going to press save on tutorial so
14:00 - that we save this private key
14:02 - with our session so now every time we
14:04 - open the session the private key will
14:06 - automatically be passed
14:08 - so that we don't need to do it manually
14:09 - all right so now we're going to
14:11 - load this session or open this session
14:12 - so let's open it and it's going to ask
14:14 - us to log in so we're going to log in as
14:16 - we normally would we're going to log in
14:18 - as root
14:18 - it's going to say that our key was
14:20 - refused that's fine
14:21 - because we don't have the public key yet
14:23 - on the server for this machine
14:25 - then we're going to type in the password
14:27 - so i'll type in my root password
14:29 - all right so i'm now signed into my
14:31 - linux machine what we're going to do now
14:33 - is we're going to add the public key
14:35 - to this machine now you need to make
14:37 - sure you follow these steps precisely
14:39 - because you can mess this up very easily
14:41 - and if you already did this on mac
14:43 - and i guess if for some reason you're
14:44 - following along with windows a lot of
14:46 - these commands you're not going to have
14:47 - to type
14:48 - now if you're just doing this on windows
14:50 - unfortunately we don't have these nice
14:51 - commands like we have on mac to just
14:53 - automatically add this
14:54 - so there's a bit more work that we need
14:56 - to do but anyways we're inside of the
14:58 - server now what we're going to do is
15:00 - we're going to first check
15:01 - and see if we currently have a dot ssh
15:04 - folder
15:04 - in the user's home directory so by
15:07 - default we're in the user's home
15:08 - directory
15:08 - we're going to try to cd into the dot
15:11 - ssh folder
15:12 - so if this works this means you have a
15:14 - dot ssh folder you can skip the step
15:16 - that i'm about to do
15:17 - so if that doesn't work though and you
15:19 - don't have an ssh folder you need to
15:20 - make one so you're going to say mkdir
15:22 - and then dot ssh so you're going to make
15:25 - a new folder
15:26 - called.ssh once you've made this new
15:28 - folder again i'm not making it because i
15:30 - already have one
15:31 - you're going to cd into it so cd into
15:33 - dot ssh
15:34 - once you're inside of dot ssh you're
15:36 - going to make a new file
15:37 - this new file is going to store your uh
15:40 - public
15:40 - key so you're going to say touch and
15:43 - then the name of the file
15:44 - in which this case it is authorized keys
15:46 - so touch authorized keys
15:48 - only if you didn't have this ssh folder
15:50 - already if you already have this
15:52 - ssh folder do not do this okay so now we
15:56 - make this authorized keys file
15:58 - once we make this authorized keys file
16:00 - what we need to do is cd out of this
16:01 - folder so cd dot dot and we now need to
16:04 - set the permissions
16:05 - for this folder and for this file the
16:08 - reason we need to do this is when you
16:09 - log
16:10 - in using your ssh keys well these
16:12 - folders and files just need to have
16:13 - set permissions i'm not a linux expert
16:16 - enough to explain exactly why we need
16:18 - all these permissions but this is just
16:19 - what you need to do just trust me this
16:21 - is the proper permissions you need to
16:23 - set
16:23 - so what we're going to type now is chmod
16:26 - and then plus so sorry a plus and then
16:30 - rwx and then comma g minus
16:34 - rwx and then o minus rwx and this is
16:38 - going to be for the dot
16:39 - slash dot ssh folder now you can just do
16:42 - dot
16:43 - ssh as well and it would be helpful if
16:44 - you spell ssh correctly
16:46 - and you're going to set this permission
16:47 - for this folder again only do these
16:49 - steps if when you first logged in here
16:51 - you didn't have the ssh folder and you
16:53 - didn't have that file that i told you to
16:55 - create
16:55 - so run this command and then after you
16:58 - run this command you're going to run
16:59 - another command so you're now going to
17:01 - cd
17:02 - into this folder so cdn2.ssh after you
17:05 - set the permissions that i just defined
17:07 - and you're now going to set the
17:08 - permissions for the authorized keys file
17:10 - so now you're going to say chmod and
17:13 - then a
17:13 - plus rwx then u minus
17:17 - x and then g minus r w x
17:20 - and then o minus r w x so you're just
17:23 - setting
17:24 - very specific permissions for who can
17:26 - access read and execute this file
17:28 - so do this then press enter set this for
17:31 - this
17:32 - file so the file sorry we should type
17:34 - the file out is going to be authorized
17:36 - keys
17:36 - and once you've done this now you're
17:38 - good we now need to add the public key
17:41 - to this file so again
17:42 - all the stuff i just showed you you're
17:43 - only doing if you didn't have this ssh
17:46 - folder when you first
17:47 - logged into this machine okay so chmod a
17:50 - plus rdbx
17:51 - u minus x g minus rwx o minus rwx
17:55 - authorized keys run that command okay
17:57 - now that we have the permissions set for
17:59 - this file and if you're on mac and
18:00 - you're still watching this just by
18:02 - default mac does this for you so you
18:03 - didn't need to do it
18:04 - now we need to add our public key to
18:06 - this file so we're going to say nano
18:08 - and then authorized keys now nano is
18:11 - just a text editor on linux it's going
18:12 - to open up this file now notice that i
18:14 - have a key inside of this file
18:16 - the reason i have this key is this is
18:18 - the ssh key from my mac when i just
18:20 - added it now
18:21 - you won't have this you'll likely just
18:23 - have nothing in this file because it's
18:24 - an empty file
18:26 - what you're going to do is you're going
18:27 - to go and find your public key that you
18:30 - saved in the text file
18:31 - and you're going to copy it not the
18:33 - comment just the key so you don't want
18:35 - the comment or the end or anything
18:37 - inside of the
18:38 - the hyphens here so we're going to take
18:40 - this key
18:41 - we're going to go to putty and we're
18:43 - simply going to paste it in now to paste
18:45 - this you actually
18:46 - right click with your mouse so you right
18:47 - click it like that and it should paste
18:49 - it into this file
18:51 - so now that this is pasted in we're
18:52 - going to go actually before this key
18:54 - sorry we should have done this before
18:56 - uh and oops i just want to go to the
18:57 - beginning of this line here and i need
18:59 - to preface all this with ssh hyphen rsa
19:02 - so ssh hyphen rsa and then whatever your
19:05 - key is now i'm hoping this is all on
19:07 - one line uh this needs to all be on one
19:09 - line i don't know why the text file
19:11 - copied this into multiple lines
19:12 - but unfortunately you are going to have
19:14 - to put this all in one line so maybe you
19:16 - can be more clever than me and not do it
19:18 - the way that i'm doing
19:19 - but uh you need to make sure there's no
19:20 - escape characters here and i'm just
19:22 - gonna fast forward through me putting
19:23 - this on one line but make sure it's on a
19:25 - single line
19:26 - all right so now it's all on one line
19:28 - once it's all on one line i apologize
19:29 - about that guys we're just going to save
19:31 - so control s and then control x and now
19:34 - you have this public key in your server
19:37 - so now what you need to do is need to
19:39 - log out and then you can log back in and
19:41 - you should just automatically be
19:43 - authorized because you've done this
19:44 - correctly and you added the public key
19:46 - so now we can log out or we can exit
19:49 - and what i will do is go back to putty
19:51 - so let me go
19:52 - now back to putty here and inside of
19:55 - putty i'm going to load
19:56 - tutorial now notice when i load tutorial
19:58 - if i go to ssh
20:00 - and then off my private key file is
20:02 - saved that's why we saved that before
20:04 - anyways now i will open and when i open
20:07 - i can type in my username and it should
20:09 - just automatically authenticate me so it
20:11 - says authenticating with public key
20:13 - and then passphrase for key is this so
20:15 - what i'm going to say is my passphrase
20:17 - and now it should log me in it logs me
20:19 - in and we are all
20:21 - good so now we have our public and
20:23 - private key authentication
20:24 - set up next i'm going to show you how to
20:26 - access this server over
20:28 - ftp so using a file transfer protocol
20:30 - first thing you need to download an ftp
20:32 - client you can pick whatever you want
20:33 - i'm just going to go with filezilla
20:35 - because it's kind of the most known
20:36 - and it works on mac and windows it's
20:38 - actually not my favorite ftp
20:40 - clients i usually use win scp but that's
20:43 - only for windows so i didn't want to use
20:44 - that in this video in case any of you
20:46 - guys are on mac
20:47 - so anyways go download filezilla i'll
20:49 - leave a link to in the description or
20:50 - whatever ftp client you want for that
20:52 - matter
20:52 - and then open it up so i've got uh
20:54 - filezilla right here and i'll just show
20:56 - you how to use filezilla to connect your
20:58 - server and
20:58 - i'll show you what an ftp client kind of
21:00 - looks like so let's make this full
21:01 - screen i'm going to put in my server ip
21:03 - address
21:03 - now i'll be back i'm just going to grab
21:05 - that all right so i've got the ip
21:06 - address in here then you're going to
21:08 - type in your username
21:09 - you type in the password as well so type
21:12 - in the root password
21:13 - and then put port 22 in here and just
21:15 - press quick connect
21:16 - now this will work if you have the user
21:19 - password
21:20 - enabled on your machine again you can
21:21 - disable this i'm not going to show that
21:23 - in this video though
21:24 - and if you just press quick connect you
21:25 - should sign into your machine and now
21:27 - you can actually see all the files on
21:29 - your machine that are accessible for
21:30 - this root user
21:31 - so now you could manually delete them
21:33 - like i can just delete the file i can
21:34 - add a new file i can also drag files
21:36 - from my machine which
21:38 - is on the left hand side of the screen
21:39 - here over onto my linux machine
21:42 - this is a really easy way to take files
21:44 - and transfer them
21:45 - to the device or transfer them to the
21:46 - linux machine and from the linux machine
21:48 - you can drag files and transfer them
21:50 - back to your local machine
21:52 - so that's ftp super straightforward also
21:54 - show you how to use your public private
21:56 - key from ftp so to do that in filezilla
21:59 - you need to go to
22:00 - where is it here uh there's somewhere
22:02 - that says settings i believe it's
22:04 - server uh so let's let's disconnect
22:06 - first actually
22:07 - and let me try to find the settings here
22:08 - because there is something to do so if
22:10 - you go in edit actually and you press
22:11 - settings then what you can do is you can
22:14 - go
22:14 - to sftp and in sftp you can add your key
22:18 - file
22:19 - so i'm going to add my key file i'm
22:20 - going to find this i believe this is on
22:23 - my desktop so desktop tutorial and
22:26 - private key
22:27 - i'm going to add that here and then that
22:30 - should be good so i'm going to press ok
22:31 - now
22:32 - and now when i access my server i should
22:34 - be able to just put in the username
22:35 - port 22 and connect using the private
22:38 - key
22:39 - so now it asks me for the passphrase for
22:41 - this key so notice i didn't put in the
22:42 - password for the root user
22:44 - and what i will do is just put in the
22:45 - passphrase and press
22:47 - ok and then it should sign me into the
22:49 - server just like before and there you go
22:50 - we're signed in using the public private
22:52 - key
22:53 - so that's actually all i wanted to cover
22:54 - in this video i hope this was helpful to
22:56 - you
22:57 - after this you should probably disable
22:59 - the password authentication or login for
23:01 - your server
23:02 - again i apologize i'm not showing that
23:03 - but i just think it's something that you
23:04 - guys can find on your own if you want to
23:06 - do it it's really simple and
23:08 - i don't want to do it for my server
23:09 - because i still would like to be able to
23:10 - log in with my password so i don't want
23:12 - to go through all the steps
23:14 - in this video anyways i hope you guys
23:15 - found this useful if you did make sure
23:16 - to leave a like subscribe to the channel
23:18 - and i will see you in another youtube
23:20 - video
23:22 - [Music]

Cleaned transcript:

hello everybody and welcome to another video in this linux for programmers tutorial series in this video what we'll be doing is talking about public and private key authentication for our server so making it so we no longer need to type in the password for our user but instead we are automatically authenticated using this special method which is kind of a key pairing which i'll discuss more as we get into that we'll also be talking about how to access our file from ftp so how we can use the file transfer protocol to transfer files to and from our server so that's what we're going to be going through in this video let's get into it after a quick word from lenode which is the sponsor of this video and this series now as i've said many times now lenode is one of the best companies to use when hosting a website domain or personal project they have all kinds of integrations specifically for programmers like deep support for kubernetes and other developer things like docker the node just makes it really easy to spin up servers i've been using them for about two years i have literally zero complaints and whenever anything goes wrong or i need help i reach out to their customer support team which is active 24 hours a day seven days a week 365 days a year so claim your 100 free credit towards the node by clicking that link in the description now before we move forward a reminder to sign up for the last five videos in this tutorial series you know where to go but there is a link in the description you can register with your name and email and then you will be notified when these videos are available on this platform lastly there is a guide for this video this is actually a very helpful guide especially if you just want more information about the stuff that i'm talking about here link will be in the description all right so let's dive in the first thing that i'm going to do is i'm actually going to show you how to on mac set up this rsa key pair and log into your server using public and private key authentication we'll talk about this more after i hop onto the mac then after that we'll go through windows then we'll talk about the ftp there'll be some time stamps in the description so you can kind of fast forward and look at the relevant sections for you anyways let's go over to the mac so i'm here on the mac what we're going to do now is set up an rsa key pair which is simply a public and private key now in case you're confused what's going to happen here is we're going to generate the public and private key we're going to store the public key on our server we're going to store the private key on this machine now what's going to happen is when we sign into our linux machine after we set up this public and private key all we'll need to do is pass the private key to our machine and in fact we won't have to do this our like operating system will just automatically do this for us and then it will compare the public key and the private key together and if there is a match then it will authenticate us and let us sign in this is typically a more secure way to do things because if you have just a standard passphrase to sign into your computer or sign into your machine that is vulnerable to brute force attacks i can say personally one of my servers was actually hacked with the brute force approach so typically after you do this what you will do is you will disable password login so you can only log in with a public and private key pair i'm not going to show you how to disable the login in this video it's pretty easy to do so i'll let you look that up if that's something that you want to do but this will at least show you how to set up the public and private key authentication and just make your life a little bit easier when signing into your server anyways i've gone through a lot here but let's just dive in so the first thing we're going to do is see if we already have a public and private key pairing on this machine now the reason we need to do this is because if we do we don't want to override this so we're going to type ls and then tilde slash then dot ssh and then slash and after that id under rs sorry not under but underscore rsa and then an asterisk what this is going to do is search for all of the private and public key pairings on our machine we're looking in the home directory of our user and again this is specific to mac this isn't going to work on windows and we see the dot ssh folder and then we have two files id underscore rsa and id underscore rsa.pub for you chances are you don't have any of these files if you don't just continue on with the rest of the video now if you do have these two files do not do the following step that i'm like don't write the next line that i'm going to write the reason you don't want to write this line is because this line is going to generate these two files now if you generate these two files and two already exist you're going to override them if you override them you're going to lose your private and public key which means you will lose access to any machine that requires this public and private key so again do not write this line if you have any ids here or any public and private key already installed on your machine if you don't have anything so you type this command and you don't see anything popping up then you can write the following line i just want to make sure that's really clear because i don't want any of you guys to lose access to any of your linux machines so what we're going to type after this assuming that we don't have these two files again is ssh hyphen and then key gen and then hyphen b and then 4096. what this is going to do is generate these two files the private and public key it's going to store them in our ssh directory and then with the two following file names you can see right here by adding this hyphen b 4096 we're increasing the amount of bits or the amount of bytes that we're going to use for our keys just so that it's more secure so we bumped it up to 4096 as opposed to i believe the default which is 2048. anyways we're going to press enter what this is going to do is generate the public and private key and now we have the option to encrypt our private key or to save it to a different file so if you want to save it to a different file then that's fine you're not going to override these two files right here so you could say id underscore rsa1 or id underscore rsa whatever you don't even have to call it id rsa you can call it whatever you want if you just hit enter which is what i'm going to do by default it's going to tell you do you want to override the file that already exists if it exists if it doesn't it will just save to this file name id underscore rsa so i'm going to override my file because i actually don't care about these ones this was just testing before the video and then it's going to ask me if i want to enter a passphrase now a passphrase is different than a password what the passphrase will do is decrypt your key so that it can be sent to the server so typically you want to have a passphrase just so that if someone gets access to your private key they're not able to access your server unless they know the passphrase so i'm just going to make my passphrase like one two three four something really basic but again you would obviously make this more secure all right so now our passphrase is in and we've generated our key now again to check where this key is well it's just going to be in your dot ssh folder and then you can run this command and well you'll see it pop up you also could just cd into the dot ssh folder in the user's home directory and on mac tilde again represents the home directory just like on linux now if you already had a key file stored so you already had your id underscore rsa and iot underscore rsa.pub you don't need to generate a new one you can just use that same key file for your server so you can use the same key file for multiple machines now is that recommended i'm not quite sure that's up to you do you want to use the same one or not i mean that's kind of your preference but if you want to use the same one you don't need to generate a new one if you want to use a different one when you type that command just be very careful and make sure you select a different file name for the key and you know what that file name is because that's going to be important in this step okay so now that we have this we're actually going to ssh into our machine and add this key to it so to add this key to our linux machine we're going to type the following ssh hyphen copy and then hyphen id and then we're going to put the username at and then the server ip address so i'm going to say root at and then 172.105.25.135. now your ip address is obviously going to be different but you're probably going to sign in as the root user unless you want to use one of the other users you've created so anyways we'll say ssh copy id and then the user that you want to add this key for so i'm going to add this for the root user but typically you add this for a other user on your machine you don't usually add these public private keys for the root user but we're just going to do it for this video and then you press enter now what this is going to do is it's going to copy your public key to your linux machine so it's going to ask you for the password for the root user so type in your root user password or whatever other user you use to sign in here press enter and after you do that all of a sudden uh the private and public key will be active on this machine so you will now be able to sign into your linux machine without entering a password rather you'll enter the passphrase to decrypt your private key now i know this is a lot of information just to reiterate here typically you don't do this for the root user i'm just doing it for the root user for this video just because it's easier and i forget the other users that i've created to be honest with you but usually you would create a new user it would be a pseudo user so you would add it to the sudo group then you would do this for that user anyways i just wanted to make sure that's clear that traditionally this is not done for the root user so anyways now we've added that key so what we're going to do next is we're going to see how we actually sign into the machine now so now on mac to actually get into this device we're going to say ssh and then our username so root and then whatever the server i p address is so actually i'll just copy this right here and remove the copy id so ssh root and then at and when we do this it's going to ask us for the passphrase for our private key which is stored in this file so you type in the passphrase to decrypt it and then it should just automatically log you in to the server so now notice i didn't have to type in a password i used the public and private key pair to sign it so that's how that works and that's the point of using this public private key is now you don't need a password to sign into the device you simply just have this key stored locally on your machine and that's automatically passed to the linux machine when you sign in then what you would do after this is you would remove the ability to sign in with a password from this machine so that the only way you can get access to this linux device is if you have that private key anyways again i'm not going to show you how to deactivate that but that is what you would traditionally do now let's head over to the windows machine and i'll show you how to do this there now we'll move on in one second but i need to quickly thank the other sponsor of this video which is algo expert algo expert is the best platform to use when preparing for your software engineering coding interviews they have a data structures crash course a mock interviews feature and over 115 coding interview questions some of which are taught by me get started using algox for today by hitting the link in the description and using the code tech with tim for a discount on the platform all right so now i'm back here on windows i'm going to show you how we can do the same thing except on windows unfortunately windows doesn't have as nice of commands to do this so it's a little bit more involved but still not too complicated anyways there's gonna be a link in the description for this software called puttygen now what this software is going to allow us to do is generate a public and private key pair that is specific for putty so we're going to use putty to sign in obviously as we've been doing this whole time and specifically we're going to use a putty private and public key pair so putty gen generates this for us so go to the link in the description and just scroll down to kind of the middle of the page and you should see an msi installer for putty and then if you keep going you should see puttygen a piece of software popping up right here so where you see puttygen you're going to download the 64bit or 32bit uh depending on what operating system you're on and again it's only going to work on windows this method all right so now i'm just going to download this to my desktop and then we'll run puttygen.exe so we run puttygen.exe and we can see that it says no key and there's a button called generate so what we're going to do first is we're going to change the size of our private key or our key in general sorry to be 4096. so let's change this to 4096 and make sure that rsa is selected that's the type of key that we want now what we're going to do is we're going to press generate and when we press generate it's going to say generate some randomness by moving the mouse around the blank area so literally just move your mouse around and that's how you're going to generate the random key which i think is hilarious but that's how you do it just move the key around so now it says that we have our public key and we should also have a private key as well what we can do is enter our passphrase so again this is just to encrypt the key so i believe this has to be at minimum five digits so i'm going to enter one two three four five and then what we're going to do is save the public key and save the private key so i'm going to save the public key it's going to ask me where i want to save it now it's important that when we save what is this the public key we save this as a dot txt file now you'll see why in a second but anyways just save this as a txt file so we're going to say public hyphen key or whatever we want to call it and then dot txt i'm just going to save this on my desktop and in fact you know let me make a folder here and i'll just call this tutorial and there we go we'll save it inside of here okay so there we go we have our public key saved and now we want to save our private key so when we save the private key notice that the file extension is ppk make sure you keep the ppk we need that as the file extension for this now we can again name this whatever we want i'll just say private hyphen key and click save all right so now that all that's done i've saved the two keys what i'm going to do is i'm going to first navigate to those so desktop and then tutorial and i have my keys right here so we'll just leave this kind of open on the side of our screen and now i'm going to open up putty so let's open up putty and what we're going to do is we're going to load our session so we'll load tutorial like this and then we're going to go to the connection tab in putty we're going to go to ssh we're going to expand ssh and go to auth and then inside of auth we are going to select our private key file so where it says private key file for authentication we're going to press browse we're going to look for it on our machine so this is in desktop tutorial private key so we're going to press open now this is why we have to have the ppk extension because this is specific for putty a putty private key is what that stands for all right so now that we've done that we're going to go back to our session we're going to press save on tutorial so that we save this private key with our session so now every time we open the session the private key will automatically be passed so that we don't need to do it manually all right so now we're going to load this session or open this session so let's open it and it's going to ask us to log in so we're going to log in as we normally would we're going to log in as root it's going to say that our key was refused that's fine because we don't have the public key yet on the server for this machine then we're going to type in the password so i'll type in my root password all right so i'm now signed into my linux machine what we're going to do now is we're going to add the public key to this machine now you need to make sure you follow these steps precisely because you can mess this up very easily and if you already did this on mac and i guess if for some reason you're following along with windows a lot of these commands you're not going to have to type now if you're just doing this on windows unfortunately we don't have these nice commands like we have on mac to just automatically add this so there's a bit more work that we need to do but anyways we're inside of the server now what we're going to do is we're going to first check and see if we currently have a dot ssh folder in the user's home directory so by default we're in the user's home directory we're going to try to cd into the dot ssh folder so if this works this means you have a dot ssh folder you can skip the step that i'm about to do so if that doesn't work though and you don't have an ssh folder you need to make one so you're going to say mkdir and then dot ssh so you're going to make a new folder called.ssh once you've made this new folder again i'm not making it because i already have one you're going to cd into it so cd into dot ssh once you're inside of dot ssh you're going to make a new file this new file is going to store your uh public key so you're going to say touch and then the name of the file in which this case it is authorized keys so touch authorized keys only if you didn't have this ssh folder already if you already have this ssh folder do not do this okay so now we make this authorized keys file once we make this authorized keys file what we need to do is cd out of this folder so cd dot dot and we now need to set the permissions for this folder and for this file the reason we need to do this is when you log in using your ssh keys well these folders and files just need to have set permissions i'm not a linux expert enough to explain exactly why we need all these permissions but this is just what you need to do just trust me this is the proper permissions you need to set so what we're going to type now is chmod and then plus so sorry a plus and then rwx and then comma g minus rwx and then o minus rwx and this is going to be for the dot slash dot ssh folder now you can just do dot ssh as well and it would be helpful if you spell ssh correctly and you're going to set this permission for this folder again only do these steps if when you first logged in here you didn't have the ssh folder and you didn't have that file that i told you to create so run this command and then after you run this command you're going to run another command so you're now going to cd into this folder so cdn2.ssh after you set the permissions that i just defined and you're now going to set the permissions for the authorized keys file so now you're going to say chmod and then a plus rwx then u minus x and then g minus r w x and then o minus r w x so you're just setting very specific permissions for who can access read and execute this file so do this then press enter set this for this file so the file sorry we should type the file out is going to be authorized keys and once you've done this now you're good we now need to add the public key to this file so again all the stuff i just showed you you're only doing if you didn't have this ssh folder when you first logged into this machine okay so chmod a plus rdbx u minus x g minus rwx o minus rwx authorized keys run that command okay now that we have the permissions set for this file and if you're on mac and you're still watching this just by default mac does this for you so you didn't need to do it now we need to add our public key to this file so we're going to say nano and then authorized keys now nano is just a text editor on linux it's going to open up this file now notice that i have a key inside of this file the reason i have this key is this is the ssh key from my mac when i just added it now you won't have this you'll likely just have nothing in this file because it's an empty file what you're going to do is you're going to go and find your public key that you saved in the text file and you're going to copy it not the comment just the key so you don't want the comment or the end or anything inside of the the hyphens here so we're going to take this key we're going to go to putty and we're simply going to paste it in now to paste this you actually right click with your mouse so you right click it like that and it should paste it into this file so now that this is pasted in we're going to go actually before this key sorry we should have done this before uh and oops i just want to go to the beginning of this line here and i need to preface all this with ssh hyphen rsa so ssh hyphen rsa and then whatever your key is now i'm hoping this is all on one line uh this needs to all be on one line i don't know why the text file copied this into multiple lines but unfortunately you are going to have to put this all in one line so maybe you can be more clever than me and not do it the way that i'm doing but uh you need to make sure there's no escape characters here and i'm just gonna fast forward through me putting this on one line but make sure it's on a single line all right so now it's all on one line once it's all on one line i apologize about that guys we're just going to save so control s and then control x and now you have this public key in your server so now what you need to do is need to log out and then you can log back in and you should just automatically be authorized because you've done this correctly and you added the public key so now we can log out or we can exit and what i will do is go back to putty so let me go now back to putty here and inside of putty i'm going to load tutorial now notice when i load tutorial if i go to ssh and then off my private key file is saved that's why we saved that before anyways now i will open and when i open i can type in my username and it should just automatically authenticate me so it says authenticating with public key and then passphrase for key is this so what i'm going to say is my passphrase and now it should log me in it logs me in and we are all good so now we have our public and private key authentication set up next i'm going to show you how to access this server over ftp so using a file transfer protocol first thing you need to download an ftp client you can pick whatever you want i'm just going to go with filezilla because it's kind of the most known and it works on mac and windows it's actually not my favorite ftp clients i usually use win scp but that's only for windows so i didn't want to use that in this video in case any of you guys are on mac so anyways go download filezilla i'll leave a link to in the description or whatever ftp client you want for that matter and then open it up so i've got uh filezilla right here and i'll just show you how to use filezilla to connect your server and i'll show you what an ftp client kind of looks like so let's make this full screen i'm going to put in my server ip address now i'll be back i'm just going to grab that all right so i've got the ip address in here then you're going to type in your username you type in the password as well so type in the root password and then put port 22 in here and just press quick connect now this will work if you have the user password enabled on your machine again you can disable this i'm not going to show that in this video though and if you just press quick connect you should sign into your machine and now you can actually see all the files on your machine that are accessible for this root user so now you could manually delete them like i can just delete the file i can add a new file i can also drag files from my machine which is on the left hand side of the screen here over onto my linux machine this is a really easy way to take files and transfer them to the device or transfer them to the linux machine and from the linux machine you can drag files and transfer them back to your local machine so that's ftp super straightforward also show you how to use your public private key from ftp so to do that in filezilla you need to go to where is it here uh there's somewhere that says settings i believe it's server uh so let's let's disconnect first actually and let me try to find the settings here because there is something to do so if you go in edit actually and you press settings then what you can do is you can go to sftp and in sftp you can add your key file so i'm going to add my key file i'm going to find this i believe this is on my desktop so desktop tutorial and private key i'm going to add that here and then that should be good so i'm going to press ok now and now when i access my server i should be able to just put in the username port 22 and connect using the private key so now it asks me for the passphrase for this key so notice i didn't put in the password for the root user and what i will do is just put in the passphrase and press ok and then it should sign me into the server just like before and there you go we're signed in using the public private key so that's actually all i wanted to cover in this video i hope this was helpful to you after this you should probably disable the password authentication or login for your server again i apologize i'm not showing that but i just think it's something that you guys can find on your own if you want to do it it's really simple and i don't want to do it for my server because i still would like to be able to log in with my password so i don't want to go through all the steps in this video anyways i hope you guys found this useful if you did make sure to leave a like subscribe to the channel and i will see you in another youtube video
