With timestamps:

00:00 - thanks for tuning in at brakus hello and
00:04 - welcome to video number five on creating
00:06 - a tower defense game in unity me today
00:07 - we are going to be continuing with our
00:09 - turret while specifically we are going
00:11 - to make it shoot some stuff so that's
00:13 - going to be super super fun so you can
00:15 - see there I'm here in unity and what I
00:17 - want to do is I want to select my turret
00:19 - and open up the charge script this is a
00:21 - pretty good place to add our shooting
00:24 - mechanics because we already have this
00:26 - target variable available to us so let's
00:29 - begin by adding a variable here and this
00:31 - is going to be our fire rate and I'm
00:33 - just going to default this to 1 meaning
00:35 - we will fire one bullet each second then
00:39 - next we need a R that's not right we
00:42 - need this to be a public float there we
00:44 - go next up we need a private variable a
00:46 - private float to be specific and this is
00:50 - going to be our fire countdown and it's
00:54 - basically going to start at zero so we
00:56 - can fire right away and then once we
01:00 - fired it's going to be set equal to one
01:02 - divided by a fire rate so if we can say
01:05 - shoot one time each second that means
01:09 - that our fire countdown will be set to 1
01:11 - and then it will countdown every time we
01:14 - draw a frame until it reaches zero and
01:16 - then we can shoot again and so it will
01:18 - continue and this just make sure that we
01:21 - have our shooting on some kind of fixed
01:23 - update so inside of our update method
01:25 - here what we're going to do is we're
01:27 - simply going to say if our fire
01:30 - countdown is less than or equal to zero
01:32 - meaning it's time to shoot now well then
01:35 - we want to shoot and we're going to make
01:37 - this method in a second and then we're
01:39 - going to set our 5 countdown equal to 1
01:42 - divided by our fire rate so you can see
01:46 - here very quickly that if our fire rate
01:49 - is 2 that means we want to fire two
01:51 - bullets each second that means that it
01:53 - should count down from point five okay
01:56 - so cool now we have that set up now we
01:59 - just need to make sure that a fire
02:01 - countdown actually counts down so we
02:04 - want to decrease this by a small amount
02:06 - each each frame and we do that by saying
02:09 - fire countdown - equals time
02:13 - - time so again this will make sure that
02:16 - every second fire countdown will repeat
02:19 - be reduced by one good we've done this
02:22 - before it's very similar to the logic we
02:25 - used in the wave spawning so now we can
02:28 - create our shoot variable and we just
02:30 - say void shoot here and we are going to
02:34 - have some different stuff in here we are
02:36 - going to be instantiated and Boulud and
02:37 - we are going to set it be setting a
02:39 - target for that bullet but for now let's
02:41 - just do a debug that lark statement
02:43 - called
02:43 - shoot just see if things are working so
02:49 - let's jump into unity here you see our
02:51 - variables pop up there is the fire rate
02:54 - and now we can hit play here and we
02:57 - should see that when it locks on to
02:58 - target
02:59 - it says shoot with an interval of 0.5
03:03 - seconds so that's perfect now what I
03:05 - want to do is just be a bit more
03:07 - organized in the way we have variables
03:09 - set up here more specifically how they
03:11 - look in the inspector because once you
03:13 - get to have more than five or six
03:14 - variables it can be a bit confusing so
03:17 - what we do here is take a fire rate and
03:19 - fire countdown and move them up on to
03:22 - where our range is placed and then let's
03:24 - separate that from our target and what
03:26 - we can do is add a header and this
03:29 - header is going to say attributes so
03:33 - these are the things that we can that
03:34 - can vary from one turret to the to
03:36 - another these are things that maybe can
03:39 - be upgraded or changed and then we're
03:42 - going to make another header down here
03:44 - which is just going to be unity set up
03:47 - fields or something like that just to
03:50 - let people know that this is things that
03:52 - unity requires for us to do this it's
03:55 - not something that should be changed by
03:57 - the user and this should just organize
04:00 - things a bit better here so we have the
04:02 - attributes and we have the unity set up
04:04 - fields in general use header files a lot
04:07 - it it really makes for it very easily
04:11 - makes for a better interface when
04:12 - working with your own scripts great so
04:16 - now we can go ahead and actually add
04:18 - this shoot functionality but we have to
04:20 - have something to instantiate so let's
04:22 - go ahead and make a bullet so let's
04:24 - right-click go on the 3d option
04:26 - and selects fear and this is going to be
04:28 - whoa we don't want this on the chart and
04:30 - this is going to be a very very simple
04:32 - model just reset that focus in on it and
04:35 - move it up a bit and I'm going to make
04:37 - this a size of let's say point five or
04:41 - six point six point six point six
04:43 - something like that just so it's clear
04:46 - when viewed from a distance but so it
04:49 - doesn't like look silly when coming out
04:52 - of a bell that is probably a lot smaller
04:54 - but yeah this is going to be fine
04:56 - actually let's do yeah look here that
04:59 - this great and let's rename this to pull
05:02 - it and this is just going to be a
05:04 - standard bullet we can have other stuff
05:06 - like rockets or something like that
05:09 - later missiles and we can go ahead and
05:13 - remove the collider here we're not going
05:14 - to be using that and we can go and add a
05:17 - custom material so let's go onto our
05:19 - materials folder right-click create and
05:21 - then material and this is going to be
05:23 - out bullet material and we can drag that
05:26 - onto a bullet and adjust it primarily we
05:29 - want the smoothness down a bit more
05:31 - metallic miss and then we want it to be
05:33 - kinda dark almost entirely black cool so
05:38 - that looks a lot better and now we can
05:41 - take our bullet and turn it in to a
05:42 - prefab by simply dragging it in under
05:44 - our prefabs folder and while we added I
05:47 - think we should go ahead and make a
05:48 - scripts folder here as well so I'm just
05:50 - going to make a new folder called it
05:52 - scripts take all of our scripts move it
05:54 - into that folder okay so uh here we are
05:58 - so the next thing that we want to do
06:01 - well actually we can just go ahead and
06:03 - instantiate this now just to see if that
06:05 - part is working so let's delete the
06:07 - prefab here let's go under our turret
06:10 - script and that has of course moved so
06:12 - we not need to open it from the new
06:14 - location there we go and we need to set
06:17 - up a reference to that bullet so let's
06:19 - make a public game object and this is
06:22 - going to be a bullet prefab and we also
06:24 - need a public transform um which is
06:29 - going to be the point at which we want
06:32 - to spawn our bullets so this is going to
06:34 - be a fire point and this is easier you
06:38 - could also use some kind of vector three
06:39 - offs
06:40 - but if we just use the position of the
06:42 - turret it's going to spawn inside the
06:44 - turret and look super weird so instead
06:46 - we just use an empty game object that we
06:48 - reference as a fire point and that just
06:51 - stores a position and rotation and
06:53 - everything's awesome so yeah so that's
06:57 - great and then we can go down here to
06:59 - our shoot and we can instantiate our
07:02 - bullet prefab add fire point dot
07:06 - position oh that's not right fire point
07:11 - dot position and then our fire point dot
07:13 - rotation as well great so now we have
07:18 - spawned this bullet in and it will not
07:20 - move anywhere and it will not do
07:22 - anything but it should be in the scene
07:24 - so if we go ahead and reference this we
07:27 - need to reference the bullet prefab
07:28 - first and then we are going to need to
07:31 - make a fire point so let's focus in on
07:33 - on turret let's go onto a pot to rotate
07:36 - and create a nod EMT reset the transform
07:38 - call this one fire point and let's shift
07:43 - back into the isometric view here the
07:46 - orthographic view just make sure it's
07:49 - centered there I'll shift to the side
07:51 - view here and let's make it sure it's
07:53 - centered here as well and I'm just going
07:55 - to move it out just a bit from the
07:57 - barrel so that it doesn't overlap with
07:59 - our turret model and something like that
08:01 - looks pretty great so let's hit apply to
08:03 - that and that's also dragging the fire
08:06 - point into the slot there and then hit
08:08 - apply again so great say that and we
08:12 - should be ready to go so we should see
08:15 - that when this locks on to an enemy it
08:18 - creates a bullet and that's awesome but
08:22 - currently it's just floating floating in
08:24 - the air and that looks super weird so
08:28 - let's go ahead and change that so let's
08:30 - add a script to a bullet let that will
08:32 - take care of moving the bullet to where
08:35 - it wants to be and take care of hitting
08:37 - the enemy and stuff like that so it will
08:39 - both move the bullet and do some hit
08:42 - detection so in order to do that let's
08:45 - find a bullet prefab hit add component
08:48 - and call this one bullet and let's just
08:52 - go ahead and move
08:53 - this under the scripts folder right away
08:55 - and let's open it up
08:58 - and let's just reload that that's fine
09:00 - remove systems are collections and what
09:04 - do we want to do here
09:06 - well first off what this bullet needs is
09:09 - a target they need something to pursue
09:11 - and what we want to do is pass on the
09:16 - target that is found under our turd to a
09:20 - bullet so we want to transfer that
09:22 - target that information of what to shoot
09:25 - at to the bullet so it can chase it and
09:29 - what how we do this is we make a private
09:32 - variable in here a private transform and
09:34 - we call this one the target and then we
09:37 - made some kind of public function that
09:41 - we can access if we have a reference to
09:43 - the bullet script that will set the
09:45 - target so we are going to have a public
09:47 - void here and I'm just going to call
09:49 - this seek or chase or whatever and this
09:54 - is going to take in a transform and an
09:57 - argument which is underscored target
09:59 - just so we can differentiate between the
10:01 - two and we're simply going to set it
10:05 - equal to underscore target so the cool
10:09 - thing here is we can simply call the
10:11 - seek method and that will set up
10:12 - everything we need to be set up on the
10:14 - bullet this could also do other stuff
10:18 - such as instantiate some kind of um
10:20 - effect right when the bullet is spawned
10:22 - in or set speed on the bullet stuff like
10:26 - that pass on a damage amount to the
10:29 - bullet all that kind of stuff great so
10:33 - we have the seek variable and now what
10:35 - we want to do is we want to call this
10:36 - from a turret so we want to go into a
10:39 - turret here scroll down to our shoot and
10:43 - first off we need a reference to a
10:45 - bullet that is currently instantiated
10:47 - and we do that by making a temporary
10:49 - variable down here that we are going to
10:51 - call the bullet game object and set by
10:55 - setting that equal to the instantiated
10:57 - object and we of course need to cast
10:59 - this into a actual game object so that
11:03 - is called object casting and it's just a
11:05 - necessity it's just something you need
11:07 - to do excuse me when instantiate objects
11:12 - and wanting to and you want to store
11:14 - them so now we have a reference to a
11:17 - bullet then we can go ahead and grab the
11:19 - bullet script off that game object so
11:22 - let's do that let's store the bullet
11:24 - script here and let's just call this
11:26 - deep poet and let's set this equal to
11:30 - bullet geo dot getcomponent
11:33 - of type bullet so we'll go ahead and
11:37 - find the component on that object and
11:38 - then we can just make sure that this is
11:41 - not null that's always a good idea to do
11:44 - that so if bullet is not equal to null
11:47 - if that's actually a component on that
11:49 - object well then we want to say bullet
11:52 - dot and then we want to use our seek
11:57 - method and then we can pass in here the
11:59 - target that is currently here the target
12:02 - from up here what we're currently
12:05 - shooting at so that's basically all we
12:08 - need to do there then inside of a bullet
12:11 - what we want to make sure is that we
12:14 - have a target because if we don't have a
12:16 - target let's say we start shooting and
12:21 - the enemy reaches the end of the level
12:25 - and therefore we lose HP and the enemy
12:29 - dies then this bullet is going to lose
12:32 - its target and it it's not going to want
12:35 - to find a new one in that case I think
12:37 - the best thing to do is either just let
12:40 - the bullet drop to the ground or simply
12:44 - just destroyed and in our case I think
12:46 - we're going to destroy it so inside of
12:48 - our update method we're going to say if
12:49 - target should be equal to null and this
12:53 - might happen then we want to destroy our
12:56 - game object this game object and then we
12:59 - want to return and the reason why we
13:01 - need to return here is that again
13:03 - destroy sometime sometimes takes a bit
13:06 - before it happens or to process and
13:09 - therefore we don't want it to continue
13:11 - down in our code and while it's doing
13:14 - that so now we are much more safe in our
13:18 - code so we should see this working
13:21 - and we could go in and preview it
13:23 - quickly but I think we are going to have
13:26 - to move on here so let's just move on
13:29 - and basically what we want to do now is
13:31 - we want to find the direction that our
13:35 - bullet needs to point in in order to
13:39 - look directly at its target so we've
13:42 - done some of this before
13:43 - it's a vector3 direction and it's going
13:46 - to be equal to our target that position
13:48 - our end location - our current position
13:51 - so our start location and what we then
13:55 - want to do is we want to go ahead and
13:58 - find out how much we are going to move
14:00 - this particular frame and we do that by
14:03 - first making a speed variable and I am
14:08 - just going to set this to something like
14:10 - 70 and then down here we are going to
14:14 - make a float and this is going to be the
14:15 - time all right arm this is going to be
14:19 - the distance this frame the total amount
14:25 - of the the actual distance that we are
14:27 - going to move this particular frame and
14:29 - that's going to be equal to speed
14:31 - multiplied with time Delta time and then
14:35 - what we can do is we can check if our
14:37 - direction dot magnitude if the length of
14:41 - our direction vector is less than or
14:45 - equal to the distance that we're going
14:48 - to move this frame well then we've hit
14:51 - something so why do we do this well the
14:55 - length of our direction vector this here
14:57 - this is our direction vector and this is
14:59 - the length of it and that is basically
15:02 - the current distance to our target so
15:07 - the distance from a bullet to a target
15:09 - is equal to the direction magnitude and
15:12 - if that is less than the distance that
15:15 - we are going to move this frame that
15:16 - means that we've basically already hit
15:19 - the object that means that if we
15:20 - actually do the movement we're going to
15:22 - overshoot and we don't want that we want
15:25 - our object to hit before we move past
15:28 - our target so inside of this if
15:33 - statement we are going to have logic for
15:34 - whenever
15:35 - we hit our target so let's go ahead and
15:37 - make a function called hit target and
15:40 - other than that I don't think we need
15:44 - anything in there I think we just need
15:45 - to call that and then yeah of course we
15:48 - could go ahead and and just return here
15:50 - and then down here that means we haven't
15:52 - yet hit our target and so we actually
15:55 - want to move and we do that using
15:56 - transform dot translate and the amount
16:01 - we want to move here our actual
16:03 - translation is going to be our direction
16:06 - that normalized multiplied with our
16:09 - distance this frame again we normalize
16:11 - it to make sure that however close we
16:14 - are to the object doesn't have an effect
16:16 - on how fast we're moving we want to move
16:18 - at a constant speed and this is going to
16:21 - be our constant speed and we want to
16:25 - move relative to the world space not the
16:28 - local space and that's important or
16:30 - you're going to get these weird circular
16:33 - almost orbital behaviors yeah it's not
16:37 - something you desire trust me cool and I
16:41 - think I think that was pretty much it
16:45 - then the last thing that we need to do
16:47 - in here is add some kind of logic for it
16:50 - whenever we hit something
16:51 - but let's go ahead and do that in just a
16:53 - second so let's just make the hit target
16:56 - down here and let's debug that lock we
17:00 - hit something just to see if it's
17:04 - currently working so let's go ahead and
17:05 - hit play here and let's find out if this
17:09 - is working so let's find out turret all
17:12 - of this is set up we find out bullet of
17:15 - that is set up let's do this so let's
17:18 - hit on play and wait for a enemy to move
17:21 - inside of our range here and you can see
17:24 - that our bullet jumps to that location
17:27 - you can see it keeps following but the
17:29 - shooting itself looks really really nice
17:34 - so and I spelled something wrong but
17:38 - yeah
17:39 - it's working and it's registering that
17:40 - we hit something so what we can do now
17:43 - is we can go ahead and just destroy our
17:46 - bullet whenever we hit something
17:48 - so that
17:48 - just right here just destroy our bullet
17:52 - which is game object there we go and
17:55 - then we can answer instantiate some hit
17:57 - particles so let's go ahead and just
17:59 - very quickly create some cool particles
18:02 - that will spawn and in order to do this
18:05 - that's right-click create a particle
18:08 - system reset the transform on this again
18:12 - reset the transform let's move this over
18:15 - here just so we can see kind of what it
18:17 - looks like in context yeah and then
18:22 - let's set the duration to 2 1 let's do 1
18:25 - let's keep looping on emission is going
18:28 - to be with the rate of 0 let's do a
18:31 - burst instead here so comes out in
18:33 - bursts like that and it's going to be
18:36 - true between 5 and 10 particles the our
18:39 - renderer is going to be kind of
18:41 - different we're going to make a new
18:43 - material first of all and this is going
18:45 - to be our bullet impact material and
18:50 - just drag it on there there and then
18:53 - drag it into the particle system here
18:56 - there we go and we're going to change
18:59 - this from billboard to mesh and it's
19:01 - going to be a cube mesh so that's
19:03 - already working so that's fine all these
19:05 - settings should just be fine we
19:07 - definitely want some shadows in there
19:09 - they look nice we can go ahead and take
19:11 - a bullet impact and make this a lot
19:13 - darker make it more metallic not as
19:15 - smooth something like that kind of the
19:19 - same style as our bullet itself so it
19:21 - almost looks like our polished bullet
19:23 - shatters and then becomes this but I do
19:26 - want to be able to control it
19:28 - independently so this is fine and we can
19:31 - go back to our particle system we can go
19:34 - in here and set our start speed to a
19:36 - random between two constant and that's
19:39 - going to be between 0 and 5 something
19:43 - like that looks nice then we can take
19:45 - our shape change it into a sphere cool
19:49 - then we can add a gravity modifier which
19:52 - is going to be one and then we can go in
19:55 - here and change the size to maybe point
19:59 - two and we can maybe randomize the size
20:02 - just a bit so between point one and
20:05 - point two five there we go so we have
20:09 - some random size that's maybe a bit two
20:13 - months 0.15 that we go that looks really
20:17 - nice then we're going to add some
20:19 - bounciness to these we are going to
20:20 - actually make them collide with our
20:22 - environment and we do that by going down
20:24 - here enabling collision changing whoops
20:28 - changing our collision to world 3d we
20:33 - want to damin it by something like point
20:35 - eight and you can see currently they're
20:38 - going right through here and the reason
20:40 - why is we need to go into our
20:41 - environments like all of our ground
20:43 - planes and add a box Collider there we
20:47 - go and we deleted those in an earlier
20:50 - episode but I didn't think of we
20:51 - wouldn't think that we would need them
20:53 - for for this but we we would and we can
20:57 - maybe damming them just a bit less
20:59 - something like point six that's a bit
21:02 - more cartoonish I think that's pretty
21:04 - fun we can change the lifetime here to
21:06 - one actually let's do a lifetime of two
21:10 - and they will sink into the ground here
21:13 - that's not much we can do about that I
21:15 - think it's fine let's change the
21:17 - collision quality to medium and yeah I
21:23 - think we're getting there the shape we
21:25 - can just make that a bit smaller
21:27 - something like point two because we want
21:30 - them to just explode from a single point
21:33 - and yeah I think that's pretty much it
21:36 - and then we can maybe make them shrink
21:38 - when they are over with their lifetime
21:42 - so let's go and add a size of a lifetime
21:44 - add a key to this and just add a small
21:46 - fade-out in size at the very end there
21:51 - we go so we can go ahead and rename this
21:53 - to our bullet impact effect and we can
21:58 - make it into a prefab and we can delete
22:01 - it from our scene then we can go into
22:03 - visual studio add a reference to that
22:05 - prefab up here public and this is going
22:09 - to be a game object and this is going to
22:10 - be our impact effect and
22:16 - down here we then want to instantiate
22:17 - our impact effect at our current
22:22 - position and using our current rotation
22:24 - as well as well and that should be it
22:29 - for that we could go ahead and clean
22:32 - this up in the hierarchy let's just do
22:33 - that so game object store a temporary
22:36 - reference and this is going to be our
22:39 - effect instance and we're going to set
22:42 - that equal to that and cast it into a
22:45 - game object and then we can destroy that
22:48 - effect instance after let's say two
22:53 - seconds this way it won't clutter up the
22:56 - hierarchy and now let's try and hit play
22:59 - on this and see if it works whoops I
23:02 - need the thing we need to reference the
23:05 - impact effect of course on a bullet
23:07 - dragging that in there so now let's hit
23:11 - play and hopefully this will work so see
23:14 - and it's working beautifully so I think
23:17 - that's a really nice effect I really
23:20 - like what that does you will notice it
23:21 - just glitches out and that's because I
23:23 - forgot to turn off looping so just very
23:25 - quickly loops and then it gets destroyed
23:26 - and that should fix it right there
23:29 - and what we can also do is we can go
23:31 - ahead and just destroy our enemy for now
23:33 - later we will have just our destroyed
23:37 - target game object later we will have
23:40 - some kind of way of damaging our enemies
23:42 - so they will need some kind of stats or
23:45 - something but for now we can just
23:47 - destroy them so all the turrets will be
23:49 - super powerful so you can see that looks
23:51 - super nice and will definitely do more
23:54 - of this stuff later but for now that was
23:57 - it so I hope you enjoyed this video
23:58 - thanks for watching and I'll see you in
24:01 - the next one so I'm going to start
24:03 - mentioning patreon supporters the
24:04 - following month after they donate so
24:07 - that there won't be any difference from
24:09 - donating at the beginning of the month
24:10 - to the end of the month this way
24:12 - everyone will get a full month of
24:14 - mentions and yeah everyone will be happy
24:17 - so just wait for it on the next month
24:20 - and you will see your name here so
24:21 - thanks for watching and I'll see you
24:23 - soon

Cleaned transcript:

thanks for tuning in at brakus hello and welcome to video number five on creating a tower defense game in unity me today we are going to be continuing with our turret while specifically we are going to make it shoot some stuff so that's going to be super super fun so you can see there I'm here in unity and what I want to do is I want to select my turret and open up the charge script this is a pretty good place to add our shooting mechanics because we already have this target variable available to us so let's begin by adding a variable here and this is going to be our fire rate and I'm just going to default this to 1 meaning we will fire one bullet each second then next we need a R that's not right we need this to be a public float there we go next up we need a private variable a private float to be specific and this is going to be our fire countdown and it's basically going to start at zero so we can fire right away and then once we fired it's going to be set equal to one divided by a fire rate so if we can say shoot one time each second that means that our fire countdown will be set to 1 and then it will countdown every time we draw a frame until it reaches zero and then we can shoot again and so it will continue and this just make sure that we have our shooting on some kind of fixed update so inside of our update method here what we're going to do is we're simply going to say if our fire countdown is less than or equal to zero meaning it's time to shoot now well then we want to shoot and we're going to make this method in a second and then we're going to set our 5 countdown equal to 1 divided by our fire rate so you can see here very quickly that if our fire rate is 2 that means we want to fire two bullets each second that means that it should count down from point five okay so cool now we have that set up now we just need to make sure that a fire countdown actually counts down so we want to decrease this by a small amount each each frame and we do that by saying fire countdown equals time time so again this will make sure that every second fire countdown will repeat be reduced by one good we've done this before it's very similar to the logic we used in the wave spawning so now we can create our shoot variable and we just say void shoot here and we are going to have some different stuff in here we are going to be instantiated and Boulud and we are going to set it be setting a target for that bullet but for now let's just do a debug that lark statement called shoot just see if things are working so let's jump into unity here you see our variables pop up there is the fire rate and now we can hit play here and we should see that when it locks on to target it says shoot with an interval of 0.5 seconds so that's perfect now what I want to do is just be a bit more organized in the way we have variables set up here more specifically how they look in the inspector because once you get to have more than five or six variables it can be a bit confusing so what we do here is take a fire rate and fire countdown and move them up on to where our range is placed and then let's separate that from our target and what we can do is add a header and this header is going to say attributes so these are the things that we can that can vary from one turret to the to another these are things that maybe can be upgraded or changed and then we're going to make another header down here which is just going to be unity set up fields or something like that just to let people know that this is things that unity requires for us to do this it's not something that should be changed by the user and this should just organize things a bit better here so we have the attributes and we have the unity set up fields in general use header files a lot it it really makes for it very easily makes for a better interface when working with your own scripts great so now we can go ahead and actually add this shoot functionality but we have to have something to instantiate so let's go ahead and make a bullet so let's rightclick go on the 3d option and selects fear and this is going to be whoa we don't want this on the chart and this is going to be a very very simple model just reset that focus in on it and move it up a bit and I'm going to make this a size of let's say point five or six point six point six point six something like that just so it's clear when viewed from a distance but so it doesn't like look silly when coming out of a bell that is probably a lot smaller but yeah this is going to be fine actually let's do yeah look here that this great and let's rename this to pull it and this is just going to be a standard bullet we can have other stuff like rockets or something like that later missiles and we can go ahead and remove the collider here we're not going to be using that and we can go and add a custom material so let's go onto our materials folder rightclick create and then material and this is going to be out bullet material and we can drag that onto a bullet and adjust it primarily we want the smoothness down a bit more metallic miss and then we want it to be kinda dark almost entirely black cool so that looks a lot better and now we can take our bullet and turn it in to a prefab by simply dragging it in under our prefabs folder and while we added I think we should go ahead and make a scripts folder here as well so I'm just going to make a new folder called it scripts take all of our scripts move it into that folder okay so uh here we are so the next thing that we want to do well actually we can just go ahead and instantiate this now just to see if that part is working so let's delete the prefab here let's go under our turret script and that has of course moved so we not need to open it from the new location there we go and we need to set up a reference to that bullet so let's make a public game object and this is going to be a bullet prefab and we also need a public transform um which is going to be the point at which we want to spawn our bullets so this is going to be a fire point and this is easier you could also use some kind of vector three offs but if we just use the position of the turret it's going to spawn inside the turret and look super weird so instead we just use an empty game object that we reference as a fire point and that just stores a position and rotation and everything's awesome so yeah so that's great and then we can go down here to our shoot and we can instantiate our bullet prefab add fire point dot position oh that's not right fire point dot position and then our fire point dot rotation as well great so now we have spawned this bullet in and it will not move anywhere and it will not do anything but it should be in the scene so if we go ahead and reference this we need to reference the bullet prefab first and then we are going to need to make a fire point so let's focus in on on turret let's go onto a pot to rotate and create a nod EMT reset the transform call this one fire point and let's shift back into the isometric view here the orthographic view just make sure it's centered there I'll shift to the side view here and let's make it sure it's centered here as well and I'm just going to move it out just a bit from the barrel so that it doesn't overlap with our turret model and something like that looks pretty great so let's hit apply to that and that's also dragging the fire point into the slot there and then hit apply again so great say that and we should be ready to go so we should see that when this locks on to an enemy it creates a bullet and that's awesome but currently it's just floating floating in the air and that looks super weird so let's go ahead and change that so let's add a script to a bullet let that will take care of moving the bullet to where it wants to be and take care of hitting the enemy and stuff like that so it will both move the bullet and do some hit detection so in order to do that let's find a bullet prefab hit add component and call this one bullet and let's just go ahead and move this under the scripts folder right away and let's open it up and let's just reload that that's fine remove systems are collections and what do we want to do here well first off what this bullet needs is a target they need something to pursue and what we want to do is pass on the target that is found under our turd to a bullet so we want to transfer that target that information of what to shoot at to the bullet so it can chase it and what how we do this is we make a private variable in here a private transform and we call this one the target and then we made some kind of public function that we can access if we have a reference to the bullet script that will set the target so we are going to have a public void here and I'm just going to call this seek or chase or whatever and this is going to take in a transform and an argument which is underscored target just so we can differentiate between the two and we're simply going to set it equal to underscore target so the cool thing here is we can simply call the seek method and that will set up everything we need to be set up on the bullet this could also do other stuff such as instantiate some kind of um effect right when the bullet is spawned in or set speed on the bullet stuff like that pass on a damage amount to the bullet all that kind of stuff great so we have the seek variable and now what we want to do is we want to call this from a turret so we want to go into a turret here scroll down to our shoot and first off we need a reference to a bullet that is currently instantiated and we do that by making a temporary variable down here that we are going to call the bullet game object and set by setting that equal to the instantiated object and we of course need to cast this into a actual game object so that is called object casting and it's just a necessity it's just something you need to do excuse me when instantiate objects and wanting to and you want to store them so now we have a reference to a bullet then we can go ahead and grab the bullet script off that game object so let's do that let's store the bullet script here and let's just call this deep poet and let's set this equal to bullet geo dot getcomponent of type bullet so we'll go ahead and find the component on that object and then we can just make sure that this is not null that's always a good idea to do that so if bullet is not equal to null if that's actually a component on that object well then we want to say bullet dot and then we want to use our seek method and then we can pass in here the target that is currently here the target from up here what we're currently shooting at so that's basically all we need to do there then inside of a bullet what we want to make sure is that we have a target because if we don't have a target let's say we start shooting and the enemy reaches the end of the level and therefore we lose HP and the enemy dies then this bullet is going to lose its target and it it's not going to want to find a new one in that case I think the best thing to do is either just let the bullet drop to the ground or simply just destroyed and in our case I think we're going to destroy it so inside of our update method we're going to say if target should be equal to null and this might happen then we want to destroy our game object this game object and then we want to return and the reason why we need to return here is that again destroy sometime sometimes takes a bit before it happens or to process and therefore we don't want it to continue down in our code and while it's doing that so now we are much more safe in our code so we should see this working and we could go in and preview it quickly but I think we are going to have to move on here so let's just move on and basically what we want to do now is we want to find the direction that our bullet needs to point in in order to look directly at its target so we've done some of this before it's a vector3 direction and it's going to be equal to our target that position our end location our current position so our start location and what we then want to do is we want to go ahead and find out how much we are going to move this particular frame and we do that by first making a speed variable and I am just going to set this to something like 70 and then down here we are going to make a float and this is going to be the time all right arm this is going to be the distance this frame the total amount of the the actual distance that we are going to move this particular frame and that's going to be equal to speed multiplied with time Delta time and then what we can do is we can check if our direction dot magnitude if the length of our direction vector is less than or equal to the distance that we're going to move this frame well then we've hit something so why do we do this well the length of our direction vector this here this is our direction vector and this is the length of it and that is basically the current distance to our target so the distance from a bullet to a target is equal to the direction magnitude and if that is less than the distance that we are going to move this frame that means that we've basically already hit the object that means that if we actually do the movement we're going to overshoot and we don't want that we want our object to hit before we move past our target so inside of this if statement we are going to have logic for whenever we hit our target so let's go ahead and make a function called hit target and other than that I don't think we need anything in there I think we just need to call that and then yeah of course we could go ahead and and just return here and then down here that means we haven't yet hit our target and so we actually want to move and we do that using transform dot translate and the amount we want to move here our actual translation is going to be our direction that normalized multiplied with our distance this frame again we normalize it to make sure that however close we are to the object doesn't have an effect on how fast we're moving we want to move at a constant speed and this is going to be our constant speed and we want to move relative to the world space not the local space and that's important or you're going to get these weird circular almost orbital behaviors yeah it's not something you desire trust me cool and I think I think that was pretty much it then the last thing that we need to do in here is add some kind of logic for it whenever we hit something but let's go ahead and do that in just a second so let's just make the hit target down here and let's debug that lock we hit something just to see if it's currently working so let's go ahead and hit play here and let's find out if this is working so let's find out turret all of this is set up we find out bullet of that is set up let's do this so let's hit on play and wait for a enemy to move inside of our range here and you can see that our bullet jumps to that location you can see it keeps following but the shooting itself looks really really nice so and I spelled something wrong but yeah it's working and it's registering that we hit something so what we can do now is we can go ahead and just destroy our bullet whenever we hit something so that just right here just destroy our bullet which is game object there we go and then we can answer instantiate some hit particles so let's go ahead and just very quickly create some cool particles that will spawn and in order to do this that's rightclick create a particle system reset the transform on this again reset the transform let's move this over here just so we can see kind of what it looks like in context yeah and then let's set the duration to 2 1 let's do 1 let's keep looping on emission is going to be with the rate of 0 let's do a burst instead here so comes out in bursts like that and it's going to be true between 5 and 10 particles the our renderer is going to be kind of different we're going to make a new material first of all and this is going to be our bullet impact material and just drag it on there there and then drag it into the particle system here there we go and we're going to change this from billboard to mesh and it's going to be a cube mesh so that's already working so that's fine all these settings should just be fine we definitely want some shadows in there they look nice we can go ahead and take a bullet impact and make this a lot darker make it more metallic not as smooth something like that kind of the same style as our bullet itself so it almost looks like our polished bullet shatters and then becomes this but I do want to be able to control it independently so this is fine and we can go back to our particle system we can go in here and set our start speed to a random between two constant and that's going to be between 0 and 5 something like that looks nice then we can take our shape change it into a sphere cool then we can add a gravity modifier which is going to be one and then we can go in here and change the size to maybe point two and we can maybe randomize the size just a bit so between point one and point two five there we go so we have some random size that's maybe a bit two months 0.15 that we go that looks really nice then we're going to add some bounciness to these we are going to actually make them collide with our environment and we do that by going down here enabling collision changing whoops changing our collision to world 3d we want to damin it by something like point eight and you can see currently they're going right through here and the reason why is we need to go into our environments like all of our ground planes and add a box Collider there we go and we deleted those in an earlier episode but I didn't think of we wouldn't think that we would need them for for this but we we would and we can maybe damming them just a bit less something like point six that's a bit more cartoonish I think that's pretty fun we can change the lifetime here to one actually let's do a lifetime of two and they will sink into the ground here that's not much we can do about that I think it's fine let's change the collision quality to medium and yeah I think we're getting there the shape we can just make that a bit smaller something like point two because we want them to just explode from a single point and yeah I think that's pretty much it and then we can maybe make them shrink when they are over with their lifetime so let's go and add a size of a lifetime add a key to this and just add a small fadeout in size at the very end there we go so we can go ahead and rename this to our bullet impact effect and we can make it into a prefab and we can delete it from our scene then we can go into visual studio add a reference to that prefab up here public and this is going to be a game object and this is going to be our impact effect and down here we then want to instantiate our impact effect at our current position and using our current rotation as well as well and that should be it for that we could go ahead and clean this up in the hierarchy let's just do that so game object store a temporary reference and this is going to be our effect instance and we're going to set that equal to that and cast it into a game object and then we can destroy that effect instance after let's say two seconds this way it won't clutter up the hierarchy and now let's try and hit play on this and see if it works whoops I need the thing we need to reference the impact effect of course on a bullet dragging that in there so now let's hit play and hopefully this will work so see and it's working beautifully so I think that's a really nice effect I really like what that does you will notice it just glitches out and that's because I forgot to turn off looping so just very quickly loops and then it gets destroyed and that should fix it right there and what we can also do is we can go ahead and just destroy our enemy for now later we will have just our destroyed target game object later we will have some kind of way of damaging our enemies so they will need some kind of stats or something but for now we can just destroy them so all the turrets will be super powerful so you can see that looks super nice and will definitely do more of this stuff later but for now that was it so I hope you enjoyed this video thanks for watching and I'll see you in the next one so I'm going to start mentioning patreon supporters the following month after they donate so that there won't be any difference from donating at the beginning of the month to the end of the month this way everyone will get a full month of mentions and yeah everyone will be happy so just wait for it on the next month and you will see your name here so thanks for watching and I'll see you soon
