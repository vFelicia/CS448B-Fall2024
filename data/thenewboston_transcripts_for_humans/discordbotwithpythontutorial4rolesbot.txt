With timestamps:

00:00 - all righty everyone welcome back to
00:02 - another tutorial and first of all what
00:05 - i'm gonna do is change my microphone
00:07 - settings to see if there is less of an
00:09 - echo so
00:10 - if this is a little bit better in terms
00:12 - of the echo i got some feedback about
00:15 - that then uh please let me know
00:17 - now aside from all that
00:19 - what we're going to be doing in this
00:20 - video is we are going to be learning how
00:23 - to create a discord roles bot
00:26 - now i'm sure you have seen something
00:27 - like this before if you've been part of
00:29 - you know a few discord servers
00:32 - and what this means is that there's
00:34 - generally like a message that says if
00:37 - you react with a certain emoji then
00:39 - you're gonna get a certain type of role
00:41 - and for those just starting out in
00:43 - discord
00:44 - that if you don't know what a role is
00:46 - it's basically these little things right
00:48 - here where users are grouped into
00:52 - different like categories or sections
00:54 - they're technically called roles
00:55 - now on the new boss boston discord
00:57 - server
00:58 - we have our roles basically broken out
01:01 - into how we structure our teams so
01:03 - there's a moderator role of course they
01:05 - have like more permissions than the
01:06 - normal user they can ban people so on
01:09 - and so forth
01:10 - and then the rest of these roles like uh
01:12 - blockchain community team design team
01:14 - those roles just have uh special
01:16 - permissions so they can access different
01:18 - channels like the design team can access
01:21 - the design channel so that is what we
01:23 - are going to be creating however before
01:25 - we jump right into that what i would
01:28 - like to do is go over the basics of
01:30 - classes versus decorators when
01:33 - structuring our discord bot
01:36 - so
01:37 - okay what the heck am i talking about
01:38 - classes decorators what's all this about
01:41 - so
01:42 - before what we did in all of the
01:45 - previous tutorials up to now whenever we
01:47 - wanted to create a discord bot what we
01:49 - did is we created a client object and
01:51 - this client object was just a connection
01:53 - to discord
01:54 - now whenever we wanted to listen for a
01:58 - certain event for example on ready or on
02:00 - message what we did is we
02:03 - added this decorator above the function
02:06 - name now in this tutorial we are not
02:09 - going to be using this method we are
02:10 - going to be using an alternative method
02:13 - however just to give you guys a quick
02:15 - comparison
02:17 - what i'm going to do is actually
02:19 - i can do this actually
02:23 - so i'll show you guys the old method
02:25 - above in a comment and i'll keep it here
02:27 - so we have a little reference to it and
02:30 - then below i'll show you the alternative
02:33 - of how we're going to be writing this
02:37 - all right so this was the old method
02:39 - before where again just to recap one
02:41 - more time is we got a connection to
02:43 - discord and then we registered an event
02:45 - and then we ran our client or our bot
02:49 - now alternatively what we are going to
02:51 - be doing let me scroll out just a little
02:53 - bit
02:55 - and collapse this
02:58 - is we can actually create our own custom
03:01 - class and instead of just having a
03:04 - reference
03:05 - to this class and creating our own
03:07 - object from it we can actually make our
03:09 - own class and to do this we just write
03:12 - class and you can actually name anything
03:14 - you want i'll just name it my client to
03:16 - keep things simple
03:18 - and again like i said instead of just
03:20 - getting a reference to this
03:22 - discord.client class what we're going to
03:23 - be doing is inheriting from it so more
03:26 - or less we're going to be writing our
03:28 - own custom discord bot client
03:32 - now the first method that you wanna
03:34 - write in this is just the dunder init so
03:36 - death
03:37 - thunder and knit
03:39 - and what this is gonna take is not only
03:42 - self but your basic argument args
03:45 - and your keyword arguments which are
03:48 - referenced as quarks
03:50 - and
03:51 - the reason that we want to accept these
03:53 - is because we want to pass these along
03:55 - whenever we're initializing this parent
03:58 - class
03:59 - so in order to do that what we need to
04:02 - call is super and all super is is it
04:04 - gets a reference to your parent class so
04:07 - super basically equals discord.client
04:10 - and then on this
04:12 - we want to call its init method
04:17 - and then i'm just going to be stealing
04:18 - these too lazy to uh type those out
04:21 - and all right
04:23 - so again the first thing we want to do
04:24 - is we want to basically say hey we're
04:27 - making our own custom discord bot it's
04:30 - going to be inheriting from
04:31 - discord.client and then whenever we
04:34 - initialize our own custom one we also
04:37 - just want to run the initialization
04:38 - logic from discord.client pretty much
04:41 - acting as a router so we don't have to
04:43 - write all of that custom initialization
04:45 - logic
04:46 - and now
04:47 - instead of writing these methods like
04:50 - async def on ready and having a
04:52 - decorator above each one since that was
04:54 - you know a bit tedious what we can do is
04:57 - we can have a reference to those now
05:00 - since this is a class method we want to
05:02 - just pass in self
05:04 - and then what did we print just to keep
05:07 - things consistent okay print online let
05:09 - me change that to ready i like that a
05:10 - little bit better
05:14 - and alright print ready just like that
05:18 - now the last thing that we need to do is
05:20 - this
05:21 - so instead of
05:23 - this client object having a reference to
05:26 - discord.client because that is pretty
05:29 - much what we did before we can now
05:31 - reference
05:32 - my client which is our custom bot
05:36 - so again if i zoom out a little bit you
05:39 - can see that
05:40 - this
05:41 - right here
05:42 - is basically the equivalent of this
05:45 - right here the only difference is this
05:48 - is how you can make a bot using
05:49 - decorators and this is how you can write
05:51 - your own custom bot
05:53 - so you can
05:55 - you pretty much can avoid using
05:56 - decorators this way and it um allows for
05:58 - a little bit more cleaner code base so
06:01 - this is a structure that we're going to
06:02 - be using for this rolls bot now even
06:05 - though this is the basic framework for a
06:08 - class-based discord bot what we want to
06:11 - do in this tutorial series is we want to
06:14 - give our bot some extra permissions
06:17 - and this is because we are going to be
06:19 - working with roles which includes
06:22 - members
06:23 - and if you remember back from my either
06:25 - the first or second tutorial where i
06:27 - talked about intents
06:29 - and i said that in discord intents are
06:31 - basically groups of events well one of
06:35 - those intents are the members intents
06:37 - and if you want to work with users like
06:38 - we're going to be doing or excuse me
06:40 - members which we're going to be doing
06:42 - because we're going to be giving them
06:43 - roles and taking roles away from them
06:46 - then we just need to enable these
06:48 - specific
06:49 - types of intents
06:51 - so to do this
06:53 - i'm just going to call this intense and
06:55 - this is equal to
06:57 - discord dot
06:58 - intense
07:00 - dot
07:01 - default
07:04 - all right so this intense object is just
07:06 - equal to the discord um default intents
07:09 - nothing's changed and this is what we
07:11 - get with our
07:12 - um standard bot however what we want to
07:15 - do for this is we want to enables the
07:18 - members intents so there's a property on
07:21 - here called members
07:22 - and we just want to toggle this to true
07:26 - and then whenever we initialize our
07:28 - custom bob what we want to do is take
07:30 - this
07:31 - and pretty much say that the intents
07:35 - that you're going to be working with are
07:36 - now equal to our custom intents and
07:39 - those are pretty much all the default
07:40 - ones with
07:42 - the members equals true basically saying
07:45 - hey discord bot we can now work with
07:47 - those members events
07:49 - now i also have some links right here
07:51 - that i'm going to include which is just
07:53 - some documentations around intents i
07:56 - think i might have included this before
07:57 - but just in case you guys want to read
07:59 - over any documentation make sure to
08:01 - include that right there
08:03 - all right so let's go ahead and recap
08:06 - exactly what we're going to be doing in
08:08 - this tutorial series and that is this
08:11 - we will create a couple roles
08:14 - and then what we will do is we'll have a
08:16 - message we'll just have it in this
08:17 - general channel for now and we'll say
08:20 - if you want a role
08:23 - then reply
08:25 - with one of these
08:28 - emojis
08:30 - and let's say if you want a custom roll
08:34 - then how do you spell emojis is there an
08:35 - e who knows
08:37 - all right and then let's just pick three
08:39 - emojis
08:41 - let's uh let's go with
08:42 - the potato
08:44 - it's one of my faves
08:46 - and then what else can we do uh
08:50 - we can have this chocolate right here
08:52 - and then let's uh
08:55 - none of these look very cool
08:58 - let's go with the monkey all right
09:01 - so our emojis that we're gonna be using
09:03 - is potato the chocolate and the monkey
09:07 - and all right let me just go ahead and
09:09 - copy that now
09:11 - what our bot is going to do is it's
09:14 - actually going to listen for any of
09:15 - these reactions or emojis that anyone
09:18 - responds with on this specific message
09:22 - so what we need is a reference to this
09:24 - message id
09:26 - and the easiest way to actually get this
09:27 - is if you just copy message link
09:30 - then what you can do is
09:32 - again i'm just going to paste it in
09:33 - somewhere real quick
09:35 - is this last
09:36 - id right here is the message id so eight
09:39 - nine yadda yadda yadda 836
09:42 - again this is probably not the most um
09:45 - formal way to do it but it's definitely
09:46 - the quickest
09:48 - so what we need is a reference to that
09:49 - message id since we're going to be
09:51 - checking of all the messages that our
09:53 - bot is listening to we want to match it
09:56 - because
09:57 - we only want to give them a row if they
09:58 - respond to um
10:00 - that specific message so i'm just going
10:02 - to name it target message
10:05 - id
10:06 - and i'm going to say it's equal to this
10:09 - message right here so anyways to recap
10:11 - the target message
10:13 - is equal to this message right here
10:17 - all right so where do we go from here
10:18 - well remember like we said we want to
10:21 - give the user a specific role whenever
10:22 - they react with one of those emojis but
10:25 - in order to do that a key part of that
10:28 - is actually having those roles available
10:30 - on our discord server so in order to
10:32 - create your role just go to your server
10:35 - settings and then roles and then you can
10:38 - i'm sure you can guess it press this
10:39 - button that says create role
10:41 - and then you can give your role a name
10:43 - so remember we have three emojis one is
10:45 - the potato one is the chocolate and one
10:47 - is the monkey
10:48 - so for the potato i'm just going to say
10:50 - whenever users click that they're going
10:52 - to get a roll called
10:53 - potato person
10:55 - and we'll just give it this green color
10:58 - and what we want to do is we want to
10:59 - display roll members separately from
11:01 - online members and that just makes sure
11:03 - that they appear separately on that um
11:05 - little user list on the right hand side
11:09 - and that is pretty much all we need for
11:11 - this again it's not going to have any
11:12 - special permissions we're just going to
11:14 - pretty much display them separately
11:17 - so save that and then if we go back we
11:19 - can create these other roles
11:22 - so the next one of the chocolates we
11:24 - will say
11:27 - chocolate lover
11:28 - and this one can be blue and of course
11:32 - the same thing
11:33 - change and then back create a new one
11:37 - and the third one was the monkey so
11:39 - we'll say uh funky monkey again not very
11:42 - uh creative but they're the first things
11:44 - that i could think of right now
11:46 - so of course want to display that
11:47 - separately too
11:48 - save changes
11:50 - and all right
11:52 - so now if we go back to roles we can see
11:54 - that we have um four different rolls
11:57 - these are the ones that we just created
11:58 - potato person
12:00 - chocolate love and i actually meant to
12:01 - change that to chocolate lover
12:05 - and funky monkey
12:07 - all right cool cool cool so all the spot
12:09 - is going to do is it's going to have two
12:11 - methods one is listening to when they
12:14 - add one of these emojis and one is
12:17 - listening to when they remove one of
12:19 - these emojis from the message of course
12:21 - whenever they add or respond with these
12:23 - emojis we're going to give them a roll
12:25 - and whenever they remove this emoji
12:27 - we're going to take the roll away from
12:28 - them so first let's go ahead and make
12:31 - sure that we can give them a roll
12:33 - so back in our so source code can't talk
12:36 - today what we do is
12:40 - the method for this is on
12:42 - raw
12:44 - reaction add
12:46 - and what this is going to take is self
12:49 - and then the payload
12:52 - all right
12:53 - and then i'll leave a comment here and
12:55 - then we can say that this method is
12:57 - going to um
12:59 - give a role based on
13:02 - a
13:03 - reaction emoji
13:06 - now again remember we only want to
13:08 - listen if they replied with the emoji on
13:10 - this specific message so
13:13 - similar to before what we want to do is
13:15 - we just want to compare the payload
13:18 - message id to this target message id
13:21 - since this is the message that we just
13:22 - created
13:23 - and
13:24 - if it doesn't match then we're just
13:25 - going to return because we don't really
13:27 - care about
13:28 - those payloads
13:29 - so if the payload
13:32 - dot message id
13:35 - is not equal to
13:37 - then we can just copy this
13:40 - self.target dot message id then what we
13:43 - can do is just return and pretty much
13:45 - ignore those payloads
13:48 - now the next thing that we want is a
13:50 - reference to the guild
13:52 - now in discord documentation whenever
13:55 - you see guild it basically just means
13:58 - the discord server
14:00 - so this new boston this is a guild right
14:02 - here in this tnb tutorials this server i
14:05 - made for this tutorial series this is a
14:07 - guild
14:08 - and the reason for that is that this bot
14:10 - can actually be running on multiple
14:13 - servers
14:14 - now we only want to get a reference to
14:16 - the roles on this server aka this guild
14:19 - so that is you know just a little bit of
14:22 - background of that
14:23 - of why we are plucking out the guild
14:26 - so the guild is equal to the client dot
14:29 - get guild
14:31 - and what we need to pass in is actually
14:33 - the guild id
14:35 - so on this payload object there's
14:38 - actually a guild
14:42 - id
14:44 - that we can call so in short what this
14:46 - is going to do is whenever they add an
14:48 - emoji to a message we're just going to
14:50 - get the guild from where that emoji was
14:53 - coming from
14:54 - so now we can get to the good stuff and
14:56 - that is making sure we give them a role
14:59 - whenever they respond with one of those
15:01 - specific emojis so what we are going to
15:03 - be doing is we are going to be looking
15:05 - at this payload object
15:08 - and we are going to be taking the emoji
15:10 - property off it and looking at the name
15:13 - property so payload.emoji.name
15:16 - and we're going to see if it matches
15:17 - either the potato the chocolate or the
15:19 - monkey and if so then we can just give
15:21 - them that roll
15:23 - so
15:24 - to get this actual name i want to show
15:26 - you something that i want to make sure
15:27 - you don't run into
15:29 - if you just copy for example this potato
15:32 - right here and you paste it in it's
15:34 - going to convert it to the text based um
15:37 - version of that emoji however we want
15:40 - i don't even know how to say this but
15:42 - we want the actual raw potato and i
15:45 - don't mean raw uncooked i just mean raw
15:47 - is in code
15:48 - so anyways if you just go ahead and and
15:51 - this is kind of a shortcut at least how
15:53 - i do it if we print out
15:55 - payload.emoji.name
15:59 - and we can actually just run the spot
16:01 - right here so again all that's going to
16:03 - happen right now is whenever they add a
16:06 - reaction to that message it's just going
16:08 - to print out the payload emoji name in
16:10 - the terminal and i'll show you guys why
16:13 - so let me run this
16:15 - and alright it is ready
16:17 - now back in discord let me actually
16:19 - reply with this
16:21 - potato
16:23 - and just to show you guys what's going
16:24 - on real quick instead of the name potato
16:27 - it's going to print out the actual
16:28 - potato
16:29 - and the reason
16:31 - that we wanted to do this again is
16:33 - because we actually want to use this in
16:35 - the source code to compare it to the
16:36 - name property
16:38 - and just so i don't have to run this
16:40 - again doing my same little test back in
16:43 - discord i'm also going to respond with
16:45 - the
16:47 - chocolate and the monkey
16:51 - all right
16:52 - so again all i'm doing uh right now is i
16:55 - just wanted a reference to these so i
16:56 - can kind of copy them and paste them in
16:58 - my source code
16:59 - so all right
17:01 - i'm
17:02 - actually i don't want to stop that
17:03 - because i think uh
17:05 - i'm worried that this might disappear
17:06 - but either way
17:09 - now that we have that available in our
17:12 - source code we can say if the
17:14 - payload.emoji.name
17:16 - is equal to this potato
17:21 - then under here
17:22 - i'm going to write past right now but
17:24 - again what we're going to be doing
17:25 - eventually is we're going to be giving
17:27 - them the role potato person
17:29 - now again i just want to write pass
17:32 - because i want to fill in basically the
17:34 - template for this
17:36 - else if payload emoji name is equal to
17:39 - this chocolate
17:40 - then we can be giving them the royal
17:42 - chocolate lover
17:44 - and then if it is equal to this uh
17:46 - monkey right here then there you go
17:48 - they're going to be given the role funky
17:50 - monkey so now let me go ahead and clear
17:52 - that and all right it looked like it
17:54 - didn't actually remove it but better
17:56 - safe than sorry
17:58 - so we have the basic framework right
18:00 - here of matching these emojis that they
18:04 - reacted to with the actual ones that
18:05 - we're looking for so now the question is
18:07 - how do we give them the actual role
18:10 - well the first thing that we need to do
18:12 - is we need to get a reference to the
18:15 - discord role object of potato person
18:19 - now the easiest way that i know how to
18:21 - do this is if we just make a variable
18:23 - called a role then there's a function in
18:25 - discord utils library called get in
18:29 - discord dot
18:31 - utils dot get and as you can see this
18:34 - takes an iterable
18:36 - and
18:37 - the second parameter is attributes so
18:39 - basically we're going to give it an
18:41 - iterable and this is basically just
18:44 - going to be the list of roles in the
18:46 - guild and right now we have three roles
18:48 - potato person chocolate lover and funky
18:50 - monkey and from that editable the
18:52 - attribute that we want to match is just
18:54 - the name of the roll which is potato
18:56 - person
18:57 - and again if this doesn't make sense
18:59 - you're gonna see in like two seconds
19:00 - what's going on
19:01 - so first thing guild.rolls
19:04 - so basically from the rolls in our guild
19:08 - find the one with the name of potato
19:11 - person
19:14 - so now this roll variable is essentially
19:16 - equal to the potato person roll
19:18 - and then once we have a reference to
19:21 - that roll we what we can do is just add
19:23 - it to the member in other words just
19:25 - give them the role so in order to do
19:27 - this we need to await payload
19:30 - dot member
19:31 - so this is how we get access to the
19:33 - actual user or the member who is um
19:36 - replying with this potato and to give
19:39 - them the role all we need to do is call
19:41 - the method add
19:43 - roles
19:44 - and pass in our role which is the potato
19:46 - person roll just like that
19:49 - so now we can just copy this and just
19:52 - change the name
19:53 - so again
19:55 - if they reply with a chocolate
19:57 - the name of that roll was
20:01 - chocolate lover
20:02 - so we're going to be getting a reference
20:04 - to the chocolate lover roll and giving
20:06 - the member this roll
20:08 - and last but not least
20:11 - this is funky monkey
20:14 - and alright
20:15 - so before i run this just to recap we
20:18 - are going to be getting a reference to
20:19 - the guild so we can get all of the roles
20:22 - from the guild and then whenever we see
20:25 - either the potato the chocolate or funky
20:27 - monkey we are going to be saying okay
20:29 - what is the role the discord role
20:32 - related to that emoji and then we're
20:35 - just gonna assign the member that role
20:37 - right here
20:38 - so now let's go ahead and run it
20:41 - and it should say ready
20:43 - all right and check it out
20:45 - now just to test this out we can see
20:48 - that if i click on my name right here i
20:50 - don't have any roles it says bucky no
20:52 - roles
20:53 - so now what i'm going to do is i'm going
20:55 - to add a reaction and let's go with the
20:57 - potato at first and ra so the first
21:00 - thing that we can see is instead of just
21:02 - online i'm now potato person always hit
21:06 - sign and if you click on my name you can
21:08 - see that indeed i do have the potato
21:11 - person roll
21:12 - and again just to test it one more time
21:15 - if i click on the chocolate
21:17 - so it doesn't change me to chocolate
21:19 - lovers because i can only be in one
21:21 - category at a time again even though i'm
21:23 - online it doesn't say i'm online because
21:26 - like i said you can only be in one
21:27 - category at a time but when you're
21:29 - testing this out i just want to point
21:31 - out if you click on the name you can
21:33 - indeed see all of their roles so potato
21:36 - person and chocolate lover and i guess
21:38 - just to make a triple sure that this
21:40 - works for all of them
21:42 - i click the monkey and all right so i
21:45 - now have the potato person chocolate
21:46 - lover and funky monkey rolls
21:49 - so now what we have to do is just add
21:51 - one more method that's pretty much just
21:53 - going to be a quick copy and paste with
21:55 - a few tweaks
21:56 - and that is how to remove a roll from a
22:00 - user whenever they
22:02 - remove this emoji so again i just remove
22:05 - funky monkey but since we don't have
22:06 - that logic yet i still have the funky
22:09 - monkey roll
22:11 - so how do we do that
22:13 - well let me just go ahead and stop this
22:15 - bot
22:17 - and all right due to laziness what i'm
22:19 - gonna actually do is just copy this on
22:22 - raw reaction add just because it's so
22:24 - similar make sure everything's lined up
22:28 - all right
22:29 - so
22:30 - the event whenever a user removes a
22:33 - reaction from a message is on raw
22:36 - reaction
22:39 - remove
22:40 - so we will say that
22:43 - this method is going to
22:45 - um
22:46 - remove a roll based on a
22:53 - remove a roll based on a reaction emoji
22:55 - so this takes the same payload and again
22:58 - uh we're just going to keep this bit of
23:00 - logic right here because if they are
23:01 - removing emojis from another message
23:04 - other than this one right here then we
23:07 - really don't care about it so we can
23:08 - just return out of that
23:10 - of course we still need a reference to
23:12 - the guild because just like before we
23:15 - only want to be looking through the
23:17 - roles for this guild now after this what
23:20 - we need to do is we actually need a
23:22 - reference to the member who is trying to
23:24 - remove their role
23:26 - so i'm just going to call this member
23:27 - and set this equal to guild and there's
23:30 - a easy method on here called git
23:33 - member
23:35 - and for here what you just need to pass
23:37 - in is the user id so payload dot
23:40 - user
23:42 - id
23:44 - all right
23:46 - so all right we have a reference to the
23:47 - guild and the actual member so now just
23:50 - like before we are gonna be matching
23:52 - these potatoes chocolate and monkey
23:55 - and this first one is the same right
23:58 - here we need a reference to the roll
24:00 - however the thing that's different in
24:02 - this is actually this second line right
24:04 - here
24:05 - which instead of adding a roll to them
24:08 - what we want to do is we want to say
24:10 - member
24:11 - dot
24:12 - remove roles
24:15 - and for this member what row do we want
24:17 - to remove well of course it's this roll
24:19 - right here
24:20 - so we can just take this and paste it in
24:23 - here replacing the adder rolls with
24:26 - remove roll and just to recap one last
24:28 - time
24:29 - whenever they remove or in other words
24:32 - do this
24:33 - what we want to do is basically say okay
24:37 - uh what member is trying to remove one
24:39 - of the roles
24:40 - are they removing one of these three
24:42 - emojis and if so we just want to get the
24:45 - roll associated with this emoji and then
24:48 - remove that roll from the member or
24:50 - remove the remember from the roll
24:52 - however you say it i don't know
24:54 - but anyway so just go ahead and test
24:55 - this out
24:56 - and run this
24:59 - and that looks ready and all right
25:01 - so of course i am a potato person now i
25:04 - actually also have these two other rolls
25:07 - because i removed those emojis before
25:11 - the bot was actually running to remove
25:12 - the rolls from it so either way i am a
25:15 - potato person right now i'm going to
25:17 - click this and it says okay
25:20 - you are now no longer a potato person
25:23 - now just to make sure i can remove
25:26 - chocolate lover and funky monkey i'm
25:27 - actually going to have to add those
25:29 - rolls back in so there's the monkey
25:32 - and there is the chocolate
25:35 - and all right so now just test chocolate
25:38 - lover if i click this
25:41 - no more chocolate level roll and last
25:43 - but not least if i just want to get rid
25:45 - of all my rolls then i'm going to click
25:47 - this monkey
25:48 - in our right so now all of my rolls are
25:51 - gone and just to test the full logic one
25:53 - more time let's go ahead and add me as a
25:56 - potato person
25:58 - all right looking good and remove and
26:00 - there you go
26:01 - so that is how you make the basics of a
26:04 - rolls bop
26:05 - in other words you can have a message
26:07 - that say reply with one of these emojis
26:09 - whenever you want a specific role and
26:11 - again in addition to just having it like
26:14 - cosmetic where you are like potato
26:17 - person or funky monkey or whatever
26:19 - typically like i said
26:21 - what roles do is it gives users access
26:24 - to either certain permissions like you
26:26 - can be a moderator
26:28 - that's probably not something you want
26:29 - to do just have someone anyone react
26:31 - with an emoji and they suddenly become a
26:33 - moderator but just you know kind of
26:35 - giving you guys an overview of the
26:36 - potential they can either have certain
26:39 - permissions to do things or more likely
26:42 - what you're going to do is you're going
26:43 - to give them access to
26:46 - certain channels or certain sections of
26:48 - the discord server that they want to see
26:50 - for example maybe programmers want
26:52 - certain channels or designers want
26:54 - certain channels so on and so forth but
26:56 - yeah there you go the basics of a
26:58 - discord rosebop so thank you guys for
27:00 - watching don't forget to subscribe and i
27:02 - will see you guys later

Cleaned transcript:

all righty everyone welcome back to another tutorial and first of all what i'm gonna do is change my microphone settings to see if there is less of an echo so if this is a little bit better in terms of the echo i got some feedback about that then uh please let me know now aside from all that what we're going to be doing in this video is we are going to be learning how to create a discord roles bot now i'm sure you have seen something like this before if you've been part of you know a few discord servers and what this means is that there's generally like a message that says if you react with a certain emoji then you're gonna get a certain type of role and for those just starting out in discord that if you don't know what a role is it's basically these little things right here where users are grouped into different like categories or sections they're technically called roles now on the new boss boston discord server we have our roles basically broken out into how we structure our teams so there's a moderator role of course they have like more permissions than the normal user they can ban people so on and so forth and then the rest of these roles like uh blockchain community team design team those roles just have uh special permissions so they can access different channels like the design team can access the design channel so that is what we are going to be creating however before we jump right into that what i would like to do is go over the basics of classes versus decorators when structuring our discord bot so okay what the heck am i talking about classes decorators what's all this about so before what we did in all of the previous tutorials up to now whenever we wanted to create a discord bot what we did is we created a client object and this client object was just a connection to discord now whenever we wanted to listen for a certain event for example on ready or on message what we did is we added this decorator above the function name now in this tutorial we are not going to be using this method we are going to be using an alternative method however just to give you guys a quick comparison what i'm going to do is actually i can do this actually so i'll show you guys the old method above in a comment and i'll keep it here so we have a little reference to it and then below i'll show you the alternative of how we're going to be writing this all right so this was the old method before where again just to recap one more time is we got a connection to discord and then we registered an event and then we ran our client or our bot now alternatively what we are going to be doing let me scroll out just a little bit and collapse this is we can actually create our own custom class and instead of just having a reference to this class and creating our own object from it we can actually make our own class and to do this we just write class and you can actually name anything you want i'll just name it my client to keep things simple and again like i said instead of just getting a reference to this discord.client class what we're going to be doing is inheriting from it so more or less we're going to be writing our own custom discord bot client now the first method that you wanna write in this is just the dunder init so death thunder and knit and what this is gonna take is not only self but your basic argument args and your keyword arguments which are referenced as quarks and the reason that we want to accept these is because we want to pass these along whenever we're initializing this parent class so in order to do that what we need to call is super and all super is is it gets a reference to your parent class so super basically equals discord.client and then on this we want to call its init method and then i'm just going to be stealing these too lazy to uh type those out and all right so again the first thing we want to do is we want to basically say hey we're making our own custom discord bot it's going to be inheriting from discord.client and then whenever we initialize our own custom one we also just want to run the initialization logic from discord.client pretty much acting as a router so we don't have to write all of that custom initialization logic and now instead of writing these methods like async def on ready and having a decorator above each one since that was you know a bit tedious what we can do is we can have a reference to those now since this is a class method we want to just pass in self and then what did we print just to keep things consistent okay print online let me change that to ready i like that a little bit better and alright print ready just like that now the last thing that we need to do is this so instead of this client object having a reference to discord.client because that is pretty much what we did before we can now reference my client which is our custom bot so again if i zoom out a little bit you can see that this right here is basically the equivalent of this right here the only difference is this is how you can make a bot using decorators and this is how you can write your own custom bot so you can you pretty much can avoid using decorators this way and it um allows for a little bit more cleaner code base so this is a structure that we're going to be using for this rolls bot now even though this is the basic framework for a classbased discord bot what we want to do in this tutorial series is we want to give our bot some extra permissions and this is because we are going to be working with roles which includes members and if you remember back from my either the first or second tutorial where i talked about intents and i said that in discord intents are basically groups of events well one of those intents are the members intents and if you want to work with users like we're going to be doing or excuse me members which we're going to be doing because we're going to be giving them roles and taking roles away from them then we just need to enable these specific types of intents so to do this i'm just going to call this intense and this is equal to discord dot intense dot default all right so this intense object is just equal to the discord um default intents nothing's changed and this is what we get with our um standard bot however what we want to do for this is we want to enables the members intents so there's a property on here called members and we just want to toggle this to true and then whenever we initialize our custom bob what we want to do is take this and pretty much say that the intents that you're going to be working with are now equal to our custom intents and those are pretty much all the default ones with the members equals true basically saying hey discord bot we can now work with those members events now i also have some links right here that i'm going to include which is just some documentations around intents i think i might have included this before but just in case you guys want to read over any documentation make sure to include that right there all right so let's go ahead and recap exactly what we're going to be doing in this tutorial series and that is this we will create a couple roles and then what we will do is we'll have a message we'll just have it in this general channel for now and we'll say if you want a role then reply with one of these emojis and let's say if you want a custom roll then how do you spell emojis is there an e who knows all right and then let's just pick three emojis let's uh let's go with the potato it's one of my faves and then what else can we do uh we can have this chocolate right here and then let's uh none of these look very cool let's go with the monkey all right so our emojis that we're gonna be using is potato the chocolate and the monkey and all right let me just go ahead and copy that now what our bot is going to do is it's actually going to listen for any of these reactions or emojis that anyone responds with on this specific message so what we need is a reference to this message id and the easiest way to actually get this is if you just copy message link then what you can do is again i'm just going to paste it in somewhere real quick is this last id right here is the message id so eight nine yadda yadda yadda 836 again this is probably not the most um formal way to do it but it's definitely the quickest so what we need is a reference to that message id since we're going to be checking of all the messages that our bot is listening to we want to match it because we only want to give them a row if they respond to um that specific message so i'm just going to name it target message id and i'm going to say it's equal to this message right here so anyways to recap the target message is equal to this message right here all right so where do we go from here well remember like we said we want to give the user a specific role whenever they react with one of those emojis but in order to do that a key part of that is actually having those roles available on our discord server so in order to create your role just go to your server settings and then roles and then you can i'm sure you can guess it press this button that says create role and then you can give your role a name so remember we have three emojis one is the potato one is the chocolate and one is the monkey so for the potato i'm just going to say whenever users click that they're going to get a roll called potato person and we'll just give it this green color and what we want to do is we want to display roll members separately from online members and that just makes sure that they appear separately on that um little user list on the right hand side and that is pretty much all we need for this again it's not going to have any special permissions we're just going to pretty much display them separately so save that and then if we go back we can create these other roles so the next one of the chocolates we will say chocolate lover and this one can be blue and of course the same thing change and then back create a new one and the third one was the monkey so we'll say uh funky monkey again not very uh creative but they're the first things that i could think of right now so of course want to display that separately too save changes and all right so now if we go back to roles we can see that we have um four different rolls these are the ones that we just created potato person chocolate love and i actually meant to change that to chocolate lover and funky monkey all right cool cool cool so all the spot is going to do is it's going to have two methods one is listening to when they add one of these emojis and one is listening to when they remove one of these emojis from the message of course whenever they add or respond with these emojis we're going to give them a roll and whenever they remove this emoji we're going to take the roll away from them so first let's go ahead and make sure that we can give them a roll so back in our so source code can't talk today what we do is the method for this is on raw reaction add and what this is going to take is self and then the payload all right and then i'll leave a comment here and then we can say that this method is going to um give a role based on a reaction emoji now again remember we only want to listen if they replied with the emoji on this specific message so similar to before what we want to do is we just want to compare the payload message id to this target message id since this is the message that we just created and if it doesn't match then we're just going to return because we don't really care about those payloads so if the payload dot message id is not equal to then we can just copy this self.target dot message id then what we can do is just return and pretty much ignore those payloads now the next thing that we want is a reference to the guild now in discord documentation whenever you see guild it basically just means the discord server so this new boston this is a guild right here in this tnb tutorials this server i made for this tutorial series this is a guild and the reason for that is that this bot can actually be running on multiple servers now we only want to get a reference to the roles on this server aka this guild so that is you know just a little bit of background of that of why we are plucking out the guild so the guild is equal to the client dot get guild and what we need to pass in is actually the guild id so on this payload object there's actually a guild id that we can call so in short what this is going to do is whenever they add an emoji to a message we're just going to get the guild from where that emoji was coming from so now we can get to the good stuff and that is making sure we give them a role whenever they respond with one of those specific emojis so what we are going to be doing is we are going to be looking at this payload object and we are going to be taking the emoji property off it and looking at the name property so payload.emoji.name and we're going to see if it matches either the potato the chocolate or the monkey and if so then we can just give them that roll so to get this actual name i want to show you something that i want to make sure you don't run into if you just copy for example this potato right here and you paste it in it's going to convert it to the text based um version of that emoji however we want i don't even know how to say this but we want the actual raw potato and i don't mean raw uncooked i just mean raw is in code so anyways if you just go ahead and and this is kind of a shortcut at least how i do it if we print out payload.emoji.name and we can actually just run the spot right here so again all that's going to happen right now is whenever they add a reaction to that message it's just going to print out the payload emoji name in the terminal and i'll show you guys why so let me run this and alright it is ready now back in discord let me actually reply with this potato and just to show you guys what's going on real quick instead of the name potato it's going to print out the actual potato and the reason that we wanted to do this again is because we actually want to use this in the source code to compare it to the name property and just so i don't have to run this again doing my same little test back in discord i'm also going to respond with the chocolate and the monkey all right so again all i'm doing uh right now is i just wanted a reference to these so i can kind of copy them and paste them in my source code so all right i'm actually i don't want to stop that because i think uh i'm worried that this might disappear but either way now that we have that available in our source code we can say if the payload.emoji.name is equal to this potato then under here i'm going to write past right now but again what we're going to be doing eventually is we're going to be giving them the role potato person now again i just want to write pass because i want to fill in basically the template for this else if payload emoji name is equal to this chocolate then we can be giving them the royal chocolate lover and then if it is equal to this uh monkey right here then there you go they're going to be given the role funky monkey so now let me go ahead and clear that and all right it looked like it didn't actually remove it but better safe than sorry so we have the basic framework right here of matching these emojis that they reacted to with the actual ones that we're looking for so now the question is how do we give them the actual role well the first thing that we need to do is we need to get a reference to the discord role object of potato person now the easiest way that i know how to do this is if we just make a variable called a role then there's a function in discord utils library called get in discord dot utils dot get and as you can see this takes an iterable and the second parameter is attributes so basically we're going to give it an iterable and this is basically just going to be the list of roles in the guild and right now we have three roles potato person chocolate lover and funky monkey and from that editable the attribute that we want to match is just the name of the roll which is potato person and again if this doesn't make sense you're gonna see in like two seconds what's going on so first thing guild.rolls so basically from the rolls in our guild find the one with the name of potato person so now this roll variable is essentially equal to the potato person roll and then once we have a reference to that roll we what we can do is just add it to the member in other words just give them the role so in order to do this we need to await payload dot member so this is how we get access to the actual user or the member who is um replying with this potato and to give them the role all we need to do is call the method add roles and pass in our role which is the potato person roll just like that so now we can just copy this and just change the name so again if they reply with a chocolate the name of that roll was chocolate lover so we're going to be getting a reference to the chocolate lover roll and giving the member this roll and last but not least this is funky monkey and alright so before i run this just to recap we are going to be getting a reference to the guild so we can get all of the roles from the guild and then whenever we see either the potato the chocolate or funky monkey we are going to be saying okay what is the role the discord role related to that emoji and then we're just gonna assign the member that role right here so now let's go ahead and run it and it should say ready all right and check it out now just to test this out we can see that if i click on my name right here i don't have any roles it says bucky no roles so now what i'm going to do is i'm going to add a reaction and let's go with the potato at first and ra so the first thing that we can see is instead of just online i'm now potato person always hit sign and if you click on my name you can see that indeed i do have the potato person roll and again just to test it one more time if i click on the chocolate so it doesn't change me to chocolate lovers because i can only be in one category at a time again even though i'm online it doesn't say i'm online because like i said you can only be in one category at a time but when you're testing this out i just want to point out if you click on the name you can indeed see all of their roles so potato person and chocolate lover and i guess just to make a triple sure that this works for all of them i click the monkey and all right so i now have the potato person chocolate lover and funky monkey rolls so now what we have to do is just add one more method that's pretty much just going to be a quick copy and paste with a few tweaks and that is how to remove a roll from a user whenever they remove this emoji so again i just remove funky monkey but since we don't have that logic yet i still have the funky monkey roll so how do we do that well let me just go ahead and stop this bot and all right due to laziness what i'm gonna actually do is just copy this on raw reaction add just because it's so similar make sure everything's lined up all right so the event whenever a user removes a reaction from a message is on raw reaction remove so we will say that this method is going to um remove a roll based on a remove a roll based on a reaction emoji so this takes the same payload and again uh we're just going to keep this bit of logic right here because if they are removing emojis from another message other than this one right here then we really don't care about it so we can just return out of that of course we still need a reference to the guild because just like before we only want to be looking through the roles for this guild now after this what we need to do is we actually need a reference to the member who is trying to remove their role so i'm just going to call this member and set this equal to guild and there's a easy method on here called git member and for here what you just need to pass in is the user id so payload dot user id all right so all right we have a reference to the guild and the actual member so now just like before we are gonna be matching these potatoes chocolate and monkey and this first one is the same right here we need a reference to the roll however the thing that's different in this is actually this second line right here which instead of adding a roll to them what we want to do is we want to say member dot remove roles and for this member what row do we want to remove well of course it's this roll right here so we can just take this and paste it in here replacing the adder rolls with remove roll and just to recap one last time whenever they remove or in other words do this what we want to do is basically say okay uh what member is trying to remove one of the roles are they removing one of these three emojis and if so we just want to get the roll associated with this emoji and then remove that roll from the member or remove the remember from the roll however you say it i don't know but anyway so just go ahead and test this out and run this and that looks ready and all right so of course i am a potato person now i actually also have these two other rolls because i removed those emojis before the bot was actually running to remove the rolls from it so either way i am a potato person right now i'm going to click this and it says okay you are now no longer a potato person now just to make sure i can remove chocolate lover and funky monkey i'm actually going to have to add those rolls back in so there's the monkey and there is the chocolate and all right so now just test chocolate lover if i click this no more chocolate level roll and last but not least if i just want to get rid of all my rolls then i'm going to click this monkey in our right so now all of my rolls are gone and just to test the full logic one more time let's go ahead and add me as a potato person all right looking good and remove and there you go so that is how you make the basics of a rolls bop in other words you can have a message that say reply with one of these emojis whenever you want a specific role and again in addition to just having it like cosmetic where you are like potato person or funky monkey or whatever typically like i said what roles do is it gives users access to either certain permissions like you can be a moderator that's probably not something you want to do just have someone anyone react with an emoji and they suddenly become a moderator but just you know kind of giving you guys an overview of the potential they can either have certain permissions to do things or more likely what you're going to do is you're going to give them access to certain channels or certain sections of the discord server that they want to see for example maybe programmers want certain channels or designers want certain channels so on and so forth but yeah there you go the basics of a discord rosebop so thank you guys for watching don't forget to subscribe and i will see you guys later
