hello and welcome back to part two of linear regression machine learning tutorial so in today's video we're gonna be actually implementing the algorithm and using it to predict and test or train our data sets and models and whatnot but at first before I move into that I'm actually gonna be explaining what linear regression is using a few drawings and kind of some mathematical proofs and whatnot so if you guys would like to understand how this is actually working please watch through the entire video if you're more interested in just the coding aspect of it that's fine just skip through to about like four or five minutes or essentially when I'm done doing all the drawings you kind of tell that by just looking at the preview in the little slider all right but I do recommend you watch this because it'll give you a fundamental understanding that's pretty interesting and I found it interesting as well so anyways let's talk about what linear regression is so linear regression is a very basic algorithm and what that algorithm attempts to do is it looks at a scatter of data points and attempts to find a best fit line to those data points so if I add or I'll create like a little plot here of some data and I will show you what a best fit line to this data might look like okay so this our data I'm just gonna say say that this is our y axes like this and this is our x axis or axis I don't know whatever you say it and our best fit line to this data point would look something like this okay it's not perfect but something along this line and we can see there's some kind of correlation between x and y where as x increases Y increases as well and we can see that it starts kind of at a certain value alright so we see there's some sort of correlation so we can actually draw this best fit line to this data okay and this is what linear regression is going to attempt to do now I just want to show actually another data set and show when linear regression may not be the best instance or best algorithm to use okay so if we have data that kind of is more randomized so I don't know I'm just like a bunch of data points all over the place we actually still draw a bestfit line to this but it's not going to be very good right it's not gonna be a good fit line it's going to be a best fit line so essentially we can draw a line and you might want to do something like downwards like this but you might want to go across like you don't really know exactly what to do just by looking at it in a case like that we're not gonna want to use the linear regression algorithm linear regression is when we have data that directly correlates to each other so based on for example the students first grade we can kind of somewhat predict what their final grade is gonna be if there's any kind of correlation that is somewhat strong like some kind of strong correlation then that is when you would use linear regression okay so let me just go back to that first example I had so let's just draw or I don't want to use red as my axes we'll use block here and we'll draw another best fit line on some data points and talk about how the math goes on actually using this best fit line well predict data so again this is our Y this is our X that's gonna be our data of some outliers over here and then we'll have a best fit line that maybe looks something like that okay so if any of you have taken high school math so probably grade 9 or 10 math is linked when I learned it this line can actually be defined by an equation and that equation is y equals MX plus B now some of you may know this as like y equals ax plus B M is the same as a in this equation okay so essentially what this means is Y is dependent on like this equation right here okay and we can find Y by just manipulating these numbers and evaluating this equation now what do these constants mean though so essentially M is gonna be the slope of our line and if you don't know what slope is that is just how fast our line increases we can have a negative slope or a positive slope in this case it is positive because as x increases Y increases you can see our slope can actually be found by taking two points on the line so if I have a point here we're gonna have another point here excuse me what we actually do is we can say at this point we're gonna call this p2 okay and this point here is called p1 well these points have an x and a y value and to find the slope all we have to do essentially is say the y2 value of this point minus the Y 1 value over top of the x2 value minus the x1 value is actually equal to our slope and I can prove it to you but I'm not gonna do that because this again is not a math class but this is how you can actually determine what the slope of this line is how much it increases by now obviously if you pick a point like you can do this the other way around as well like you knew y1 minus y2 over x1 minus x2 that'll work fine because if you have two negative values they're gonna cancel out and give you a positive but if you had a line that looks something like this you're gonna get a negative slope value because your point one will be up here your point two will be down here you're gonna be subtracting a larger value from the tops you're gonna get a negative number right but anyways that's enough on kind of deep math for that so let's just erase this we don't need this anymore so that is our slope and that is what M is ok how much our line increases by but what is B well B is actually our yintercept all right and that is where I'm kind of doing this big dot right now where we start our line at so essentially right this is our yintercept because this is where our line intercepts the yaxis and our line will actually keep going down in this direction as well if we add like a negative xvalues right so that's what B stands for and essentially what the computer does when we give it all of this data when using linear regression is it creates this line okay and then when we want to predict a value so it uses this equation to predict the value so say I have a student and say this is like representing their grade 1 and this is representing their final grade if I have a grade 1 of say like 17 because our grade 0 to 20 it's gonna plug 17 into this equation I'm gonna say y is equal to whatever our M value is times 17 why is it doing that plus our B value and sorry I just buttered all of that writing but you get what I mean so M times 17 plus B it's going to generate a Y and now Y is actually going to be our predictive value in what we predict now this is really simple if you look at it in 2d space but we actually have multiple variables who are attributes when we create this best fit line and so it's gonna create a best fit line in multidimensional space for us which I can't really show you because it's actually impossible to visualize but I can show you an example of what it looks like in 3d space really quickly okay how much time we get six minutes so I'll just keep going and get this explanation out essentially if this is our origin so zero zero zero we could have if we have two variables like say we have G 1 and G 2 and this is gonna be our G 3 well we can create a best fit line that kind of goes through like coordinate space like something like this now this seems weird but essentially if this is on like G 1 G 2 and then we have like this we can create it in multi dimensional space using all these different variables now you don't really have to understand like how this is working but that's what the computer is doing for us it's using all these attributes to create a best fit line in like whatever space how many attributes we have okay so I think that's all I'm going to talk about for linear regression essentially it's a best fit line y equals MX plus B and I'm actually gonna get the constants of that line for us so I can show you how it works okay so now let's move into actually coding all right so to actually code this best fit line let me just put my tablet away what we need to do is we need to create a like a training model so I'm just gonna say linear and this is again in PI trim is equal to linear model dot linear regression okay and this is just gonna be uh no I put a semicolon used to Java now is gonna be what we're working with so linear regression and what I'm gonna do now is I'm literally just gonna type linear which is our model don't fit and then I'm gonna give it X underscore train Y underscore train like this okay and what this is gonna do is it is just gonna fit this data to find like a best fit line all right using the X train data in the why train data it's going to store that line in linear and then we can use that to actually test our test addon so now that we have this line because we fitted the model to it whatever we can actually do linear dot score and then in here we can actually score X test and Y test now this is gonna return to us a value that's gonna represent the accuracy of our model so we're gonna say AC C equals linear dot score and what this is gonna stand for is just accuracy and we're just gonna print this out to the screen to see how accurate we're actually getting and this is literally all you have to do to actually create a model and see how well that model is working or how well the algorithm is working okay this is all you have to do so I'm just gonna run this and instead of samples what's the issue here give me one second guys extra my dream okay so I look through here and I realized I've made a very slight mistake so what actually need to do here just swap this test and train variable so Ali's gonna say and say X underscore test and Y underscore train and this should be hopefully fixing things for us my apologies about that guys so run this now and now we can see we're actually getting an accuracy of eighty six point eight percent we're like zero point eight six like out of one right okay and that's not bad obviously we can do better but for actually determining students grades because it's not a like it's extremely concrete's mathematical thing that we can do with that that's pretty decent that based on just these six attributes of these five attributes g1g to study time failures and absences we can determine with eighty six point eight percent accuracy what a student's grade is going to be at the end of the year and I think that's pretty cool but that's what we're a lot of people will stop right this okay you got eighty six percent accuracy that's great but how do we actually use this model now so now that we've created this model we want to use and actually test it on data and see like what we're actually getting that's what I'm gonna do is first I'm gonna show you the constants because remember I was telling you how this works with like y equals MX plus B I'm gonna show you what those coefficients are so what M is and what B are for this actual line so to do this I'm just gonna print out we'll just say Co has in like coefficients plus linear and dot coefficients like this and it's gonna actually give us a list of all the different coefficients and I'm going to print out intercept like this okay and again plus and now linear dots intercept and this is gonna show us the yintercept so if I run this did not get a loop with signature matching type one second let's see what the issue is here okay so he turns out the issue was uh what do you call it that I was trying to add these things together because now I'm used to job programming anyways we're just gonna throw a little comma here I just added this coefficient and backs list and so it goes in the new line essentially about sorry that was the issue I was trying to add these things together we just have to do comma okay and you see actually I ran this just to make sure this is working and down here now we're actually getting all the coefficients of our five different variables and we're getting our intercept which is negative one point four seven right you can see the accuracy has dropped a little bit but that's gonna happen once in a while our accuracy is gonna fluctuate within a few percentages just because when we train it it's gonna be different each time so yeah anyways so this is actually these coefficients here that I'm showing sorry down here are actually those that the M coefficient so I was showing you y equals MX plus B now that's the equation for a line in twodimensional space a line in five dimensional space needs five coefficients so like five kind of M's you can think of it as like M X plus MX plus like I don't know like Zed y plus C W like a bunch of different variables they all have their own coefficients and these are actually the coefficients that we've generated for those variables and you can kind of see the bigger the coefficient the more weight it actually each what he call it attribute actually has in are like defining you know what grade we're gonna get and this is our intercept so yeah so that's great we got our coefficient and we have our intercept but now I actually want to show you how this works on a real student so how we can use this to predict base a student's information what great they're gonna get cuz right now we're just getting a bunch of numbers I'm actually seeing any like no good output on how this work so you'll see what I mean in a second but essentially what I'm gonna do you can use this model to predict I say linear dot predict and I'm going to say X underscore test okay so what I'm gonna do here I'm gonna store this in predict Qin's even how you spell it I don't know but predictions equals linear to predict X underscore test what I'm gonna do is I'm gonna actually print out all the predictions and then I'm gonna show you what the input data was for that prediction so essentially this is gonna take an array or an array of arrays in our case and it's going to do a ton of predictions and guess what all these are on the test data that we did not train our model on because we only trained it on the train data right and then we'll see what we're actually like what that input was so I'm just saying say for X in range and then if I spelled range correctly will do the length of our predictions okay and then what we're going to do so used to Java now sorry guys well we're going to just print out the prediction so in this case we'll do predictions X and then we'll also print out what that input data was so that input data is gonna directly correlate to X underscore test X value and then we're gonna print out what the actual value of the final grade was which is going to be Y underscore test X and now if I run this you'll see we actually get some pretty interesting output so we got a bunch of stuff printing out here cuz just printing all of them but essentially right you can see we have fifteen point two two one nine right as our answer okay and the mid or the beginning grade was fifteen their end of term grade or like second semester grade was that they had two hours of study time they had zero failures and they had four absences and their actual grade was fifty so we got pretty close by getting fifteen points you and I believes we're getting a ton of decimal numbers but these are always gonna be rounded off so we could actually round these and get better accuracy but that's fine for now so this is one where we made mistake right you can see that their first grade was sick so there grade was 5 they had one our study time one failure and they got a grade of zero and we were saying they were gonna get a grade of four okay so we got low but we still didn't get the correct answer here again right 14 the correct answer was fourteen twelve twelve thirteen twelve point seven nine ten nine point four nine eight right so we're getting very very close to the actual answers and you guys can look through these and kind of play around with them but essentially that's how you'd use it to predict based on input what are what the grade would be and you can see we're getting like pretty close with most of these answers at least within one or two points for almost all of them which i think is kind of amazing because only in like 20 or 30 minutes we've been able to set this up understand how it works and now we can actually use this on like real in reallife situations to predict a student's certain grade based on these pieces of information anyways that has been it for linear regression in the next video I'm actually not sure what we're gonna talk about but it's gonna be another basic machine learning algorithm a bit more advanced in this we're gonna go through and play with all of them understand how they work and then again move into neural networks so if you guys enjoyed the video please make sure you leave it like you guys should definitely follow my Twitter if you want to know when the next video is coming out and with that being said I guess I'll see you in the next video