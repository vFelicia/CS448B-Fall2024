With timestamps:

00:00 - hello everyone and welcome back to the
00:01 - fourth episode in my how to make a piggy
00:04 - game on roblox series now in this video
00:07 - we're going to be making the tools such
00:10 - as the stunt script for the crossbow and
00:12 - also the piggy batt work as well as the
00:15 - remote events we're going to set those
00:17 - up so we can have the announcements that
00:19 - come up when someone gets killed and
00:20 - also going to do the animations for the
00:23 - piggy bats as well as some general
00:24 - things as well to do with the game logic
00:26 - scripts as I said in the last video if
00:29 - you found a book check out the link in
00:31 - the description down below I am human
00:33 - and so I can't answer all of your
00:35 - comments because I'm getting a hundreds
00:37 - every single day it's just
00:38 - mathematically impossible for me to
00:40 - answer them all so try your hardest to
00:42 - debug your code look at the output
00:44 - window and scan your code line by line
00:46 - really carefully to see if you spell
00:49 - something wrong or made a mistake
00:50 - because that's going to be the cause of
00:52 - your books or your errors because as you
00:55 - can see on my end it's working
00:57 - completely fine so that any further ado
00:59 - let's get straight into episode 4 so
01:01 - what we're gonna work on next is
01:02 - cleaning up after the round is finished
01:04 - so things like teleporting the players
01:06 - back to the lobby
01:07 - removing everybody's tags destroying the
01:10 - map etc so after the start round
01:13 - function is called what we're gonna do
01:14 - is we're going to make the contestant
01:17 - stable in the game logic script we're
01:19 - gonna make it blank again so we're going
01:22 - to say contestants equals and then a
01:24 - blank table to reset it to a blank table
01:26 - then what we're going to do is we're
01:28 - going to loop through all of the players
01:30 - in the game again and just like we did
01:33 - at the beginning we're gonna copy this
01:34 - for loop and we're gonna paste it down
01:36 - here again and what we're gonna do is
01:39 - we're just gonna insert all of the
01:40 - players that are not in the menu into it
01:43 - okay just so that we've got all of the
01:45 - players in the game and then what we'll
01:48 - do is we'll teleport them back to the
01:50 - lobby
01:50 - so because obviously if they are in the
01:53 - menu that now they're going to be
01:55 - already in the lobby so this for loop is
01:57 - just in in adding them to the table
01:59 - again including those though the reason
02:02 - we have made the table from scratch
02:04 - again is because some people might have
02:06 - joined halfway through the round which
02:07 - is what we'll be working on later on and
02:09 - they won't have been counted in the
02:11 - original contestant table because it
02:13 - made before the previous round started
02:15 - so getting all the players again and
02:17 - then what we're gonna do is we're gonna
02:18 - put them back in the lobby so firstly we
02:20 - need to check if there are spawns in the
02:22 - lobby so make sure that you've named
02:24 - your lobby model lobby and you've got
02:27 - that spawns folder in there containing
02:29 - all of these spawn locations they need
02:30 - to be spawn locations and not just
02:32 - normal parts so make sure the fall is
02:34 - called spawns and you've got the lobby
02:40 - so once you've got all of the players in
02:42 - that table we obviously need to check
02:45 - that they were spawned so if game
02:47 - thought workspace Lobby caught on find
02:49 - first child spawns so she's got spawned
02:53 - in your lobby then we're gonna do around
02:56 - we're gonna call that teleport players
02:58 - function on the contestants and then
03:06 - we're going to do we we need to give the
03:09 - spawns to the teleport players function
03:11 - so that's going to be game dot workspace
03:14 - dot lobby again but spawns
03:20 - : get children and that will return a
03:23 - table of all the spawns in that folder
03:27 - okay all these spawn locations so that
03:29 - the teleport players can put all the
03:32 - players on different ones and that
03:34 - should do it for the piggy as well
03:35 - because the piggy won't be in the menu
03:38 - so even though we were counseling the
03:39 - piggies our contestant here we're not
03:41 - actually checking if they have a
03:42 - contestant value we're just checking to
03:44 - see if they're they're not in the menu
03:46 - which the piggy won't be so the piggy
03:47 - should be included here but if you
03:50 - haven't got any spawns we can do another
03:53 - fatal error warning just to warn the
03:56 - Creator so if you add a if you change
03:59 - the lobby it's a later date and you
04:01 - forget to add the spawns this should
04:03 - warn you in the output so you don't have
04:06 - to do it if you want but so it's a good
04:07 - way of reminding yourself if you don't
04:10 - know what you've done wrong and it just
04:11 - helps reduce the amount of errors that
04:12 - you might get after that we're going to
04:15 - need to delete the map delete the
04:18 - chapter that's currently in the work
04:19 - space so we can say cloned chapter :
04:21 - destroy and that will remove the map we
04:24 - don't want lots of maps being create
04:26 - that each round and then we need to
04:28 - remove everybody's tax and just clean up
04:30 - the whole game in general we've got
04:32 - quite a lot of things that we do need to
04:33 - clean up and which you might not have
04:35 - thought of so things like obviously the
04:38 - Piggy and contestant tag but also
04:40 - removing everybody's tools if they've
04:42 - got one equipped and all that other good
04:45 - stuff so we're gonna go back into the
04:47 - round module where we've got all of our
04:48 - functions and we're going to create
04:50 - another function I'm gonna call it
04:55 - function module dot remove tanks and
05:00 - then inside of this function firstly
05:03 - just going to do another for loop so for
05:04 - I comma V in pairs game dot players
05:08 - colon get players do so for every player
05:13 - who is going to be represented as V we
05:16 - are going to firstly check to see if
05:18 - they have a piggy tag if they do have a
05:24 - pig attack we'll say V dot piggy column
05:26 - destroy him to remove that piggy tag
05:30 - else else if V has a contestant tag
05:37 - which they probably will because there's
05:40 - only one piggy if they have got the
05:42 - contestant tag we will say V dot
05:43 - contestant :
05:45 - destroy so we'll firstly delete those
05:47 - tanks very nice and and then we will
05:53 - remove the tools so if they're the piggy
05:59 - gonna have a piggy bat so if V dot
06:02 - backpack find first child
06:06 - piggy bats then V dot backpack piggy bat
06:11 - : destroy and and we're gonna do the
06:15 - same thing again we're gonna copy that
06:17 - line I'm just paste it underneath but
06:19 - change the backpack to character in case
06:21 - they have it equipped so change it there
06:23 - but also change it after the then you've
06:25 - got to change it two times so if leader
06:27 - character find for his child to pick you
06:29 - bat then they'll have it in the hands
06:30 - currently we need to destroy it from
06:31 - there as well because it'll either be in
06:34 - the backpack or it will be in the
06:35 - character
06:36 - it'll be unwanted but not both but now
06:40 - we've done that we need to remove all of
06:44 - the contestants tools so we can say for
06:47 - now because we've got a for loop inside
06:50 - another for loop I'm going to use two
06:52 - different variable names for my I and V
06:55 - so we're gonna say for underscore comma
06:57 - P in pairs V backpack : get children do
07:04 - so looking through all the tools in the
07:06 - players backpack if P is a tool then he
07:12 - : destroyed as I've said it doesn't
07:14 - matter what you call these two values
07:15 - okay I've just used a - because I'm not
07:17 - even gonna use the I value the index
07:19 - value I'm only using the P and the P
07:21 - represents the thing that's going to be
07:23 - inside the backpack or anything that's
07:24 - going to be inside the backpack so we're
07:26 - looping through everything so it's going
07:27 - to be done to everything in the backpack
07:29 - so if it's at all gonna destroy it then
07:31 - we need to copy this for loop make sure
07:35 - you only copy the right amount of n so
07:38 - we should only need two ends one for
07:40 - ending the for loop one for ending the
07:42 - if statement and once again change the V
07:44 - dot backpack to V dot character so
07:46 - you're just looping through all of the
07:47 - things in the character and if there's a
07:49 - tool stored in the contestant character
07:52 - we're going to destroy it so now that
07:54 - we've done that we've deleted their
07:55 - contestant value and removed their tools
07:57 - we should be good to go on that front
08:00 - one other thing I'm going to do is I'm
08:02 - going to go into server storage and
08:04 - inside of here
08:07 - in fact yeah in self storage I'm going
08:13 - to insert a folder called game values
08:16 - and inside of here I'm going to insert a
08:21 - bull value and this value is going to be
08:24 - called game in progress and it's just
08:27 - useful because we can set it to be true
08:29 - or false when a game is happening and
08:31 - then from other scripts we can tell if a
08:33 - game is currently in progress for
08:35 - example when we're going to work on the
08:37 - menu script soon which is going to run
08:40 - when they press the play button we want
08:42 - to check to see if a game is currently
08:43 - in progress and if it is we want to put
08:45 - the player into the current around if
08:47 - they've joined halfway through so to do
08:49 - that we need to check our games in
08:50 - progress so I'm gonna set this value to
08:53 - be true when around starts and then at
08:55 - the end when we do the remove tags we
08:57 - can set the value of it to be false so
08:59 - I'm gonna say outside of this for loop
09:03 - that's where it ends
09:04 - don't do that I'm going to say game but
09:09 - service storage game values dot game in
09:12 - progress store value equals false okay
09:14 - I'm gonna make that false then what I'm
09:17 - going to do is we're gonna set it to
09:19 - true in another scripts okay and the
09:23 - script we're gonna put that into is
09:24 - gonna be in the game round module but
09:30 - it's going to be it's gonna be in the
09:34 - start round because that's when the
09:35 - round begins so we'll just do this
09:37 - little whoops we'll just copy it and
09:38 - paste up here but this time I'm going to
09:42 - set it to true because when the round
09:43 - starts we're going to set the game in
09:45 - progress value to be true but then when
09:46 - it ends and we do the remove tags to
09:49 - clean up the game to the general clean
09:51 - up so we can do the next round we're
09:52 - going to set it to false because off to
09:54 - the game isn't in progress anymore in
09:56 - fact we'll put that at the top because
09:57 - it should be executed first in my
10:00 - opinion the script does everything in
10:01 - steps and so we want to firstly set the
10:05 - game in progress value to be false
10:06 - obviously because that's the first thing
10:08 - that should be done just in case somehow
10:10 - some of this is so fast that they click
10:12 - the play button before we set it to
10:14 - false even though the round has finished
10:17 - okay so that's that done and that is the
10:19 - cleaning up needed so that we can start
10:21 - the next round but you will be wondering
10:24 - well how do we start the next round
10:25 - because currently when the game finishes
10:28 - that's it it doesn't restart and it's a
10:31 - good question first things though we
10:33 - need to call that's remove tax function
10:36 - just like that after the clone chapter
10:38 - colon destroy now we need to wrap all of
10:43 - this code that we've just written well
10:44 - nearly all of it into a while loop so
10:46 - where we start this intermission here
10:48 - we're gonna say while while wait do and
10:54 - then we're gonna add an end right at the
10:57 - bottom so make sure you've got that
10:58 - while wait do at the start just after
11:01 - where you've acquired the door module
11:03 - but just before the intermission and
11:05 - then at the very end of the script after
11:07 - the remove tags you add that end then
11:11 - selects everything in between those two
11:13 - lines in between the while wait do and
11:16 - the end select it all and press tab on
11:18 - your keyboard that will indent it and
11:21 - that just makes it a lot more organized
11:24 - and clean it shows us the code that is
11:26 - inside this while loop and now that
11:28 - we've put it in a while loop that means
11:29 - that it will repeat forever so it will
11:32 - just keep running this code over and
11:34 - over again so we start off on the
11:36 - intermission but when we get right to
11:38 - the end and we've removed the tags and
11:40 - we get to this end here we're gonna go
11:42 - right back up to the top and do it all
11:44 - over again and that is how the rounds
11:45 - repeat themselves forever and ever and
11:47 - ever because the while loop when it gets
11:50 - the bottom it will go straight back up
11:51 - to the top so after we've cleaned up the
11:53 - round and destroyed the map and
11:54 - everything and teleported everyone back
11:56 - it's gonna do an intermission again for
11:57 - 30 seconds then it's going to choose a
11:59 - new map because it's firing this round
12:01 - select chapter function and then it's
12:03 - going to teleport everyone then it's
12:04 - going to start another round and that
12:06 - round is only gonna finish when the
12:08 - round start round function gets to the
12:11 - end which will only gets the end when
12:13 - this for loop is broken so either when
12:15 - the time's up or someone dies or the
12:17 - piggy dies or whatever so you can now
12:19 - see that we have this game loop which is
12:21 - running over and over and over again so
12:23 - this is how the game works
12:25 - and we've pretty much finished the game
12:27 - loop for itself
12:31 - now obviously we don't want the round to
12:33 - start unless there are two players
12:35 - because that way is going to do the
12:37 - intermission and if there's only one
12:38 - player is going to choose the piggies
12:40 - and then it's going to get stuck because
12:42 - there's no other contestants to choose
12:44 - from because we've removed the piggy
12:45 - from the table so we need at least two
12:47 - people to start the game and obviously
12:49 - we can test with two people because we
12:50 - can start up our test server so we're
12:53 - going to implement a repeat until loop
12:55 - in our while loop at the top here before
12:57 - the intermission
12:58 - but inside the while loop still so we
13:01 - write repeat until and we want to repeat
13:05 - checking to see if there's enough
13:07 - players in the game so we'll do local
13:09 - we'll create a table and when I call
13:11 - that table available players and we're
13:13 - going to add all of the players that are
13:15 - not in the menu to this table then we're
13:17 - going to see how many items are in this
13:18 - table so how many players are available
13:20 - to play and then we can see if that
13:22 - number of valuable players is greater
13:24 - than or equal to two we can start the
13:26 - game so we're going to repeat and we're
13:28 - going to use a for loop for I comma
13:31 - player in pairs game dot players come
13:36 - get players do if player so if not
13:43 - player find first child in menu so if
13:48 - there isn't a tag in the player called
13:50 - in menu then we're going to insert them
13:53 - into that table so table dot inserts
13:55 - we're going to add them into the
13:56 - available players table and the thing we
13:58 - want to insert is that player so then
14:01 - what we've done that we can say we can
14:05 - set the status to say say to stop value
14:09 - equals in fact we haven't got a variable
14:14 - for the status yet so we're gonna say
14:15 - local status equals game but replicated
14:19 - storage come on wait for child status
14:21 - because we have we have the status value
14:24 - in the round module which is where we've
14:26 - been was well been updating the status
14:29 - from currently but we have no need to
14:31 - actually update the status from the game
14:32 - logic script yet so status door value
14:34 - equals to ready
14:37 - players needed okay
14:41 - and then what we'll do we'll do a
14:42 - bracket and open bracket and then we'll
14:44 - do a dot dot and then we'll do hash tag
14:47 - available players dot dot and then open
14:50 - the bracket again open the speech marks
14:51 - and close the bracket off and that way
14:53 - it just it will tell us the number of
14:55 - players current in the game and in fact
14:57 - I'll do it / - in this in this end
15:01 - string here so that it will it will look
15:04 - like a fracture and so if this one
15:06 - player in the game it will say to Eddy
15:07 - players needed and then it will say one
15:09 - out of two not just updates the status
15:10 - makes it look really nice then we're
15:12 - gonna add a weight to just so that it's
15:15 - not repeatedly repeating this every you
15:17 - know hundreds of times per second or
15:20 - whatever we need a nice delay so that it
15:22 - doesn't crash off script so a weight too
15:24 - will do perfectly and then we want it to
15:26 - keep on repeating this and keep on
15:28 - checking to see if there's two players
15:30 - until the number of available players is
15:34 - greater than or equal to two and when it
15:37 - is greater than or equal to two it will
15:39 - break out of this loop it's kind of like
15:41 - a for loop or a while loop it will keep
15:42 - on running until there are two or more
15:47 - objects in that table when I say objects
15:49 - in that table I mean players in the game
15:51 - because if there is a player that is not
15:53 - in the menu then we insert them into
15:55 - that table and every time we go around
15:57 - again we reset the table so we make it
15:59 - blank again we insert all the players
16:00 - that are ready to play and then we count
16:02 - up how many are ready and then if there
16:04 - are enough players then it will break
16:06 - out of this repeat loop okay so now we
16:10 - can test the game and I'm gonna put this
16:13 - intermission back down to 5 seconds
16:15 - because it doesn't matter about it being
16:17 - long or short because the game is only
16:19 - going to start when we have those two
16:21 - players in the game okay so you can see
16:27 - that we are in the game but we haven't
16:29 - been teleported or anything you know
16:31 - nothing has come up on the screen and
16:32 - that is because we're in the menu and we
16:35 - told the scripts not to count us if
16:38 - we're in the menu and if we open up the
16:39 - server here oops if we just bring the
16:42 - server over here and we look at player 1
16:44 - we can see that player 1 is in menu and
16:46 - player 2 is in the menu when we exit out
16:49 - of the menu look at player 1 you can see
16:51 - that that in menu gets destroyed and now
16:53 - it says that there's one
16:54 - out of two players that are ready to
16:56 - start the game if we do the same for
16:58 - player two it will now say two out of
17:00 - two players already and it's gonna say
17:02 - next round starts in five four three two
17:04 - one one of us is gonna be selected to be
17:05 - the piggy but then we have our game loop
17:08 - and it's still going really really
17:09 - quickly so if I die for example if I
17:14 - reset then it's gonna say the piggy has
17:18 - killed everyone then hopefully it should
17:22 - it will get rid of the map let's see
17:24 - yeah the maps gone I could see it on my
17:26 - server it's completely gone but the next
17:29 - round is starting so it should insert
17:30 - them up again there we go it's been
17:31 - inserted and now you can see we're both
17:35 - the piggy and that's because we haven't
17:36 - undressed the piggy yet and we haven't
17:39 - actually removed the old piggy so that's
17:42 - what we need to do next so to reload the
17:46 - piggy we're going to go into the round
17:47 - module we're gonna go through our remove
17:49 - tags and in the if if statement where it
17:52 - says if the fine first hard piggy what
17:54 - gonna do is we're gonna say at the end
17:56 - of this V curl on load character and
17:59 - what I will do is will respawn the piggy
18:01 - without their outfit so it will just
18:02 - respawn them as they were with their
18:04 - normal player outfit okay and then that
18:07 - way when the next round starts they will
18:10 - be back to normal they won't have their
18:11 - piggy bath anymore because we've
18:13 - destroyed it from the backpack yeah and
18:17 - one other thing I'm gonna do is I'm
18:19 - going to go to the game logic and I'm
18:21 - gonna add some weights so I don't want
18:24 - to activate the doors as soon as the map
18:27 - has been loaded because just in case the
18:29 - map hasn't fully loaded yet and we
18:30 - accidentally miss out a door I'm gonna
18:32 - add a wait two seconds there I'm also
18:34 - going to have a wait two seconds between
18:38 - the actual teleporting of the players
18:41 - and the math being loaded because
18:44 - sometimes the map can't be fully loaded
18:46 - and if you teleport people straight away
18:48 - they might get stuck halfway in the map
18:51 - because they'll start falling and then
18:52 - suddenly the map gets loaded so their
18:54 - torso is stuck in the map so if we get
18:59 - where the map yeah when the map has been
19:02 - loaded and when the piggy has been
19:04 - chosen if we just
19:07 - do another wait here for two seconds
19:10 - that looks good to me and we'll also do
19:14 - another wait here just so that when the
19:19 - rounds all finished we can just wait two
19:22 - seconds after everything's been cleaned
19:24 - up before we start the next one okay I
19:28 - think that's all good
19:32 - let's go ahead and test it again okay so
19:39 - the next round is starting and if we
19:41 - just die again as soon as we load in get
19:46 - ready to reset okay so the current PE
19:50 - has reset and so he should yeah so he's
19:54 - now responding as my default character
19:57 - and hopefully a different piggy gets
20:00 - chosen next time maybe it's gonna be
20:02 - player one on the rise see so now we've
20:07 - got those weights in there were just
20:08 - allowing some time for the everything to
20:12 - get loaded but now we actually have a
20:13 - proper game loop which seems to be
20:16 - working which is really really good so
20:18 - what is left to do got quite a few more
20:21 - things left to do such as the piggy bats
20:23 - and all of the different remote events
20:25 - that we need for our duis and things
20:28 - like that
20:28 - and also things like teleporting players
20:31 - if they've joined halfway through
20:33 - crouching placing traps lots more to
20:37 - come because we want to make our piggy
20:41 - back work so that's one of the remote
20:43 - events that we are we're going to have
20:44 - to set up so I thought I'd walk you
20:48 - through how the piggy batt works so
20:51 - inside the tool piggy bat which is in
20:54 - service storage firstly we have a local
20:56 - script and this handles all of the
20:58 - clicking that's done on the players
20:59 - computer so we've got two events here
21:01 - script dot perparing dot equipped and
21:04 - that's going to run when the tool is
21:06 - equipped and opened up it's going to
21:07 - show the GUI that says click a player
21:09 - within eight studs to kill them just a
21:11 - little helpful guide and this one as
21:13 - well unequipped will hide it when you
21:14 - want equipped at all but this one let's
21:16 - cook the pound activated it's going to
21:18 - fire or be triggered when you click the
21:20 - mouse
21:21 - so Mao stop target is gonna be the thing
21:22 - that you clicked so if the mouse top
21:24 - target is a hip is called hitbox okay or
21:27 - it's inside of a model the thing that
21:31 - you touch then it's likely there's gonna
21:34 - be a player okay so what we'll do is we
21:38 - will use get player from character with
21:41 - the mass target and that will check
21:42 - whether the player that you've clicked
21:44 - is an actual player and if they are a
21:46 - player then we can fire this remote
21:50 - event inside the piggy bat called hit
21:52 - and supplying the player that we've
21:56 - clicked and then in this server scripts
21:58 - is going to pick up the hit event and
22:02 - it's going to play an animation which
22:05 - looks like you're swinging the bat if
22:07 - you're the piggy and what's going to
22:09 - happen is it's quite it looks a bit you
22:13 - know confusing to you but all that's
22:14 - happening is it's checking if the victim
22:16 - the person that you've passed to the to
22:18 - the server script to the through the
22:21 - remote event the victim if they have a
22:24 - character is checking to see if they
22:27 - haven't already escaped that's something
22:29 - that we're going to work on very soon
22:30 - but also it is going to check to see if
22:35 - you are within eight studs of the player
22:38 - so this victim dot character the
22:40 - humanoid root part opposition - player
22:42 - character to human rapport position dot
22:44 - magnitude that is basically the distance
22:47 - between you the piggy and the victim so
22:50 - if it's less than or equal to eight
22:52 - studs then it will let you kill them so
22:54 - you have to be within close range and
22:56 - then what it will do is it will slow
22:58 - them down it will make them freeze
22:59 - you'll freeze as well and we've got this
23:02 - function called freeze which will
23:03 - basically kind of like it will weld all
23:05 - of your body parts together so you can't
23:07 - move sorry the victim's character and
23:10 - then we're gonna fire this remote event
23:12 - called piggy hit and that's what we've
23:14 - got to insert so let's create the remote
23:16 - event in a replicated storage and call
23:18 - it piggy hit now what this will do is it
23:23 - will tell the player or the victim to
23:27 - show a GUI on the client end and that's
23:31 - going to be the black GUI that appears
23:32 - and then
23:34 - what will happen is after naught point
23:35 - 65 seconds which is going to be how long
23:38 - it takes for the swing to actually
23:40 - unlike hit the player it will again slow
23:46 - the player down and it will kill them
23:47 - and sorry yeah it kills them and then it
23:50 - plays a death sound and the death sound
23:52 - is the same one you'll hear in piggy and
23:53 - then after they've died it will make the
23:56 - piggy be able to walk again and it will
23:58 - fire this other remote event called kill
24:00 - feed and the kill feed is what makes the
24:02 - GUI pop up on the screen saying that the
24:06 - victim was killed by the piggy so that's
24:07 - another remote event that we're gonna
24:09 - insert and we're gonna call it kill feed
24:11 - so by now you should have three remote
24:14 - events one called menu play one called
24:16 - kill feed and one called piggy hit now
24:19 - if you're interested in learning more
24:20 - about how I made this piggy bat I'm
24:22 - gonna make a tutorial I'm gonna link to
24:24 - it in the card or put it in the
24:25 - description I'm not sure if I've run out
24:26 - of cars yet cuz there's a max limit of
24:28 - five but I will film myself making this
24:31 - from scratch so if you want to enhance
24:34 - your scripting knowledge maybe a little
24:35 - bit more advanced at scripting and you
24:37 - want to know how I made this tool from
24:38 - scratch then I will have a tutorial on
24:41 - how I did that I'll put it in the
24:42 - description okay so they are the road
24:48 - events that you need for the bats now
24:51 - the next thing we'll look at is the stun
24:54 - script so there's also a tool called the
24:58 - crossbow and that's for use by the
25:00 - players the contestants and if they
25:02 - click the piggy basically like shoot the
25:05 - crossbow at the piggy the piggy will
25:07 - become stunned for 20 second so 20
25:11 - seconds so yeah so inside of this local
25:15 - script it's a little bit different to
25:17 - the other scripts because it fires a rep
25:19 - a remote event called stun so that's
25:21 - another remote event that we'll need I'm
25:23 - gonna add another remote event in
25:25 - through applicators storage and so
25:27 - should you and I'm going to call it stun
25:29 - so what it will do it will fire that
25:31 - remote event and then it will destroy
25:32 - the crossbow because it can only be used
25:34 - once unlike other tools we don't want
25:36 - any player to always be able to kill the
25:38 - auto stone that the piggy house it would
25:41 - be unfair so you only get one use and so
25:43 - it will destroy after use but there are
25:45 - two crossbows available in the map
25:47 - in different places but they were both
25:49 - destroy when they've been used once okay
25:51 - so when this stun remote event is fired
25:55 - it gets picked up on the server in this
25:57 - stun script which came with your piggy
26:00 - kit again I will have a video up
26:02 - teaching you how to make the stun script
26:04 - and the crossbow from scratch although
26:06 - for most of you it probably will be
26:08 - quite advanced and if you don't want to
26:12 - learn how to make it then that's fine
26:13 - but the video is in the description or
26:15 - in the card if I do have a space for a
26:17 - card if you want to learn how to do it
26:19 - but basically a quick overview is that
26:21 - when it's picked up on the server your
26:23 - mouse target so the thing that the
26:24 - player clicked is sent it just checks if
26:27 - the target is um is a member of a model
26:29 - and if it is then it's probably the
26:32 - piggy so we look up the piggy player
26:34 - from their character check to see if
26:36 - they have that piggy value and if they
26:38 - do we're inserting a tag into the piggy
26:41 - called stunned and after 20 seconds that
26:45 - tag gets destroyed
26:47 - so from other scripts we can tell
26:50 - whether the piggy has been stunned for
26:52 - example in the bat script the piggy is
26:55 - not allowed to kill anybody
26:57 - whilst they're stunned so if they try
27:00 - and click and fire this hit event then
27:03 - we will check if not player a fined for
27:06 - his child stunned and that basically
27:08 - means if the piggy isn't stunned then
27:10 - we'll let them kill this player but if
27:12 - they are stunned and they have got that
27:14 - value in them called stunned we're not
27:15 - going to let them we're not going to let
27:18 - the player kill the victim so the victim
27:21 - gets away because the piggy is stuck
27:23 - remember in the stun script the piggy
27:26 - also gets sparkles added to their head
27:29 - which makes it look like they're
27:31 - confused we also announce to all players
27:34 - that piggy is gone for 20 seconds now
27:36 - this is another a most event that you
27:38 - need to insert so go ahead insert
27:40 - another remote event into replicated
27:42 - storage and call it announcement now the
27:45 - announcement remote event gets fired
27:47 - from the server and what you can do is
27:49 - you can send a message now you can
27:50 - either send a message to a certain
27:52 - client a client is basically a player or
27:54 - you can send it to all clients so all
27:56 - players in the game will get the message
27:57 - and when you do if we go into the GUI in
28:00 - the client
28:01 - mein which does again come with your
28:02 - picky kit because I made it for you if
28:04 - you look in here we've got game dot
28:07 - replicated storage that announcement on
28:09 - client event so when it gets fired from
28:10 - the server it's gonna make it's gonna
28:12 - change the announcement GUI so it's
28:14 - gonna change the announcement text
28:16 - labels text to your whatever the text is
28:18 - that we sent it's gonna make it visible
28:19 - for five seconds so you can see that
28:21 - announcement all players will be able to
28:23 - see some something get announced so kind
28:26 - of like a message like piggy has gone
28:29 - for 20 seconds we've also got one the
28:31 - kill feed which we've already created
28:33 - we've already created our remote event
28:35 - for and that is when somebody gets
28:38 - killed with the bat with with a bat
28:41 - script we will fire that event to all
28:43 - players saying that the player whoever
28:46 - it was was killed by the piggy and it's
28:48 - basically the same thing so the remote
28:51 - events that you will need are going to
28:53 - the stun piggy hit announcement kill
28:56 - feed and menu play make sure that you've
28:59 - named them exactly the same as I have
29:01 - and you've got the capitalization
29:02 - correct really really important and as
29:04 - always I am gonna put tutorials into the
29:07 - scripture on how I made all of these
29:09 - realized events work and all of the
29:12 - tools as well it may be a little bit
29:14 - delayed after the video that's just
29:16 - because I have got a lot of content but
29:18 - over at the moment I've already got gone
29:21 - into three hours of filming this video
29:23 - so a lot to to edit so please do back
29:25 - with okay so now that we have done these
29:29 - stunt scripts let's go ahead and try it
29:31 - out and see if it works now like any
29:35 - other item I'm gonna have to go into the
29:37 - map and find the crossbow so hopefully
29:41 - we can do that before the time runs out
29:43 - here we go so try and do it as quick as
29:47 - I can
29:47 - I know it's in here in a dining room and
29:52 - pick it up and hopefully I don't out of
29:55 - time look we've got not long left to
29:57 - talk if I click the piggy he's gone for
29:59 - 20 seconds he can't move I'm trying to
30:01 - move him but he can't move at all
30:03 - he's just trapped and he can't kill
30:06 - anybody so look the contestants everyone
30:08 - so brilliant so the stun script has
30:10 - worked perfectly now
30:13 - let's also test out the bats because I'm
30:15 - wondering if that's working with your
30:18 - most events that we've just added I
30:20 - wonder if it does so wait for the piggie
30:24 - and this will be awesome if it does work
30:27 - so we're gonna click on the player look
30:32 - at that boom player one was killed by
30:35 - the piggy so we've now got our piggy bat
30:37 - working and it says to the piggy has
30:39 - killed everyone so we've got a working
30:41 - piggy game which is awesome so I'm going
30:45 - to try this again and what I love about
30:47 - this is that the camera will change to
30:50 - the piggy when you get killed just like
30:52 - in the normal game so if the piggy kills
30:54 - you it will look like the piggy is
30:57 - hitting you with the bat which is really
31:00 - really awesome so let's have a look
31:01 - again I try and boom and you heard that
31:04 - as well the death sound is the actual
31:07 - one from the piggy game as well so
31:10 - awesome we've got a lot of our piggy
31:14 - game finished so far although there's
31:15 - still a lot more to do things like traps
31:17 - crouching lots more to do and if we just
31:21 - check the output see if anything's gone
31:23 - wrong I don't think it has no errors
31:25 - which is awesome so you can tell that
31:27 - the tutorial is working so there we go
31:33 - okay the next thing that we're going to
31:35 - do is we're going to work on this menu
31:37 - play on server event in the event
31:39 - handling script and we're going to work
31:41 - on when a new player joins and around is
31:44 - already in progress we can insert them
31:47 - into the current round which we know
31:48 - it's going to be pretty easy to do trust
31:50 - me
31:50 - so after this if in menu if statement
31:54 - we're going to do another one underneath
31:55 - it we're gonna say if game got service
31:57 - storage dot game values got game in
32:00 - progress dot value is equal to true
32:03 - double equals then so if a game is
32:06 - currently in progress
32:07 - what we're gonna do is we're going to
32:09 - put the player into the round so what do
32:11 - we need to do well firstly we need to
32:12 - give them a contestant value we're going
32:15 - to put that contestant value into their
32:17 - player so very very simple just as we've
32:19 - done before
32:20 - local contestant equals instance new
32:22 - ball value give it a name contestant and
32:25 - we're going to put that we're gonna
32:26 - parent it inside
32:27 - their player objects then we're going to
32:29 - do is we're going to teleport them into
32:32 - the round using the teleport players
32:35 - function of the round module so we're
32:38 - going to have to in we're gonna have to
32:39 - require the round module by saying a
32:41 - local round module equals require script
32:44 - or parent wait for child game logic
32:46 - round module and then underneath this
32:50 - instance new ball value but still in the
32:52 - if statement we can say round module dot
32:55 - teleport players and we have to supply
33:00 - the player table so the table of players
33:03 - that we want to teleport obviously we
33:05 - just want to teleport this one player so
33:07 - we have to put them in their own table
33:08 - like this just as we have to do with a
33:10 - piggy and then we're gonna do comma and
33:12 - we also need to give the function the
33:15 - map spawns so we will get the current
33:18 - map from the workspace which will be
33:19 - games don't work space dot map as we
33:21 - change the name of the map to be map
33:23 - doctor player spawns in fact we will say
33:26 - find first child map in case it's not
33:30 - there and then we will save dot player
33:33 - spawns : get children like this okay and
33:37 - that will teleport that player into the
33:40 - map it and then they will be in the
33:42 - round so now let's go ahead and test
33:47 - this out so we're going to go into test
33:49 - mode this time however with three
33:51 - players because obviously we need to to
33:53 - start the game and then we're gonna have
33:55 - the third one who joins halfway through
33:57 - so let's check it out
33:58 - okay so we've got player player two on
34:02 - the left to play one on the right and
34:03 - player three in the middle now we're
34:05 - going to insert player three into the
34:07 - game when the current round starts and
34:10 - so let's click on play and boom they get
34:14 - inserted into the round and if the piggy
34:16 - kills player three well they still play
34:19 - a two left so they're still being
34:21 - counted so they're being counted as an
34:22 - actual player so the game registered
34:26 - them as a contestant because we inserted
34:27 - that contestant value into their player
34:30 - excellent so we have just been able to
34:33 - allow players who join late or you know
34:36 - midway through a round into the game
34:39 - halfway through and I think that's fair
34:40 - you know these rounds they're quite long
34:42 - ten minutes they can last a while you
34:44 - only be waiting for ages so so yeah okay
34:51 - so next thing that we're going to do is
34:52 - to do with the piggy bat again and I
34:54 - said earlier about a hitbox which we
34:57 - talked about in the bat script so either
35:00 - to see if it's if the victim is a I'm
35:05 - sorry so two hits a player the piggy
35:08 - currently has to hit the player's
35:10 - character so one of their body parts and
35:12 - that can be hard to do especially if
35:15 - they're moving and jumping is hard to
35:17 - click it especially if you're on a
35:18 - mobile device as well so what I've also
35:21 - done is I've allowed a I've allowed for
35:24 - the piggy to also be able to touch a
35:27 - part called hitbox and so what we can do
35:30 - is we can create a big part which
35:32 - surrounds the players boundaries and
35:35 - it's kind of like a big square part so
35:37 - even if you click an edge of a player's
35:39 - character or maybe just a little bit
35:41 - outside of their head you will still hit
35:44 - their hitbox which will be attached to
35:47 - their character so it will still
35:48 - register as being able to kill the piggy
35:50 - which is why I've said if Mouse target
35:52 - name is hitbox so what we need to do is
35:54 - we need to weld this hitbox to the
35:57 - player if you haven't already seen the
35:59 - hitbox is currently in the server
36:01 - storage it came with the piggy kit and
36:04 - I'm going to show you what it looks like
36:06 - in the workspace it's currently
36:07 - transparent but if we just make it
36:09 - visible you can see so the player would
36:14 - be inside of this hitbox so imagine that
36:16 - the head is like in the middle here you
36:18 - still have a little bit of leeway in
36:20 - that you can hit anywhere within this
36:23 - box and you will still hit the player
36:25 - which is kind of fair I think and it's
36:27 - worked very well in testing so I'm going
36:28 - to make it transparent we're gonna put
36:30 - it into the server storage and the way
36:32 - we're going to do it is we're going to
36:33 - clone at this hitbox and then weld it
36:36 - using a weld object so that it sticks to
36:38 - the players character even when they're
36:39 - moving so make sure that anchored is set
36:42 - to false and can collide it's also set
36:44 - to false okay so both need to be false
36:46 - unchecked but what we're going to do is
36:50 - okay so inside the round module in the
36:56 - teleport teleport players here we will
37:05 - let's think about this yeah so I'm going
37:08 - to I'm going to do a wiener inserts the
37:10 - hitbox so local hitbox clone equals game
37:14 - dot server storage dot hitbox cut on
37:17 - clone I'm gonna say hitbox clone got
37:21 - parents ah yeah got parent equals game
37:28 - sorry
37:29 - player character then we're gonna say
37:31 - hit in fact before we parent it will say
37:33 - hitbox clone dot C frame equals
37:38 - character dot humanoid a root part dot C
37:42 - frame we need to attach it first before
37:43 - we parent it because we need to weld it
37:46 - in a minute
37:46 - then we're gonna say local weld it was
37:49 - instance gotten you by the way if you
37:51 - don't know what a weld is a weld is an
37:53 - object in roblox which joins two objects
37:56 - together even if they weren't anchored
37:57 - so that they stick to each other so
38:00 - instance new weld weld dot part one so
38:04 - you have to set the two parts that
38:05 - they're that they that they stick
38:07 - together so the first part is going to
38:09 - be the characters humanoid root part the
38:13 - second part we don't say part two
38:15 - instead we say part zero I know it's
38:17 - weird but that's the way roblox works
38:19 - part 0 equals hitbox clone okay and then
38:23 - we're going to put the weld objects
38:25 - inside of the character just like that
38:29 - and then we can do the hitbox cloned or
38:33 - parent equals player character so
38:34 - firstly we're cloning it in we're
38:36 - putting it in the right position we're
38:37 - still keeping it in server storage for
38:39 - now
38:39 - just so that we caught it in the right
38:40 - position it won't fall out of place or
38:42 - whatever then we're welding it together
38:44 - and then we're putting the hitbox inside
38:48 - the players character now if we check
38:50 - this out again and load the game up
38:51 - let's have a look okay
38:56 - new round is about to start if we open
38:58 - up the Explorer and have a look in our
39:00 - if we have a look here in this list you
39:04 - can see we have a hitbox for player one
39:07 - who is the other player if we have a
39:09 - look over here you see that they've now
39:11 - got a hitbox surrounding their character
39:13 - so if I was to click maybe just a little
39:16 - bit a little bit off by their next to
39:18 - their head but still click in the hitbox
39:21 - they would still die and it didn't
39:24 - register the first time because I was
39:26 - just a little bit out of bounds so I
39:28 - wasn't within the eight studs but you
39:29 - can see that the hitbox gets created now
39:32 - if your watch again closely obviously we
39:34 - don't know who the Piggy's going to be
39:35 - so it could do insert into any of these
39:37 - players let's have a look who's gonna be
39:43 - ok was player two so this time I've got
39:46 - the hitbox on me so if I was to make
39:50 - open at the properties window and change
39:51 - the transparency ignore point five you
39:53 - can see it surrounding me so the piggy
39:55 - could click anywhere wherever this
39:59 - hitbox is surrounding so here wouldn't
40:01 - work but if I was to click there it
40:03 - would work so it makes it easier for the
40:04 - piggy to kill you but it was hard in the
40:06 - first place especially if you're on
40:08 - mobile so and especially as well if
40:10 - you're a small character and your are 15
40:14 - sliders are ha the lowest is even harder
40:17 - to kill somebody
40:18 - so this hitbox makes it easier for the
40:20 - piggy and trust me if you've ever played
40:22 - with the piggy it is it is it's a
40:25 - godsend it's it's much much better to
40:27 - play with it like this so yeah that's
40:30 - the hitbox complete and it just makes
40:33 - for a better game
40:35 - and also those of you who are using the
40:39 - bats the animation most likely will not
40:41 - play for you and that's because we can't
40:43 - share animations in roblox so you're
40:45 - gonna have to create it yourself
40:47 - now if the bat isn't working for you
40:49 - because of this I recommend that you go
40:53 - into the bat script and you just remove
40:55 - this part here where it says local
40:57 - animal equals player character find
41:00 - first child humanoid load animation
41:01 - script the pound or swing ok remove
41:03 - these lines of code this highlighted
41:05 - block remove that and it should work but
41:08 - I'm going to show you how you can make
41:09 - the animation so what you need to do is
41:12 - you need to go to server storage we're
41:15 - gonna copy the piggy we're gonna put the
41:17 - piggy into the workspace and if we open
41:20 - up the animation editor again set the
41:22 - animation property to be action just
41:23 - make sure that you click the three dots
41:25 - by the play button on the animation and
41:28 - then you've clicked on set animation
41:30 - priority and then you've clicked action
41:32 - if you don't do this then your animation
41:34 - is not going to play when we load the
41:38 - game because it's priority is lower than
41:41 - the default core animation so make sure
41:44 - if your animation doesn't work that you
41:47 - have set the animation priority to be
41:49 - action and then we're gonna do is when
41:53 - you go to about noir point one we're
41:55 - going to drag the arm up into the air
41:58 - I'm gonna move along a bit move it even
42:02 - further back and then drag the blue
42:05 - along and we're gonna swing it so we're
42:08 - gonna move the arm background but turn
42:10 - it a little bit like this let's play
42:13 - perfect I like this one looks good to me
42:16 - so I'm gonna right click export' okay
42:20 - and then it's going to say create new go
42:23 - ahead and do that and give it a name and
42:26 - click finish then carefully click and
42:31 - drag to select this ID then right click
42:35 - and copy it click OK if you can't see
42:40 - that that animation ID go to roblox go
42:43 - to the create page and then go to my
42:46 - animation
42:47 - in the left column and it will appear
42:49 - for you then you can close down the
42:51 - animation editor and then go into the
42:54 - swing animation and paste your animation
42:56 - ID into there and then if you go back
42:59 - into the game it should work I have been
43:02 - filming for over three hours I know the
43:04 - video isn't that long that you're
43:06 - watching but all of this footage has to
43:08 - be edited really really carefully so
43:09 - I've been filming for over three hours
43:12 - today so reads appreciate all the
43:13 - support the likes the subscribes and
43:15 - everything much appreciated
43:17 - ok let's try it again then let's go over
43:19 - here and see if our animation will play
43:20 - boom look at that
43:23 - the animation has played now if you
43:25 - think the player got killed too early or
43:27 - too late and you want to change the
43:29 - timing that's fine just go into the tool
43:32 - and the piggy bat and play around with
43:35 - these weights okay so this weight here
43:37 - change it to maybe a smaller number so
43:40 - in 0.55 100.75 have a quick play don't
43:44 - mess around too much with the other
43:45 - things because you might break the bats
43:47 - and I can't help you you've messed it up
43:49 - okay so the next thing that we need to
43:50 - do we need to actually make it possible
43:51 - for players to escape so in the map we
43:55 - have a final door now I'm going to just
43:58 - take the chapter 1 out of the folder and
44:01 - put it in workspace to show you so the
44:02 - final door is this one and it's unlocked
44:04 - by the white key firstly you need to use
44:07 - the wrench to turn the generator on and
44:09 - the generator has a value inside of it
44:11 - called on and when you click the wrench
44:13 - it will check to see if you've clicked
44:15 - the generator and if you have it will
44:17 - set this on value to be true
44:19 - then when you use the hammer to click
44:22 - these two wooden blocks they will get
44:23 - deleted and then finally when both of
44:26 - these things have been done you'll be
44:28 - able to use the white key to unlock the
44:29 - door so what I've done is I've named
44:33 - this door the exit door so the door that
44:36 - you want people to escape from you must
44:38 - call it the exit door with a capital e
44:40 - and a capital D that is so important you
44:42 - need to call it exit door I've also
44:45 - added a padlock mesh onto every single
44:49 - door so if you want to add if you want
44:52 - to make another door which is locked
44:56 - you need to have two things you need to
44:57 - have this value called key and you also
45:02 - need to take this pavlok so you'd copy
45:03 - it and then you'd get the door you want
45:06 - and select it I press alt and click to
45:09 - select the door itself and then you
45:10 - right-click and paste those two things
45:12 - into it now the padlock is going to
45:15 - appear far away so you need to click the
45:17 - padlock by pressing alt and click and
45:19 - then alt again and click and drag ok let
45:23 - go of alt and then you can drag it onto
45:25 - your door so I'm going to drag it onto
45:27 - the door here then I'm going to use the
45:29 - Move tool just to push it into the door
45:31 - a little bit and I'm going to change the
45:32 - color of the door to a different color
45:35 - okay what I've done that I then need to
45:38 - in fact we would have got a green key so
45:40 - I'm gonna do a a black key it's kind of
45:45 - hard to see there we go
45:46 - black but I'll make it hmm okay we'll go
45:50 - with that
45:51 - so yeah when you've done that you need
45:53 - to then change the value of this key
45:56 - value to say to be the name of your key
46:00 - so it needs to be the name of the tool
46:02 - now I'm gonna create a tool called black
46:04 - key so I'm gonna change this value to
46:06 - say black key so this is the the key
46:09 - that you'll need to unlock this door ok
46:11 - you need to have the value you need to
46:13 - set the value the value property of the
46:15 - value and have the padlock in there as
46:17 - well next you then need to make the key
46:20 - so what I do is I will just take a key
46:23 - so the green key for example right click
46:25 - and duplicate and change it to black key
46:28 - make sure you name it black key and then
46:31 - going to change the color to be black
46:36 - and then I'm gonna go into key handles
46:38 - and I'm going to duplicate one of our
46:41 - current keys so the black and the blue
46:42 - key I'm going to name it black key and
46:45 - again I'm going to change the brick
46:47 - color to be black so we've created a key
46:49 - handle which will allow us to click it
46:52 - and equip it and then we've created our
46:54 - tool objects called black key and we've
46:57 - also got our door with the key value
46:59 - inside which tells this the black key
47:01 - that's needed to unlock it as well as
47:03 - the padlock which will fall off when you
47:05 - click the the key against it so you need
47:07 - a padlock in every single door and
47:10 - key it's not gonna work and you'll get
47:12 - an error then obviously you need to take
47:16 - the black key out of the service storage
47:20 - key handles and you need to put it into
47:21 - the items folder so I'm right clicking
47:25 - and pressing paste into or ctrl shift V
47:28 - and that puts the black key into the
47:31 - items folder and I'm going to press F
47:32 - when selected to move the camera to it
47:35 - and we now need to move it somewhere
47:37 - into our map so that players can pick it
47:39 - up so for example I'm gonna go put it on
47:42 - the bottom for all here okay now if I
47:45 - take the map and I put it into
47:47 - replicated storage into the chapters
47:49 - folder and I play the game again we'll
47:52 - be able to use it so very very essential
47:54 - things firstly you need to have the door
47:57 - with the key string value inside and
48:01 - that needs to the value property of that
48:03 - needs to be the name of the key used to
48:05 - unlock it you then need to create that
48:07 - key and put it into the service storage
48:08 - tools folder and then you need to create
48:12 - the key handle which is basically the
48:14 - the the parts inside of the key inside
48:18 - looked at all so what I did I just
48:20 - duplicated the current key that I had
48:22 - the blue key changed its name changed
48:24 - the color and that way I just had a
48:28 - quick way to make the key and then you
48:30 - had to okay so it's not working for some
48:33 - reason so I can't open the door and if
48:34 - you can't open the door it's a sign that
48:36 - your door manager has gone wrong and
48:39 - there's an error in your door manager
48:41 - scripts so let's just have a look and
48:43 - see what the error is in this server so
48:46 - going into the server window nothing
48:48 - seems to have gone wrong hmm no nothing
48:53 - needs to be wrong here let's try and
48:55 - debug oh I just realized I'm so stupid
49:01 - um so it's locked isn't it it's locked
49:05 - we need the key but the key is on the
49:06 - other side of the door so we kind of
49:10 - chose the wrong door to do there but
49:12 - we'll try again and see we get a
49:13 - different spawn point but then
49:14 - afterwards what we will delete the door
49:17 - there because we don't want that door to
49:18 - be locked
49:21 - by the way unclear into the round module
49:23 - and change the weight here for the for
49:27 - loop to go back to one so it's actually
49:29 - a true countdown of ten minutes so I got
49:33 - lucky this time so if I take the well
49:36 - firstly let's check out the door so I
49:38 - can't currently go through it but if I
49:40 - pick up the key which I can do because
49:44 - it's got that click detector and the key
49:47 - the key scripts inside which you need to
49:50 - put into each key handle by the way so
49:54 - put that a click detector and the key
49:56 - script in there in all the other keys
49:57 - and items so you can pick it up if we
50:00 - put it against the door you can see the
50:01 - door manager automatically makes the
50:03 - padlock for when the key touches it and
50:05 - the door will disappear so that works
50:09 - perfectly so that's how you add your own
50:10 - door or key I'm gonna go back into the
50:12 - chapter now and remove the black key I'm
50:18 - also going to remove the padlock and the
50:21 - key value I'm gonna rename the door as
50:24 - well good practice to name your door to
50:27 - whatever it is so if it's unlocked by
50:29 - the black key name it black door that's
50:32 - what I've done with will leave the door
50:33 - so this is the blue door this is the
50:34 - purple door this is the red door etc so
50:37 - remove the door and the Black Keys also
50:42 - gone from the items folder so that can
50:43 - go back into chapters folder make sure
50:46 - you do put it in wrap the kg storage
50:47 - chapters then I'm gonna go into the key
50:50 - handles and remove it so when I was
50:52 - talking about the key script if you're
50:53 - adding a new key make sure you add this
50:55 - item script into the black key key
50:59 - handle it's in all the other keys so you
51:01 - can just copy it and paste it in but if
51:03 - it's a model like the crossbow as I've
51:05 - said before put it in a part inside the
51:07 - model but change script or parent to
51:09 - script a pound a parent because we want
51:12 - to send the model not a part to the
51:16 - clicked function in the key module so
51:19 - delete the black key and also delete the
51:21 - tool as well if you're not going to use
51:23 - it okay so we're nearly finished with
51:25 - our piggy game the last thing that we
51:26 - need to do is work on the crouching
51:28 - system so that a player can Crouch
51:30 - through certain holes in the map and
51:32 - also the trap system
51:34 - that the piggy can lay down traps which
51:37 - the players can get stuck in so that's
51:39 - what we'll be doing next but we do have
51:42 - a functional piggy game as we speak so
51:44 - you can go ahead and play it and try to
51:46 - escape from the piggy
51:47 - perhaps publish it and try it out with
51:49 - some friends so click on file and then
51:51 - if you go to publish to roblox you'll be
51:54 - able to publish this as your own roblox
51:57 - game also you might not have seen that
52:00 - this main menu actually changes your
52:02 - camera to be looking into that intro
52:04 - tunnel I showed you about earlier this
52:06 - is because in the client main scripts
52:09 - after two seconds your camera see frame
52:12 - so the position of your camera gets
52:13 - changed to the to be looking into the
52:16 - intro tunnel so if you wanted to add
52:18 - your own piggy inside of this tunnel
52:20 - what you need to do is go into server
52:22 - storage where we have currently got our
52:24 - piggy right click and copy and then
52:27 - paste piggy into the intro tunnel now
52:31 - we're gonna use the Move tool to move
52:33 - him all the way over there and we're
52:35 - gonna press F to move our camera to him
52:37 - I'm just gonna move them over here and
52:40 - because the cameras looking like this
52:42 - what I'm going to do is I'm going to use
52:44 - the scale tool and a press down shift
52:47 - and drag to make him bigger then I'm
52:49 - going to use the rotate tool to make him
52:52 - look at the camera like this oops I've
52:57 - dragged it too far out so I'm gonna
52:58 - press ctrl Z and now if we select
53:02 - everything inside of this piggy and we
53:06 - set it to anchored so that he won't move
53:08 - around we can also delete this animate
53:10 - script because it's not needed now if
53:13 - you play the game then after 2 seconds
53:17 - of being in the menu it's 2 seconds just
53:19 - to let you load in you'll see that the
53:21 - piggy has appeared because our camera is
53:24 - now looking at the piggy so if you
53:26 - wanted to you could rotate him even
53:30 - further like this so he's actually
53:31 - looking at you and we'll try it again
53:33 - and you can add whatever things you want
53:36 - to this intro tunnel and it makes it
53:40 - look more like the real game doesn't it
53:42 - because you've got your picky looking at
53:43 - you and you could have more things down
53:45 - here if you want to improve the lighting
53:48 - you can if we go into the lights parts
53:51 - and change the surface light range you
53:53 - can increase that or you can change the
53:55 - brightness or even the angle of the
53:58 - light like this I'm gonna have mine set
54:02 - at 90 there you go very very nice touch
54:04 - and again that intro tunnel came with
54:08 - the piggy kit so make sure that you
54:10 - don't change the name of the intro
54:12 - tunnel or the name of the camera face or
54:14 - camera origin parts because it will it
54:16 - will and break itself if you do want to
54:18 - change it and you do have knowledge on
54:20 - see framing the camera then go ahead but
54:23 - I won't be able to help if you if you
54:25 - mess it up so I hope you enjoy the
54:26 - series so far if you are then please do
54:28 - click the like button and don't forget
54:30 - to subscribe to my channel for more
54:32 - roblox scripting videos I hope you
54:34 - enjoying this one I've put a lot of
54:36 - effort into it so far as I said three
54:38 - hours into recording and there countless
54:40 - hours of creating it and testing it
54:43 - before I even started recording so
54:45 - please do show your support by liking
54:46 - subscribing and if you do want to take
54:50 - your support further you can become a
54:51 - channel remember a premium channel
54:53 - member four dollars 99 and month on my
54:56 - channel you can click the join button
54:57 - underneath the video next to the
54:59 - subscribe button and also you will get
55:01 - the access to the full project file
55:03 - which I'm working on right now so you
55:05 - have all of the code completed for you
55:07 - to go in and use for yourself as well as
55:10 - other cool perks such as a little badge
55:13 - next to your comments in in the chat and
55:16 - also priority responses for your
55:18 - comments and also if you want to tinker
55:21 - around with the effects that come on the
55:24 - screen when the piggy does hit you then
55:26 - you're gonna want to go into the piggy
55:27 - hit local script in the main GUI and
55:29 - mess around with this noir point 65
55:32 - value as well because this is the time
55:35 - that the camera will be looking at the
55:38 - piggy before the screen goes black so
55:40 - the longer the the higher the number so
55:44 - maybe noir point seven five or more
55:45 - point eight the longer will stay looking
55:48 - at the piggy but the the less the number
55:50 - then the the less time it will it will
55:51 - between looking at the piggy and the
55:54 - screen going black so you kind of want
55:55 - it to be synchronized with the piggy
55:57 - batt script so if you set it to nought
55:59 - point eight five over here you want
56:01 - have it the same in this piggy hit
56:03 - script as well so we will leave it there
56:04 - for episode 4 I recommend you go
56:06 - straight to episode 5 it should be
56:09 - released by the time you're watching it
56:10 - or if you're watching it just as it's
56:12 - come out then you'll have to wait until
56:13 - tomorrow to watch that but it should be
56:15 - on your screen now so go ahead and click
56:17 - the thumbnail to head straight to the
56:20 - next part episode 5 I'll see you there

Cleaned transcript:

hello everyone and welcome back to the fourth episode in my how to make a piggy game on roblox series now in this video we're going to be making the tools such as the stunt script for the crossbow and also the piggy batt work as well as the remote events we're going to set those up so we can have the announcements that come up when someone gets killed and also going to do the animations for the piggy bats as well as some general things as well to do with the game logic scripts as I said in the last video if you found a book check out the link in the description down below I am human and so I can't answer all of your comments because I'm getting a hundreds every single day it's just mathematically impossible for me to answer them all so try your hardest to debug your code look at the output window and scan your code line by line really carefully to see if you spell something wrong or made a mistake because that's going to be the cause of your books or your errors because as you can see on my end it's working completely fine so that any further ado let's get straight into episode 4 so what we're gonna work on next is cleaning up after the round is finished so things like teleporting the players back to the lobby removing everybody's tags destroying the map etc so after the start round function is called what we're gonna do is we're going to make the contestant stable in the game logic script we're gonna make it blank again so we're going to say contestants equals and then a blank table to reset it to a blank table then what we're going to do is we're going to loop through all of the players in the game again and just like we did at the beginning we're gonna copy this for loop and we're gonna paste it down here again and what we're gonna do is we're just gonna insert all of the players that are not in the menu into it okay just so that we've got all of the players in the game and then what we'll do is we'll teleport them back to the lobby so because obviously if they are in the menu that now they're going to be already in the lobby so this for loop is just in in adding them to the table again including those though the reason we have made the table from scratch again is because some people might have joined halfway through the round which is what we'll be working on later on and they won't have been counted in the original contestant table because it made before the previous round started so getting all the players again and then what we're gonna do is we're gonna put them back in the lobby so firstly we need to check if there are spawns in the lobby so make sure that you've named your lobby model lobby and you've got that spawns folder in there containing all of these spawn locations they need to be spawn locations and not just normal parts so make sure the fall is called spawns and you've got the lobby so once you've got all of the players in that table we obviously need to check that they were spawned so if game thought workspace Lobby caught on find first child spawns so she's got spawned in your lobby then we're gonna do around we're gonna call that teleport players function on the contestants and then we're going to do we we need to give the spawns to the teleport players function so that's going to be game dot workspace dot lobby again but spawns get children and that will return a table of all the spawns in that folder okay all these spawn locations so that the teleport players can put all the players on different ones and that should do it for the piggy as well because the piggy won't be in the menu so even though we were counseling the piggies our contestant here we're not actually checking if they have a contestant value we're just checking to see if they're they're not in the menu which the piggy won't be so the piggy should be included here but if you haven't got any spawns we can do another fatal error warning just to warn the Creator so if you add a if you change the lobby it's a later date and you forget to add the spawns this should warn you in the output so you don't have to do it if you want but so it's a good way of reminding yourself if you don't know what you've done wrong and it just helps reduce the amount of errors that you might get after that we're going to need to delete the map delete the chapter that's currently in the work space so we can say cloned chapter destroy and that will remove the map we don't want lots of maps being create that each round and then we need to remove everybody's tax and just clean up the whole game in general we've got quite a lot of things that we do need to clean up and which you might not have thought of so things like obviously the Piggy and contestant tag but also removing everybody's tools if they've got one equipped and all that other good stuff so we're gonna go back into the round module where we've got all of our functions and we're going to create another function I'm gonna call it function module dot remove tanks and then inside of this function firstly just going to do another for loop so for I comma V in pairs game dot players colon get players do so for every player who is going to be represented as V we are going to firstly check to see if they have a piggy tag if they do have a pig attack we'll say V dot piggy column destroy him to remove that piggy tag else else if V has a contestant tag which they probably will because there's only one piggy if they have got the contestant tag we will say V dot contestant destroy so we'll firstly delete those tanks very nice and and then we will remove the tools so if they're the piggy gonna have a piggy bat so if V dot backpack find first child piggy bats then V dot backpack piggy bat destroy and and we're gonna do the same thing again we're gonna copy that line I'm just paste it underneath but change the backpack to character in case they have it equipped so change it there but also change it after the then you've got to change it two times so if leader character find for his child to pick you bat then they'll have it in the hands currently we need to destroy it from there as well because it'll either be in the backpack or it will be in the character it'll be unwanted but not both but now we've done that we need to remove all of the contestants tools so we can say for now because we've got a for loop inside another for loop I'm going to use two different variable names for my I and V so we're gonna say for underscore comma P in pairs V backpack get children do so looking through all the tools in the players backpack if P is a tool then he destroyed as I've said it doesn't matter what you call these two values okay I've just used a because I'm not even gonna use the I value the index value I'm only using the P and the P represents the thing that's going to be inside the backpack or anything that's going to be inside the backpack so we're looping through everything so it's going to be done to everything in the backpack so if it's at all gonna destroy it then we need to copy this for loop make sure you only copy the right amount of n so we should only need two ends one for ending the for loop one for ending the if statement and once again change the V dot backpack to V dot character so you're just looping through all of the things in the character and if there's a tool stored in the contestant character we're going to destroy it so now that we've done that we've deleted their contestant value and removed their tools we should be good to go on that front one other thing I'm going to do is I'm going to go into server storage and inside of here in fact yeah in self storage I'm going to insert a folder called game values and inside of here I'm going to insert a bull value and this value is going to be called game in progress and it's just useful because we can set it to be true or false when a game is happening and then from other scripts we can tell if a game is currently in progress for example when we're going to work on the menu script soon which is going to run when they press the play button we want to check to see if a game is currently in progress and if it is we want to put the player into the current around if they've joined halfway through so to do that we need to check our games in progress so I'm gonna set this value to be true when around starts and then at the end when we do the remove tags we can set the value of it to be false so I'm gonna say outside of this for loop that's where it ends don't do that I'm going to say game but service storage game values dot game in progress store value equals false okay I'm gonna make that false then what I'm going to do is we're gonna set it to true in another scripts okay and the script we're gonna put that into is gonna be in the game round module but it's going to be it's gonna be in the start round because that's when the round begins so we'll just do this little whoops we'll just copy it and paste up here but this time I'm going to set it to true because when the round starts we're going to set the game in progress value to be true but then when it ends and we do the remove tags to clean up the game to the general clean up so we can do the next round we're going to set it to false because off to the game isn't in progress anymore in fact we'll put that at the top because it should be executed first in my opinion the script does everything in steps and so we want to firstly set the game in progress value to be false obviously because that's the first thing that should be done just in case somehow some of this is so fast that they click the play button before we set it to false even though the round has finished okay so that's that done and that is the cleaning up needed so that we can start the next round but you will be wondering well how do we start the next round because currently when the game finishes that's it it doesn't restart and it's a good question first things though we need to call that's remove tax function just like that after the clone chapter colon destroy now we need to wrap all of this code that we've just written well nearly all of it into a while loop so where we start this intermission here we're gonna say while while wait do and then we're gonna add an end right at the bottom so make sure you've got that while wait do at the start just after where you've acquired the door module but just before the intermission and then at the very end of the script after the remove tags you add that end then selects everything in between those two lines in between the while wait do and the end select it all and press tab on your keyboard that will indent it and that just makes it a lot more organized and clean it shows us the code that is inside this while loop and now that we've put it in a while loop that means that it will repeat forever so it will just keep running this code over and over again so we start off on the intermission but when we get right to the end and we've removed the tags and we get to this end here we're gonna go right back up to the top and do it all over again and that is how the rounds repeat themselves forever and ever and ever because the while loop when it gets the bottom it will go straight back up to the top so after we've cleaned up the round and destroyed the map and everything and teleported everyone back it's gonna do an intermission again for 30 seconds then it's going to choose a new map because it's firing this round select chapter function and then it's going to teleport everyone then it's going to start another round and that round is only gonna finish when the round start round function gets to the end which will only gets the end when this for loop is broken so either when the time's up or someone dies or the piggy dies or whatever so you can now see that we have this game loop which is running over and over and over again so this is how the game works and we've pretty much finished the game loop for itself now obviously we don't want the round to start unless there are two players because that way is going to do the intermission and if there's only one player is going to choose the piggies and then it's going to get stuck because there's no other contestants to choose from because we've removed the piggy from the table so we need at least two people to start the game and obviously we can test with two people because we can start up our test server so we're going to implement a repeat until loop in our while loop at the top here before the intermission but inside the while loop still so we write repeat until and we want to repeat checking to see if there's enough players in the game so we'll do local we'll create a table and when I call that table available players and we're going to add all of the players that are not in the menu to this table then we're going to see how many items are in this table so how many players are available to play and then we can see if that number of valuable players is greater than or equal to two we can start the game so we're going to repeat and we're going to use a for loop for I comma player in pairs game dot players come get players do if player so if not player find first child in menu so if there isn't a tag in the player called in menu then we're going to insert them into that table so table dot inserts we're going to add them into the available players table and the thing we want to insert is that player so then what we've done that we can say we can set the status to say say to stop value equals in fact we haven't got a variable for the status yet so we're gonna say local status equals game but replicated storage come on wait for child status because we have we have the status value in the round module which is where we've been was well been updating the status from currently but we have no need to actually update the status from the game logic script yet so status door value equals to ready players needed okay and then what we'll do we'll do a bracket and open bracket and then we'll do a dot dot and then we'll do hash tag available players dot dot and then open the bracket again open the speech marks and close the bracket off and that way it just it will tell us the number of players current in the game and in fact I'll do it / in this in this end string here so that it will it will look like a fracture and so if this one player in the game it will say to Eddy players needed and then it will say one out of two not just updates the status makes it look really nice then we're gonna add a weight to just so that it's not repeatedly repeating this every you know hundreds of times per second or whatever we need a nice delay so that it doesn't crash off script so a weight too will do perfectly and then we want it to keep on repeating this and keep on checking to see if there's two players until the number of available players is greater than or equal to two and when it is greater than or equal to two it will break out of this loop it's kind of like a for loop or a while loop it will keep on running until there are two or more objects in that table when I say objects in that table I mean players in the game because if there is a player that is not in the menu then we insert them into that table and every time we go around again we reset the table so we make it blank again we insert all the players that are ready to play and then we count up how many are ready and then if there are enough players then it will break out of this repeat loop okay so now we can test the game and I'm gonna put this intermission back down to 5 seconds because it doesn't matter about it being long or short because the game is only going to start when we have those two players in the game okay so you can see that we are in the game but we haven't been teleported or anything you know nothing has come up on the screen and that is because we're in the menu and we told the scripts not to count us if we're in the menu and if we open up the server here oops if we just bring the server over here and we look at player 1 we can see that player 1 is in menu and player 2 is in the menu when we exit out of the menu look at player 1 you can see that that in menu gets destroyed and now it says that there's one out of two players that are ready to start the game if we do the same for player two it will now say two out of two players already and it's gonna say next round starts in five four three two one one of us is gonna be selected to be the piggy but then we have our game loop and it's still going really really quickly so if I die for example if I reset then it's gonna say the piggy has killed everyone then hopefully it should it will get rid of the map let's see yeah the maps gone I could see it on my server it's completely gone but the next round is starting so it should insert them up again there we go it's been inserted and now you can see we're both the piggy and that's because we haven't undressed the piggy yet and we haven't actually removed the old piggy so that's what we need to do next so to reload the piggy we're going to go into the round module we're gonna go through our remove tags and in the if if statement where it says if the fine first hard piggy what gonna do is we're gonna say at the end of this V curl on load character and what I will do is will respawn the piggy without their outfit so it will just respawn them as they were with their normal player outfit okay and then that way when the next round starts they will be back to normal they won't have their piggy bath anymore because we've destroyed it from the backpack yeah and one other thing I'm gonna do is I'm going to go to the game logic and I'm gonna add some weights so I don't want to activate the doors as soon as the map has been loaded because just in case the map hasn't fully loaded yet and we accidentally miss out a door I'm gonna add a wait two seconds there I'm also going to have a wait two seconds between the actual teleporting of the players and the math being loaded because sometimes the map can't be fully loaded and if you teleport people straight away they might get stuck halfway in the map because they'll start falling and then suddenly the map gets loaded so their torso is stuck in the map so if we get where the map yeah when the map has been loaded and when the piggy has been chosen if we just do another wait here for two seconds that looks good to me and we'll also do another wait here just so that when the rounds all finished we can just wait two seconds after everything's been cleaned up before we start the next one okay I think that's all good let's go ahead and test it again okay so the next round is starting and if we just die again as soon as we load in get ready to reset okay so the current PE has reset and so he should yeah so he's now responding as my default character and hopefully a different piggy gets chosen next time maybe it's gonna be player one on the rise see so now we've got those weights in there were just allowing some time for the everything to get loaded but now we actually have a proper game loop which seems to be working which is really really good so what is left to do got quite a few more things left to do such as the piggy bats and all of the different remote events that we need for our duis and things like that and also things like teleporting players if they've joined halfway through crouching placing traps lots more to come because we want to make our piggy back work so that's one of the remote events that we are we're going to have to set up so I thought I'd walk you through how the piggy batt works so inside the tool piggy bat which is in service storage firstly we have a local script and this handles all of the clicking that's done on the players computer so we've got two events here script dot perparing dot equipped and that's going to run when the tool is equipped and opened up it's going to show the GUI that says click a player within eight studs to kill them just a little helpful guide and this one as well unequipped will hide it when you want equipped at all but this one let's cook the pound activated it's going to fire or be triggered when you click the mouse so Mao stop target is gonna be the thing that you clicked so if the mouse top target is a hip is called hitbox okay or it's inside of a model the thing that you touch then it's likely there's gonna be a player okay so what we'll do is we will use get player from character with the mass target and that will check whether the player that you've clicked is an actual player and if they are a player then we can fire this remote event inside the piggy bat called hit and supplying the player that we've clicked and then in this server scripts is going to pick up the hit event and it's going to play an animation which looks like you're swinging the bat if you're the piggy and what's going to happen is it's quite it looks a bit you know confusing to you but all that's happening is it's checking if the victim the person that you've passed to the to the server script to the through the remote event the victim if they have a character is checking to see if they haven't already escaped that's something that we're going to work on very soon but also it is going to check to see if you are within eight studs of the player so this victim dot character the humanoid root part opposition player character to human rapport position dot magnitude that is basically the distance between you the piggy and the victim so if it's less than or equal to eight studs then it will let you kill them so you have to be within close range and then what it will do is it will slow them down it will make them freeze you'll freeze as well and we've got this function called freeze which will basically kind of like it will weld all of your body parts together so you can't move sorry the victim's character and then we're gonna fire this remote event called piggy hit and that's what we've got to insert so let's create the remote event in a replicated storage and call it piggy hit now what this will do is it will tell the player or the victim to show a GUI on the client end and that's going to be the black GUI that appears and then what will happen is after naught point 65 seconds which is going to be how long it takes for the swing to actually unlike hit the player it will again slow the player down and it will kill them and sorry yeah it kills them and then it plays a death sound and the death sound is the same one you'll hear in piggy and then after they've died it will make the piggy be able to walk again and it will fire this other remote event called kill feed and the kill feed is what makes the GUI pop up on the screen saying that the victim was killed by the piggy so that's another remote event that we're gonna insert and we're gonna call it kill feed so by now you should have three remote events one called menu play one called kill feed and one called piggy hit now if you're interested in learning more about how I made this piggy bat I'm gonna make a tutorial I'm gonna link to it in the card or put it in the description I'm not sure if I've run out of cars yet cuz there's a max limit of five but I will film myself making this from scratch so if you want to enhance your scripting knowledge maybe a little bit more advanced at scripting and you want to know how I made this tool from scratch then I will have a tutorial on how I did that I'll put it in the description okay so they are the road events that you need for the bats now the next thing we'll look at is the stun script so there's also a tool called the crossbow and that's for use by the players the contestants and if they click the piggy basically like shoot the crossbow at the piggy the piggy will become stunned for 20 second so 20 seconds so yeah so inside of this local script it's a little bit different to the other scripts because it fires a rep a remote event called stun so that's another remote event that we'll need I'm gonna add another remote event in through applicators storage and so should you and I'm going to call it stun so what it will do it will fire that remote event and then it will destroy the crossbow because it can only be used once unlike other tools we don't want any player to always be able to kill the auto stone that the piggy house it would be unfair so you only get one use and so it will destroy after use but there are two crossbows available in the map in different places but they were both destroy when they've been used once okay so when this stun remote event is fired it gets picked up on the server in this stun script which came with your piggy kit again I will have a video up teaching you how to make the stun script and the crossbow from scratch although for most of you it probably will be quite advanced and if you don't want to learn how to make it then that's fine but the video is in the description or in the card if I do have a space for a card if you want to learn how to do it but basically a quick overview is that when it's picked up on the server your mouse target so the thing that the player clicked is sent it just checks if the target is um is a member of a model and if it is then it's probably the piggy so we look up the piggy player from their character check to see if they have that piggy value and if they do we're inserting a tag into the piggy called stunned and after 20 seconds that tag gets destroyed so from other scripts we can tell whether the piggy has been stunned for example in the bat script the piggy is not allowed to kill anybody whilst they're stunned so if they try and click and fire this hit event then we will check if not player a fined for his child stunned and that basically means if the piggy isn't stunned then we'll let them kill this player but if they are stunned and they have got that value in them called stunned we're not going to let them we're not going to let the player kill the victim so the victim gets away because the piggy is stuck remember in the stun script the piggy also gets sparkles added to their head which makes it look like they're confused we also announce to all players that piggy is gone for 20 seconds now this is another a most event that you need to insert so go ahead insert another remote event into replicated storage and call it announcement now the announcement remote event gets fired from the server and what you can do is you can send a message now you can either send a message to a certain client a client is basically a player or you can send it to all clients so all players in the game will get the message and when you do if we go into the GUI in the client mein which does again come with your picky kit because I made it for you if you look in here we've got game dot replicated storage that announcement on client event so when it gets fired from the server it's gonna make it's gonna change the announcement GUI so it's gonna change the announcement text labels text to your whatever the text is that we sent it's gonna make it visible for five seconds so you can see that announcement all players will be able to see some something get announced so kind of like a message like piggy has gone for 20 seconds we've also got one the kill feed which we've already created we've already created our remote event for and that is when somebody gets killed with the bat with with a bat script we will fire that event to all players saying that the player whoever it was was killed by the piggy and it's basically the same thing so the remote events that you will need are going to the stun piggy hit announcement kill feed and menu play make sure that you've named them exactly the same as I have and you've got the capitalization correct really really important and as always I am gonna put tutorials into the scripture on how I made all of these realized events work and all of the tools as well it may be a little bit delayed after the video that's just because I have got a lot of content but over at the moment I've already got gone into three hours of filming this video so a lot to to edit so please do back with okay so now that we have done these stunt scripts let's go ahead and try it out and see if it works now like any other item I'm gonna have to go into the map and find the crossbow so hopefully we can do that before the time runs out here we go so try and do it as quick as I can I know it's in here in a dining room and pick it up and hopefully I don't out of time look we've got not long left to talk if I click the piggy he's gone for 20 seconds he can't move I'm trying to move him but he can't move at all he's just trapped and he can't kill anybody so look the contestants everyone so brilliant so the stun script has worked perfectly now let's also test out the bats because I'm wondering if that's working with your most events that we've just added I wonder if it does so wait for the piggie and this will be awesome if it does work so we're gonna click on the player look at that boom player one was killed by the piggy so we've now got our piggy bat working and it says to the piggy has killed everyone so we've got a working piggy game which is awesome so I'm going to try this again and what I love about this is that the camera will change to the piggy when you get killed just like in the normal game so if the piggy kills you it will look like the piggy is hitting you with the bat which is really really awesome so let's have a look again I try and boom and you heard that as well the death sound is the actual one from the piggy game as well so awesome we've got a lot of our piggy game finished so far although there's still a lot more to do things like traps crouching lots more to do and if we just check the output see if anything's gone wrong I don't think it has no errors which is awesome so you can tell that the tutorial is working so there we go okay the next thing that we're going to do is we're going to work on this menu play on server event in the event handling script and we're going to work on when a new player joins and around is already in progress we can insert them into the current round which we know it's going to be pretty easy to do trust me so after this if in menu if statement we're going to do another one underneath it we're gonna say if game got service storage dot game values got game in progress dot value is equal to true double equals then so if a game is currently in progress what we're gonna do is we're going to put the player into the round so what do we need to do well firstly we need to give them a contestant value we're going to put that contestant value into their player so very very simple just as we've done before local contestant equals instance new ball value give it a name contestant and we're going to put that we're gonna parent it inside their player objects then we're going to do is we're going to teleport them into the round using the teleport players function of the round module so we're going to have to in we're gonna have to require the round module by saying a local round module equals require script or parent wait for child game logic round module and then underneath this instance new ball value but still in the if statement we can say round module dot teleport players and we have to supply the player table so the table of players that we want to teleport obviously we just want to teleport this one player so we have to put them in their own table like this just as we have to do with a piggy and then we're gonna do comma and we also need to give the function the map spawns so we will get the current map from the workspace which will be games don't work space dot map as we change the name of the map to be map doctor player spawns in fact we will say find first child map in case it's not there and then we will save dot player spawns get children like this okay and that will teleport that player into the map it and then they will be in the round so now let's go ahead and test this out so we're going to go into test mode this time however with three players because obviously we need to to start the game and then we're gonna have the third one who joins halfway through so let's check it out okay so we've got player player two on the left to play one on the right and player three in the middle now we're going to insert player three into the game when the current round starts and so let's click on play and boom they get inserted into the round and if the piggy kills player three well they still play a two left so they're still being counted so they're being counted as an actual player so the game registered them as a contestant because we inserted that contestant value into their player excellent so we have just been able to allow players who join late or you know midway through a round into the game halfway through and I think that's fair you know these rounds they're quite long ten minutes they can last a while you only be waiting for ages so so yeah okay so next thing that we're going to do is to do with the piggy bat again and I said earlier about a hitbox which we talked about in the bat script so either to see if it's if the victim is a I'm sorry so two hits a player the piggy currently has to hit the player's character so one of their body parts and that can be hard to do especially if they're moving and jumping is hard to click it especially if you're on a mobile device as well so what I've also done is I've allowed a I've allowed for the piggy to also be able to touch a part called hitbox and so what we can do is we can create a big part which surrounds the players boundaries and it's kind of like a big square part so even if you click an edge of a player's character or maybe just a little bit outside of their head you will still hit their hitbox which will be attached to their character so it will still register as being able to kill the piggy which is why I've said if Mouse target name is hitbox so what we need to do is we need to weld this hitbox to the player if you haven't already seen the hitbox is currently in the server storage it came with the piggy kit and I'm going to show you what it looks like in the workspace it's currently transparent but if we just make it visible you can see so the player would be inside of this hitbox so imagine that the head is like in the middle here you still have a little bit of leeway in that you can hit anywhere within this box and you will still hit the player which is kind of fair I think and it's worked very well in testing so I'm going to make it transparent we're gonna put it into the server storage and the way we're going to do it is we're going to clone at this hitbox and then weld it using a weld object so that it sticks to the players character even when they're moving so make sure that anchored is set to false and can collide it's also set to false okay so both need to be false unchecked but what we're going to do is okay so inside the round module in the teleport teleport players here we will let's think about this yeah so I'm going to I'm going to do a wiener inserts the hitbox so local hitbox clone equals game dot server storage dot hitbox cut on clone I'm gonna say hitbox clone got parents ah yeah got parent equals game sorry player character then we're gonna say hit in fact before we parent it will say hitbox clone dot C frame equals character dot humanoid a root part dot C frame we need to attach it first before we parent it because we need to weld it in a minute then we're gonna say local weld it was instance gotten you by the way if you don't know what a weld is a weld is an object in roblox which joins two objects together even if they weren't anchored so that they stick to each other so instance new weld weld dot part one so you have to set the two parts that they're that they that they stick together so the first part is going to be the characters humanoid root part the second part we don't say part two instead we say part zero I know it's weird but that's the way roblox works part 0 equals hitbox clone okay and then we're going to put the weld objects inside of the character just like that and then we can do the hitbox cloned or parent equals player character so firstly we're cloning it in we're putting it in the right position we're still keeping it in server storage for now just so that we caught it in the right position it won't fall out of place or whatever then we're welding it together and then we're putting the hitbox inside the players character now if we check this out again and load the game up let's have a look okay new round is about to start if we open up the Explorer and have a look in our if we have a look here in this list you can see we have a hitbox for player one who is the other player if we have a look over here you see that they've now got a hitbox surrounding their character so if I was to click maybe just a little bit a little bit off by their next to their head but still click in the hitbox they would still die and it didn't register the first time because I was just a little bit out of bounds so I wasn't within the eight studs but you can see that the hitbox gets created now if your watch again closely obviously we don't know who the Piggy's going to be so it could do insert into any of these players let's have a look who's gonna be ok was player two so this time I've got the hitbox on me so if I was to make open at the properties window and change the transparency ignore point five you can see it surrounding me so the piggy could click anywhere wherever this hitbox is surrounding so here wouldn't work but if I was to click there it would work so it makes it easier for the piggy to kill you but it was hard in the first place especially if you're on mobile so and especially as well if you're a small character and your are 15 sliders are ha the lowest is even harder to kill somebody so this hitbox makes it easier for the piggy and trust me if you've ever played with the piggy it is it is it's a godsend it's it's much much better to play with it like this so yeah that's the hitbox complete and it just makes for a better game and also those of you who are using the bats the animation most likely will not play for you and that's because we can't share animations in roblox so you're gonna have to create it yourself now if the bat isn't working for you because of this I recommend that you go into the bat script and you just remove this part here where it says local animal equals player character find first child humanoid load animation script the pound or swing ok remove these lines of code this highlighted block remove that and it should work but I'm going to show you how you can make the animation so what you need to do is you need to go to server storage we're gonna copy the piggy we're gonna put the piggy into the workspace and if we open up the animation editor again set the animation property to be action just make sure that you click the three dots by the play button on the animation and then you've clicked on set animation priority and then you've clicked action if you don't do this then your animation is not going to play when we load the game because it's priority is lower than the default core animation so make sure if your animation doesn't work that you have set the animation priority to be action and then we're gonna do is when you go to about noir point one we're going to drag the arm up into the air I'm gonna move along a bit move it even further back and then drag the blue along and we're gonna swing it so we're gonna move the arm background but turn it a little bit like this let's play perfect I like this one looks good to me so I'm gonna right click export' okay and then it's going to say create new go ahead and do that and give it a name and click finish then carefully click and drag to select this ID then right click and copy it click OK if you can't see that that animation ID go to roblox go to the create page and then go to my animation in the left column and it will appear for you then you can close down the animation editor and then go into the swing animation and paste your animation ID into there and then if you go back into the game it should work I have been filming for over three hours I know the video isn't that long that you're watching but all of this footage has to be edited really really carefully so I've been filming for over three hours today so reads appreciate all the support the likes the subscribes and everything much appreciated ok let's try it again then let's go over here and see if our animation will play boom look at that the animation has played now if you think the player got killed too early or too late and you want to change the timing that's fine just go into the tool and the piggy bat and play around with these weights okay so this weight here change it to maybe a smaller number so in 0.55 100.75 have a quick play don't mess around too much with the other things because you might break the bats and I can't help you you've messed it up okay so the next thing that we need to do we need to actually make it possible for players to escape so in the map we have a final door now I'm going to just take the chapter 1 out of the folder and put it in workspace to show you so the final door is this one and it's unlocked by the white key firstly you need to use the wrench to turn the generator on and the generator has a value inside of it called on and when you click the wrench it will check to see if you've clicked the generator and if you have it will set this on value to be true then when you use the hammer to click these two wooden blocks they will get deleted and then finally when both of these things have been done you'll be able to use the white key to unlock the door so what I've done is I've named this door the exit door so the door that you want people to escape from you must call it the exit door with a capital e and a capital D that is so important you need to call it exit door I've also added a padlock mesh onto every single door so if you want to add if you want to make another door which is locked you need to have two things you need to have this value called key and you also need to take this pavlok so you'd copy it and then you'd get the door you want and select it I press alt and click to select the door itself and then you rightclick and paste those two things into it now the padlock is going to appear far away so you need to click the padlock by pressing alt and click and then alt again and click and drag ok let go of alt and then you can drag it onto your door so I'm going to drag it onto the door here then I'm going to use the Move tool just to push it into the door a little bit and I'm going to change the color of the door to a different color okay what I've done that I then need to in fact we would have got a green key so I'm gonna do a a black key it's kind of hard to see there we go black but I'll make it hmm okay we'll go with that so yeah when you've done that you need to then change the value of this key value to say to be the name of your key so it needs to be the name of the tool now I'm gonna create a tool called black key so I'm gonna change this value to say black key so this is the the key that you'll need to unlock this door ok you need to have the value you need to set the value the value property of the value and have the padlock in there as well next you then need to make the key so what I do is I will just take a key so the green key for example right click and duplicate and change it to black key make sure you name it black key and then going to change the color to be black and then I'm gonna go into key handles and I'm going to duplicate one of our current keys so the black and the blue key I'm going to name it black key and again I'm going to change the brick color to be black so we've created a key handle which will allow us to click it and equip it and then we've created our tool objects called black key and we've also got our door with the key value inside which tells this the black key that's needed to unlock it as well as the padlock which will fall off when you click the the key against it so you need a padlock in every single door and key it's not gonna work and you'll get an error then obviously you need to take the black key out of the service storage key handles and you need to put it into the items folder so I'm right clicking and pressing paste into or ctrl shift V and that puts the black key into the items folder and I'm going to press F when selected to move the camera to it and we now need to move it somewhere into our map so that players can pick it up so for example I'm gonna go put it on the bottom for all here okay now if I take the map and I put it into replicated storage into the chapters folder and I play the game again we'll be able to use it so very very essential things firstly you need to have the door with the key string value inside and that needs to the value property of that needs to be the name of the key used to unlock it you then need to create that key and put it into the service storage tools folder and then you need to create the key handle which is basically the the the parts inside of the key inside looked at all so what I did I just duplicated the current key that I had the blue key changed its name changed the color and that way I just had a quick way to make the key and then you had to okay so it's not working for some reason so I can't open the door and if you can't open the door it's a sign that your door manager has gone wrong and there's an error in your door manager scripts so let's just have a look and see what the error is in this server so going into the server window nothing seems to have gone wrong hmm no nothing needs to be wrong here let's try and debug oh I just realized I'm so stupid um so it's locked isn't it it's locked we need the key but the key is on the other side of the door so we kind of chose the wrong door to do there but we'll try again and see we get a different spawn point but then afterwards what we will delete the door there because we don't want that door to be locked by the way unclear into the round module and change the weight here for the for loop to go back to one so it's actually a true countdown of ten minutes so I got lucky this time so if I take the well firstly let's check out the door so I can't currently go through it but if I pick up the key which I can do because it's got that click detector and the key the key scripts inside which you need to put into each key handle by the way so put that a click detector and the key script in there in all the other keys and items so you can pick it up if we put it against the door you can see the door manager automatically makes the padlock for when the key touches it and the door will disappear so that works perfectly so that's how you add your own door or key I'm gonna go back into the chapter now and remove the black key I'm also going to remove the padlock and the key value I'm gonna rename the door as well good practice to name your door to whatever it is so if it's unlocked by the black key name it black door that's what I've done with will leave the door so this is the blue door this is the purple door this is the red door etc so remove the door and the Black Keys also gone from the items folder so that can go back into chapters folder make sure you do put it in wrap the kg storage chapters then I'm gonna go into the key handles and remove it so when I was talking about the key script if you're adding a new key make sure you add this item script into the black key key handle it's in all the other keys so you can just copy it and paste it in but if it's a model like the crossbow as I've said before put it in a part inside the model but change script or parent to script a pound a parent because we want to send the model not a part to the clicked function in the key module so delete the black key and also delete the tool as well if you're not going to use it okay so we're nearly finished with our piggy game the last thing that we need to do is work on the crouching system so that a player can Crouch through certain holes in the map and also the trap system that the piggy can lay down traps which the players can get stuck in so that's what we'll be doing next but we do have a functional piggy game as we speak so you can go ahead and play it and try to escape from the piggy perhaps publish it and try it out with some friends so click on file and then if you go to publish to roblox you'll be able to publish this as your own roblox game also you might not have seen that this main menu actually changes your camera to be looking into that intro tunnel I showed you about earlier this is because in the client main scripts after two seconds your camera see frame so the position of your camera gets changed to the to be looking into the intro tunnel so if you wanted to add your own piggy inside of this tunnel what you need to do is go into server storage where we have currently got our piggy right click and copy and then paste piggy into the intro tunnel now we're gonna use the Move tool to move him all the way over there and we're gonna press F to move our camera to him I'm just gonna move them over here and because the cameras looking like this what I'm going to do is I'm going to use the scale tool and a press down shift and drag to make him bigger then I'm going to use the rotate tool to make him look at the camera like this oops I've dragged it too far out so I'm gonna press ctrl Z and now if we select everything inside of this piggy and we set it to anchored so that he won't move around we can also delete this animate script because it's not needed now if you play the game then after 2 seconds of being in the menu it's 2 seconds just to let you load in you'll see that the piggy has appeared because our camera is now looking at the piggy so if you wanted to you could rotate him even further like this so he's actually looking at you and we'll try it again and you can add whatever things you want to this intro tunnel and it makes it look more like the real game doesn't it because you've got your picky looking at you and you could have more things down here if you want to improve the lighting you can if we go into the lights parts and change the surface light range you can increase that or you can change the brightness or even the angle of the light like this I'm gonna have mine set at 90 there you go very very nice touch and again that intro tunnel came with the piggy kit so make sure that you don't change the name of the intro tunnel or the name of the camera face or camera origin parts because it will it will and break itself if you do want to change it and you do have knowledge on see framing the camera then go ahead but I won't be able to help if you if you mess it up so I hope you enjoy the series so far if you are then please do click the like button and don't forget to subscribe to my channel for more roblox scripting videos I hope you enjoying this one I've put a lot of effort into it so far as I said three hours into recording and there countless hours of creating it and testing it before I even started recording so please do show your support by liking subscribing and if you do want to take your support further you can become a channel remember a premium channel member four dollars 99 and month on my channel you can click the join button underneath the video next to the subscribe button and also you will get the access to the full project file which I'm working on right now so you have all of the code completed for you to go in and use for yourself as well as other cool perks such as a little badge next to your comments in in the chat and also priority responses for your comments and also if you want to tinker around with the effects that come on the screen when the piggy does hit you then you're gonna want to go into the piggy hit local script in the main GUI and mess around with this noir point 65 value as well because this is the time that the camera will be looking at the piggy before the screen goes black so the longer the the higher the number so maybe noir point seven five or more point eight the longer will stay looking at the piggy but the the less the number then the the less time it will it will between looking at the piggy and the screen going black so you kind of want it to be synchronized with the piggy batt script so if you set it to nought point eight five over here you want have it the same in this piggy hit script as well so we will leave it there for episode 4 I recommend you go straight to episode 5 it should be released by the time you're watching it or if you're watching it just as it's come out then you'll have to wait until tomorrow to watch that but it should be on your screen now so go ahead and click the thumbnail to head straight to the next part episode 5 I'll see you there
