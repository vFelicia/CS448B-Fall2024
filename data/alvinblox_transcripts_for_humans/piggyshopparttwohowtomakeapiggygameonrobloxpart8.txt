With timestamps:

00:00 - okay so next we need to do the data
00:02 - saving this won't take long at all all
00:05 - we need to do is go into the event
00:06 - handling scripts and at the top here
00:09 - let's create a variable for the
00:11 - datastore service which is used to save
00:13 - data so local data store service equals
00:16 - game : get service data store service
00:21 - then we're gonna get our datastore for
00:24 - this specific game to hold everyone's
00:25 - data so a local datastore equals the
00:28 - datastore service code on get data store
00:31 - and you need to give a name for this
00:34 - datastore now the name I'm gonna give is
00:36 - my data store very very simple you can
00:39 - name it whatever you like but if you
00:41 - change the name of this there's
00:44 - something different then it's going to
00:45 - start using new data so let's say for
00:49 - example you publish this game and 10
00:51 - people came and had their data saved to
00:53 - the my datastore but then you went and
00:55 - change the name of the datastore to my
00:56 - datastore too and then people rejoined
00:59 - their data would get lost so choose a
01:01 - name and stick with it okay it doesn't
01:03 - matter no one else is gonna see it so
01:05 - now you put your data store what we need
01:08 - to do is because it for a datastore each
01:10 - player has their own key and that key is
01:13 - used to identify their data so we can
01:16 - save data to a key for each player and
01:18 - we can identify the key by their user ID
01:21 - so every player on roblox has a user ID
01:24 - and you can find your user ID by going
01:26 - to your profile it's in the web web
01:28 - address link you don't need to know it
01:30 - though what we need to do is we need to
01:32 - save the data so what we'll do is just
01:38 - after the player added events down here
01:42 - just before the trap debounce we're
01:44 - going to say game dot players play out
01:47 - removing : Connect function and player
01:51 - it's gonna be one of the arguments so
01:54 - this will run the code inside of it
01:57 - when a player leaves the game so what
02:04 - we're gonna do is we need to create a
02:08 - table for all their data so there's
02:10 - gonna be lots of data that goes in here
02:12 - for example they're tokens they're
02:16 - equipped trap or skin the skins they own
02:21 - the traps they own etc so what we'll do
02:26 - is we're going to create sub indexes
02:28 - inside this table so there could be a
02:30 - table inside this big data table which
02:32 - contains all the skins they have and I
02:34 - know the table inside of it which
02:35 - contains all the traps they have so to
02:38 - create an index in the table
02:40 - you just have to say the table name and
02:41 - then the name the index so for example
02:44 - if I want it to name if I wanted to save
02:46 - the tokens in the table I could say data
02:48 - dot tokens equals player dot tokens dot
02:52 - value and now that is inside the table a
02:55 - bit like so it might look a bit like
02:57 - this ok so that's what it might look
03:02 - like at the minute so now that we've put
03:06 - the two water we're gonna put all this
03:08 - data into the big tip into the big data
03:10 - table then we're just gonna save this
03:11 - one table to the datastore so it's
03:13 - saving everything to our key I have a
03:16 - full video on my channel as well on how
03:18 - to use data stores if you are a little
03:20 - bit so unsure but this will give you a
03:23 - quick intro and brief about them so now
03:25 - that we've saved these tokens we need to
03:27 - save the equipt trap and equipped skin
03:29 - so data not equipped trap equals player
03:33 - dot equipped trap value and data
03:37 - equipped skin equals player dot equipped
03:42 - skin dot value then we need to create a
03:47 - sub table for all the skins you have so
03:49 - data dot skins equals a blank table now
03:53 - I'm using a capital letter for skins so
03:55 - a capital S and a capital T for traps so
03:59 - I've created those two tables and now I
04:02 - need to use a for loop to loop through
04:03 - the skin inventory table and the trap
04:05 - inventory table
04:07 - so for IV in pairs player got skin
04:12 - inventory : get children so because the
04:17 - skin inventory : get children returns us
04:19 - a list of all of the skins in your
04:22 - inventory the eye is going to be the
04:25 - number of where it is in the table and
04:27 - the V is going to be the value so it's
04:29 - going to be the the value that's in
04:31 - there so V is like the object the value
04:34 - that's in there and I is like how the
04:36 - number of of where it is in that table
04:39 - so in a table so in that table it could
04:42 - look a bit like this it could have
04:46 - Mangala boy if that was the name of her
04:48 - skin ghost
04:50 - piggy and what was the other one we had
04:53 - shaggy boy okay so if we so the first
05:00 - time so for the first index would be one
05:02 - second index would be two third index
05:04 - would be 3/4 index was before so I it's
05:07 - just the the number of the index that
05:09 - were currently on so if we were
05:10 - currently looping through the ghost then
05:12 - I would be 2 and V would be ghost okay
05:14 - so what we're gonna do is make sure you
05:18 - had to do on the end of that for loop
05:20 - and then we're going to insert into the
05:22 - table table dot inserts we're going to
05:24 - insert into date skins and then comma
05:27 - the name of the current objects were
05:30 - looping through so the name of the skin
05:31 - that's in that in that inventory so if
05:33 - there's five skins in the skin inventory
05:35 - we're going to loop through every single
05:37 - one and five times we're going to insert
05:39 - the name of that skin so we're gonna
05:41 - insert the name of every skin in that
05:43 - skin inventory into the table data dot
05:46 - skins okay so this data got skins it's
05:49 - gonna get populated with every single
05:54 - skin for that player will own okay and
05:57 - the way that we get all the skins that
05:58 - they own is because we get basically
06:00 - taking everything that's in the skin
06:02 - from inventory folder and cloning it
06:05 - into the data dot skins but
06:10 - we can't just set they still skins to
06:12 - player dot skin inventory come on get
06:14 - children because you can't save objects
06:16 - through a data store so what we're doing
06:18 - is we're kind of serializing it so that
06:20 - we're saving their name not the object
06:22 - and then when we load the data we'll be
06:24 - able to look up the skin using its name
06:26 - in the replicated storage so we can't
06:28 - save objects to date stores but we can
06:30 - save object names instead so I'm also
06:34 - going to prints the name of V of the
06:37 - object that we're looping through so
06:39 - that it'll print out all of the objects
06:41 - that get added that to that table so we
06:43 - know that the that they got saved for
06:46 - sure to the datastore then I'm going to
06:48 - copy and paste but change skin inventory
06:50 - to trap inventory and also data dot
06:53 - skins will be changed today to traps so
06:55 - make sure that you change the truck the
06:57 - skin inventory to trap inventory in the
07:00 - clone in the second for loop and they
07:02 - thought they'd allot skins will become
07:04 - data thought traps okay so we are
07:06 - populating the data dot skins and the
07:08 - data's or traps folders with the names
07:11 - of these skins and the traps that you
07:13 - own and now that we've populated this
07:16 - big data table with all this data we can
07:19 - save that big table to our data store
07:21 - for a specific player who's leaving the
07:23 - game so data store colonel onset async
07:27 - that's how we save to a datastore and we
07:31 - need to provide the key so the key is
07:32 - going to be unique for each player and
07:34 - the best way to uniquely identify each
07:36 - player is by using their roblox user ID
07:38 - because nobody is going to have the same
07:40 - user ID so we can say player got user ID
07:43 - comma and then the second argument is
07:47 - going to be the data that we save so in
07:48 - this case we're going to save our table
07:50 - called data to the datastore and then
07:53 - what we need to do is we need to wrap it
07:55 - in a peak or in case it goes wrong so
07:57 - local success error message equals P
08:02 - call and then in brackets function with
08:04 - another pair of brackets and make sure
08:06 - you close it off with an end and a
08:08 - closing bracket now a P call basically
08:11 - because sometimes a data store could
08:13 - error
08:14 - maybe this data store service could be
08:15 - down or something data stores can error
08:18 - and they can break your whole scripts
08:20 - but when you wrap them inside a peak or
08:22 - function it's um
08:23 - thing goes wrong it won't break the
08:24 - script the arrow won't cause the script
08:26 - to stop you just simply won't save your
08:28 - data so instead of losing even more data
08:31 - by breaking the scripts in it no longer
08:33 - running so it will no longer be checking
08:35 - for when someone leaves the game it will
08:37 - just catch the error and it will not
08:39 - break the script it will just put it to
08:41 - one side and not stop the script for it
08:44 - so and in all it will also if it was a
08:48 - success this values variable called
08:50 - success which we've also created will be
08:52 - true and if success is false then there
08:54 - will be an error message and that what
08:56 - error message will be the error message
08:59 - variable that i've also created will be
09:01 - populated and it will be updated with
09:03 - the error message so if it was the
09:05 - success then prints successfully saved
09:11 - okay so that will successfully save
09:14 - somebody's data to the datastore now we
09:17 - need to load the data when they rejoin
09:19 - the game which is very very simple so if
09:23 - you go back to the player added event so
09:25 - this is when a player joins the game we
09:27 - can get the players data from the data
09:29 - store if they have some data
09:30 - because of you there could be a new
09:31 - player and there wouldn't be any data
09:33 - for them we're gonna get it anyway local
09:35 - data equals and this variable it doesn't
09:39 - have to be called data I'll just make
09:40 - calling it data because it makes sense
09:41 - sooo so if you are copying what I'm
09:43 - doing probably best to use the same name
09:47 - so you don't get confused local data he
09:50 - was datastore : gets async and we need
09:54 - to provide the key which we saved the
09:56 - data to so we can look up that key in
09:58 - the datastore and see if there's any
10:00 - data attached to it so the key which we
10:03 - saved was their user ID so we're just
10:05 - gonna say player but user ID make sure
10:08 - the user ID you have an uppercase I but
10:10 - a lowercase D and that uppercase u for
10:12 - user so comfortable you for user then
10:14 - come to I but a lowercase D is it we're
10:17 - confusing but you have to write it like
10:18 - I do obviously it will not work so you
10:20 - do a your user ID with a capital D not
10:23 - gonna work has to be a lowercase D so if
10:27 - there is data in the datastore and it
10:29 - should be this table that we saved
10:31 - because this data at this table was
10:32 - going to have the tokens they equipped
10:34 - route the equipped skin everything
10:36 - attached to it
10:36 - because it's gonna be inside that table
10:39 - so if there is data then it's going to
10:42 - be then the data variable is going to
10:44 - hold that data but again it because
10:48 - we're using data stores it could go
10:49 - wrong there could be an error when we
10:51 - get the data so we need to do a peak or
10:52 - so a local success common error message
10:55 - equals P call function like this make
10:59 - sure you get the brackets on the end of
11:00 - the function and you also have a closing
11:03 - bracket for the end like this so P call
11:06 - an open bracket and you have a function
11:08 - with another pair of brackets and you
11:10 - have to close the first bracket off
11:11 - there as well
11:12 - so actually what we'll do is we will
11:18 - define the data variable outside of the
11:21 - P call because we will because if we
11:23 - were to define it inside the P call then
11:25 - we'd only be able to access the data
11:26 - from inside the peek or what we want to
11:28 - access the data from outside the people
11:30 - as well so only isn't the P cool for
11:33 - when we when were for only for this line
11:35 - when we're getting the data because
11:36 - that's the only time where it could
11:39 - error and it could break the script so
11:41 - once we have the data we need to check
11:43 - to see if the data is not equal to nil
11:45 - so if data is not equal to nil when it's
11:49 - not equal to nil we know that there is
11:50 - data there if the data was nil-nil means
11:53 - nothing so there's no data stored so if
11:56 - there is any nil data then we're not
11:59 - going to do anything but if there is not
12:01 - any new data so that's what this
12:03 - operator is so if data is not nil and
12:06 - there is some data then we want to load
12:09 - this data so we know that we need to
12:11 - load the equipped trap we know that we
12:14 - need to load the equipped skin we know
12:17 - that we need to load the tokens we know
12:19 - that we need to load the skins inventory
12:21 - I also know that we need to load the
12:23 - traps inventory so we're creating these
12:26 - folders for the equipped trap sorry for
12:28 - the trap inventory skin inventory and
12:30 - the values for the equipped trap
12:32 - equipped skin and tokens but what we
12:34 - need is we just need to set the value of
12:36 - these things to the values from the data
12:39 - store so firstly we're going to say if
12:42 - data because Mary's a table so there we
12:45 - are our sub tables and indexes inside of
12:48 - it so if data don't equip the trap
12:50 - then equipped value sorry equip the trap
12:54 - dot value equals data
12:57 - equipped trap and then we can say if
13:01 - data not equipped skin I'm doing them
13:03 - all in the if statement in case they're
13:05 - not there for some reason so if they
13:07 - start equipped skin then equipped skin
13:11 - dot value equals data but equipped skin
13:15 - then we're gonna say if data got tokens
13:18 - then I'm gonna say piggy tokens remember
13:24 - if you named your variable something
13:25 - different which is not picky tokens you
13:28 - would be saying the name of your
13:29 - variable here so if it was cash for
13:32 - example piggy tokens value equals data
13:38 - dot tokens and the same thing if you
13:40 - saved your data your tokens are
13:42 - something different like data cache
13:44 - equals player dot data player got cash
13:46 - no value you would say data's or cash or
13:48 - data got money your data dot
13:50 - tickets or something else but because
13:52 - it's tokens for me I am loading the data
13:55 - tokens right then I'm going to load in
13:58 - the skins a little bit more work needed
14:00 - but not a lot at all if theta dot skins
14:03 - then I'm gonna say for I comma V in
14:09 - pairs data dot skins because it's a
14:12 - table I'm gonna loop through the data
14:14 - dot skins table do and I'm going to
14:17 - create a string value because remember
14:18 - in the skin inventory and the trap
14:20 - inventory all it is is a folder which
14:23 - will contain lots of string values and
14:24 - the string values will be named with the
14:27 - same name as the skins and the traps
14:29 - that we own so it's a way of telling us
14:31 - which skins and traps be owned by
14:32 - inserting string values with the same
14:34 - names so we can just loop through and
14:36 - get the names of all of the string
14:38 - values in that's in that equipped so in
14:43 - that skinned in retreat wraps inventory
14:45 - II they will be string values they won't
14:47 - be the actual skins and trap models
14:49 - themselves but they will be a reference
14:50 - because I'll have the same names so
14:53 - local Val or string value doesn't matter
14:56 - because instance new string value
15:01 - foul name we're going to set the name
15:04 - with a string value to be V because V is
15:07 - going to be the name of each skin
15:08 - because it's not gonna be V dot name
15:10 - it's just gonna be V because it's a
15:11 - string it's not an object because when
15:13 - we save the data we saved V dot name not
15:16 - the object itself not be the object but
15:19 - V dot name so he saved a string to the
15:21 - datastore cause remember I said earlier
15:22 - you cannot save an object through
15:25 - datastore you have to save H string to a
15:27 - datastore so a valid name equals V we're
15:31 - just giving it the name of the other
15:32 - skin that was the week that was saved
15:33 - one of the skins that were saved because
15:35 - we're doing if every skin is gonna loop
15:37 - through it's gonna create a new string
15:38 - value for every single skin there's not
15:41 - data's or skins table and then we're
15:43 - gonna parent it to the skin inventory so
15:46 - Valdo parent equals skin inventory then
15:50 - all we need to do is just copy this for
15:52 - loop and same thing again if data dot
15:55 - wraps then and we're going to loop
15:59 - through theta dot wraps and insert a new
16:03 - string value name it the name of the
16:05 - trap but we're going to parent it to the
16:07 - trap infantry okay so there we go we've
16:11 - just loaded all of the data in but
16:14 - because we only want to now what I did
16:17 - earlier was in the client shop after
16:21 - five seconds I call the add skins and
16:24 - our traps I only want to do this when
16:26 - your data has loaded so once your data
16:28 - has loaded and we know that it's loaded
16:30 - so what I'm gonna do is I'm going to
16:31 - create a rotor I'm gonna create a remote
16:33 - event in the replicated storage and
16:36 - remote events I'm going to call it send
16:41 - data so what we can do is I'm
16:53 - got replicated storage got send data
16:54 - curl on fire clients I'm going to fire
16:58 - it for the player who just joined the
17:00 - game I'm going to send their data as
17:02 - well so the data we got from the data
17:03 - store I'm going to send to the client
17:04 - okay and then when the data gets picked
17:08 - up sorry when that Verizon gets picked
17:10 - up down here I'm gonna get rid of the
17:13 - white 5 I'm gonna change it to dick game
17:15 - tool replicate his storage dot send data
17:18 - but on client event : Connect function
17:22 - and we don't need to play our argument
17:25 - because it's on the client I'm going to
17:27 - put the ad skins and our traps function
17:29 - inside this event so the traps and the
17:34 - skins are only going to be loaded into
17:36 - our GUI once once they once the date has
17:43 - been loaded so once the data about our
17:46 - equipped values and our skins that we
17:49 - own has been loaded only then will I
17:52 - create all the frames in the skins and
17:55 - traps frames and show them only once the
18:00 - date has been loaded and we know the
18:02 - date has been loaded because after all
18:05 - of this equipped trap setting and adding
18:08 - all the skins to the skin inventory in
18:10 - the trap inventory only then do I fire
18:12 - the Sun data remote events so that will
18:15 - only fire once the data's loaded and it
18:16 - only picks up once the data's loaded so
18:22 - moment of truth let's see if this will
18:25 - work first things you need to do is
18:26 - right-click and click on publish to
18:30 - roblox ass if you haven't already make
18:32 - sure you publish it as a roblox game ok
18:37 - I'm gonna try again publish to roblox
18:40 - ass doesn't want to work for some reason
18:48 - yeah there we go every started studio
18:49 - and now it seems to work so I'm going to
18:51 - publish it or update a already published
18:53 - game just make sure it's published to
18:55 - roblox and then click on game settings
18:58 - go to options this is very very
19:01 - important make sure that enable studio
19:03 - access to API services is turned on okay
19:06 - turn that on enable studio access to API
19:09 - services on click Save and then you'll
19:13 - be able to test your game and your data
19:14 - stores in roblox studio ok now I
19:17 - recommend that you test it in a proper
19:19 - game ok I recommend you do that and that
19:22 - is what I'm going to do and if it takes
19:28 - ages to load the server don't worry it's
19:30 - probably because roblox is under a lot
19:31 - of load it did take me a while to open
19:33 - this server up but if I go and purchase
19:36 - a few things let's purchase the ghost
19:38 - and the shaggy mane and the invisi trap
19:40 - let's equip the invisi trap and equip
19:42 - this shaggy man
19:43 - let's leave the server and rejoin okay
19:47 - moment of truth and I'm just gonna say
19:49 - this as well
19:49 - data stores it is likely you might have
19:52 - problems with it and it's one of the
19:55 - hardest things to debug ok so it looks
19:59 - like our data hasn't loaded here so I'm
20:02 - going to check the developer console
20:04 - just to see if anything's gone wrong and
20:06 - just to make sure let's do game thoughts
20:11 - players thought Alvin under school
20:14 - blocks thought equipped trap value let's
20:17 - print that out just to see if anything
20:19 - was saved okay so it says the equipped
20:23 - one was the invisi trap so what I
20:26 - think's happened yes ok I know what's
20:30 - happened so it has loaded the data but
20:33 - it's just not it's not updating the the
20:39 - cost text or the button image so because
20:42 - look when we click on the button sorry
20:46 - when we click on let's go back when I
20:48 - click on the shaggy man it instantly
20:50 - equips it and this turns to owned so it
20:53 - knows that we already own it it's just
20:54 - that we haven't coded it on the client
20:56 - so when the when we first insert these
20:59 - frames it doesn't automatically update
21:01 - to say the it doesn't load the equipped
21:05 - or owned values in the GUI it load it
21:09 - updates the values but it doesn't update
21:11 - the GUI so let's have a look at that now
21:13 - so I've got a very very simple fix for
21:16 - this if we go back into the main GUI
21:19 - into the shop and client shop what we
21:22 - can do in the ad skins and the other
21:24 - trap is we will say if game dot players
21:29 - got a local player so the player which
21:32 - this script is running on so for the
21:34 - current player local player dot trap
21:37 - inventory cannot find first child or
21:39 - Jesus for the skinning of inventory as
21:41 - well very soon find first child the V
21:44 - dot name then so if if it's in your if
21:47 - the skin that we're looping through was
21:50 - already the trap that were looping
21:51 - through is in your trap inventory so you
21:53 - you own it then we can set the frames
21:56 - cost of text to be owned and the frames
22:00 - button image to be the green tick
22:04 - straight away and so they're having to
22:05 - wait for us to click the button so
22:07 - because this is running when the data is
22:10 - sent when the data is loaded we can
22:13 - check to see if you have that trap in
22:16 - your trap inventory and if you do then
22:18 - we will change it to say owned Anna
22:19 - green tick and we'll do another if
22:22 - statement to see if you have it equipped
22:23 - so if game got players that local player
22:26 - does equipped trap dot value equals
22:30 - equals V dot name because we don't name
22:32 - is the name of the trap so if you have
22:34 - this trap equipped we can say frame dot
22:36 - cost of text equals equipped and frame
22:40 - but button dot image equals green tick
22:44 - just like that so it's going to
22:46 - instantly say whether you own it or
22:48 - whether you have it equipped now I'm
22:50 - going to copy these two if statements
22:52 - we're gonna go oh my bad
22:55 - I've done the trap one in add skins so I
22:58 - need to change it to skin inventory and
23:00 - equipped skin let's take these copy them
23:05 - let's go to the add traps one
23:08 - and paste them into our traps but change
23:11 - skin inventory to trap inventory and
23:13 - equipped skin to equipped trap okay so
23:18 - what it's going to do is it's going to
23:20 - instantly check to see if you own the
23:22 - trap or the skin or whether it's
23:23 - equipped and if it is it will
23:25 - automatically update the frame just say
23:27 - to say whether it is owned or equipped
23:30 - now I'm going to publish the game again
23:32 - and go check it out so what should
23:36 - happen is it should instantly show me my
23:39 - loaded owned and equipped skins and
23:43 - Trump's so let's go to the store and
23:46 - there we go straight off the bat it says
23:48 - oK you've got the shaggy man equips
23:50 - because that is what we did equip in the
23:52 - last time we were in the game about two
23:53 - minutes ago and also it says that we own
23:55 - the ghost and also that the invisi trap
23:58 - is equipped and the yellow trap is also
24:00 - owned so if I go and buy everything and
24:03 - buy buy buy
24:05 - I'm going to equip the ghost and equip
24:07 - the red trap now I'm going to leave the
24:09 - game and go back in now if you're
24:12 - testing new studio sometimes it might
24:15 - not save your data and I think that's
24:17 - because the game is closing down before
24:19 - it's managed to save in time because
24:21 - it's in roblox to do this shouldn't
24:23 - happen in a real game and it shouldn't
24:25 - affect you because I've tested it quite
24:27 - a lot and it hasn't caused me any
24:30 - problems but anyway you can see that the
24:32 - ghost is equipped and the red trap is
24:34 - also equipped and everything else is
24:36 - owned and if I wanted to I could change
24:38 - the equipt values and it's everything
24:40 - else is becoming unequipped but the
24:42 - yellow trap is now equipped and now
24:44 - universi traffic equipped and the other
24:45 - trap is now owned so it seems to be
24:48 - working really really well ok so now I'm
24:51 - going to show you how to make the skins
24:53 - and the traps appear in the GUI here in
24:56 - these gray squares and we're gonna be
24:58 - using viewport frames viewport frames
25:00 - allow you to render roblox objects in a
25:03 - GUI so in this case we want to render
25:05 - the piggy skin and the traps so to
25:10 - render them they need to be cloned into
25:12 - the viewport frame and then we also need
25:16 - to have a camera which will be looking
25:18 - directly out those objects so in roblox
25:20 - we can have an
25:21 - objects called a camera and we can tie
25:23 - that camera we can set the viewport
25:25 - frames current camera property to that
25:28 - camera objects and then it will be
25:29 - looking we can set the see frame like
25:31 - the position of that camera to be
25:33 - looking at our cloned piggy characters
25:35 - so I'm gonna show you how you can you
25:37 - can do that now so we're gonna go into
25:41 - the client shop script I'm going to go
25:43 - up to the create frame function so right
25:46 - now we've only just we've only copied
25:48 - our template in there we haven't done
25:49 - anything to do with the viewport frames
25:51 - so what we're going to need to do is
25:52 - we're going to need to take the objects
25:55 - argument which is the actual object of
25:57 - the skin or Liam trap we're gonna have
25:59 - to clone it out and put it inside our
26:02 - viewport frame because the only things
26:03 - that put into the viewport frame can be
26:05 - rendered on the screen so we can say
26:08 - local vpf obj so if you put frame
26:12 - objects you can call it whatever you
26:13 - like this is just the name I made up
26:14 - equals objects current clone then we can
26:19 - say vpf or parent equals frame doctor
26:23 - viewport frame so we're putting it
26:26 - inside that viewport frightened there so
26:28 - now that we've put our objects in the
26:30 - viewport frame we need to create our
26:31 - camera which will be looking at it
26:33 - because the camera is the thing that's
26:34 - going to render everything in the
26:35 - viewport frame on the screen so it's a
26:39 - local cam it was instance got new camera
26:44 - cam parent I'm gonna put this inside the
26:47 - viewport frame as well equus frame dot
26:50 - viewport frame now we've done that we
26:53 - can say if item type Oh in fact yeah
26:57 - sorry I was just reading off my script I
27:00 - forgot to so what we gonna do we're
27:02 - gonna create a fifth argument and this
27:04 - is gonna be called item type so that we
27:06 - can tell the function whether we're
27:08 - gonna insert a skin or a trap so in the
27:10 - add skins function on line 54 that's
27:13 - where my line is it might not be on your
27:15 - line 54 but where we're calling create
27:17 - frame in the add skins function we're
27:19 - going to add that v argument and we're
27:21 - just gonna add a string we're going to
27:23 - call it skin just like we do down here
27:24 - in the by item so we can tell the
27:27 - function that we're going to be adding a
27:29 - skin and you'll see why is because
27:32 - we need to make the camera a look at a
27:35 - certain object look at a certain part so
27:38 - for the skin
27:39 - we'll just make it we'll make the camera
27:40 - look at the the skin head right that the
27:43 - head objects inside the piggy character
27:45 - but a trap obviously won't have a part
27:48 - called head so we will just need to well
27:52 - because the of the object for the trap
27:54 - will just be a part we can make it look
27:55 - at that part the reason I'm doing that
27:58 - is because if you don't make it look at
28:01 - the head for the piggy then we wouldn't
28:03 - be able to see it it will probably just
28:04 - look at its torso and we won't get a
28:06 - view of its head
28:07 - so if we position the camera to be
28:09 - looking at the head of the piggy
28:11 - character we'll be able to see his face
28:12 - whereas it doesn't matter for the trap
28:14 - because we can just make it look at that
28:16 - one part because the trap is only made
28:17 - up of one part so well this is going to
28:20 - tell us whether it's a skin or a trap so
28:22 - if we go down to the out traps function
28:24 - we're going to have that faith argument
28:25 - in there as well but the argument is
28:27 - gonna be called trap the both they're
28:29 - both going to be strings as well so trap
28:32 - and skin and once you've done that we
28:34 - can then say if item type is equal
28:38 - remember doll equals because it's an if
28:39 - statement is equal to a skin then we can
28:43 - set the camera C frame to the to the
28:49 - character's head whereas else if the
28:52 - item type double equals is a trap then
28:57 - we can just set the camera C frame to
29:00 - the object because it's just going to be
29:02 - a part because if you think about it if
29:04 - you're going to replicate the storage
29:07 - got traps and then look these are just
29:09 - obvious just parts right and they're
29:12 - just done by their mesh parts but they
29:14 - still a part there's one object isn't it
29:16 - so to set the camera C frame to be the
29:19 - character's head I also have a video
29:21 - coming out on see frames very soon so if
29:24 - you find it a little bit hard to
29:25 - understand check that video out it's
29:27 - gonna be in the advanced series but
29:28 - anybody can watch it you don't need any
29:30 - prior experience for that one so what
29:33 - what we'll do we'll set the C frame C
29:34 - frame is basically position with
29:37 - rotation so in this case we're going to
29:39 - position the camera to be
29:42 - just a little bit far out from the place
29:46 - character so we can actually see them
29:48 - but we're going to be pointing it
29:49 - towards the player's head so it's going
29:51 - to be rotated towards their head so a
29:55 - little example here if we've got imagine
29:59 - this is the character really badly drawn
30:00 - but imagine this is the character we're
30:03 - gonna put our camera around about here
30:05 - about five studs away from the character
30:08 - and if I will put it around here because
30:11 - it'll be up in the air a little bit and
30:12 - it's going to be looking at their head
30:14 - so it's gonna be angled down this way so
30:16 - if that's the camera and that's the
30:19 - Piggy character it's going to be looking
30:21 - at their head because normally if we
30:24 - didn't do this it would just be looking
30:26 - at their torso so we're gonna do it like
30:29 - this and to do that we're gonna say cam
30:32 - dot C frame equals C frame new and this
30:37 - C frame is going to be object because
30:39 - it's a character we know that the object
30:41 - is their character model so we can say
30:43 - object dot head position so the position
30:46 - of their head with we're gonna add on to
30:49 - that we're going to add on in the
30:52 - direction that's their character is
30:54 - facing so currently if you think about
30:57 - that diagram again if we've currently
30:59 - got their head position so the cameras
31:01 - around about here where the arrow head
31:02 - is we need to get the forward-facing
31:05 - direction and we need to multiply it by
31:08 - a certain number to bring it out to
31:10 - around about here so we want to bring
31:11 - the camera out to around about here
31:13 - currently the cameras here we want the
31:15 - camera to be about five or ten studs
31:17 - away from the character and then we can
31:19 - point it towards a character so we can
31:21 - actually get their head in the view okay
31:24 - because all of this stuff won't be seen
31:25 - because it's out of the characters out
31:26 - the cameras view so we can say inside of
31:30 - here we're doing another pair of
31:31 - brackets and inside of it we'll say
31:34 - object dot head dot C frame so then
31:40 - we'll say look vector so look vector is
31:42 - a property of C frame but it's actually
31:45 - a position value this probably might be
31:48 - making sense but if it doesn't as I said
31:50 - don't worry I have a C frame video
31:51 - coming out multiply that by five
31:54 - and then what we can do is we can add
31:59 - some height to it so about two studs of
32:02 - height okay so I'm adding two studs of
32:09 - heights because I want it to be the
32:13 - camera just to be a little bit higher
32:14 - than the players head so we can look
32:16 - down on their head and that just gives a
32:18 - better experience and it fits more into
32:20 - the into the camera frame and then so
32:24 - this this part of the code this first
32:27 - part it's just positioning the camera so
32:30 - what we've done is we've positioned the
32:32 - camera well we firstly got the position
32:35 - of the players head which is around
32:37 - about here right if you imagine this is
32:39 - the players character and this is the
32:41 - you know this is the position of their
32:43 - head we're then getting the look vector
32:46 - the look vector is the forward-facing
32:47 - direction so the forward direction and
32:49 - that's so that's a nicer vector so we're
32:53 - multiplying it by five so we can move
32:57 - that thing you don't get my words out
33:00 - and so we're moving this five studs
33:05 - forward this is moving the camera five
33:08 - studs forward so the camera was here and
33:11 - it's now probably about here we're then
33:13 - moving it to studs in the air so now the
33:16 - camera is here and the next thing we're
33:18 - going to do after this comma is we're
33:21 - going to tell the scripts where we
33:24 - wanted to be facing because we the
33:25 - camera could be facing this way could be
33:27 - facing that way could be facing that way
33:30 - so how do we tell it we want it to look
33:32 - at the head which is here well that's
33:37 - what we'll do so to do that we can just
33:39 - write objects got head got position
33:43 - because it would then just point the
33:46 - camera towards the the character's head
33:48 - so that is going to set this camera C
33:51 - frame to the character's head now what
33:54 - about if it's a trap well it's a little
33:56 - bit easy if it's a trap all we need to
33:57 - do is say cam got C frame obviously
34:01 - equals C frame new objects drop position
34:05 - because the trap is just going to be a
34:06 - part
34:07 - now if your trap is a model is made up
34:10 - of loads of parts you will need to say
34:14 - objects and then the parts name so for
34:17 - example if yours was in a group like
34:19 - this you'd have to say object bear
34:22 - underscore trap dot position in fact you
34:26 - wouldn't you'd have to have you'd have
34:28 - to have a part in that model which is
34:31 - named the same throughout all models so
34:33 - we have multiple models you would just
34:34 - say an object dot handle and handle
34:38 - would be the the main part right which
34:40 - is used by this viewport frame which it
34:44 - which is where the camera is looking at
34:45 - so object dot handle sorry notice it so
34:49 - yeah that's if you're using a model
34:50 - right so you'd say objects that handled
34:52 - opposition
34:53 - all right so instead of saying object
34:55 - opposition you'd say object dot handle
34:57 - but if you are just if you're like me
35:01 - and you're not you've only got one part
35:03 - traps I'm using a mesh part by the way
35:05 - which is why I can make them look good
35:07 - and just use one part because there are
35:10 - mesh using a mesh ID so I'm just going
35:12 - to rename this to be bear underscore
35:14 - trap so yeah if you're just like me and
35:16 - they're not in models they're just
35:17 - single parts I'm going to say object dot
35:20 - position because object is the part
35:22 - itself because it will be passed to the
35:25 - function and we're going to add on
35:27 - object dot C frame got to look vector so
35:30 - that's the forward facing component
35:32 - multiply it by five so we can be so it's
35:35 - the is five studs away from the object
35:37 - so that the camera actually is able to
35:40 - see it fully and then we will say plus
35:43 - vector three dot new zero to zero so
35:46 - it's just a little bit higher up in the
35:47 - air so that we can still we can get a
35:50 - nice view on it then we'll do a comma
35:52 - and then because the second argument in
35:53 - a C frame is the what is going to look
35:56 - at we just needed to look at the trap
35:58 - itself so object opposition so the
36:00 - camera will be facing the object okay so
36:04 - now that we've set the camera C frame we
36:06 - just need to set the if you put frame
36:09 - its current camera property to be that
36:12 - camera so frame dot viewport frame dot
36:15 - current camera equals
36:18 - yeah okay so now as soon as that current
36:23 - camera is set to our camera it will
36:25 - start rendering the objects in our
36:27 - people frame so let's go ahead and test
36:29 - it out hope this works
36:31 - really hope it does it would be amazing
36:32 - if it worked first time so we're gonna
36:34 - go to store oh yeah we need to make that
36:37 - button work don't we but there we go
36:39 - you can see we've got shaggy man Piggy
36:41 - and the ghost so all of our skins are
36:44 - loaded in and all of our traps are
36:46 - loaded in as well you can see the
36:47 - Envisat wrap is kind of hard to see but
36:49 - I can see it on my screen is because
36:51 - it's nearly invisible hence the name
36:54 - invisi trap but there we go we can now
36:56 - see our objects in there very very
36:59 - nicely some people probably will ask how
37:02 - do you make them spin good question it
37:05 - would take a little bit more coding I'm
37:06 - not going to go into it today but you
37:08 - can probably look up how to do that it
37:11 - involves having a loop which would
37:13 - repeatedly set the C frame of the object
37:16 - to be moving around or you could loop
37:20 - setting the C frame of the camera to
37:22 - loop around it but that is not necessary
37:24 - and I think this looks fine as it is it
37:26 - just requires less work so that is how
37:29 - you get the characters in a viewport
37:31 - frame like that so very very nice I am
37:34 - pleased with that right next I'm going
37:37 - to show you how you can add the piggy
37:39 - tokens to the bottom of the screen so we
37:41 - can see how much money we've got so I am
37:44 - going to insert into the main GUI I'm
37:48 - going to add a text label on that text
37:51 - label I'm going to call it tokens and I
37:57 - will set the position of this text label
38:03 - to one zero one zero and that will put
38:08 - it at the bottom right corner of the
38:10 - screen but you can't really see it that
38:12 - is because it's positioning it from the
38:14 - middle so if we set it to be positioned
38:16 - from the top right sorry the bottom
38:19 - right by setting the anchor point to be
38:22 - 1 1 it is now in the bottom right corner
38:26 - of the screen I'm going to set the
38:27 - background transparency to be 1 and I'm
38:30 - going to set these text
38:31 - scale would have to be true I can change
38:35 - the font if I like I'm going to change
38:37 - it to Gotham bold and I'm also going to
38:41 - change the size I'm going to change it
38:43 - from offset to scale so that it scales
38:45 - with the size of the screen so I'm going
38:47 - to set it to not 0.15 so it takes up
38:51 - well it takes up yeah that that's it's
38:56 - kind of like a fraction so naught point
38:58 - 1 5 would be 15 percent of the screen on
39:01 - the x-axis and then it's going to take
39:04 - up a tenth of the screen on the y-axis
39:06 - that didn't work some reason no point 1
39:10 - 5 comma 0 naught point 1 comma 0 there
39:13 - we go that's better then I'm going to
39:15 - change the text and to whatever really
39:18 - it's going to be updated anyway and I'm
39:20 - going to change the text color 3 to a
39:23 - nice pinky color let's see let's see
39:26 - what we've got okay I know I've got a
39:34 - saved color so we'll use 255 comma 1 1 6
39:38 - comma 1 3 4 perfect
39:41 - that's a nice color so now that we've
39:46 - done that we can start coding it so if
39:48 - we go into the client main script I mean
39:52 - if you could do it in any script really
39:53 - but I'm going to do it in this one
39:54 - because that's where I've done the rest
39:55 - of the coding for this sort of stuff so
39:57 - I'm going to create two variables the
39:59 - first one is going to be the the text
40:06 - label so local tokens label equals the
40:10 - script dot parent which is a Gy color on
40:12 - wait for child tokens ok the next thing
40:16 - I'm going to create a variable for is
40:18 - going to be the actual tokens value
40:20 - which is in my player so local tokens
40:24 - whose game dot players but local player
40:28 - : wait for child tokens okay so they've
40:35 - got the same name but they're in
40:36 - different they're in different places
40:37 - and they're different things because
40:39 - this one is the value with our tokens in
40:41 - the player object
40:44 - whereas this is the text label in our
40:47 - main GUI
40:49 - so now that we've got those two what we
40:52 - can do is we can create some simple
40:53 - events which will whenever the value
40:55 - gets changed we can update the text of
40:58 - the text label so very very simple we're
41:01 - just going to say I will do it mmm we'll
41:05 - do it here are these data stuff we'll
41:08 - say firstly because the game will load
41:12 - and the and because beer oh because the
41:18 - game will load and this script sorry
41:23 - what awesome so what I'm trying to say
41:26 - is we're going to set up a changed event
41:29 - a get property change signal to change
41:30 - the text when the value changes but it
41:34 - might not we want to set the value sorry
41:38 - the text of the text label to its
41:40 - current value before we set up that
41:41 - event because it might be changed before
41:44 - the event is running so we can say
41:46 - tokens label dot text equals tokens dot
41:49 - value and then we can say tokens : gets
41:53 - property changed signal a value so when
41:56 - the value property changes we can say
41:59 - you can connect it to a function and
42:02 - that function is going to fire and
42:05 - inside of that function we can say the
42:07 - same thing again tokens label dot text
42:09 - equals tokens dot value so if we load
42:15 - the game it should immediately change
42:16 - the text to zero so we shouldn't see you
42:19 - one three three seven there we go so
42:21 - after two seconds obviously because we
42:23 - have to do the two-second wait for the
42:25 - script to load up but it has loaded up
42:29 - with seven hundred and thirty eight
42:31 - poins so that's obviously been taken
42:34 - from a data store that got saved last
42:36 - time so if I go in to the server because
42:40 - you can only change your values like
42:41 - your tokens value on the server house it
42:43 - won't take effect let's change it to one
42:45 - one zero obviously you won't be able to
42:47 - see the amount of tokens on the server
42:49 - because its client based there we go it
42:52 - says 110 so I leave the game
42:55 - I'm also going to change the tokens text
42:57 - from one three three seven just to
42:59 - nothing so that it doesn't give a fake
43:01 - amount of coins that you don't actually
43:03 - have okay it didn't seem to load for
43:09 - some reason but it's well it loaded the
43:11 - old value but it didn't save the one
43:12 - from the previous game I think that's
43:14 - because the play solo shut down before
43:16 - it managed to save it in time so yeah
43:19 - we'll see about that but we have got the
43:21 - tokens working now which is which is
43:23 - good okay next we need to code the
43:28 - buttons don't we the buttons in the menu
43:31 - here so that it loads the store and also
43:36 - this close button here so we'll begin
43:38 - with the close button because that won't
43:41 - take very long to do at all so we can go
43:43 - to the client main script and at the
43:46 - bottom here I'm going to create an event
43:51 - for the close button so we can say
43:54 - scripts dot parents come on wait for
43:58 - child shop and then we can say dot wait
44:04 - for child close doctor mouse button one
44:10 - click
44:10 - : connect function and then inside of
44:15 - here very very simply we can just say
44:18 - well firstly we need to see if you're in
44:20 - the menu because you could close the
44:21 - shop when you're in the menu or you
44:23 - could close the shop when you're out of
44:24 - the menu so depending on that if you are
44:27 - in the menu and you close it we want to
44:28 - show you the menu screen again but if
44:30 - you aren't in the menu we just want to
44:31 - close the GUI so we already know if
44:34 - you're in the menu or not because you've
44:35 - got like in menu value in your player so
44:37 - we can say if game dot player's dot
44:40 - local player curl on find first child in
44:43 - menu then we know you are in the menu so
44:51 - because of that we will say intro dr.
44:54 - serve 1 equals true we'll make that
44:56 - intro frame visible
44:59 - and then also because this will apply
45:03 - for whether you're in the menu or not we
45:05 - will close the shop so script doctor
45:07 - parent wait before child shop dot
45:11 - visible it was false so we're going to
45:13 - hide that shop so we have just scripted
45:17 - the close button let's go and test it
45:20 - out in fact we can test it out until
45:23 - we've made the shop store button in the
45:26 - menu work so we will say intro because
45:32 - in the intro he can see we've got a
45:33 - person called store so intro dot store
45:36 - dot mouse button one-click colon connect
45:40 - function and then we will say when you
45:45 - click that store button we want to
45:47 - firstly hide as well we want to enable
45:49 - the shop so script dot parents come on
45:51 - wait for child shop thought visible it
45:55 - was true and we're gonna hide the intro
45:58 - because if you're in the intro we want
45:59 - to hide it so intros look visible equals
46:02 - false right let's go and try it now so
46:06 - we play the game and if we click on
46:11 - store you can see it opens up the camera
46:15 - stays there because we're still in the
46:16 - menu it still got that in menu value so
46:20 - we can browse the store and when we're
46:22 - finished we're back in the menu and then
46:25 - we can get out of the menu in menu has
46:27 - gone away and we can open the shop
46:29 - normally if we want to click the button
46:31 - to close it you can see it doesn't open
46:33 - the menu again so very very good we have
46:36 - now managed to make the menu in the shop
46:40 - work let's just do one more test we'll
46:42 - set it to one one one close the game and
46:45 - click play again yes we I don't think
46:52 - it's managed to save the values in time
46:54 - because the play solo has quit before
46:56 - it's managed to save I've never
46:58 - experienced that in a running game
47:00 - before but ok I'm going to show you a
47:03 - way to fix that problem where it doesn't
47:05 - save your data if you leave the play
47:07 - solo because there's a chance it could
47:09 - happen in a real server as well if
47:10 - you're the last player in the game
47:12 - because we're the last player in the
47:13 - game
47:13 - to play solo the server can shut down
47:15 - before the script has finished saving
47:17 - your data so to fix this we can use an
47:21 - event called bind to close so game :
47:24 - bind to close then we're just going to
47:26 - put a function in there
47:27 - no connect or anything just like this so
47:29 - any code inside of here will ruin when
47:32 - the server is about to shut down so when
47:37 - the last player has left the server will
47:39 - not trip down unless this code is
47:42 - finished executing so we can loop
47:43 - through all of the players that are left
47:45 - in the game like this and if we just set
47:53 - the V to player and we copy this code
47:57 - inside the player removing and we put it
48:00 - inside of here and we just indent it
48:03 - like this there we go
48:07 - it will make sure your data gets saved
48:09 - before the server shuts down so I'll
48:12 - show you this I'll show you once more my
48:15 - data will appear my amount of tokens
48:17 - will be very very large because I just
48:18 - tested that if we go in and we set my
48:21 - tokens to be 11 for example and I leave
48:27 - the game and I go back in you can see it
48:30 - successfully saved it friendly is
48:31 - successfully saved this time we go back
48:33 - in I have got as if by magic an 11
48:36 - tokens so that is the data store problem
48:39 - fixed one last bug I'd like to address
48:44 - which I have found after testing the
48:46 - game after I put the series out it's not
48:49 - a big book or a big game breaking book
48:51 - at all it's just that sometimes it can
48:54 - bug out because if you reset when a game
48:59 - isn't happening and the map isn't loaded
49:02 - then it will it will get through this if
49:05 - statement and it will try to drop your
49:06 - tools using games at workspace dock map
49:08 - and I'll see there won't be a game that
49:09 - works based on map because the map won't
49:11 - have been loaded yet so to fix this we
49:14 - can say if in
49:19 - this humanoid root part a statement we
49:21 - can say if player cannot find first
49:23 - child contestant so if they're in the
49:27 - game currently and they've got the
49:28 - contestant tag they wouldn't have it if
49:30 - a game wasn't in progress and game dot
49:32 - workspace cannot find first child map
49:37 - then just put this these two lines in
49:41 - there to drop the tools and we can put
49:42 - an end in there so this is just an
49:46 - example of how you know books can pop up
49:49 - after you've made something and they
49:51 - won't pop up for a while because that
49:53 - eventualities one happen so in this case
49:55 - the eventualities was that no player
49:57 - reset themselves when a game wasn't
50:00 - happening and that took a while to find
50:02 - out it's not something that people
50:03 - usually do but when they do do it if
50:04 - they do do it it would break your script
50:06 - so that's how you fix a book there and
50:09 - that is a book that we have fixed so
50:11 - again it's not a huge book because they
50:13 - know the chances of somebody even
50:14 - resetting in the lobby are minimal it's
50:17 - not like somebody will do that anyway
50:19 - and I don't think it would break the
50:21 - whole script it just wouldn't it would
50:23 - cause a small error but it's there you
50:25 - go that's another book that we have
50:26 - squashed right then I think we do one
50:31 - last test and we'll be good to go so
50:32 - let's just insert yeah two players
50:36 - should do okay so i have equipped the
50:41 - shaggy mane and the invisi trap on this
50:44 - account so if you can see that the
50:45 - shaggy man has loaded in and if they
50:49 - press the truck button there you go
50:52 - there's the invisi trap it's loaded
50:54 - perfectly so everything just seems to be
50:56 - working and no complaints from me let's
51:00 - just place another trap let's get stuck
51:03 - in the trap there we go and ooh ah
51:06 - got one more thing it says killed by the
51:09 - piggie um now I'm not too worried about
51:12 - that to be honest because yeah I'm fine
51:15 - with that just if you're naming your
51:17 - your game something different so I don't
51:19 - know like bacon or whatever then you
51:24 - would want to go into your game logic
51:27 - scripts and your client script where it
51:31 - says
51:32 - player was killed by the piggy and
51:34 - changed that - player was killed by the
51:35 - bacon etc but again please be original
51:38 - when you're quoting these piggy games
51:40 - please credit me in them because you
51:42 - know I've spent a lot of time working on
51:43 - this series so I think it's just right
51:45 - that you credit me in the video so in
51:49 - your game or you know in the description
51:51 - that you've used my kit so that others
51:54 - can know how you made it and can help
51:57 - grow my channel because I've said a lot
51:59 - effort into this series you know if
52:00 - biggest serious I've ever done it and
52:02 - I've done it in the smallest amount of
52:03 - time I've ever done before so thanks for
52:07 - watching the series as I said this will
52:09 - be the last one because you know it's
52:11 - got to end at some point got to end at
52:13 - some point you know for me to go on and
52:15 - make even more series and more videos
52:16 - I've got to stop making these ones
52:18 - because they take up way too much of my
52:20 - time but that is everything for part 7
52:23 - please do like the video if you've
52:25 - enjoyed it please do subscribe if you're
52:28 - interested in more videos do check out
52:30 - my 23 part beginner series and my
52:32 - advanced series after that because it
52:33 - will help you become a roblox crypto so
52:35 - you can make your own games without me
52:36 - having to show you because I'll be
52:38 - awesome when you when you know how to
52:40 - make your own games it's awesome because
52:41 - you get an idea it comes in your head
52:43 - and you can just make it straight away
52:45 - so it's really really awesome and you
52:47 - can also make a lot of money from roblox
52:49 - a lot of money so if you're interested
52:51 - in that you interested in learning how
52:53 - to make your own roblox games then do go
52:56 - ahead and click the subscribe button
52:57 - share it with your friends or like the
52:59 - videos so I know you like them and it's
53:01 - been a blast thank you for watching this
53:03 - piggie series how to make a piggy game
53:05 - from scratch it really has been fun
53:08 - making this game and I'm glad you've had
53:09 - fun watching it as well do check my
53:12 - website if you have any problems or bugs
53:14 - to learn how to fix your books I've also
53:16 - got a video showing how to fix books if
53:19 - you come across them and not to give up
53:20 - and remember you can become a channel
53:23 - member if you want to take the full
53:25 - source code and get a load of other
53:27 - awesome perks which you can check out by
53:28 - clicking the join button on my channel
53:30 - so after all of that I would just like
53:32 - to say a final thank you to everybody
53:34 - who has watched the series and everybody
53:36 - else who has helped me test my channel
53:39 - members have spent an awful lot of time
53:41 - testing the game with me even before I
53:44 - launched the first video and I
53:45 - alter them so you know who you are thank
53:47 - you for that and also thank you to Linda
53:50 - in 2009 for developing a map as well
53:55 - much appreciated for that so thank you
53:58 - everybody for watching and I'll see you
54:00 - in the next tutorial Cheers

Cleaned transcript:

okay so next we need to do the data saving this won't take long at all all we need to do is go into the event handling scripts and at the top here let's create a variable for the datastore service which is used to save data so local data store service equals game get service data store service then we're gonna get our datastore for this specific game to hold everyone's data so a local datastore equals the datastore service code on get data store and you need to give a name for this datastore now the name I'm gonna give is my data store very very simple you can name it whatever you like but if you change the name of this there's something different then it's going to start using new data so let's say for example you publish this game and 10 people came and had their data saved to the my datastore but then you went and change the name of the datastore to my datastore too and then people rejoined their data would get lost so choose a name and stick with it okay it doesn't matter no one else is gonna see it so now you put your data store what we need to do is because it for a datastore each player has their own key and that key is used to identify their data so we can save data to a key for each player and we can identify the key by their user ID so every player on roblox has a user ID and you can find your user ID by going to your profile it's in the web web address link you don't need to know it though what we need to do is we need to save the data so what we'll do is just after the player added events down here just before the trap debounce we're going to say game dot players play out removing Connect function and player it's gonna be one of the arguments so this will run the code inside of it when a player leaves the game so what we're gonna do is we need to create a table for all their data so there's gonna be lots of data that goes in here for example they're tokens they're equipped trap or skin the skins they own the traps they own etc so what we'll do is we're going to create sub indexes inside this table so there could be a table inside this big data table which contains all the skins they have and I know the table inside of it which contains all the traps they have so to create an index in the table you just have to say the table name and then the name the index so for example if I want it to name if I wanted to save the tokens in the table I could say data dot tokens equals player dot tokens dot value and now that is inside the table a bit like so it might look a bit like this ok so that's what it might look like at the minute so now that we've put the two water we're gonna put all this data into the big tip into the big data table then we're just gonna save this one table to the datastore so it's saving everything to our key I have a full video on my channel as well on how to use data stores if you are a little bit so unsure but this will give you a quick intro and brief about them so now that we've saved these tokens we need to save the equipt trap and equipped skin so data not equipped trap equals player dot equipped trap value and data equipped skin equals player dot equipped skin dot value then we need to create a sub table for all the skins you have so data dot skins equals a blank table now I'm using a capital letter for skins so a capital S and a capital T for traps so I've created those two tables and now I need to use a for loop to loop through the skin inventory table and the trap inventory table so for IV in pairs player got skin inventory get children so because the skin inventory get children returns us a list of all of the skins in your inventory the eye is going to be the number of where it is in the table and the V is going to be the value so it's going to be the the value that's in there so V is like the object the value that's in there and I is like how the number of of where it is in that table so in a table so in that table it could look a bit like this it could have Mangala boy if that was the name of her skin ghost piggy and what was the other one we had shaggy boy okay so if we so the first time so for the first index would be one second index would be two third index would be 3/4 index was before so I it's just the the number of the index that were currently on so if we were currently looping through the ghost then I would be 2 and V would be ghost okay so what we're gonna do is make sure you had to do on the end of that for loop and then we're going to insert into the table table dot inserts we're going to insert into date skins and then comma the name of the current objects were looping through so the name of the skin that's in that in that inventory so if there's five skins in the skin inventory we're going to loop through every single one and five times we're going to insert the name of that skin so we're gonna insert the name of every skin in that skin inventory into the table data dot skins okay so this data got skins it's gonna get populated with every single skin for that player will own okay and the way that we get all the skins that they own is because we get basically taking everything that's in the skin from inventory folder and cloning it into the data dot skins but we can't just set they still skins to player dot skin inventory come on get children because you can't save objects through a data store so what we're doing is we're kind of serializing it so that we're saving their name not the object and then when we load the data we'll be able to look up the skin using its name in the replicated storage so we can't save objects to date stores but we can save object names instead so I'm also going to prints the name of V of the object that we're looping through so that it'll print out all of the objects that get added that to that table so we know that the that they got saved for sure to the datastore then I'm going to copy and paste but change skin inventory to trap inventory and also data dot skins will be changed today to traps so make sure that you change the truck the skin inventory to trap inventory in the clone in the second for loop and they thought they'd allot skins will become data thought traps okay so we are populating the data dot skins and the data's or traps folders with the names of these skins and the traps that you own and now that we've populated this big data table with all this data we can save that big table to our data store for a specific player who's leaving the game so data store colonel onset async that's how we save to a datastore and we need to provide the key so the key is going to be unique for each player and the best way to uniquely identify each player is by using their roblox user ID because nobody is going to have the same user ID so we can say player got user ID comma and then the second argument is going to be the data that we save so in this case we're going to save our table called data to the datastore and then what we need to do is we need to wrap it in a peak or in case it goes wrong so local success error message equals P call and then in brackets function with another pair of brackets and make sure you close it off with an end and a closing bracket now a P call basically because sometimes a data store could error maybe this data store service could be down or something data stores can error and they can break your whole scripts but when you wrap them inside a peak or function it's um thing goes wrong it won't break the script the arrow won't cause the script to stop you just simply won't save your data so instead of losing even more data by breaking the scripts in it no longer running so it will no longer be checking for when someone leaves the game it will just catch the error and it will not break the script it will just put it to one side and not stop the script for it so and in all it will also if it was a success this values variable called success which we've also created will be true and if success is false then there will be an error message and that what error message will be the error message variable that i've also created will be populated and it will be updated with the error message so if it was the success then prints successfully saved okay so that will successfully save somebody's data to the datastore now we need to load the data when they rejoin the game which is very very simple so if you go back to the player added event so this is when a player joins the game we can get the players data from the data store if they have some data because of you there could be a new player and there wouldn't be any data for them we're gonna get it anyway local data equals and this variable it doesn't have to be called data I'll just make calling it data because it makes sense sooo so if you are copying what I'm doing probably best to use the same name so you don't get confused local data he was datastore gets async and we need to provide the key which we saved the data to so we can look up that key in the datastore and see if there's any data attached to it so the key which we saved was their user ID so we're just gonna say player but user ID make sure the user ID you have an uppercase I but a lowercase D and that uppercase u for user so comfortable you for user then come to I but a lowercase D is it we're confusing but you have to write it like I do obviously it will not work so you do a your user ID with a capital D not gonna work has to be a lowercase D so if there is data in the datastore and it should be this table that we saved because this data at this table was going to have the tokens they equipped route the equipped skin everything attached to it because it's gonna be inside that table so if there is data then it's going to be then the data variable is going to hold that data but again it because we're using data stores it could go wrong there could be an error when we get the data so we need to do a peak or so a local success common error message equals P call function like this make sure you get the brackets on the end of the function and you also have a closing bracket for the end like this so P call an open bracket and you have a function with another pair of brackets and you have to close the first bracket off there as well so actually what we'll do is we will define the data variable outside of the P call because we will because if we were to define it inside the P call then we'd only be able to access the data from inside the peek or what we want to access the data from outside the people as well so only isn't the P cool for when we when were for only for this line when we're getting the data because that's the only time where it could error and it could break the script so once we have the data we need to check to see if the data is not equal to nil so if data is not equal to nil when it's not equal to nil we know that there is data there if the data was nilnil means nothing so there's no data stored so if there is any nil data then we're not going to do anything but if there is not any new data so that's what this operator is so if data is not nil and there is some data then we want to load this data so we know that we need to load the equipped trap we know that we need to load the equipped skin we know that we need to load the tokens we know that we need to load the skins inventory I also know that we need to load the traps inventory so we're creating these folders for the equipped trap sorry for the trap inventory skin inventory and the values for the equipped trap equipped skin and tokens but what we need is we just need to set the value of these things to the values from the data store so firstly we're going to say if data because Mary's a table so there we are our sub tables and indexes inside of it so if data don't equip the trap then equipped value sorry equip the trap dot value equals data equipped trap and then we can say if data not equipped skin I'm doing them all in the if statement in case they're not there for some reason so if they start equipped skin then equipped skin dot value equals data but equipped skin then we're gonna say if data got tokens then I'm gonna say piggy tokens remember if you named your variable something different which is not picky tokens you would be saying the name of your variable here so if it was cash for example piggy tokens value equals data dot tokens and the same thing if you saved your data your tokens are something different like data cache equals player dot data player got cash no value you would say data's or cash or data got money your data dot tickets or something else but because it's tokens for me I am loading the data tokens right then I'm going to load in the skins a little bit more work needed but not a lot at all if theta dot skins then I'm gonna say for I comma V in pairs data dot skins because it's a table I'm gonna loop through the data dot skins table do and I'm going to create a string value because remember in the skin inventory and the trap inventory all it is is a folder which will contain lots of string values and the string values will be named with the same name as the skins and the traps that we own so it's a way of telling us which skins and traps be owned by inserting string values with the same names so we can just loop through and get the names of all of the string values in that's in that equipped so in that skinned in retreat wraps inventory II they will be string values they won't be the actual skins and trap models themselves but they will be a reference because I'll have the same names so local Val or string value doesn't matter because instance new string value foul name we're going to set the name with a string value to be V because V is going to be the name of each skin because it's not gonna be V dot name it's just gonna be V because it's a string it's not an object because when we save the data we saved V dot name not the object itself not be the object but V dot name so he saved a string to the datastore cause remember I said earlier you cannot save an object through datastore you have to save H string to a datastore so a valid name equals V we're just giving it the name of the other skin that was the week that was saved one of the skins that were saved because we're doing if every skin is gonna loop through it's gonna create a new string value for every single skin there's not data's or skins table and then we're gonna parent it to the skin inventory so Valdo parent equals skin inventory then all we need to do is just copy this for loop and same thing again if data dot wraps then and we're going to loop through theta dot wraps and insert a new string value name it the name of the trap but we're going to parent it to the trap infantry okay so there we go we've just loaded all of the data in but because we only want to now what I did earlier was in the client shop after five seconds I call the add skins and our traps I only want to do this when your data has loaded so once your data has loaded and we know that it's loaded so what I'm gonna do is I'm going to create a rotor I'm gonna create a remote event in the replicated storage and remote events I'm going to call it send data so what we can do is I'm got replicated storage got send data curl on fire clients I'm going to fire it for the player who just joined the game I'm going to send their data as well so the data we got from the data store I'm going to send to the client okay and then when the data gets picked up sorry when that Verizon gets picked up down here I'm gonna get rid of the white 5 I'm gonna change it to dick game tool replicate his storage dot send data but on client event Connect function and we don't need to play our argument because it's on the client I'm going to put the ad skins and our traps function inside this event so the traps and the skins are only going to be loaded into our GUI once once they once the date has been loaded so once the data about our equipped values and our skins that we own has been loaded only then will I create all the frames in the skins and traps frames and show them only once the date has been loaded and we know the date has been loaded because after all of this equipped trap setting and adding all the skins to the skin inventory in the trap inventory only then do I fire the Sun data remote events so that will only fire once the data's loaded and it only picks up once the data's loaded so moment of truth let's see if this will work first things you need to do is rightclick and click on publish to roblox ass if you haven't already make sure you publish it as a roblox game ok I'm gonna try again publish to roblox ass doesn't want to work for some reason yeah there we go every started studio and now it seems to work so I'm going to publish it or update a already published game just make sure it's published to roblox and then click on game settings go to options this is very very important make sure that enable studio access to API services is turned on okay turn that on enable studio access to API services on click Save and then you'll be able to test your game and your data stores in roblox studio ok now I recommend that you test it in a proper game ok I recommend you do that and that is what I'm going to do and if it takes ages to load the server don't worry it's probably because roblox is under a lot of load it did take me a while to open this server up but if I go and purchase a few things let's purchase the ghost and the shaggy mane and the invisi trap let's equip the invisi trap and equip this shaggy man let's leave the server and rejoin okay moment of truth and I'm just gonna say this as well data stores it is likely you might have problems with it and it's one of the hardest things to debug ok so it looks like our data hasn't loaded here so I'm going to check the developer console just to see if anything's gone wrong and just to make sure let's do game thoughts players thought Alvin under school blocks thought equipped trap value let's print that out just to see if anything was saved okay so it says the equipped one was the invisi trap so what I think's happened yes ok I know what's happened so it has loaded the data but it's just not it's not updating the the cost text or the button image so because look when we click on the button sorry when we click on let's go back when I click on the shaggy man it instantly equips it and this turns to owned so it knows that we already own it it's just that we haven't coded it on the client so when the when we first insert these frames it doesn't automatically update to say the it doesn't load the equipped or owned values in the GUI it load it updates the values but it doesn't update the GUI so let's have a look at that now so I've got a very very simple fix for this if we go back into the main GUI into the shop and client shop what we can do in the ad skins and the other trap is we will say if game dot players got a local player so the player which this script is running on so for the current player local player dot trap inventory cannot find first child or Jesus for the skinning of inventory as well very soon find first child the V dot name then so if if it's in your if the skin that we're looping through was already the trap that were looping through is in your trap inventory so you you own it then we can set the frames cost of text to be owned and the frames button image to be the green tick straight away and so they're having to wait for us to click the button so because this is running when the data is sent when the data is loaded we can check to see if you have that trap in your trap inventory and if you do then we will change it to say owned Anna green tick and we'll do another if statement to see if you have it equipped so if game got players that local player does equipped trap dot value equals equals V dot name because we don't name is the name of the trap so if you have this trap equipped we can say frame dot cost of text equals equipped and frame but button dot image equals green tick just like that so it's going to instantly say whether you own it or whether you have it equipped now I'm going to copy these two if statements we're gonna go oh my bad I've done the trap one in add skins so I need to change it to skin inventory and equipped skin let's take these copy them let's go to the add traps one and paste them into our traps but change skin inventory to trap inventory and equipped skin to equipped trap okay so what it's going to do is it's going to instantly check to see if you own the trap or the skin or whether it's equipped and if it is it will automatically update the frame just say to say whether it is owned or equipped now I'm going to publish the game again and go check it out so what should happen is it should instantly show me my loaded owned and equipped skins and Trump's so let's go to the store and there we go straight off the bat it says oK you've got the shaggy man equips because that is what we did equip in the last time we were in the game about two minutes ago and also it says that we own the ghost and also that the invisi trap is equipped and the yellow trap is also owned so if I go and buy everything and buy buy buy I'm going to equip the ghost and equip the red trap now I'm going to leave the game and go back in now if you're testing new studio sometimes it might not save your data and I think that's because the game is closing down before it's managed to save in time because it's in roblox to do this shouldn't happen in a real game and it shouldn't affect you because I've tested it quite a lot and it hasn't caused me any problems but anyway you can see that the ghost is equipped and the red trap is also equipped and everything else is owned and if I wanted to I could change the equipt values and it's everything else is becoming unequipped but the yellow trap is now equipped and now universi traffic equipped and the other trap is now owned so it seems to be working really really well ok so now I'm going to show you how to make the skins and the traps appear in the GUI here in these gray squares and we're gonna be using viewport frames viewport frames allow you to render roblox objects in a GUI so in this case we want to render the piggy skin and the traps so to render them they need to be cloned into the viewport frame and then we also need to have a camera which will be looking directly out those objects so in roblox we can have an objects called a camera and we can tie that camera we can set the viewport frames current camera property to that camera objects and then it will be looking we can set the see frame like the position of that camera to be looking at our cloned piggy characters so I'm gonna show you how you can you can do that now so we're gonna go into the client shop script I'm going to go up to the create frame function so right now we've only just we've only copied our template in there we haven't done anything to do with the viewport frames so what we're going to need to do is we're going to need to take the objects argument which is the actual object of the skin or Liam trap we're gonna have to clone it out and put it inside our viewport frame because the only things that put into the viewport frame can be rendered on the screen so we can say local vpf obj so if you put frame objects you can call it whatever you like this is just the name I made up equals objects current clone then we can say vpf or parent equals frame doctor viewport frame so we're putting it inside that viewport frightened there so now that we've put our objects in the viewport frame we need to create our camera which will be looking at it because the camera is the thing that's going to render everything in the viewport frame on the screen so it's a local cam it was instance got new camera cam parent I'm gonna put this inside the viewport frame as well equus frame dot viewport frame now we've done that we can say if item type Oh in fact yeah sorry I was just reading off my script I forgot to so what we gonna do we're gonna create a fifth argument and this is gonna be called item type so that we can tell the function whether we're gonna insert a skin or a trap so in the add skins function on line 54 that's where my line is it might not be on your line 54 but where we're calling create frame in the add skins function we're going to add that v argument and we're just gonna add a string we're going to call it skin just like we do down here in the by item so we can tell the function that we're going to be adding a skin and you'll see why is because we need to make the camera a look at a certain object look at a certain part so for the skin we'll just make it we'll make the camera look at the the skin head right that the head objects inside the piggy character but a trap obviously won't have a part called head so we will just need to well because the of the object for the trap will just be a part we can make it look at that part the reason I'm doing that is because if you don't make it look at the head for the piggy then we wouldn't be able to see it it will probably just look at its torso and we won't get a view of its head so if we position the camera to be looking at the head of the piggy character we'll be able to see his face whereas it doesn't matter for the trap because we can just make it look at that one part because the trap is only made up of one part so well this is going to tell us whether it's a skin or a trap so if we go down to the out traps function we're going to have that faith argument in there as well but the argument is gonna be called trap the both they're both going to be strings as well so trap and skin and once you've done that we can then say if item type is equal remember doll equals because it's an if statement is equal to a skin then we can set the camera C frame to the to the character's head whereas else if the item type double equals is a trap then we can just set the camera C frame to the object because it's just going to be a part because if you think about it if you're going to replicate the storage got traps and then look these are just obvious just parts right and they're just done by their mesh parts but they still a part there's one object isn't it so to set the camera C frame to be the character's head I also have a video coming out on see frames very soon so if you find it a little bit hard to understand check that video out it's gonna be in the advanced series but anybody can watch it you don't need any prior experience for that one so what what we'll do we'll set the C frame C frame is basically position with rotation so in this case we're going to position the camera to be just a little bit far out from the place character so we can actually see them but we're going to be pointing it towards the player's head so it's going to be rotated towards their head so a little example here if we've got imagine this is the character really badly drawn but imagine this is the character we're gonna put our camera around about here about five studs away from the character and if I will put it around here because it'll be up in the air a little bit and it's going to be looking at their head so it's gonna be angled down this way so if that's the camera and that's the Piggy character it's going to be looking at their head because normally if we didn't do this it would just be looking at their torso so we're gonna do it like this and to do that we're gonna say cam dot C frame equals C frame new and this C frame is going to be object because it's a character we know that the object is their character model so we can say object dot head position so the position of their head with we're gonna add on to that we're going to add on in the direction that's their character is facing so currently if you think about that diagram again if we've currently got their head position so the cameras around about here where the arrow head is we need to get the forwardfacing direction and we need to multiply it by a certain number to bring it out to around about here so we want to bring the camera out to around about here currently the cameras here we want the camera to be about five or ten studs away from the character and then we can point it towards a character so we can actually get their head in the view okay because all of this stuff won't be seen because it's out of the characters out the cameras view so we can say inside of here we're doing another pair of brackets and inside of it we'll say object dot head dot C frame so then we'll say look vector so look vector is a property of C frame but it's actually a position value this probably might be making sense but if it doesn't as I said don't worry I have a C frame video coming out multiply that by five and then what we can do is we can add some height to it so about two studs of height okay so I'm adding two studs of heights because I want it to be the camera just to be a little bit higher than the players head so we can look down on their head and that just gives a better experience and it fits more into the into the camera frame and then so this this part of the code this first part it's just positioning the camera so what we've done is we've positioned the camera well we firstly got the position of the players head which is around about here right if you imagine this is the players character and this is the you know this is the position of their head we're then getting the look vector the look vector is the forwardfacing direction so the forward direction and that's so that's a nicer vector so we're multiplying it by five so we can move that thing you don't get my words out and so we're moving this five studs forward this is moving the camera five studs forward so the camera was here and it's now probably about here we're then moving it to studs in the air so now the camera is here and the next thing we're going to do after this comma is we're going to tell the scripts where we wanted to be facing because we the camera could be facing this way could be facing that way could be facing that way so how do we tell it we want it to look at the head which is here well that's what we'll do so to do that we can just write objects got head got position because it would then just point the camera towards the the character's head so that is going to set this camera C frame to the character's head now what about if it's a trap well it's a little bit easy if it's a trap all we need to do is say cam got C frame obviously equals C frame new objects drop position because the trap is just going to be a part now if your trap is a model is made up of loads of parts you will need to say objects and then the parts name so for example if yours was in a group like this you'd have to say object bear underscore trap dot position in fact you wouldn't you'd have to have you'd have to have a part in that model which is named the same throughout all models so we have multiple models you would just say an object dot handle and handle would be the the main part right which is used by this viewport frame which it which is where the camera is looking at so object dot handle sorry notice it so yeah that's if you're using a model right so you'd say objects that handled opposition all right so instead of saying object opposition you'd say object dot handle but if you are just if you're like me and you're not you've only got one part traps I'm using a mesh part by the way which is why I can make them look good and just use one part because there are mesh using a mesh ID so I'm just going to rename this to be bear underscore trap so yeah if you're just like me and they're not in models they're just single parts I'm going to say object dot position because object is the part itself because it will be passed to the function and we're going to add on object dot C frame got to look vector so that's the forward facing component multiply it by five so we can be so it's the is five studs away from the object so that the camera actually is able to see it fully and then we will say plus vector three dot new zero to zero so it's just a little bit higher up in the air so that we can still we can get a nice view on it then we'll do a comma and then because the second argument in a C frame is the what is going to look at we just needed to look at the trap itself so object opposition so the camera will be facing the object okay so now that we've set the camera C frame we just need to set the if you put frame its current camera property to be that camera so frame dot viewport frame dot current camera equals yeah okay so now as soon as that current camera is set to our camera it will start rendering the objects in our people frame so let's go ahead and test it out hope this works really hope it does it would be amazing if it worked first time so we're gonna go to store oh yeah we need to make that button work don't we but there we go you can see we've got shaggy man Piggy and the ghost so all of our skins are loaded in and all of our traps are loaded in as well you can see the Envisat wrap is kind of hard to see but I can see it on my screen is because it's nearly invisible hence the name invisi trap but there we go we can now see our objects in there very very nicely some people probably will ask how do you make them spin good question it would take a little bit more coding I'm not going to go into it today but you can probably look up how to do that it involves having a loop which would repeatedly set the C frame of the object to be moving around or you could loop setting the C frame of the camera to loop around it but that is not necessary and I think this looks fine as it is it just requires less work so that is how you get the characters in a viewport frame like that so very very nice I am pleased with that right next I'm going to show you how you can add the piggy tokens to the bottom of the screen so we can see how much money we've got so I am going to insert into the main GUI I'm going to add a text label on that text label I'm going to call it tokens and I will set the position of this text label to one zero one zero and that will put it at the bottom right corner of the screen but you can't really see it that is because it's positioning it from the middle so if we set it to be positioned from the top right sorry the bottom right by setting the anchor point to be 1 1 it is now in the bottom right corner of the screen I'm going to set the background transparency to be 1 and I'm going to set these text scale would have to be true I can change the font if I like I'm going to change it to Gotham bold and I'm also going to change the size I'm going to change it from offset to scale so that it scales with the size of the screen so I'm going to set it to not 0.15 so it takes up well it takes up yeah that that's it's kind of like a fraction so naught point 1 5 would be 15 percent of the screen on the xaxis and then it's going to take up a tenth of the screen on the yaxis that didn't work some reason no point 1 5 comma 0 naught point 1 comma 0 there we go that's better then I'm going to change the text and to whatever really it's going to be updated anyway and I'm going to change the text color 3 to a nice pinky color let's see let's see what we've got okay I know I've got a saved color so we'll use 255 comma 1 1 6 comma 1 3 4 perfect that's a nice color so now that we've done that we can start coding it so if we go into the client main script I mean if you could do it in any script really but I'm going to do it in this one because that's where I've done the rest of the coding for this sort of stuff so I'm going to create two variables the first one is going to be the the text label so local tokens label equals the script dot parent which is a Gy color on wait for child tokens ok the next thing I'm going to create a variable for is going to be the actual tokens value which is in my player so local tokens whose game dot players but local player wait for child tokens okay so they've got the same name but they're in different they're in different places and they're different things because this one is the value with our tokens in the player object whereas this is the text label in our main GUI so now that we've got those two what we can do is we can create some simple events which will whenever the value gets changed we can update the text of the text label so very very simple we're just going to say I will do it mmm we'll do it here are these data stuff we'll say firstly because the game will load and the and because beer oh because the game will load and this script sorry what awesome so what I'm trying to say is we're going to set up a changed event a get property change signal to change the text when the value changes but it might not we want to set the value sorry the text of the text label to its current value before we set up that event because it might be changed before the event is running so we can say tokens label dot text equals tokens dot value and then we can say tokens gets property changed signal a value so when the value property changes we can say you can connect it to a function and that function is going to fire and inside of that function we can say the same thing again tokens label dot text equals tokens dot value so if we load the game it should immediately change the text to zero so we shouldn't see you one three three seven there we go so after two seconds obviously because we have to do the twosecond wait for the script to load up but it has loaded up with seven hundred and thirty eight poins so that's obviously been taken from a data store that got saved last time so if I go in to the server because you can only change your values like your tokens value on the server house it won't take effect let's change it to one one zero obviously you won't be able to see the amount of tokens on the server because its client based there we go it says 110 so I leave the game I'm also going to change the tokens text from one three three seven just to nothing so that it doesn't give a fake amount of coins that you don't actually have okay it didn't seem to load for some reason but it's well it loaded the old value but it didn't save the one from the previous game I think that's because the play solo shut down before it managed to save it in time so yeah we'll see about that but we have got the tokens working now which is which is good okay next we need to code the buttons don't we the buttons in the menu here so that it loads the store and also this close button here so we'll begin with the close button because that won't take very long to do at all so we can go to the client main script and at the bottom here I'm going to create an event for the close button so we can say scripts dot parents come on wait for child shop and then we can say dot wait for child close doctor mouse button one click connect function and then inside of here very very simply we can just say well firstly we need to see if you're in the menu because you could close the shop when you're in the menu or you could close the shop when you're out of the menu so depending on that if you are in the menu and you close it we want to show you the menu screen again but if you aren't in the menu we just want to close the GUI so we already know if you're in the menu or not because you've got like in menu value in your player so we can say if game dot player's dot local player curl on find first child in menu then we know you are in the menu so because of that we will say intro dr. serve 1 equals true we'll make that intro frame visible and then also because this will apply for whether you're in the menu or not we will close the shop so script doctor parent wait before child shop dot visible it was false so we're going to hide that shop so we have just scripted the close button let's go and test it out in fact we can test it out until we've made the shop store button in the menu work so we will say intro because in the intro he can see we've got a person called store so intro dot store dot mouse button oneclick colon connect function and then we will say when you click that store button we want to firstly hide as well we want to enable the shop so script dot parents come on wait for child shop thought visible it was true and we're gonna hide the intro because if you're in the intro we want to hide it so intros look visible equals false right let's go and try it now so we play the game and if we click on store you can see it opens up the camera stays there because we're still in the menu it still got that in menu value so we can browse the store and when we're finished we're back in the menu and then we can get out of the menu in menu has gone away and we can open the shop normally if we want to click the button to close it you can see it doesn't open the menu again so very very good we have now managed to make the menu in the shop work let's just do one more test we'll set it to one one one close the game and click play again yes we I don't think it's managed to save the values in time because the play solo has quit before it's managed to save I've never experienced that in a running game before but ok I'm going to show you a way to fix that problem where it doesn't save your data if you leave the play solo because there's a chance it could happen in a real server as well if you're the last player in the game because we're the last player in the game to play solo the server can shut down before the script has finished saving your data so to fix this we can use an event called bind to close so game bind to close then we're just going to put a function in there no connect or anything just like this so any code inside of here will ruin when the server is about to shut down so when the last player has left the server will not trip down unless this code is finished executing so we can loop through all of the players that are left in the game like this and if we just set the V to player and we copy this code inside the player removing and we put it inside of here and we just indent it like this there we go it will make sure your data gets saved before the server shuts down so I'll show you this I'll show you once more my data will appear my amount of tokens will be very very large because I just tested that if we go in and we set my tokens to be 11 for example and I leave the game and I go back in you can see it successfully saved it friendly is successfully saved this time we go back in I have got as if by magic an 11 tokens so that is the data store problem fixed one last bug I'd like to address which I have found after testing the game after I put the series out it's not a big book or a big game breaking book at all it's just that sometimes it can bug out because if you reset when a game isn't happening and the map isn't loaded then it will it will get through this if statement and it will try to drop your tools using games at workspace dock map and I'll see there won't be a game that works based on map because the map won't have been loaded yet so to fix this we can say if in this humanoid root part a statement we can say if player cannot find first child contestant so if they're in the game currently and they've got the contestant tag they wouldn't have it if a game wasn't in progress and game dot workspace cannot find first child map then just put this these two lines in there to drop the tools and we can put an end in there so this is just an example of how you know books can pop up after you've made something and they won't pop up for a while because that eventualities one happen so in this case the eventualities was that no player reset themselves when a game wasn't happening and that took a while to find out it's not something that people usually do but when they do do it if they do do it it would break your script so that's how you fix a book there and that is a book that we have fixed so again it's not a huge book because they know the chances of somebody even resetting in the lobby are minimal it's not like somebody will do that anyway and I don't think it would break the whole script it just wouldn't it would cause a small error but it's there you go that's another book that we have squashed right then I think we do one last test and we'll be good to go so let's just insert yeah two players should do okay so i have equipped the shaggy mane and the invisi trap on this account so if you can see that the shaggy man has loaded in and if they press the truck button there you go there's the invisi trap it's loaded perfectly so everything just seems to be working and no complaints from me let's just place another trap let's get stuck in the trap there we go and ooh ah got one more thing it says killed by the piggie um now I'm not too worried about that to be honest because yeah I'm fine with that just if you're naming your your game something different so I don't know like bacon or whatever then you would want to go into your game logic scripts and your client script where it says player was killed by the piggy and changed that player was killed by the bacon etc but again please be original when you're quoting these piggy games please credit me in them because you know I've spent a lot of time working on this series so I think it's just right that you credit me in the video so in your game or you know in the description that you've used my kit so that others can know how you made it and can help grow my channel because I've said a lot effort into this series you know if biggest serious I've ever done it and I've done it in the smallest amount of time I've ever done before so thanks for watching the series as I said this will be the last one because you know it's got to end at some point got to end at some point you know for me to go on and make even more series and more videos I've got to stop making these ones because they take up way too much of my time but that is everything for part 7 please do like the video if you've enjoyed it please do subscribe if you're interested in more videos do check out my 23 part beginner series and my advanced series after that because it will help you become a roblox crypto so you can make your own games without me having to show you because I'll be awesome when you when you know how to make your own games it's awesome because you get an idea it comes in your head and you can just make it straight away so it's really really awesome and you can also make a lot of money from roblox a lot of money so if you're interested in that you interested in learning how to make your own roblox games then do go ahead and click the subscribe button share it with your friends or like the videos so I know you like them and it's been a blast thank you for watching this piggie series how to make a piggy game from scratch it really has been fun making this game and I'm glad you've had fun watching it as well do check my website if you have any problems or bugs to learn how to fix your books I've also got a video showing how to fix books if you come across them and not to give up and remember you can become a channel member if you want to take the full source code and get a load of other awesome perks which you can check out by clicking the join button on my channel so after all of that I would just like to say a final thank you to everybody who has watched the series and everybody else who has helped me test my channel members have spent an awful lot of time testing the game with me even before I launched the first video and I alter them so you know who you are thank you for that and also thank you to Linda in 2009 for developing a map as well much appreciated for that so thank you everybody for watching and I'll see you in the next tutorial Cheers
