okay we are live hi everyone welcome welcome to our live stream we are so excited to walk you through this new code academy case study analyze Taylor Swift lyrics with python it's me hi I'm Corey Stieg a proud Swifty and code Academy's content marketing manager I'm joined by Michelle McSweeney code Academy's data science domain manager who created this case study and Eva savinga a code academy curriculum developer in data science who will be answering all of your questions in the chat so Michelle is going to walk us through step by step how to use Python and Jupiter notebooks to analyze the lyrics to every Taylor Swift song including the new album midnights that just came out now if you're a Taylor Swift fan you know all too well that she intentionally leaves Clues and Easter eggs in her lyrics which is why we're focusing on Taylor Swift's music today she also made history this week becoming the first ever artist to claim all top 10 spots of the Billboard Hot 100 charts probably thanks to the 1 billion times that I personally have streamed midnights in the past couple of weeks but it's pretty iconic and if you're not a hardcore Swifty that's totally fine this is a data science project that you can do with any of your favorite musical artists as a reminder you can practice this case study on your own whenever you want it's free on codecademy and all you need is a free account to try it you can find the link for the case study in the YouTube description below and this live stream will be available to replay so if you get stuck or need hints we got you let me tell you more about Michelle Michelle McSweeney is a linguist data scientist and educator she is the data science domain manager at codecademy and teaches data analysis and visualization at the CUNY Graduate Center she has a PHD in linguistics and is the author of a book about the word okay coming out this January with Bloomsbury and another book on the word data releasing in 2024 with Oxford University press she has been teaching text analysis for over 10 years and has written extensively on how we communicate trust and intimacy on textbased platforms before we jump in Michelle where do you recommend people start learning if they're totally new to data science totally if you are like I'm just getting into data science we've curated the foundations for it in our data science foundations and it gives you a really great overview of everything that you need to know in order to start breaking into the world of data science perfect well I'm gonna pass it over to you and and take it away awesome thank you so much I am going to start by sharing my screen um so we are going to look at the Taylor Swift song lyrics today but as quite mentioned um you can really do this with absolutely anything and not just song lyrics so I've done this with peace treaties I've done this with books um it's really anything that you can get into a text based format you can do the same exact process on so we're going to start off um in our new Jupiter notebooks workspace so you may have seen this locally before but this might be the first time that you're seeing it on codecademy something really cool about this workspace is if you click on this Jupiter button up here it'll take you back to the file tree what we're looking at in the file tree is all of the csvs and all of the files that have Taylor Swift's lyrics in them I am going to work from the solutions notebook because you do not want to see my typos as I like write this code um on the Fly so the data set has all of the albums in it we did some data cleaning the code for the data cleaning is behind here in the file tree first thing that we got to do is load all of these packages Pro tip when you're working in a Jupiter notebook and you want to see your plots you add this little like magic code up here so we're going to be using pandas we're going to be using the natural language toolkit and some other plotting and string manipulation techniques let me talk a little bit about the natural language toolkit so this is a whole bunch of this is a library that has a whole bunch of functions that allow you to analyze text more efficiently and more easily a lot of things come out of the box so if you're just getting started you want to start with nltk right so the first thing we're going to do is we're going to load this data set and as Corey mentioned we've added the midnights data set oh wait oh duh okay so how did I know that I didn't run the first one this told me that the name PD is not defined I thought that I had already defined it up here so didn't expect to teach you how to debug these error messages but uh Jupiter notebooks are really helpful so now that my program knows what the pan does is it's loading in these data this data frame and we're going to look at the very beginning of it we're going to inspect this a little bit we see we have album name track title track number and then the lyrics um and then we have what line that is within the song I'm going to get a little bit of information about it just to like inspect what's going on here and this is my first task I have numbers on the track and numbers on the line but everything else is this object data type I know that it's a string um just because like I know what's in this data set but I noticed that I don't really have the gear in this so I'm going to add the gear into this data frame which I consider to be essential information okay so first thing I'm going to do is get a list of all the albums that are here and I notice immediately I'm like oh my goodness midnight is in here in two different formats thank you Taylor Swift for launching it you know a little bit earlier so for most of these I'm going to Define this function that says if the if the album name is Taylor Swift I know it was released in 2006 right I'm going to get a little bit more creative down here um I know that folklore was released in 2020 but we're going to give it 2021 because it makes our visualizations a little bit cleaner if you were creating this for your portfolio in the future um you would probably clean this up just a little bit and handle this in a slightly different way um which you can learn more about in our pyth in our pandas course on codecademy um same thing here I've used a little bit of trickery here so I know that I have midnights written two ways so I say if the word midnights appears in album name at all return 2022. I've also given myself a little bit of a helper here that if it's not in there just return no date and we'll worry about it later okay so I'm going to apply this function and I'm applying I'm saying album year I'm applying the function I just wrote to every row of the album release um the um the album release function to every row of my data frame sorry um and then I'll inspect this here make sure it looks like what I expect and I have album year there okay so I've added my Essential data next thing I'm going to do is clean my lyric text so this is kind of the first thing that you always do when you're working with any kind of text based data is to you make sure that everything is lowercased because Taylor Swift is obviously so good about like putting clues in how she capitalizes things and how she writes things because some of her albums are written all lower case and we can read something into that um so here computers are not quite as smart as humans so you know ever more written lowercase is different from Evermore in uppercase but we don't want to treat it that way we want to make sure that everything is lowercase together you could also make it everything uppercase but I read that as being yelling you might also so um the other thing that I'm going to do here is I'm going to replace punctuation um I don't want to be analyzing this data with commas and with um periods or things like that I don't know how this how the lyrics were input into the file but I'm going to assume that those are not going to help me in my analysis last thing I want to do is I'm going to remove stop words now you don't always remove stop words but it's a good practice to get into if you're going to try to figure out topics or things like that that said I personally go both ways depending on the goals of the project but for us this time because we're first trying to understand like how often she uses words and we're trying to understand like what her most common words are the a this that those aren't that useful to me so we call them stop words we're going to take them out okay so I'm going to apply this kind of complicated function that I'm going to break down in just a second but what I've done is I've made a clean lyric column that everything was lowercased all of the like extraneous punctuation has been replaced with just nothing that's what this says and I've made a list of stop words that I've removed as well right so what I get is this cleaned lyrics note that I've kept the original lyrics in case I ever want to go back but I have these clean lyrics that are all lowercase you know the word u is the same at the beginning of the sentence as the middle of the sentence right okay these are just for illustration to show you how we split up the words um see what applying this join function does remove the and then I'm removing those columns so I'm actually going to skip that completely there's lots of builtin stop words if you get really deep into text analysis you can learn so much more about those I encourage you to check out our NLP content if you want to get um go a little bit deeper okay so now we're going to actually start asking questions right I've done the preliminary cleaning of my data set now I'm going to ask some questions my first question is how many times does the word Midnight appear right so it looks like across her entire discography it appears 20 times that is way less than I expected I was expecting midnight to appear way more often let's explore that a little bit more okay so maybe I'm like okay maybe she hasn't been hinting to me about midnight exactly but maybe she's been talking about night or maybe she has a really strong focus on day or maybe she has a like really strong Focus just on time words in general I've kept the time words intentionally short here because I expect that you would add some more words to that maybe you know Taylor Swift's music way better than I do and you're like oh I shouldn't just talk about today tomorrow yesterday maybe I should add the word future and see how often she tracks the word future you could do that a couple of different ways you could add to the time list here or you could say I want to make a whole new list about the word future and then use this code to make a new future column and you can pretty easily see from that how you would go about applying this to other artists right so if you had the lyrics of other artists and you were like I'm not actually interested in time at all maybe you're analyzing David Bowie which I have definitely done and you're like I want to analyze dance like how often does he talk about dancing right you can use this exact same technique okay so I'm going to run this I've made a list here of my knight words I've made a list of my day words my time words and here I'm creating a regular expression string for each list of words um the reason that we're doing that is so that we can go through and search for them within our cleaned lyrics and I'm going to create a new column to say um how many does it appear in the cleaned lyrics so I make a new column of saying yes it appears no it doesn't appear this is probably the most important step in text analysis because generally what we're doing here is we're turning unstructured words into numeric outputs this time it's just true and false but whenever you're transforming this like unstructured text into something quantitative you've hit this level of abstraction that is really the underpinning of all text analysis so this is a really cool step right because we're saying if it contains it give it a true or false and then I'm adding up here how many instances of night are true how many instances of day are true and how many instances of time are true we could with a little bit more code count the number of times that night or day appeared in each lyric I did that preliminarily to see if it would like make any sort of difference I found literally zero instances when the word Knight appeared or a night word appeared two times in one given lyric so rather than exposing all of that code um we've just said is it going to be true or false this is another totally valid data science technique is you know you're not necessarily solving every problem but you're solving the problem that you're presented with right so the problem that I'm presented with is counting how many times day and night up here a different problem would be counting how many times day or night appear in every lyric we found out it was one so we can use a simple true and false which gives us some like programmatic shortcuts okay one of those programmatic shortcuts is creating this count right so I'm going to make a night count which is just the sum of the Night lyrics column right so I have this column I have true and false true and false for if the word if a knight word appears in the lyric and then I can just add up the number of times that a night word appears the number of truths I do the same for days do the same for counts and I'm going to print them here okay so it looks like Knight appears 287 times day appears 387 and time only appears 35. we're not going to worry about time too much more that was really just for illustration but it seems like she hasn't actually been focusing on night throughout her discography she hasn't been telling us that she's going to be talking about night but our next question might be yeah that's true for entire discography but what about the past few years I mean she's been producing albums since 2006. that's a long time so let's let's inspect this a little bit further okay so we are going to um visualize how Taylor Swift's mentions have changed over time has she been talking about night more has she been talking about night less right so I'm going to create a new data frame for yearly mentions the group submissions by Year let me break that down because it's super confusing okay so I'm using the group by function which breaks it down I could have used album album name or album year I'm choosing to use year because it gives me some benefits later on okay so I'm grouping by every year and for every year I want to add up the number of mentions of Knight the number of mentions of day the number of mentions of time we're not going to care about time but so that's what the sum is saying it's saying take every numeric column every numeric variable and add it up and give me that group by output that's going to return a whole new data frame right so if you think of a data frame as a table with rows and columns or rows and columns that's going to give me a whole new data frame to work with and I'm going to say on that data frame reset the index just because it makes our data frame a little bit clearer okay let's take a look at what we get out so here is our new data frame so for this album here I see how many tracks it added up the number of tracks that means nothing it computers are not very smart that's not the right kind of variable completely ignore the track column completely ignore the line column but pay attention to the midnight day and night and time columns right so here I see that oh the word midnight is so much more popular in her Midnight's album this should not be surprising um but interestingly Knight is a night words are actually not more prominent there than in her 2012 album right so let's visualize that because it's actually really hard to understand all of this data just looking at a table okay so I want to plot the yearly mentions of night or just like any kind of night word and what I see here is that her most recent album is off the charts more but compared to previous but not that much more than her 2012 album that's interesting so my Swifty um code catamite cocadamites my fellows with Taylor Swift fans told me that it is rumored that Taylor Swift plans everything about three years out and we see a really interesting result here then if we view it in that context we see that starting in 2014 she's been saving those mentions of night you have to wonder if she started planning this album you know around this time period and it has just been holding on to all of her music and all of her lyrics that are going to reference night that would kind of make sense looking at this chart and looking at her progression okay so the next thing that we are going to do is we want to know what albums are the most night focused what albums are the most day focused um and really understand like how that has changed over time not just focusing on magnets okay so the first thing that I'm going to do is you know I showed you that function before mostly because there's some instructional content in here about like creating functions and things like that but there's an album year name file in the file tree because it's a little bit easier to just join it rather than like going back and forth so I'm going to reinstate the album name into that new yearly mentions data frame that we made right so I'm going to read in the CSV file that has all the albums and the years together and I'm going to call it your name and then I'm going to make a new column here for the album name this should go above here I will fix that in the solution later today okay um so I have my yearly mentions data frame I'm giving it a new column called album name and I'm using the year name and giving it album name and then I'm going to sort both of my data frames by year oh that's why I did that never mind I'm going to sort my yearly mentions data frame by year and I'm going to sort my year name data frame by year just to make the join a little bit more logical okay and now I have my yearly mentions data frame that has the album name in it and I'm going to sort by the night values to see which has the highest night value and it turns out its reputation right it's not even midnight it's reputation what why what was going on all of my Taylor Swift fans I'm sure that you know why I don't know her discography that deeply so like what's going on tell us in the chat um or in the comments there right okay so we can do this with a whole lot more things you can probably already see the like possibilities here you might want to increase the words in my nights list or in my days list cool though um okay so we know what her most night focused album was what's her most day focused album let's find out we're going to do the same thing we're going to take our yearly mentions data frame we're going to sort it by values we're going to say hey started by the day column and we're going to make it descending right so her most day focused album is red um where it's you know quite a bit more than any of her others and you can inspect This and like make some assumptions what I find really interesting about this is that if we sorted by time as well then it's also her most time focused album and it's not it's not not night focused um and this was 2008 right so this was almost 15 years ago she is talking about time talking about the past talking about the future talking about like the passage of time what was going on in her life I don't know I hope that our like most Taylor Swift fans do know um but it's really interesting just to watch this moment and like what that can mean about her as an artist but also what it means about the like moment that she's speaking to right and the culture that she's reflecting so like I said doing this with all kinds of different artists can like Lead You In some really interesting directions to start asking these questions okay so that's great but really we want to know the relationship between day and night mentions so we're going to create another line chart with both the day and the night mentions and that's going to let us see this progression a little bit easier where so we have one we're using one plot so when you're working with matplotlib if you everything that comes above your Plot show ends up on one plot right so we're gonna plot yearly mentions and night yearly mentions on album mirror on the xaxis and day on the yaxis if we give it our labels then we can create a legend and we're going to give it a title all right let's take a look at this so interestingly this 2019 album right was way more day and if we think about the fact that we there is a rumor that I've heard down the Grapevine that she plans things three years out then three years out she's really talking about day which we could argue is the exact opposite of midnight and that gives us something really interesting to think about as we see this like big peak in night as well as Midnight's mentions so there might be something too this like three years out planning but I leave it to you guys to start to figure that out okay so now we're like okay maybe it's not just about years but maybe she's telling us like a bigger story just within the albums themselves right so like maybe there's a progression of day to night in the albums or like some sort of ebb and flow like that um based on the fact that like we know that she hides some Easter eggs so let's go and see if that hypothesis is going to pan out so here we have our lyrics position which we're going to do something kind of cool and kind of interesting we really included this to like get you thinking about how to like get these things out of different albums Taylor Swift might not be known for this progression but you know you might want to look at other artists in this way um so we're going to create a new column called position it's going to be the track number is going to be a whole number and we're going to add it to 1 1000th of the line number and this gives us a decimal value that is an ordered representation of each album that we can then line up across all of the albums right so we're going to do that same group Phi function again but this time rather than grouping by album year we're going to group by position within the album so like the first the first track the first lyric of every single album is going to be added together right so the number of night mentions for the first track the first lyric the second track the first lyric the third track the first lyrics so on and so forth okay um we'll do the same thing we'll add them up and then we'll reset our index I'm going to increase the size of this plot basically because it's just it gets way too squished if you don't increase the size of that plot it's not something that you always have to do it's just something to make it a little bit easier to read okay so I'm going to do the same thing I'm going to create a plot that has two um lines on it and the bottom is going to be the position because rather than talking about progression through a year we're talking about progression through an album and lining all of those up and then we'll compare night and day mentions okay so let's go ahead and run this and see what we get and we see no Trends whatsoever right okay so yes maybe we could have cut this out because like it really doesn't have any kind of an interesting Trend going on here um but it's also a really valid practice for everything that you do to check out directions that do turn into something and explore directions that don't and don't erase your work the benefit of working in something like a Jupiter notebook is that you're basically keeping lab notes and a failed experiment is just as valuable as a successful experiment and maybe I shouldn't use failure or success but this led us to a dead end let's back up okay so we've investigated day and night and that's interesting but we also want to do some sentiment analysis and just some more General text analysis of Taylor Swift's um lyrics the first question to ask of any artist or really any document that you're looking at is what are the most common words what are the most frequently used words what is the author or the artist really focusing on here this is the first step towards doing something called topic modeling which is an unsupervised approach to just cluster topics together the first part of that is getting just frequency of mentions so what is Taylor Swift talking about the way to figure that out is to line up all of or to like just figure out how many times she said individual words we're going to do this a kind of like shortcut way mostly because we know that when you're interacting with a learning environment and you're on different speeds of web browsers you don't want something that's super heavy so we wanted to use the lightest way possible to break up these words that is to split them on the space you can read here about like more sophisticated ways to do that but the lightest way to break up your words is just split them on the space it doesn't give you the most accurate result but it does get you a result quickly okay so let's take a look at what that looks like so if I've split all of my cleaned lyrics on the space then I come over here and I have a list of all of the words in each lyric right so this is just a list of all of the words for each one what this is called is a tokenized list so this process is called tokenizing um and it's absolutely an essential process for any time that you're working with text tokenizing your words is essential um read more hear about different ways to tokenize okay so now I want to know what are the most frequent words I have this pretty complicated list comprehension here that is basically just saying like for each word in the tokenized lyrics count them up add them up okay then I'm going to use this counter function um and add them all up and then I'm going to sort them by the frequency okay let's take a look at what this looks like and then we'll break it down a little bit so I have this word frequency variable that is the sorted list of key value pairs right so turn my dictionary into a list that my key value pairs my key is U so I have this word you and you occurred over three thousand times I occurred almost three thousand times if you look at this a little bit more closely you see me and my your there's some more down here um you're this type of your right tokenizing would reconcile more sophisticated tokens tokenizing would reconcile all of those so like you your your yours would all become the same word um but here just splitting it on those on the spaces shows us really clearly that Taylor Swift is talking about relationships she is talking about you and me she's talking about two people and how they're in relationship with each other and we can tell that just by the words that she's using okay cool now we're going to go down and we're going to look at sentiment so we're going to use a prebuilt lexicon um called the Vader lexicon which comes with nltk so nltk has out of the box a lot of techniques to make sentiment analysis and other types of analysis more efficient and a little bit easier to work with a lot of things in the mltk library have to be initiated like this so I create a variable that is this function and then I apply this variable to a to a piece of text right so sentiment intensity analyzer has a function polarity scores within it right so just like pandas has a read CSV the sentiment intensity analyzer has a polarity scores I pass it a string and it tells me how positive or negative it is okay so let's run this and see what we get all right I love Taylor Swift exclamation point so it has not at all negative it's a little bit neutral but it's very very positive the compound is the normalized average or the normalized sum of neutral and positive compound takes intensity into effect um and therefore it's not the linear sum but rather the normalized some of them okay so I'm going to apply this sentiment analyzer to the cleaned lyrics column note that I am not applying it to the tokenized lyrics column I'm applying it to the entire string column that I know to do that based on reading the documentation for this particular sentiment analyzer I went to the documentation and I said okay this one is taking in the entire string and it has its own tokenization process behind the scenes right so I don't need to worry about any of that so I'm going to apply polarity scores from the package to everything in this column okay and if you are curious about Lambda Expressions check out our pandas content which goes over Lambda expressions in a lot of detail okay so let's see what we got all right so I have this new column that is a dictionary so every everything in this column is a dictionary so it's a series of dictionaries where negative is zero neutral is one and positive is zero I'm like wait a minute wait a minute wait a minute neutral it's only neutral but yeah when we analyze there's something about the way that is just a neutral statement it's not positive it's not negative what comes after it might be positive or negative but it's not overtly positive or negative in and of itself same thing Street looks when it's just rained I'm showing you oh no come back um I'm showing you some of the downfalls of working with sentiment analysis because even though that might be very emotionally evocative right like we might associate some sort of feeling to how the street looks when it rains that might not necessarily be happy a sentiment analyzer is not going to be able to capture that especially in out of the box sentiment analyzer um so there we go much better um ah okay so if you ever get disconnected let me show you what to do so it my code gets saved but um where I was does not get saved so um when you are actually no oh it did it ran everything cool let's make sure that that worked if it doesn't work I'll show you the like tip to make things work um you can just go sell run all or sell run all above or below okay um down here we were talking about sentiment analysis okay um I'm going to run this run this run this run this nope cell run all right okay so when we're looking at sentiment analysis it's really like how a computer would view sentiment rather than how a person would okay so here we are we have our dictionary of sentiment analysis is a sentiment analyzes but that's not actually that easy to work with I'm going to need to transform that transforming a dictionary into a bunch of new columns is way easier than you might think um so in Excel this would be something like a pivot here we are applying polarity to the we're making a series out of the polarity column and pandas knows how to work with that and then we're going to drop the polarity column entirely and what we get is a well what we get is here um so now rather than having this all in a dictionary we have each one of these as their own um as their own column which is a lot easier to work with we are going to focus a lot on the compound when we do our analysis okay so here we're going to sum the positive sentiment we're going to sum the negative sentiment and we're going to sum the compound and what we find is that Taylor Swift is overall extremely positive um the compound is the average and it comes out to 485 you will note that this is just a simple sum this is not normalized for anything there's a few reasons for that if you normalize it by the number of lyrics it actually just tells you the overall positivity of each lyric rather than the overall positivity of her discography right so we're thinking of her discography as one entire unit that spans her entire career okay so let's break that up again using the group by function by albemir so the same thing that we were doing before we are going to look at her overall sentiment per year and we see that this 2020 album was so sad compared to the rest of her discography from 2019 to 2020 it really just like fell off and completely plummeted and one might assume that mendites was just as negative or just as sad as the rest of them as it turns out according to our sentiment analyzer it's not right um It's actually kind of on par with the rest of her discography that like it's not overwhelmingly sad and that's an interesting finding in and of itself because you know if we're thinking about sleepless nights we might assume it to be sadder than other things but it's not right finally we want to know is day more positive or is night more positive I'm going to do something kind of tricky here so hold on tight okay so I'm going to create a new data frame of just those lyrics that mention the word night okay um so what I do is I take this data frame and I say give me return back to me the data frame where night is true right so it's only those lyrics that have night I'm not worrying about anything else I'm just worrying about the lyrics that brenference Knight I'm going to do the same for the lyrics to reference day and I want to make sure that it is um the numbers that I expect so take a look there too okay and now I'm going to sum that compound column that weighted average and see what the overall night sentiment was and what the overall Day sentiment was so I'm going to take that data frame that's been filtered for night or day and I'm going to sum the compound column this will give me an overall sum of her discography but again it's not normalized we know going in that there's way more Dimensions than there are night mentions so it's going to be biased in that direction that makes sense in this case because I'm not trying to understand the overall like positivity of her of each lyric I'm trying to understand the overall positivity of the discography or the overall negativity of the discography not any individual lyric or individual song if you are like oh I actually want to know the like average positive or negative sentiment per this unit then you could divide by that unit but that's not what we're trying to do here the question that we're answering is about her entire discography and in the end what we find is that she is overall far more positive than negative even after this most recent album so um I kind of quit going through these but all of these steps are laid out um over here as well and what we can take away from this is no matter what Taylor Swift's entire discography it's it is a little bit more on the positive side I'm going to assume that's a little bit more hopeful a little bit later and that's it thank you thank you thank you so much Michelle that was fascinating for me as a Swifty personally and we hope that everyone watching this live stream had fun taking a deep dive into Taylor Swift's discography and that you're feeling inspired by all of the cruel creative ways you can apply data science to your own interests and life if you want to learn the technical skills that we use today on this project we have lots of beginner friendly data science courses and paths for you to explore the best place to start if you're brand new to coding is the skillpath data science foundations or our popular course learn python3 if you already know Python and you want to level up your skills you might want to try the path build a machine learning model with python or apply natural language processing with python and if you're considering having a career in data science you can take the career path data scientist natural language processing specialist where you'll learn how to build out the skills you need to land a job and you can find links for all of these courses that we mentioned today in the YouTube description below and if you want even more practice projects to try on your own sign up for a free code academy account today we recently released another free data science case study analyze NFL stats with python where you'll build a machine learning model that predicts the winner of NFL football games may be useful for your fantasy team who knows let us know if there's a topic you want to see covered with data science in the future be sure to check out all of codeacademy's free online courses and tutorials and please subscribe and follow codecademy on social media to stay in the loop about more interactive coding and data science content thank you thank you everybody