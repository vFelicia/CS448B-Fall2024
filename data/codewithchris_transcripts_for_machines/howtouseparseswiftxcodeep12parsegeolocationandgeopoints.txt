hey coders what's up it's Chris here and today we're going to talk about geop points in parse which allows you to store Geographic data with your objects in the parse back end and what's more it's really simple to do you create a PF geopo object and you initialize it with the latitude and longitude and then you assign that PF geop Point as the value of a key of your class parse also provides a handy method to get a geopoint from the current location of the person using the app and it does this in the background it's nothing special because under the hood it is just using the CL location manager and it's listening for updated location data from the GPS which is what we would do if we didn't use this parse geopoint for a current location and background method but having this handy method to grab the location is just convenience so once you have your data in the parse backend with this location data you can then in your query provide constraint to query based on location so take a look at this one so here they have a constraint on the query where some sort of key where your location data is is near geopoint and then you can use the current user's location say that you're searching for closest restaurants or something and you have a list of restaurants in your parse backend with that location data you can query all of you know the restaurant objects based on the location key or whatever your key name happens to be that has the location data near geop point and then you pass in the user's current location and then what gets returned is a list of restaurant objects that are closest to the user now you can limit it by distance as well so here you can see there are a couple more methods where key near geop point you know within miles within kilometers within radians uh and then you can limit the result set to maybe 10 results or something like that so that's some pretty handy stuff if you're working with location data in your app so let's try some of this out in our xcode project but first I want to show you what we have in our parse sample app so parse demo is the one we've been working with and if we go to contact that's our class which we created it's our custom class and it's got two rows of data Tommy and John these are two contacts and what I want to do is to add some location data for it I'm going to be creating a brand new contact and I'm going to be setting some geopoint data for a brand new column called location and because it detects that it's a new column it's just going to add it in here but Tommy and John won't have that data let's go back to our xcode project and this is just an empty xcode project with the parse libraries integrated already and if you missed that episode just go to episode one or two of the series to see how to integrate the parse Library into your xcode project but other than that it's a blank single View application with no code written in it inside yet other than this up here import parse so you're going to have to write that import parse statement to work with the libraries okay so in the viewed load what I'm going to do is create a new contact get its get the users current location and then when it does we're going to save it to the parse back end so create new contact is very straightforward I'm going to say let contact equals p F object class name is contact which mirrors this right here right so I'm going to set some key value pairs for it we have first name equals let's say Chris contact last name equals ching and let's set the email blah blah blah blah blah. comom and let's try to get the current location let's go back to the parse documentation and up here we write PF geo. geopoint for current location and background so because we're using the simulator we can simulate the current user location I'll show you how to do that PF geopoint do geopoint for current location background so there is a result block which we're going to double click to expand and it's going to pass a geopoint back either a nil or an actual location so let's put GE Point here error there and inside here we can check if let GE Point let's say if let location equals GE Point uh that means we know that it returned an actual location so we can say something like contact location is equal to location okay so let's set a breakpoint here if they successfully geocat the user else something's or couldn't get the location info and then you can print the error or something like that uh okay so let's run it and give it a whirl uh actually we forgot to do one thing we forgot to save the object back to the parse back end but let's see what happens okay so nothing's happening right now because uh the location hasn't been found but we go up to here we go up to debug we go up to location and then we can pick a location let's say apple let's pick a different one because it was at Apple let's say custom location and let's change that okay okay it's not working I have an idea I think I know what's wrong because normally when you run this on a device it's actually going to pop up a little dialogue asking you for permission so I think that in the simulator it doesn't do that so we actually have to give our app uh permission and it's basically location services okay so I figured out why it wasn't working if in the simulator you go up here to debug and you open up the system log you can kind of see what has been going on and if you look closely it says here that my parse demo app is depending on Legacy on demand authorization which is not supported for new apps so apparently the authorization for geoca the user has changed and what it should be doing is showing up a dialogue or something like that asking me for permission to geolocate the user now it might actually work on a device it may just be uh something that's not working on the simulator however even if this method doesn't work geop point for current location background you can always just do it the traditional way of getting the user's location using CL location manager which you can find in other tutorials but the point is is that once you get that geol location you can either convert it to a PF Geo point if you're using CL location manager or if you're using this method which we weren't able to get working in the simulator it already just gives you back a PFG point so in my xcode project what I'm going to do is since this isn't working for us right now I'm just going to erase this right here and just write something like to do get users current location and then what we would do is we would update it with the location uh I'm just going to create a PF Geo point right here for the sake of our demo and I'm going to pass in you know just some latitude and longitude and then we're going to call contact save in background okay I'm going to run the app just so we can have that contact saved into our parse backend here let me just refresh it and here we are we've got the new contact and if I scroll a little to the right we can see that there's now geopoint data for at least one contact right and if we were to perform a query comment this out if we were to perform query contacts based on location we would say let query equals PF query we're looking for contact and we would add a constraint where key near Geo point and then we would pass in the user's current location so the key is location because that's what it's named right here you would fill in whatever that column name was and then for the Geo point you would capture the user's current location and pass this in here and then it's going to fetch all of the contacts which have some sort of geopoint data and compare it with your current location and then return that to you so right now I don't have any so I'm just going to create a brand new geoint and pass it in there just going to put some numbers in here and then you would go and execute the query so find objects in background with block and that's how you add Geographic data to your PF objects and if any of you guys actually try this geopoint for current location and background on your device on your physical device and you get it working please let me know in the comment section below let everyone else know as well thanks for watching guys please give it a thumbs up and please share it with anyone whom you think could use the tutorial thanks for watching again and I'll see you guys tomorrow bye