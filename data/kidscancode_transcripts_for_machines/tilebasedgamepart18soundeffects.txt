welcome to part 18 of our tilebased pygame project in this episode we're going to be adding sound effects to the game so one change I want to make real quick before we do anything else is I've added this detect radius variable to our settings and what this is going to represent is how far the zombies can see so if the player is within 400 pixels of them they will chase him but if he's more than 400 pixels away they won't chase right now the zombies can you know head towards you from all the way across the map no matter how far away they are they're gonna be coming towards you I want to make it so that they they can't see forever so all we need to do is we have that value is go over here to our mob and you know here we're calculating how far away we are here so we're gonna make this a little more flexible and a little simplified by just adding a self dot target and that's just going to be the player okay so our mobs target is the player and then we're gonna just go down here and in our update instead of calculating the distance here in the rotation calculation we're going to do it separately so the target will just say dist for short the target distance is the target position minus our position right this same calculation we did just calling it target instead of player so rotation becomes just that okay but now we have this we can use that to tell if we're close enough so we want to say target distance is a vector so we need to know what the length is and so we could say length if the length of the vector is less than the detect radius then we'll do something right but the problem with that is the way we calculate the length of a vector is using the Pythagorean theorem right a squared plus B squared equals C squared so the length is the square root of the X component squared plus the Y component squared and it turns out that for computers calculating square roots is relatively slow I mean compared to compared to arithmetic and multiplication and division and things like that it's really slow so what a lot of vector libraries let you do including PI games is calculate the length squared I just want to know what x squared plus y squared is and leave it there and not take the square root which means we just have to compare it to the detect radius squared and this will be a much faster calculation and since we're doing it every frame for every zombie this will save a little bit of time it may not be significant but it's just as easy to type so what we want to do is say if that so if the distance is less than the rate the TEC radius then all of this stuff here all of the movement code will happen but otherwise it won't so if we check that out we should be able to go over here and see yeah I'll go by the big group see how those zombies are not chasing me right but if I get closer they're gonna start coming after me and if I get far enough away from them again they should stop chasing yep so later on we can go back and add some code to make the zombies wander around when they're not when they're not chasing us but we'll come back to that later this is good enough for now oops and there's one other quick thing we got to talk about there is a bug that started appearing when we just added that detect radius code that I thought be interesting to look real quickly at how to fix it it's a quick fix but it might be a weird one if you don't understand what's happening so let's run and see what this bug is so there I am there's a zombi who can't see me so he's not chasing me yet he's just sitting still so are all the other zombies on the map so if I shoot him boom he's now taken some damage and his health bar has gone down just a little bit right and that all seems fine but watch what happens when I start moving around all the zombies have green bars on them that aren't their health bars right if I start shooting them you know they have their own health bars but they have that green bar on them why is that happening well if we look at how we did our mob when we spawned the mob we set its image equal to the games image when the mob gets hit we draw the health bar on it so we draw the health bar on its image but it's image is the game's image which every mob is using so now the game's image has a green bar on it now when every mob starts moving we rotate the game's mob image which already has that green bar on it and make it its own so so that green bar is getting written to the original image which should be clean and not have anything on it so to fix this very simple all we need to do is make sure that when we spawn the mob we use a copy of the game image and that way we won't be going and drawing this mobs green bar on every mobs image and now you can see this will work much better that mob doesn't affect the other mobs whether they're moving or not all right bug fixed all right let's talk about sounds so I have added over here in the settings file a list of a bunch of different sounds for us to use so I've got some background music that is going to give us some atmosphere and make things sound a little better and then we've got some sound effects for a lot of different things so the player hit sounds are gonna be the sounds that the player makes when a zombie hits them like kind of grunts of pain the zombie moan sounds are pretty obvious these are all a list of various sounds that zombies can make just stuck all in a list because we can randomize them I've got a sound I found that I liked for the zombie getting hit this is when it killed a zombie it just caught it goes splat we've got a sound for the firing of the gun and let me see I made this a list even though there's only one thing in it because eventually we're probably going to want to add a couple more in here and make some variety but I haven't found haven't really found the perfect gun sound yet I'm still looking for one I really like or a set of them that I really like this will be good enough for now and then I have some various sound effects for different for different things happening like picking up the health pack and I found a really cool sound you'll hear when we play it to play at the beginning of the level when the level first starts so these are all the sounds we've got so far for all the stuff that we have going on in the game so we just need to load those things in our in our game now so if we go over to our load data section we have a couple other folders that we're going to need to load so I'm going to make a duplicate of this here and we're gonna load the all the sounds are in the snd folder I just abbreviated it like I did for image and then all of the music is going to be in a music folder okay so we load those up so or we define those as we can load our or our thing so let's start with the music since that's gonna be super simple then the music let's go to the end of the file or sorry the end of the function here and we're gonna add all the sound sound loading stuff first thing we're gonna do is load the sound sub PG mixer music load that's how we load the music we want to use you tell it that we're gonna use the music folder and we're loading the BG music variable so that loads the sound we're sorry that loads the music now we're gonna just play it when we start the game so I'm going to put it right here and def run before we start the game loop PG mixer music play and we're gonna put loops equals negative one cuz we need one because we just want it to loop around and repeat let's see how that sounds you see got a little very cinematic sounding creepy sneaking around kind of music alright let's start adding some sound effects so I'm gonna do these in kind of order from the simplest to the most complicated none of them are gonna be that hard but let's talk start with the effects sounds so we're gonna have sounds for all sorts of different effects we're going to make this a dictionary so that we can name them and have a name map to a sound so we're gonna just go through that effects sounds list that we made or started dictionary that we made in here alright we're gonna look at each one of these I'm going to make one for a little start one of our health up let's call this effects sounds because that's what it is so so the effect sounds for that type is going to be equal to PG that mixer dot sound in the sound folder effects sounds whatever type so that's going to load so at the end of this we'll have a dictionary of effects sounds it has both of those sounds in it and then we can play them you know we want into play so I want the new level start thing to play here right when it get when def new happens when we start a new level so we want to play the level start sound stop play when that starts and then the other sound effect that we want to play is when we pick up the health pack so that's here where is it right here so if we hit a health item then we're going to add health to the player and we're gonna play the effect sounds of the level or sorry level start of the health pack which we called health up okay so let's try those out there's the little level start and then let's go pick up the health pack I need to take a couple of hits and then there we go just a little sound little chime for that alright now we're ready to move on to the next one all right so next let's start on the weapons sounds now we're gonna start building up a list of a dictionary of different weapon sounds we only have one weapon in the game at the moment but we're definitely planning on adding some more so weapon sounds gun is just going to be a list of the sounds that we're gonna play when you shoot the gun alright remember we only have one in that list at the moment but we'll get there so so if we go through that list that we put in settings I get that one right there then we're going to just append it to it so what them sounds gun dot append and then we're just gonna do PG mixer that sound again you can copy and paste that with whatever the sound that we're loading is alright oops forgot a parenthesis there okay so now we've got the sounds loaded and we can play the gun sound when we shoot now when we shoot is over in the class player right we have here that when you press the space you're going to shoot so we want to play the sound too so let's just stick that in there so we want to make a random choice out of that list alright because it's a list so the game weapon sounds gun dot play all right let's go here that is our gun sound not super great I'm not super thrilled with it but it's good enough for now we'll keep looking and see if we find some better weapon sounds good feel free to post your suggestions in the comments below as well we find it good pistol sounds I did find a good shotgun sound but we haven't made a shotgun yet alright now let's see we've got the we've got the weapon sounds let's add the zombie sounds now so now we have see we have sort of a pattern going on here we're gonna have these zombie bone sounds OOP sounds and that's going to be another list of sounds that we can that we can use so we're just going to take all the ones we listed and go through them and we're just going to append them to the list so and and we can just append that same thing here and now we have a list of all the zombie moan sounds now when do we want to play those well we want to play those occasionally right we don't want to play them all the time we don't wanna play them too often we don't want to play them too rarely we want it sort of random and each zombie can occasionally make a sound so we'll go over to that to our mob here and I'm only gonna how the zombies make sounds if they're chasing after the player right there they're hungry they're coming up to the player we're gonna have it make sounds then so what we need to do is we need to pick a random number so the random picks a random number between zero and one right and if that is a very small number because remember that we're doing this every frame for every mob so if we make this happen too frequently we're gonna have a constant bunch of sounds just all playing at once so we want it to be really rare so this is what I played around with and we can see if that's too often or too rare and adjust it so now we want to make a random choice out of that list it's a random choice from that list and play it alright so here we go now they're not going to make this down unless they're chasing me so let's go get a bunch of them to chase me so you can see is it too often is it too rare I'm not really sure yet it's gonna depend really on where we go with the game with how big a crowd how big the crowds of zombies are gonna get how much we want them making noise but it doesn't leave give them a little bit of personality especially when they occasionally say brains okay oh but something you else you might have noticed let me run this again is that the zombie sounds are pretty loud all right they're kind of overpowering that is so we probably want to adjust the sound and this is something that happens a lot when you start bringing in sound effects different sounds were created at different volume levels and they might not be the volume level you want for your particular application relative to the other sounds right we could obviously lower the volume of the whole game but I don't want the zombie sounds to be so overpowering I want them to be quieter and so when we load the sound we can adjust the sounds volume in our program so so what we want to do is before we put the sound into the list okay we're gonna just gonna give it a temporary variable called s just so we can load the sound and set the volume and the set volume command lets you put anywhere between 0 and 1 so 1 is the volume that it's at right now so you can reduce it as much as you want all the way down to 0 right and I'm actually going to drop it quite a bit they're pretty loud sounds actually and you'll see that this will work a little bit better and then we append it into the list once it's been once it's been decreased in volume alright let's go over there and get zombies to chase us now alright see it's a little better to have it more often if they're not as loud and overpowering so maybe point maybe point two you know you can play around with what you think is a good volume and as we get more and more sounds in we'll probably adjust that more and make it a little more or a little easier to change but this will be good enough for now okay okay I'm just gonna skip to the end here and I went ahead and paste it in just doing the same thing with the player hit sounds and the zombie hit sounds alright same process loading them up and now we want to play the player hit sounds when a mob hits a player which we have down here mobs hit player and so I'm going to play a random sound out of that list but I'm only doing it a random yeah I'm only doing it sometimes not every time and that's just because when there's a whole bunch of mobs around you all hitting you if every single one of them makes a sound that'll be too much so there's where we play the hit sounds and then for the zombies we go down here to their update when their health is less than zero and we delete them we're also going to play the zombie hit sound okay so let's see how those work out so I'll let this zombie hit me all right so I make some grunting noises and then I'll go ahead and kill this guy and you can see we get a splat sound when he goes away which is gonna be good for us when we add a nice little effect for the zombie dying all right so that'll do it for the sounds hopefully enjoyed this it feels a lot nicer to play now you've got now it's not purely silent will obviously be adjusting that as we go as we add more features and as we adjust how things behave will definitely be changing the shooting sound will be adding some some may be adjusting the volume down some of them to get the balance just right but I feel pretty good about it so far so hopefully you enjoyed this down below I will link to where you can download all the sounds I used feel free to go ahead and find your own use your own sounds and I will see you in the next video thanks for watching you