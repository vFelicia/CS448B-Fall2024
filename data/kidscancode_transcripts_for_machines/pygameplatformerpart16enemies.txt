welcome back to game development with pygame this is part 16 of the platformer game and in this video we will be adding enemies so we're gonna make the game a little more challenging now by adding a mob sprite that we'll have to avoid so I'm gonna copy some of this stuff from the powerup sprite to save a little time we're gonna make a class mob and this is going to go into the alt sprites and the mobs group we've got our game reference and then we are going to start setting up how we want the mob to behave now first of all what we want the sprite or the mob to look like there's a bunch of different or a few different mob types in the sprite sheet if we go over and look at it you know there's a the little red guy with the spike on his head there's a little springy guy there's a flying guy and there's the little propeller guy and so I thought I would take the propeller guy and we're gonna use him and what we're gonna want to do is I want him to win he flies across the screen did not just go in a boring straight line but kind of look like he's bouncing a little bit so he's kind of hovering you know hovering effect so we're gonna switch between these two different sprites where his feet are going in the opposite direction so this is when he's flying upwards and this is when he's dropping downwards okay and then so we'll just alternate between those as he bounces across the screen and if you look at your XML file you can find him here it's the fly man and we're gonna want the fly and the jump frames so what we're going to do is we're going to call that we're going to load those two different images and actually I already copied and all those numbers to save a little time there we go we're gonna use the image up and the image down so the image for winning is moving up and the image for Lang is moving down and we'll set our image to start with just to image up doesn't really matter we'll get our rect and then we need to figure out where to spawn him now I want the mobs to sometimes spawn on the left and come across this way and sometimes fall on the right and come across this way so so they should start off the screen on one of the sides so we're just going to pick a random location between minus 100 which would be off the screen to the left and with oops width plus 100 which would be off the screen to the right then we're going to pick a random speed so that sometimes they'll be moving fast and sometimes slow and that's just going to be between 1 and 4 now that's a positive number so that means it'll move to the right and that's fine if we started out off to the left but if our if our sprite spawned off the screen to the right then I just want those to be negative so that the velocity will move it to the right then we can pick where we want it to spawn in the ydirection and that's just going to be I want it to be somewhere in the top half of the screen so top half not down in the bottom half okay and then our self dot V Y is going to be zero and what we want to do is we want our V Y so the the VX will be constant so it'll move across the screen at a constant speed but the V Y is going to alternate between moving upwards and moving downwards and then moving upwards and then moving downwards but I don't want it to be very jerky I want it to be smooth so what we want to use is some acceleration where we speed up to the top and slow down and then speed down towards the bottom and slow down so we make a nice curve so I'm gonna make a set a variable called dy for that and that's going to be one half okay so our update well our x speed is constant so we can just move in the xdirection but now we need to do the ydirection so we're going to take our V Y and we're gonna add the dy to it alright so in the first frame our V Y is zero so we wouldn't move at all if we were if it was just ero but we're gonna add point five to its then we'll move it point five next frame we'll be moving our V Y we'll get another point five added to it will be one then it'll be one point five etc so we're gonna keep making our V Y bigger which would accelerate us upward but at a certain point we want that to stop and turn around so so what we're gonna do is say if the V Y gets to be greater than three or less than 3 then I want my dy just to reverse so x equals negative one okay so that way we'll have that nice smooth curve now so now we figured out how to move now we need to figure out which image to use do we do we use the up one or the down one well first first we're gonna track where our center is because these two sprites if you notice are slightly different sizes just a few pixels but enough that it would be could introduce a little bit of jerkiness so we're going to track where the center of our sprite is and if our D Y is less than zero then we're moving upwards so we're gonna use the or use the up image otherwise we'll use the down image we get our new rect from that based on that image we set our Center equal to the old center or the same center so it stays the same and then we can finally move our Y by whatever IV Y is and now we'll have our nice smooth movement and then the last thing we need to do is if it's moved all the way off the screen come all the way across we need to kill it so if the left is greater than width plus 100 or the right is less than negative 100 so if it's moved all the way off the screen then we'll delete okay so that'll be our class mob now we just need to make it start spawning so we'll go over to our main and we need to do a couple of things we need to we need to make a mobs group and then we need to decide how often are we gonna spawn mobs so what I'm gonna do is I'm gonna add a setting in here for mob frequency and I'm gonna put 5,000 that's milliseconds so five seconds as kind of the baseline that's gonna be the average time between each mob spawning and we'll use some randomness to vary it but that will be how frequently they spawn so now in our game loop in our updates section we can decide whether we want to spawn them up or not so spawn a mob question mark so we need to figure out what time it is now oh right and then I also forgot we're gonna need our mob timer and that's just gonna be keeping track of when the last time we spawned one so we know whether it's time to spawn one again all right so we get what time it is now get ticks and if now mob timer is greater than 5,000 now if I just did that it would they would spawn every 5,000 milliseconds exactly every 5 seconds exactly but we're gonna vary that a little bit now I could do something like this right if I let's say I wanted to be between 4 and 6 seconds I could do that right pick a random number between here and then sometimes it would be as low as 4,000 sometimes it would be as high as 6,000 but the problem is there's there's way too many increments in here this is 2,000 integers all the way across this range sometimes it'll be 837 sometimes it'll be 834 and what difference does it make if it's 2 milliseconds different instead what we can do is just do some discrete values just to vary it some and I'm gonna put minus 1000 minus 500 0 500 and a thousand so that way we have either either four seconds four and a half seconds five seconds five and a half seconds or six seconds and if that happens then we will spawn a mob so we'll set the mob timer to now and we will spawn a mob oops and the mob it wants a plat that's not right I think I left something when I copied and pasted I did don't want that in there okay so let's see how this looks so far there's a mob okay he's going across oh there's another one so we should see they're all going to the right at the moment we should see one going in the other direction sooner or later there's one yeah so you can see we've got the animation is working it looks like it's bouncing up and down we've got different speeds and now this might seem a little too frequent to you like there's a lot of mobs to navigate between but remember once we start moving they're gonna be dropping off the bottom of the screen as we go past them which reminds me of something we do have to take into account you guys see that he's not it looks like he's chasing us because we are not when we scroll the screen we are not scrolling the screen or we're not moving the mobs along with the camera so they are not moving the way the rest of things on the screen are so here on the when we reach the top quarter of the screen I'm just going to do the same thing I'm doing with the platforms with the mops so I'm gonna say for Bob in Bob's mom's we just want to move them downwards that should let us zoom right past them there we go today we can sort of leave him behind as we get past him there's no collisions happening yet so that doesn't really matter but I think that's a pretty good start for how we want our mob to behave and we can do the collisions although there is one other thing there we go see how the mob goes behind the sprite sometimes and sometimes in front of it well that has to do with that draw order problem again you remember we went down to our in order to fix that with our player we went down here to our draw section and we are bleeding the player after drawing all the sprites so that we make sure it's always on top and that's fine if you just have one one thing you want to draw but now we've got the mobs it could start to get messy we're going to blit all our different sprites separately so pygame has a good solution for that and the solution is if we go over here when we make our sprite our all sprites group we're gonna use a different type of group called layered updates and this sprite group type allows you to specify what order you want things drawn in by giving each sprite a layer value a number for what layer it is the lower layers will get drawn first so we just need to assign a layer to each of the sprites and they will all get drawn in the right order so we'll go over here and we'll do that here okay so we're gonna set the player layer and I'm gonna make that I'm gonna set the platform layer to one we can set the pal layer and that can be one as well they're right on top of the platforms and the mob layer and we'll put the mobs on the same layer as the player since they're gonna run into each other we're not gonna see them overlap anyway okay so now we have these layers designed then in our sprites we can tell our sprites what layer we want them to be on and there's two different ways you can do that you can do that when you when you add them to the group which remember we're not doing that anymore we got rid of the all sprites dot add you can put the parameter in there and say layer equals two or whatever but since we're spawning the play the sprites with all their properties in the sprite definition it makes sense to put that in here so we just need to say we need to give it a another property call and we need to do it again we need to do it before the sprite in it and it needs to be called underscore layer okay and so this is going to be the player layer on the player and on the platform we're gonna set the underscore layer to platform platform list platform layer and we're gonna set the cows to tell where and we're gonna set the mobs to a mob layer okay so let's take a look and then oh and then down here in our draw we don't need this line anymore we don't need to blitt this i duplicated it instead of deleting it okay so we're just gonna draw all sprites and the all sprites group will now take care of all the layers so let's take a look at how that looks okay so see the you can see the mob in front of the platforms the player is still the player is still always in front of the platforms and the player and the and the mobs could be either cuz they're on the same layer but that's okay because we're gonna do collisions in a second but you can see when you've got a lot of different Speights sprites on the screen they layered the layered drawing is a lot easier to do with that layered updates sprite group alright and already we're getting kind of long so we're gonna do a quick collision here we're just going to say we're just going to use our usual PI game sprite that's right collide function between the player and the mobs and it doesn't really matter whether we put true or false because if we hit the mob playing equals false game over all right so let's just make sure we see how that works and then we can in this video okay there we go now there is gonna be one thing you'll notice a nice a string of boosts there okay so let's see if this little not quite I'm trying to get a collision to happen close by just so you guys can see there we go you see that collision so because we're using the rectangles you might remember from our shmoop game that it can really be bad if the player thinks that they dodged something but they died anyway just because the rectangles overlap so that doesn't look good at all and so in the next video we'll improve the collisions by using something called pixel perfect collision but as always please like and subscribe if you enjoy these videos and help other people find them and if you have any questions or comments please post them in the discussion area below and I will see you all in the next video you