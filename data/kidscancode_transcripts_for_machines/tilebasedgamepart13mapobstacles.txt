welcome back this is game development with tie game this is part 13 of our topdown tile based shooter and in this video we'll be adding obstacles to our tiled map so the next thing we want to add to our map is we want to add some obstacles or we want to define the obstacles that are the things we don't want the player to be able to walk through like this wall here for example or maybe the table or the couch I want to define those and make those walls to do that we're going to use a different kind of layer so you notice we these are all tile layers that we made to draw the different layers of our map and when we're on the tile layers these buttons over here are active and these ones are not well I'm going to create now an object layer so I click on new layer new object layer and I'm going to name this obstacles okay now when I'm on the when I'm on the object layer these buttons become active and what these let you do is draw objects onto your map so let's pick the rectangle here and let's just go out here and draw a rectangle so I just drew a rectangle just randomly drew a rectangle and that's going to be an object if I click again and let me draw another one but I don't want to do that so I'm gonna undo and then I'm going to go over here and I'm gonna click on the Select objects tool and that's gonna be the most useful and that lets you grab an object move it around change its size and so on right like if I wanted to occupy one square I could just make the obstacle of that size and if you notice in the View menu you can set it to snap to grid which will only allow your obstacles or your objects to be one full grid square so 64 by 64 or what I have on is snap to fine grid which lets me resize it to fractions of the tile size and that's an a setting that you can set but right now it's set to do it in quarters which is just fine for now so we could make an object like this for every square that we want to be an obstacle but that's going to be kind of inefficient it's gonna make a lot of them so what we could do is we could just make it like that right I could just resize it to fill this this wall it'll still be a rectangle so in our PI game collisions we'll still be able to do rectangle collisions I've just saved myself a little bit of time by making it one rectangle instead of a bunch of squares so now over here you can see the properties of our object it tells you the X and the y of where the object is located so you can see as I move this around right that it changes and if it were all the way up in the corner all right the x and y would be 0 0 and you can also see how wide and how tall it is so those are going to be useful to define the rectangle in our code but we also have these name and type fields and these are basically things you can use for any any data you want because we're gonna be able to read whatever is in these fields when we read this into our program so I'm gonna click on name here and I'm going to call this a wall so now you see the name appears above it that's why I'm using name instead of type if I put something if I left name empty and I put wall and type it's just as useful but I can't see the label here and it's kind of nice to know what the object is because I'm gonna have this wall object and I'm gonna copy and paste it and I'm gonna put one over here and what this one is gonna be it's just a little square that I'm going to name player and I'm gonna use this for my player spawn point this is where I want my player to appear is right here centered on this little square of the sidewalk so I have a wall object now and I have a player object now so make sure you save your map so we have this new layer added in and then we'll go over to our code and read these layers in and create the objects where they need to be okay so we're already reading in the TMX file the child map that we saved so reading that in and we're now gonna have access to that object layer so all we need to do is down here just like we were doing previously where we were going through our old textile map and looking for ones and M's and peas and we just want to look through the object layer of our tile map and look for those named objects the ones named wall and the ones named player so we're going to do and I'm going to leave this this commented out here in case you ever want to go back to it you can so we're going to do another loop here and we're going to go through we'll call it tile object in the TMX data objects so the TMX data that we loaded has a list called objects that's going to hold all the objects that we defined in our object layer and we're going to loop through each one and we're gonna find out what the properties are and the properties are a dictionary okay and what I mean by that is if we look back at the map real quick we're gonna get each object we're gonna get a dictionary and for the dictionary key X it's going to have this value the key width is going to have this value and so on so we'll be able to look for name we're gonna look for X Y width and height for the objects that we want to create but now before we do that we need to create walls right and our wall object that we defined earlier our wall sprite doesn't have a width and a height it's just the 64 by 64 square that we made well I could change this but again I'm gonna leave this and I'm just gonna duplicate it in case you want to ever use that sprite again I'm gonna leave it there for now okay we're not gonna use it we're gonna create I'm just gonna call this an obstacle okay and an obstacle sprite when we create it is not even gonna be visible I'm not gonna put it in the all sprites group and it's not going to be drawn it's not going to have it's not going to have an image right it's just going to be an object that we can collide with that's invisibly gonna sit on top of the wall so when we create it we're gonna pass an X a Y a width and a height and we're just going to make a rectangle using that X doesn't want to stay in there there we go the Y the width and the height and the rest can stay the same except we need to get rid of don't need to x tile size because it's going to give us the pixel x and y so this will be the sprite that we're gonna create it's just a sprite that has a rectangle so it can do the collisions all right so we're just going to spawn one of these obstacle sprites if the object has a property name equals wall and if it has a property name equals player well will spawn the player go back over here to main so all we have to do is look at those values so if tile object dot name equals player did I capitalize that I didn't capitalize it so if the tile a bit name is player then we're going to spawn the player right itself and then the X will be the tile object dot X and the y will be the tile object dot Y and I can remove that and now if we run it we're gonna spawn our player but we need to make sure we go over here and again we don't multiply by tile size anymore because we're gonna spawn the player at that location okay so there's my player spawning in the spot I want him to and then we can just do the same thing if the tile object name is wall then what we want to do is we want to add a player I mean I'm sorry an obstacle we want to add an obstacle and then each of these properties is just going to be a tile object dot the name of the property so tile tile object dot X dot Y I'll continue this on the next line since it's kind of long I'll get dot with anti object dot hi okay and that's going to spawn an obstacle where the wall was so let's run now okay so now as you can see I can't go through that wall so now on your map you just need to go through and anywhere you want there to be a wall you're gonna create another one of these objects named wall the quickest way to do that is just going to be to copy and paste and just make another one size like that now what's also nice is if i zoom back in we could make this let's say we wanted to make this bush an obstacle to so I could come out here and resize it like that but that's going to make the player clip against this corner here right and so what we can do is we can actually make an obstacle that's just that big for the bush and then the player look like he gets close to the bush but doesn't can't go through it okay let's take a look so now I can get up close to that bush but I can't go through it okay and now these other wall sections are solid but I can go through the door so we can go ahead and do that we can go through and add walls wherever there need to be walls and then we can also take and just like we did with the player we can define a spot here for a zombie to spawn all we need to do is just name this zombie and anywhere we find a zombie object will spawn a zombie there okay so skipping ahead this is what the map is gonna look like once you have filled in all the obstacles everywhere you want there to be a wall or something where the player can't walk but here's the thing when we run this you know we can try it out and it'll work the walls are all blocking and the table and everything like that but I need to be able to see sometimes when you're troubleshooting you need to be able to see what you're actually colliding with instead of these invisible objects and so what we're gonna do here is in the new section we're going to add a flag and remember a flag is a variable that can be true or false we're gonna call this draw debug okay and it's going to start out being false normally we don't want it on but in our events I'm gonna add a key here and so we're going to use the H key for this we're not using that for anything else let's use H so if I press the H key then draw a debug equals not draw a debug right so if it's true change it to false if it's false change it to true that way I can toggle back and forth and now in my draw section I can just add here when I go through all the sprites which is going to be the player and the zombies if draw debug is on then I'm going to draw a rectangle so draw a rectangle on the screen I'm going to use cyan and we're just going to use a self dot camera apply because we have to apply the offset to the sprites hit rect all right because I want to see the hit rectangle of the sprite and then I also need to say if draw debug is on then for all the walls I need to do the same thing right I need to look at each of the walls so let's duplicate this line and I'm going to shift that down to there and what we're gonna do is we're all the we're gonna say apply oops I just noticed this should be apply rect apply rect to the wall defect okay and oh let's just make these I just want these to be thin rectangles not filled in so I'm going to put comma one there for the width and now if we run this by hitting H I can see the outlines of all these things right I can just turn that on and off just so that as we move forward and are making sure thing work we can see where things are actually colliding and all that's left now is to just add one other check here that if we find an object called zombie in the map we're gonna spawn a mob I like that X dot Y and our mobs right here again get rid of the x tile size and that way we should now be spawning everything we need to spawn there's some zombies right there still colliding with the walls just like they're supposed to still not very smart oops and I just realized when we fire the bullet it's trying to draw the hit rectangle of the bullet the bullets don't have a hit rectangle we didn't add that to the bullet when we spawned them so let's just do that here and the hit rect of the bullet is just gonna be the same as the rectangle of the bullet right that way we can go over here and hit H and now when we're shooting we can see our bull it's hard to see the little rectangle around the bullet anyway but better than getting an error message all right that will do it for this video as always please like and subscribe and if you have drawn your own map with the Kenny game art tiles here I'd really like to see it please share it in the comments below so everybody can see what you've come up with I'm sure you guys can do even better than my little simple map here that isn't even finished and has all this empty space still waiting to get filled in alright and I will see you guys in the next video you