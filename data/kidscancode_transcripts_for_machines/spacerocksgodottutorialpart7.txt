okay welcome back this is part 7 of space rocks the video engine game tutorial where we make a slow asteroid style game in this part we're going to work on the players shield so that we can have something happen when the asteroids hit them plus a few other tweaks and improvements buddy let's get started okay so it's time to start making these asteroids do something when they run into the ship so we can go to the player here the player is an area 2d so in the signals it has an a body enter signal and we're going to connect that to our script and so that's going to tell it to body that enters and right now we're talking about the asteroids but you know other bodies might be on the screen at some point so we're going to say if bodies get groups have asteroids so if it's in the asteroids group let's just test this out by printing the body dot get name just to make sure things are working now what we should be able to do is go fly on top of this asteroid and see its name print right so we're detecting a collision and we just need to decide what to do well probably we want that to explode and we want the player to take some damage or play your shield to take some damage so we're going to have some variable period for the shield level right and that can start out at some value and then I'm also going to have whether the shield is up or not like when they it's a shield it's completely not done to the other shields going to go down and now the play is going to be vulnerable so the shield level is that and then we're going to take away some damage when the asteroid hits it but it's not really very visible because we're going to need to display that shield we're also going to want to set how much damage the individual asteroids do based on their size so one thing we can do over here and asteroid week or sorry in name right we have the things like the pattern that didn't break up into right we're also going to have you know the individual asteroid sizes give you different amount of points when you shoot them give you a different amount of damage when they hit you and all those things are like settings that you want to be able to make that globally affect the whole game and so what I'm going to do then to make a new script just to hold all those type of things there's going to make a new script it can be a good inherit from node that's fine make put this in scripts and this is going to be global Gd and so what we can do is if we go into the project settings auto load and we choose that script and say add okay so it will be named global and it is a singleton which means it's going to be one one instance of this script I go script object will exist in every scene so everything will be able to access the things that are in it and we don't even need the ready function at the moment but we what we're going to do is just put some variables in here so the global game settings things like let us not a comment for our game over night weather when we gain dependent or not we're going to have a score we're going to have a level alright every time you clear the screen we're going to have maybe some other stuff we'll get to later and on the player we're going to have things like the next shield level and we know how fat how far up that can go and I'm also going to have a regeneration right this is going to be every pick how many and shield you get back so your shield does regenerate if you can avoid getting hit and then there are some also some asteroid settings and asteroid that's where we're going to want things like this if we grab this I'm going to put that into global and then we're also going to duplicate that we're going to have a damage how much damage the asteroids do okay I skipped over the formatting but now I have an asteroid damage and asteroid points and this is going to be how much those values are which we can obviously just later welcome stuff in there but now on our main we have a problem right because we removed that break pattern now we just need to put global in front of it and everything should work just fine don't shoot it there we go okay and now we can use those in our player so our shield level is going to be equal to whatever shield max was and you can see the auto auto correct and inside the autocomplete to use the global so it knows what variables we've declared in there so now we can go down here and do something with the asteroids when we hit them so what we're going to do is we're going to say if pick the shield is up then we're going to say body dot explode we already have that function on the asteroids window when they bullet hit them so when the body does explode the players velocity as the impacting body and then we're just going to say shield level during a subtract global dot extra damage body dot size so you know what's I doing and if the shield isn't up we're going to set game over to false but that won't do anything yet now again we're not going to see any of this stuff happen so let's just print out sea level to make sure it is subtracting exactly so I should be able to go running to this and is going off the screen when I want to hit them all right so you're not careful you're going to hit multiple ones because they're going to come flying out off of the ship when you hit them especially the big ones are going to be super dangerous to hit okay there's a four speed yeah okay so that's working so now let's just get rid of that print and we want to talk about displaying our shield on the screen using some kind of progress bar yeah that will get shorter as we the shield and so what we're going to do is I'm going to go so I'm going to make this as a new scene then they can move scene and this is going to use this is going to use down here at the bottom to show you where it is a canvas layer and Candice layer lets you make a layer that'll be drawn in a certain order so for example the the main scene it's going to be on the layer zero so anything that's drawn on the canvas layer would be on top of it and the perfect way to do your headsup display so that's what we're going to call this is the HUD and so this is going to contain all of our information like the she'll of the score messages we want to give the player anything like that so in here let's put a couple of things we're going to put a label that's going to hold the score and for the shield bar under control there are all sorts of great GUI related node like the one that we're going to use is right down here textured progress and that lets you make a progress bar using a texture who's going to be the shield by okay now we need to configure this we need some textures to put in it you can see it has a progress texture that will be the texture that it will show some fraction of between zero and a hundred percent and then under and over let you put something underneath and over top of it to give it some more visual appeal but we want to start out with what graphic we want to use all right well our old friend Kenny has also made a great GUI pack looks like this that has all the bits to make all these great little progress bars and and dialog boxes and everything and this is all the pieces that are in it I really like these little glass looking transparent panels I'm going to use those too and so I've put those all here in the GUI folder under art and all the pieces are in here and here is our nice green horizontal bar that's what we're going to use for the progress and then here let's say the minimum value is zero the maximum value is 100 and the current value is let's say we're at 75 and there you see how it changes the queer at 25% etc right and so that's how we'll that's how we'll do that when we just need to put it in the right place now I'm going to use that using the using the anchor properties of the control node now I'm not going to go too much into how these anchors work that'll have to be for another video but I'm just going to go down here and set the margins here left I'm going to set to 30 that's 30 pixels from the left top I'm going to set to 10 10 pixels down the right value is going to be 230 and the bottom value is going to be 48 left fine so that's where we want it it's up in the corner but not right up against the top okay and then while we're at it let's get the score going in the score I want it to be centered on the screen so you left and right anchors I'm going to make them relative to the center and skipping down to the margins I've just gone ahead and filled them in 200 pixels to the left and right of center and we value let's just put 0 in there I want that to be centered I want that to be Center aligned and I don't want to use the default ugly font so I have gone in here and we're going to say new dynamic font goes over here and we're for thought we're going to load and I am a fox folder where I've got a canny font I'm going to set the font size to about 48 and there we go now I have a nice score display up there at the center and that is good enough for now so in the main we just have to add an instance of that hug team and because it's a canvas layer it's going to be on top even though it's down here at the bottom of the list you can you you're welcome to put it you know up higher mo or doesn't matter because it uses that property now to our main script hearing process we can say HUD get node all right you can actually see them coming up right so shield bar you could just set value to be players field level right now the thing is let's just try that for the moment I'm going to do this a different way but get node player dot shield level right and that's going to work fine if we try this out if I go run into this guy now look at that that went down right but what I also want to do is I'd like to change the color of it we have some we have a red bar and we have a yellow bar so instead of doing this let's make this a little nicer I'm just going to add a function called show hood shield okay and then what this is going to do is a couple of things first we're going to get the shield level from the to the player get the node player shield level and then we're going to use that to decide what color we want to make it and so the default color will be green but if the shield level is less than 40 in color is going to be red and then if the shield level it's not red then the fissure levels lessons save 70 and the color is going to be yellow and if you look at the names of the textures they're all the same just with the color name inserted there so the texture that we need to use is just going to be in a load art GUI bar horizontal underscore something underscore mid 200 PNG and then we just say percent color that'll insert the right thing in there and then we can say hug get node shield bar set progress texture progress texture to that and I'm not get node to a bar set value to shield level okay that way we can see and now we should be able to see it game changing color as it gets shorter let me shoot this I get some smaller ones if we run into this see when we got down the bear wear yellow get some more hits here and we're into the red okay much better while we're at it we're also going to stay on the score we're just going to set the text to whatever global dot score is the leniently start changing the score we'll see it change alright let's finish up our shield functionality here in process here we're going to say if the shield is up alright then we're going to allow you to recharge so we want to add whatever that reach regeneration rate is but we don't want it to go above 100 so I'm going to set it equal to the minimum of either a shield level plus mobile shield regen times Delta that's how much we want to do each frame or 100 ways you will keep it a macron 100 and that's going to do the shield regeneration but if shield level is less than equal to 0 and the shield is up then we want to set shield up to false because we have now lost our shield to level 0 and we'll say get node shield hide this shield will disappear so let's try that okay see my shield bar regenerating okay like a whole bunch of hip it's going to go down below and you're going to have a problem let me get let's get some big ones back on here and we'll see if we can knock our shield out entirely there we go see now the shield has disappeared from around the player and game over would be is being set to zero but we haven't anything about that yet alright let's wrap this stuff with a couple other things we want to add some points when the asteroids get destroyed so here and explode we'll just say global dot score and we'll add the asteroid points for whatever size we are that's simple enough and then in the main I'm going to go here to the ready I'm going to get rid of this one that responding at the beginning and what we're going to say here is that if the asteroid container is empty we're going to add one to level global level plus equals one and we're just going to count for I in range level and spawn that name so every time we go up a level we'll just get one more asteroid and that should do it its global dot well I should be able to get some points over here by shooting asteroid all right nice we have our score and our shield working that's a good day's work okay as always thanks for watching I hope you're enjoying making this as much as I am you can always grab the source code for each part at the link below please hit like and leave your comments below if you have any questions or suggestions see you next time you