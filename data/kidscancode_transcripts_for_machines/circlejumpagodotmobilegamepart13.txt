welcome back to circle jump we're getting really close to completing this game this time I'm going to be adding a few small features that will really boost the fun level of the game the main one being a score multiplier that rewards you for quick reaction if you jump quickly before completing a full orbit you'll get more points especially if you can keep doing it alright let's get started the first thing we're gonna do is we're gonna make the music fade out when you lose instead of stopping instantly I had a suggestion from a couple of people that that was a bit jarring and that we should do something about that so we're gonna add a tween to this main scene here that we're gonna use to ramp the volume down when the game ends so if we go over here to our main script we're going to add a new function called fade music and what this is going to do is it's going to take the tween which let's name this music fade the music fade we're going to interpolate property the music node the volume DB is the property that we want to interpolate we're gonna start from zero which is the default value to minus 50 we're going to take one second and we're going to use I don't think it really matters all that much since we're gonna just hear it fade out but I'm just gonna do the default ease types we'll do ease in okay so we then are going to start it music fade start and then we're just going to wait for it to we're going to wait for music fade we're gonna make wait for the all completed signal and then just tell the music to stop so now at the end of the game instead of music dot stop we're just gonna say fade music now that would fade the music down to zero on the first play but then when we go to play again our sorry to negative 50 then we go to play again it's gonna be on negative 50 still so when we start a new game and we play the music we also need to reset the volume back to normal so we're gonna set volume DB to zero so let's give that a quick shot so we hit play there's our music and then when we lose it fades out play again and then there we go alright the other thing that we're gonna do which was suggested by game Endeavor who I'm gonna link to in the comments below you should definitely go watch his channel he does some really good go to toriel's as well he suggested that when you top your high score you should get some kind of notification so you get that dopamine hit of hey I got a new high score so we're gonna make a flag here to track whether you've gotten a new high score in the current in the current game this would be false and then when you whenever we start a new game we will set that to false and then if you break that record then down here when we set the score if score is greater than high score and we haven't hit a new high score then we're gonna show the message on the HUD and your show message new record so you'll see that come up and then we'll set a new high score to true so you don't get that notice every time you get another point right we only want them to show once when you surpass the old record now we can move on to the main focus of this episode which is to implement a bonus counter so I've added to the HUD already just a label up here which is going to hold it we're gonna use this to give you a bonus every time you jump if you jump before you've orbited the circle one full revolution and so if you can get a chain of those going your bonus will increase every time and you can score a lot more points and so I also added an animation for this so that whenever you get a bonus up it will pulse like that and so it's just scaling it up and then scaling it down and turning it red and then back to white so that we just get that little click whenever we get another bonus every time it goes up and we're gonna use that in the script when we update the bonus we'll change the text and then if we're going up we'll play the animation if you're dropping back down because you've lost the bonus it's not going to play the animation okay implementing this on the circle is gonna require a little bit of change we are we're already keeping track of the orbits but we're only doing it when we're unlimited mode so that we can count down and see when you run out instead we need to do this for every circle count how many rotations you've or how many orbits you've done but then if you're limited have them run out just like they're doing now so what we're gonna do is we're gonna take the in the limited mode so right now what we're doing is we have our num orbits which is company the limited mode has and then we have current orbits which is how many of you've done we're starting that out at zero and we're going to keep that so I'm going to set that to zero every time you get captured so we're here and we're just going to have it count up but that means that when we're in limited mode instead of setting the current orbits to you know say three and subtracting to count it down we're going to leave it at zero and add up so that means our text needs to be num orbits when we're in limited mode show how many there are and then in process when we're checking the orbits to count what we've made a complete revolution we need to do that all the time not just when we're in a limited mode so we're gonna take that conditional out and we're gonna just do it if there's a jumper attached now check orbits needs to change so we're gonna test if we've done a full circle but then we're going to increase current orbits by one and then if we have completed a circle we're going to emit a signal so I'm going to define a signal up here called full orbit that we're going to emit if we've done a full orbit so we're going to emit signal full orbit and now if we're in limited mode we'll do this other stuff like we've been doing before so if mode is modes dot limited then we will play the beep sound because we completed a circle we will update the label text to be we want that to be num orbits minus current orbits because now if we started out with three we've done two they'll be one left and it's still gonna be over and implode if we run out but then we need this to happen regardless to update the orbit for the next time around now the other place we need to change them in our draw so draw is going to be getting called all the time now so we need to not draw a be limited circle pie in the middle unless we're in limited mode so if mode is not equal to modes limited we're going to return and then otherwise we will draw now that we need to update this a little bit too because it's using the wrong formula now and instead it's going to be this and then just one plus current orbits so then the pie gets bigger as current orbits goes up breaks are multiplying okay so now we're about there but there's one kind of subtle bug that got introduced here when I was testing this out and trying to figure out how I wanted to do it and that is we emit the signal when the circle completes an orbit but if you jump off right before the orbit is completed the circle you jumped away from it's still going to emit the signal because it hasn't had a chance to implode yet or it's running the implode animation while that's happening and the reason for that is because when we call implode we're not setting jumper equals null and that will solve that problem so now we're done with the circle and we're emitting the signal so over here in Maine we're going to need to do something about that signal all right so we're gonna add a variable called bonus to keep track of our bonus level and it's going to start out and we're gonna give it a set get of set bonus and then we'll define that in a second but we also when we spawn the circle we need to connect up that signal so let's see new game up new game we should set bonus bonus equals zero when we spawn the circle we need to connect that signal and we're gonna connect the full orbits signal to we're gonna connect it directly to the set bonus method and we're gonna pass it a value of 1 because if you complete a full or knit orbit you lose your bonus to the bonus bonus gets reset back to 1 so we're just gonna send one on over there now we also need to when you hit a new circle if you jumped we should add one to your bonus so score we add we add 1 times bonus right so whatever your multiple bonus is your your score multiplier and we increase bonus by one and then we can do the set bonus method and what this is going to do is set the bonus equal to the value and update the HUD so on the HUD will call update bonus with the bonus value all right and that should do it let's give it a try all right so you can see my bonus increasing but when I let it go around a full circle I lose it and you see my score going up and you can see I got a couple of really good long chains going which was really satisfying to get that really high score and try and keep the chain from breaking so I think this is a great addition it really adds a lot of excitement to playing the game this tutorial is part of my nugudo recipes website the goal is to collect all the best tips and lessons to help make you a better at Godot developer if you like this video I hope you'll go and check out the site and make sure to hit subscribe so you'll be notified whenever I release new videos thanks for watching