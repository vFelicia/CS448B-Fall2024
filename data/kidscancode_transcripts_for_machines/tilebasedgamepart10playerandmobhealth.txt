welcome back to game development with pame this is part 10 of our tile based top down shooter and in this video we're going to be adding Health to our player and our mob Sprites all right so we have our gun working and we can shoot the zombies although hitting them in one shot is a little too powerful so what we want to do now is we want to add some health to those zombies and make the bullets uh do a certain amount of damage uh with hit so we're going to go over here to to our settings and we're going to add a bullet damage let's just keep round numbers I'm going to make the bullets do 10 points of damage and the mob zombies will have 100 Health okay so over here on our uh class mob they have a health of 100 and now what we can do is every time a bullet hits it we just want to subtract the bullet damage from the health and then if the health is ever less than zero we can put that in the update here self that health is less than zero put less than or equal to zero sorry then self. kill okay so now we just need to take away some health whenever the bullet hits okay so over here we in the last video added this little group Collide between the mobs and the bullets and we are just saying each mob that gets hit just gets killed so instead what we're going to do is we're going to say hit. Health minus equals bullet damage right we're just going to take away that amount and if it gets down to zero then the mob will uh will disappear because we already added that in the update um I'm also going to while I'm here I'm going to take the velocity of the mob and set it to zero so when you hit it it just will stop it slightly as if the bullet has a little bit of stopping power Okay so that should look like this okay I'll get over here so we have some more space you can see see I'm shooting that one and it disappears now good enough 10 shots to kill the Zombies but it would be nice if the zombies had some indication of what their health was right a little uh health bar that I could see going down so I know how much damage I'm doing and how close I am to killing the zombie because I might want to run away from it or I might want to keep shooting it okay so on our mob we're going to add a new method to our mob and this is going to be called Draw health and what this is going to do is draw a little colored bar up at the top you know superimposed on the mob showing what it's health bar is now one thing we want to do is let's go over here and check our colors do we have yep green yellow and red so it's green when it's full yellow when it's Midway and red when it starts to get low so we can see visually uh how it's changing so we're going to go over here and depending we need to choose a color based on what the health is if the health is greater than say 60% then the color is going to be green okay if it's not then we're going to say if it's greater than 30 the color is going to be yellow and otherwise the color will be red okay so now we know what color we're going to draw our bar in okay uh the width of the bar is just going to be um the width of the bar is going to be whatever the width of our rectangle is right times the percentage of the health that's left so self. health over 100 so if you have 50 Health left it'll be half the width right so that's perfect okay and then we need to make a little we need to figure out the rectangle that we're going to fill in so the health bar is going to be a rectangle and this this is the location it's going to be on the Sprite image not on the screen okay it's going to be width wide and uh let's try this thickness and see what we how we like it okay now I don't want to draw the bar I only want to draw the bar if it's actually less than 100 so when the mob first spawns and it's at full health we don't see the bar at all it'll be once we hit it so we're just going to draw that rectangle on top of our mob's image in the color and then we use that uh health bar rectangle okay all right so now what we can do is go back over here to our main and in the draw section right here we're going through all the Sprites and we're drawing them on the screen now only the zombies have a health bar so I only want to do the draw Health on Sprites that are zombies so we're going to use the is instance command to say if the Sprite we're looking at is an instance of of mob okay if it is a mob then it's going to have the draw health so we can say sprite. draw Health all right so let's try that out all right let's start shooting there we go see we have our nice little health bar uh going down turning red yellow and then red and then disappears very good now we have some nice feedback on our mobs and now we kind of want to do the same thing on our player which is we want to have the the mobs damage the player and we want to have the player have a health bar that we can see going down as well although I don't think we want to put the health bar of the player on the player uh we're going to put that up in the corner as a a heads up display um and uh we'll be able to see what our health is there so let's go to our player settings here and add a player health and we'll just have that start at 100 too it's easy to use round numbers when you're starting and just occurs to me we forgot to do this we should have done this with the mob too uh set this as a variable so that it's easy for us to change later because we use that number 100 in a lot of different places right so here our mob's Health should be set to mob Health right and when we draw it um we care if it's less than whatever the full health is right and we want to draw the percentage right so that way we know what fraction we have of the of the health not have everything locked to 100 um okay so on the player we're also going to say our health of the player is player health and we just need to draw it on the screen we also need to take away some when when the mobs hit the player and so hitting the player uh we're going to go over to our update section again and we need to do a collision between the mobs and the player Okay so so that's going to be mob's hit player we're going to do another Collide we're going to do a Sprite Collide between the player mobs false now we probably want to use the hit rect hit hit rectangle again just like we did with the with the colliding with the walls remember we made the hit rect so we're going to say uh Collide hit wrecked here so that way when the if the mobs hit the players hit wrecked not if they hit the bigger outer rectangle of the image that way it won't look like they got you when they're not actually that close to you so all right so we need to go through and for each one that hit us we're going to take our player health and we're going to subtract whatever the mob damage is which we need to set as well so we're going to go here and we're going to say the mob damage is also 10 right again I'm just sticking with round numbers to get things working all that stuff can get adjusted later so we take away some health from the player okay I'm also going to have the mob stop brief just like when it get hit gets hit with the bullet like it swiped at you so it's a little little pause there and then we're also going to um say if the player's health is less than zero uh then the game is over right and that'll restart okay now if we run this we're going to see we have a couple of problems still okay one is see I'm dying right away when the mob hits me um so what you would see if we were showing the health bar yet is it would just instantly drop to zero and the reason for that is that the mob is colliding with the player and taking away but the next frame it's still colliding so we're basically permanently colliding so the health gets taken away really fast so what we need to do is one thing we could do is just say if the player gets hit okay if the player gets hit we're going to push the player back a little bit we're going to make the mobs knock you back just a little bit okay um so we want to take the player's velocity or sorry the player's position we're just going to knock him back a little distance and it's going to be something we'll call knockback and we're going to rotate that at whatever the uh Mob that hit us whatever its rotation is so notice I'm not doing it for each mob that hits if you get hit with multiple mobs we're just going to knock you back once because I want you to see how this works so we need to say uh Mob knockback and that's just going to be how what distance it knocks you back okay so Watch What Happens so now I get pushed back which is good right but look at that I get pushed inside the wall if you saw that happen so when I get hit just be because I just move I get pushed inside the wall and we don't want that the reason that I'm going inside the wall has to do with our collide with walls function here our collide with walls function only moves you and puts you against the side of a wall if you're moving because we were using the velocity we were saying if you were moving to the left or you're moving to the right well that's a problem now because we're hitting a wall without moving so we're going to change this and all I really needed to do is instead of checking to see if I was moving to the right I'm just going to say check to see if the walls Center is greater than the player's center right so if the player's Center is greater than the wall Center then I'm on the right hand side of the wall right and then same thing here in this direction we're just going to say if the center X is less than this the the player Cent X then we must be on the left hand side of the wall so we go against the right same idea in this one we're going to say if the center y right is greater than that oops so if the players the center of the player's rectangle is greater than then we must be underneath right so the Y gets put there and then the last one is this one is the center Y is less than okay so that should fix our wall Collision problem so now when I get pushed back I'm going to get against the wall there right and so if you get trapped in a corner you're going to have a problem right because you can't get pushed any further so you definitely don't want to get trapped in a corner okay and let's wrap this up by drawing the player Health on the screen so we can see it now I'm just going to add this at the top here um right now we only have for our HUD our headsup display uh we only have the player Health but eventually we're going to have more and we'll probably move these to a separate file but for right now since there's just one uh I'm going to put it here so I'm just going to define a a function called draw a player Health okay and what we pass to it is um what surface we want to draw on the X and Y where we want to draw it and the percentage of Health uh so we know how big to fill the bar okay and just in case we ever pass it a negative value then we will pin it at zero and now we need to do the size I'm just going to make the variables here real quick because again I just want to see how it looks so we're going to make the bar be 100 pixels wide and we'll make it be 20 pixels tall okay so the amount that's filled is the percentage times the bar bar length right that's going to be how much of it we fill in and we need two rectangles okay we need the outline we're just going to draw an outline of this box it's going to be a rectangle at X and Y and the length will be bar length and the height will be bar height and then the filled rectangle that's going to go inside it is also going to be at XY but its width is going to be that fill amount that we just calculated and the height can also be bar height now just like the when we did it with the zombie we want to figure out what color so if we're uh if our percentage is greater than 60% then the color is going to be green um and if it's greater than 0.3 color equals yellow and otherwise color equals red and then we just need to draw it so we're just going to draw a rect on the surface we said in the color we said using the fill wct and then we're going to draw the outline the surface I'm going to use white outline rect two pixels thick okay so there's our little HUD and then we'll go down to our draw section and just put it there right before we flip the display right I'm going to label this here HUD okay so we're just going to say draw player Health self. screen uh where do we want to put it I think I want to put it in the upper leftand corner so that means that uh I'm going to put it at at 1010 and the percentage is going to be whatever the player's health is divided by the uh total player Health okay let's take a look at that there's our bar and I'll let myself get hit and you can see it going down getting mobbed by zombies ah okay cool our game is dangerous now all right well that was another fairly long video pushing 20 minutes uh let me know in the comments below if that's a problem for you um if you like the shorter length or if you're cool with uh with these pushing uh pushing 20 minutes with some of the more advanced stuff we're going to start doing as we progress with this game some things are going to start taking a little bit longer to explain and to implement and I don't want to break features up in the middle and continue them on separate videos I like to keep at least each video being one adding one thing to the game or one uh one new feature as always please hit the like button below and if you're not subscribed already please hit that subscribe button and if you have any questions or comments post them in the section below and I will see you in the next video