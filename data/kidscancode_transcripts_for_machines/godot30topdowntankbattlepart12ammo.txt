welcome to part 12 of the topdown tank battle tutorial for Godot 3.0 this time we're going to talk about ammo we have added a pickup item that can restore health to our tank repair the damage and now we're gonna add limited ammo so that we can give our player the sense of urgency they've got to conserve their ammo they gotta find Emma crates to restore their ammo alright let's get started previously we made the health pickups so that we could recover some armor when we've been damaged and this time I want to add a different type of pickup that will give us ammo so that it's possible for us to give the player limited ammo and they have to go pick up crates to restore it now to do that we're gonna go over to our first over to our pickup object that we made and in the script we already made an enumerator listing the health and ammo types and so that means that all we need to do is make those both work so I want to use a different texture because you know when we when we run the game we have the little repair wrench hovering above the crate to let us know that's a repair crate so I want to equivalent ammo icon above the ammo crates so that means I'm going to need to load some different images into that icon sprite and we can list those in the code here and load the one we need depending on which one reload and so I'm gonna use in my assets folder I've got my wrench that's the one we were using for the health and then on the next line we will reload the ammo bullet icon so that we know that's what that one is okay so I have two icons and I listed them in this order so that you know health will be zero and that will match the that will match the first one it's the wrench and mo is the second one which would matches the second one and I forgot my equal sign here alright so we have our two images loaded and then in the ready we're just gonna set whichever one is appropriate for what we've chosen and so we'll set the icon texture equal to icon textures type so so now we can choose over here which type we want health or ammo and it'll choose the appropriate icon and then in the pick up we're doing nothing if you pick up a an ammo one so instead what we want to do is the body that picked it up we increase its ammo and this is gonna be the same I'm gonna include the same R and range so that we can have the option of making it random between two values we could also set this to 10 comma 11 here and we'd be sure that you know it's always gonna give back 10 mo but that's okay for now so we're gonna so now we're we have our pickup item set up and ready to go for ammo we need to add ammo to the player tank okay here's our tank script and we're gonna add a signal just like we send out a signal when the health changed we want to send a signal out when the ammo change so that we can have the UI update and display the an accurate value for what our ammo is and then we're going to have a couple of new variables here so first we're going to have a max ammo that's how much how many shots it has that's the the maximum so when you are down that's how much you'll come back up to when you pick up a crate and we'll export that so that we can set that to whatever value we want and then we also need a variable that's going to track our current ammo how much we are currently holding and I'm going to use a negative one so that we can indicate negative one if it has negative one ammo that means it has infinite ammo that's the situation we're in right now where they can just unlimited unlimited ammo then keep firing remember this is the tank script this is inherited by our player and our enemies so this way what we can do is have the enemies stick with negative one they have unlimited ammo and then we can set this to some value say 10 for example for the player and then they will only have 10 shots and then when this whenever this changes we're going to use a setter function called set ammo to update it and have it change I have it do a couple of things whenever we pick up or use ammo let's see so in the ready we're gonna need two just like we did with the health we're gonna need to emit that signal the ammo change signal and what we're going to send out is ammo times 100 over a max ammo so we just send out the percentage of ammo we have left so that we can set the HUD to display that now in our shoot function we want to only allow you to shoot if you have ammo so if you if your can shoot flag is true then your gun cooldown has run out and that's okay but we also need to have ammo so if your ammo is not equal to zero so if you have a negative one you're fine and if you have a number greater than zero you're fine and we subtract one we subtract one from ammo so now every time you shoot we're gonna subtract one and yeah for the enemy tanks that's good means it's gonna be negative two negative three negative four or they're gonna keep going down and down every time they shoot but whatever I mean they're they're not going to shoot billions of times it's just gonna be an integer it doesn't really matter what size the integer is we could even use that for stats later we know how many times the enemy tanks shot might be interesting and we'll think about that later but that's good enough for now and then finally we're going to write that set ammo set our function so set ammo value so when we change our ammo that reminds me we're doing this locally so we have to say self dot ammo so that when we change this value it will call this function if the value is greater than the max ammo then the value equals max ammo yeah so then we cap it there we clamp it to that value set it and name it the signal and actually I can go back up here we're just gonna admit that same signal I admit that ammo change signal also when we set the ammo all right so that means now that we have all this code editing here if we go over to the player we will now have a max ammo in an ammo field and we can set this to 10 for example now my player has 10 shots so I should be able to fire 10 times 2 3 4 5 6 7 8 9 10 and now I can't shoot anymore my ammo has depleted so that's working now we just need to worry about the why so that we can see how much ammo we have so for the HUD I've gone ahead and added a node here so I added a vertical separator just to give some space between these two and I'm using a texture progress just like we used for the bar the health bar except this time I'm setting it to clockwise instead of left to right which means it's going to do a circular progress bar and I'm using this I'm just using this white circular texture for now because again I think I think I said this one we did the health bar we're gonna do we're gonna come back and redo the graphics for this UI because I'm sort of grabbing grabbing pieces from here or there wherever I find them just to sort of build it for now and we can swap in some other textures when we get something that when we have a good idea of exactly all the pieces that we've placed and where we have them and and make them look like a more coherent whole so but so I have a circular texture progress and I've set the filled degrees to 180 that means it's not gonna fill all the way around the whole circle it's only gonna use 180 of it which means so that for example if my value is set to 60% right now you see where the you see where the percentage is and if we were at 10% we'd be there 50% is halfway 100% is the full semicircle whatever we have it set to so that's going to just show us and that that will go down as we fire as we update the HUD so we need to go into our HUD script and add a function to update the ammo gauge just like we update the health bar so that is going to be here we'll say update ammo with whatever value we passed and we'll take the mo gauge dot value equals value and that's all we need to do there and then in our map we have the player's health changed linked to HUD we're also going to connect the connect it to the HUD update mo function all right so let's give that a try and we should see yeah see I said it I set Maximo to 20 and the current mo is 10 so I'm 50% and you can see it going down oh and then we need to last little thing to test here let's make this mo create a or make this create an ammo pickup so we'll make that an ammo pickup and that should show us the right see it has the little bullet over it and if I go pick it up I am now at 20 shots and this is gonna give you some more flexibility with your ammo deserve sorry with your level design because you can you know make the ammo crates rare and then the player has to be really careful about what mo they use maybe the ammo crates are dropped by the enemy tanks when you blow them up so that's where you're gonna get your extra ammo from that kind of thing so it gives you some more flexibility and again you can just set the players ammo to negative 1 and you will have unlimited that'll do it for this episode I'll see you in the next one please feel free to comment in the comments below and let me know if you have anything in particular you'd like to see added to the game next there's a lot of different ways we could go from here so I'd love to hear your ideas you