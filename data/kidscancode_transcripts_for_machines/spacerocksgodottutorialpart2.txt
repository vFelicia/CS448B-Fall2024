hello and welcome to part 2 of the space rocks Godot Engine series in the last part you created our player ship and this time around we're going to make it shoot bullets or lasers or energy pulses or whatever we want to call them in the game there's a link below to the code for the previous part if you want to start there and follow along as well as the code for this part if you just want it to be the final result alright let's get started ok so we have our ship and it slides around and we can control it and that's all good eventually we're going to add some some more visual effects to our ship like a shield and maybe some flames coming out the back when you thrust that all make it look better particles all that kind of fun stuff but the next thing that I want to do is I want to start letting us shoot so we're going to add the weapons to our ship and what that means is we're going to have when you press the starter button a bullet is going to spawn right here in front of the ship and it's going to fly forwards in whatever direction is pointing really fast and then we're going to start a little timer and when that timer runs out is when you'll be allowed to shoot again and that's how we're going to be going to control the fire rate of our of our weapon so we can you know adjust that and get it just right and allowed to be upgraded and all that kind of stuff so I'm going to start by creating a new scene for our bullets and I'm going to use an area 2d for the bullet because this is going to be I just want to know when that bullet overlaps something it doesn't need to collide and down lots of things I want it to I just want to know when it overlaps something so it can be destroyed and so look we're going to call this player player bullet just in case we add enemy bullets and things like that later and we want them to be different that's what I'm going to call it you know and put this in the scene folder and now we're going to add a strike you know what we use sprite a lot you can see it shows up in the recent here you can grab it from there too which is nice so the sprite for a bullet is going to be from our art folder here we've got a bunch of different laser images we can choose from there's blue ones there's green ones there's red ones I'm going to pick a blue one I'm going to take this one right here drop that in the texture spot and where is our there we are grab this and look then now see what happened as I pulled the bullet and I didn't move the area too deep that's why we like to lock them like that alright so there is our bullet node we need to add a collision shape the collision shape 2d and the shape we're going to use for this is a capsule shape that will fit the size of the bullet here really really well remember when you're doing these collision shapes never use these scale handles around the sides it doesn't work with the physics it will either not work the way you expect it or not work at all you want to use the resize handles attached to the shape itself and so we're going to lengthen this we're going to pull this in until we get about the size of the bullet there we go alright so there is our bullet ready to go okay we're going to add a script player bullet we don't want this in the scenes folder I want it in the scripts folder player bullet create ends area to be these comments okay so what's this bullet is going to do is it's going to appear it's going to move and it's going to disappear if it doesn't hit anything and we don't want the bullets to just keep going on infinitely so we are definitely going to you're definitely going to set six process to true and then in the sixth process we are going to move bullets and we're going to move the bullet just by setting the position to whatever the position currently is plus whatever its velocity is times Delta and what's its philosophy to get me well we're going to need a variable for that that's going to be a vector too and we're also going to need a set of speed this is going to be what we can do we can export this and we'll set that equal to something big because we want the bullet to go fast all right now the tricky thing here is that when we spawn the bullet we're going to want it to shoot in the direction you know we're going to rotate it and have it travel in the direction that the ship is pointing at the time it was spawned and the ship is going to be moving around so we're going to have to pass into this bullet those values when we first create it so I'm going to make a new function here called start at and we're going to pass it a direction and a position so what we're going to tell it what directions point in and what position on the screen to start at and we're just going to set the rotation to that direction you can set the position to that position and we're going to set our velocity to a vector two of the speed rotated in that direction so now when we spawn the bullet we will just need to tell ten bits of players rotation and the players location and then the bullet will be spawn at that spot and we still need to do the time out but we're going to go ahead and go back over to the player and make sure that we can start using this so on the player we're going to be we're going to be instancing these three bullet seams right we're going to be instancing them and we need to we need somewhere to add them as a child and the problem is we add them as a child of the player in their position is going to be relative to the player so the bullets will sort of move around and spin whenever the player does and that is not going to be good that's going to look weird so we need a node to hold all of them and the perfect node to use for that is just plain node root one you know if a node has really no properties at all barely any properties at all and it doesn't have a position because if you look at one of the other nodes all this position information comes from the node 2d class and the node is above the 2d class right no duty is here node is notice the simplest node you could possibly have okay this is going to be our bullet container that's going to be a node to hold all the bullets as we spawn them we have lots of them flying around the screen so back to our player script so we want to be able to load that scene the bullet scene so that we can instance it now one way you can do this is you can you can do it like this you could have the bullet and we preload and then we go find the player bullet scene over here copy the path clip sound it and that and that would work and then we have bullet we would say bullet dog instance we want to change what scene we use we have to go in and edit this the other way we could do this is instead of doing it this way we can make this an export export variable you just need to tell it what type this is going to be a packed scene Bar Boulud all right and then that's going to show up now in our inspector and now here I can pick let's see that once I can say go pick one or I can just actually drag the player bullets over here and drop it in there because and it allows that because that's the right type you can see a little tiny image of our a little blue bullet there so now I have a reference to that bullet scene that I can instance and I'm also going to say I'm also going to get a reference to the bullet container so I don't have to say getting a get note all the time we know we can add it to the child they're added as a child to that note okay so now we need to shoot down here is our input code we're going to add one for the fire button input is action press in this case we want player shoot if we press the player shoot then we're going to shoot and I'm going to define that as a function so that we can put whatever other stuff we want in there and say long sheet and in the shoot function we're going to instance a bullet so let's just do bullet instance we're going to add it to the bullet container add child and then we're going to say B dot start app we're going to use our start at function which needs a rotation so we'll get the player's rotation and it needs a position so we're going to get positions okay and let's see how that works okay so a couple things not quite right the bullet is pointing in the right direction but it is traveling in the wrong direction all right so we need figure out why is our velocity not matching our rotation well it's that whole pesky 90 degree rotation thing again so if we go back over to our player bullet here our velocity we actually need to add 90 degrees to that PI over 2 okay if we play that now now the bullet is off in the right direction okay now two problems one is we're shooting them out basically every frame right because we're holding when we hold the button down bolts are being produced every frame the other problem is that these bullets are now they're still going right traveling forever and when they're off the screen or even when they're still on the screen I want them to disappear after a certain amount of time so we need to put that bullet lifetime odds on the player bullet we need to add one more note and this is a super useful node called a timer and so we're going to call this the lifetime and the lifetime is going to determine how long the bullet stays alive so let's put here wait time here is one so that's fine we can leave that and then Auto starts I'm going to fit two on so the timer will start in this script starts running okay so starts counting one second and then we needed to do something when the timer runs out so to do that we're going to look at a signal so lifetime node click on the node here has all of these signals and this is the one we want the timeout signal we're going to connect that to the script on the player bullet node and this is going to be the callback function that will happen when it happens and it's the default name it usually uses is on underscore the name of the signal and up sign we'll just leave that okay on lifetime timeout we're going to say Q 3 Q 3 is how you tell a node to remove itself from the tree and be deleted so now if we run it's a little hard to see if it's working because it's going off the screen so let's actually go back over here and make this really let's make it really small it says 2 quarter of a second so that way when we run it we should see yes if you have the bullet they're stopping they're stopping when they reach that point so that's not how long they live that might be a little shorter than we actually want it but they'll show you that it's working ok still a few things we got to do though we need to set our fire rate and we also need to make it as a bull that was its funding that's flying on top of the player because we're using the players position as the start point I really wanted to start ahead of the play all right so to my players tree here I'm going to add a position to D node this is a useful node you just keep track of a position in space and I want it to be in front of the ship so I'm going to take the position here and I'm just going to move it negative 50 pixels now my position 2 D is out there in front of the ship's right and if I were in rotation mode and I were rotating ship to see it just stays right there in front of the ship wherever it is that's the spot I want the bullet to spawn not the ship's position ok all right so let's call this the muzzle that's the muzzle of our gun and in our script down here in the shoot function instead of getting visions of the ship we're going to say get node get node muzzle duck it close right that's the muzzles position is where I want to pull it to spawn now when we run oh where am I bullets well a clue might be if I point down here to the right hey there are some bullets coming why are they coming from up there well the position of this muzzle is 0 negative 50 well that's up here 50 pixels off the top of the screen right so that's why it's spawning there when we say get pause of the muzzle that's the relative position of the mobile to its parent right I want the real position so I could put the position of the player plus the position of the muzzle but you can also just say get global pause right so that's the global position of the muzzle if I hit play now everything is good okay now the last thing we need to add here is that fire rate okay so to do this we are going to add a new mode called a timer so I have it here in my favorites timer is a very useful very simple node I'm going to call this the gun timer and you have a few settings here in the nodes wait time that's how long the timer will run let's put that at point five not the second and then we have two checkboxes here auto start will have the timer start automatically when the node starts on the sorry when the scene starts so it will continue to repeat we don't want that we're going to start the timer every time we shoot but the one we do want is this one one shot if this is off then what happens is the timer will tick down and when it reaches zero it will just start again counting down another loop and it will just continue going around and what happens is every time it reaches zero it sends out this timeout signal and you can do something with that timeout signal but we don't need that we're going to put this on one shot which means when we hit when we tell it to start it's going to count down to zero and then it's going to stop and then every time we shoot we'll so let's start again okay so all we need to do in the code is go over here and we're going to get a reference to it we don't have to take it note all the time all right done timer node timer and here when we shoot we're just going to say done caller start and that will start it counting down while it's counting down it hasn't reached zero yet so here in the player shoots what we're going to do is we're going to say if gun timer if you get time left how much time is left on the timer it says zero then it has run out so we will shoot which will start it again and that's all we need to do so good start here we can see holding the spacebar down I am now shooting a bullet every half second and if you want to adjust that you just can go the timer and put it at let's say zero point you and that's going to let us do faster but so one of our upgrades can be you know could either change that value of what we use for the gun timer okay so we are done with our bullets so our next step is going to be to get the asteroids going so hopefully I will see you in the next video and we will have some rocks to shoot at thanks for watching bye you