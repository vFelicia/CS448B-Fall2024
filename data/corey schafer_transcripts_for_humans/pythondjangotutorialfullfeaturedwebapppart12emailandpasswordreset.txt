With timestamps:

00:00 - hey there how's it going everybody in
00:01 - this video we'll be learning how to use
00:02 - email to allow users to reset their
00:05 - passwords so Gengo has built-in
00:07 - functionality that can generate a secure
00:09 - token to ensure that only a specific
00:11 - user can reset their password and then
00:13 - we'll see how we can send an email a
00:15 - Django that has instructions for a user
00:18 - to reset their password so let's go
00:20 - ahead and get started so we're going to
00:21 - go back into our projects URL spy module
00:24 - and add some more built-in Gengo views
00:27 - so let's open that up so within my
00:29 - sublime text here I'm going to open the
00:32 - Django project URLs so this is the URLs
00:36 - module where we have the admin route
00:38 - register route and things like that so
00:41 - just like our login and logout views
00:43 - down here towards the bottom these
00:45 - password reset views are built into the
00:47 - off views that we've already imported so
00:50 - we're going to create a few different
00:51 - paths using these built-in views and
00:53 - I'll explain along the way what each of
00:55 - these do so there are a lot of them so
00:58 - I'll try to keep this organized as we're
01:00 - walking through them so first let's
01:02 - create a URL pattern called password
01:04 - reset so I'm going to create this down
01:07 - here below our login and logout views
01:09 - and I'm going to use our logout view as
01:12 - a template here to get started so I'm
01:15 - going to paste this in and now we want
01:17 - this path to be password - reset and the
01:21 - view that we're going to use here comes
01:23 - from off views as well and this is going
01:25 - to be password reset view and for the
01:30 - template name here we will put this in
01:33 - users forge / password underscore reset
01:38 - dot HTML and for the name we will simply
01:41 - do password underscore reset now this is
01:45 - a very long line so let's split this up
01:48 - so I will split this here and also after
01:52 - our off views I'll split that they're
01:54 - still going off the edge there a little
01:56 - bit but that's better than it was so
01:59 - this will be a route that provides a
02:01 - form for our user to fill out that will
02:04 - send a password reset instruction to
02:07 - their email so we specified that we
02:10 - wanted to use this password underscore
02:13 - set template so let's create that and
02:16 - we'll create that in the same place that
02:18 - we created the login and logout
02:19 - templates so that is here in our users
02:22 - app and in our user templates so in our
02:26 - users templates I'm going to create a
02:27 - new template here and I'm gonna call
02:29 - this password underscore reset dot HTML
02:33 - and within this template we're gonna
02:35 - have a form for filling out our email
02:37 - address so I'm gonna grab one of our
02:39 - other templates as a starting point so I
02:41 - think the login route would be a good
02:44 - starting point so I'm going to copy that
02:47 - template and paste it into our password
02:49 - reset template and now I just want to
02:51 - make a few changes here so the legend I
02:53 - will change the legend to reset password
02:57 - I will change the button here on the
03:00 - submit form to request password reset
03:05 - and we also don't need this link here at
03:08 - the bottom so I'm just going to remove
03:11 - that div that is underneath our form and
03:14 - save that okay so now that we've created
03:16 - that path with the built in view and
03:18 - also created the template we also need
03:21 - to create the page for after this form
03:23 - is submitted successfully so this will
03:25 - just be a route that confirms that the
03:27 - email has been sent and tells you to
03:29 - check your inbox so we need to create
03:31 - that so let's open up our urls module
03:35 - again here and this route will be very
03:37 - similar to the one that we just created
03:38 - so I'm going to copy this so I'm going
03:42 - to copy this and paste this in now this
03:45 - still looks a little weird let me try to
03:47 - split this up a little more here ok so
03:51 - that looks a little strange but at least
03:53 - you all can see everything on the screen
03:56 - at the same time if I do it this way
03:58 - okay so like I said this next route is
04:01 - just going to be the page for when our
04:03 - password reset form is submitted
04:05 - successfully and this route will just
04:07 - confirm that the email has been sent and
04:09 - tell us to check our inbox so we can set
04:12 - this equal to password reset forged
04:15 - slash done as the URL for the route that
04:20 - we want to handle this this is going to
04:22 - be password reset done view the name of
04:25 - the template that we're going to use is
04:27 - password underscore reset underscore
04:29 - done dot html' and the name that we will
04:33 - use for this route is going to be
04:35 - password underscore reset underscore
04:37 - done so now let's create a template for
04:40 - this password reset done view so again
04:43 - and our user templates let's create this
04:46 - so I will create a template in here
04:48 - called password underscore reset
04:51 - underscore done dot HTML so in here this
04:55 - is just going to be an informative page
04:57 - there aren't gonna be forms or anything
04:59 - like that in here so I think we can just
05:02 - copy the logout template and reuse most
05:05 - of that so within our password reset
05:08 - done template I'm going to paste that in
05:10 - now I'm actually just going to remove
05:11 - everything inside the content block here
05:14 - and I'm just going to put a bootstrap
05:16 - alert on this page so I will put in a
05:18 - div and this div I'll give a class equal
05:22 - to alert and this will just be an alert
05:25 - - info and within this alert I'm just
05:28 - going to say an email has been sent with
05:33 - instructions to reset your password okay
05:38 - so with those two routes complete let's
05:40 - actually pull this up in our browser and
05:41 - check if this is working so it isn't
05:44 - quite going to work just yet but I want
05:46 - to make sure that the air that we
05:47 - receive is at least what I expect it to
05:49 - be and that we haven't messed anything
05:51 - up along the way so let's make sure that
05:54 - our dev server is running and it is so
05:57 - now let's go back to our page and let's
06:00 - go to forge / password - reset okay so
06:04 - we can see that we get a form here now
06:06 - if we try to fill in this form and
06:08 - submit it then it's going to give us an
06:10 - error because it's going to try to
06:12 - reference a path that doesn't exist yet
06:14 - so I'm gonna fill this in with my email
06:17 - so khorium Schaffer at gmail.com and I
06:19 - will submit that then we can see that we
06:21 - get an error that it's looking for a
06:23 - password underscore reset underscore
06:26 - confirm route and if we look in the
06:29 - place where the actual error occurred
06:32 - which is down here in this template
06:34 - rendering then we can see that it
06:36 - occurred because it's trying to create a
06:38 - URL to this password reset confirm
06:41 - route with these weird values here and
06:44 - the name of the template that through
06:45 - this error is called password reset
06:48 - email HTML so that is a template that
06:52 - Django is using in the background to
06:54 - create the email to send to the user so
06:56 - that they can reset their password and
06:58 - when it's trying to create that email
07:00 - from the template it runs into an error
07:02 - because we don't have a route called
07:04 - password reset confirm and not only is
07:08 - it trying to access that route but it's
07:10 - also trying to pass two different things
07:12 - into the URL parameters so one of those
07:14 - things is called this UID be 64 and the
07:19 - other parameter is one called token now
07:22 - these are two parameters that we need to
07:24 - accept in our URL so that we know that
07:26 - the user who requested the password
07:29 - reset is the person trying to access
07:31 - that page so basically it's adding a
07:34 - layer of security to these routes the
07:37 - UID be 64 is the user's ID encoded in
07:41 - base64 and the token is the token to
07:45 - check that the password is valid and
07:47 - these are required since the view is
07:49 - expecting them so let me create this
07:52 - route that it's looking for and this
07:54 - will make more sense once we see this an
07:56 - action so like I said before these error
07:59 - pages are very useful for following the
08:01 - trail of exactly what changes we need to
08:04 - make in order to get things working so
08:06 - to add this route let's pull up our
08:09 - project URLs module again so I will pull
08:13 - this up and go to our other two routes
08:16 - here and now we need to create a route
08:18 - for password reset confirm so let's just
08:22 - copy one of our other password reset
08:25 - routes here and paste in another one so
08:27 - now we want this URL to be password -
08:30 - reset - confirm and remember I said that
08:35 - it took in - URL parameters so within
08:38 - our angle brackets here one of those
08:40 - parameters that it is expecting is UI DB
08:44 - 6 4 and the other so Forge slash again
08:48 - another angle brackets here you put the
08:51 - trailing slash there at the end the
08:54 - other one is
08:55 - touken so you have to accept those URL
08:58 - parameters there because it expects
09:00 - those so now the view that we want to
09:02 - handle this is going to be password
09:04 - reset confirm view and the template that
09:08 - we're going to want to use is within our
09:10 - users templates and this will be
09:12 - password reset confirm dot HTML and the
09:17 - name that we all set for this is
09:18 - password reset confirm and make sure all
09:22 - of that is spelled correctly okay and
09:25 - just like our other routes let's create
09:27 - a template for this and we called this
09:29 - template password underscore reset
09:31 - underscore confirmed HTML so within our
09:34 - user templates I'm going to create a new
09:36 - file and this is password underscore
09:39 - reset underscore confirm dot HTML and
09:43 - this one is going to have a form for us
09:45 - to actually reset our password so let's
09:48 - copy one of the templates with a form
09:50 - and I'm just going to use the password
09:52 - reset form as a starting point so back
09:55 - in our password reset template I'm going
09:57 - to copy that and paste that into our
09:59 - password reset confirm template and the
10:02 - only thing that I'm going to change in
10:03 - here is the text that is on our submit
10:06 - button so instead of request password
10:08 - reset this is actually going to be the
10:10 - form that resets our password so I'm
10:12 - just going to say let's see reset
10:16 - password okay so now that we have that
10:19 - password reset confirm route that that
10:21 - password reset email template was trying
10:24 - to create now let's try to resubmit
10:27 - resubmit our password reset form and see
10:29 - what we get so I will go back to the
10:32 - browser here and reload our password
10:35 - reset page and now let's submit the
10:39 - password reset for that email one more
10:41 - time okay so we're still getting an
10:43 - error but this is a different error
10:45 - this says connection refused now this
10:48 - error is less helpful than most of the
10:50 - other error pages but I can tell you
10:53 - that what's going on here is that it's
10:55 - trying to send an email but it's failing
10:57 - so right now we don't have an email
10:59 - server or anything like that to send
11:01 - email so at this point you have some
11:04 - choices that you can make there are a
11:06 - lot of different ways to send email now
11:08 - in this video I'm
11:09 - to be using Gmail now if you don't have
11:11 - a gmail account then you can create one
11:13 - and use these same constants with your
11:16 - username and password now if you don't
11:18 - want to use Gmail then there are ways
11:21 - that you can set up your localhost to be
11:23 - used as an email server with Django but
11:25 - I feel like using something like Gmail
11:27 - is a better example of how this is
11:29 - actually going to be done in production
11:32 - and it also gives us practice of
11:34 - actually sending emails but just in case
11:37 - I'm also going to link to the Django
11:39 - documentation on how to set this up on
11:41 - your localhost just in case some of you
11:43 - want to do it that way but with that
11:45 - said in this video I'm going to be using
11:47 - Gmail okay so to do this with Gmail
11:50 - depending on how your account is set up
11:52 - you might have to let Google know to
11:54 - expect sign-ins from a Python
11:56 - application so let me pull up my browser
11:58 - to show you this so I have searched
12:01 - google app passwords here and by
12:04 - searching that there are instructions
12:06 - for how to sign in to your Google
12:08 - account through different applications
12:09 - now if you don't have two factor
12:12 - authentication then you can just tell
12:14 - Google to allow sign-ins from less
12:16 - secure apps but if you do have
12:18 - two-factor authentication which I have
12:20 - and which I would highly recommend by
12:22 - the way then you can create a password
12:25 - specifically for the application that
12:27 - you want to sign in from and that is
12:29 - what I did so the link to do this is the
12:32 - third link down here that says app
12:33 - passwords sign in and the other two
12:36 - pages up here are just two links with
12:38 - instructions and they'll just link you
12:40 - to that third page eventually anyway so
12:43 - I already went through that process and
12:45 - have put my password for this Jango app
12:47 - in a private environment variable on my
12:50 - machine so once you have gone through
12:51 - those google instructions that allow you
12:53 - to sign into your Gmail through a Python
12:56 - application and you have all that setup
12:58 - then now we can open our project's
13:01 - settings dot py file and set a few
13:03 - variables so I can open our projects
13:07 - settings dot py and I'm going to scroll
13:09 - all the way to the bottom to set a few
13:12 - more variables here that will set up our
13:14 - email so I'm going to say email
13:16 - underscore back end is equal to and
13:20 - within a string here I'm going to say
13:23 - Django cor dot mail dot backends dot
13:29 - smtp.gmail.com that that is a class
13:35 - there at the end okay and now I'm going
13:38 - to set an email underscore host and
13:40 - these are all caps by the way so set an
13:43 - email host to smtp.gmail.com and now we
13:50 - want an email underscore port and we're
13:54 - going to set that equal to five eight
13:56 - seven and that is an integer not a
13:59 - string and lastly we will set one called
14:01 - email underscore use underscore TLS set
14:05 - that equal to true and now you need to
14:08 - pass in your username and password now
14:10 - for the username and password I'm not
14:12 - going to actually type those out here
14:14 - for obvious reasons because I don't want
14:15 - anyone to have access to my email so for
14:18 - this information I put this in an
14:20 - environment variable and I have a video
14:22 - on using environment variables to hide
14:24 - sensitive information for things like
14:25 - this so if you don't know how to do this
14:27 - then I would just give that video a
14:29 - watch so to access these I'm just going
14:32 - to say email underscore host underscore
14:36 - user is equal to and access those
14:39 - environment variables I can simply say
14:40 - oh s dot environment
14:43 - get and I put this an environment
14:45 - variable called email underscore user so
14:48 - now I'm going to copy that and for the
14:52 - next line here actually I'll just copy
14:54 - this entire line for the next line we
14:57 - are setting the email host password and
15:01 - the environment variable that I set for
15:04 - this is email underscore Pass and this
15:07 - email host user here this is actually
15:09 - your login email address for Gmail so be
15:13 - sure that you have an email address set
15:15 - for that value so with those settings
15:17 - set I should now be able to send an
15:19 - email with Django and get this password
15:22 - reset email so let's try this out so
15:25 - first of all let's make sure that our
15:27 - dev server is still running and it is so
15:29 - I'm going to open up our browser go back
15:31 - to the password reset page try to send
15:35 - this to Cory M Schaefer
15:36 - gmail.com again I will submit that and
15:40 - it took a little second there but it
15:42 - says that an email has been sent with
15:44 - instructions to reset your email okay so
15:46 - now if I open my Gmail which I have open
15:49 - here in the browser we can see that this
15:51 - has already come in if it hasn't come in
15:53 - yet it might take a second you can just
15:55 - refresh your email until it comes in if
15:58 - it doesn't come in then you might have
15:59 - to go through those steps again and see
16:02 - if you miss something there but we can
16:04 - see that I got an email that says
16:05 - password reset on localhost port 8000 so
16:08 - if you were actually doing this from a
16:10 - website then this would actually be the
16:12 - domain name here so if I click on that
16:14 - we can see it says you're receiving this
16:15 - email because you requested a password
16:17 - reset please go to the following page
16:20 - and choose a new password your username
16:22 - in case you've forgotten is kori MS so I
16:25 - can click on this password reset link
16:28 - here and we can see that it's going to
16:30 - password reset confirm and then it has
16:33 - those two values in the URL so that's
16:37 - that UUID B value and then the token so
16:41 - it created those for us and now when we
16:44 - click on this it'll pass those two that
16:46 - route so now if those tokens and
16:48 - everything were correct which they'll
16:50 - only be correct if they come from your
16:52 - email so they know that it's you trying
16:54 - to change your password if they are
16:55 - correct then now we're redirected to a
16:57 - forum or if we can actually reset our
16:59 - password so I'm going to set this to
17:01 - something different so I did have
17:03 - testing one two three
17:04 - now I'm going to use capital testing and
17:07 - three two one so and then just confirm
17:10 - that so capital testing three two one
17:13 - and reset okay so finally we got to the
17:16 - last step and we got an error but this
17:18 - is going to be super easy to fix this is
17:20 - just one last route called password
17:22 - reset complete that tells us our
17:25 - password has been successfully changed
17:27 - and that we can log in with a new
17:29 - password so let's create this one last
17:31 - route and we should be finished up so
17:33 - let's open up our projects URLs module
17:37 - again and we need to create one last
17:39 - route so I'm going to copy this route
17:43 - here actually this one has a bunch of
17:45 - variables in the URL I'm going to grab
17:48 - this password
17:49 - a trout instead and paste this in so
17:53 - this last route here is going to be
17:55 - password - reset - complete and the view
17:59 - that we want to handle this is password
18:02 - reset complete view and for the template
18:05 - name we will set this equal to password
18:08 - underscore reset underscore complete dot
18:12 - HTML and for the name here we will do
18:14 - password underscore reset underscore
18:16 - complete and save that okay and just
18:19 - like the other routes let's create a
18:21 - template for this so we called this
18:23 - template so and within our user
18:25 - templates I'm going to create a new file
18:27 - this is going to be password underscore
18:29 - reset underscore complete dot HTML and
18:34 - this template is just going to be
18:35 - informative so it doesn't have any forms
18:37 - or anything like that so that's very
18:39 - similar to our password reset done
18:42 - template so let's just copy from there
18:44 - so I've still got that password reset
18:46 - done template here so I will copy that
18:49 - and paste it in here so currently on
18:51 - this page we just have an alert so I'm
18:53 - gonna have an alert on this page too and
18:55 - just say your password has been set and
19:00 - now we can link them to the sign-in page
19:04 - so right underneath that I'm just going
19:06 - to do an anchor tag and do a code block
19:10 - here and have this be a URL to our login
19:15 - page and then for the text of this link
19:17 - I'm just going to say sign in here and
19:22 - save that okay so with that last page
19:24 - created let's walk through all of this
19:26 - one more time and I'm going to point out
19:28 - every page that we are on throughout the
19:30 - whole process so I'm going to go back to
19:33 - our browser and let's go to our main
19:37 - page here and then go to forge /
19:39 - password reset so this here is the
19:43 - password reset page that displays the
19:46 - password reset template so now we'll
19:48 - fill out the form with the email that we
19:51 - want to request the password reset link
19:54 - be sent to so I will submit that so when
19:57 - we submit that form it sends the email
20:00 - and it directs us to the password reset
20:03 - template that just gives us this
20:05 - information that the email has been sent
20:08 - so now we can actually go to our email
20:10 - and see the message that was sent so if
20:13 - I go to my email then I've got one new
20:15 - message here so again this is a password
20:17 - reset on localhost so I will go here and
20:20 - click on the password reset link and now
20:24 - we're being asked to create a new
20:25 - password for our account so this is the
20:28 - password reset confirm template and
20:30 - lastly if we fill out the new password
20:33 - so I'll do the old password of testing
20:35 - three to one testing three to one
20:38 - and reset password then that resets our
20:40 - password and now we get redirected to
20:43 - the password reset complete page and
20:45 - this is the last page in that process
20:48 - and from here we can click on sign-in
20:51 - and if I sign in with that new password
20:55 - then if everything worked correctly then
20:57 - you should now be able to log in with
20:59 - your new password okay so that looks
21:02 - like that works oh that's awesome
21:03 - so now that we're done with that there's
21:04 - just one more thing that we need to do
21:06 - we haven't actually created a link
21:08 - anywhere for the user to reset their
21:10 - password and most web applications have
21:12 - this link on the login page since that's
21:15 - where they'll go to sign up and so I'm
21:17 - going to put a link there for them to
21:19 - reset their password if they forgot it
21:21 - or just want to change it so let's go to
21:24 - the login template and put that there so
21:27 - I'm going to open this up I'm going to
21:28 - close down some of our tabs that we have
21:31 - loaded up here now I'm going to open our
21:34 - login template and I'm just going to put
21:36 - this reset password link right after our
21:39 - submit button
21:40 - so I'll just even put it right in the
21:42 - same div so here's our submit button
21:43 - here to login and right underneath that
21:47 - I'm going to just put some small text
21:50 - here and I'm going to give this a class
21:52 - equal to text - muted and I'm also going
21:57 - to give it a margin left of 2 so within
22:00 - there let's create a an anchor tag so
22:03 - I'll create an anchor tag and the URL I
22:06 - will create a URL here and we want the
22:09 - URL to go to that password reset route
22:14 - so password
22:16 - reset and the text that we can put for
22:20 - this link I'll just say forgot password
22:23 - question mark okay so once we save that
22:26 - let's go back to our browser and let me
22:29 - log out and go back to the login page
22:32 - okay and it looks like we got an error
22:34 - here so reverse for password reset not
22:37 - found okay so that is I put a dash there
22:40 - that should actually be an underscore so
22:42 - back in our login template instead of
22:45 - URL for password - reset that should be
22:48 - password underscore reset is what I
22:50 - named that route so now let me reload
22:54 - that so now we can see that right beside
22:56 - the login button there is a link that
22:58 - asked if you forgot your password so if
23:00 - you forget your password or want to
23:02 - reset your password then you can just
23:04 - click there and it takes you to that
23:06 - reset password form where you can type
23:09 - in your email and request your password
23:11 - reset link and at that point the user
23:13 - would go through that whole process that
23:15 - we solved before okay so I think that is
23:17 - going to do it for this video I hope
23:19 - that now you have a good idea for how
23:21 - you can create password reset emails
23:23 - using Jango now this is a nice secure
23:25 - way to do these password resets since
23:27 - Jango handles all of that token creation
23:30 - and everything else in the background
23:31 - it's definitely a feature that a lot of
23:33 - people overlook on applications but it's
23:36 - one that you're definitely going to need
23:37 - at some point so you may as well learn
23:39 - how to do it now and that really does it
23:41 - for the base functionality of the
23:43 - application that we've built now in the
23:45 - near future I'm going to release further
23:47 - videos on some improvements that we can
23:48 - make to this application so when it
23:50 - comes to web applications there's almost
23:52 - no limit to the improvements that you
23:54 - can continue to make so for example with
23:56 - this application we'll go over how to
23:58 - write unit tests for this application
24:00 - we'll go over how to deploy this
24:02 - application on multiple different
24:03 - platforms we could learn how to send
24:06 - longer running requests off to a message
24:08 - queue and make it asynchronous we could
24:10 - add a commenting system a search feature
24:13 - there are just all kinds of things that
24:14 - we can do with this application in the
24:17 - near future so if you have any
24:18 - suggestions for future videos that you'd
24:20 - like to see with this application then
24:22 - feel free to leave a comment below and
24:24 - I'll do my best to work on a tutorial
24:26 - for that in the near future but if
24:28 - anyone has any questions about what
24:29 - covered in this video then feel free to
24:31 - ask in the comment section below and
24:32 - I'll do my best to answer those and if
24:34 - you enjoy these tutorials and would like
24:35 - to support them then there are several
24:36 - ways you can do that the easiest ways to
24:38 - simply LIKE the video and give it a
24:39 - thumbs up and also it's a huge help to
24:41 - share these videos with anyone who you
24:43 - think would find them useful and if you
24:44 - have the means you can contribute
24:45 - through patreon and there's a link to
24:46 - that page in the description section
24:48 - below be sure to subscribe for future
24:49 - videos and thank you all for watching
25:02 - you

Cleaned transcript:

hey there how's it going everybody in this video we'll be learning how to use email to allow users to reset their passwords so Gengo has builtin functionality that can generate a secure token to ensure that only a specific user can reset their password and then we'll see how we can send an email a Django that has instructions for a user to reset their password so let's go ahead and get started so we're going to go back into our projects URL spy module and add some more builtin Gengo views so let's open that up so within my sublime text here I'm going to open the Django project URLs so this is the URLs module where we have the admin route register route and things like that so just like our login and logout views down here towards the bottom these password reset views are built into the off views that we've already imported so we're going to create a few different paths using these builtin views and I'll explain along the way what each of these do so there are a lot of them so I'll try to keep this organized as we're walking through them so first let's create a URL pattern called password reset so I'm going to create this down here below our login and logout views and I'm going to use our logout view as a template here to get started so I'm going to paste this in and now we want this path to be password reset and the view that we're going to use here comes from off views as well and this is going to be password reset view and for the template name here we will put this in users forge / password underscore reset dot HTML and for the name we will simply do password underscore reset now this is a very long line so let's split this up so I will split this here and also after our off views I'll split that they're still going off the edge there a little bit but that's better than it was so this will be a route that provides a form for our user to fill out that will send a password reset instruction to their email so we specified that we wanted to use this password underscore set template so let's create that and we'll create that in the same place that we created the login and logout templates so that is here in our users app and in our user templates so in our users templates I'm going to create a new template here and I'm gonna call this password underscore reset dot HTML and within this template we're gonna have a form for filling out our email address so I'm gonna grab one of our other templates as a starting point so I think the login route would be a good starting point so I'm going to copy that template and paste it into our password reset template and now I just want to make a few changes here so the legend I will change the legend to reset password I will change the button here on the submit form to request password reset and we also don't need this link here at the bottom so I'm just going to remove that div that is underneath our form and save that okay so now that we've created that path with the built in view and also created the template we also need to create the page for after this form is submitted successfully so this will just be a route that confirms that the email has been sent and tells you to check your inbox so we need to create that so let's open up our urls module again here and this route will be very similar to the one that we just created so I'm going to copy this so I'm going to copy this and paste this in now this still looks a little weird let me try to split this up a little more here ok so that looks a little strange but at least you all can see everything on the screen at the same time if I do it this way okay so like I said this next route is just going to be the page for when our password reset form is submitted successfully and this route will just confirm that the email has been sent and tell us to check our inbox so we can set this equal to password reset forged slash done as the URL for the route that we want to handle this this is going to be password reset done view the name of the template that we're going to use is password underscore reset underscore done dot html' and the name that we will use for this route is going to be password underscore reset underscore done so now let's create a template for this password reset done view so again and our user templates let's create this so I will create a template in here called password underscore reset underscore done dot HTML so in here this is just going to be an informative page there aren't gonna be forms or anything like that in here so I think we can just copy the logout template and reuse most of that so within our password reset done template I'm going to paste that in now I'm actually just going to remove everything inside the content block here and I'm just going to put a bootstrap alert on this page so I will put in a div and this div I'll give a class equal to alert and this will just be an alert info and within this alert I'm just going to say an email has been sent with instructions to reset your password okay so with those two routes complete let's actually pull this up in our browser and check if this is working so it isn't quite going to work just yet but I want to make sure that the air that we receive is at least what I expect it to be and that we haven't messed anything up along the way so let's make sure that our dev server is running and it is so now let's go back to our page and let's go to forge / password reset okay so we can see that we get a form here now if we try to fill in this form and submit it then it's going to give us an error because it's going to try to reference a path that doesn't exist yet so I'm gonna fill this in with my email so khorium Schaffer at gmail.com and I will submit that then we can see that we get an error that it's looking for a password underscore reset underscore confirm route and if we look in the place where the actual error occurred which is down here in this template rendering then we can see that it occurred because it's trying to create a URL to this password reset confirm route with these weird values here and the name of the template that through this error is called password reset email HTML so that is a template that Django is using in the background to create the email to send to the user so that they can reset their password and when it's trying to create that email from the template it runs into an error because we don't have a route called password reset confirm and not only is it trying to access that route but it's also trying to pass two different things into the URL parameters so one of those things is called this UID be 64 and the other parameter is one called token now these are two parameters that we need to accept in our URL so that we know that the user who requested the password reset is the person trying to access that page so basically it's adding a layer of security to these routes the UID be 64 is the user's ID encoded in base64 and the token is the token to check that the password is valid and these are required since the view is expecting them so let me create this route that it's looking for and this will make more sense once we see this an action so like I said before these error pages are very useful for following the trail of exactly what changes we need to make in order to get things working so to add this route let's pull up our project URLs module again so I will pull this up and go to our other two routes here and now we need to create a route for password reset confirm so let's just copy one of our other password reset routes here and paste in another one so now we want this URL to be password reset confirm and remember I said that it took in URL parameters so within our angle brackets here one of those parameters that it is expecting is UI DB 6 4 and the other so Forge slash again another angle brackets here you put the trailing slash there at the end the other one is touken so you have to accept those URL parameters there because it expects those so now the view that we want to handle this is going to be password reset confirm view and the template that we're going to want to use is within our users templates and this will be password reset confirm dot HTML and the name that we all set for this is password reset confirm and make sure all of that is spelled correctly okay and just like our other routes let's create a template for this and we called this template password underscore reset underscore confirmed HTML so within our user templates I'm going to create a new file and this is password underscore reset underscore confirm dot HTML and this one is going to have a form for us to actually reset our password so let's copy one of the templates with a form and I'm just going to use the password reset form as a starting point so back in our password reset template I'm going to copy that and paste that into our password reset confirm template and the only thing that I'm going to change in here is the text that is on our submit button so instead of request password reset this is actually going to be the form that resets our password so I'm just going to say let's see reset password okay so now that we have that password reset confirm route that that password reset email template was trying to create now let's try to resubmit resubmit our password reset form and see what we get so I will go back to the browser here and reload our password reset page and now let's submit the password reset for that email one more time okay so we're still getting an error but this is a different error this says connection refused now this error is less helpful than most of the other error pages but I can tell you that what's going on here is that it's trying to send an email but it's failing so right now we don't have an email server or anything like that to send email so at this point you have some choices that you can make there are a lot of different ways to send email now in this video I'm to be using Gmail now if you don't have a gmail account then you can create one and use these same constants with your username and password now if you don't want to use Gmail then there are ways that you can set up your localhost to be used as an email server with Django but I feel like using something like Gmail is a better example of how this is actually going to be done in production and it also gives us practice of actually sending emails but just in case I'm also going to link to the Django documentation on how to set this up on your localhost just in case some of you want to do it that way but with that said in this video I'm going to be using Gmail okay so to do this with Gmail depending on how your account is set up you might have to let Google know to expect signins from a Python application so let me pull up my browser to show you this so I have searched google app passwords here and by searching that there are instructions for how to sign in to your Google account through different applications now if you don't have two factor authentication then you can just tell Google to allow signins from less secure apps but if you do have twofactor authentication which I have and which I would highly recommend by the way then you can create a password specifically for the application that you want to sign in from and that is what I did so the link to do this is the third link down here that says app passwords sign in and the other two pages up here are just two links with instructions and they'll just link you to that third page eventually anyway so I already went through that process and have put my password for this Jango app in a private environment variable on my machine so once you have gone through those google instructions that allow you to sign into your Gmail through a Python application and you have all that setup then now we can open our project's settings dot py file and set a few variables so I can open our projects settings dot py and I'm going to scroll all the way to the bottom to set a few more variables here that will set up our email so I'm going to say email underscore back end is equal to and within a string here I'm going to say Django cor dot mail dot backends dot smtp.gmail.com that that is a class there at the end okay and now I'm going to set an email underscore host and these are all caps by the way so set an email host to smtp.gmail.com and now we want an email underscore port and we're going to set that equal to five eight seven and that is an integer not a string and lastly we will set one called email underscore use underscore TLS set that equal to true and now you need to pass in your username and password now for the username and password I'm not going to actually type those out here for obvious reasons because I don't want anyone to have access to my email so for this information I put this in an environment variable and I have a video on using environment variables to hide sensitive information for things like this so if you don't know how to do this then I would just give that video a watch so to access these I'm just going to say email underscore host underscore user is equal to and access those environment variables I can simply say oh s dot environment get and I put this an environment variable called email underscore user so now I'm going to copy that and for the next line here actually I'll just copy this entire line for the next line we are setting the email host password and the environment variable that I set for this is email underscore Pass and this email host user here this is actually your login email address for Gmail so be sure that you have an email address set for that value so with those settings set I should now be able to send an email with Django and get this password reset email so let's try this out so first of all let's make sure that our dev server is still running and it is so I'm going to open up our browser go back to the password reset page try to send this to Cory M Schaefer gmail.com again I will submit that and it took a little second there but it says that an email has been sent with instructions to reset your email okay so now if I open my Gmail which I have open here in the browser we can see that this has already come in if it hasn't come in yet it might take a second you can just refresh your email until it comes in if it doesn't come in then you might have to go through those steps again and see if you miss something there but we can see that I got an email that says password reset on localhost port 8000 so if you were actually doing this from a website then this would actually be the domain name here so if I click on that we can see it says you're receiving this email because you requested a password reset please go to the following page and choose a new password your username in case you've forgotten is kori MS so I can click on this password reset link here and we can see that it's going to password reset confirm and then it has those two values in the URL so that's that UUID B value and then the token so it created those for us and now when we click on this it'll pass those two that route so now if those tokens and everything were correct which they'll only be correct if they come from your email so they know that it's you trying to change your password if they are correct then now we're redirected to a forum or if we can actually reset our password so I'm going to set this to something different so I did have testing one two three now I'm going to use capital testing and three two one so and then just confirm that so capital testing three two one and reset okay so finally we got to the last step and we got an error but this is going to be super easy to fix this is just one last route called password reset complete that tells us our password has been successfully changed and that we can log in with a new password so let's create this one last route and we should be finished up so let's open up our projects URLs module again and we need to create one last route so I'm going to copy this route here actually this one has a bunch of variables in the URL I'm going to grab this password a trout instead and paste this in so this last route here is going to be password reset complete and the view that we want to handle this is password reset complete view and for the template name we will set this equal to password underscore reset underscore complete dot HTML and for the name here we will do password underscore reset underscore complete and save that okay and just like the other routes let's create a template for this so we called this template so and within our user templates I'm going to create a new file this is going to be password underscore reset underscore complete dot HTML and this template is just going to be informative so it doesn't have any forms or anything like that so that's very similar to our password reset done template so let's just copy from there so I've still got that password reset done template here so I will copy that and paste it in here so currently on this page we just have an alert so I'm gonna have an alert on this page too and just say your password has been set and now we can link them to the signin page so right underneath that I'm just going to do an anchor tag and do a code block here and have this be a URL to our login page and then for the text of this link I'm just going to say sign in here and save that okay so with that last page created let's walk through all of this one more time and I'm going to point out every page that we are on throughout the whole process so I'm going to go back to our browser and let's go to our main page here and then go to forge / password reset so this here is the password reset page that displays the password reset template so now we'll fill out the form with the email that we want to request the password reset link be sent to so I will submit that so when we submit that form it sends the email and it directs us to the password reset template that just gives us this information that the email has been sent so now we can actually go to our email and see the message that was sent so if I go to my email then I've got one new message here so again this is a password reset on localhost so I will go here and click on the password reset link and now we're being asked to create a new password for our account so this is the password reset confirm template and lastly if we fill out the new password so I'll do the old password of testing three to one testing three to one and reset password then that resets our password and now we get redirected to the password reset complete page and this is the last page in that process and from here we can click on signin and if I sign in with that new password then if everything worked correctly then you should now be able to log in with your new password okay so that looks like that works oh that's awesome so now that we're done with that there's just one more thing that we need to do we haven't actually created a link anywhere for the user to reset their password and most web applications have this link on the login page since that's where they'll go to sign up and so I'm going to put a link there for them to reset their password if they forgot it or just want to change it so let's go to the login template and put that there so I'm going to open this up I'm going to close down some of our tabs that we have loaded up here now I'm going to open our login template and I'm just going to put this reset password link right after our submit button so I'll just even put it right in the same div so here's our submit button here to login and right underneath that I'm going to just put some small text here and I'm going to give this a class equal to text muted and I'm also going to give it a margin left of 2 so within there let's create a an anchor tag so I'll create an anchor tag and the URL I will create a URL here and we want the URL to go to that password reset route so password reset and the text that we can put for this link I'll just say forgot password question mark okay so once we save that let's go back to our browser and let me log out and go back to the login page okay and it looks like we got an error here so reverse for password reset not found okay so that is I put a dash there that should actually be an underscore so back in our login template instead of URL for password reset that should be password underscore reset is what I named that route so now let me reload that so now we can see that right beside the login button there is a link that asked if you forgot your password so if you forget your password or want to reset your password then you can just click there and it takes you to that reset password form where you can type in your email and request your password reset link and at that point the user would go through that whole process that we solved before okay so I think that is going to do it for this video I hope that now you have a good idea for how you can create password reset emails using Jango now this is a nice secure way to do these password resets since Jango handles all of that token creation and everything else in the background it's definitely a feature that a lot of people overlook on applications but it's one that you're definitely going to need at some point so you may as well learn how to do it now and that really does it for the base functionality of the application that we've built now in the near future I'm going to release further videos on some improvements that we can make to this application so when it comes to web applications there's almost no limit to the improvements that you can continue to make so for example with this application we'll go over how to write unit tests for this application we'll go over how to deploy this application on multiple different platforms we could learn how to send longer running requests off to a message queue and make it asynchronous we could add a commenting system a search feature there are just all kinds of things that we can do with this application in the near future so if you have any suggestions for future videos that you'd like to see with this application then feel free to leave a comment below and I'll do my best to work on a tutorial for that in the near future but if anyone has any questions about what covered in this video then feel free to ask in the comment section below and I'll do my best to answer those and if you enjoy these tutorials and would like to support them then there are several ways you can do that the easiest ways to simply LIKE the video and give it a thumbs up and also it's a huge help to share these videos with anyone who you think would find them useful and if you have the means you can contribute through patreon and there's a link to that page in the description section below be sure to subscribe for future videos and thank you all for watching you
