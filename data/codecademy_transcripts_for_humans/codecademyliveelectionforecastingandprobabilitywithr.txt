With timestamps:

00:00 - loading just wait a little bit
00:05 - i can never tell when it's like even
00:07 - actually going all the way through
00:09 - loading it
00:10 - sometimes makes us be live so
00:13 - yeah we'll just hang out here for a
00:15 - second until we actually confirm that
00:17 - we're live i think we probably are
00:19 - but we'll see
00:24 - okay cool we are live so if you want to
00:27 - go ahead and get started whenever you're
00:28 - ready sure yeah
00:31 - welcome everybody i'm super excited to
00:33 - be here
00:34 - um i'm sophie this is my co-worker alex
00:38 - and we are both curriculum developers
00:41 - at codecademy and we're both
00:45 - uh working on data science content a
00:48 - fair amount
00:49 - on the site so we've been
00:52 - working on our own data science projects
00:54 - for a while and
00:55 - um and asking our own data science
00:58 - related questions and
00:59 - um one of the things that we were
01:02 - working on
01:03 - for the last week or so is digging into
01:06 - some of the 538 data and we thought we
01:09 - would
01:09 - share all that work with you guys so um
01:13 - feel free to say hello in the chat i
01:15 - think we're live on youtube
01:17 - and twitter i think or twitter
01:21 - yeah okay well we're live on a few
01:24 - different platforms but we are going to
01:27 - um be monitoring the youtube chat
01:30 - so i have that open um feel free to say
01:33 - hi feel free to say where you're calling
01:36 - or you're watching from it's always fun
01:38 - to see where everybody is
01:40 - at um and if you have any questions or
01:43 - you want us to stop and like discuss
01:45 - anything
01:46 - um feel free to mention that in the chat
01:49 - as well um yeah i i'm really excited for
01:53 - this one
01:54 - if you haven't been following our
01:55 - youtube channel very much we've been
01:56 - doing these live stream series kind of
01:58 - teaching lessons on codecademy
02:00 - uh we just finished a series teaching
02:02 - introduction
02:03 - coding topics and so we're kind of
02:05 - looking for the next live stream thing
02:06 - to do
02:07 - and uh last week sophie was telling me
02:09 - you were like looking around at 538 data
02:12 - and we felt like it would be a a fun
02:14 - quick little one-off stream to do so
02:16 - um sophie i'm like blown away by uh the
02:19 - lesson that
02:20 - that you prepared maybe i don't want to
02:22 - set expectations too high but i'm super
02:24 - excited too
02:26 - to go through this stuff yeah so uh i
02:29 - think the first caveat that we just want
02:30 - to share with everybody is that
02:32 - uh neither of us are election
02:35 - forecasting
02:36 - experts um we both are people that
02:39 - like asking questions and trying to
02:41 - understand things
02:43 - um and like you know and we both like to
02:45 - try to understand things through code
02:46 - and so
02:47 - um for me you know like as i read the
02:50 - news and i see these simulations i want
02:52 - to understand what's going on i want to
02:54 - know how to make my own
02:57 - i don't know form my own opinions about
02:59 - what simulations are
03:00 - good or bad or like i don't even know uh
03:04 - but
03:04 - i want to be able to understand it so
03:06 - that i can feel like
03:07 - i know what's going on in the world and
03:09 - so um the way
03:11 - that i do that is i read a bunch of
03:14 - stuff
03:14 - and then i download some data and then i
03:16 - kind of
03:18 - play around with the data on my own and
03:20 - so i think
03:21 - the goal for today is
03:24 - one to kind of talk about election
03:27 - simulations and election forecasting but
03:29 - a bigger goal i think is to kind of
03:31 - demonstrate to you how
03:33 - if you're reading stuff and you want to
03:34 - understand something you can
03:37 - kind of dig a little bit and sometimes
03:38 - download your own data and kind of ask
03:40 - your own questions
03:42 - and so what i hope people get from this
03:45 - is that
03:45 - it's possible to do um and we we also
03:49 - have uploaded some
03:50 - code uh like the final code
03:53 - uh that we're using today um
03:57 - where can people get that alex yeah so
04:00 - if you're watching on youtube or if
04:01 - you're watching um
04:02 - in our uh youtube channel after the fact
04:04 - this will be posted after the fact
04:06 - um it's all in the description of the uh
04:09 - youtube video so we have a link to
04:11 - the data that we're using from 538 we
04:13 - will link to a blog post from andrew
04:15 - gellman who uh
04:16 - sophie we're going to talk about this
04:18 - specific blog post a lot i think
04:20 - and then finally we have a link to the
04:21 - code that sophie um
04:23 - wrote in preparation for this and
04:24 - hopefully we'll be able to show a lot of
04:25 - that
04:26 - in this stream perfect awesome so i
04:30 - think with that
04:31 - we will get started um and so
04:34 - i have this page up hopefully everybody
04:37 - can see it this
04:38 - is on 5 38 and this is
04:41 - um they're kind of like interactive
04:43 - election map where you can
04:45 - try out different scenarios and see how
04:48 - it changes the map so
04:50 - by default when you first go to this
04:52 - site you can see all of the
04:54 - all the states are colored by how likely
04:58 - uh we think they are to go red or blue
05:01 - so if you hover over any state like
05:03 - here we're on texas and it says trump
05:06 - has a 61 and 100 chance or 61
05:08 - chance of winning based on this forecast
05:11 - and biden has
05:12 - a 39 chance um if we hover over florida
05:16 - we see
05:17 - biden has a 69 chance and trump has a 31
05:20 - chance um and then what you can do so
05:24 - this is kind of like the baseline map
05:25 - and then what you can do is you can
05:27 - turn certain states different colors so
05:30 - um
05:31 - you can say okay well what would happen
05:34 - if
05:34 - pennsylvania goes red and then you'll
05:37 - notice that
05:39 - the whole map changes um so before if we
05:42 - go back to
05:43 - kind of normal it says we have biden
05:46 - with
05:46 - an 89 chance of winning um
05:50 - and then if you turn pennsylvania red
05:53 - all of a sudden now this gets flipped
05:55 - where trump has a higher percentage
05:57 - chance of winning based on the
05:59 - simulation
06:00 - and another thing you'll notice too if
06:02 - you look at this is
06:04 - um like right now florida is slightly
06:07 - blue so
06:08 - biden has a 69 chance of winning based
06:11 - on this baseline map
06:13 - but if we turn pennsylvania red
06:16 - all of a sudden florida now goes red um
06:19 - slightly red and is now slightly in
06:21 - favor of
06:23 - of trump winning um and so we've got
06:26 - like some
06:27 - interesting things going on here where
06:29 - when you first come to this map at least
06:31 - when i first came to this
06:33 - this map and sort of saw this baseline
06:35 - and i see these
06:37 - probabilities um for each state i'm
06:40 - thinking
06:40 - okay so it's kind of like it's like
06:43 - flipping a coin or something like this
06:45 - where
06:46 - you know a coin has a 50 chance of
06:48 - coming up heads
06:49 - if i flip that coin it's gonna come up
06:52 - heads half the time and it's going to
06:53 - come up tails the other half
06:55 - the time but then you get a little bit
06:58 - i don't know i felt i get a little
07:01 - confused because then i'm thinking well
07:03 - how can we really talk about probability
07:05 - in that way with this map
07:07 - because well first of all there's only
07:10 - going to be one election
07:12 - right so like with a coin flip you could
07:14 - imagine flipping a coin
07:16 - like a million times and when we say
07:19 - that there's a 50
07:20 - chance of it coming up heads we really
07:22 - mean that like if we flip that coin a
07:24 - million times
07:25 - half the time we expect it to come up
07:27 - heads
07:28 - but with the election there's only going
07:31 - to be one
07:32 - election day tomorrow like there's going
07:34 - to be an outcome
07:35 - and it's not like we could repeat the
07:39 - same election
07:40 - um and there would be slightly different
07:43 - outcomes like these probabilities are
07:45 - not
07:45 - really uh or maybe it's false to call
07:49 - them probabilities but
07:50 - the way they're presented they kind of
07:51 - seem like them these probabilities are
07:53 - not
07:54 - um you know imagining that we're
07:58 - running the same election multiple times
08:00 - and just like
08:01 - depending on who's a who's able to get
08:04 - out to vote we expect some differences
08:06 - like it's
08:06 - it's something else a little bit more
08:08 - complex here um and so
08:11 - i felt like i wanted to understand this
08:13 - a little bit better
08:14 - um and so i i started by reading a lot
08:18 - on 5 38
08:19 - i also um i follow andrew gelman's blog
08:23 - he's
08:24 - a statistician at columbia um and he
08:27 - helped create
08:28 - a forecast for um the economist i
08:31 - believe
08:32 - and uh so he has some back and forth and
08:35 - um
08:36 - this is a blog post that he wrote
08:40 - somewhat recently about 538 simulation
08:44 - or 538's map um and he points out some
08:47 - interesting edge cases
08:49 - i think it's a healthy back and forth um
08:51 - but he points to
08:53 - he has a uh someone in the comments of
08:56 - his
08:56 - uh blog had pointed to a file on 538
09:00 - site where you can get
09:01 - all of the data uh for this simulation
09:04 - map and so
09:05 - oops for this for this map you can get
09:09 - the data that's creating it um and so
09:12 - whoops and so i decided to download it
09:16 - myself
09:16 - i used some of the code that he
09:19 - actually provided in this article or in
09:22 - this blog post so
09:23 - um lots of credit to him for sharing his
09:26 - code
09:27 - um and and i went ahead and investigated
09:30 - myself so
09:30 - what i'm gonna do now unless alex is
09:33 - there anything you wanna
09:35 - no i think i i think kind of in all of
09:37 - this prelude i think
09:38 - uh you've hit on something that's a
09:39 - little bit interesting which is like uh
09:42 - you know we we probably started talking
09:43 - about doing this stream like a week ago
09:45 - and we had an idea of what we originally
09:46 - wanted to do
09:47 - and it focused a lot about that idea of
09:49 - like probabilities of like
09:50 - oh let's um you know uh let's run a
09:53 - thousand simulations of the election
09:55 - uh you know for every state we're gonna
09:56 - flip our coin you know it's not a coin
09:58 - but it's for texas it's gonna be 61
10:01 - trump uh
10:02 - 31 uh biden or whatever it was
10:05 - uh we were gonna do that i think
10:07 - something that's interesting is that
10:08 - like
10:09 - we could just keep digging deeper and
10:11 - deeper where
10:12 - our results from our initial idea were a
10:15 - little bit underwhelming and we felt
10:17 - inaccurate or like not
10:20 - not actually showing what these
10:21 - simulations are going on and so we uh
10:23 - well you
10:24 - uh dug deeper and found more discussions
10:27 - and so again
10:28 - abstracted away from the conversation
10:31 - about elections
10:32 - and forecasting and all this stuff i
10:34 - think this is a really common thing that
10:35 - happens in data science where
10:37 - basically you join a part of the
10:39 - community where sophie has really dug
10:41 - into this article
10:42 - really like read these discussions
10:44 - trying to understand what other people
10:46 - are talking about trying to replicate it
10:47 - herself
10:48 - which i think is a really cool
10:50 - demonstration of what it means to be a
10:52 - data scientist where you're able you're
10:53 - empowered to
10:54 - start with this thing that you kind of
10:56 - understand and slowly grow
10:58 - knowledge about it yeah no i think
11:02 - it's my favorite thing about the skills
11:04 - that i now have
11:06 - is that i i always have been the person
11:09 - that wants to understand things and like
11:11 - asks a million questions until i feel
11:12 - like i have a grasp on it
11:14 - um and so this is a fun way to be able
11:17 - to do that
11:19 - okay so i'm gonna actually go to this
11:21 - file you can
11:22 - see um it's like it's if you just
11:26 - take lop off this last part of the
11:30 - um of this it just brings me back to the
11:32 - map um
11:33 - the simulation map so it's
11:36 - if you take a closer look you can see
11:38 - that it is what is generating this map
11:42 - um but we can go to this file
11:45 - and i'm actually going to demonstrate
11:46 - this full process because i just think
11:48 - it's useful
11:49 - um so i'm going to go ahead and i'm
11:51 - going to say file
11:54 - save i think save page as yup
11:57 - json um simmed maps for right now i'm
12:01 - actually gonna just save it
12:02 - to my desktop um i'll i'll show you in a
12:05 - minute what i'm gonna do with this
12:07 - um okay so we have it saved
12:11 - as a json file
12:14 - and i'm going to close this because it
12:16 - makes my computer
12:18 - fan start going um and now i'm going to
12:22 - just kind of demonstrate uh how i would
12:25 - open this file in r and r studio
12:29 - um i so i use rstudio our studio is
12:31 - basically like
12:33 - a some software that allows you to run
12:36 - our code and allows you to see output
12:37 - from that r code
12:38 - in a way that's simpler um
12:42 - and so what i'm going to do is i'm going
12:43 - to open
12:45 - r and
12:49 - hopefully you guys can all see oops
12:52 - um so it's it's actually opening me up
12:54 - into a file that i was working in before
12:57 - but if you've never used our studio
12:59 - before or if you're working in somewhere
13:01 - else it'll open up
13:02 - to whatever you were most recently using
13:05 - um and what i like to do whenever i'm
13:07 - working on
13:08 - a new kind of set a new project is i
13:11 - like to
13:12 - create a project um which just makes it
13:14 - easier to read in data
13:16 - um without having to use like all of the
13:20 - uh without having to like say exactly
13:24 - where that data exists on your computer
13:27 - um so what i'm gonna do is
13:29 - file new project um i'm gonna create a
13:33 - new directory
13:34 - because i don't have one to dump stuff
13:37 - in yet
13:38 - um i'm going to say new project and then
13:41 - i am going to create uh
13:44 - an election live
13:48 - stream folder
13:53 - i am going to just put this on my
13:56 - desktop
14:00 - and i'm gonna press create project and
14:03 - it's gonna switch me over
14:05 - now to this new project
14:08 - in um in our studio and now i can dump
14:12 - any files that i want into this folder
14:15 - and then it
14:17 - r will all or our studio will know that
14:19 - like i'm just working out of this folder
14:22 - so anything that i put in this folder
14:23 - is something that i might want to use
14:27 - um okay so i'm gonna open up a new
14:30 - finder window
14:31 - you can see whoop you can see that
14:35 - this folder that i made is just a folder
14:38 - on my
14:39 - this project that i made there's a
14:41 - folder on my desktop
14:43 - and i'm going to move this json file
14:46 - into it whoops sorry
14:51 - um i'm having issues with
14:56 - my
14:58 - sorry i'm gonna
15:02 - go to this i don't know why it's doing
15:05 - that
15:10 - sorry one more
15:14 - do you know i did this earlier yeah um
15:17 - maybe it's because it's open
15:18 - in uh original studio like you want to
15:21 - close your visual studio uh
15:23 - it's not open um
15:26 - um i don't know okay let me
15:29 - let me try this one more time
15:34 - i'm just having like
15:38 - you can you can always also use your uh
15:40 - the other project that you have set up
15:42 - and
15:42 - uh i think it has to do
15:47 - i'm sorry guys uh i think it has to do
15:50 - with my like
15:51 - dual desktop situation going on here
15:56 - so i'm gonna go ahead and
16:07 - why
16:11 - here maybe uh maybe you can stop sharing
16:14 - your screen for a sec
16:15 - and then uh i think i might have
16:20 - it like
16:23 - well what i'm going to do actually is
16:32 - just drop it in there um
16:35 - file save pages
16:38 - and then i'm just gonna put it into
16:43 - that the folder
16:46 - um hopefully this won't happen to you
16:50 - oh and rename it yeah there you go okay
16:56 - there we go and now we can pull this
16:59 - back
17:00 - okay well basically all i was trying to
17:03 - show
17:04 - is that uh if you put that file into
17:07 - this
17:08 - folder that we're you're working in then
17:11 - you'll
17:11 - you can see it even in our studio in
17:13 - that um
17:15 - in that little file area and now i'm
17:18 - going to
17:19 - create a new file in here i'm going to
17:22 - make
17:22 - it an r script i'll just save it
17:26 - as demo
17:30 - you'll see it's down here and now i can
17:32 - start writing some code
17:34 - um so the first thing that you'll need
17:38 - to do
17:38 - is read in this data um and in order to
17:42 - read it in we actually need a library
17:44 - called our json so what i'm going to do
17:47 - is
17:48 - quickly so if you've never installed
17:51 - um if you never installed our json
17:54 - in r the first thing you would need to
17:57 - do is do
17:58 - install.packages um and then
18:01 - rjson in quotes and you could run that
18:05 - and this is called the console so this
18:07 - is where you can run code
18:08 - um and that will install it if you
18:12 - are on the internet
18:15 - um but if you've already installed the
18:18 - package you can load it
18:19 - using the library command um so i'm
18:22 - going to go ahead
18:23 - and load that file
18:27 - and then um
18:30 - i'm gonna go ahead and load this data so
18:33 - i'm gonna call
18:34 - it sim maps
18:39 - um and i'm gonna say
18:42 - from json
18:46 - and then the file name is
18:49 - simmed maps
18:54 - sophie when you have a sex you want to
18:55 - go over your browser and close that uh
18:58 - that giant tab that's making your
18:59 - computer work can you hear it
19:02 - uh i can't i can't tell if i can hear it
19:04 - exactly but
19:05 - uh audio quality seemed like it got a
19:07 - little bit worse yeah just close that
19:09 - tab and hopefully it'll get better
19:11 - oh yeah that file like stress that's
19:14 - huge
19:15 - um okay so
19:19 - we've got this and then whoops
19:22 - sinned
19:29 - do you see what's wrong with this let's
19:31 - see uh
19:32 - sorry i was talking in chat no you're
19:34 - good
19:36 - zoomed maps
19:41 - oh that worked okay cool
19:45 - um all right so now i'm gonna just so i
19:47 - have
19:48 - lo uploaded this file um from
19:52 - here from my desktop or from this folder
19:56 - and i've saved it as something called
19:58 - sim
19:59 - underscore maps and now what i want to
20:01 - do is
20:02 - just take a look at what this object
20:06 - is um and so just you'll notice that i'm
20:10 - writing code up here i'm saving that
20:12 - code
20:13 - but i can also run code at the bottom
20:17 - here
20:18 - i can save code up here and then run it
20:20 - all at once or i can just write like one
20:22 - line
20:23 - at a time down here um cool
20:27 - so what i'm gonna do is first take a
20:30 - look at sim maps
20:32 - and one of the nice things about rstudio
20:34 - is that
20:35 - if you use this dollar sign operator
20:38 - it'll tell you what is contained in
20:42 - this like object um and so i see that
20:44 - there's something called states
20:46 - in here which i can print out and i see
20:49 - that these are
20:50 - the state codes i also notice
20:53 - when i look at this that there are some
20:56 - interesting state codes in here which
20:58 - you might be able to guess if you've
21:00 - done some election
21:03 - or if you've done some research you
21:04 - might be able to guess what these are
21:06 - but you'll see there's an n1n2 and
21:08 - n3 and then there's also an m1
21:11 - and an m2 um and so those are
21:15 - those are the like i don't know exactly
21:18 - what they're called but basically
21:20 - in nebraska and i think maine um you
21:24 - they split out the electoral votes into
21:27 - different regions and then the state
21:30 - itself
21:31 - also gets some electoral votes for the
21:33 - entire state
21:34 - um and so these are like the those
21:37 - separate
21:38 - regions that get their own electoral
21:41 - votes
21:41 - yeah this will be relevant later on when
21:43 - we start dealing with something that
21:45 - we're going to start having a bunch of
21:46 - numbers and there aren't 50 of them
21:48 - there are
21:48 - uh what 56 of them i think because of
21:50 - these extra
21:52 - nebraska ones and main ones in dc as
21:54 - well dc is in here as well
21:56 - um and then i'm going to just take a
21:59 - look at the other
22:00 - piece here so we've got sim maps
22:04 - maps and
22:07 - wow there's a lot in here
22:10 - let's take a look i'm actually gonna we
22:13 - see that this is a list
22:15 - um it's got a bunch of it's got
22:18 - basically 40 000 different
22:22 - sets of vectors within
22:25 - uh these like list headers so i'm
22:28 - actually just going to print out the
22:29 - first one
22:30 - because they think it's a little easier
22:31 - to see um so
22:33 - the way i'm going to do that is i'm
22:35 - going to just kind of call
22:36 - this like first this one is number 1000
22:40 - but the first one that got printed out
22:42 - would be number one
22:43 - i'm just gonna print that out and then
22:45 - i'm gonna print the states
22:48 - along with it
22:52 - so that we can see them um and so
22:56 - it looks like so these map these lists
22:59 - within the maps
23:00 - they are um they are longer than
23:04 - the states lists and it looks like
23:08 - they're all starting if you kind of look
23:10 - back at this
23:11 - they all start with three numbers um
23:14 - that kind of follow a similar pattern so
23:17 - it's first either a one or a zero
23:20 - um and then there's numbers like
23:23 - 187 and 351 or 302 and 236.
23:27 - um and so just maybe by
23:31 - guessing uh i you can probably
23:35 - tell that these are um these are the
23:38 - number of electoral votes for each of
23:40 - the candidates and then
23:41 - this one or zero um if you dig a little
23:44 - deeper you can figure out that this is
23:46 - like a one
23:47 - if trump one and a zero if um biden won
23:51 - and then uh it goes i
23:54 - i guess trump electoral votes and then
23:56 - buy in electoral votes
23:58 - for each simulation separately and then
24:02 - it gives numbers for each of the states
24:06 - um and those numbers you'll notice
24:08 - there's like positive and negative
24:10 - numbers so that's
24:11 - not the share of or it's not the um the
24:14 - share of the vote
24:15 - but rather the margin um
24:18 - so like how much one candidate beat
24:22 - the other by so if it says
24:25 - 1.12 this is like
24:29 - trump won this state by 1.12 percentage
24:33 - points
24:34 - and you can figure out that it's trump
24:37 - won the state by
24:38 - 1.12 percentage points by taking a look
24:41 - at like a state that you kind of know
24:43 - like
24:44 - uh wyoming right is like
24:47 - clearly a positive number versus i don't
24:51 - know what's another one that's easy to
24:52 - find
24:53 - that would be democratic so california
24:56 - is probably one of those first big
24:57 - negatives it's probably about negative
24:58 - 37.
25:00 - so like one two three four five in
25:03 - one two three four five and is this
25:06 - negative
25:07 - 37 so that means that in this forecast
25:10 - and
25:10 - in most of them right like it's always a
25:13 - bigger negative
25:14 - number and that would suggest that
25:16 - that's like how much
25:19 - trump would lose by in that simulated
25:22 - election
25:22 - so basically yeah so basically each of
25:25 - these like 1000 or 40
25:27 - 000 i mean um lists is like a simulated
25:31 - election
25:32 - um that's being used to generate the map
25:35 - that you see on 538
25:36 - yeah one of the things i think is cool
25:38 - about this is again this was kind of a
25:41 - instance of you having to like interact
25:43 - with the community follow along in that
25:45 - blog post i know you were reading the
25:46 - comments on that blog post a lot
25:48 - um this data the explanation of the data
25:52 - isn't immediately obvious right it took
25:54 - a little bit of investigation to figure
25:56 - out what's going on and i imagine that
25:58 - um you know people in the community are
26:00 - helpful in in terms of
26:02 - doing that sort of stuff um often times
26:04 - you'll encounter data where
26:05 - things are a little bit more spelled out
26:07 - where they'll give you descriptions of
26:08 - the data that sort of stuff but
26:09 - sometimes
26:10 - you come across data like this where
26:12 - it's like you kind of have to deduce
26:13 - what's going on a little bit
26:15 - yeah totally um okay
26:18 - so what i'm gonna do now is because this
26:21 - is
26:22 - currently in like a kind of tough uh
26:26 - this this format is not the easiest
26:29 - format to parse
26:30 - if you're trying to like look at things
26:33 - more easily so
26:34 - what i'm going to actually do is i'm
26:36 - going to convert all of these separate
26:38 - lists
26:38 - into basically one big array um and i'm
26:42 - using i'm gonna use andrew gelman's code
26:45 - because
26:46 - he just did it and already and
26:51 - it makes it very very easy um
26:54 - so i'm gonna pull this over and then
26:56 - i'll walk through what the code is doing
26:59 - um i guess i called this something else
27:02 - so
27:03 - naps um okay so basically
27:07 - this first uh line of code all we're
27:10 - doing here is we're just saving the
27:11 - states separately
27:13 - so um remember we when we pulled out the
27:15 - states
27:16 - that's this is what we got now we're
27:18 - just saving it as something called
27:20 - states so that we can pull that out um
27:23 - the next thing
27:27 - is that uh we're we're taking
27:31 - we're gonna make this um this array
27:34 - the same length as the number of
27:36 - simulations that 538 ran
27:38 - um and so you'll see this is just 40 000
27:43 - um this length right so we could have
27:46 - just said n sims is equal to 40
27:48 - 000 because we know they ran it 40 000
27:50 - times but this makes it a little
27:51 - more reproducible if they change this
27:53 - data and they decided to do it
27:55 - 50 000 times then we could still
27:58 - download this data set
27:59 - the same way and our code would still
28:01 - work
28:02 - um so we're saving nsims is the number
28:06 - of simulations that's 40 000.
28:09 - and then we're gonna create this empty
28:12 - array
28:13 - um so all this is doing is it's
28:16 - basically filling an array with n a's
28:20 - and that array is going to have 40 000
28:23 - rows and it's going to have 59 columns
28:26 - the reason we want it to have 59 columns
28:28 - is just
28:29 - that um there are 59
28:32 - numbers in each of these like list
28:35 - elements
28:37 - um and again those numbers are the three
28:40 - kind of like markers where the first one
28:42 - is who won it's either one or a zero
28:44 - and then the two uh electoral votes and
28:47 - then the
28:48 - 56 states or you know uh nebraska has
28:51 - four of them
28:52 - uh because of how that works so so it
28:54 - all adds up to 59 total
28:56 - right and now so if i run this oops
29:01 - i guess i didn't run this i'm using
29:03 - command return by the way to run each
29:05 - thing
29:05 - you can um also just press run and
29:08 - you'll see it like copies it down into
29:09 - the console
29:11 - um so you can see that it ran um
29:14 - okay cool so i'm just gonna now show you
29:16 - what this looks like
29:17 - so sims um we'll do just like the first
29:21 - 50 rows um is really
29:25 - or that's hard to read but basically i
29:28 - just made this
29:29 - uh this array it's got
29:32 - columns where there's no name for the
29:35 - first
29:35 - column then it says trump biden and then
29:38 - it's got all the states
29:40 - um uh
29:43 - as the rest of the state codes as the
29:45 - rest of the column names in here
29:47 - yeah so what we're really doing here is
29:49 - we're just kind of like organizing our
29:50 - code
29:51 - would you say this is data cleaning or
29:53 - data
29:54 - like um pre-processing i guess where
29:56 - before
29:57 - we had yeah before when we had um
30:01 - like the list of states and then the um
30:04 - just the list of numbers without any
30:06 - like matching to them now we're kind of
30:07 - combining them
30:08 - so later on in our code we can say
30:10 - things like okay get me the
30:12 - uh give me the number associated with
30:13 - florida from the first um
30:15 - from the first simulation or get me
30:17 - every single simulation from
30:19 - the numbers from every single simulation
30:20 - from florida and it's gonna be a lot
30:22 - easier to do that now that we've
30:23 - associated the names with the numbers
30:25 - yeah exactly um so we've created this
30:29 - empty array
30:30 - and now basically all this code is doing
30:32 - is filling it in so we're saying for
30:33 - every row
30:34 - just take the list from um
30:38 - from that like initial maps data take
30:41 - the list
30:41 - and fill it in as a row in this array
30:44 - so once we run this
30:48 - now we'll see that if we look at um
30:51 - sims one to we'll do like one to ten now
30:56 - um we it's just filled out
30:59 - it's basically one big array where
31:02 - each row is one um one election
31:05 - simulation
31:07 - and uh there will be 40 000 rows in this
31:10 - i've just printed the first 10.
31:12 - nice cool um okay so now we've got this
31:16 - thing called
31:17 - sims that is a little bit easier to work
31:21 - with
31:21 - um one other thing that i'd like to do
31:25 - is i probably just want to pull out
31:28 - like these first three columns are maybe
31:30 - not as useful
31:32 - as the first as the rest of them or at
31:34 - least what we're going to be looking at
31:36 - um is just the the state column so what
31:39 - i'm going to do is actually just pull
31:41 - those out
31:42 - so i'll make a new um
31:46 - a new array where i just say okay i want
31:49 - the simulations
31:50 - um but i just want the columns
31:54 - and i wrote down before uh
31:59 - yeah so four
32:03 - through 59 yeah that makes sense right
32:05 - so we're cutting off the first three
32:06 - columns
32:08 - right okay
32:11 - i think and that and that comma
32:14 - beforehand uh so i'm
32:15 - i'm not a huge r person i do much more
32:17 - python that comma beforehand is just
32:18 - saying
32:19 - i want every row and then the comma says
32:21 - okay i've got every row
32:23 - what which columns do i want um and we
32:25 - want yeah the syntax is like
32:27 - square brackets rows and then columns so
32:30 - you can say like
32:31 - if i did 1 to
32:35 - 20 then i would get like the first 20
32:37 - rows
32:38 - um and those columns since i want all
32:41 - the columns i just leave it
32:42 - or all the rows i just leave it blank
32:44 - that syntax really tripped me up at
32:46 - first i hated seeing like that floating
32:47 - comma
32:48 - i feel like this compared to
32:51 - well we don't have to get into our
32:53 - discussion about python versus
32:56 - i feel like this is so much easier now
32:59 - that i understand it i get it but you
33:00 - know
33:02 - just coming from python it looked very
33:03 - strange
33:05 - i see some people in the chat like our
33:07 - snap's the best and then python
33:09 - slab it's growing on me i realized when
33:11 - i started
33:12 - doing this i kept using uh like python
33:15 - syntax
33:16 - and i was like oh god i've been working
33:18 - with python for too long
33:20 - losing my r skills um okay so
33:24 - now we've got all of our state
33:25 - simulations and now we can start taking
33:27 - a look at them
33:28 - um and so i think like the one of the
33:30 - first things that's
33:32 - interesting to take a look at is just
33:34 - the distribution
33:36 - of margins um for a particular state
33:40 - so um for example
33:43 - like i think when we were first looking
33:46 - at this when we started
33:47 - on the map we were looking at
33:49 - pennsylvania
33:51 - so i'm going to start with with pen well
33:54 - yeah i'm going to start with
33:55 - pennsylvania
33:56 - um and so we can also take a request
33:58 - from chat as well so we can also take a
34:00 - look
34:01 - but um and so the histogram function
34:04 - is the easiest way to do this um and
34:07 - what i'm going to
34:08 - do is i'm going to take the state sims
34:12 - and then i want um i want just
34:15 - pennsylvania
34:16 - there's a couple of different ways i can
34:18 - do this um i think
34:20 - actually since this is not saved as a
34:22 - data frame we can't do that um
34:24 - but i can so like we said before
34:27 - use the square brackets now i want a
34:29 - single column
34:31 - right i just want the pennsylvania
34:33 - column that has all of these values just
34:35 - for pennsylvania all these um
34:38 - these marginal like win percentages
34:42 - uh and i can uh
34:46 - just say i want um
34:51 - okay yeah so again this is uh well two
34:54 - things one this is the same syntax we
34:56 - want all rows comma
34:57 - just pa um something i need this here
35:01 - actually
35:02 - you can if you wanted like different if
35:04 - you wanted a selection of them you could
35:06 - create a vector and say which ones you
35:08 - want yeah we could get pencil
35:09 - we could get pennsylvania pennsylvania
35:11 - and new york but if we just want one we
35:12 - don't have to put that there
35:14 - um the other thing that this shows is
35:16 - again the
35:17 - kind of value of us putting it in this
35:20 - organized table where
35:21 - if we didn't connect the table with the
35:23 - names we'd have to know like
35:24 - pennsylvania was like the 25th
35:25 - column or something but now we can just
35:27 - straight up ask for pa um
35:29 - which is really nice yeah totally
35:32 - okay so i get this histogram it's got
35:35 - some it's
35:36 - default things here are a little bit uh
35:39 - maybe not easy to read so what i'm going
35:41 - to do is just change some of those
35:43 - things
35:43 - so i'm going to say maine is
35:47 - trump margins in pa
35:51 - and i'm going to say xlab is
35:55 - trump margin um
36:00 - and um i also can
36:04 - color it something so i can do like call
36:07 - equals
36:08 - red um
36:12 - and that looks a little nicer um i can
36:14 - also just like
36:16 - open this up a little bit so you can see
36:17 - it a little better
36:19 - and what you see is this distribution
36:22 - so basically um let's
36:26 - let's remind ourselves about what we're
36:28 - plotting so across all the different
36:30 - simulations
36:31 - um trump is gonna win or lose
36:35 - by some number of percentage points
36:39 - and this is the distribution so this
36:41 - shows us
36:42 - how often different ranges of percentage
36:45 - points when
36:46 - percentage point wins or losses are
36:48 - occurring so um
36:49 - the highest bar here looks like it's
36:52 - around negative five
36:54 - so that means that the most common
36:56 - outcome
36:57 - across all these simulations is that
36:59 - trump is losing by five percentage
37:01 - points
37:02 - in um in pennsylvania and if you look
37:05 - at the polling um the polling averages
37:08 - in pennsylvania you'll see that
37:10 - um biden is ahead by about five
37:12 - percentage points on average so
37:14 - this is kind of like a polling average
37:17 - more or less
37:18 - like it's telling us um on average trump
37:22 - loses by about five points in
37:24 - pennsylvania meaning
37:25 - that biden wins by about five points in
37:27 - um
37:28 - in pennsylvania and then this
37:30 - distribution on either side of here is
37:32 - giving us a little
37:33 - more information about how much
37:37 - error we think
37:40 - might exist in the polls
37:43 - so if this is the if this is the
37:47 - distribution of simulated
37:49 - margins for trump across all these
37:51 - simulations it's kind of indicating that
37:53 - based on 538's model
37:55 - they think that the most like likely
37:58 - outcome is that
37:59 - biden wins by um five points
38:04 - but it that could be off by as much as
38:08 - about 15 percentage points so
38:11 - it's unlikely but trump could win
38:13 - pennsylvania by 10 percentage points
38:16 - or by five percentage points
38:20 - um it's also unlikely but possible that
38:23 - biden wins pennsylvania by 20
38:26 - percentage points on the other side um
38:29 - so zero would be a tie
38:31 - anything on this side anything to the
38:33 - left of zero would be
38:35 - a simulation where biden won and
38:37 - everything to the right of here would be
38:39 - a simulation where trump won
38:41 - yeah and i think one of the one of the
38:43 - main questions that i had when
38:45 - um i was going through this with you was
38:46 - like where do these numbers even come
38:48 - from and i know that we like digged into
38:50 - this
38:50 - a little bit but essentially that's like
38:52 - a little bit of the
38:54 - like real intense stat magic that's
38:57 - going on at
38:58 - um 538 is there different ways that they
39:00 - can like
39:01 - simulate 40 000 runs of the election to
39:04 - get these numbers
39:05 - for for each individual state yeah
39:08 - and i think the maybe
39:11 - i shouldn't call it an epiphany but the
39:13 - thing that
39:15 - this helps me understand and maybe it
39:17 - helps you understand too
39:19 - um if you're watching is that basically
39:23 - what's going on here when you're seeing
39:25 - percent
39:26 - chances or proportion of simulations
39:29 - where someone
39:30 - is winning it's basically like the
39:33 - proportion of this distribution
39:36 - that's less than or greater than zero so
39:39 - like if you
39:40 - calculate the proportion of this
39:42 - distribution that's like
39:43 - to the left of zero that's going to be
39:46 - on their website what they're saying is
39:49 - biden's probability or biden's chances
39:52 - of winning
39:54 - and this distribution is really
39:58 - like even if you read nate silver's
40:00 - comments on his model like
40:02 - he says that they predominantly in their
40:06 - modeling
40:06 - use um the polling averages and so
40:10 - essentially like this distribution what
40:13 - i can learn from it is like
40:15 - basically if you look at an individual
40:17 - state
40:18 - you'll see this distribution of margins
40:21 - where
40:22 - um where the most common one is going to
40:24 - be approximately what the polls are
40:26 - saying
40:27 - and then there's going to be some level
40:30 - of uncertainty
40:31 - and that uncertainty can we don't fully
40:34 - know
40:34 - like i think you can read what nate
40:37 - silver writes
40:38 - and you can kind of understand more
40:40 - about where that uncertainty comes in
40:42 - but basically it's like polling error
40:46 - like
40:47 - did we survey the right people did we
40:50 - wait
40:51 - like our observations appropriately
40:54 - based on like who's actually gonna show
40:56 - up to the polls like
40:57 - um are there other random factors that
41:00 - are gonna
41:01 - influence who comes out to the polls um
41:04 - and so this level and then some of the
41:08 - uncertainty
41:09 - i believe also comes from like how wrong
41:12 - polls have been in the past like
41:14 - it helps us understand like if we
41:18 - if we do this this polling how confident
41:21 - can we be that like
41:22 - the result of the polls or the result of
41:26 - an average of a bunch of polls is like
41:28 - accurately gonna tell us
41:31 - the outcome of the election and so
41:34 - this ra the randomness is more
41:36 - associated with our
41:38 - level of uncertainty about the polls
41:40 - than it is about like
41:41 - coming back to the coin flip like
41:44 - whether
41:45 - a coin comes up heads or tails which is
41:47 - like
41:48 - it could go either way every time you
41:51 - you do it
41:51 - right there's like no uncertainty with a
41:54 - coin flip it's like a known
41:56 - probability right um whereas with poles
41:59 - it's like we think that the the average
42:01 - is here and then there's some degree of
42:02 - uncertainty
42:04 - yeah i come back to the fact that you
42:05 - can't run the election multiple times
42:07 - but the uncertainty is coming from
42:09 - basically our uncertainty about our
42:12 - polls
42:14 - this is this is a question from from uh
42:18 - um which i think segues nicely into what
42:21 - we're probably going to go into next uh
42:22 - and you touched on it a little bit here
42:23 - does the data collected in surveys
42:25 - nicely represent the total set of those
42:27 - who ultimately vote
42:28 - i think that this is related to uh
42:31 - looking at the correlation between
42:32 - states
42:33 - and like how how yeah i think another so
42:37 - my advisor in graduate school taught an
42:40 - incredible class on
42:42 - um surveys and and
42:45 - actually like the way that polls work
42:48 - is that they're you're not just going
42:50 - out and surveying a bunch of people
42:52 - and saying like how many of those people
42:54 - said they'd vote for biden and how many
42:56 - of those people vote
42:56 - said they'd vote for trump there's also
42:58 - some like
43:00 - very complicated waiting that goes into
43:02 - that so like
43:03 - uh basically like
43:07 - if you only if you think on average like
43:12 - a certain number of hispanic women are
43:16 - gonna go
43:16 - out to vote but you only manage to
43:18 - survey
43:19 - like a smaller proportion then you're
43:21 - gonna upweight
43:23 - all of those observations to try to like
43:26 - match the demographics of who you think
43:29 - is is gonna vote
43:30 - so um so yeah so there's a lot of
43:34 - complicated like waiting and math that
43:36 - goes into
43:37 - not just taking not just surveying
43:39 - people but like figuring out
43:41 - who are the people who are most likely
43:42 - to vote and how can we appropriately
43:44 - weight our sample in order to
43:46 - know or in order to more accurately
43:50 - guess how like our
43:52 - our survey relates to what's actually
43:54 - going to happen
43:55 - thanks um so the
43:59 - so there's some uncertainty here the
44:01 - other thing that i showed you guys when
44:03 - we were clicking around on the map
44:05 - is that when you click on one state and
44:07 - you say okay
44:08 - um pennsylvania is going to go blue
44:11 - or pennsylvania is going to go red then
44:13 - you saw that the
44:14 - other states are changing
44:18 - or the probabilities and the other
44:19 - states are changing and so there's some
44:21 - there's something going on where
44:23 - the outcome in one state is predictive
44:26 - of the outcome in another state
44:28 - um and so one of the things that andrew
44:32 - gellman does in his blog and
44:35 - for a different reason but it's super
44:37 - interesting to do
44:39 - is he starts looking at kind of like a a
44:42 - scatter plot basically
44:43 - of one state versus another
44:46 - so i'm going to do that let's say i want
44:48 - to plot um
44:50 - we're going to do
44:53 - pa versus
44:56 - florida
45:02 - and i just know from experience
45:05 - i'll plot this for you because i think
45:07 - it's like useful to see
45:09 - um it's going to take a second uh that
45:12 - it by default it uses these like circles
45:15 - that
45:15 - are not great so you can change that i
45:18 - think i had pch
45:19 - equal 20.
45:23 - um
45:26 - try it
45:30 - and you can change around just like
45:34 - before
45:35 - um you can change the
45:39 - uh the x and the y labels to make them
45:41 - easier to see
45:42 - so the x label is gonna be
45:46 - um pa margins
45:50 - um and the y label is gonna be
45:54 - florida margins
45:58 - oh my computer is making sounds again
46:01 - it's all right it's working hard
46:03 - oh well now
46:06 - my ocd is kicking in um okay i will
46:09 - rerun it
46:10 - um and you'll notice that there's kind
46:13 - of this relationship right like you can
46:15 - kind of draw like a positively sloped
46:17 - line through here
46:19 - so um you'll remember from before when
46:21 - we looked at just
46:22 - pennsylvania um those
46:25 - we kind of saw that histogram that like
46:28 - the
46:29 - trump margins range from negative 25
46:32 - to up to like a little above 10
46:35 - positive 10. um and then florida looks
46:38 - like the predictions are ranging from
46:41 - negative 25 to positive 30 almost
46:45 - um and so
46:48 - i see a question how do we know that
46:50 - this is trump margins for pennsylvania
46:52 - that's related to how we how we
46:56 - structured this data set um but
46:59 - basically i'm just
47:00 - once we pulled out uh each of these
47:03 - so we set up this this array with each
47:07 - of these as each of these states as
47:08 - columns um
47:10 - now i can just pull out and plot the
47:12 - pennsylvania column against the florida
47:14 - column and that's what this code is
47:16 - doing
47:16 - yeah and going back to that question of
47:18 - like how do you know what this data is
47:19 - actually
47:20 - doing again that's like part of the
47:21 - discussion all of these blog posts um
47:24 - yeah and you can kind of verify it for
47:25 - yourself where you can look at the
47:27 - numbers for
47:28 - a state that's likely to go trump or
47:30 - biden we did with wyoming you can see
47:32 - the wyoming numbers are all
47:33 - very positive you can see the um
47:37 - vermont uh numbers which um probably is
47:39 - probably a
47:40 - uh biden state all very negative so you
47:42 - can kind of extrapolate from there that
47:44 - positive is a trump margin um a negative
47:46 - is a vitamin margin
47:47 - right yeah exactly um yeah so
47:51 - i think it's interesting to kind of take
47:53 - a look at we see this relationship
47:55 - um and and basically what that tells me
47:58 - is
47:58 - right if if it turns out that
48:01 - pennsylvania
48:03 - um loses by or that
48:06 - sorry that in pennsylvania biden wins by
48:10 - 20
48:10 - percentage points so trump loses by 20
48:12 - percentage points
48:13 - then more in more of the simulations
48:17 - we have that florida had a similar
48:19 - result that like
48:20 - biden also won by 20 percentage points
48:22 - in florida if that happened
48:24 - and on the reverse side if trump wins by
48:26 - 10 percentage points over here
48:28 - then um then it looks like more of the
48:32 - more of these points are up in this
48:33 - corner right where in florida there was
48:36 - a similar
48:37 - margin for trump and so
48:40 - the question is and like the question
48:42 - that i ask myself when i look at this is
48:45 - why is that um and i think
48:48 - a lot of it having listened to podcasts
48:51 - and
48:51 - and read a bunch of blog posts a lot of
48:53 - it is basically because
48:56 - if we're wrong in the polls in one state
49:00 - then we're likely to be similarly wrong
49:03 - with our polling in other states um and
49:06 - so it's basically like
49:08 - if our if our polls are skewed towards
49:11 - biden
49:12 - in one state then they're more likely to
49:14 - be skewed towards biden
49:16 - in another state and vice versa do we
49:19 - want to show that
49:20 - weird example that we saw when we were
49:21 - playing around with this or is that just
49:22 - like too
49:23 - hard to explain i think we looked at
49:25 - california and wyoming where they were
49:26 - negatively correlated
49:28 - yeah i mean i don't have a good answer
49:31 - for it but
49:32 - i think that uh
49:35 - i think that this is like another
49:37 - example of how you could like play with
49:38 - this yourself
49:40 - so we can show it um
49:45 - so if you look at california and wyoming
49:51 - we see this like negative correlation
49:54 - showing up um
49:57 - i i honestly don't have a
50:01 - good explanation for why
50:04 - this happens but maybe if i read more i
50:06 - can understand it
50:08 - yeah i mean what this graph is saying is
50:10 - that if
50:11 - california goes to trump which is on the
50:13 - right side of the uh
50:15 - of the image then that means that
50:17 - wyoming will
50:19 - be more likely to go biden because
50:21 - that's on the lower half of the image
50:22 - and that's like completely reverse of
50:23 - what you would expect obviously
50:25 - most of the data is in the top left
50:26 - corner of california going to biden
50:28 - wyoming going to trump but yeah they
50:30 - have this inverse correlation which
50:32 - uh i was confused by as well
50:36 - yeah i'm sure there is an explanation
50:40 - um okay
50:43 - uh okay we're running a little bit low
50:45 - on time
50:47 - uh but i think that at this point it
50:50 - would be fun to
50:51 - look at some maps um i think a fun thing
50:55 - to do
50:55 - is kind of inspect how this correlation
50:58 - plays out
50:59 - uh by looking at a map um and so
51:02 - i'm actually gonna grab i'm gonna grab
51:05 - some code that i wrote prior to this
51:08 - um and it's gonna look a little bit
51:10 - complicated
51:12 - um but
51:17 - it's probably unnecessarily complicated
51:20 - this is
51:21 - this is uh me
51:24 - not liking using built-in functions
51:28 - um is really what's going on um so
51:31 - basically i wanted to plot a map
51:35 - of the us and you can do that with shape
51:38 - files which you can find on like
51:40 - census.gov
51:42 - but when i was doing that the scale
51:45 - was really off like because you have
51:47 - hawaii and alaska
51:49 - and you want you don't want those to be
51:51 - in their actual locations
51:53 - um the shape file that they had on
51:56 - on the census website had had it
52:00 - to scale and so everything was really
52:02 - tiny
52:03 - and so then in google searching um
52:07 - i found this this package called usmap
52:10 - in r that you can use to easily
52:13 - simulate or to easily generate us maps
52:17 - um but then it wasn't giving me enough
52:20 - uh i couldn't like
52:24 - put the labels i wanted or what like i
52:27 - couldn't ha
52:27 - i didn't have enough control over the
52:29 - inputs to their function
52:31 - and so instead of just using their
52:33 - function
52:34 - i pulled out their data um
52:38 - and this map will take an understanding
52:40 - of uh
52:43 - of what the number correlation is we're
52:45 - going to have numbers between zero and
52:46 - one here
52:47 - um let's see oh you need a oh
52:51 - oh that's fine i don't need this
52:54 - this was for something else
52:59 - ignore ignore all the red
53:02 - i know it's stressful but ignore it
53:06 - okay so what i'm gonna go ahead and do
53:12 - is grab this
53:18 - um okay so basically what i'm doing here
53:22 - and i'll try to talk through it quickly
53:24 - is i'm taking the correlation so this
53:27 - core function
53:28 - will will give me the
53:32 - correlations between um
53:38 - between pennsylvania and
53:41 - other states so this
53:45 - gives me the correlation between
53:47 - pennsylvania and all of the other states
53:50 - the correlation is just basically a
53:52 - measure of how strong this relationship
53:54 - is so this is going to be a negative
53:56 - correlation
53:57 - if it was in just like a straight line
54:00 - um the correlation would be one
54:02 - so if we if we do the correlation of
54:04 - like california against california
54:06 - um we can even see it in that print out
54:09 - actually
54:10 - if you scroll down a little bit we can
54:11 - see the correlation of pennsylvania to
54:13 - pennsylvania somewhere in there
54:16 - there it is left second one yeah
54:20 - and then the larger the number the
54:23 - stronger this association is the
54:25 - the more clumped those points would be
54:27 - around a line
54:28 - the smaller the correlation so the
54:30 - closer to zero
54:31 - um the more dispersed these points would
54:34 - be there would be no real relationship
54:37 - um and if it's positive it's going to be
54:39 - a positive slope
54:40 - and if it's negative it's going to be a
54:42 - negative slope
54:44 - this is a lot we're building some new
54:45 - content though uh
54:47 - explaining all this
54:50 - year and i'm very yeah about it so
54:54 - so you'll be able to learn more once
54:56 - that is
54:57 - uh once that exists um okay
55:00 - i'm just gonna go ahead and you should
55:03 - we you should make this the the project
55:04 - of uh of that course
55:06 - ooh maybe that's actually not a bad idea
55:10 - um okay so we can see this i made this
55:13 - map
55:13 - um and so this is giving us the
55:16 - correlations between pennsylvania
55:19 - and every other state um and so
55:21 - basically you can see
55:22 - obviously pennsylvania is dark blue
55:24 - because it has a high correlation with
55:26 - itself
55:27 - but now we can see based on 538's model
55:29 - like
55:30 - if pennsylvania changes if the if we
55:34 - lock in pennsylvania as like red or we
55:36 - lock in pennsylvania as blue
55:38 - you can see which other states um
55:41 - are most are gonna have their
55:44 - probability
55:45 - of or their chances of going towards
55:47 - biden or trump
55:49 - change the most drastically so the
55:50 - darker colors are going to change the
55:52 - most drastically when
55:53 - pennsylvania changes and the lighter
55:55 - colors are going to change the least
55:57 - drastically so
55:58 - it looks like for example the whatever
56:01 - happens in pennsylvania based on this
56:03 - isn't really gonna change what we think
56:06 - happens in california
56:08 - or is this what a state is this
56:11 - that's uh alabama alabama sorry
56:15 - i need to like learn my learn my states
56:17 - again
56:18 - um but then you'll see you know other
56:21 - states nearby
56:22 - that are kind of like mississippi not
56:26 - alabama mississippi
56:29 - yeah mississippi alabama georgia got it
56:32 - i used to like say that in my head when
56:34 - you know when you were younger and you
56:35 - had to take those like
56:37 - i don't know if you had to do this take
56:38 - like quizzes where you need to fill in
56:40 - all the
56:41 - state capitals yeah um we have a
56:44 - question in the chat
56:45 - or a comment in your chat all of your
56:46 - correlations are positive do you want to
56:48 - speak to that
56:50 - yeah so in this in this simulation
56:54 - um all of the correlations with
56:56 - pennsylvania
56:57 - came out to be positive um i think
57:00 - most of the most of the correlations
57:04 - are coming out positive in this um
57:07 - in 538 like simulations just because
57:11 - i think it makes more sense for um
57:15 - for information like if your polls are
57:18 - wrong in a particular direction
57:20 - in a given state it makes more sense to
57:22 - me that your polls
57:24 - are wrong in the same direction in
57:26 - similar states it makes less sense to me
57:29 - um but again i'm not an expert and i'm
57:32 - sure there's a
57:32 - there is an explanation that like if
57:34 - your polls are favoring biden in one
57:37 - state that we think that like the polls
57:39 - are
57:39 - then more likely to favor trump than
57:41 - another state
57:43 - if we throw in uh i don't know how easy
57:45 - it is for you to change pennsylvania to
57:46 - california
57:47 - if you can throw in california there we
57:50 - might be able to see
57:52 - again there's that there was that weird
57:53 - negative correlation with wyoming so
57:55 - we might be able to see a negative
57:57 - correlation there
57:58 - um um to california
58:02 - yeah california yeah between california
58:04 - and uh
58:06 - and wyoming in particular it looked
58:07 - negative um i'll just do this
58:09 - i'm going to save it as core pa anyway
58:12 - but it's the new
58:13 - data
58:17 - why did that correlation not found
58:22 - did i not on this
58:27 - there we go there we go um yeah so now
58:30 - we see the scale
58:31 - runs into the negatives so california is
58:34 - negatively correlated with a lot of the
58:36 - south
58:36 - uh wyoming south dakota
58:40 - interesting yeah i really so this is
58:43 - like another
58:45 - uh this is another thing that
58:48 - i'm probably gonna spend more time
58:51 - uh trying to figure out and i think it's
58:53 - something that
58:54 - if you're interested like i very much
58:56 - encourage you to
58:58 - think about and explore yourself um and
59:01 - all of the
59:02 - all of the code to generate these maps
59:04 - and everything
59:05 - like alex said is available to you um
59:08 - if you want to just download my code and
59:11 - um and run it and then change it however
59:14 - you find interesting yeah in the in the
59:16 - youtube description there's a link
59:18 - uh that will download a zip file and
59:19 - then that's all of so please code that
59:21 - you can play around with
59:23 - awesome we are right at six o'clock
59:26 - so i think this is
59:29 - maybe a good time to wrap up is there
59:32 - anything else you want to
59:34 - shadow i don't think so uh this was
59:37 - super cool i love doing this kind of
59:38 - stuff i would love to do
59:39 - more things like this on codecademy um
59:42 - we can stall here for a little bit
59:44 - to see if people have questions i think
59:46 - we can probably hang out for like five
59:47 - minutes to
59:48 - answer some uh some last minute
59:50 - questions i see one from andrew right
59:52 - now
59:53 - um so yeah
59:56 - basically is there any historical data
59:58 - for if poems are wrong in one direction
59:59 - they're wrong everywhere in one
60:01 - direction
60:02 - so like i said i'm not an expert so i
60:05 - don't
60:06 - really know but i assume
60:09 - yes i i assume that if
60:12 - all of these simulations and and all of
60:15 - them
60:16 - have this kind of like correlation
60:18 - between states
60:20 - or all the ones that i've looked into um
60:22 - i'm assuming that that's because
60:25 - of historical data right and yeah and
60:28 - again
60:28 - the the data that we're using here are
60:30 - the 538
60:32 - for uh 40 000 simulations of this
60:35 - election
60:35 - but the way that that data is generated
60:37 - is probably through some combination of
60:39 - historical data and current pollings and
60:41 - all that sort of stuff
60:44 - thanks jamie and morgan oh
60:47 - morgan is content contributor extort
60:51 - extraordinaire for the data science team
60:55 - um what was uh yeah uh
60:58 - taku says what is the lowest and highest
61:00 - correlation for california with other
61:02 - states i mean we can look at that right
61:03 - now right it seems like
61:04 - california is very highly correlated
61:06 - with washington colorado
61:08 - new mexico new york and pretty low uh
61:11 - lowly or
61:12 - negatively correlated uh with alabama
61:15 - mississippi tennessee
61:16 - arkansas uh yeah with correlation
61:20 - too it's about absolute value when we're
61:22 - talking about like how strong the
61:24 - relationship is but it looks like
61:26 - none of these negative correlations are
61:28 - really getting below
61:29 - none of them are getting to like
61:32 - negative 0.5 because that's not even on
61:34 - the scale so
61:35 - i would assume that these are pretty
61:37 - weak negative correlations and then
61:38 - we've got
61:40 - um all of the kind of light purple ones
61:43 - um are the kind of weekly
61:46 - positive ones cool
61:50 - awesome awesome um yeah in finishing up
61:53 - i think
61:54 - uh i at least would encourage people to
61:56 - go vote wherever you are
61:57 - um it's uh we're glad that we were able
62:00 - to get this in before election day just
62:01 - so we could
62:02 - show some data encourage people to vote
62:04 - um thanks for running this sophie this
62:06 - was super super cool
62:07 - i'm very impressed
62:10 - thank you awesome well
62:14 - have a good night

Cleaned transcript:

loading just wait a little bit i can never tell when it's like even actually going all the way through loading it sometimes makes us be live so yeah we'll just hang out here for a second until we actually confirm that we're live i think we probably are but we'll see okay cool we are live so if you want to go ahead and get started whenever you're ready sure yeah welcome everybody i'm super excited to be here um i'm sophie this is my coworker alex and we are both curriculum developers at codecademy and we're both uh working on data science content a fair amount on the site so we've been working on our own data science projects for a while and um and asking our own data science related questions and um one of the things that we were working on for the last week or so is digging into some of the 538 data and we thought we would share all that work with you guys so um feel free to say hello in the chat i think we're live on youtube and twitter i think or twitter yeah okay well we're live on a few different platforms but we are going to um be monitoring the youtube chat so i have that open um feel free to say hi feel free to say where you're calling or you're watching from it's always fun to see where everybody is at um and if you have any questions or you want us to stop and like discuss anything um feel free to mention that in the chat as well um yeah i i'm really excited for this one if you haven't been following our youtube channel very much we've been doing these live stream series kind of teaching lessons on codecademy uh we just finished a series teaching introduction coding topics and so we're kind of looking for the next live stream thing to do and uh last week sophie was telling me you were like looking around at 538 data and we felt like it would be a a fun quick little oneoff stream to do so um sophie i'm like blown away by uh the lesson that that you prepared maybe i don't want to set expectations too high but i'm super excited too to go through this stuff yeah so uh i think the first caveat that we just want to share with everybody is that uh neither of us are election forecasting experts um we both are people that like asking questions and trying to understand things um and like you know and we both like to try to understand things through code and so um for me you know like as i read the news and i see these simulations i want to understand what's going on i want to know how to make my own i don't know form my own opinions about what simulations are good or bad or like i don't even know uh but i want to be able to understand it so that i can feel like i know what's going on in the world and so um the way that i do that is i read a bunch of stuff and then i download some data and then i kind of play around with the data on my own and so i think the goal for today is one to kind of talk about election simulations and election forecasting but a bigger goal i think is to kind of demonstrate to you how if you're reading stuff and you want to understand something you can kind of dig a little bit and sometimes download your own data and kind of ask your own questions and so what i hope people get from this is that it's possible to do um and we we also have uploaded some code uh like the final code uh that we're using today um where can people get that alex yeah so if you're watching on youtube or if you're watching um in our uh youtube channel after the fact this will be posted after the fact um it's all in the description of the uh youtube video so we have a link to the data that we're using from 538 we will link to a blog post from andrew gellman who uh sophie we're going to talk about this specific blog post a lot i think and then finally we have a link to the code that sophie um wrote in preparation for this and hopefully we'll be able to show a lot of that in this stream perfect awesome so i think with that we will get started um and so i have this page up hopefully everybody can see it this is on 5 38 and this is um they're kind of like interactive election map where you can try out different scenarios and see how it changes the map so by default when you first go to this site you can see all of the all the states are colored by how likely uh we think they are to go red or blue so if you hover over any state like here we're on texas and it says trump has a 61 and 100 chance or 61 chance of winning based on this forecast and biden has a 39 chance um if we hover over florida we see biden has a 69 chance and trump has a 31 chance um and then what you can do so this is kind of like the baseline map and then what you can do is you can turn certain states different colors so um you can say okay well what would happen if pennsylvania goes red and then you'll notice that the whole map changes um so before if we go back to kind of normal it says we have biden with an 89 chance of winning um and then if you turn pennsylvania red all of a sudden now this gets flipped where trump has a higher percentage chance of winning based on the simulation and another thing you'll notice too if you look at this is um like right now florida is slightly blue so biden has a 69 chance of winning based on this baseline map but if we turn pennsylvania red all of a sudden florida now goes red um slightly red and is now slightly in favor of of trump winning um and so we've got like some interesting things going on here where when you first come to this map at least when i first came to this this map and sort of saw this baseline and i see these probabilities um for each state i'm thinking okay so it's kind of like it's like flipping a coin or something like this where you know a coin has a 50 chance of coming up heads if i flip that coin it's gonna come up heads half the time and it's going to come up tails the other half the time but then you get a little bit i don't know i felt i get a little confused because then i'm thinking well how can we really talk about probability in that way with this map because well first of all there's only going to be one election right so like with a coin flip you could imagine flipping a coin like a million times and when we say that there's a 50 chance of it coming up heads we really mean that like if we flip that coin a million times half the time we expect it to come up heads but with the election there's only going to be one election day tomorrow like there's going to be an outcome and it's not like we could repeat the same election um and there would be slightly different outcomes like these probabilities are not really uh or maybe it's false to call them probabilities but the way they're presented they kind of seem like them these probabilities are not um you know imagining that we're running the same election multiple times and just like depending on who's a who's able to get out to vote we expect some differences like it's it's something else a little bit more complex here um and so i felt like i wanted to understand this a little bit better um and so i i started by reading a lot on 5 38 i also um i follow andrew gelman's blog he's a statistician at columbia um and he helped create a forecast for um the economist i believe and uh so he has some back and forth and um this is a blog post that he wrote somewhat recently about 538 simulation or 538's map um and he points out some interesting edge cases i think it's a healthy back and forth um but he points to he has a uh someone in the comments of his uh blog had pointed to a file on 538 site where you can get all of the data uh for this simulation map and so oops for this for this map you can get the data that's creating it um and so whoops and so i decided to download it myself i used some of the code that he actually provided in this article or in this blog post so um lots of credit to him for sharing his code um and and i went ahead and investigated myself so what i'm gonna do now unless alex is there anything you wanna no i think i i think kind of in all of this prelude i think uh you've hit on something that's a little bit interesting which is like uh you know we we probably started talking about doing this stream like a week ago and we had an idea of what we originally wanted to do and it focused a lot about that idea of like probabilities of like oh let's um you know uh let's run a thousand simulations of the election uh you know for every state we're gonna flip our coin you know it's not a coin but it's for texas it's gonna be 61 trump uh 31 uh biden or whatever it was uh we were gonna do that i think something that's interesting is that like we could just keep digging deeper and deeper where our results from our initial idea were a little bit underwhelming and we felt inaccurate or like not not actually showing what these simulations are going on and so we uh well you uh dug deeper and found more discussions and so again abstracted away from the conversation about elections and forecasting and all this stuff i think this is a really common thing that happens in data science where basically you join a part of the community where sophie has really dug into this article really like read these discussions trying to understand what other people are talking about trying to replicate it herself which i think is a really cool demonstration of what it means to be a data scientist where you're able you're empowered to start with this thing that you kind of understand and slowly grow knowledge about it yeah no i think it's my favorite thing about the skills that i now have is that i i always have been the person that wants to understand things and like asks a million questions until i feel like i have a grasp on it um and so this is a fun way to be able to do that okay so i'm gonna actually go to this file you can see um it's like it's if you just take lop off this last part of the um of this it just brings me back to the map um the simulation map so it's if you take a closer look you can see that it is what is generating this map um but we can go to this file and i'm actually going to demonstrate this full process because i just think it's useful um so i'm going to go ahead and i'm going to say file save i think save page as yup json um simmed maps for right now i'm actually gonna just save it to my desktop um i'll i'll show you in a minute what i'm gonna do with this um okay so we have it saved as a json file and i'm going to close this because it makes my computer fan start going um and now i'm going to just kind of demonstrate uh how i would open this file in r and r studio um i so i use rstudio our studio is basically like a some software that allows you to run our code and allows you to see output from that r code in a way that's simpler um and so what i'm going to do is i'm going to open r and hopefully you guys can all see oops um so it's it's actually opening me up into a file that i was working in before but if you've never used our studio before or if you're working in somewhere else it'll open up to whatever you were most recently using um and what i like to do whenever i'm working on a new kind of set a new project is i like to create a project um which just makes it easier to read in data um without having to use like all of the uh without having to like say exactly where that data exists on your computer um so what i'm gonna do is file new project um i'm gonna create a new directory because i don't have one to dump stuff in yet um i'm going to say new project and then i am going to create uh an election live stream folder i am going to just put this on my desktop and i'm gonna press create project and it's gonna switch me over now to this new project in um in our studio and now i can dump any files that i want into this folder and then it r will all or our studio will know that like i'm just working out of this folder so anything that i put in this folder is something that i might want to use um okay so i'm gonna open up a new finder window you can see whoop you can see that this folder that i made is just a folder on my this project that i made there's a folder on my desktop and i'm going to move this json file into it whoops sorry um i'm having issues with my sorry i'm gonna go to this i don't know why it's doing that sorry one more do you know i did this earlier yeah um maybe it's because it's open in uh original studio like you want to close your visual studio uh it's not open um um i don't know okay let me let me try this one more time i'm just having like you can you can always also use your uh the other project that you have set up and uh i think it has to do i'm sorry guys uh i think it has to do with my like dual desktop situation going on here so i'm gonna go ahead and why here maybe uh maybe you can stop sharing your screen for a sec and then uh i think i might have it like well what i'm going to do actually is just drop it in there um file save pages and then i'm just gonna put it into that the folder um hopefully this won't happen to you oh and rename it yeah there you go okay there we go and now we can pull this back okay well basically all i was trying to show is that uh if you put that file into this folder that we're you're working in then you'll you can see it even in our studio in that um in that little file area and now i'm going to create a new file in here i'm going to make it an r script i'll just save it as demo you'll see it's down here and now i can start writing some code um so the first thing that you'll need to do is read in this data um and in order to read it in we actually need a library called our json so what i'm going to do is quickly so if you've never installed um if you never installed our json in r the first thing you would need to do is do install.packages um and then rjson in quotes and you could run that and this is called the console so this is where you can run code um and that will install it if you are on the internet um but if you've already installed the package you can load it using the library command um so i'm going to go ahead and load that file and then um i'm gonna go ahead and load this data so i'm gonna call it sim maps um and i'm gonna say from json and then the file name is simmed maps sophie when you have a sex you want to go over your browser and close that uh that giant tab that's making your computer work can you hear it uh i can't i can't tell if i can hear it exactly but uh audio quality seemed like it got a little bit worse yeah just close that tab and hopefully it'll get better oh yeah that file like stress that's huge um okay so we've got this and then whoops sinned do you see what's wrong with this let's see uh sorry i was talking in chat no you're good zoomed maps oh that worked okay cool um all right so now i'm gonna just so i have lo uploaded this file um from here from my desktop or from this folder and i've saved it as something called sim underscore maps and now what i want to do is just take a look at what this object is um and so just you'll notice that i'm writing code up here i'm saving that code but i can also run code at the bottom here i can save code up here and then run it all at once or i can just write like one line at a time down here um cool so what i'm gonna do is first take a look at sim maps and one of the nice things about rstudio is that if you use this dollar sign operator it'll tell you what is contained in this like object um and so i see that there's something called states in here which i can print out and i see that these are the state codes i also notice when i look at this that there are some interesting state codes in here which you might be able to guess if you've done some election or if you've done some research you might be able to guess what these are but you'll see there's an n1n2 and n3 and then there's also an m1 and an m2 um and so those are those are the like i don't know exactly what they're called but basically in nebraska and i think maine um you they split out the electoral votes into different regions and then the state itself also gets some electoral votes for the entire state um and so these are like the those separate regions that get their own electoral votes yeah this will be relevant later on when we start dealing with something that we're going to start having a bunch of numbers and there aren't 50 of them there are uh what 56 of them i think because of these extra nebraska ones and main ones in dc as well dc is in here as well um and then i'm going to just take a look at the other piece here so we've got sim maps maps and wow there's a lot in here let's take a look i'm actually gonna we see that this is a list um it's got a bunch of it's got basically 40 000 different sets of vectors within uh these like list headers so i'm actually just going to print out the first one because they think it's a little easier to see um so the way i'm going to do that is i'm going to just kind of call this like first this one is number 1000 but the first one that got printed out would be number one i'm just gonna print that out and then i'm gonna print the states along with it so that we can see them um and so it looks like so these map these lists within the maps they are um they are longer than the states lists and it looks like they're all starting if you kind of look back at this they all start with three numbers um that kind of follow a similar pattern so it's first either a one or a zero um and then there's numbers like 187 and 351 or 302 and 236. um and so just maybe by guessing uh i you can probably tell that these are um these are the number of electoral votes for each of the candidates and then this one or zero um if you dig a little deeper you can figure out that this is like a one if trump one and a zero if um biden won and then uh it goes i i guess trump electoral votes and then buy in electoral votes for each simulation separately and then it gives numbers for each of the states um and those numbers you'll notice there's like positive and negative numbers so that's not the share of or it's not the um the share of the vote but rather the margin um so like how much one candidate beat the other by so if it says 1.12 this is like trump won this state by 1.12 percentage points and you can figure out that it's trump won the state by 1.12 percentage points by taking a look at like a state that you kind of know like uh wyoming right is like clearly a positive number versus i don't know what's another one that's easy to find that would be democratic so california is probably one of those first big negatives it's probably about negative 37. so like one two three four five in one two three four five and is this negative 37 so that means that in this forecast and in most of them right like it's always a bigger negative number and that would suggest that that's like how much trump would lose by in that simulated election so basically yeah so basically each of these like 1000 or 40 000 i mean um lists is like a simulated election um that's being used to generate the map that you see on 538 yeah one of the things i think is cool about this is again this was kind of a instance of you having to like interact with the community follow along in that blog post i know you were reading the comments on that blog post a lot um this data the explanation of the data isn't immediately obvious right it took a little bit of investigation to figure out what's going on and i imagine that um you know people in the community are helpful in in terms of doing that sort of stuff um often times you'll encounter data where things are a little bit more spelled out where they'll give you descriptions of the data that sort of stuff but sometimes you come across data like this where it's like you kind of have to deduce what's going on a little bit yeah totally um okay so what i'm gonna do now is because this is currently in like a kind of tough uh this this format is not the easiest format to parse if you're trying to like look at things more easily so what i'm going to actually do is i'm going to convert all of these separate lists into basically one big array um and i'm using i'm gonna use andrew gelman's code because he just did it and already and it makes it very very easy um so i'm gonna pull this over and then i'll walk through what the code is doing um i guess i called this something else so naps um okay so basically this first uh line of code all we're doing here is we're just saving the states separately so um remember we when we pulled out the states that's this is what we got now we're just saving it as something called states so that we can pull that out um the next thing is that uh we're we're taking we're gonna make this um this array the same length as the number of simulations that 538 ran um and so you'll see this is just 40 000 um this length right so we could have just said n sims is equal to 40 000 because we know they ran it 40 000 times but this makes it a little more reproducible if they change this data and they decided to do it 50 000 times then we could still download this data set the same way and our code would still work um so we're saving nsims is the number of simulations that's 40 000. and then we're gonna create this empty array um so all this is doing is it's basically filling an array with n a's and that array is going to have 40 000 rows and it's going to have 59 columns the reason we want it to have 59 columns is just that um there are 59 numbers in each of these like list elements um and again those numbers are the three kind of like markers where the first one is who won it's either one or a zero and then the two uh electoral votes and then the 56 states or you know uh nebraska has four of them uh because of how that works so so it all adds up to 59 total right and now so if i run this oops i guess i didn't run this i'm using command return by the way to run each thing you can um also just press run and you'll see it like copies it down into the console um so you can see that it ran um okay cool so i'm just gonna now show you what this looks like so sims um we'll do just like the first 50 rows um is really or that's hard to read but basically i just made this uh this array it's got columns where there's no name for the first column then it says trump biden and then it's got all the states um uh as the rest of the state codes as the rest of the column names in here yeah so what we're really doing here is we're just kind of like organizing our code would you say this is data cleaning or data like um preprocessing i guess where before we had yeah before when we had um like the list of states and then the um just the list of numbers without any like matching to them now we're kind of combining them so later on in our code we can say things like okay get me the uh give me the number associated with florida from the first um from the first simulation or get me every single simulation from the numbers from every single simulation from florida and it's gonna be a lot easier to do that now that we've associated the names with the numbers yeah exactly um so we've created this empty array and now basically all this code is doing is filling it in so we're saying for every row just take the list from um from that like initial maps data take the list and fill it in as a row in this array so once we run this now we'll see that if we look at um sims one to we'll do like one to ten now um we it's just filled out it's basically one big array where each row is one um one election simulation and uh there will be 40 000 rows in this i've just printed the first 10. nice cool um okay so now we've got this thing called sims that is a little bit easier to work with um one other thing that i'd like to do is i probably just want to pull out like these first three columns are maybe not as useful as the first as the rest of them or at least what we're going to be looking at um is just the the state column so what i'm going to do is actually just pull those out so i'll make a new um a new array where i just say okay i want the simulations um but i just want the columns and i wrote down before uh yeah so four through 59 yeah that makes sense right so we're cutting off the first three columns right okay i think and that and that comma beforehand uh so i'm i'm not a huge r person i do much more python that comma beforehand is just saying i want every row and then the comma says okay i've got every row what which columns do i want um and we want yeah the syntax is like square brackets rows and then columns so you can say like if i did 1 to 20 then i would get like the first 20 rows um and those columns since i want all the columns i just leave it or all the rows i just leave it blank that syntax really tripped me up at first i hated seeing like that floating comma i feel like this compared to well we don't have to get into our discussion about python versus i feel like this is so much easier now that i understand it i get it but you know just coming from python it looked very strange i see some people in the chat like our snap's the best and then python slab it's growing on me i realized when i started doing this i kept using uh like python syntax and i was like oh god i've been working with python for too long losing my r skills um okay so now we've got all of our state simulations and now we can start taking a look at them um and so i think like the one of the first things that's interesting to take a look at is just the distribution of margins um for a particular state so um for example like i think when we were first looking at this when we started on the map we were looking at pennsylvania so i'm going to start with with pen well yeah i'm going to start with pennsylvania um and so we can also take a request from chat as well so we can also take a look but um and so the histogram function is the easiest way to do this um and what i'm going to do is i'm going to take the state sims and then i want um i want just pennsylvania there's a couple of different ways i can do this um i think actually since this is not saved as a data frame we can't do that um but i can so like we said before use the square brackets now i want a single column right i just want the pennsylvania column that has all of these values just for pennsylvania all these um these marginal like win percentages uh and i can uh just say i want um okay yeah so again this is uh well two things one this is the same syntax we want all rows comma just pa um something i need this here actually you can if you wanted like different if you wanted a selection of them you could create a vector and say which ones you want yeah we could get pencil we could get pennsylvania pennsylvania and new york but if we just want one we don't have to put that there um the other thing that this shows is again the kind of value of us putting it in this organized table where if we didn't connect the table with the names we'd have to know like pennsylvania was like the 25th column or something but now we can just straight up ask for pa um which is really nice yeah totally okay so i get this histogram it's got some it's default things here are a little bit uh maybe not easy to read so what i'm going to do is just change some of those things so i'm going to say maine is trump margins in pa and i'm going to say xlab is trump margin um and um i also can color it something so i can do like call equals red um and that looks a little nicer um i can also just like open this up a little bit so you can see it a little better and what you see is this distribution so basically um let's let's remind ourselves about what we're plotting so across all the different simulations um trump is gonna win or lose by some number of percentage points and this is the distribution so this shows us how often different ranges of percentage points when percentage point wins or losses are occurring so um the highest bar here looks like it's around negative five so that means that the most common outcome across all these simulations is that trump is losing by five percentage points in um in pennsylvania and if you look at the polling um the polling averages in pennsylvania you'll see that um biden is ahead by about five percentage points on average so this is kind of like a polling average more or less like it's telling us um on average trump loses by about five points in pennsylvania meaning that biden wins by about five points in um in pennsylvania and then this distribution on either side of here is giving us a little more information about how much error we think might exist in the polls so if this is the if this is the distribution of simulated margins for trump across all these simulations it's kind of indicating that based on 538's model they think that the most like likely outcome is that biden wins by um five points but it that could be off by as much as about 15 percentage points so it's unlikely but trump could win pennsylvania by 10 percentage points or by five percentage points um it's also unlikely but possible that biden wins pennsylvania by 20 percentage points on the other side um so zero would be a tie anything on this side anything to the left of zero would be a simulation where biden won and everything to the right of here would be a simulation where trump won yeah and i think one of the one of the main questions that i had when um i was going through this with you was like where do these numbers even come from and i know that we like digged into this a little bit but essentially that's like a little bit of the like real intense stat magic that's going on at um 538 is there different ways that they can like simulate 40 000 runs of the election to get these numbers for for each individual state yeah and i think the maybe i shouldn't call it an epiphany but the thing that this helps me understand and maybe it helps you understand too um if you're watching is that basically what's going on here when you're seeing percent chances or proportion of simulations where someone is winning it's basically like the proportion of this distribution that's less than or greater than zero so like if you calculate the proportion of this distribution that's like to the left of zero that's going to be on their website what they're saying is biden's probability or biden's chances of winning and this distribution is really like even if you read nate silver's comments on his model like he says that they predominantly in their modeling use um the polling averages and so essentially like this distribution what i can learn from it is like basically if you look at an individual state you'll see this distribution of margins where um where the most common one is going to be approximately what the polls are saying and then there's going to be some level of uncertainty and that uncertainty can we don't fully know like i think you can read what nate silver writes and you can kind of understand more about where that uncertainty comes in but basically it's like polling error like did we survey the right people did we wait like our observations appropriately based on like who's actually gonna show up to the polls like um are there other random factors that are gonna influence who comes out to the polls um and so this level and then some of the uncertainty i believe also comes from like how wrong polls have been in the past like it helps us understand like if we if we do this this polling how confident can we be that like the result of the polls or the result of an average of a bunch of polls is like accurately gonna tell us the outcome of the election and so this ra the randomness is more associated with our level of uncertainty about the polls than it is about like coming back to the coin flip like whether a coin comes up heads or tails which is like it could go either way every time you you do it right there's like no uncertainty with a coin flip it's like a known probability right um whereas with poles it's like we think that the the average is here and then there's some degree of uncertainty yeah i come back to the fact that you can't run the election multiple times but the uncertainty is coming from basically our uncertainty about our polls this is this is a question from from uh um which i think segues nicely into what we're probably going to go into next uh and you touched on it a little bit here does the data collected in surveys nicely represent the total set of those who ultimately vote i think that this is related to uh looking at the correlation between states and like how how yeah i think another so my advisor in graduate school taught an incredible class on um surveys and and actually like the way that polls work is that they're you're not just going out and surveying a bunch of people and saying like how many of those people said they'd vote for biden and how many of those people vote said they'd vote for trump there's also some like very complicated waiting that goes into that so like uh basically like if you only if you think on average like a certain number of hispanic women are gonna go out to vote but you only manage to survey like a smaller proportion then you're gonna upweight all of those observations to try to like match the demographics of who you think is is gonna vote so um so yeah so there's a lot of complicated like waiting and math that goes into not just taking not just surveying people but like figuring out who are the people who are most likely to vote and how can we appropriately weight our sample in order to know or in order to more accurately guess how like our our survey relates to what's actually going to happen thanks um so the so there's some uncertainty here the other thing that i showed you guys when we were clicking around on the map is that when you click on one state and you say okay um pennsylvania is going to go blue or pennsylvania is going to go red then you saw that the other states are changing or the probabilities and the other states are changing and so there's some there's something going on where the outcome in one state is predictive of the outcome in another state um and so one of the things that andrew gellman does in his blog and for a different reason but it's super interesting to do is he starts looking at kind of like a a scatter plot basically of one state versus another so i'm going to do that let's say i want to plot um we're going to do pa versus florida and i just know from experience i'll plot this for you because i think it's like useful to see um it's going to take a second uh that it by default it uses these like circles that are not great so you can change that i think i had pch equal 20. um try it and you can change around just like before um you can change the uh the x and the y labels to make them easier to see so the x label is gonna be um pa margins um and the y label is gonna be florida margins oh my computer is making sounds again it's all right it's working hard oh well now my ocd is kicking in um okay i will rerun it um and you'll notice that there's kind of this relationship right like you can kind of draw like a positively sloped line through here so um you'll remember from before when we looked at just pennsylvania um those we kind of saw that histogram that like the trump margins range from negative 25 to up to like a little above 10 positive 10. um and then florida looks like the predictions are ranging from negative 25 to positive 30 almost um and so i see a question how do we know that this is trump margins for pennsylvania that's related to how we how we structured this data set um but basically i'm just once we pulled out uh each of these so we set up this this array with each of these as each of these states as columns um now i can just pull out and plot the pennsylvania column against the florida column and that's what this code is doing yeah and going back to that question of like how do you know what this data is actually doing again that's like part of the discussion all of these blog posts um yeah and you can kind of verify it for yourself where you can look at the numbers for a state that's likely to go trump or biden we did with wyoming you can see the wyoming numbers are all very positive you can see the um vermont uh numbers which um probably is probably a uh biden state all very negative so you can kind of extrapolate from there that positive is a trump margin um a negative is a vitamin margin right yeah exactly um yeah so i think it's interesting to kind of take a look at we see this relationship um and and basically what that tells me is right if if it turns out that pennsylvania um loses by or that sorry that in pennsylvania biden wins by 20 percentage points so trump loses by 20 percentage points then more in more of the simulations we have that florida had a similar result that like biden also won by 20 percentage points in florida if that happened and on the reverse side if trump wins by 10 percentage points over here then um then it looks like more of the more of these points are up in this corner right where in florida there was a similar margin for trump and so the question is and like the question that i ask myself when i look at this is why is that um and i think a lot of it having listened to podcasts and and read a bunch of blog posts a lot of it is basically because if we're wrong in the polls in one state then we're likely to be similarly wrong with our polling in other states um and so it's basically like if our if our polls are skewed towards biden in one state then they're more likely to be skewed towards biden in another state and vice versa do we want to show that weird example that we saw when we were playing around with this or is that just like too hard to explain i think we looked at california and wyoming where they were negatively correlated yeah i mean i don't have a good answer for it but i think that uh i think that this is like another example of how you could like play with this yourself so we can show it um so if you look at california and wyoming we see this like negative correlation showing up um i i honestly don't have a good explanation for why this happens but maybe if i read more i can understand it yeah i mean what this graph is saying is that if california goes to trump which is on the right side of the uh of the image then that means that wyoming will be more likely to go biden because that's on the lower half of the image and that's like completely reverse of what you would expect obviously most of the data is in the top left corner of california going to biden wyoming going to trump but yeah they have this inverse correlation which uh i was confused by as well yeah i'm sure there is an explanation um okay uh okay we're running a little bit low on time uh but i think that at this point it would be fun to look at some maps um i think a fun thing to do is kind of inspect how this correlation plays out uh by looking at a map um and so i'm actually gonna grab i'm gonna grab some code that i wrote prior to this um and it's gonna look a little bit complicated um but it's probably unnecessarily complicated this is this is uh me not liking using builtin functions um is really what's going on um so basically i wanted to plot a map of the us and you can do that with shape files which you can find on like census.gov but when i was doing that the scale was really off like because you have hawaii and alaska and you want you don't want those to be in their actual locations um the shape file that they had on on the census website had had it to scale and so everything was really tiny and so then in google searching um i found this this package called usmap in r that you can use to easily simulate or to easily generate us maps um but then it wasn't giving me enough uh i couldn't like put the labels i wanted or what like i couldn't ha i didn't have enough control over the inputs to their function and so instead of just using their function i pulled out their data um and this map will take an understanding of uh of what the number correlation is we're going to have numbers between zero and one here um let's see oh you need a oh oh that's fine i don't need this this was for something else ignore ignore all the red i know it's stressful but ignore it okay so what i'm gonna go ahead and do is grab this um okay so basically what i'm doing here and i'll try to talk through it quickly is i'm taking the correlation so this core function will will give me the correlations between um between pennsylvania and other states so this gives me the correlation between pennsylvania and all of the other states the correlation is just basically a measure of how strong this relationship is so this is going to be a negative correlation if it was in just like a straight line um the correlation would be one so if we if we do the correlation of like california against california um we can even see it in that print out actually if you scroll down a little bit we can see the correlation of pennsylvania to pennsylvania somewhere in there there it is left second one yeah and then the larger the number the stronger this association is the the more clumped those points would be around a line the smaller the correlation so the closer to zero um the more dispersed these points would be there would be no real relationship um and if it's positive it's going to be a positive slope and if it's negative it's going to be a negative slope this is a lot we're building some new content though uh explaining all this year and i'm very yeah about it so so you'll be able to learn more once that is uh once that exists um okay i'm just gonna go ahead and you should we you should make this the the project of uh of that course ooh maybe that's actually not a bad idea um okay so we can see this i made this map um and so this is giving us the correlations between pennsylvania and every other state um and so basically you can see obviously pennsylvania is dark blue because it has a high correlation with itself but now we can see based on 538's model like if pennsylvania changes if the if we lock in pennsylvania as like red or we lock in pennsylvania as blue you can see which other states um are most are gonna have their probability of or their chances of going towards biden or trump change the most drastically so the darker colors are going to change the most drastically when pennsylvania changes and the lighter colors are going to change the least drastically so it looks like for example the whatever happens in pennsylvania based on this isn't really gonna change what we think happens in california or is this what a state is this that's uh alabama alabama sorry i need to like learn my learn my states again um but then you'll see you know other states nearby that are kind of like mississippi not alabama mississippi yeah mississippi alabama georgia got it i used to like say that in my head when you know when you were younger and you had to take those like i don't know if you had to do this take like quizzes where you need to fill in all the state capitals yeah um we have a question in the chat or a comment in your chat all of your correlations are positive do you want to speak to that yeah so in this in this simulation um all of the correlations with pennsylvania came out to be positive um i think most of the most of the correlations are coming out positive in this um in 538 like simulations just because i think it makes more sense for um for information like if your polls are wrong in a particular direction in a given state it makes more sense to me that your polls are wrong in the same direction in similar states it makes less sense to me um but again i'm not an expert and i'm sure there's a there is an explanation that like if your polls are favoring biden in one state that we think that like the polls are then more likely to favor trump than another state if we throw in uh i don't know how easy it is for you to change pennsylvania to california if you can throw in california there we might be able to see again there's that there was that weird negative correlation with wyoming so we might be able to see a negative correlation there um um to california yeah california yeah between california and uh and wyoming in particular it looked negative um i'll just do this i'm going to save it as core pa anyway but it's the new data why did that correlation not found did i not on this there we go there we go um yeah so now we see the scale runs into the negatives so california is negatively correlated with a lot of the south uh wyoming south dakota interesting yeah i really so this is like another uh this is another thing that i'm probably gonna spend more time uh trying to figure out and i think it's something that if you're interested like i very much encourage you to think about and explore yourself um and all of the all of the code to generate these maps and everything like alex said is available to you um if you want to just download my code and um and run it and then change it however you find interesting yeah in the in the youtube description there's a link uh that will download a zip file and then that's all of so please code that you can play around with awesome we are right at six o'clock so i think this is maybe a good time to wrap up is there anything else you want to shadow i don't think so uh this was super cool i love doing this kind of stuff i would love to do more things like this on codecademy um we can stall here for a little bit to see if people have questions i think we can probably hang out for like five minutes to answer some uh some last minute questions i see one from andrew right now um so yeah basically is there any historical data for if poems are wrong in one direction they're wrong everywhere in one direction so like i said i'm not an expert so i don't really know but i assume yes i i assume that if all of these simulations and and all of them have this kind of like correlation between states or all the ones that i've looked into um i'm assuming that that's because of historical data right and yeah and again the the data that we're using here are the 538 for uh 40 000 simulations of this election but the way that that data is generated is probably through some combination of historical data and current pollings and all that sort of stuff thanks jamie and morgan oh morgan is content contributor extort extraordinaire for the data science team um what was uh yeah uh taku says what is the lowest and highest correlation for california with other states i mean we can look at that right now right it seems like california is very highly correlated with washington colorado new mexico new york and pretty low uh lowly or negatively correlated uh with alabama mississippi tennessee arkansas uh yeah with correlation too it's about absolute value when we're talking about like how strong the relationship is but it looks like none of these negative correlations are really getting below none of them are getting to like negative 0.5 because that's not even on the scale so i would assume that these are pretty weak negative correlations and then we've got um all of the kind of light purple ones um are the kind of weekly positive ones cool awesome awesome um yeah in finishing up i think uh i at least would encourage people to go vote wherever you are um it's uh we're glad that we were able to get this in before election day just so we could show some data encourage people to vote um thanks for running this sophie this was super super cool i'm very impressed thank you awesome well have a good night
