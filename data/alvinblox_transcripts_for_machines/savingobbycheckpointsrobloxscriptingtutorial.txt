everyone Alvin blocks here now in the last video I showed you how you can make or be checkpoints but today I'm gonna be showing you how you can save them so make sure you've checked out the OB checkpoint video if you haven't already I'll leave a link in the card and in the description so first thing that we're gonna do is going to go into the player data script this is where we firstly set the players team when they join the game to stage one now what I'm going to do is we're going to create a another event which will run when they leave the game and it's going to save their team to the roblox datastore system but firstly we have to actually create a variable to reference to the datastore service so at the top of the script we're going to say local data tour service equals game get service data store service okay just like this make sure you've got the capitalisation correct as well now we can create our datastore so again another variable and our datastore for this game is going to be datastore service get if datastore and we can give our datastore a name so this is the name of the datastore which will contain all of the saved team values so we can say we can just call it what we want I'm going to call it saved team values actually I'm going to call it or be datastore because it's the obby datastore for everything in the game then what I'm going to do is we're going to create a event which will run when a player leaves the game similar to player added we call it player removing so game dot players got two player removing so when a player leaves the game we're going to connect to a function and again this function will take an argument of the player that is going to leave so this player we've kind of like a variable we call it an an argument that's going to be the player that will leave the game so whatever we do to player will be done to the player who leaves the game so firstly we need to save their their team so we actually need to get their team name so you can say local team name is going to be player dot team dot name let's just have a look here so if we go into okay excellent so when we say playoff team we don't say don't name because the value of player or team is actually the team names earth or on stage one player dot team will be equal to stage one excellent so now what we can do is we can say datastore.set async and when we say set async is basically telling the script that we want to save to a player's data store and we have to tell the datastore before I get him to tell the script where we want to save this data because Cooney was saving it in the OB data store but we have no connection between the data that we're going to save and which player we're going to save it to so each player has their own key and the key is a unique identifier of their data store so we're gonna have probably thousands of players data stored in one game but how you would how do we know whose data is whose and that's why we use keys keys tell us who the data belongs to that we're going to be save and then later on load so the first thing that we need to put inside of here is the players key and it's gonna be whatever we want as long as it's unique to the player so something that is unique to every player is their user ID so we can say player user ID and then we're going to put dot dot and then in a string and say stage okay and this just is a unique reference so we know which is which because if we have more than one key for example we had a key for their cash and a key for the stage and we didn't have this this string for stage they would both have the same key so when the key is the same you can't you can only store one piece of data so we're just gonna make it unique by saying what it is that they're saving to that player's user ID that is their key then so it would be like one two three four five stage that is that key then the next thing that we're going to say we're gonna have a comma to separate the arguments we're going to put in here the actual value that we're going to save so we're gonna save their team name and there we go we have just saved the players stage or their team name to the data store but to be extra safe and to ensure that nothing went wrong when we saved so if the roblox servers went down just as we were saving we're gonna put it in a picot and what happens in a pickle is if the datastore errors when we call set a sink we can catch the error in the Pico and when it is in a P call it won't stop the entire script when we usually have an error it will stop the whole script but we can just do a Pico so we can say local success comma error message equals function sorry P call function like this and we'll close the function with an end and closing bracket like this so any code in between here if it errors it won't stop the whole scripts because it's inside of a peek or the Pico will stop it from airing and it will just carry on with the rest of the script and if it was a success then success variable will be set to true automatically but if it is not success then success will be false and the error message will have some kind of value attached to it and that will be an error message sent back from roblox so if it was a success then we can just print all went well else if it wasn't a success then we can print out what the error message was and that will tell us what went wrong usually it's if roblox is servers go down but if it wasn't a success and then which can print out the error message but apart from that we are done it should now save the players stage to that datastore all we need to do now is get their data in this player added function so when they join the game we're going to try and get their data so firstly let's try and check for that data so we're gonna copy this set async code from the player and moving and just paste it in here but this time we're going to get the data so instead of saving we're trying to load it so we say get acing instead and we don't need to have the second argument of the data but we're gonna write to the latest we're not writing any data we're getting the data so all we need to give is the players key that same key from down here so that we can uniquely identify the players data store inside of the ob datastore and then what we can do is we can create a variable outside of here called a local retrieved data I'm just going to call it data because there's too long to write that and then I can set data over here to the returned data from get a sync and then what I can say is if it was a success and if the data was correctly gotten and there wasn't any errors then what we can do is we say player dot team equals data and that will set their team to the saved team name so if the saved team name was stage two in fact what we'll do is we'll say game lots of teams and then in square brackets we'll put this data because we have to have a team object and if the data is stage one stage two then we'd say game drop teams or stage two and that would be the object of the team that we're setting that team value to so we're changing their team to the saved value but because the save value is a string we have to supply an object now if there was no data and there was an error what we can do is set their team to stage one but also if data is there is no data because there are new player to the game if we if it was a success that we did get the data but there was actually no data there the getter thing didn't go wrong it was still a success but there was just no data so if there is data then we'll set their team to whatever that data is but if there isn't any data saved we can just sit there that's the stage two stage one okay so I think we're all good to go here let's let's run a test and see if it works now if you want to see this working what you've got to do is you got to publish your word blocks game because data stores only work in published games so I'm going to go publish it right now by going to file and then clicking publish to roblox hours then it will let you publish the game so just follow all of these steps and click on create and it's great to the game for me now I need to go to roblox on the website to play it but before you do that click on game settings and click on options and make sure that enable studio access to API services is turned on this will allow us in the future to test our data source within roblox studio but it doesn't seem to be working for me this this checkbox and read books to do currently I think it's broken so I'm going to show you another way how you can turn it on so find your game on the roblox website click on the three dots and click on configure this game then you should be able to turn on enable studio access to a PR services now it seems that it did work in roblox studio when I turned it on so that's all good so now that you've published the game and you've turned on enable studio access to API services you can either test it in roblox or you can test it in roblox studio I'm going to test it in robotics to do so in we go and let's hope that this works I'm confident that it will so let's head to a stage quickly head over to stage two and we're gonna step on the stage and we're going to stop the game now what I'm going to do is I'm going to go into the data store editor plugin which is a great way to see your saved data and see if it actually saved in fact I just realized that I made a mistake here I said play a ramp of view instead of removing so I'm going to change that and let's try it again so here we go and I'm gonna set my stage to stage two again because it obviously didn't say last time because there was an error in our script but if we go over to stage two and step on the spawn and I'm gonna hit the output open so we stop the game and let's see what it printed ok so it said cannot store instance in data store data stores only accept valid utf8 characters now this probably means that we've accidentally stored an object instead of some text so let's have a look so this was the error message so player dot team hmm okay so let's try saying play alot team dot name maybe that will work let's try that because the team property that's a bit annoying the team property player dot team is actually an object and because it's an object you can't actually save objects to data stores so we have to actually save the name of the object which is why when we load the data we say game teams and in those square brackets we say the name of the data so let's have a look so I think everybody everything went well because there's no error message so let's play again and see what happens no ok we're back at stage two no worries sorry we're back at stage one so let's have a look let's check the datastore editor okay so it's safe it's saved so that's a good sign but so now we know that there's a problem with when it's loading so let's have a look here so it gets the data if it was success then if there is data then player dot team equals game dot the team's data ok let's do some printing to find out so print success else print error message and we'll also just print test 1 and test 2 we'll load this up and try it again ok so it printed success test 1 and let's just check again what we're saved to the day store idea ok so it's saved stage 1 let's change this to stage 2 so imagine that we've now changed our datastore to save stage 2 let's see what happens ok excellent so it spawns us on stage 2 because that was our save data so let's have another look at the saving here so getting that team name and we're saving that let's try once more and see if this works so I'm confident they should be working now and I'm gonna leave this in the video because it's a great way to show you how to debug your code because your office you may come across some datastore errors sometime in your development career so it's great that I leave these in because it's teaching you how to debug by yourself and what we've done here is debugged our script so we're gonna go to stage 3 we're gonna leave the game and now let's check the datastore editor to see what we're saved to our datastore so I'm going to put my user ID comma stage and it saved stage two for some reason and I got to stage three now that's weird but no worries we will have another look at this let's try one more time hmm start weird okay so I think I figured out what was causing that problem I think it was because when you first joined the game you're your first team was stage 1 before any of this code around it was currently at stage 1 but then when we got the data we changed it to another stage but what usually have what happens is in the game in this game your starting location like the way you normally spawn is actually above the first spawn and afters because it's I think it's in like the middle of the map or something but anyway what I've done is I've changed the first spawn so that allow team change on touches set the force only for the first spawn because when players first join the game there if there are new player their team is immediately set to Sage 1 so they don't need to change the team on touch but for any other stage when they get to that stage obviously we want to change that team when they get there so only stage 1 I've changed allow team change on touch to false now also at the bottom of this of this player added function event sorry and when all this data is loaded I'm going to say player load character and it is basically respawning them so when we've updated their stage two the one from the datastore we're going to respawn them to that spawn location so if they spawn at the starts and the date hasn't been loaded yet when the data is loaded will respawn them so that they spawn at their loaded team spawn so let's try this out now I just saved the game at stage or and I got teleported back to stage four so now if we head over to stage three so here I am about to jump on the stage three spawn I'm now going to leave the game I'm not gonna rejoin now what's going to happen it's going to load my team and it's gonna respawn me hmm and there we go so it all happened very very quickly so we didn't see it but I've been respawn back at stage three which is where I left the game at so really cool we have just implemented or be saving checkpoint so we're gonna test it even more we're gonna go over here and stage two and leave the game and respawn and if everybody is interested in what I use that plugin to edit the data to us on the fly that's called data store editor and it is by crazy man 32 really really good plug in that and it allows you to change players data stores without using any scrips or anything so really useful especially when you're debugging data stores and data stores are the hardest to debug and you've just watched me be able to debug my data stores there and you've been able to see what I've done I added prints at certain lines to check what was happening to see where the script got to before it broke and I also used the power of P call and error messaging to print out an error message when it rose which will help me figure out what was wrong with the data store so remember publish your game for them to work turn on studio API requests so that you can test it in roblox studio and that should be all for this video so thank you very much for watching if you enjoyed it please do like the vid share it with anybody you know that will be interested in learning data stores I've got loads more dates tour videos on my channel which are all linked in the card so make sure to click the thumbnail to go check those out but don't forget to subscribe for more roblox scripting videos I make loads of videos to help you create your own roblox games and earn robots from them until next time this is alan block's signing off Cheers bye