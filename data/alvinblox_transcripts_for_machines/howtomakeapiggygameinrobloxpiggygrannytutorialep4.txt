hello everyone and welcome back to the fourth episode in my how to make a piggy game on roblox series now in this video we're going to be making the tools such as the stunt script for the crossbow and also the piggy batt work as well as the remote events we're going to set those up so we can have the announcements that come up when someone gets killed and also going to do the animations for the piggy bats as well as some general things as well to do with the game logic scripts as I said in the last video if you found a book check out the link in the description down below I am human and so I can't answer all of your comments because I'm getting a hundreds every single day it's just mathematically impossible for me to answer them all so try your hardest to debug your code look at the output window and scan your code line by line really carefully to see if you spell something wrong or made a mistake because that's going to be the cause of your books or your errors because as you can see on my end it's working completely fine so that any further ado let's get straight into episode 4 so what we're gonna work on next is cleaning up after the round is finished so things like teleporting the players back to the lobby removing everybody's tags destroying the map etc so after the start round function is called what we're gonna do is we're going to make the contestant stable in the game logic script we're gonna make it blank again so we're going to say contestants equals and then a blank table to reset it to a blank table then what we're going to do is we're going to loop through all of the players in the game again and just like we did at the beginning we're gonna copy this for loop and we're gonna paste it down here again and what we're gonna do is we're just gonna insert all of the players that are not in the menu into it okay just so that we've got all of the players in the game and then what we'll do is we'll teleport them back to the lobby so because obviously if they are in the menu that now they're going to be already in the lobby so this for loop is just in in adding them to the table again including those though the reason we have made the table from scratch again is because some people might have joined halfway through the round which is what we'll be working on later on and they won't have been counted in the original contestant table because it made before the previous round started so getting all the players again and then what we're gonna do is we're gonna put them back in the lobby so firstly we need to check if there are spawns in the lobby so make sure that you've named your lobby model lobby and you've got that spawns folder in there containing all of these spawn locations they need to be spawn locations and not just normal parts so make sure the fall is called spawns and you've got the lobby so once you've got all of the players in that table we obviously need to check that they were spawned so if game thought workspace Lobby caught on find first child spawns so she's got spawned in your lobby then we're gonna do around we're gonna call that teleport players function on the contestants and then we're going to do we we need to give the spawns to the teleport players function so that's going to be game dot workspace dot lobby again but spawns get children and that will return a table of all the spawns in that folder okay all these spawn locations so that the teleport players can put all the players on different ones and that should do it for the piggy as well because the piggy won't be in the menu so even though we were counseling the piggies our contestant here we're not actually checking if they have a contestant value we're just checking to see if they're they're not in the menu which the piggy won't be so the piggy should be included here but if you haven't got any spawns we can do another fatal error warning just to warn the Creator so if you add a if you change the lobby it's a later date and you forget to add the spawns this should warn you in the output so you don't have to do it if you want but so it's a good way of reminding yourself if you don't know what you've done wrong and it just helps reduce the amount of errors that you might get after that we're going to need to delete the map delete the chapter that's currently in the work space so we can say cloned chapter destroy and that will remove the map we don't want lots of maps being create that each round and then we need to remove everybody's tax and just clean up the whole game in general we've got quite a lot of things that we do need to clean up and which you might not have thought of so things like obviously the Piggy and contestant tag but also removing everybody's tools if they've got one equipped and all that other good stuff so we're gonna go back into the round module where we've got all of our functions and we're going to create another function I'm gonna call it function module dot remove tanks and then inside of this function firstly just going to do another for loop so for I comma V in pairs game dot players colon get players do so for every player who is going to be represented as V we are going to firstly check to see if they have a piggy tag if they do have a pig attack we'll say V dot piggy column destroy him to remove that piggy tag else else if V has a contestant tag which they probably will because there's only one piggy if they have got the contestant tag we will say V dot contestant destroy so we'll firstly delete those tanks very nice and and then we will remove the tools so if they're the piggy gonna have a piggy bat so if V dot backpack find first child piggy bats then V dot backpack piggy bat destroy and and we're gonna do the same thing again we're gonna copy that line I'm just paste it underneath but change the backpack to character in case they have it equipped so change it there but also change it after the then you've got to change it two times so if leader character find for his child to pick you bat then they'll have it in the hands currently we need to destroy it from there as well because it'll either be in the backpack or it will be in the character it'll be unwanted but not both but now we've done that we need to remove all of the contestants tools so we can say for now because we've got a for loop inside another for loop I'm going to use two different variable names for my I and V so we're gonna say for underscore comma P in pairs V backpack get children do so looking through all the tools in the players backpack if P is a tool then he destroyed as I've said it doesn't matter what you call these two values okay I've just used a because I'm not even gonna use the I value the index value I'm only using the P and the P represents the thing that's going to be inside the backpack or anything that's going to be inside the backpack so we're looping through everything so it's going to be done to everything in the backpack so if it's at all gonna destroy it then we need to copy this for loop make sure you only copy the right amount of n so we should only need two ends one for ending the for loop one for ending the if statement and once again change the V dot backpack to V dot character so you're just looping through all of the things in the character and if there's a tool stored in the contestant character we're going to destroy it so now that we've done that we've deleted their contestant value and removed their tools we should be good to go on that front one other thing I'm going to do is I'm going to go into server storage and inside of here in fact yeah in self storage I'm going to insert a folder called game values and inside of here I'm going to insert a bull value and this value is going to be called game in progress and it's just useful because we can set it to be true or false when a game is happening and then from other scripts we can tell if a game is currently in progress for example when we're going to work on the menu script soon which is going to run when they press the play button we want to check to see if a game is currently in progress and if it is we want to put the player into the current around if they've joined halfway through so to do that we need to check our games in progress so I'm gonna set this value to be true when around starts and then at the end when we do the remove tags we can set the value of it to be false so I'm gonna say outside of this for loop that's where it ends don't do that I'm going to say game but service storage game values dot game in progress store value equals false okay I'm gonna make that false then what I'm going to do is we're gonna set it to true in another scripts okay and the script we're gonna put that into is gonna be in the game round module but it's going to be it's gonna be in the start round because that's when the round begins so we'll just do this little whoops we'll just copy it and paste up here but this time I'm going to set it to true because when the round starts we're going to set the game in progress value to be true but then when it ends and we do the remove tags to clean up the game to the general clean up so we can do the next round we're going to set it to false because off to the game isn't in progress anymore in fact we'll put that at the top because it should be executed first in my opinion the script does everything in steps and so we want to firstly set the game in progress value to be false obviously because that's the first thing that should be done just in case somehow some of this is so fast that they click the play button before we set it to false even though the round has finished okay so that's that done and that is the cleaning up needed so that we can start the next round but you will be wondering well how do we start the next round because currently when the game finishes that's it it doesn't restart and it's a good question first things though we need to call that's remove tax function just like that after the clone chapter colon destroy now we need to wrap all of this code that we've just written well nearly all of it into a while loop so where we start this intermission here we're gonna say while while wait do and then we're gonna add an end right at the bottom so make sure you've got that while wait do at the start just after where you've acquired the door module but just before the intermission and then at the very end of the script after the remove tags you add that end then selects everything in between those two lines in between the while wait do and the end select it all and press tab on your keyboard that will indent it and that just makes it a lot more organized and clean it shows us the code that is inside this while loop and now that we've put it in a while loop that means that it will repeat forever so it will just keep running this code over and over again so we start off on the intermission but when we get right to the end and we've removed the tags and we get to this end here we're gonna go right back up to the top and do it all over again and that is how the rounds repeat themselves forever and ever and ever because the while loop when it gets the bottom it will go straight back up to the top so after we've cleaned up the round and destroyed the map and everything and teleported everyone back it's gonna do an intermission again for 30 seconds then it's going to choose a new map because it's firing this round select chapter function and then it's going to teleport everyone then it's going to start another round and that round is only gonna finish when the round start round function gets to the end which will only gets the end when this for loop is broken so either when the time's up or someone dies or the piggy dies or whatever so you can now see that we have this game loop which is running over and over and over again so this is how the game works and we've pretty much finished the game loop for itself now obviously we don't want the round to start unless there are two players because that way is going to do the intermission and if there's only one player is going to choose the piggies and then it's going to get stuck because there's no other contestants to choose from because we've removed the piggy from the table so we need at least two people to start the game and obviously we can test with two people because we can start up our test server so we're going to implement a repeat until loop in our while loop at the top here before the intermission but inside the while loop still so we write repeat until and we want to repeat checking to see if there's enough players in the game so we'll do local we'll create a table and when I call that table available players and we're going to add all of the players that are not in the menu to this table then we're going to see how many items are in this table so how many players are available to play and then we can see if that number of valuable players is greater than or equal to two we can start the game so we're going to repeat and we're going to use a for loop for I comma player in pairs game dot players come get players do if player so if not player find first child in menu so if there isn't a tag in the player called in menu then we're going to insert them into that table so table dot inserts we're going to add them into the available players table and the thing we want to insert is that player so then what we've done that we can say we can set the status to say say to stop value equals in fact we haven't got a variable for the status yet so we're gonna say local status equals game but replicated storage come on wait for child status because we have we have the status value in the round module which is where we've been was well been updating the status from currently but we have no need to actually update the status from the game logic script yet so status door value equals to ready players needed okay and then what we'll do we'll do a bracket and open bracket and then we'll do a dot dot and then we'll do hash tag available players dot dot and then open the bracket again open the speech marks and close the bracket off and that way it just it will tell us the number of players current in the game and in fact I'll do it / in this in this end string here so that it will it will look like a fracture and so if this one player in the game it will say to Eddy players needed and then it will say one out of two not just updates the status makes it look really nice then we're gonna add a weight to just so that it's not repeatedly repeating this every you know hundreds of times per second or whatever we need a nice delay so that it doesn't crash off script so a weight too will do perfectly and then we want it to keep on repeating this and keep on checking to see if there's two players until the number of available players is greater than or equal to two and when it is greater than or equal to two it will break out of this loop it's kind of like a for loop or a while loop it will keep on running until there are two or more objects in that table when I say objects in that table I mean players in the game because if there is a player that is not in the menu then we insert them into that table and every time we go around again we reset the table so we make it blank again we insert all the players that are ready to play and then we count up how many are ready and then if there are enough players then it will break out of this repeat loop okay so now we can test the game and I'm gonna put this intermission back down to 5 seconds because it doesn't matter about it being long or short because the game is only going to start when we have those two players in the game okay so you can see that we are in the game but we haven't been teleported or anything you know nothing has come up on the screen and that is because we're in the menu and we told the scripts not to count us if we're in the menu and if we open up the server here oops if we just bring the server over here and we look at player 1 we can see that player 1 is in menu and player 2 is in the menu when we exit out of the menu look at player 1 you can see that that in menu gets destroyed and now it says that there's one out of two players that are ready to start the game if we do the same for player two it will now say two out of two players already and it's gonna say next round starts in five four three two one one of us is gonna be selected to be the piggy but then we have our game loop and it's still going really really quickly so if I die for example if I reset then it's gonna say the piggy has killed everyone then hopefully it should it will get rid of the map let's see yeah the maps gone I could see it on my server it's completely gone but the next round is starting so it should insert them up again there we go it's been inserted and now you can see we're both the piggy and that's because we haven't undressed the piggy yet and we haven't actually removed the old piggy so that's what we need to do next so to reload the piggy we're going to go into the round module we're gonna go through our remove tags and in the if if statement where it says if the fine first hard piggy what gonna do is we're gonna say at the end of this V curl on load character and what I will do is will respawn the piggy without their outfit so it will just respawn them as they were with their normal player outfit okay and then that way when the next round starts they will be back to normal they won't have their piggy bath anymore because we've destroyed it from the backpack yeah and one other thing I'm gonna do is I'm going to go to the game logic and I'm gonna add some weights so I don't want to activate the doors as soon as the map has been loaded because just in case the map hasn't fully loaded yet and we accidentally miss out a door I'm gonna add a wait two seconds there I'm also going to have a wait two seconds between the actual teleporting of the players and the math being loaded because sometimes the map can't be fully loaded and if you teleport people straight away they might get stuck halfway in the map because they'll start falling and then suddenly the map gets loaded so their torso is stuck in the map so if we get where the map yeah when the map has been loaded and when the piggy has been chosen if we just do another wait here for two seconds that looks good to me and we'll also do another wait here just so that when the rounds all finished we can just wait two seconds after everything's been cleaned up before we start the next one okay I think that's all good let's go ahead and test it again okay so the next round is starting and if we just die again as soon as we load in get ready to reset okay so the current PE has reset and so he should yeah so he's now responding as my default character and hopefully a different piggy gets chosen next time maybe it's gonna be player one on the rise see so now we've got those weights in there were just allowing some time for the everything to get loaded but now we actually have a proper game loop which seems to be working which is really really good so what is left to do got quite a few more things left to do such as the piggy bats and all of the different remote events that we need for our duis and things like that and also things like teleporting players if they've joined halfway through crouching placing traps lots more to come because we want to make our piggy back work so that's one of the remote events that we are we're going to have to set up so I thought I'd walk you through how the piggy batt works so inside the tool piggy bat which is in service storage firstly we have a local script and this handles all of the clicking that's done on the players computer so we've got two events here script dot perparing dot equipped and that's going to run when the tool is equipped and opened up it's going to show the GUI that says click a player within eight studs to kill them just a little helpful guide and this one as well unequipped will hide it when you want equipped at all but this one let's cook the pound activated it's going to fire or be triggered when you click the mouse so Mao stop target is gonna be the thing that you clicked so if the mouse top target is a hip is called hitbox okay or it's inside of a model the thing that you touch then it's likely there's gonna be a player okay so what we'll do is we will use get player from character with the mass target and that will check whether the player that you've clicked is an actual player and if they are a player then we can fire this remote event inside the piggy bat called hit and supplying the player that we've clicked and then in this server scripts is going to pick up the hit event and it's going to play an animation which looks like you're swinging the bat if you're the piggy and what's going to happen is it's quite it looks a bit you know confusing to you but all that's happening is it's checking if the victim the person that you've passed to the to the server script to the through the remote event the victim if they have a character is checking to see if they haven't already escaped that's something that we're going to work on very soon but also it is going to check to see if you are within eight studs of the player so this victim dot character the humanoid root part opposition player character to human rapport position dot magnitude that is basically the distance between you the piggy and the victim so if it's less than or equal to eight studs then it will let you kill them so you have to be within close range and then what it will do is it will slow them down it will make them freeze you'll freeze as well and we've got this function called freeze which will basically kind of like it will weld all of your body parts together so you can't move sorry the victim's character and then we're gonna fire this remote event called piggy hit and that's what we've got to insert so let's create the remote event in a replicated storage and call it piggy hit now what this will do is it will tell the player or the victim to show a GUI on the client end and that's going to be the black GUI that appears and then what will happen is after naught point 65 seconds which is going to be how long it takes for the swing to actually unlike hit the player it will again slow the player down and it will kill them and sorry yeah it kills them and then it plays a death sound and the death sound is the same one you'll hear in piggy and then after they've died it will make the piggy be able to walk again and it will fire this other remote event called kill feed and the kill feed is what makes the GUI pop up on the screen saying that the victim was killed by the piggy so that's another remote event that we're gonna insert and we're gonna call it kill feed so by now you should have three remote events one called menu play one called kill feed and one called piggy hit now if you're interested in learning more about how I made this piggy bat I'm gonna make a tutorial I'm gonna link to it in the card or put it in the description I'm not sure if I've run out of cars yet cuz there's a max limit of five but I will film myself making this from scratch so if you want to enhance your scripting knowledge maybe a little bit more advanced at scripting and you want to know how I made this tool from scratch then I will have a tutorial on how I did that I'll put it in the description okay so they are the road events that you need for the bats now the next thing we'll look at is the stun script so there's also a tool called the crossbow and that's for use by the players the contestants and if they click the piggy basically like shoot the crossbow at the piggy the piggy will become stunned for 20 second so 20 seconds so yeah so inside of this local script it's a little bit different to the other scripts because it fires a rep a remote event called stun so that's another remote event that we'll need I'm gonna add another remote event in through applicators storage and so should you and I'm going to call it stun so what it will do it will fire that remote event and then it will destroy the crossbow because it can only be used once unlike other tools we don't want any player to always be able to kill the auto stone that the piggy house it would be unfair so you only get one use and so it will destroy after use but there are two crossbows available in the map in different places but they were both destroy when they've been used once okay so when this stun remote event is fired it gets picked up on the server in this stun script which came with your piggy kit again I will have a video up teaching you how to make the stun script and the crossbow from scratch although for most of you it probably will be quite advanced and if you don't want to learn how to make it then that's fine but the video is in the description or in the card if I do have a space for a card if you want to learn how to do it but basically a quick overview is that when it's picked up on the server your mouse target so the thing that the player clicked is sent it just checks if the target is um is a member of a model and if it is then it's probably the piggy so we look up the piggy player from their character check to see if they have that piggy value and if they do we're inserting a tag into the piggy called stunned and after 20 seconds that tag gets destroyed so from other scripts we can tell whether the piggy has been stunned for example in the bat script the piggy is not allowed to kill anybody whilst they're stunned so if they try and click and fire this hit event then we will check if not player a fined for his child stunned and that basically means if the piggy isn't stunned then we'll let them kill this player but if they are stunned and they have got that value in them called stunned we're not going to let them we're not going to let the player kill the victim so the victim gets away because the piggy is stuck remember in the stun script the piggy also gets sparkles added to their head which makes it look like they're confused we also announce to all players that piggy is gone for 20 seconds now this is another a most event that you need to insert so go ahead insert another remote event into replicated storage and call it announcement now the announcement remote event gets fired from the server and what you can do is you can send a message now you can either send a message to a certain client a client is basically a player or you can send it to all clients so all players in the game will get the message and when you do if we go into the GUI in the client mein which does again come with your picky kit because I made it for you if you look in here we've got game dot replicated storage that announcement on client event so when it gets fired from the server it's gonna make it's gonna change the announcement GUI so it's gonna change the announcement text labels text to your whatever the text is that we sent it's gonna make it visible for five seconds so you can see that announcement all players will be able to see some something get announced so kind of like a message like piggy has gone for 20 seconds we've also got one the kill feed which we've already created we've already created our remote event for and that is when somebody gets killed with the bat with with a bat script we will fire that event to all players saying that the player whoever it was was killed by the piggy and it's basically the same thing so the remote events that you will need are going to the stun piggy hit announcement kill feed and menu play make sure that you've named them exactly the same as I have and you've got the capitalization correct really really important and as always I am gonna put tutorials into the scripture on how I made all of these realized events work and all of the tools as well it may be a little bit delayed after the video that's just because I have got a lot of content but over at the moment I've already got gone into three hours of filming this video so a lot to to edit so please do back with okay so now that we have done these stunt scripts let's go ahead and try it out and see if it works now like any other item I'm gonna have to go into the map and find the crossbow so hopefully we can do that before the time runs out here we go so try and do it as quick as I can I know it's in here in a dining room and pick it up and hopefully I don't out of time look we've got not long left to talk if I click the piggy he's gone for 20 seconds he can't move I'm trying to move him but he can't move at all he's just trapped and he can't kill anybody so look the contestants everyone so brilliant so the stun script has worked perfectly now let's also test out the bats because I'm wondering if that's working with your most events that we've just added I wonder if it does so wait for the piggie and this will be awesome if it does work so we're gonna click on the player look at that boom player one was killed by the piggy so we've now got our piggy bat working and it says to the piggy has killed everyone so we've got a working piggy game which is awesome so I'm going to try this again and what I love about this is that the camera will change to the piggy when you get killed just like in the normal game so if the piggy kills you it will look like the piggy is hitting you with the bat which is really really awesome so let's have a look again I try and boom and you heard that as well the death sound is the actual one from the piggy game as well so awesome we've got a lot of our piggy game finished so far although there's still a lot more to do things like traps crouching lots more to do and if we just check the output see if anything's gone wrong I don't think it has no errors which is awesome so you can tell that the tutorial is working so there we go okay the next thing that we're going to do is we're going to work on this menu play on server event in the event handling script and we're going to work on when a new player joins and around is already in progress we can insert them into the current round which we know it's going to be pretty easy to do trust me so after this if in menu if statement we're going to do another one underneath it we're gonna say if game got service storage dot game values got game in progress dot value is equal to true double equals then so if a game is currently in progress what we're gonna do is we're going to put the player into the round so what do we need to do well firstly we need to give them a contestant value we're going to put that contestant value into their player so very very simple just as we've done before local contestant equals instance new ball value give it a name contestant and we're going to put that we're gonna parent it inside their player objects then we're going to do is we're going to teleport them into the round using the teleport players function of the round module so we're going to have to in we're gonna have to require the round module by saying a local round module equals require script or parent wait for child game logic round module and then underneath this instance new ball value but still in the if statement we can say round module dot teleport players and we have to supply the player table so the table of players that we want to teleport obviously we just want to teleport this one player so we have to put them in their own table like this just as we have to do with a piggy and then we're gonna do comma and we also need to give the function the map spawns so we will get the current map from the workspace which will be games don't work space dot map as we change the name of the map to be map doctor player spawns in fact we will say find first child map in case it's not there and then we will save dot player spawns get children like this okay and that will teleport that player into the map it and then they will be in the round so now let's go ahead and test this out so we're going to go into test mode this time however with three players because obviously we need to to start the game and then we're gonna have the third one who joins halfway through so let's check it out okay so we've got player player two on the left to play one on the right and player three in the middle now we're going to insert player three into the game when the current round starts and so let's click on play and boom they get inserted into the round and if the piggy kills player three well they still play a two left so they're still being counted so they're being counted as an actual player so the game registered them as a contestant because we inserted that contestant value into their player excellent so we have just been able to allow players who join late or you know midway through a round into the game halfway through and I think that's fair you know these rounds they're quite long ten minutes they can last a while you only be waiting for ages so so yeah okay so next thing that we're going to do is to do with the piggy bat again and I said earlier about a hitbox which we talked about in the bat script so either to see if it's if the victim is a I'm sorry so two hits a player the piggy currently has to hit the player's character so one of their body parts and that can be hard to do especially if they're moving and jumping is hard to click it especially if you're on a mobile device as well so what I've also done is I've allowed a I've allowed for the piggy to also be able to touch a part called hitbox and so what we can do is we can create a big part which surrounds the players boundaries and it's kind of like a big square part so even if you click an edge of a player's character or maybe just a little bit outside of their head you will still hit their hitbox which will be attached to their character so it will still register as being able to kill the piggy which is why I've said if Mouse target name is hitbox so what we need to do is we need to weld this hitbox to the player if you haven't already seen the hitbox is currently in the server storage it came with the piggy kit and I'm going to show you what it looks like in the workspace it's currently transparent but if we just make it visible you can see so the player would be inside of this hitbox so imagine that the head is like in the middle here you still have a little bit of leeway in that you can hit anywhere within this box and you will still hit the player which is kind of fair I think and it's worked very well in testing so I'm going to make it transparent we're gonna put it into the server storage and the way we're going to do it is we're going to clone at this hitbox and then weld it using a weld object so that it sticks to the players character even when they're moving so make sure that anchored is set to false and can collide it's also set to false okay so both need to be false unchecked but what we're going to do is okay so inside the round module in the teleport teleport players here we will let's think about this yeah so I'm going to I'm going to do a wiener inserts the hitbox so local hitbox clone equals game dot server storage dot hitbox cut on clone I'm gonna say hitbox clone got parents ah yeah got parent equals game sorry player character then we're gonna say hit in fact before we parent it will say hitbox clone dot C frame equals character dot humanoid a root part dot C frame we need to attach it first before we parent it because we need to weld it in a minute then we're gonna say local weld it was instance gotten you by the way if you don't know what a weld is a weld is an object in roblox which joins two objects together even if they weren't anchored so that they stick to each other so instance new weld weld dot part one so you have to set the two parts that they're that they that they stick together so the first part is going to be the characters humanoid root part the second part we don't say part two instead we say part zero I know it's weird but that's the way roblox works part 0 equals hitbox clone okay and then we're going to put the weld objects inside of the character just like that and then we can do the hitbox cloned or parent equals player character so firstly we're cloning it in we're putting it in the right position we're still keeping it in server storage for now just so that we caught it in the right position it won't fall out of place or whatever then we're welding it together and then we're putting the hitbox inside the players character now if we check this out again and load the game up let's have a look okay new round is about to start if we open up the Explorer and have a look in our if we have a look here in this list you can see we have a hitbox for player one who is the other player if we have a look over here you see that they've now got a hitbox surrounding their character so if I was to click maybe just a little bit a little bit off by their next to their head but still click in the hitbox they would still die and it didn't register the first time because I was just a little bit out of bounds so I wasn't within the eight studs but you can see that the hitbox gets created now if your watch again closely obviously we don't know who the Piggy's going to be so it could do insert into any of these players let's have a look who's gonna be ok was player two so this time I've got the hitbox on me so if I was to make open at the properties window and change the transparency ignore point five you can see it surrounding me so the piggy could click anywhere wherever this hitbox is surrounding so here wouldn't work but if I was to click there it would work so it makes it easier for the piggy to kill you but it was hard in the first place especially if you're on mobile so and especially as well if you're a small character and your are 15 sliders are ha the lowest is even harder to kill somebody so this hitbox makes it easier for the piggy and trust me if you've ever played with the piggy it is it is it's a godsend it's it's much much better to play with it like this so yeah that's the hitbox complete and it just makes for a better game and also those of you who are using the bats the animation most likely will not play for you and that's because we can't share animations in roblox so you're gonna have to create it yourself now if the bat isn't working for you because of this I recommend that you go into the bat script and you just remove this part here where it says local animal equals player character find first child humanoid load animation script the pound or swing ok remove these lines of code this highlighted block remove that and it should work but I'm going to show you how you can make the animation so what you need to do is you need to go to server storage we're gonna copy the piggy we're gonna put the piggy into the workspace and if we open up the animation editor again set the animation property to be action just make sure that you click the three dots by the play button on the animation and then you've clicked on set animation priority and then you've clicked action if you don't do this then your animation is not going to play when we load the game because it's priority is lower than the default core animation so make sure if your animation doesn't work that you have set the animation priority to be action and then we're gonna do is when you go to about noir point one we're going to drag the arm up into the air I'm gonna move along a bit move it even further back and then drag the blue along and we're gonna swing it so we're gonna move the arm background but turn it a little bit like this let's play perfect I like this one looks good to me so I'm gonna right click export' okay and then it's going to say create new go ahead and do that and give it a name and click finish then carefully click and drag to select this ID then right click and copy it click OK if you can't see that that animation ID go to roblox go to the create page and then go to my animation in the left column and it will appear for you then you can close down the animation editor and then go into the swing animation and paste your animation ID into there and then if you go back into the game it should work I have been filming for over three hours I know the video isn't that long that you're watching but all of this footage has to be edited really really carefully so I've been filming for over three hours today so reads appreciate all the support the likes the subscribes and everything much appreciated ok let's try it again then let's go over here and see if our animation will play boom look at that the animation has played now if you think the player got killed too early or too late and you want to change the timing that's fine just go into the tool and the piggy bat and play around with these weights okay so this weight here change it to maybe a smaller number so in 0.55 100.75 have a quick play don't mess around too much with the other things because you might break the bats and I can't help you you've messed it up okay so the next thing that we need to do we need to actually make it possible for players to escape so in the map we have a final door now I'm going to just take the chapter 1 out of the folder and put it in workspace to show you so the final door is this one and it's unlocked by the white key firstly you need to use the wrench to turn the generator on and the generator has a value inside of it called on and when you click the wrench it will check to see if you've clicked the generator and if you have it will set this on value to be true then when you use the hammer to click these two wooden blocks they will get deleted and then finally when both of these things have been done you'll be able to use the white key to unlock the door so what I've done is I've named this door the exit door so the door that you want people to escape from you must call it the exit door with a capital e and a capital D that is so important you need to call it exit door I've also added a padlock mesh onto every single door so if you want to add if you want to make another door which is locked you need to have two things you need to have this value called key and you also need to take this pavlok so you'd copy it and then you'd get the door you want and select it I press alt and click to select the door itself and then you rightclick and paste those two things into it now the padlock is going to appear far away so you need to click the padlock by pressing alt and click and then alt again and click and drag ok let go of alt and then you can drag it onto your door so I'm going to drag it onto the door here then I'm going to use the Move tool just to push it into the door a little bit and I'm going to change the color of the door to a different color okay what I've done that I then need to in fact we would have got a green key so I'm gonna do a a black key it's kind of hard to see there we go black but I'll make it hmm okay we'll go with that so yeah when you've done that you need to then change the value of this key value to say to be the name of your key so it needs to be the name of the tool now I'm gonna create a tool called black key so I'm gonna change this value to say black key so this is the the key that you'll need to unlock this door ok you need to have the value you need to set the value the value property of the value and have the padlock in there as well next you then need to make the key so what I do is I will just take a key so the green key for example right click and duplicate and change it to black key make sure you name it black key and then going to change the color to be black and then I'm gonna go into key handles and I'm going to duplicate one of our current keys so the black and the blue key I'm going to name it black key and again I'm going to change the brick color to be black so we've created a key handle which will allow us to click it and equip it and then we've created our tool objects called black key and we've also got our door with the key value inside which tells this the black key that's needed to unlock it as well as the padlock which will fall off when you click the the key against it so you need a padlock in every single door and key it's not gonna work and you'll get an error then obviously you need to take the black key out of the service storage key handles and you need to put it into the items folder so I'm right clicking and pressing paste into or ctrl shift V and that puts the black key into the items folder and I'm going to press F when selected to move the camera to it and we now need to move it somewhere into our map so that players can pick it up so for example I'm gonna go put it on the bottom for all here okay now if I take the map and I put it into replicated storage into the chapters folder and I play the game again we'll be able to use it so very very essential things firstly you need to have the door with the key string value inside and that needs to the value property of that needs to be the name of the key used to unlock it you then need to create that key and put it into the service storage tools folder and then you need to create the key handle which is basically the the the parts inside of the key inside looked at all so what I did I just duplicated the current key that I had the blue key changed its name changed the color and that way I just had a quick way to make the key and then you had to okay so it's not working for some reason so I can't open the door and if you can't open the door it's a sign that your door manager has gone wrong and there's an error in your door manager scripts so let's just have a look and see what the error is in this server so going into the server window nothing seems to have gone wrong hmm no nothing needs to be wrong here let's try and debug oh I just realized I'm so stupid um so it's locked isn't it it's locked we need the key but the key is on the other side of the door so we kind of chose the wrong door to do there but we'll try again and see we get a different spawn point but then afterwards what we will delete the door there because we don't want that door to be locked by the way unclear into the round module and change the weight here for the for loop to go back to one so it's actually a true countdown of ten minutes so I got lucky this time so if I take the well firstly let's check out the door so I can't currently go through it but if I pick up the key which I can do because it's got that click detector and the key the key scripts inside which you need to put into each key handle by the way so put that a click detector and the key script in there in all the other keys and items so you can pick it up if we put it against the door you can see the door manager automatically makes the padlock for when the key touches it and the door will disappear so that works perfectly so that's how you add your own door or key I'm gonna go back into the chapter now and remove the black key I'm also going to remove the padlock and the key value I'm gonna rename the door as well good practice to name your door to whatever it is so if it's unlocked by the black key name it black door that's what I've done with will leave the door so this is the blue door this is the purple door this is the red door etc so remove the door and the Black Keys also gone from the items folder so that can go back into chapters folder make sure you do put it in wrap the kg storage chapters then I'm gonna go into the key handles and remove it so when I was talking about the key script if you're adding a new key make sure you add this item script into the black key key handle it's in all the other keys so you can just copy it and paste it in but if it's a model like the crossbow as I've said before put it in a part inside the model but change script or parent to script a pound a parent because we want to send the model not a part to the clicked function in the key module so delete the black key and also delete the tool as well if you're not going to use it okay so we're nearly finished with our piggy game the last thing that we need to do is work on the crouching system so that a player can Crouch through certain holes in the map and also the trap system that the piggy can lay down traps which the players can get stuck in so that's what we'll be doing next but we do have a functional piggy game as we speak so you can go ahead and play it and try to escape from the piggy perhaps publish it and try it out with some friends so click on file and then if you go to publish to roblox you'll be able to publish this as your own roblox game also you might not have seen that this main menu actually changes your camera to be looking into that intro tunnel I showed you about earlier this is because in the client main scripts after two seconds your camera see frame so the position of your camera gets changed to the to be looking into the intro tunnel so if you wanted to add your own piggy inside of this tunnel what you need to do is go into server storage where we have currently got our piggy right click and copy and then paste piggy into the intro tunnel now we're gonna use the Move tool to move him all the way over there and we're gonna press F to move our camera to him I'm just gonna move them over here and because the cameras looking like this what I'm going to do is I'm going to use the scale tool and a press down shift and drag to make him bigger then I'm going to use the rotate tool to make him look at the camera like this oops I've dragged it too far out so I'm gonna press ctrl Z and now if we select everything inside of this piggy and we set it to anchored so that he won't move around we can also delete this animate script because it's not needed now if you play the game then after 2 seconds of being in the menu it's 2 seconds just to let you load in you'll see that the piggy has appeared because our camera is now looking at the piggy so if you wanted to you could rotate him even further like this so he's actually looking at you and we'll try it again and you can add whatever things you want to this intro tunnel and it makes it look more like the real game doesn't it because you've got your picky looking at you and you could have more things down here if you want to improve the lighting you can if we go into the lights parts and change the surface light range you can increase that or you can change the brightness or even the angle of the light like this I'm gonna have mine set at 90 there you go very very nice touch and again that intro tunnel came with the piggy kit so make sure that you don't change the name of the intro tunnel or the name of the camera face or camera origin parts because it will it will and break itself if you do want to change it and you do have knowledge on see framing the camera then go ahead but I won't be able to help if you if you mess it up so I hope you enjoy the series so far if you are then please do click the like button and don't forget to subscribe to my channel for more roblox scripting videos I hope you enjoying this one I've put a lot of effort into it so far as I said three hours into recording and there countless hours of creating it and testing it before I even started recording so please do show your support by liking subscribing and if you do want to take your support further you can become a channel remember a premium channel member four dollars 99 and month on my channel you can click the join button underneath the video next to the subscribe button and also you will get the access to the full project file which I'm working on right now so you have all of the code completed for you to go in and use for yourself as well as other cool perks such as a little badge next to your comments in in the chat and also priority responses for your comments and also if you want to tinker around with the effects that come on the screen when the piggy does hit you then you're gonna want to go into the piggy hit local script in the main GUI and mess around with this noir point 65 value as well because this is the time that the camera will be looking at the piggy before the screen goes black so the longer the the higher the number so maybe noir point seven five or more point eight the longer will stay looking at the piggy but the the less the number then the the less time it will it will between looking at the piggy and the screen going black so you kind of want it to be synchronized with the piggy batt script so if you set it to nought point eight five over here you want have it the same in this piggy hit script as well so we will leave it there for episode 4 I recommend you go straight to episode 5 it should be released by the time you're watching it or if you're watching it just as it's come out then you'll have to wait until tomorrow to watch that but it should be on your screen now so go ahead and click the thumbnail to head straight to the next part episode 5 I'll see you there