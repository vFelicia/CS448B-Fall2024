in this video we're going to be looking at messaging service and it allows you to communicate across different servers in your game so if you think of a big game like jailbreak has loads of players across loads of different servers how can you relay messages between them or maybe give announcements you could do a server wide announcement feature how do you update these servers by sending messages or you know data to them so messaging service it allows you to publish it has publish async and subscribe async publish a sync is used to send messages to the servers and subscribe async is used to pick them up so in order to receive a message you have to be subscribed think of it like a YouTube subscription box where if you're not subscribed to the channel you won't receive updates or new videos if you're not subscribed to the topic and I'll describe what the topic is in a minute if you're not subscribed then you're not going to get the the messages or the information from the other server so the way this works is you can say publish async and you can send a message are messages hello there we've also got noob now noob is the topic with messaging service you can send a message with a topic and the topic is what identifies this message and who it's being sent to so you can subscribe to certain messages with by by giving your topic so if I only wanted to subscribe to the messages from the topic called noob then I've subscribed with just noob here so if I was to then send the message with the topic ooof right then none of these servers are going to get the message because they haven't subscribed to that topic you can subscribe to multiple topics so you could have you could be subscribed to topic and booth and that would mean that you would receive the messages for oath and noob but if you send a message with a topic that you haven't subscribed to then you're not going to receive that message so how do we do this well it's quite simple actually firstly we need to set up the subscription we need to subscribe to a topic so that we can receive updates and messages from whichever server is sending the message to that topic so what happens is a server will publish a message to a topic and then if you're subscribed to the topic in your script then you'll be able to get the update from that topic so to subscribe you say messaging service and we've also got the messaging service set up here as a variable so we say messaging service or game get service messaging service whatever you choose but once we've got the service we can say kernel subscribe async and we now need to give the topic that we want to subscribe to so what messages are we going to receive we only want to receive messages that are in the Nuba category okay so we firstly need to say our topic and as I've said that's the thing that uniquely identifies the messages that are going to be sent we could send some messages to a noob topic or a news topic you can call the topics whatever you like so we could have a topic called global announcement right so you could you could have you could use the messaging service for a global announcement and when a message is sent if it's a global announcement if it's got the topic global announcements we will globally announce it in like a GUI or something okay so and we subscribe to it and now we need to tell the script what we want to do when a message comes through with this topic assigned to it so we will do a comma and then we are going to have a function which is going to run when this message comes in so function and then pair of brackets drop a line and then we're going to do and for the closing bracket now what this is done is we've created a function that's gonna run when the message comes in but we don't have the data of the message so all of you wanted to print out the message we need to get the the message data from somewhere so it's passed to this function automatically by subscribe async so if we just write an argument of message then the message is gonna be is gonna be passed up to the argument and whenever we say message that's what our message is going to be equal to but actually what happens is subscribe async it sends the message in a table formats so the we will have two bits of data being sent it will have the message but we'll also have the time which it was sent and that's since third the epoch so the number of seconds since January the 1st 1970 we can use that number of seconds to manipulate it into the time arrived but right now we're gonna be just focusing on the message that has been sent so actually it's not called message it's called data so I think it's called data and sense so if you wanted to print out the message we would have to say message data okay and I'll actually just check that as well let's have a look and subscribe async we have message let's have a look cross server messaging yep so we've got message dot data which is passed and also message sent so which is the unix time in seconds at which the message was sent so if you wanted to print out the message we'd have to say message data we wanted to print out the the time to assembly could say message sent so that is how you subscribe to a topic whenever a message comes in with this topic assigned to it we will print out the message but now we actually want to send the message right so we're gonna learn how to do that so it's quite simple as well all we need to do is say messaging service curl on publish async we now need to say the topic that we're gonna that with this message will be sent to so global announcement and also the message so we can just say hello there guys if we just add a little wait delay in here so we can actually see it see it happen what's gonna happen is the SUBSCRIBE a sync connection which is waiting for the message to be sent is created five seconds later we the message and it gets picked up and it prints out hello there guys and then the number of seconds since Jeremy the first in 1970 and we're not gonna be going into that today but you can manipulate that in a way to find out when the message will sent but I'm going to go over this again so if you're not familiar with events or connections I'm just going to go over that now so what we've done is before we send any data as soon as the script has started we have created an event listener an event listener is something that waits for something to happen and it's constantly checking so in this case we're constantly checking to see if a message has been sent using subscribe async now what this does is it's going to wait until the message comes in and when a message does come in with this topic then we are firing this function and this function prints out the message data and the time that it was sent and then five seconds later we are publishing a message to this topic and so because the topic has a new message it's triggered our SUBSCRIBE async event which is listening out waiting for a message to come in now that the message has come in is printed out that message this is data so in this case hello there guys because that was the data we passed to that message and also the time in which it was sent so you might be thinking this is a bit pointless because it's all in the same script and we can just you know we could just print out our own message but this is where it starts get interesting what if we what if we added other scripts we had another scripts and in one scripts we would publish the announcement and in another script we would pick it up right so this could be our subscribed script and this could be our publish scripts now for the purpose of this tutorial I can't open up multiple servers to show you this but let's imagine that our publish script is running in in one server so server one and our subscribed script is running in in another server and we wanted to send the message from server 1 to server 2 now look we don't have the publish in our publish async stuff in our in our subscribe script so if we run this now what should happen is after 5 seconds it just still prints out hello there guys even though it's in the different script and there we go this is because we have published it from a different script and we are picking it up in another script as well so you can think of this as like if we have 10 servers opened and they were all subscribed because the we've subscribe to in our scripts in our server scripts that will run as soon as the the game is created whenever we publish something to this announcement it will print out the data and just to show you as well if I was to just disable this script and just get rid of it for the publishing stuff and I only have the SUBSCRIBE a sink let's go into the game and what we can do is we can use the command bar now let's imagine were in another server again down here in the command bar we could say local messaging service equals game phone and get service messaging service and we can say messaging service publish async and we're gonna give the topic go open our announcement because that's the topic that we have subscribed to in our scripts and then we can publish a message so if I was to publish this we have a error it can only be exceeded by the game so okay that's fine we just go into server mode here and try this again okay cool so we've just published a message from the command line and it's been picked up by our script that has been subscribed to this topic so if I was to do this again with a different topic and the topic was called hey there okay nothing happens well actually show you again you see nothing happens the hey there XD is not printed out and that's because we have sent the message to a new topic we haven't sent it to the global announcements topic and we sent it to the the hey there topic and it's not been printed out because we haven't subscribed to the hey there topic if we were to subscribe to this topic in the command line we could say messaging service subscribe async and to the topic hey there and we can just do a function quickly that will print out the message okay and now that we've subscribed to it what we can do is we can just publish to the hey there topic again and it's going to print out the message if I change the message doesn't matter it will still get printed out so you can see you can subscribe to a topic a certain topic and you can send messages to that topic now obviously you're not going to want to you might have certain different topics in your game you might have say for example a global announcement and you might also have something like a ranked announcement so you might only want to send messages to people with a certain rank so you wouldn't want that to be a global message so you might want to topics so you can have as many topics as you like and then you can publish messages to those topics so you can send certain messages to certain servers so most likely you'll have every server subscribed to a topic but that's how messaging service works you can subscribe to a topic and then you can send messages to that topic and you can do whatever you like with those messages this is very basic still you could for example make a GUI which shows the messages you know you could have a topic which could be alert and when you send a message to that alert topic then your game could set off some alarms or something if you have like a I don't know a roleplay game or no something like that so lots of use cases for messaging service this was just a very very basic tutorial on it and I'm also going to say when you are dealing with messaging service it is recommended to wrap your subscribe async and publish async lines in a Pico just in case something goes wrong and or an error occurs it's not going to affect your entire script so the error gets contained so we fry an event here we create an event connection so we could say local success connection equals P call function and then drop a line and we'll move this and with the closing bracket over here so that our messaging service event is surrounded by this P call we'll also just before the connection variable I'll explain what that does in a minute we'll add an error message so in case we get an error message and we'll be able to print it out and see what what goes wrong so the success basically says whether whether everything went well and no errors occurred so if it's true everything went well if it's false then there was an error and so we can print out the error message which is also set as this error in this error message variable that's where the error message would be and then the connection is is the connection to this this event the SUBSCRIBE this P call messaging service subscribete sync event so when we need when we don't need to be subscribed to this anymore if we if we wanted to stop being subscribed we could disconnect the connection so we should say connection disconnect now what that would do is it would basically if we if if a message came in it wouldn't get printed out anymore because the with with we've ditched the connection we've stopped it's being subscribed to this to this event so if you ever wanted to stop being subscribed at one point you could say connection disconnect so we've done that we've wrapped our subscribe based thinking a peek all what we now need to do if you are publishing you do the same thing so say cool success I will message but this time don't need the connection because we are publishing so we are not listening we are publishing equals P call function and then in here we can just say messaging service cut on publish a sync with our token and our message so let's add a wait in there again and everything should work now one final thing is that you will probably get an error when you try this out you will probably get an error called messaging rooter service disconnected in fact I can guarantee you'll get an error unless you publish your game you have to publish your game as a place okay you have to go to publish to roblox here or probably Sherlock's asked you have to make sure you published it as a place so go here and then publish your game and then it will work for you because messaging service only works in running in published games so there we go that was a quick tutorial on messaging service I hope you found it useful if you did please like the video share it with anybody knows that think would benefit from learning about this very very cool and very powerful as well messaging service I might make some more videos on it in the future as well about how to make more practical things with it such as a global announcement system that actually works with a GUI but for now that's the end of this video thank you for watching and I'll see you in the next one