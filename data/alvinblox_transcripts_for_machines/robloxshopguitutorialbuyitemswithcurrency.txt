in this video I'm going to be showing you how to create a GUI shop which will allow players in your game to buy virtual items let's get started welcome back to another video my name's Alvin blocks and today it wouldn't be creating this GUI which will allow players to buy items in your game with virtual currency now my last video I taught you how to create a currency system which saves and which will allow you to buy stuff and today we're making a shop which will allow you to spend that currency so the first thing that we're going to do is we're going to make sure that we've got this GUI in our game so I've already made the GUI now if you want to make your own GUI and also want to use this script you're gonna have to make it look the same as mine okay so it's gonna have to have a main frame item description it's gonna have to look like this but if you want to take this GUI you just need to go to the description of this video and there'll be a link to the model you need to take that model then go to the toolbox and it should be in your models you just click my models you'll be able to drag it in and place them into these start at GUI so we're going to just script this GUI today we're going to Swift it so that it shows the item you've currently selected and then we're going to get some information about the item and show it on the right here and then whenever you click the buy button we're gonna make a request to see if you have enough money to buy the item and if you do we will give the player or you the the item well to get started you can see we have two frames we have item description and a list inside of this main frame and the list is where all of our items are going to go so each item is going to be an image button and the name of that image button is going to be the name of your gear okay so if you're wanting to give a sword the name of your image button would be sword the same as your tool on the item description we have a Buy button we also have an image label which is going to be the selected image and then inside that image label we've got a text label and that's going to display how much these selected item costs and this far you hear selected item will change whenever we click one of these image wear buttons so we're going to start by coding I leaderboard scripts if your game curtain does not have a leaderboard I'm just going to quickly add one to our game so we're going to insert a script into service script service and we're just going to want to get a a normal leaderboard script and it looks like this okay you should know how to do leaderboards if you have watched my tutorials before or you're getting into monetization it's very simple when a player enters the game we add a folder who leader starts and inside of that we put some currency called points you just want to change points to the name of your currency so if it was called cash you change this to cash for example but we're gonna keep at points for today in our shop and there we go that as our leaderboard done I'm just gonna call this script the server handler so we're gonna put all of our service scripts in this in this one big script here and we're going to get started then by coding our image buttons here so that we can show the selected year on the right so to do that we're gonna have to insert a local script into our first gun which is called hyper and also we also need to insert into the server storage a folder called shop items just like that and you need to make sure the s and I are capitalized for shopping items and inside of here is where we're gonna put all of the tools which the player can buy so for each tool which you're gonna sell you're gonna want an individual folder okay so this is what its gonna look like so a plate we've pasted this folder inside of shop items so whenever you've gone your item just copy and paste this folder and change hyper to the name of your tool so you can see the tool currently inside the folders called hyper and that's what we're gonna give the hyper gun here so inside the folder we've got the tool and we've also got a value called points this is how much you want this gun to cost if you want it to cost 300 points you'd want to set this value to 300 but we're just gonna keep at 99 for now and I'm also just gonna do another folder and which I can just copy in here called portal gun so we've also got a gun inside this folder called portal gun and that is gonna cost us 77 points so we've got our two guns now in the shop items folder we've got our server handler script we just need to add one more thing which is our remote functions so remote functions they allow you the client which is the player to talk to the server so the client can make a request the server and the server can send some information back so for example when we click on the image button here we're gonna make a request from the client to the server and we can ask how much the gun costs and then the server is gonna send back to us he's gonna send back feedback the cost of that item so that you can't exploit either game to change how much everything costs so let us insert a remote function in here and we're just gonna call this one get info so one of them is going to be for getting information about the tool and we're going to just duplicate it I'm gonna have another one which is called check sale I'm gonna get onto that a bit later on but check sale is going to make sure that the player that the transaction is legal and that the player is allowed to buy the specific tool so let's head back to our local script then and we're gonna want to do we want to define a couple or variable right now so we want to firstly define replicated storage so that is where the remote functions are so we can say local replicated storage equals game come on get serviced and then in speech mark so we can say replicated service that's replicated storage okay so this is a replicated story it's where all of our remote functions are and we can just quickly say replicated storage to get to them next we want to define the selected item value so we can say local selected item equals script doctor and got parents doc parent weight of child selected item so we're just waiting that selected items to be added into the game and this is the value that were going to update whenever you click on the one of the gears we can update the selected value so that when we click the Buy button we know what we're going to purchase so the next thing the next variable want to declare is the selected image label here so you can say local selected image equals script not parent dot parent dot parent the item description and then we can say wait for child in fact now we don't need we can say wait for child item description dot selected image okay and then what we're gonna want to do is we're going to want to define the selected name which is the text label inside of the selected image so we can say local selected name equals selected image and then we can say dot selected name and that is what we're going to update with the number of points of how much something costs so we're going to want to now have a mouse button one click event so this is gonna run whenever one of the image labels have been clicked and what we want to do is we want to make your remote function request now so we want to request to one of our remote functions to get some information about the tool which has just been click so we want to get the price of the tool so we can say local price and then we can make a call to our remote function we can invoke it by saying we can say replicated storage and then once they've got get info and then we say invoke server and then we can pass we can pass through to the server script a parent or name because this is the the name of the tool remember I said the image buttons need to be called the same as the actual tool object this is because we are passing the name of the image button and that is going to work as the tool name so that when this request is seen by the server we can see that the player wants to buy this specific tool so just so that the both the tool name and the image button are the same it just makes it easier to know what the player wants to buy so we just need to make sure that there is actually a value that's been returned for the price so if price is not equal to nil then what we can do is we can update the selected image selected name and selected item values to the to link to the tool which is going to be bought so we can say selected name dot text equals price and then double dot and then in speech marks we say points with a space so we're concatenating the price with with points so it will show up how much the items going to cost what's wrong here selecting that home a spelling mistake up here on the variable just make sure that selected name and then what we're going to do is we're going to update the selected image so reflected image dot image equals and then we can say script dot parent or image because we just want to update this image here well to update that to whatever the clicked image will be so you can just say script or parent or image and then we just want to say selected item value equals script dot parent got name so we're dating this value here to whatever the image buttons called so if we selected hyper then this would be called the value of this during value would be hyper so when we click on the Buy button we can easily find out what is selected so that is all we need to do for the for the first part which is actually getting how much it costs let's just have a look and see if it works you can open the game and we have a small error let's have a look what it says it says silletti name is not a valid member of image label on line 4 let's have a look selected name is it has a capital S force let's name let's try it again I tries to leave the errors in for you guys so you can see what's going wrong and how to fix it I so you can see we've got the hyper laser gun and if we click on it nothing happened ok and we can click on this one and nothing happens ok let's just have a look something might be going on here so our heart of course no wonder it's not working we haven't coded it on serviette whoops that was my bad so we actually need to code the request here to to actually get the information and send it back so no wonder it's not working because you haven't done that yet so what we can do in this service scripts and the server handler now what we can do is we can create an event for when the remote function is fired so to do that we can just say replicated storage I want to make a variable for that at the top so local replicated storage equals game get service replicated storage ok and then we just want to do another variable for the shop items it's a game and get service server storage because that's where the shop items held wait for child shop items so this is where the tools are held okay so we've got our two variables we just now want to get the replicated storage and then we say dots get info on server event kernel connect function and then we want to have an argument here that will be the player that requested this remote function and also the item which they have chosen and then we just want to return back the price of our item so we can say return shop items and then we say item in square brackets because that's the name of the item got points value so that's gonna return back the the points how much it costs so if we try out the game now and let's just have a look on server event it's not over our course yet I know what's wrong here so this is a common mistake what's happened is it's this event has been written as if it's a a remote event but it's actually a remote function which is a callback function so because we're returning something we have to actually write it like this so we can say dot get info and because it also Roemer event we're gonna have to say on server invoke equals function so on server invoke means that when it's been invoked so it's it's a remote function not over my event so you have to invoke it and then the event looks a little bit different because you say equals and then we just declare this function here so if you try this again I think there might be another error yet because we need to get rid of this this bracket let's run it again and there we go you can see it we've clicked the hyper laser gun is found how much it costs and it has returned back at the price so it update that text label and we've also updated the image labels image so we need now we need to put this local scripts into the other gun so whenever you're making a new gun make sure that this local script is inside it's image button and now we can get started with the Buy button so let's insert a local script into the Bible synth and let's get rid of this print hello world and what's happened here is we want to define a couple more variables so we can just quickly take this replicated storage variable to get us started from the other script and then we want to define the selected item so we're going to want to say local selected item equals script dot parent parent or parent weight for child selected item and we want to also get the well we also want to now have some variables for the button so if the purchase failed we want to show a / ed color so local red color equals and then we want to do is you want to select a color for this so color 3 so I can just say cut a 3 from RGB and then we can do a red value so let's just do 255 so that's 4 red unless add a little bit green and blue in so it looks a bit like a persimmon color and then we can do local green and color equals color 3 dot from RGB and then for this one the color that we're going to use is 2 2 3 4 1 1 1 so it's mainly a green color just to show that the purchase was a success so now that we've done that the next variable we want to create is a time delay which is going to be 2 seconds so when they click the button and it says purchase failed or put your success there'll be a 2 second delay before it goes back to saying bye so we want to do is we also want to just define another variable called success and you'll see why we're doing this in a moment but this is just so if we can tell whether the purchase will success or not and then we'll allow them to to buy the item so we're going to want to insert a mouse button click event like this and we want to make a remote function request again okay so we want to set success to false for now whoops spelt it wrong so Express because we don't know whether it's gone right or wrong but if it did go all right when we get the request back we updates the success value back to true so we can say if selected a voucher selected item value is not equal to nil then we can make a request to the remote function so if there is a selected item then we can actually request to make a transaction so we can say success equals replicator storage check sale invokes server and let's add in the other bracket and let's give Li selected let's pass through the selected I can't talk today selected item value we want to pass that through and what happen is we're gonna script it so that the you remote function the server script will either return true or false so it would either be a success or it won't so we can check to see if the success then we can have an else here and in this block of code we're just gonna say script a parent of text equals success and what do we say purchased we can wait two seconds in fact we wait the time delay because that's what we've defined as a variable and then with no script or parent text equals by just like that and then we just want to do the same thing in the house doing in case something did go wrong we want to say purchase failed and we want to wait the time delay and we're also just gonna put it back to buy but we also want to change the text color here so we want to say script or parent text color 3 whose green color and let's just put that over here as well in the success just so that if it was I clicked while it was red it goes back to green and then we can just make it red here for when it's a purchase failed 3 equals red color just like that so there we go we have got our Buy button complete all that's left is for us to code the check sale serverside so we can do the same thing here we can copy this this one server invoke and just paste it and change get info to check sale because we've got the same arguments of player and item and then what we're gonna do we're just gonna get rid of this return we're gonna make it a bit bigger and we're gonna want to say local price equals shop items so we're getting the price again so item in square brackets that's the name got points got value and then we can say if player leader stats got points value is greater than or equal to the price then we've got another if statement here and inside of here we're gonna want to have an else where we can return false because if they haven't got enough money we know that the purchase is gonna be a fail so we want to return success as false otherwise we're gonna return true and here's where we want to handle the we want to deduct the points from their balance so we can say player dot lead you start stop points dot value equals player that leader starts two points to allow you take away price this deducting it from their account balance and then what we're gonna do is we're gonna say local gear which is the tool equal shop items and then square brackets item because that's the folder then we want to say item again because inside the folder there will be an object with the same name which is the tool and I want to clone up and we want to put this in the players starter gear so that they get it when they reset and we also just want to clone it once more so that we can put it inside of their backpack so the backpack is where it shows up on your inventory you can select it but if you reset the backpack gets cleared but if it's in your starter gear as well then it's gonna go back to your backpack when you reset but it doesn't save I do I'm gonna have a weapon saving tutorial out very soon so make sure to watch out for that on my channel but apart from that I think that is everything let's go and test this out and make sure that it works so there might be a couple of errors so we'll sleep so we're gonna click on the items you can see the updates with a selected item click on buy you can see we have been given the tool you might not be able to see it because the GUI is in the way just try and buy another item being see we can buy as many items so you want don't worry about the error it's just an error in the tool I didn't make the tool but you can see we can shoot you can do anything you can update this with your custom weapons and it will still give you the weapon as long as you change the names of everything but just to finish off let's just add a little toggle button which will allow us to open and close the GUI so to do this we're just gonna wait for it to come back I know roblox studio has been having a couple of loading issues recently but that's alright and we're gonna insert a text button I'm just gonna quickly drag it over here it's not gonna be the best button and we're gonna change the style I'm gonna make the text white I'm gonna make it text scaled and just say shop and inside of here we now have a local script and then we can say mouse button one click event so swept up parent or muss one button one click so when it's been clicked when you say script doctor and doctor in mainframe doc visible equals not script or parent or parent up mainframe not visible so this will just change the main frames visibility to the opposite of what it currently is so it's kind of like a toggle so if it's on it'll go off if it's off its off it'll go it will come back on so there we go we've got a little toggle you can see you can close it and we can reopen it and we can buy things I think if we reset you should be able to keep your items hopefully because it's in the starter gear yep you get to keep the item and I think that is everything we just want to actually change this to we want to make this GUI I want to make the mainframe invisible for now so that it can be opened it doesn't open up straightaway but there we go that's the end of this tutorial on how to create a shop which can get you gears when you pay virtual currency don't forget to check out my other video on how to make currency system because this these two videos were made for roblox their relations are you'll be able to see the article on their medium page I don't forget to subscribe to my channel Alvin blocks for more roblox scripting tutorials I should have liked the video a ton on the notification bell and I'll see you in the next video the sound blocks telling you to keep scripting