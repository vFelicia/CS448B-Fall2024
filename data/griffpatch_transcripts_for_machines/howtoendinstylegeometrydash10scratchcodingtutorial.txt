hello fellow scratchers the end is no no not the end of the Geometry Dash series but the end portal of our Geometry Dash levels and this is a key moment where the player gets to celebrate their victory in style so we need to make this look amazing just look at those awesome particle effects we are going to have a lot of fun creating this one firstly we'll need to Define where are levels end a simple update to the level with a color trigger should do the trick then comes our delightfully apocalyptic particle system followed quickly by the players's end of game animation sequence sending them tumbling through the air and into the center of that most sucky of portals no mean feet so all that come and more are you excited yes me too so open up your projects from where we left off in episode 9 and we'll take a moment to save them as a new copy for this this is episode 10 guys let's get scratching we'll Begin by defining the end of our levels so click into the level Sprite and open the costume editor I'm going to go and copy a run of tiles that I can reuse to create a vertical wall and then to make testing easy I'll duplicate the very first costume and create my end portal right here at the start let's name it end one okay so paste in those tiles and build your end wall use shift to keep things aligned and it wants to be as tall as you can possibly make it then smash that green flag and we can check it all looks good smashing literally to give it a bit of a glow I'm going to draw a rectangle on its left Edge and then switch it to a gradient fill from transparent on the left to Canan blue that looks really nice all we need to do now is put a stop to the level scrolling the moment this end wall appears in view to trigger this we'll use a new unique color so just change the Hue away from San just aad and then we'll draw an 8 pixel wide line down the left edge of the wall holding shift like so perfect if you are having trouble drawing this then I'll make sure to add it to my asset project linked under the video here it is under the level asset Sprite now to detect the bar of color entering the screen make the level Sprite visible on the stage so that we can see the end portal and then create a new Sprite we'll name it end detector no prizes at guessing what this is for and I'm going to draw a bright red square starting two grid squares above Center and dragging it out to the left to be four by four grid squares in size that's 16 pixels so we want to detect the portal once it Scrolls a little way into view so move the detector Sprite on the stage to just around here right to the code when green flag clicked go to XY and I'll round these values off to 220 by zero and the game begins when I receive game on we'll first wait for 1 second this is to allow the game to start and to ensure we don't accidentally trigger the end of level at startup and now we wait until our detector is touching color and then very carefully use the Color Picker to select the bright bar of color next to our portal then when that happens what do we do we stop the level scrolling any further by setting scroll speed to zero great let's give that a test and here comes the portal oh wait what that was a complete failure wasn't it did I not pick the correct color oh the weight let's try 0.1 seconds instead I bet this will work yes oh my gosh that had me going for a moment next up we're going to add in those beautiful particle effects for tast and a new message level complete now for the particles to appear in all their Glory we'll want to scroll the screen up a little bit to give us some more space to work with when I receive level complete Loop forever and we'll check if the floor is on screen if camera Y is less than floor shimmy then yes the floor is still on screen so we want to smooth scroll it downwards change camera y by and we'll use a round block and then we multiply by 0.1 for that smooth scroll effect and we want the difference so use a subtract between floor shimmy and the current camera y let's see that in action shall we and again nice the level snappily Scrolls down to reveal more portal which means it's time to create something awesome the end portal particles if we look at the official Geometry Dash the way these appear to work is that they spawn in a semicircle around the center of the end portal and various sizes and speeds they get sucked directly into its core shrinking as they do well then particles we already have two Sprites for these particles and particles too do we need more tell you what let's rename particles 2 as explode particles so we remember what it was for and now yes we will create a brand new Sprite naming it end particles I'm keeping all these separate just to avoid making the code more complex what we will need is to copy the particle costume from the explode particles into our new end particle Sprite nice we are ready to code this up first let's initialize things when green flag clicked hide only when we receive a level complete do we want to start spawning particles and lots of them repeat 10 to gradually bring them in and then create clone of myself but not just one six create clones all at once doing this 10 times over will give us six particle clones in this end of level effect nice now we want to position the new clones in a semicircle around the center of the end portal which happens to be where we placed this end detector Sprite when I start as a clone show and go to the end detector now we spread these particles out in a semicircle point in Direction pick random from 0o point 0 to 180 and then move by 200 steps yes that is backwards because we are backing them up ready to fly forwards back into the portal to test this Theory click the when I receive level complete script and watch all 60 clones form a beautiful semicircle very cool I do note that these particles are displaying rotated and we don't want that so click on the direction input and switch to don't rotate tap the stop button to reset the clones and then click the level completed script again excellent they are all uniform however we don't want them to appear in a perfect line like this so distribute them out by moving by a pick random between 30 and 200 great that did the job finally then let's mix up their sizes to set size two pick random between 75 and 110 now let's get things animating each particle wants to travel at its own speed so make a new variable named speed ensuring it's for this Sprite only then we set speed to a random number between 40 and 14 feel free to play around with all these numbers to see what effect they have on your animation after we get it working now we animate within a repeat until Loop repeating until the distance from this particle to the end detector is less than speed that means if we move forward by speed anymore we would go past the end then we move forward by speed making sure you stopped the project first click on the level completed script and what those particles fly to the end detector that is really good and every time we click it more particles are cloned but after a few clicks we exceed that 300 clone limit and no more particles get generated sad for now click the stop button to reset the clones and then we can test them again okay these particles are too big we can shrink them down over time by dropping in a change size by negative three inside the loop that's better okay we need these particles to not stop and to keep running the most efficient way to do this is just to recycle them in a loop over and over again so bring in a forever block and we want all the scripts from the set size block onwards separate those off but before we continue duplicate the goto pointing Direction and move blocks from up here and drop them onto the the end of the repeat until block down here this will reset each particle then drop the entire script into the forever Loop and join it all together so why did we add a duplicate of these initializing scripts down here simply because we wanted the new clones to appear further away than the initial ones that we created at top so replace the 30 with A180 instead okay here goes nothing click the level complete script again and behold that is one cool effect don't you think is there anything we could improve well I'd quite like the particles to be shrinking even smaller I think we're currently hitting the limit of how small scratch will allow our particles to go but that's easy to fix we just need to draw a larger rectangle around the particle and then make that transparent now the costume is reported as being over 60 pixels wide so it should be allowed to shrink down more and yes it does perfect that is the effect we were after we've got to see this in game but first click into the end detector and drop a hide block under the green flag script guys are you ready for this smash the green flag and we'll see this all put together oh yeah this is looking perfect don't you think it's really got that Geometry Dash Vibe I'm just so looking forward to getting the player to hurtle into it too but we've got some work to do to make this happen in our player Sprite scroll down to the game on scripts you see we have a concept of the level scrolling speed but to allow the player to move when the level doesn't we'll need a new variable speed X for this Sprite only this is the Players movement speed so before setting scroll speed drop in a set speed X and we'll set it to 10 now the scroll speed can be adjusted to be the opposite of our player speed so subtract speed X that will still be 10 in this case next in the forever Loop below before we change y We'll add a change X2 and we add together the new speed X and the scroll speed you see under normal operation these cancel each other out moving 10 to the right and scrolling back 10 to the left but when the scrolling stops the player should now shoot off to the right just like that excellent oh well apart from that annoying death Loop but we'll fix that later but let's not get too carried away we haven't yet checked our ship mode I'll need to move the end portal back a bit in the level now watch what happens when the level stops scrolling our ship suddenly points upwards that's because of how we are calculating its Direction let me show you find the ship movement custom block and down at the bottom this pointing Direction script we are using scroll speed in the calculation but now this needs to work off our speed X for when the scrolling stops but we'll need to negate it with a subtract to match the scroll speed testing that again and that fixed it great I must just point out that we could simplify this math a teeny bit now if we want it by removing the subtract from the right and switching the left ad to be a subtract instead 90 subtract the eight and blah blah blah there we go a lot neater and it works just as well now let's study the player motion the next thing to occur is the Players slows down before launching up and being Hur into the portal so scroll down into some free space and we'll trigger this off of a when I receive level complete hat block a small delay of five animation frames using an empty repeat five and then another repeat five this time slowing down the player so change speed X by negative two doing that five times will bring the player speed right down to zero a full stop also we want to gradually bring the vertical movement to a halt to set speed y to itself speed y multiplied by 0.5 halfing its value each frame finally stop other scripts in this Sprite to Halt the main game Loop and then oh hold on we've coded this before just above this makes sure the player is not appearing as a hitbox set rotation style to all around and switch costume to mode and I think we should give that a quick test to see how we are doing oh cool I am liking this we slide to a stop and you'll see that once the main game Loop ends our level is free to fully scroll up to reveal the full portal which is great news let's continue this animation over the the next five frames repeat five change speed y by two to accelerate the player upwards and turn clockwise by speed y I'll use that because it will make a spin faster as we move upwards talking of which change y by speed y to do just that finally add some particles with a create clone of particles this is just just the start to get the player spinning now we add the scripts to bring it all home repeat until the player's X position is greater than 200 that is the right of the screen and we can duplicate the scripts above from the turn block onwards but don't turn by speed y now instead we'll just turn by 10° each time also as well as as changing y we now need to change X too by our speed X variable to make them accelerate towards the portal change the variable speed X by 0.75 and change speed y by now this wants to direct us towards a y position of zero so we can use a negative fraction of the Y position divide y position by 70 we also need to dampen this motion to avoid overshoot so set speed y to itself speed y multiplied by 0.9 want to see how that is looking yes me too here it comes oh wow what a delight will curve that is exactly what I wanted a quick launch upwards and then spinning we are pulled back into the portal the last special effect we can easily add in is the large circular explosion it's very similar to our smaller death explosion after all we'll trigger it using a broadcast for the new message win explosion and at the same time we'll set our players ghost effect to 100 to hide them away now click into the explosion Sprite you can click this script to see the small explosion animation play on the stage its size is defined by this 170 value over here let's make this configurable and make a new custom block to house it in name it boom size with an input named size leave the run without screen refresh clear as this wants to play back as a full animation okay and then make use of the block right away within the game over a script the size wants to be set to the same 170 value used in the old script and that frees us up now to replace the 170 with this size input perfect it works just as before so now duplicate the game over receiver and change it to a win explode then increase the size to 600 yeah super big I hope that works oh yeah let's see that again so what about this music ending so abruptly had you noticed well when you finish a level often the music track will be coming to an end anyhow but let's neaten this up look at the first game on script in the player Sprite this is sadly being stopped by any use of the stoer the scripts in Sprite so we're going to have to move the music out of the player Sprite into a new Sprite of its own named music and then copy the stereom madness soundtrack from the player Sprite into the new music Sprite I'll delete the one in the player Sprite now to avoid confusion next up we can copy the game on sound playing script into the music Sprite too and again delete the script from the player Sprite now click into the music Sprite yeah that's looking good all we need to do is make sure this music is still stopped when the player dies when I receive game over stop other scripts in this Sprite easy testing that we can now confirm that the music continues when we hit the end of the level check and if we smash into a spike then the music instantly stops check and restarts when the level starts starts over check all is good so finally when the level really does end let's fade the music gradually out to nothing when I receive level complete we can wait for 1 second before repeating over the next 20 frames changing the volume gradually by 5 20 * 5 is 100 of course if we do this we must be careful to restore the sound when the music begins again so set volume to 100 before we begin our main music Loop hey talking of Music Loops we might as well terminate this music Loop once the music has faded out with a stop other scripts in Sprite let's give that a go that's good the music is brought to a tidy end of course you may well try to synchronize your music length to the length of your level in which case you might want to remove the forever loop from your music track all together but that is completely up to you the only thing remaining in this episode is for us to try to get the game to boot back to the main menu once we've beaten a level we'll instigate this from within the end detector Sprite but you may want to do this elsewhere it's completely up to you we wait for I don't know say 8 seconds that could be too long we'll see and then we stop other scripts in the Sprite specifically the script that Scrolls us upwards and then broadcast to restart the main menu a new message main menu okay let's go around our Sprites making sure they behave correctly now the menu Sprite first we need to replace these green flag receivers with main menu receivers instead both of them the player right next this green flag also needs replacing when I receive main menu the level Sprite that doesn't have any green flag scripts but it does need to reset when I receive main menu hide and then delete any clones lastly the end particles similarly when I receive main menu delete this clone is that it let's check uh nope our main menu has disappeared all together ah I know back into the menu Sprite we never kicked off the main menu scripts when green flag clicked broadcast main menu of course and that looks best better but let's check out the level restart normal death is okay and now wait for it yeah I knew 8 seconds might seem too long one eternity later um what's this gosh I'm not doing so well am I H looks like I forgot to reset the player Sprite fully and the level scrolling too I know what it is in our player Sprite scroll down to just before the main game Loop we need to duplicate the set speed X and set scroll speed blocks here and we'll set them in the main menu script to get level scrolling once more then to bring the level back into view we need to also set camera y back to zero lastly to reveal the ghosted out player drop in a clear graphic effects block two too is that it are we done smash the green flag and we'll take a look I'm flying through the level to the end now and waiting yes it was worth the wait it's all beautifully restored once more man that was a ride but we finally did it we can stuff that end of level costume wherever we need it in the level and the game will play out perfectly all it needs now is a splash screen to congratulate the player on beating the level but I leave that as an exercise for you if you'd like to keep that a go yourselves either way I'm dead excited to see how your projects are getting along so do submit them to the scratch Studio linked under this video so what is next for this tutorial series I would expect we can now turn our hand to exploring more of the exciting game elements like jump pads and orbs other player modes I can't wait for for those and also how to add more than one level now that would be awesome right if you agree then please smash that like button and don't forget to subscribe to this channel checking the Bell icon so it's not to miss the next exciting episode the moment it drops but until next time thank you for watching have a great week ahead and scratch on guys oh