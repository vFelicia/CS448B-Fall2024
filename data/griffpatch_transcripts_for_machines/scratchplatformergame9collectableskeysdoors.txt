hello fellow scratchers here's a question how do we make our games exciting and keep players hooked collectibles yes everyone loves to collect things no seriously we're addicted put a coin a lemon or an apple in our sights and even better temptingly jangle it up and down then my word we are simply driven to find a way to make it ours i'm griffpatch and in this part 9 of our classic platforming series we'll not only learn how to scatter delicious apples throughout our level but also how to add other enticing special items such as working keys that open actual locked doors how cool is that yep this is a real game changer now if you've been following along with this tutorial then don't panic that the game is suddenly looking different no you've not missed an episode did you catch last week's tutorial on pen special effects that make your game go pop well all i've done is followed that tutorial in the level sprite of this project and we've drawn the levels to make it fresh if you didn't catch that tutorial then i've included a link under the video that you can follow if you wish but don't feel you need to it won't make any difference if you decide to skip it and keep all your hard work just the same and unaltered everything will continue to work just fine as a quick overview here are my new level costumes they are really simple just plain filled shapes no outlines or anything i've gone for a much more chunky confined feel to the levels this time so that i can keep the player fenced in and give them direction my danger costumes have been upgraded to these exciting spikes filled with red and black gradient fills to contrast the purple of the level and as for the platform's bright i don't currently use any of these so i've disabled them by separating off the ifs within the change scene event here but don't delete the event receivers and scripts because we'll be using them later on in this episode to add a working locked door now back to the level sprite you'll see we have new scripts in here these are from the cool pen effects tutorial a link to which you can find under this video the only thing to notice is the pen effects are triggered here from the when i receive change scene block not from the when green flag click block okay cool and that's it so let's take this for a spin watch as we run the project and the pen stamping kicks in and makes our level design pop i love how the level is lifted off the stripy background when the outline and shadow effects are applied right then before we begin make sure to save this as a new copy of your project name it episode 9 and let's get scratching we'll start simple and then build things up first we want a nice new sprite to represent something we can collect a collectible i'm going to create a new sprite but for convenience and because i want an apple i'll pick from the scratch library using the magnifying glass here and there it is the apple sprite great there it is on our project stage so drag it to where we want it to appear it is however really very much too big poor scratchy won't stand a chance against this beast of an apple now we could size it down using the size block but this time i'm going to go into the costume editor and actually shrink it down as a costume edit the reason i just want to make all collectible costumes their actual sizes so that when we have other types of items to collect we don't have to keep using size blocks for each one oh dear did you notice the side of that apple has been cut off if you want to fix this then there is a trick to sort this just draw a rectangle around the entire sprite and make it transparent there that fixes it believe it or not okay to the code we want to set up this collectible to appear in the same place each time the game is run now ensure the project is stopped before we start coding when green flag clicked we switched costume to apple and go to xy now look because this project was stopped scratch has auto completed the x and y with the position of the sprite on the stage that's neat and it saves us time so next up with the costume positioned correctly we want to wait until it is touching the player this is great because as soon as the player touches it we want to collect it right the quickest way to show that would be just to hide it that we can do but you know i want to also play a sound click into the sounds tab oh yay the chomp sound is already here i wasn't expecting that as i don't often use preset sprites but scratches added a default sound of chomp for us how clever well that's perfect we'll use it so as well as hiding we'll now start sound chomp hit the green flag and we'll give it a go chomp the apple is gone did that seem too easy i hope so because if we start the project again ah no apple it's still collected not to worry we just need to make it visible again so here we are back with our apple but issue number two if we walk off screen the apple is also here on the second scene too we need to ensure the apple knows what scene it belongs to we want to trigger the visibility of a change of scene so when i receive change scene then with an if else block we compare the current scene variable to well for now this scene scene 1. if it is scene 1 we show it and if not we hide it run the project and voila the apple is showing on scene one but running onto scene two great it's gone very good indeed good enough to eat ha oh wait look the apple is back that's not how it's meant to work but it does make scratchy a happy cat oh no no it doesn't at all because he can't collect it i'm so sorry scratchy so what is going on here well look our collection code is running here on the green flag script so once collected we are never waiting for it to be collected again making that impossible but when we change scene again we do still show the hidden apple once more but as i said we are not waiting for collection any longer so that's exactly what we are seeing now i have a cunning trick to show you that fixes our problem i think you'll like it because this trick dates back to the very earliest days of computer game programming first make a new variable naming it my scene and make it for this sprite only we can use this to store the scene number the apple belongs to in which case we'll set it to 1 after the green flag is clicked that then allows us to use the my scene variable in place of the if scene equals 1 over here great so this should not have made any difference yet we can just test that yes indeed just the same but now we have a special trick up our sleeve drop in another set my scene block after the apple has touched the player here and set my scene to the empty value wow what does that mean what have we done to this poor harmless apple setting its scene to nothing well hit the green flag and we'll give it a test it appears as normal we can collect it my scene changes to empty you'll notice and now when coming back to scene 1 the apple remains invisible superb what we have done is not delete the apple but we've sent it to a different place the null room yes a mythical storeroom outside of the level where all nonspawned items reside this is a very common technique for keeping track of items from a game that are not currently in play now when we change back to scene 1 the apple's my scene is not one anymore so it simply remains hidden problem solved so this is fabulous for a single collectible but the thing about collectibles is the more the better in this case we really need to branch out to using clones clones will allow us to place our collectibles all around the level and keep track of which ones have been collected the transition to using clones is not too difficult either bring in a when i start as a clone this is triggered for every new collectible clone that we create so it's perfect for us to move the wait until script stack into like this now each new collectible will wait to be collected independently from each other we just need to drop in a create clone of myself after positioning the sprite here to trigger a new clone copy of our collectable to appear and it will start waiting to be collected the only addition we also should make is to set my scene back to the empty value after making the clone to ensure that the collectible sprite the one that is not a clone is kept in that null room and is not visible we only want our clones to be showing up now okay sanity check test this should work identically if all i've told you is true yes sweet we have transitioned to clones all ready to ramp up production and spawn a whole load more apples for collecting but not so fast because some of you may find that your collectibles don't always appear now don't believe me well watch this here everything starts up fine and the apple looks quite delicious yum but if i happen to select and drag scratch cat on the stage not an uncommon thing to do right behold a disaster beyond your imagination has occurred the apple has gone what in the world right if i didn't know the reason then this would be so frustrating the apple reappears if i come back into the first screen too to get it working again i just make the apple visible and drag it around on the stage and now clicking the green flag again and we're back so this is not a satisfactory state for the game to be in it's too temperamental to solve it you need to first understand what is causing it firstly did you know that dragging a sprite on the stage like we did always brings that sprite to the front of all the others it's like clicking on the go to front block the second thing to know is that the order the sprites are in on the stage makes a difference to the order in which their scripts are run yeah the one at the front will run first be it from an event receiver or the green flag clicked this is a common source of bugs in games where the order of sprites is not always the same the first time the green flag is clicked in our case if this collectible sprite is the front sprite then this green flag script runs before all the others so we are able to create these apple clones first then the green flag on the player sprite runs which starts the game loop but also broadcasts a changed scene event as it sets up the first scene doing so will trigger the change seen here in the new clones and the apple clones appear so where does this go wrong if the player sprite is the front most sprite well if the player sprites green flag script runs first then the broadcaster change scene happens before the collectible green flag has run and therefore before the apple clone has been created that means that once the apple does get around to being cloned the when seen change script has been missed and the apple doesn't reappear right fixes what would you do about this well we need to take control of the order the scripts are running so let's remove the when green flag clicked from the collectibles initial script we'll replace it with a new event receiver when i receive and make a new event we'll call it setup then in the player sprite under the green flag script we'll add a broadcast and wait block for the new event setup we broadcast it before the reset and begin level block the important thing here is that the weight from the broadcast ensures that the collectible sprite has finished creating the clones before this script continues to run this should solve any ordering problems so let's give it a quick test looking okay so i'll drag the player sprite to bring it to the front and then we can click the green flag to see yes the collectible is still with us bug squashed well done phew with that out of the way let's push on with these collectibles click back into the collectible sprite what we want now is to bring more apples into play to make this easier i first click on the show icon here this makes the real sprite visible as well as the clone so i can drag the sprite on the stage it just so happens to be on top of the clone and i want my new apple to appear just here next we need a new go to xy and create clone block we need to type in the new x and y locations for me that's negative 27 and 43. then be careful to drop the two blocks before the set scene block and let's run the project now we are seeing two apples and i can collect them both nice if we test again i can also confirm the collection of one apple and switching screens shows only the uncollected one remains visible as we might hope that's perfect really great so what if we want an apple on another scene do you know what we need to do easy make the apple visible drag it to where it wants to appear but this time duplicate the scripts so that we have a set my scene a go to xy and a crate clone block i fill in the my scene value of 2 followed by the x and y from the sprites x and y that's under the stage and pop the scripts above the set scene block a quick test scene one and now scene two yes there's our apple sorted so easy easy indeed but soon this setup script will begin to get too long being good coders we should notice that we are repeating the same actions over and over to make our new collectibles so this is a prime candidate for wrapping up in a custom block so make a new block naming it place since we are placing collectibles on the level then we need an input of costume name a label scene with a matching input of scene and then finally a label x y and two inputs x and y might as well tick the without screen refresh okay then so this block is going to do everything we need to create a new collectible all in one go that's these four blocks then now let's see how these values plug into a fresh new place block the first input is the costume name that's apple notice we use a lowercase a just like the costume name here then the scene is a1 my x is 155 and my y is negative 25 just the same with that done let's plug in the blocks inputs in the custom block too costume name to costume name scene to my scene x to x y to y awesome then we have to do the same for the next two collectibles too duplicate the place block and fill in the scene and the x and y values there that's all three collectibles recoded to use the same custom block we just have one block left over this sets scene to empty value now we could pop this on the end of the setup script but i think it's cleaner to put it at the end of the place custom block itself that then means we don't have to remember to keep it at the bottom of the setup scripts and this makes our lives easier throw away the rest of these old junk scripts and we are ready for a test two apples on the first scene excellent news the second one yes all is well i am pleased so how about we add a new collectible apple up here using our place block just duplicate a new place block set the scene to 103 now since we've moved up a level to position it make our sprite visible and i'll place it up here so that you have to wall jump to get to it then fill out the x and y position into the place blocks x and y like so that's it even easier than before wonderful run the project oh man did you hear that munch sound as the game started does that give you the shivers too i have a feeling we have a bug i'm expecting that when we get to the upper room oh yes the apple is already gone so what happened there well as soon as we create a new collectible we start checking for collisions the collectibles are only hidden though once the scene changes so there is a moment when the game starts where these collectibles are visible and can possibly touch the player so to stop this we need to be more careful and ensure we hide the collectible sprites before we even start cloning there another potentially dangerous bug squished now we have the positioning of these new items sorted we should look more into making them look nicer somehow when you bob an item up and down it just becomes irresistible like you're saying come and get me so where will this animation script go well it has to occur while we are waiting for it to be collected that's here in the when i start as clone script so how about we replace the wait until with a repeat until touching player block now we can do an animation in here while we're waiting we want to change the y of the sprite gradually up and down for that we need a multiply here for say 0.5 we can play with this value to give a bigger bobbin effect and then use the maths syn or sine operator to give us a nice smooth up and down motion now you might feel tempted to use a timer variable in the right hand side but just to warn you that would lead to your collectibles appearing in slightly different places than you intended so to be consistent i'll make a new variable frame for this sprite only and use that in our sign block next change frame by 5 this value indicates how fast our object will bob up and down and finally set the frame to 0 right at the start of the setup script cool we can take a look at what we have made yeah look at that bobbing that brings the level to life doesn't it and makes them so much more desirable to collect too i think to complete the effect we just need to add a collection animation too as they disappear so back in the when i start as clone let's add a repeat 20. and we'll change y by 2 so gradually moving it upwards but while we do that we'll also fade it out using a change effect block that's changing ghost by five that will be a hundred divided by twenty that's five stuff that in before the hide block and that should do the job let's see chop yeah that's nice oh but wait how many apples have we collected we don't know we need a count well that's easy make a new variable call it apples for all sprites now after we play the chomp sound change the apples variable by one we just need to be careful to reset it to zero when the game begins so for now up here in the setup script just set apples to zero test again yeah no problem that works as expected and it resets too so that brings us nicely to the most exciting part of the episode where we look at expanding our collectible items to include special items such as a key oh yeah baby let me find somewhere to place it and this looks like a fine spot we need a new costume so in the collectible sprite enter the costume editor and we'll add a new costume again from the library since we have it i'm looking for yeah a key this one is perhaps a little more detailed in depiction than i'd like but it'll do for now we need to click to make it visible on the stage oh oh that's far too big i'll just rotate and resize the actual costume in the editor and now we can drag it into position on the stage there next the costume name it says key that would work but i'm going to change it to key space one this is so if we wanted to extend the game to have more than one key for more than one door we still can then we could color them or something to tell which doors they opened yeah that would be cool right back in the code editor we can duplicate the last place block the costume must match our new keys name exactly it was key one with a capital k this time the scene remains as 103 like our last apple but the position is 192 by 4. there we go this is exciting time to give it a test rushing through the level and here we are and we have a key yeah can i collect it oh man what sort of sound was that for a key a munch no no this has to change the code for playing the chomp is here in under the when i start as clone in the collectible sprite let's find a new sound for the key in the sounds tab in the library search for want it may not be perfect but it's not half bad is it so separate off the chomp sound and the change apples by one these should only occur now for apples we'll bring in an if else block and we place the apple script in there the repeat can stay below to animate the collection for all items to detect if this was an apple we need to check the costume name if costume name equals apple great that leaves us with the else where it's not an apple but something far more wondrous something deserving of us starting the wand sound perhaps yeah that's great but let's not change apples by one since this is not an apple no we need a completely new way of keeping track of the other special items we have collected to do this how about we use a scratch list click to make a new list and we'll name it collected and mark it for all sprites so its data can be shared throughout the project what we'll do is add an item to this new list after playing the one sound and what we add must uniquely identify the object we've collected so why not use the costume name again shall we see what that does run the project ready oh yeah that's cool new sounds and more importantly a key one in our collected list that's beautiful as you can imagine this list can be allowed to get as many items in it as we collect so it's very flexible what we do need to remember is to clear it down when the project starts no we don't start with a key let's stuff that into the when i receive script here delete all of collected sweet so tell me what uses a key without a locked door well not very useful so i think we'd better get busy this looks like a prime position to place one don't you think now we made a door before at least sort of we did using a platform it just went up and down by itself we are just going to code this all over again though click into the platform sprite and let's make a new costume for this door before i forget let's give it its name now this may seem a little odd but go with it and we'll also name it key one now the nice thing about this is it will allow us to easily match it to the key that opens it so we can draw a nice yellow door and i'll make sure it has a little lock hole on it so the player knows that they need to find a key there that looks fine next we go into the code now if you remember under the when i receive change scene receiver i separated off all of the old scripts when i changed my level so unless you are also starting again just leave all your ifs as they are what's important is that you add a new if under here for the room with the door in it this is scene four for me so if scene equals four then now we need a new custom block to handle our doors name it door at with an input of x and an input of y and then a label of key and an input of key name don't tick the run without screen refresh though as we will be animating the door within this custom block now move this custom block into some space and i'll drop the new block inside our if here ah this leftover show can just be plonked in the custom block so door at we need a position first drag the door to the right place on the stage we can use this to fill out the x and y values as normal and the key input that wants to be key one with a capital k just the same as our item in the collected list great i'm just going to move this define block into some free space oh look i forgot i'd left this animate block in here this wasn't included in a tutorial but was just me trying some things out it animates a platform back and forth between two points but we don't need it so don't worry yes a door we begin by showing the sprite and then switch costumes remember we named the door as key one so well switch costume to the key name input easy positioning the door is equally straightforward use a go to xy block and pass in the x and y input variables now the action of opening the door wants to be repeatable over and over so bring in a forever loop we'll wait until the door is touching the player before we take any action what happens next depends on whether the key has been collected or not using an if else we can check if the collected list contains the key and since the key has the same name as the door costume we can use the input variable keyname here too so if we touch the door and have the correct key in our collected list then the door wants to open let's animate this by repeating for 24 frames and change y by four that will get our door sliding upwards nicely next we'll pause it at the top for one second wait one second before bringing it back down again for this we repeat 24 again but change y by negative 4 to reverse the direction completely excellent we should be able to test this right away if we run straight over to the door we should be unable to open it since we have no key in our collected list so let's get the key and here we go and now yes celebration that's right you dance scratch cat because this is awesome it's really fun how it opens and then closes and you can keep on walking into it to open it again i think this might benefit though from a little bit more sound and i know there are some nice sounds in the scratch library that we can use here so in the platform sprite sounds tab we'll search up some new sounds they have buzzwor we'll use this for the movement of the door as it opens and shuts crunch but click louder twice as otherwise it's too quiet this is for the door pounding closed and one more low squeak this one i'm choosing to indicate that the door is locked back in the code in the door at script drop in a start sound and we want the buzz were sound pop that before we begin the upwards animation of the door here and we want to play it again before we begin the downward animation after the second delay then as i said the crunch sound should play when the door hits the ground that's here before the last weight start crunch sound lastly the else condition down here we haven't used that that is for when we touch the door but we don't have the key now i want us to start playing the low squeak sound however do you spot the issue with doing it that way watch this or should i say listen to this ah nasty the sound is starting to play over and over in a fast loop which makes it sound awful we just want a single sound each time we touch the door for this we just need to wait until the player walks away from the door before continuing the loop wait until we are not touching the player there right testing that again ah now beautiful just a single squeak that's good feedback now let's grab that key and try out the opening and closing sounds oh yes loving that and the crunch at the end is so very satisfying indeed i'm noticing that the door is not feeling very responsive to being opened a second time it takes a while before it goes up again oh yeah that's because we duplicated this wait one second after playing the down crunch sound this was to hold the door up before it came down but we don't need to wait once the door is closed so let's remove that okay so now the door opens right away cool and if we stay next to the door it doesn't just open again but requires us to back away and try again that's perfect isn't that working great i bet you can't wait to get this into your projects and don't stop with this idea what else could you trigger using a key or the pass card or anything else so many possibilities oh no i got squashed and now i have to say that losing a life here is far too quiet after having all these doors and collectibles making sounds we must quickly address that before we draw to a close click into the player's sprite and the sounds tab and we'll choose a new sound from the library there's one called oops oh man look at this why does scratch think all these words match the word oops that's just not helpful well we'll have to find it by hand it's in the effects category luckily it's alphabetical there it is oops next back in our code find with me the when i receive lose life script and before we begin the fade out start the sound oops so here we go testing sharp pointy spike death boom we lost a life and we know it the sound is very confirming of that nice um so any more sounds we were missing well apart from maybe a nice thumping soundtrack the main one that might be missing is the jumping sound now this needs to play in the define controls up and down script there's two places to do this in here just look for where we are set jumping to one we start sound jump here above the set jumping to one this is for the wall jumping and then down below we do it again so start sound jump this is the standard jump well let's go jump jump the sound is perhaps a little too loud and over the top for me i'd get annoyed by this far too soon yeah let's tone it down a tad find the jump sound i'm going to start by clicking the softer button three times then i'm going to use the fade out button to shorten the sound there i think four times is good that's nice and crisp let's see how that plays yeah i think that works what do you think is that sounding and looking good and do you have any burning requests that you know we need next i suspect some enemies may be a good plan well as i wrap up i'm just going to add in a final huge apple to reward the player for getting through that door but as i do let me just say i really hope you enjoy this video they take a lot of work so please do smash the like button and if you can subscribe to the channel then please do so i also have a channel membership that you can join which has added perks of priority replies to comments early access to videos and for educators and top supporters downloads for the projects themselves but until next time then have a great week ahead and scratch on guys you