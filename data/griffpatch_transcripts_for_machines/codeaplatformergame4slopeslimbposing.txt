hello fellow scratchers i'm griff patch do you see anything extra cool about this scene apart from that overly large scratch cat oh boy yes look at that pose look at their feet look at their legs what magic is this indeed welcome to part four of our classic scratch platformer tutorial we've covered player movements collisions scene switching and in the last episode player animation that was so cool and today we are talking about character posing and slopes we'll begin by fixing it so our player isn't stopped in their tracks by a minor bump in the road then we'll fix the issue with standing on ridiculously steep slopes and finally you must stay tuned as we add support for new standing poses and automatic feet leveling oh my what an episode of course for those of you who have chosen to use your own player sprite i'm sure scratchy doesn't mind yes this episode is also for you however we are focusing on you scratchy we begin by saving a new copy of our episode three scripts good to keep a backup and then name this one as episode 4. let me just hide these old variable reporters for a clean stage super up until now we designed our level to avoid having any slopes because well our player is completely incapable of even stepping over a tiny lump in the ground at least without jumping of course so we must begin by updating our level click into the level sprite and then the costumes tab i'm going to draw a curved bit of level in the lower right of the canvas draw a square then with the shaping tool select the top right point and delete it either by pressing delete or pressing the delete key then grab the middle of the line and drag it inwards to form a beautiful curve you can tweak it to look just right there that will do nicely while we're at it i'll also reshape this floating platform into a useful diamond platform good that should work well run the project and let's see what we have to work with we are pretty nimble able to jump onto and run down slopes but can we run up no siree we end up just running on the spot not very impressive to fix this we need to look back at our define move in steps custom block this clever block splits a bigger movement into smaller steps so that we can detect a collision and stop the player as soon as that occurs to allow the player to walk up slopes we just need to relax this rule a little and see if moving the player up a little might also get us out of the collision doing this over the course of a full movement will guide the player up a gentle slope okay this is the movement loop and here is where we move the player in the x direction the collisions are detected here so pull out the set x and set speed x blocks we'll make a new custom block to replace these naming it collide x slope or wall attach the define block to the scripts we moved out and replace them with a fresh collidex block great now we can work on pushing the player upwards basically if there is space to move a player up then we should do so therefore begin by changing y by one then check whether we're touching anything solid if touching is greater than zero then we are indeed not out of the ground yet but perhaps we might try moving up one more time duplicate the hole change y stack and put it in the if right so if again we are not out of the collision perhaps we've hit a wall let's return the player's y position back to its original value change y by negative 2. then since this is not a slope after all bring back those two blocks to push the player out of the wall as before finally stop this script but if the player has successfully moved out of the ground then we accept this new position and continue the script without backing out and up the slope we should go nice let's give it a test hit the green flag and down and then back up oh yeah look at that this is excellent news no more stubbed toes or excess jumping for us we are a lean mean hill running machine but perhaps there's something to miss here obviously there's a limit on how steep scratch cat will climb but do you notice how scratchy appears to actually move quicker as they travel up the slope but that's because our speed x is staying constant but we are adding to our total speed by also moving upwards now to combat this we need the act of climbing a hill to simply slow down our player this collide script only runs when we are going up a hill so to slow the player down set speed x to speed x multiplied by 0.95 this is the effect of making hit a speed just a little bit less each time the player is moved up by a collision running that now and wow it's surprisingly effective the slope takes the edge off scrapcats top speed but the last steeper incline that's still too fast okay so duplicate the set speed x and bring within the if above this only runs if we're moving up a steeper incline change the multiple to 0.8 this will really slow the player down a lot more and you can play with these values to get the effect you want for your game green flag oh and i think we have ruined scratchy's hill running dreams but the good news is that it's looking a lot more natural sorry about that scratch cat next we'll talk about the downhill skipping effect oh gosh this is a common problem when our player hits the ground we naturally set their speed y to zero but when running down a slope this has the effect of suddenly making us change direction and literally sends us skipping our way down the slope it's not an awful problem but we can do better we need to preserve some of the downward motion after a collision to allow a more smooth descent find the define move in step script again this time we are looking for the vertical movement that's the y direction down here just like before we'll pull out the scripts within the if set y and below into some free space and then make a new custom block naming it collide y ceiling or floor we'll use the scripts we just removed as the body of this new defined block and pop a new collide y block in their place cool we are on our way so we only want to alter the downward movement after a collision ignore upwards motion for now in that case use a new if this time checking that speed y is greater than zero rather than less than so when it's greater than zero it's moving upwards so just set speed y to zero and stop this script functionally no different from before but otherwise yes we can set falling to zero we're on the ground now but what about the speed y well we don't want to set it to zero but we do need it to reduce in that direction a quick trick is to set speed y to speed y multiplied by 0.8 again hopefully leaving them enough momentum to slide on down the slope but slowing them enough to remove any weird side effects let's give it a test so we run up the hill and then down we go oh cool this is much better once scratchy is dashing down the hill his downward momentum keeps him tightly on the slope hold on let me do a quick side by side comparison the video on the right is the updated scripts and oh boy yes the new scripts have it they are silky smooth i'm well pleased with that there comes a point though when we cannot continue to ignore our players strange ability to stand on a really really steep slope look at this hanging on by a toe it's pretty obvious that if we tried this at home we'd be sliding down this hill on our faces so what do we do now about these inclines although they may not look like it here their collision shapes are actually made up of jagged runs of pixels like this our player's hitbox is catching its toe on one of these and the cat thinks it's on a platform to get around this we need to check whether our player can move across and down by 2 pixels if there's no collision there to stop them then we'll let them slip off down the slope okay let's do this we start by making a new custom block naming it slip still within the define collide y scripts place an if block around the set falling and check whether falling is greater than zero we only want to trigger a slip call in here when we just land otherwise we'll be calling this from elsewhere you'll see in a mo so drop in our slip block great so we can change y by minus 2 to check below the player but also we change x by 1 to look to the right next we check whether we are touching solid and use and if touching is less than one this means we are not touching the ground in this direction so we want to slip the first thing we do is set falling to nine this needs some explanation it's a little trick because the falling variable is used to prevent the player from jumping while they're in the air by setting this to a number larger than 3 or so we will be preventing the player from jumping when they are slipping down a slope like this now you may think this is counterproductive because we may want to add wall jumping later but don't fear that is a completely different mechanic altogether another tweak to make is to change our speed x by one that will accelerate the player to the right a little bit as we slip down and then stop this script but what if we are not slipping we have to undo the previous move we made up here so change y by 2 this time and then change x by 1 super that's slopes that go downhill to the right sorted let's give that little beauty a test okay i don't care what you say that actually looks really cool when we land on a slope we slide right down i'll just make sure i can still stand on a less steep slope over here yeah no sliding down this that's really good really good well since that's working we should complete our scripts by adding the left hand slopes too duplicate everything from the check touching solid block we've checked down two pixels and to the right by one we just need to move left by two steps then to check for the left hand slopes and get rid of the change y block and change x by minus two instead pop these scripts back at the bottom it's all very similar except now we change our speed x by minus one to accelerate the player off to the left finally make sure to update the last change x by to be one now to bring us back to where we started now i can't test this yet on my level as i don't have any left hand slopes i better quickly pop one in there that's it and we can test i just need to jump up to the right and you can see there that there's no way i can get a footing on this now i slide right off success is ours you may notice that we see a bit of jitter when running up a slope and we've reached a point where we can't go any further do you see that okay it's not a problem find the define clyde x script and right on the bottom pop a slip block 2. this ensures we're always checking for slips whether we're colliding from falling on the ground or from running across it testing again running up the slope now and that's considerably better good job now if you are sticking to using a square player costume like guy then i suggest you might be able to skip the rest of the episode or just make use of the parts that you want however for players who stand up straight this is going to be cool it's time to take a second look at advanced hitboxes standing just here i gotta say it's perhaps a little odd that we still appear to be balanced perfectly on one toe it would be so much better if the center of our sprite costume could sit on the ground rather than the edge of our hitbox this is especially an issue when we stand on the edge of a step like this we prefer him to slip off at this point really luckily due to our recent changes to slip the player down slopes we can now do something quite awesome in the world of hitboxes click into the player's costumes and find the hitbox costume 20. this was perfectly rectangular to avoid any snagging on the edges of platforms but now with the slip block we are a little more free to experiment with shape so click into the next costume hitbox version 2. so what you will notice is that the bottom of the hitbox is a sharp point this is placed on the floor between scratch's feet when on a slope it means that the hitbox will no longer balance on a corner the next interesting thing is that the top of the hitbox is much wider than before this allows us to accommodate the scratch cat's large head preventing it overlapping the ground quite so much but how come we can use this shape now when previously we said we needed a perfect rectangle well the answer is that the slip feature we just added will automatically cause our player to slip off steep edges and that includes the steep edges of our hitbox let's just give that a try find that when i receive tick first script now switch the hitbox to hitbox 2. don't forget we also need to do the same in the define begin scene script here so hit the green flag and let's see right off we find our feet are planted centrally on the curve of the ground rather than above it that's good and now off we go to the right we'll find that we can no longer squish right up against the wall like we used to another boon so how about the edge of steps oh yes this is excellent our player now slips off the very edge and is pushed away from the wall by our new conical hitbox wonderful so just test now that the slopes are still behaving themselves as before yes indeed cool so now the player is more closely hugging the ground but our feet they are still looking a little odd one hanging in the air and the other clipping into the ground it would make sense for the feet to be level with the slope we are standing on what can we do about this well we could switch the player rotation style to all directions and try to match the player's direction to the floor but while this might look great for vehicles small cube players or even blue hedgehogs it's just not suitable for slower moving bipeds like scratch cat instead we want to keep the player upright and adjust their legs and feet to accommodate the change of the slope this does require drawing extra costumes for the possible slopes we might stand on but luckily for you if you've taken a peek in the costumes i provided you will find costumes 28 to 32 very interesting here if i click on costume29 you can see scratchcat is far better posed for the slope now not perfect but when they are small again very acceptable equally i can move them over here we can check the standing costumes again and perhaps this one okay there this one works well to draw these costumes i simply started with the default standing pose and then draw a line passing through the middle point between their feet the rear foot then needs to be drawn a little bit higher up and the back foot lower down you may find you need to reposition the player's body too to avoid the front leg stretching too long now as a quick note if you're trying to angle a player sprite like guy you may indeed want to use rotation to put them at a suitable angle with a slope but it's a lot more tricky to get right with this technique so how many poses will we need to draw well it's up to you but i find even just five standing poses is quite adequate what's more we don't even need to redraw any costumes for the running poses as when they're moving around the issue of where their feet are positioned is much less obvious so we have these five poses the next problem is working out how to get scratched to pick the right one for the right situation you'll need some way in code of examining the ground at their feet the simplest way to achieve this would be as follows we draw a specialized hit box for each standing pose shaping them to match the position of just the player's feet then to find which standing pose to use we switch through each of the hitboxes to find the one that does not collide with the level the first pose is the flat ground pose oh it's the same color as the level hold on i'll change that so now you can see the hitbox is touching the ground from that we can deduce that the start ground pose will not work we try the next hitbox nope this is also touching the ground hitbox 3 then this one does not touch the ground the third hitbox is the winner now since we are very forward thinking we set up our standing costumes in the same order as the angled hitboxes this way the third hitbox means we switch to the third standing costume click and there you go we found our pose excellent this works just as well on any slope in our game i think it's time to get scratching find with me the define set costume since all we are doing is leveling off the cat's feet this is the best place to do the job scroll down to the bottom to where we are setting the costume to stand we'll start by setting the costume to the first of the five hit angle costumes it's called hit angle zero then we loop through them with a repeat for a count of five so firstly is our hit angle sprite colliding with the level check touching solid and then if touching is less than one the hit angle costume is not touching the level so great we found the angle of the ground we now want to switch to the matching scratch cat costume we need to move 5 costumes forward so use an addition block starting with the current costume number and then add five super so then we can stop this script we would be done but if the hit angle costume did not touch the level then we should move on to the next hit angle costume before this repeat block loops around and off the scripts go again then finally if none of the hit angle costumes worked then we just switch costumes back to the original standing costume for good measure shall we give that a try wow i forgot how big i'd made this guy but at least he's got his feet in the right place let me just shrink him down a touch back to 40. great now notice how as i turn left and right his feet remain rooted on the slope and i can move to the less angled ground oh yes i'm loving this very much it even looks quite cool when one leg is dangling off the edge of a step you may find you need to tweak your angled hitboxes until you get the best slope detection but these costumes are working really well here wow this episode is drawing to a close but we are in an awesome place now ready to look at adding seriously cool wall jumping and sliding i'm so excited for that along with moving platforms another favorite of mine i do hope you've enjoyed watching today please smash the like button and don't forget to subscribe to my channel to catch the latest videos if you are a loyal fan or an educator then please can i encourage you to support the channel further by joining the channel membership i do what i can to make you the best videos possible and the extra support is really appreciated thank you so much and thank you for watching hope you have a great week ahead and scratch on guys