hello fellow scratchers we had a lot of fun adding the ship mode in last week's episode of our exciting Geometry Dash series and today we are going to finish the job in classic Geometry Dash when entering a portal the vertical scrolling level changes to become a sort of tunnel with a floor and ceiling and the position of this tunnel is centered around the portal that we last passed through so we are going to need some clever scrips to determine the vertical position of a portal on our level we'll need a new ceiling Sprite and we'll need to fix the vertical scrolling perfectly in place no problem we'll be doing this and More in today's episode so what are we waiting for load up your projects from episode 7 and we'll save them as a fresh new copy for this is episode 8 guys let's get scratching now before we dive into adding these fantastic new features let's quickly address two little bugs that you may have experienced from the last episode yeah a lot of you noticed that we started to get excessive particles when starting our first game whoops even when jumping through the air now but as soon as we die and we start the particles go back to normal this little buglet was introduced in the player Sprite under the green flag script this forever Loop to generate tit screen particles needs to be stopped when the game begins not just on death so a simple fix when I receive reset level we stop other scripts in Sprite and that's it give that a run and all is well again no more particles while we're jumping now the second issue wasn't as widely reported and you have to be quick to see it I'm going to place the ship portal at the start of the level once more to show you now watch what happens when we die did you see it look closer yeah we are turning back into the cube costume so how many of you noticed that one if you did then comment saw that bug under the video and better still comment bug squashed if you have already fixed it right I'll show you how I do it scroll down with me to the game on script and look at the forever Loop When We Touch pale yellow that's our spikes then we broadcast game over and we end this forever Loop but that's before we set the rotation style and costume back to mode so duplicate those two blocks and then bring them downwards to our game over scripts and here we are switching costumes not to mode but to cube this is the culprit we remove moove the old switch costume and we'll replace it with the rotation and switch costume block from above nice it's testing time smash that green flag and now bug squashed great job and so we can commence with the meat of this episode creating that horizontal ship mode tunnel now when we're designing our levels we can place our portals at any height however when the player enters it the level is scrolled vertically so that the portal is perfectly centered on the screen from now on our camera is locked to a horizontal rail our problem then is finding that y value of this rail what I suggest is that on touching the portal we switch to use a new hitbox costume that we can slide down the screen until it no longer touches that port portal color now we know where the portal ends the bottom of the portal we can easily calculate its Center too and we'll store that result in a new variable rail y well then let's make that new variable right away rail Y and it's for all Sprites now we should make sure to reset it in the green flag script setting rail y to the empty value however I'll duplicate it as we're going to need two of these one when the project starts and the other right down here in the game on script so it resets each time the level Starts Now to detecting the center of the portal we'll need that new hitbox costume duplicate the first hitbox and we'll name the new one hitbox portal to ensure it stays in contact with the rounded portal right to the very bottom we need it to be relatively wide so hold down the ALT key and stretch it sideways to a width of 72 then move it downwards while holding shift to keep it centered until its top is level with the center of the costume canvas just there good now we can script this up find the Define check portal script now just for a moment I'm going to separate off the existing three blocks from within here as they want to happen last and we switch to the new hitbox portal costume to do our detection sweep we are repeating until we are no longer that is not touching the portal color but until then we move down change y by negative 2 pixels okay we should now be clear of the portal let's record the position with a set rail Y 2 and we'll need a couple of addition blocks the middle of the portal is located at the current y position of the hitbox plus 50 that's half the portal height and finally add to that the current camera y value that we are already scrolled to perfect we found the center of the portal so return those previous scripts to the end of this if but hold on having moved the hit box down to the bottom of the portal our player will now be out of position we need to restore them back up to where they were before luckily that's exactly why we added the player y input here so set the player's y position back to the player y input nice and also we need to switch the costume back to the hitbox spike costume too so does this work let's find out hit that green flag and head for the portal 27 huh well that does sound about right since the portal is close to the middle of the screen already and subsequent attempts all come in with values roughly around the same Mark so that's good our next job is to scroll our level to the value in our rail y variable so can you find the defined camera tracking script we only want to change this when we are on a camera rail so if else inserted after setting the last camera Y and what we're going to check is if rail Y is greater than if rail Y is greater than the empty value then all these original cameras tracking scripts can be placed in the else Branch that's what we do when we're not on the rail but if we are on a camera rail then it's very simple duplicate one of those change camera y blocks and remove the Y position so we want to scroll the camera towards the rail y value and we are scrolling from the previous camera y this should smoothly bring our camera to our rail y value shall we take a look jumping through the portal oh nice did you see the level scroll up a touch and now we can no longer bring the screen up any higher we are indeed locked at the current portal height another test is to bring the portal up a little higher and try again this time we should see the level Scrolls up even higher with a rail of 55 good job so as well as fixing the camera to this rail we also need to move the floor down so that it is only just visible on the stage okay then click into the floor Sprite and make it visible on the stage we can manually drag the floor costume down until it's at the height we are after even lower than this lower yeah so I guess for me a value of around 1 100 in the Y will be perfect it could be a little different for you depending on the height of your floor costume we'll make a new variable to hold this value name it floor shimmy and leave it for all Sprites right away set floor shimmy to not negative 100 but positive 100 or again whatever value you found looked best here then to actually move the floor down find the when I start as clone forever Loop we just want to adjust the set y depending whether we are on Rails or not so we need an if else everything else goes under that except the set Y block that goes inside the then branch and duplicate it into the else Branch too now fill out the if condition are we on a rail that's rail Y is greater than the empty value if we are then we position the floor at the current rail y but shimming it down by subtracting floor shimmy and finally drop that into the top set Y block oh yeah let's test I'm expecting the floor to drop away now as I enter the portal but oh it did but we have two floors visible I left the main floor Sprite visible on the stage that's why turn that off and try again and there we go so cool that's exactly where we want it on the screen but obviously something else is a miss here since we can now fly under the original level what we'll need to do is place a lower limit on how low this camera rail can be defined click back with me into our player Sprite and find the check portal custom block here we are setting the rail y draw in a simple if block beneath we want to check for when the rail y value is less than our floor shimmy if it is then it's just too low down and we set rail y back to floor shimmy if all is well when we jump through our portal the screen jumps up and is left with the whole level floor locked to the bottom of the screen that is perfect I'm really pleased with how that is looking now we just need to replicate this floor Sprite as a ceiling Sprite too to close the player in well then we'll duplicate the floor Sprite and name it ceiling we want to flip this costume perfectly upside down now you might think that tapping the flip vertical would do the job but sadly it's not relative to the canvas but the local costume I do have a fix for that though start by drawing a rectangle over the entire stage and then make sure it's snapped to the center of the canvas that's dead important then oh hold on let me make this shape an outline so that you can see this in action but you don't need to do this step now deselect everything by clicking in some free space and then flip vertic taada a perfect flip all you need to do now is then select and delete the large rectangle how cool is that next up a little bit of coding make sure we are still editing the ceiling Sprite we don't want to be setting these Global variables in the ceiling Sprite as well as the floor Sprite so remove them all including the one under the reset level hat block now we're not on a rail this ceiling wants to be hidden so we can just scroll it out of view set y to 999 we can test that that works by making the ceiling Sprite visible and then click that reset level script cool it vanishes well off the screen so coming down to the when I start as clone script when we are not on a rail that's the second set y here we want the ceiling to remain off screen green so once again set y 2999 but when it is on a rail rather than moving the Sprite down by floor shimmy we want to move it up by the same amount to move it to the top edge of the stage so that's rail y plus floor shimmy and pop that back in the set Y block like so you know what time it is it's testing time well that's interesting why have we got a ceiling visible on the title screen after all rail Y is not set oh I know I didn't hide the main floor Sprite don't okay here we go here we go and yes we have a ceiling and man it is nicely positioned the perfect mirror of the floor this is spoton and the player nicely bumps up against it when we fly to the top again and I love how the screen Scrolls up smoothly to reveal the new ceiling that is so cool so I'm really enjoying flying around the level but in all honesty we do need to introduce that second portal type to switch us back to a cube again what do you say we look into that next if you want to Simply recolor my existing portal then that's no problem but otherwise I have updated my geometry dash asset project to include the extra portal if you want it oh and while we are here you may also notice that there are some other new additions just in case I've started playing with some nice costumes for use as the background and the foreground scrolling areas but I don't expect us to use them this episode but I'll snag them anyhow into my backpack okay so back in our episode 8 projects I'll remove the previous level asset Sprite and replace it with the new one from my backpack then we shall copy that new green portal so I'm going to place it On My Level Sprite perhaps on costume 3 yeah that is looking good we just need to trigger a change back to our Cube form back into the player Sprite and we want the check portal script which just happens to be the last one we looked at nice a new if to detect a new color we do need to make that portal visible on the stage though yep let's see there they are so in the player script carefully pick that green color from the stage and we don't need to do much to get back into the cube form a simple set mode to Cube for starters and then reset the rail y by setting it back to the empty value that will allow us to scroll vertically up and down once more and that is all amazing drag that down to the bottom of this script and pop it on the end as always as we run the project we need to ensure we hide that initial level costume are you ready for this ship the green portal and we are back to being a cube and we're dead but yeah this is excellent imagine what we can do with this we could almost finish making our stereo Madness level now and when I have a bit more time I most certainly will but right now I'm afraid that this is all we've got time for this episode I'm very much looking forward to adding in a proper scrolling background perhaps some wandering background particles and even better an actual ending to our level now that will be epic what are you most looking forward to so if you enjoyed watching this episode then please set that like button to a value of one and make sure you subscribe to the channel and enable that Bell icon so as not to miss my next exciting video the moment it drops until then though have a great week ahead and scratch on guys