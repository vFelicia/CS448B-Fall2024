foreign scratchers if you didn't know I have been working hard on a new Minecraft MMO scratch game something I've been wanting to try to go for a really long time but technically it's been quite a challenge in this video I'm going to take you on a deep dive into the tricks I discovered that helped me to make this multiplayer Masterpiece possible in scratch now MMO stands for massive multiplayer online and as such you may see as many as 60 scratches in game simultaneously Yes you heard me right 60 players all mining crafting chatting and swapping items in the same game world now I simply love walking around and seeing what my fellow scratches have been building from Deep mines to Pumpkin houses nice one be legal102 so as with all online scratch games this project is built using the humble Cloud variable they work like normal variables except their values are shared across the internet to all the other players of your scratch project very cool but with serious limitations they can only store numbers not text and after setting a cloud variable you must wait a tenth of a second before setting another one to avoid facing stability issues and you can only have 10 of them per project but before we talk any more about Cloud variables what about the scrolling platformer engine does this look familiar to you it's actually adapted directly from episode 4 or 5 of my titled RPG tutorial yes so this is a 500 by 100 tiled grid list where the tile set costumes were sourced directly from the Minecraft sample resources on GitHub and it works just great the tiles of stamped and so it uses minimal clones and I've used very basic platformer scripts like those in my early tiled Mario tutorials and really enough said about that I was just pleased I could adapt the code so quickly and save all that rethinking so next up I need the multiplayer code again I was able to reuse some of my existing scripts to get the Head Start specifically for my MMO platformer game but we should take a step back and let's first take a look at the precursor to this my first successful cloud game Cloud platformer multiplayer fun all my cloud games up until very recently worked just like this one we have eight Cloud variables for the players and we allocate them out one per player then each player's scratch project is responsible for taking the player's username their position on the screen and the costume number and encoding all of that into a single Cloud variable friendly value or data packet if you will they then set their allotted Cloud variable to this value as do all the other players and in this way all the connected scratch projects know who is playing and where they should be on the screen and it works really well but it does have an obvious limitation we can't support more than 8 to 10 players at a time then along comes my new experimental MMO platformer project and this one blows the 10 player limit right out of the water and far up the beach see for yourself as I'm joined by over 130 of my fellow scratches all in game at the same time what magic is this well it's actually pretty straightforward let me explain as before each player's scratch project constructs a data value from their username and Sprite positions Etc but this time they just pick any of the cloud variables at random and set it to their data value now all 140 players of the game will see that cloud variable change value and this is where it gets funky each project maintains two lists the first contains the names of players who've joined the game by decoding the start of the incoming Cloud variable we can identify who sent it this one's username is guy if they've already joined then we find them in the name list and use the second list to store the actual cloud value alongside their name both at the same item number this is called a key value pair the other case is that the cloud available is for a player we have yet to see before a new player in this case we simply add them to the player names list and insert the cloud value too and that is it awesome by using lists to store the cloud data we are no longer restricted to a maximum of 10 players and the players sharing the same Cloud variable do not have to worry about overriding each other as the list keeps each player's code safely stored away so cool it's then just a matter of cloning a Sprite for each new player and decoding their position for display so since this Cloud engine worked so well I dropped it into my modified RPG engine and yay it's perfect for running and jumping around with all my friends but that's really only half the story not only do we need to synchronize our player movements via the cloud but also the state of the entire game World 2 and this is a huge problem a huge problem indeed because a level consists of 50 000 tiles back when Cloud variables didn't have a limit on their size we could in fact squeeze an entire level into one variable think scratch Aria but sadly as of 2023 we can only squeeze in 256 digits at a time scratch Aria r i p the next idea would be to split the level code up into chunks and send them one at a time across the cloud well with the limits on cloud updates that would take a full two minutes that's a long time to wait for a game to load and who is going to be sending this anyway we need this to somehow selfcoordinate between all the players of the game so to cut down on the amount of data that needs to be sent I decided to begin the game with a predefined world akin to the Demo World on Minecraft that would allow all projects to load up instantly in a common Land good then as players mine and place blocks all we need to worry about is keeping a list of these changes and sending these details to everyone else obviously the list of changes will gradually grow quite large and so we can't send them all at once so instead we keep a record of the last sent block and cycle around the list sending just four or five updates along with our normal username and position data in this way every player will eventually see every block that we've modified Splendid we have a workable solution but as with all good ideas there's always issues to be teased out for example when another player changes a block that we previously changed ourselves we have to be careful we don't accidentally overwrite it again with our recorded change so remove the record of our change as soon as another user overwrites it it's useful to keep a record of who changed each tile and when to best resolve these conflicts you can see this working in game by holding space so that's who stole my precious cake another issue that causes a lot of trouble is when a player leaves the gate all existing players would continue seeing Bob's glorious house exactly as Bob left it but a new player joining the game will not see Bob's house at all why is this well because Bob is no longer around to send his tile edits to the new players and they are seeing the level as if Bob never existed and this is a serious problem because the levels are out of sync between players and it's never gonna sort itself out we must have consistency between our players or this game will fall apart the easiest solution is after Bob leaves to reset all his changes for everyone and since I'm already keeping a record of who modified which game tiles this shouldn't be hard goodbye bobville and sorry to that poor scratcher exploring Bob's mind sad but the plus side to this strategy is at a level which would slowly have descended into chaos that's entropy in action my friends now continually selfrepairs as players leave if all is well we strike a nice balance and everybody can have a lot of fun obviously there's tons more I could talk about the inventory hot bar crafting smelting player costumes armor but what's interesting is where this project is heading I began it as a mere experiment to see whether it was even possible to make an online multiplayer Minecraft Style game and the answer is a very positive yes but there are things I have not yet added and with good reason let me go over those uh Falling Sand and Gravel blocks these are particularly tricky since once a block moves I have to decide where it ends up and who is the owner the consistency across computers far harder than it sounds water and lava for the same reason as sand and gravel any tile with movement brings me lots of pain maybe one day I'll look into it and figure something out then there's day night and Illumination in general calculating this is quite expensive even in a single player game if I was to extend this out for 60 players all editing the map it's going to be too slow trust me perhaps there's some clever trick I could use but I haven't thought of it yet our chests now then these would be cool but it's another layer of complexity but where do we store the chess data and how do we make sure it's synchronized over the cloud one to ponder PVP this has come up so many times seriously this is a peaceful game the biggest problem is that the game lag means that everybody is a half second or so behind each other and movement wise and when you think you might have hit someone but you didn't and vice versa nobody wins and no one ends up happy then there's mobs oh man usually for these I end up having one player's computer take control of the mobs nearest to them but sending enough data to make that work will be super hard given the current cloud restrictions I would really love to add some pigs and chickens I have pondered on providing say masks that let you take on a roll of a different mob so players can play as people or other mobs like Piggies or chickens I don't know what do you think could be really entertaining if you agree then why not drop me a comment and lastly safe zones and teaming it's obvious that there are a number of people who find it more fun to destroy people's hard work than build themselves and I really don't approve so I wonder if there's something clever I could do to help prevent it and still support collaborative building hmm tricky so let the discussion begin I value your ideas and thoughts do drop me a comment well I hope you enjoyed that little technical overview and update if you did then please say thanks by Smashing the like button under the video I'm having a lot of fun coding this game and I'd love your feedback so do drop me a comment or two if you haven't yet subscribed to my channel then you can do that now and don't forget to toggle that little bell icon so as not to miss being notified that my next video has dropped so I'll see you again soon but until then take care and have a great week ahead and scratch on guys