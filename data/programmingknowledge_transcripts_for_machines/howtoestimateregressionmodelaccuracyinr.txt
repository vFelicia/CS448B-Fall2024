hello guys welcome back to another tutorial hit the bell icon button so that you don't miss out any tutorial okay in this video we're going to check the accuracy of the multiple regression model that we created for the cancer data and so we will do this we'll look at this a couple of different ways we're going to use what's called RM SE RM s e so let me just write this down our MSE is the root of the mean squared error and so the idea here is that whenever we make an estimate with our model we can compare that to what the actual what the actual was so let's just do cancer mod rig our MSE on train and I'm being kind of detailed with the name there because we'll have different models and different accuracy measures and stuff so we'll have cancer the cancer mod and the cancer model regression on for our MSE on the training data set so what we'll do is take the training data set and will mutate and put the regression prediction for train as predict using cancer mod cancer mod reg okay so let's just look at what we created there okay so we created an estimate we added to our train data set an estimate prediction estimate based on our model and so using that predict function the predict function all we have to do is pass it the model and so we've we then created an estimate so you can see for the first observation our estimate was 180 3.9 according to our model and the actual was 170 9.5 the second one our estimate was 140 9.6 the actual was 120 4.1 and so on down the line so some of them are quite some of them are a little bit off and and that's just the idea so a lot of that is just currently unexplained error right we just don't have a perfect model no model is going to be perfect so there is some error there and so one of the first things we want to do is just plot and then we'll get back to our SRMs see in just a minute one of the first things we want to do is just plot we want to plot the actuals which would be the target death rate against the against our predicted values okay so let's do a simple scatter plot here and look at the horizontal axis is our actuals the vertical axis are our predicted models our predicted values and so you can see there's a nice positive correlation here they look like in general as the the actual values increased our predicted values increased so at least directionally we're in the right neighborhood we do have this outlier out here which kind of jumps out at you and so we saw this earlier in our exploratory analysis that there was an actual that had a death rate of above 350 was like 362 I believe and so the good news is that our model predicted that value quite high right it actually did a good job of predicting that value now here was the other outlier this was probably the one with high incidence rate but the the target death rate wasn't as high the target death rate was a bit lower so we predicted that unfortunately too high so that one kind of threw things off but for the rest of this this actually looks pretty good not perfect you know there's still some noise kind of going around here it looks like a cloud but but for our first attempt at multiple regression I think that that that's a good a good looking model so I would expect the error to not be to not be too terribly bad so the first thing we're going to do is create the mean squared error alright so mean squared error we're going to take that cancer mod reg MSE train and we're gonna run some calculations on it okay so we'll mutate that we're going to create the error which is just going to be the prediction on the regression for training data minus the target death rate okay so that's the actual then we'll have squared error is going to be simply error squared and so we'll pop that into summarize and so the mean squared error will be the mean of the squared error all right so let's go ahead and create this and then we'll take a look at what actually is is going on here actually let me we need to run this before we before we summarize so we keep all of our individual observations here and then before we summarize with the with the mean so what's happening is that we'll calculate the error so it's it's the 180 three point nine minus one seventy nine point four has an error of four point four this one is an error of twenty five point five this one has an error of negative 0.5 so what happens is that some of these will be high and some will be low in the way the regression works is if you added up all of these errors you would get zero because by design the regression the multiple regression algorithm creates residuals creates error measures that sum to zero it does a little bit that are high and a little bit that are low so on average it's right in the middle and so on average these residuals have a mean of zero so if we just add them up or if we take their mean it's going to be zero and so that's it's rather uninteresting to do that so what we do to get around that is to make them all positive by squaring them and then we just find the average of that so we make them all positive by squaring so that gives us the squared error and then we summarize that by taking the mean of the squared error so that's what we have here the mean of the squared error but then we want to get back into our scale so our MSE is going to be the square root of the mean squared error so to get back to scale the scale of our data since we squared them to make them all positive we got to take the square root of our numbers so our RMS see here is twenty one point two three two three four so training training RMS C equals 21 point two three four twentyone point two three four so that that's nice you know some of these values the target rate values you know these are in the high 100's you know up into the 200s at time so for an error our average error you can think of it twentyone units so that's not too bad so that means on average you know if we take our estimate compare it to the target death rate on average we're off by about 21 units so in a scale that's in the high 100's around two hundred that's not too bad you know to be off by 21 units or you know maybe 10 10 to 20% some 10 15 percent probably somewhere in that neighborhood that that's not too bad at all so I'm very comfortable with that I think plotting it out looks good the numbers look good here but that's the training data and so we also want to check this on the testing data remember we held out 20% of our data set in order to test for accuracy so we want to make a prediction on that test data on that data that our model has not yet seen and we'll see how accurate that is because if we get an error of 21 on the training data and then our error is a hundred units on the test data meaning on average our predictions are off by a hundred units well that's not a very good model right so hopefully we get something that's at least relatively close to 20 to 21 that that would be the best so so we'll check our MSE on the on the test data and so we will create let's call it pred pred regression test and so we'll just predict on our on our cancer mod Reg and now we can pass it new data new data is test right new data is test and so our MSE for test let's call this regression our MSE test is going to be the square root of the mean of the test prediction test and target death rate squared okay so what did I just do here let's walk through this calculation right so we have in our test data set we have the actuals one of the columns is the actuals we just created up here the prediction on that data set so we're taking our predicted values the actuals okay to get our error and then we are squaring that error to make them all positive just like we did on the training data then we're taking the mean of the squared error to get MSE and then we're taking the the square root of that okay so it's the same calculation as we did with the piping operator we just did it a little bit differently here okay so let's go ahead and print that out rig our MSE test okay twentyone point three seven how about that huh so test our MSC equals 21 point point three seven so that that's actually great point three seven two this is really great because what this means is that our training data and our test data our MSE are very very similar not exactly the same they never will be they shouldn't be but they're very very similar so that tells us that not only is our did our model do do relatively well on our training data but it did relatively well on our test data or it did at least the same level it performed at the same level on test data on on data had never seen before so we can feel pretty confident that we're on the right track with with this model now I don't think we're done but we are at least on on the right on the right track okay so that that's really great that's all we're gonna do with the multiple regression model but let's but before we we wrap up here let's just think about what are some other things that could be attempted in our multiple regression in our multiple regression modeling so you know we had we restricted this down to just three variables for our model so we had a number of other variables that were available to us so we could create additional models that incorporate some of the other variables some of the other transformed variables we could also go back into those variables and do some of the cleaning up some of the outliers or the abnormal values like on age and then recheck correlations and see if that tells us anything we could go with the data set we currently have and eliminate these two outlier values and see if we model you know if we kind of set those outliers aside and then model based on everything else see how that changes our model so all of those would be options for trying to refine the this model a little bit and those would be things that that you would want to try on your own as you were kind of working to refine a multiple regression model on this on this data set so have fun try those things out if you want that's gonna do it for the multiple regression section thank you for watching don't forget to subscribe the channel if you like the video do give us a thumbs up and share it also check out amazing discounts and offers on our premium poses in the description below