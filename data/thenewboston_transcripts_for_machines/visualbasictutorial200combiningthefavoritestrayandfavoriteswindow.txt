hello YouTube Sam here from youtube.com/ onli gamer for the New Boston and in this tutorial we're going to be combining our favorites viewer and our favorites viewer try into one application now the credit for these two application goes to the authors of beginning Microsoft Visual Basic 2008 and they are thean Willis and Brian Nome now I've been using these applications to teach you guys some objectoriented programming techniques and now what we're going to do is we're going to use my method of combining these two applications into one so what we need to do is we need to come over here to favorites viewer YouTube and we need to add an existing item so go ahead and go to favorites viewer YouTube and go to favorites viewer Trey YouTube and add add web favorite menu item so I'm just going to click cancel because I've already done that so once that's in there you need to right click on it and click view code now you will see the import statement right here that says Imports and it will say internet favorites so you can just go ahead and delete that because we don't actually reference that dll in this uh project so now that we have our web favorite menu item let's go ahead and change some properties of our viewer. VB so we need to come over here to the properties and we need to not show it in the taskbar so we'll find show in taskbar and we will set that to false now it should be set to true for you um and I already set mine to false so now that we've done that let's go ahead and come over to our toolbox and we'll add a notify icon so we'll set the text of this to rightclick for favorites so when they hover over it with their Mouse it's going to tell them to right click for the favorites and for the name we'll set it to Icon favorites and now what we need to do is we need to set the icon to the star that we had so I'll just go to my desktop and select this favorites icon okay so now we'll come into viewer. VB and you can see that when the viewer loads it loads the favorites so what we need to do is come down here and we need to edit our load favorite sub so you can see that it uses object favorites as a a new favorites so if you notice here it uses a four each Loop to go through each of the favorites in our favorites collection now if we go back and look at form 1vb from our favorites viewer tray you can see that it also uses a for each Loop to go uh and search through each of the favorites in the collection so we can use this to our advantage we can use this existing for Loop that's already here and now one thing you need to make sure that you've done before you edit your code is right click on favorite view viewer YouTube and set it as the startup project okay so let's come up here and whenever we load the favorites we'll just go ahead and declare object menu as a new context menu so now that we have our context menu context menu what we need to do is come down here into our 4 each Loop and we need to to declare a we favorite menu item so we'll just call it object uh favorite item or we'll do object item as a new web favorite item or web favorite menu item and for the arguments it's going to take a web favorite and you can see that in our 4 Ebe it has object web favorite as a web favorite so we can use that in this argument so object web favorite so it creates that object item and so now what we want to do is we want to add that to our list so we'll do object menu menu items. add and we want to add our object item now this is going to be called for each of the favorites that are in our collection so let's come over here back to form one. VB and see what else we need to do well we've done this right here so now we need to add the separ separator and the exit menu so we'll go into viewer. VB and we'll come down here below our end using and we'll just type object menu. menu items. add and then we'll add the separator and now what we need to do is type object menu. menu items. add and and we'll create a new instance of an exit menu item so instead of declaring a a variable of exit menu item and creating that outside of this that would just be a waste of memory so what we can do is create the new instance of it inside the arguments of the object menu. menu items. add so the exit menu item is inside of our class or uh inside of our file I should say our web favorite item. VB you can see we've got the class exit menu item and it inherits from menu item and it sets the text to exit and when they click on it it will exit their application so we'll come back into viewer. VB and let's make sure that we've done everything right okay so now we need to do is we need to set that context menu um to the icon we need to attach those to each other so we'll type icon favorites. context menu is going to be equal to our object menu so once we've created our menu and we've added added it to the icon let's go ahead and have this um program minimize to the system tray so if they double click on icon favorites we'll type if m.v visible is equal to false then we'll type me do show so if the um application is not visible and it's hidden then we'll just show it again and instead of testing to see if it's visible let's just type if me. window state is equal to form window state. minimize so if it's minimized then we'll show it and then we'll set the form Windows state to a um normal so me. window state is going to be equal to form window state. normal so they'll be able to see it so now what we need to do is we need to access the resize event for this form so that if they minimize it it will hide it so we'll go to our viewer events and we will find resize so if they resize it let's use an if statement so if me. windowstate is equal to form window state do minimized then we'll just type me. hide so when I double click on the icon favorites it'll show it if it's hidden and then when they minimize it it's going to hide it so let's go ahead and run this and hopefully we won't get any errors and you can see here that it loads our form right here and it has our default link and we can refresh and we can select these links but you can also see down here in our tray we have the favorites um icon that says right click right click for favorites and when we right click we get our menu so if we minimize this you can see that it's not shown in the taskbar and it just disappears so in order for us to show it we'll just double click on the um icon and it'll show it back okay well the error that we had there um was fairly simple um it took me a little bit to figure it out though because it was kind of strange you can see here that we've got our sub that handles icon favorites uh double click now what we wanted to actually use is icon favorites Mouse double click so when they Mouse double click on the star it will show it um I don't know why this is this is actually very strange cuz you would think that icon favorites double click would run this code but you actually have to use Mouse double click so we'll run this you can see here is our form and let me just go ahead and come down here to the tray we'll minimize and you can see here is our favorites um icon and when we right click on it we get the favorites and let's just go ahead and double click on it you can see It'll open up the favorites again and when we minimize it it goes away and if we double click it it'll open it up again and then if we right click on the star and click exit the whole application is going to exit so thanks for watching these tutorials on Visual Basic if you have any questions leave them in the comments um and once you're done with this program feel free to leave a video response showing us um what you made and all of my projects well mostly all of them all the big ones are going to be available for download at the new Boston's website