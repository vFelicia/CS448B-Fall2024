and so let's refresh a couple more times two three four so now I'll count it equal to four so we've successfully created our function to update the count value however what we need to do now is we need to check whether the IP address already exists in the table but we haven't actually input our IP address into the table yet so we need to do that first so let's change this back to zero okay so let's not call this update count function for now now what we've got now is a function that's going to work let's just get rid of this if statement is not required at all we just are updating the query there and if it doesn't work we are we're silencing this anyways so because it doesn't really matter anyway okay so we've created our function which is update account that works and we can use that later on to update the count if eval if this function returns true so if the IP address does exist so let's term first of all up here every time our page is run we want to store the users own oh sorry okay so update count is fine we've got IP exists and we also want a function I didn't think this through properly obviously we need IP add and this is going to app this is going to add an IP address to our database so again we're taking in IP and okay yeah so I P add so we need to add an IP address to our table our table is just refresh this to blank that our table is hits IP and our field is IP so what we want to do is we want to first of all create a create query and this is going to be equal to insert in capitals insert into and our table name is hits I hits IP insert into IP values and we only have one value so that's it values is the IP that we specify in here so that can just be IP like that now we come down and we say query run equals of my SQL query query okay so let's just first of all get rid of that and and we need to call this function so what we're doing is down here we're calling the function we're saying IP add and the IP that we want to specify is the user IP so we call this function the user IP which we've grabbed from our session our server data is transferred through to this function and is added to the database because we're taking this argument here and putting it in here okay so user IP is added to a database now let's check if this was working let's go back and refresh okay let's go into browse and you can see that our IP address has been added okay so we also have a problem here in the fact that a duplicate entry might exist so we might have two of the same IP address in here however we're going to do this later on in our if statements we're only going to add an IP if it doesn't already exist in the database and that's what we have let's just delete this function that's what we have this function IP exists for now remember we got the global user IP from here so we're accessing this IP address from outside the function now we need to well I've added the IP into the IP address and now we can check if it's there or not so we're going to perform the check first of all while it is in there then we're going to perform the check after after I've manually deleted it so IP exists first thing we need to do is create a query and the query is select IP from and we can put these in there select IP from hits IP where and IP is equal to user IP now let's run this function and then I'll explain a bit about what we're doing or what we're going to do okay so this function is going to select an IP address which we don't we don't need to do we could have select its star but I've just specified it from the hits table where we've already got one IP address which is one two seven dot dot dot one where the IP equals my current IP address now what we can do is we run the query and we can return the amount of rows returned now if the rows returning is equal to one this means that we the address already exists in the database if we return a zero rows there's no rows then the IP address doesn't and remember we do this using the MySQL num rows function