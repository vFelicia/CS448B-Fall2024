all righty everyone welcome back to another tutorial and first of all what i'm gonna do is change my microphone settings to see if there is less of an echo so if this is a little bit better in terms of the echo i got some feedback about that then uh please let me know now aside from all that what we're going to be doing in this video is we are going to be learning how to create a discord roles bot now i'm sure you have seen something like this before if you've been part of you know a few discord servers and what this means is that there's generally like a message that says if you react with a certain emoji then you're gonna get a certain type of role and for those just starting out in discord that if you don't know what a role is it's basically these little things right here where users are grouped into different like categories or sections they're technically called roles now on the new boss boston discord server we have our roles basically broken out into how we structure our teams so there's a moderator role of course they have like more permissions than the normal user they can ban people so on and so forth and then the rest of these roles like uh blockchain community team design team those roles just have uh special permissions so they can access different channels like the design team can access the design channel so that is what we are going to be creating however before we jump right into that what i would like to do is go over the basics of classes versus decorators when structuring our discord bot so okay what the heck am i talking about classes decorators what's all this about so before what we did in all of the previous tutorials up to now whenever we wanted to create a discord bot what we did is we created a client object and this client object was just a connection to discord now whenever we wanted to listen for a certain event for example on ready or on message what we did is we added this decorator above the function name now in this tutorial we are not going to be using this method we are going to be using an alternative method however just to give you guys a quick comparison what i'm going to do is actually i can do this actually so i'll show you guys the old method above in a comment and i'll keep it here so we have a little reference to it and then below i'll show you the alternative of how we're going to be writing this all right so this was the old method before where again just to recap one more time is we got a connection to discord and then we registered an event and then we ran our client or our bot now alternatively what we are going to be doing let me scroll out just a little bit and collapse this is we can actually create our own custom class and instead of just having a reference to this class and creating our own object from it we can actually make our own class and to do this we just write class and you can actually name anything you want i'll just name it my client to keep things simple and again like i said instead of just getting a reference to this discord.client class what we're going to be doing is inheriting from it so more or less we're going to be writing our own custom discord bot client now the first method that you wanna write in this is just the dunder init so death thunder and knit and what this is gonna take is not only self but your basic argument args and your keyword arguments which are referenced as quarks and the reason that we want to accept these is because we want to pass these along whenever we're initializing this parent class so in order to do that what we need to call is super and all super is is it gets a reference to your parent class so super basically equals discord.client and then on this we want to call its init method and then i'm just going to be stealing these too lazy to uh type those out and all right so again the first thing we want to do is we want to basically say hey we're making our own custom discord bot it's going to be inheriting from discord.client and then whenever we initialize our own custom one we also just want to run the initialization logic from discord.client pretty much acting as a router so we don't have to write all of that custom initialization logic and now instead of writing these methods like async def on ready and having a decorator above each one since that was you know a bit tedious what we can do is we can have a reference to those now since this is a class method we want to just pass in self and then what did we print just to keep things consistent okay print online let me change that to ready i like that a little bit better and alright print ready just like that now the last thing that we need to do is this so instead of this client object having a reference to discord.client because that is pretty much what we did before we can now reference my client which is our custom bot so again if i zoom out a little bit you can see that this right here is basically the equivalent of this right here the only difference is this is how you can make a bot using decorators and this is how you can write your own custom bot so you can you pretty much can avoid using decorators this way and it um allows for a little bit more cleaner code base so this is a structure that we're going to be using for this rolls bot now even though this is the basic framework for a classbased discord bot what we want to do in this tutorial series is we want to give our bot some extra permissions and this is because we are going to be working with roles which includes members and if you remember back from my either the first or second tutorial where i talked about intents and i said that in discord intents are basically groups of events well one of those intents are the members intents and if you want to work with users like we're going to be doing or excuse me members which we're going to be doing because we're going to be giving them roles and taking roles away from them then we just need to enable these specific types of intents so to do this i'm just going to call this intense and this is equal to discord dot intense dot default all right so this intense object is just equal to the discord um default intents nothing's changed and this is what we get with our um standard bot however what we want to do for this is we want to enables the members intents so there's a property on here called members and we just want to toggle this to true and then whenever we initialize our custom bob what we want to do is take this and pretty much say that the intents that you're going to be working with are now equal to our custom intents and those are pretty much all the default ones with the members equals true basically saying hey discord bot we can now work with those members events now i also have some links right here that i'm going to include which is just some documentations around intents i think i might have included this before but just in case you guys want to read over any documentation make sure to include that right there all right so let's go ahead and recap exactly what we're going to be doing in this tutorial series and that is this we will create a couple roles and then what we will do is we'll have a message we'll just have it in this general channel for now and we'll say if you want a role then reply with one of these emojis and let's say if you want a custom roll then how do you spell emojis is there an e who knows all right and then let's just pick three emojis let's uh let's go with the potato it's one of my faves and then what else can we do uh we can have this chocolate right here and then let's uh none of these look very cool let's go with the monkey all right so our emojis that we're gonna be using is potato the chocolate and the monkey and all right let me just go ahead and copy that now what our bot is going to do is it's actually going to listen for any of these reactions or emojis that anyone responds with on this specific message so what we need is a reference to this message id and the easiest way to actually get this is if you just copy message link then what you can do is again i'm just going to paste it in somewhere real quick is this last id right here is the message id so eight nine yadda yadda yadda 836 again this is probably not the most um formal way to do it but it's definitely the quickest so what we need is a reference to that message id since we're going to be checking of all the messages that our bot is listening to we want to match it because we only want to give them a row if they respond to um that specific message so i'm just going to name it target message id and i'm going to say it's equal to this message right here so anyways to recap the target message is equal to this message right here all right so where do we go from here well remember like we said we want to give the user a specific role whenever they react with one of those emojis but in order to do that a key part of that is actually having those roles available on our discord server so in order to create your role just go to your server settings and then roles and then you can i'm sure you can guess it press this button that says create role and then you can give your role a name so remember we have three emojis one is the potato one is the chocolate and one is the monkey so for the potato i'm just going to say whenever users click that they're going to get a roll called potato person and we'll just give it this green color and what we want to do is we want to display roll members separately from online members and that just makes sure that they appear separately on that um little user list on the right hand side and that is pretty much all we need for this again it's not going to have any special permissions we're just going to pretty much display them separately so save that and then if we go back we can create these other roles so the next one of the chocolates we will say chocolate lover and this one can be blue and of course the same thing change and then back create a new one and the third one was the monkey so we'll say uh funky monkey again not very uh creative but they're the first things that i could think of right now so of course want to display that separately too save changes and all right so now if we go back to roles we can see that we have um four different rolls these are the ones that we just created potato person chocolate love and i actually meant to change that to chocolate lover and funky monkey all right cool cool cool so all the spot is going to do is it's going to have two methods one is listening to when they add one of these emojis and one is listening to when they remove one of these emojis from the message of course whenever they add or respond with these emojis we're going to give them a roll and whenever they remove this emoji we're going to take the roll away from them so first let's go ahead and make sure that we can give them a roll so back in our so source code can't talk today what we do is the method for this is on raw reaction add and what this is going to take is self and then the payload all right and then i'll leave a comment here and then we can say that this method is going to um give a role based on a reaction emoji now again remember we only want to listen if they replied with the emoji on this specific message so similar to before what we want to do is we just want to compare the payload message id to this target message id since this is the message that we just created and if it doesn't match then we're just going to return because we don't really care about those payloads so if the payload dot message id is not equal to then we can just copy this self.target dot message id then what we can do is just return and pretty much ignore those payloads now the next thing that we want is a reference to the guild now in discord documentation whenever you see guild it basically just means the discord server so this new boston this is a guild right here in this tnb tutorials this server i made for this tutorial series this is a guild and the reason for that is that this bot can actually be running on multiple servers now we only want to get a reference to the roles on this server aka this guild so that is you know just a little bit of background of that of why we are plucking out the guild so the guild is equal to the client dot get guild and what we need to pass in is actually the guild id so on this payload object there's actually a guild id that we can call so in short what this is going to do is whenever they add an emoji to a message we're just going to get the guild from where that emoji was coming from so now we can get to the good stuff and that is making sure we give them a role whenever they respond with one of those specific emojis so what we are going to be doing is we are going to be looking at this payload object and we are going to be taking the emoji property off it and looking at the name property so payload.emoji.name and we're going to see if it matches either the potato the chocolate or the monkey and if so then we can just give them that roll so to get this actual name i want to show you something that i want to make sure you don't run into if you just copy for example this potato right here and you paste it in it's going to convert it to the text based um version of that emoji however we want i don't even know how to say this but we want the actual raw potato and i don't mean raw uncooked i just mean raw is in code so anyways if you just go ahead and and this is kind of a shortcut at least how i do it if we print out payload.emoji.name and we can actually just run the spot right here so again all that's going to happen right now is whenever they add a reaction to that message it's just going to print out the payload emoji name in the terminal and i'll show you guys why so let me run this and alright it is ready now back in discord let me actually reply with this potato and just to show you guys what's going on real quick instead of the name potato it's going to print out the actual potato and the reason that we wanted to do this again is because we actually want to use this in the source code to compare it to the name property and just so i don't have to run this again doing my same little test back in discord i'm also going to respond with the chocolate and the monkey all right so again all i'm doing uh right now is i just wanted a reference to these so i can kind of copy them and paste them in my source code so all right i'm actually i don't want to stop that because i think uh i'm worried that this might disappear but either way now that we have that available in our source code we can say if the payload.emoji.name is equal to this potato then under here i'm going to write past right now but again what we're going to be doing eventually is we're going to be giving them the role potato person now again i just want to write pass because i want to fill in basically the template for this else if payload emoji name is equal to this chocolate then we can be giving them the royal chocolate lover and then if it is equal to this uh monkey right here then there you go they're going to be given the role funky monkey so now let me go ahead and clear that and all right it looked like it didn't actually remove it but better safe than sorry so we have the basic framework right here of matching these emojis that they reacted to with the actual ones that we're looking for so now the question is how do we give them the actual role well the first thing that we need to do is we need to get a reference to the discord role object of potato person now the easiest way that i know how to do this is if we just make a variable called a role then there's a function in discord utils library called get in discord dot utils dot get and as you can see this takes an iterable and the second parameter is attributes so basically we're going to give it an iterable and this is basically just going to be the list of roles in the guild and right now we have three roles potato person chocolate lover and funky monkey and from that editable the attribute that we want to match is just the name of the roll which is potato person and again if this doesn't make sense you're gonna see in like two seconds what's going on so first thing guild.rolls so basically from the rolls in our guild find the one with the name of potato person so now this roll variable is essentially equal to the potato person roll and then once we have a reference to that roll we what we can do is just add it to the member in other words just give them the role so in order to do this we need to await payload dot member so this is how we get access to the actual user or the member who is um replying with this potato and to give them the role all we need to do is call the method add roles and pass in our role which is the potato person roll just like that so now we can just copy this and just change the name so again if they reply with a chocolate the name of that roll was chocolate lover so we're going to be getting a reference to the chocolate lover roll and giving the member this roll and last but not least this is funky monkey and alright so before i run this just to recap we are going to be getting a reference to the guild so we can get all of the roles from the guild and then whenever we see either the potato the chocolate or funky monkey we are going to be saying okay what is the role the discord role related to that emoji and then we're just gonna assign the member that role right here so now let's go ahead and run it and it should say ready all right and check it out now just to test this out we can see that if i click on my name right here i don't have any roles it says bucky no roles so now what i'm going to do is i'm going to add a reaction and let's go with the potato at first and ra so the first thing that we can see is instead of just online i'm now potato person always hit sign and if you click on my name you can see that indeed i do have the potato person roll and again just to test it one more time if i click on the chocolate so it doesn't change me to chocolate lovers because i can only be in one category at a time again even though i'm online it doesn't say i'm online because like i said you can only be in one category at a time but when you're testing this out i just want to point out if you click on the name you can indeed see all of their roles so potato person and chocolate lover and i guess just to make a triple sure that this works for all of them i click the monkey and all right so i now have the potato person chocolate lover and funky monkey rolls so now what we have to do is just add one more method that's pretty much just going to be a quick copy and paste with a few tweaks and that is how to remove a roll from a user whenever they remove this emoji so again i just remove funky monkey but since we don't have that logic yet i still have the funky monkey roll so how do we do that well let me just go ahead and stop this bot and all right due to laziness what i'm gonna actually do is just copy this on raw reaction add just because it's so similar make sure everything's lined up all right so the event whenever a user removes a reaction from a message is on raw reaction remove so we will say that this method is going to um remove a roll based on a remove a roll based on a reaction emoji so this takes the same payload and again uh we're just going to keep this bit of logic right here because if they are removing emojis from another message other than this one right here then we really don't care about it so we can just return out of that of course we still need a reference to the guild because just like before we only want to be looking through the roles for this guild now after this what we need to do is we actually need a reference to the member who is trying to remove their role so i'm just going to call this member and set this equal to guild and there's a easy method on here called git member and for here what you just need to pass in is the user id so payload dot user id all right so all right we have a reference to the guild and the actual member so now just like before we are gonna be matching these potatoes chocolate and monkey and this first one is the same right here we need a reference to the roll however the thing that's different in this is actually this second line right here which instead of adding a roll to them what we want to do is we want to say member dot remove roles and for this member what row do we want to remove well of course it's this roll right here so we can just take this and paste it in here replacing the adder rolls with remove roll and just to recap one last time whenever they remove or in other words do this what we want to do is basically say okay uh what member is trying to remove one of the roles are they removing one of these three emojis and if so we just want to get the roll associated with this emoji and then remove that roll from the member or remove the remember from the roll however you say it i don't know but anyway so just go ahead and test this out and run this and that looks ready and all right so of course i am a potato person now i actually also have these two other rolls because i removed those emojis before the bot was actually running to remove the rolls from it so either way i am a potato person right now i'm going to click this and it says okay you are now no longer a potato person now just to make sure i can remove chocolate lover and funky monkey i'm actually going to have to add those rolls back in so there's the monkey and there is the chocolate and all right so now just test chocolate lover if i click this no more chocolate level roll and last but not least if i just want to get rid of all my rolls then i'm going to click this monkey in our right so now all of my rolls are gone and just to test the full logic one more time let's go ahead and add me as a potato person all right looking good and remove and there you go so that is how you make the basics of a rolls bop in other words you can have a message that say reply with one of these emojis whenever you want a specific role and again in addition to just having it like cosmetic where you are like potato person or funky monkey or whatever typically like i said what roles do is it gives users access to either certain permissions like you can be a moderator that's probably not something you want to do just have someone anyone react with an emoji and they suddenly become a moderator but just you know kind of giving you guys an overview of the potential they can either have certain permissions to do things or more likely what you're going to do is you're going to give them access to certain channels or certain sections of the discord server that they want to see for example maybe programmers want certain channels or designers want certain channels so on and so forth but yeah there you go the basics of a discord rosebop so thank you guys for watching don't forget to subscribe and i will see you guys later