hello YouTube Sam here from youtube.com/ onli gamer from the New Boston and in this tutorial we're going to continue working on our uh FTP downloader now you may have been thinking to yourself that well what if they put in a an invalid server so let's say this is invalid when I click save server settings you can see um that if I click home directory it's going to try and connect to that and you may think it's going to freeze and crash but you can see that our FTP client um VB class library has this built into it so so that if it can not connect to the FTP server it's going to show them a message box saying uh that it could not be resolved so it could not connect now this is something that makes our lives a whole lot easier um when we're building this program because it checks for us automatically and already has a exception handling in it so uh thanks to Howard Richards for that so now let's go ahead and allow the user to upload a file so we'll access the click event for upload and what we need to do is create an open file dialogue so we'll go ahead and get rid of this and what we need to do is come into our designer come over to our toolbox and scroll down to dialogues so we'll open up an or we'll add an open file dialogue and we'll just call this open file to upload just hit enter there and looks like we put that in the wrong field that needs to go in the name so now what we need to do is we'll do declare path name as string and then we'll do file name as string and let's go ahead and type open file to upload. tile and we'll say that equal to please select a file to upload okay so now I'll type if open file to upload do show. dialog is equal to Windows or let's see forms let's see windows. forms. dialog result. okay so if the dialogue result is equal to okay then what do we want to do well we're going to set path name is going to be equal to open file to upload dot file name so this is going to get the whole directory of the file so now what we need to do is get the file name now this is where it gets a little bit tricky so file name is going to be equal to string or we need to get a substring of the the path name so we'll do path name. substring and we're going to have to give it a start index so what we're going to do is type path file or not path file path name. last index of so it says reports the index position of the last occurrence of a specified character within this instance so the last occurrence of I believe it's going to be a backs slash so at the last index of this we just want to add one so what this is going to do is it's going to set file name equal to a substring of path name and this substring is going to start at the last occurrence of the backs slash and we add one to that um just so it'll start on the first character so let's say we've got a whole long directory like C Callum back SL doents back SL hello. text what this is going to do it's going to start at the last index of this so let's say the last index is 15 it's going to add one and so it'll start at 16 and it'll take all the characters after that which will get us the file name so now what we need to do is we need to upload that file so let's just go ahead and enclose it in a try catch statement in case any errors happen so we will call FTP downloader do upload and the local file name is going to be equal to path name and the target file name is going to be equal to file name and then let's see here we'll go ahead and catch this exception so messagebox doow ex. message so the reason we're doing a TR catch is because we might get a network error and also these might be set to null so let's go ahead and minimize out of that now I know this part right here can be a little confusing but if you play around with this and see uh changing changing the last index of this um or if you go back to the substrings tutorials um and you look at this you will be able to figure it out um and see what's going on so we go ahead and run this so go ahead and click upload and let's just go to my desktop and let's add a let's just upload popey to the FTP server so we'll click open and it's going to open up that um file and it's going to upload it to the server now you can see that nothing's showing up right here so what we need to do whenever they upload we're going to need to refresh the list now we'll go ahead and run this let's go ahead and go to the home directory and you can see here that we have popeye. jpeg now I'll show you this by uploading another one and you can see here the title is please select a file to upload which is what we um selected so we'll upload a villain so we upload the villain and you can see it will update the list box and it adds villain cartoon. JPEG to it so go ahead add this code in to upload a file and once you've done that if you understand it move on to the next tutorial