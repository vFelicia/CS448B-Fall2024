hello YouTube sam here from youtube.com slash on live gamer for the new Boston and in this tutorial winner can we're going to continue working on the FTP downloader now you can see we have these two buttons here called load files and clear now I just added these so it makes it easy to update the list and it also makes it easy to clear everything from the list now this doesn't actually delete any files and you click clear it's just going to clear our list box so whenever the user clicks check for new files let's just go ahead and refresh the list so now I'll come back in here and whenever they cleared the list we'll just type list FTP files dot items dot clear so now if we go ahead and run this we can go ahead and go to the home directory and if we click load files it actually upload not uploads it updates the files in here and it doesn't look like anything's changing but it's actually going through and adding all them to the list we can also clear it and then when we click load files again it's gonna add them back in there so now we have one last button and it's called start checking for new files now this button yeah what we're gonna program for it is gonna be very useful what its gonna do is it's going to start a timer and every so often it's going to check for new files in the FTP server and if it detects that a new file is there it's gonna notify us of that so what we're gonna do is we're going to add a variable that we can use so we'll do private checking as you lean and we'll set that equal to false so this is gonna let us know if the if it's checking for a new files so let's double click on the event for start checking for new files and we'll say checking equals not checking okay so now that it is reversed so it starts out as false and when they click it the first time it's going to be true because it is it will be checking now so if checking then what do we want to do well we want to set the button text so button check for new files dot text is going to be equal to and let's see here start checking for new files so if it's checking then we wanted to say stop checking for new files and then after that let's do timer checking dot start now this is going to give us an error because we have not created time for checking yet but we're going to do that later on so then we'll do else if not checking if checking is equal to false by saying not checking that's just basically saying else if checking is equal to false then what do we want to do we'll set button check for new files dot txt is gonna be equal to start checking for new files and then we'll stop the timer so a timer checking dot stop okay so now all we need to do is we'll come over here to form one and we need to add a timer so this is going to be under your components then we'll click on timer to add it to the form and now we will set the name of timer to timer checking so you can set the interval of time or checking to whatever you want but I'm gonna leave mine at one millisecond 100 milliseconds for now which is a tenth of a second and this is going to be a good time so we'll double click on timer checking to open up the tick event for it and what we're gonna do is we're going to go through each file in the server directory and see if there's one that we don't already have so we're going to type for each and we'll do file in FTP downloader dot list directory detail so for each of the files in there what we want to do is check to see if we already have it so we'll do this by using a simple if statement so if and then we'll just say not list FTP files dot items dot contains and we want to see if it contains file dot file name so basically what this is doing if and let's just ignore the knot for now so if list FTP files that item stock contains file dot file name so if the file that is in the current iteration of this for each loop is already in the list box then we know we already have it and so we're using not here so if it's not already in there then what do we want to do we want to add that to the list box so this list FTP files dot items don't add and we will add file dot file name now we need to have a way of showing this to the user so that they know that there is a new file so let's come over here into form 1vb and we need to open our toolbox and let's go ahead and find a notify icon let's see here here's our notify icon and we'll just set this to the name of this to notify new file so go ahead and put this code in and create the notify icon and then in that in the next tutorial what we're gonna learn how to use this