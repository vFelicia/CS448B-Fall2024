all righty guys welcome back to another video and in this one we are going to talk about a concept called routing so as your application scales you may find that it gets difficult to really have a single big prompt that does everything that you need it to not only is it going to be difficult to maintain but it's going to be difficult to evaluate as well now instead what you're likely going to find is that it's better to have smaller specialized prompts that are better at responding to a certain category of questions kind of similar to how we have been developing them so far so let's pretend that this application got released this little chat bot in that after a month of just looking at user traffic figuring out what questions they're asking we saw that there were really three big categories of questions and we'll go with this example that we've been sticking with one of the categories of questions that we've been getting in was questions about the bot itself stuff like what is your name or what is your purpose or what llm do you use the other category of questions that we'll pretend that we got in were questions about the video so in the last video we saw we could create this prompt right here IA video and we can inject a video transcript as well as a source code into it and that this worked really well for answering questions about the video we even saw that in the evaluation now the last section right here let's just say that if we get a question in and it wasn't about ya wasn't about the bot and it wasn't about the video then we could assume that it was just like a general programming question how do I fix this bug um I have a missing semicolon what am I supposed to do so on and so forth so what we could do is now that we notice that three these are three big categories we can go ahead and create prompt templates like we have been that's responsible for each one but now we have the problem of whenever that question first comes in we now have to decide which category or in other words which prompt template to use for that question and in this case what the solution would be is this router prompt template and that's what we're going to be building in this video a router prompt template that intakes a question and responds with a single word either self video or general and then in our application code what we can do is we can use that to map it to a prompt template and that way we can develop our system to really keep things very modularized which of course is going to help with development a lot and also it's going to simplify the evaluation process because now our evaluations they don't have to test this whole slew of all these random questions we can develop our prompts so that they're a bit more specialized because just like in programming whenever you have a function and it becomes too big it's difficult to test and difficult to maintain so we want to take that same concept and apply it to llm application development as well so on that note let's go ahead and hop over here and in the University I'm going to go ahead and create a new template and I'll just call it a router and then let me just change this to Ginger 2 and for the system prompt we can say something like you are an AI that helps people with questions related to uh programming tutorial videos and I just want to give it context of like what its purpose is even though this doesn't help with the exact output just to um you know give it a little better understanding of what we're using it for so now we can kind of give it more Direction and say given a question your job is to categorize it to one of three categories and we will say since we're looking for either self video or general we'll say self and we'll say for questions about yourself such as what is your name good to give it a little example here and then we'll say video so so respond with this for video specific questions and we can say something like um we actually use an example that we used in our evals from last video uh what words print out in the first Loop and this is also why I like to say that you're an AI that helps with programming uh related questions basically because then this makes a little bit more sense has some context of what a loop is and then we'll say General and we'll just say that this is for all other questions and we can go ahead and just set we'll try 3.5 see how that works out and then I just want to reemphasize that your response should be one word only okay so the last thing we need in here is just a placeorder for the question and that's just singular question there we go so I'm going to create this template next next all right so now that our template is created let's go ahead and test this bad boy out so I already created this data set and I just have five questions here and I'll go through them real quick um again each of these questions and let me download this while I'm waiting so file download CSV all right download okay so the first one is just what is your name and again this should be easy we gave it as the example example that the second one is just actually these next two are just like General programming questions so those should end up in the general bucket and then these last two questions right here what is to return value of the main function from the video and what is the name of the class from the video again we're really helping it out here by saying from the video but uh for now again this is just like a really simple data set whenever we are releasing this in production you actually want to go through make a much bigger more extensive data set but for right now testing out uh this will be fine to demonstrate the concepts so what I'm going to do from here is just evaluate it by clicking on evaluate and I again am just going to name it similar to this which is router so I'll name the pipeline router and for the data sets let me upload that so upload my download router and I'll say router data set just like that all right so select my data set choose select data set and create my Pipeline and now I can just hook it up by clicking add new column and then we just want to hook up the prompt template that we just created so prompt templates and for this I will say the llm response and now for the prompt template what was it this IR router uh we'll just use the latest version and then for the model engine uh we won't select any defaults because we already set our model prams on the prompt template itself so it's just going to pick up those and for question I'm just going to select the question and all right run step so this was the actual answer and we'll see what I responds and actually we're going to add one more okay so this is looking good so far so what we can do actually is add one more check which is equality comparison and I'll show you what I'm doing right now so what we're really looking for at the end is did I as a response which is in this column right here match this response which is basically the right answer and since it's a little bit different where they just match exactly it's not like the last video where the right answer was ya but she could have said my name is a or oh yeah actually I'm referred to as a and they're all acceptable here what we can do is just check strict equality so equality comparison and we'll say uh we'll just say score actually let's say booing since this is going to return a Boolean and we're just going to compare strings and this is basically asking what are the two columns that you want to compare so the source is the category this is just the right answer and the target is the llm response basically what I answered so I'm just going to save this and now all this is going to do is check if these two values from the category and llm response are equal if so it's going to say true and of course this means that I got all of these right so far so now I'm just going to go ahead and run the full batch and that's just going to run all five examples instead of four so you know probably going to get pretty similar results here but there we go the initial cells are created now I'm going to give a some time to come up with her answers looks like she's been doing so far and all right there you go so it looks like she got a perfect score of 100 and yeah there you go the basics behind the routing architecture in llm application development again this just really helps with keeping your promp template small to help with not only maintenance of development but also to simplify the evaluation process as well so on that thank you guys for watching don't forget to subscribe and I'll see you next video