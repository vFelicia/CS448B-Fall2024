With timestamps:

00:00 - you'll build spotify web 3.0 adapt with
00:03 - next.js you'll also learn how to create
00:05 - your own program on the solana
00:08 - blockchain using the anchor framework in
00:11 - the programming language called rust
00:13 - we'll also be storing the music data on
00:15 - the solana blockchain we're gonna use
00:18 - quicknote as our rpc provider to connect
00:21 - to the blockchain you'll use cargo to
00:23 - compile and deploy your own smart
00:25 - contract you're gonna be using phantom
00:27 - wallet to actually authenticate your
00:29 - users that sign in and out of your
00:31 - application phantom wallet i believe is
00:34 - one of the best wallets to pair up with
00:36 - solana and it's so seamless and the ui
00:38 - is an incredible experience that's why
00:40 - we're using that they'll use the solana
00:42 - web3.js
00:43 - package to interact with your smart
00:45 - contract on the blockchain we'll use
00:47 - context api to manage the built-in music
00:50 - player on your spotify app will then
00:52 - deploy this app to digitalocean and host
00:56 - your own spotify web 3.0 blockchain app
00:59 - on the freaking interwebs are you
01:02 - excited because i'm excited with that
01:04 - said smash that like button turn it
01:06 - white hit the subscribe button because
01:08 - it's the best channel on the planet when
01:10 - it comes to you becoming a web 3d
01:12 - developer and with that said let's jump
01:14 - right into it what is up youtube i'm
01:17 - super excited today to demo the spotify
01:20 - app for you guys so let's just get
01:21 - started right away the first thing
01:22 - you'll see is the log in to access this
01:25 - app as you can see we are missing an s
01:26 - but it doesn't mean it doesn't work once
01:28 - you see this button click select wallet
01:30 - and you will need a phantom wallet to
01:32 - connect to this build so i have phantom
01:35 - already and i'll show you guys how to do
01:37 - that later in the video but that's not
01:38 - the focus click on phantom it's gonna
01:40 - prompt you to log in i'm already logged
01:42 - in as you can see and there's a super
01:44 - sick feature where i'll show you guys
01:46 - how to make it so that people need to
01:48 - pay to use your own service that you
01:49 - work hard to make this is an optional
01:51 - thing that you can include but it's
01:53 - something cool to learn so make a
01:54 - payment to get our app it's pretty cheap
01:57 - you're just going to pay point one test
01:59 - solana so let's click on this and only a
02:01 - one-time payment which is cool so i hit
02:03 - approve awesome an alert that says
02:05 - transaction successful and all i have to
02:07 - do is just wait for it to refresh by
02:09 - passing pressing verify payment just
02:12 - give it a second awesome and once you
02:14 - click it it refreshes and look at this
02:16 - beautiful app how amazing this is right
02:19 - you won't even think that this is like
02:21 - the real spotify we have playlists we
02:22 - have songs and beats we have all our
02:25 - favorite songs over here all you need to
02:27 - do is customize it however you want and
02:29 - add it to your portfolio but what is
02:30 - functional are these two songs right
02:33 - here these songs are actually living on
02:36 - the blockchain and are being fetched
02:38 - from the solana network to our front-end
02:40 - app so let's see if they work right i'm
02:42 - gonna click on floating so all right you
02:44 - guys can hear that what if i press pause
02:46 - let's go right there's pause play
02:48 - functionality and best of yet there is a
02:51 - play next and the cool part it's really
02:53 - smart if i were to play next and this is
02:55 - on loop what song should i go to right
02:57 - back to the first one so all of that
02:59 - functionality is included in our app all
03:01 - right and let me show you guys more my
03:03 - favorite feature which is let's add a
03:05 - song right to add a song what you're
03:07 - going to need is to host that mp3 file
03:10 - on the cloud we're using cloudenary for
03:12 - this and also a title for it so this one
03:14 - is called
03:15 - sun
03:16 - kissed blood and then for the music url
03:18 - i have it here feel free to use any
03:20 - cloud hosting site you want i'm again
03:22 - i'm using this one and it's not the main
03:24 - focus of the video but once you have
03:25 - that rest set up all you do is click
03:27 - create new so i'll hit create new right
03:30 - solana is going to ask me to if i want
03:32 - to store it and approve it disappears
03:34 - let's give it a magic minute and
03:37 - there we go do you guys see it the sun
03:38 - kiss glow song that we just added is
03:41 - live in our app and guess what it's
03:44 - playable as well can i hear the file
03:46 - cracker on this one beautiful you guys
03:48 - don't have to add any songs that i add
03:50 - feel free to add whatever you want put
03:52 - this in portfolio do you guys want to
03:53 - learn how to build this i know i do so
03:55 - i'll see you guys in the tutorial hello
03:58 - youtube welcome back to another video
04:00 - it's lance here again and i'm with you
04:02 - today to teach you about the spotify
04:04 - clone i'm super excited about this build
04:05 - because i personally love music and it'd
04:07 - be super cool to teach you how to store
04:09 - songs on the solana network so enough
04:12 - talking i want to show you guys how to
04:14 - build this app so let's head over to
04:15 - your terminal
04:17 - once you open up your terminal let's use
04:19 - our fancy cli tool that we just made
04:21 - i'll have to do is type in npx clever
04:24 - programmer like so and hit enter type in
04:27 - your email address i'll put in my clever
04:28 - programmer account type in your name and
04:31 - look at that so you're going to see two
04:33 - projects at the moment and if you're
04:34 - seeing this in the future you might see
04:35 - a whole list of projects that we've
04:37 - created together so we don't worry about
04:39 - tick tock we want to click on spotify
04:41 - because once i hit enter bam take a look
04:44 - at that so let's make this vs code
04:46 - extension nice and big i didn't open vs
04:48 - code the cli tool did it for us which is
04:50 - super amazing as you can see too it
04:52 - created the next js app for us so
04:56 - one thing you got to make sure is make
04:57 - sure you have the node modules installed
05:00 - for whatever reason you don't have node
05:02 - modules you can take a look at what
05:04 - packages we have over here you can see
05:06 - we have a couple especially if you want
05:07 - to start using solana for this and to
05:09 - double check if you do you can one see
05:11 - if you have the folder and if not you
05:12 - can type in npm install or yarn if you
05:15 - want to use yarn okay so i'm going to
05:17 - install my dependencies i'll check back
05:18 - with you guys in a second okay amazing
05:20 - so if you have your node modules ready
05:22 - to go you can go ahead and type in yarn
05:25 - dev okay so i hit yarn dev looks like
05:28 - it's ready to go at localhost 3000 i hit
05:30 - enter and take a look at that as you can
05:32 - see we gave away some of the front end
05:35 - for the app mainly because i want to be
05:37 - teaching you guys how to integrate your
05:38 - app with solana so don't worry i didn't
05:41 - give away all the front end we're going
05:42 - to be doing some of the main features
05:44 - together like the player and the header
05:46 - this is just static information so
05:48 - you're not missing too much with all of
05:49 - this so now that you have your app up
05:51 - and ready to go we can go ahead and get
05:53 - started all right so one of the first
05:54 - things we're going to do is i'm going to
05:55 - switch these two windows around because
05:56 - usually i have the code on the left and
05:58 - the browser on the right so let's format
06:01 - this real quick don't mind me cool let
06:03 - me go ahead and exit our terminal and
06:07 - boom there we go so i can minimize this
06:09 - and let's just take a quick look around
06:11 - as you can see this is a standard
06:13 - next.js app with some starter files of
06:15 - course right so we have the index.js
06:18 - which comes with every react app and the
06:20 - only thing that it holds is this audio
06:23 - tag which is what we're going to use to
06:24 - set up and play music which is pretty
06:27 - much given to us with javascript with
06:29 - the home page that is a component over
06:31 - here which is going to hold all of this
06:33 - so if i do like an alt c here and do a
06:36 - command b you guys can see i've made a
06:38 - little comment for you that says start
06:39 - coding here so this would be nav this
06:42 - would be activity right that's what's
06:44 - given cool other than that there is a
06:46 - couple components that are made like the
06:48 - activity and nav stuff which again is
06:50 - all this sidebar is right here we're
06:52 - going to be making a lot more components
06:54 - so don't feel like you missed out so one
06:57 - of the first things i'll have you do is
06:58 - let's go ahead and make the login
07:00 - component so i'm going to go over here
07:03 - go over to components and let's just say
07:04 - new file and we can say
07:06 - login.js okay once that's done i'm just
07:10 - going to do an rafce oops did it too
07:12 - fast r-a-f-c-e
07:14 - boom to set up the component i'll hit
07:17 - save and the trick that we're going to
07:19 - do here is if i do control p and head
07:22 - over to the index notice how it's going
07:25 - it loads the home page right it's just
07:27 - to temporarily load it we instead we
07:29 - want to be loading the login page right
07:32 - because they can't get into our app
07:33 - until the user logs in so if that makes
07:35 - sense let's instead of importing this
07:38 - let's import login from components login
07:42 - and we don't want home page we want log
07:45 - okay you can go ahead and erase this
07:47 - comment because that is complete so if i
07:50 - save this now hey look at that it says
07:52 - login that is totally fine so if you
07:55 - remember our demo the login component is
07:58 - going to ask us to connect with our
08:01 - wallet so if we're making a project on
08:02 - solana we typically use phantom wallet
08:05 - so if you don't have phantom installed
08:07 - let me show you guys how to do that now
08:09 - so all you have to do is type in phantom
08:11 - and you can say extension
08:14 - and usually it'll lead you to this
08:15 - chrome website if you didn't know
08:17 - phantom is the wallet where you can hold
08:19 - your crypto especially it's made for the
08:21 - solana chain so i already have it on
08:23 - chrome go ahead and click add once
08:25 - that's done you can open up your phantom
08:28 - and it's going to ask you to create a
08:29 - new wallet and type in a password you're
08:32 - going to see when you type in your
08:33 - password and sign up it's going to give
08:35 - you a recovery phrase don't share that
08:37 - with anyone because that's essentially
08:38 - the key to get into your account besides
08:40 - you know your password so i'm going to
08:41 - type in my password and as you can see i
08:44 - have
08:45 - wallet one right and on top of making an
08:47 - account you can make up multiple wallets
08:50 - the main thing that you're going to need
08:51 - to do is connect to the devnet right if
08:54 - you're on the main net that's going to
08:55 - be using a real solana that you pay for
08:57 - right then that's worth money so when
09:00 - you're developing and you're just
09:01 - testing stuff we don't need to use real
09:02 - money you can just use you know fake or
09:04 - test salon for our apps so let's connect
09:07 - to the devnet you can connect to the
09:09 - devnet by clicking onto your phantom
09:11 - wallet after you've logged in click on
09:13 - the little cog wheel right here and this
09:15 - is your settings here you can rename
09:16 - your wallet or anything like that but
09:18 - scroll down to
09:20 - change network and make sure you are in
09:23 - devnet so again not mainnet beta so i
09:26 - click make devnet and i'm already on
09:27 - there and now you guys are good to go
09:30 - all right so now you have phantom wallet
09:31 - set up let's go over to the login again
09:34 - over here and let's just create the
09:36 - front end for it first okay cool so just
09:39 - to give you guys a better view i'm going
09:41 - to extend this just a little bit more
09:43 - now is that now we're full screen right
09:45 - so with the login there's not much to it
09:48 - all we have to do is make a div here
09:50 - which there already is format it like so
09:52 - and again we're going to be using
09:53 - tailwind for this but for the login i'm
09:55 - just going to use the class name
09:58 - styles
10:01 - dot login page login page and within
10:04 - that div
10:06 - we're gonna have a p tag class name i'm
10:09 - gonna say styles dot text and then we'll
10:12 - just say right i know it says styles is
10:14 - not defined log in to access this app so
10:17 - if you want to put styles on here
10:19 - because we're using tailwind just make
10:21 - that styles object up top say cons
10:23 - styles oops is equal to
10:26 - login
10:27 - page
10:30 - and here we can give it a width screen
10:32 - height screen
10:34 - background white all right because this
10:35 - background should go with the main
10:37 - spotify component i want to fade save
10:39 - here see this should be s there we go so
10:41 - now we can see the background white
10:42 - taking effect here and we want to
10:45 - display flex with a justify center
10:48 - justify dash center give it a flex
10:51 - direction of column and and item centers
10:54 - now it's going to make that
10:56 - box perfectly in the center okay cool
10:59 - then we can see text oops don't forget
11:01 - to put a comma then we can style the
11:03 - text and then we can say
11:05 - text we're going to write text
11:07 - for xl then make sure the text is black
11:10 - with mb 10.
11:12 - cool log in to access this app from here
11:15 - i want to set up the skeleton
11:17 - of the phantom connection so i'll just
11:20 - put a comment here temporarily and
11:22 - inside is going to be a component called
11:24 - wallet multi
11:26 - button right so this component is not
11:29 - something we need to make it's something
11:31 - we're going to import from the phantom
11:34 - library so we're going to need to do is
11:36 - say import wallet multi button from at
11:42 - solana
11:43 - wallet adapter react ui yep the reason
11:47 - why i don't have it uncommented because
11:50 - if i do this we're not going to see
11:51 - anything because i didn't add the wallet
11:54 - connection provider so that we can use
11:56 - this library so you know we could leave
11:58 - it like this but i wanted to just
12:00 - visualize that this isn't working just
12:01 - yet but let me go let me show you guys
12:03 - how to get it up and running
12:04 - okay so what we're going to have to do
12:06 - here is set up a folder called context
12:11 - and our context folder is going to hold
12:13 - our provider so in the new file we'll
12:15 - say
12:16 - wallet connection
12:18 - provider dot js awesome now with that
12:22 - provider i'll just do a control b here
12:25 - boom r-a-f-c-e
12:27 - cool now to get started with the
12:29 - provider we're gonna need to import a
12:31 - couple things as well the first one
12:33 - being import
12:34 - connection provider and the wallet
12:38 - provider and this is going to be coming
12:39 - from at solana wallet adapter react okay
12:42 - can i see that
12:44 - awesome next thing you want to import is
12:46 - the wallet
12:48 - modal provider from
12:51 - solana wallet adapter react ui and then
12:55 - import
12:56 - phantom wallet adapter from the wallet
12:59 - adapter wallets okay cool so in the
13:03 - parameters of the function we're gonna
13:05 - make an object right here and it's gonna
13:08 - take children and then up at the top
13:10 - here we're gonna say const wallets is
13:13 - equal to
13:14 - something called use memo use memo is a
13:17 - react hook so that we only have to
13:19 - render this once so we're going to take
13:21 - advantage of that so we're going to
13:22 - import use
13:24 - memo and while we're here we're also
13:25 - going to import something called fc
13:27 - from react
13:30 - wait sorry never mind we're not
13:31 - importing fc so we're going to take
13:33 - advantage of that and say use memo from
13:35 - react that's what we're going to need so
13:37 - now that this used memo exists all right
13:39 - we can make use of it so inside of used
13:42 - memo we're going to make an anonymous
13:44 - function
13:45 - that is going to be have an array and
13:47 - it's going to say new instance of a
13:49 - phantom
13:50 - wallet okay and make sure you put
13:53 - parentheses right after close the array
13:56 - and put a comma here and put an empty
13:58 - array as well awesome cool so basically
14:00 - i'm saying the wallet that i want to
14:01 - provide is phantom okay now for the
14:03 - return it's pretty important we're going
14:05 - to need to get
14:06 - our connection provider and then inside
14:09 - connection provider we're going to need
14:10 - the wallet provider
14:17 - and then lastly inside the wallet
14:19 - provider we're going to need the wallet
14:22 - modal provider you following so far so
14:24 - close it off and in between this water
14:27 - wallet modal provider there we can put
14:29 - children okay and
14:32 - for inline 13 for me in wallet provider
14:35 - it's going to have an attribute
14:37 - called wallets and it's going to equal
14:39 - what so essentially passing all the
14:40 - wallets that we're using if you look
14:42 - what wallets we're using we're using
14:43 - phantom so say wallets and you're also
14:45 - going to need something called auto
14:46 - connect here so that if you already have
14:50 - phantom it's going to be connected
14:52 - automatically if you're logged in cool
14:54 - there's one more thing we're going to
14:56 - have to do inside of the wall connection
14:58 - provider and this app is to provide an
15:01 - end point for our connection all that
15:04 - means is think of our front end app or
15:06 - our provider here it needs to be
15:08 - connected to the solana network it can
15:10 - do this by becoming a node and using
15:13 - that node to connect to the blockchain
15:15 - so if you're going to make your own rpc
15:17 - node that could take a lot of work for
15:19 - this build we're going to be using a
15:20 - service called quick node which they
15:22 - provided support for solana as an
15:24 - endpoint so what i'm going to do is set
15:26 - equal to endpoint right and then what we
15:29 - need to do next is let's set up our
15:31 - quick node project i just want to take a
15:33 - moment to show you guys what we're going
15:34 - to be using to deploy our app to make it
15:37 - live right so what we'll do is head over
15:39 - to do.co
15:41 - cleverprogrammer and you'll be greeted
15:43 - with this page right so like i said
15:45 - we're going to be using a service called
15:47 - digitalocean to make our app live and as
15:49 - you can see here our friends at
15:50 - digitalocean were very nice and gave you
15:52 - guys a hundred dollars to get started to
15:54 - learn on digitalocean so how cool is
15:56 - that so all you have to do to get this
15:58 - credit is to sign up with your email and
16:00 - once you do you'll be able to use all
16:02 - the services and infrastructure that
16:03 - digitalocean has to offer and if you're
16:05 - not familiar with what digitalocean is
16:07 - as a whole it actually does a lot of
16:09 - different things so let's go ahead and
16:11 - make an account real quick and once
16:12 - you've made an account go ahead and
16:13 - click create free account and it's going
16:15 - to ask you to verify your email and once
16:17 - you are officially signed up you should
16:19 - be greeted with this nice landing page
16:22 - and all you have to do is take a look at
16:23 - this left sidebar and you can see all
16:24 - the digitalocean has to offer our main
16:27 - focus is going to be the app so that we
16:29 - can make our project live like i
16:30 - mentioned before so i'm gonna explain to
16:33 - you what digitalocean is more in depth
16:35 - later in the video when we go ahead and
16:36 - deploy but for now all you need to know
16:38 - is that digitalocean is infrastructure
16:41 - as a service all that means is
16:43 - digitalocean is hosting servers that we
16:46 - as developers can program and make full
16:48 - use out of as you can see here so
16:51 - without further ado let's get on to the
16:52 - next part of the video alright so to get
16:54 - started with quick node and to get the
16:56 - endpoint that we need go ahead and go
16:59 - into the description and click in the
17:00 - link below because quicknote hooked this
17:02 - up with a free endpoint all you have to
17:04 - do is take that link put it into the
17:07 - browser and fill out this quick 45
17:09 - second survey and as i fill it out i'll
17:11 - go ahead and explain to you what quick
17:13 - note is so let's hit let's go type in
17:15 - your email to where you're gonna this is
17:17 - where you're gonna receive your endpoint
17:18 - go ahead and hit okay and if you didn't
17:20 - know quick node is a web3 development
17:23 - platform that helps us scale our apps
17:26 - right there's a lot of different
17:27 - platforms that do similar things to
17:28 - quick node but one of the main reasons i
17:30 - like quick note and why we're using it
17:32 - today is because they provide support
17:34 - for the solana chain and at the time of
17:36 - this video they're the only ones that i
17:38 - know that are doing it at this moment so
17:40 - we're going to take advantage of that so
17:42 - when it says what change do you plan to
17:43 - build on we're clicking solana so i
17:45 - click solana i hit okay and from there
17:48 - just answer this question are you
17:50 - building a project outside of this
17:51 - tutorial no just this video but feel
17:53 - free to use this for any other builds
17:55 - that you guys want so cool i'm gonna
17:57 - click web 2 engineer because that's
17:59 - going to relate to most of you guys and
18:00 - where are you based just click on what
18:03 - is relevant to you from there go ahead
18:06 - and click submit and you'll be greeted
18:08 - by the quick node web page
18:11 - all right so you should have gotten an
18:13 - email by now i'm going to go ahead and
18:14 - grab my endpoint double check your email
18:16 - to see if you got it yourself all right
18:18 - perfect so i got my endpoint and what
18:20 - we're going to do to make this a lot
18:21 - easier since we're going to be using it
18:23 - in a couple different places i'm going
18:25 - to go ahead and hit ctrl b and what i'll
18:27 - do is in the root of our folder we're
18:30 - going to make another folder called okay
18:33 - and in our utils folder make a new file
18:35 - and we'll say const.js
18:37 - perfect
18:39 - let's just clear out this folder we can
18:40 - make this a little bit bigger awesome
18:42 - and just click this back to our page and
18:44 - what we'll do is import a couple things
18:47 - the idea with the cons folder is going
18:49 - to hold a couple different variables
18:50 - that we'll be using throughout our app
18:52 - let's just import public from at solana
18:57 - slash oops lana slash web3.js perfect
19:01 - okay from there we want to do is export
19:05 - const
19:06 - something called
19:07 - solana underscore host and it's going to
19:11 - equal
19:12 - the quick note endpoint that you got in
19:14 - your email so if i put quotes in here
19:15 - and i hit paste this is mine all right
19:18 - go ahead and paste yours onto there and
19:20 - we're going to be coming back back to
19:21 - this to update it with more things but
19:23 - for now this is perfect so now we have
19:26 - that let's head back to our wallet
19:28 - connection provider and what we'll do is
19:31 - the following so we're just going to
19:32 - import that solana host right so what
19:34 - does a lot of host
19:36 - hold in this variable what do you guys
19:38 - think it's the actual endpoint itself
19:41 - okay so what do we want to pass in here
19:44 - exactly so what we're going to do before
19:46 - we just put it into this
19:48 - value here or this object we're going to
19:50 - set it up like we did with wallets and
19:51 - i'm just going to say const endpoint is
19:54 - equal to
19:56 - use memo so we're going to use the use
19:58 - memo hook again and inside use memo
20:01 - we're going to say solana underscore
20:03 - host perfect so essentially right our
20:06 - quick note endpoint is in solana host
20:08 - and we're going to put that in a
20:09 - variable called endpoint and we're going
20:11 - to take that variable and pass it here
20:14 - so that we can use it all right so
20:16 - that's it that's our wallet connection
20:18 - provider right so our provider is set up
20:20 - but it's not being in use yet so that we
20:22 - can use it we're gonna need to do is go
20:24 - to our app and let's import that
20:26 - provider and wrap it around our
20:29 - application so what we need to do is
20:32 - import dynamic from next dynamic right
20:35 - this is something similar like we did on
20:37 - the tick tock clone if you guys watch
20:39 - that video we also need to import or
20:42 - like actually require at
20:44 - solana we need the wallet slash adapter
20:48 - react that's the one i want to adapt
20:51 - wallet adapter so react one yep react
20:54 - ui
20:55 - and then it's gonna be slash styles.css
20:59 - hit save and what we can do from there
21:01 - is say
21:02 - const wallet connection provider is
21:05 - equal to and here comes dynamic
21:07 - parentheses and then we can say import
21:10 - quotes dot dot context
21:13 - dash
21:14 - wallet connection provider okay we're
21:16 - almost done what you want to do after
21:18 - this is add a comma then put this little
21:20 - object here and say sr is false okay
21:24 - cool awesome so now we have the provider
21:26 - imported to us what we need to do is
21:29 - wrap it around the app so to do so i'm
21:31 - going to put quotes and after we put
21:33 - quotes what we need to do is take the
21:35 - provider so i'll say call the what's it
21:37 - called the less than symbol wallet
21:39 - connection
21:40 - provider right now it's not grayed out
21:43 - close it and just simply put your app in
21:45 - between this okay cool so now that we
21:47 - have our provider set up we can go ahead
21:49 - and use that wallet connection button
21:51 - over here so what i'll do is head back
21:53 - to login and we can comment this one out
21:55 - so i said save hey there it is we now we
21:57 - can select wallet and you can see that
22:00 - it detects that i have phantom right i
22:02 - didn't write any code for this wallet
22:05 - multi button this is provided through us
22:07 - through the solana wallet adapter and it
22:08 - can already detect what wallets are
22:10 - connected so that is pretty sick we can
22:13 - do take this one step further before i
22:14 - make the connection is that once you log
22:16 - in you should be sent to the home page
22:20 - yeah that makes sense but another thing
22:21 - that we could do and i want to show you
22:23 - case in this video is what if you wanted
22:25 - to make it so users have to pay for your
22:28 - service or whatever app that you create
22:29 - so i'm going to show you guys how to do
22:31 - that with a payment component right so
22:34 - users will pay some solana to use your
22:36 - app you can think of it like subscribing
22:38 - to spotify so that you can get their
22:39 - music so let's hit ctrl b and what i'll
22:42 - do it under components i'll make a new
22:44 - file i'll call it payment.js
22:46 - we can just say rafce perfect hit save
22:49 - and once that's done all right it should
22:52 - just look just like this go back to
22:53 - login and here's what we'll need to do
22:55 - we're going to import a hook and report
22:57 - right here and import something called
23:00 - use wallet from solano wallet adapter
23:03 - react okay use wallet is a hook provided
23:06 - by solana because and what it does is
23:08 - it's gonna get the instance of the
23:10 - wallet that's connected and we can use
23:13 - that object to check different things
23:15 - like is the wallet connected is it not
23:17 - connected and so forth so like i said if
23:20 - we select wallet we connect the wallet i
23:22 - want to be redirected to a payment js so
23:26 - that users can pay and once they pay
23:28 - they're free to use our service whenever
23:29 - they want it sounds pretty cool i'll
23:31 - show you guys how to do that so it's
23:32 - actually pretty simple all i have to do
23:34 - now that you imported that is go ahead
23:37 - and write an if statement right here in
23:39 - line 11 for me and you want to write is
23:41 - if right wallet
23:43 - dot connected okay wallet dot connected
23:47 - is wallet defined right i hope most of
23:49 - you say no as you can see it says wallet
23:51 - undefined right so where do we get the
23:54 - wallet and how do i tell if it's
23:55 - connected like i said this is where the
23:57 - hook comes in so all right actually i
23:59 - move this if statement by the way inside
24:01 - your login button right here so put it
24:03 - in line 17 and what i want to do so that
24:05 - we can make this defined is get the
24:08 - instance of the wallet so we can get
24:09 - that by saying const wallet is equal to
24:14 - use wallet right so now while it exists
24:18 - this is a hook that's checking what
24:19 - wallet is connected and if the
24:21 - wallet.connected is true which means i'm
24:24 - logged in we want to return
24:26 - payment
24:27 - yes the component needs imported of
24:29 - course so let's import payment from
24:31 - payment so let's hit save i'll hit
24:33 - refresh just for and what should happen
24:35 - once i hit this button we should be
24:38 - returning payment you can hook this up
24:40 - to send to you to whatever component you
24:41 - want you can have this to home a
24:43 - different landing page right it's up to
24:45 - you but let's hit phantom type in my
24:47 - password unlock and bam look at that we
24:51 - are now logged in and we are looking at
24:53 - the payment js this is how you set up
24:56 - the rider thanks to quick node and
24:58 - phantom cool so now that's done before i
25:00 - go ahead and write out the payment
25:02 - component and make it all nice and
25:03 - pretty what i want to do next is start
25:05 - writing our solana smart contract if you
25:07 - guys know what a smart contract is go
25:09 - ahead and move on if you guys don't know
25:11 - what i'm saying what is a smart contract
25:13 - let me ask you guys this do you guys
25:14 - know what a regular contract is yes of
25:17 - course you do a smart contract is
25:19 - essentially a programmable agreement
25:21 - that lives on the blockchain so a solana
25:25 - smart contract is usually called a
25:27 - program let me show you guys by showing
25:29 - you the smart contract that we created
25:30 - solana in the last video so what i'm
25:32 - going to do is go to this website called
25:34 - beta.soulpg.io
25:36 - if you guys are coming from solidity
25:38 - this is essentially remix but for solana
25:40 - it will make it easier for you to write
25:42 - the smart contracts all from your
25:43 - browser without any you know tedious
25:46 - installations for your computer
25:48 - right so a lot of playground uses the
25:50 - anchor framework which is a framework of
25:52 - rust just the native coding language to
25:54 - develop on salon okay cool so what does
25:57 - this smart contract do in particular
25:59 - this is the tiktok clone if you see
26:00 - something called pub fn this is no
26:02 - different from a function right you guys
26:04 - are developers you guys know what
26:05 - functions are so what does this function
26:07 - do take a moment to take a look exactly
26:09 - it creates a user right what does this
26:11 - one do it creates a video right what
26:14 - does this one do it creates a comment
26:16 - okay so yeah i'm going to take this time
26:18 - to go on net to go over the anatomy of a
26:20 - smart contract so where can i find the
26:22 - smart contract's name well if i scroll
26:24 - up at the top here you can see that
26:27 - here's the program and again that's what
26:28 - a smart contract is on solana and you're
26:30 - going to see mod tick-tock clone so you
26:32 - can look at this as the name of our
26:35 - smart contract or program i'm gonna
26:37 - start saying now okay cool so when you
26:40 - create a user how does it know what a
26:43 - create user is well if you come down to
26:45 - the below here you're gonna see that
26:47 - something called pub struct right the
26:50 - closest thing i can think of when it's
26:51 - coming from javascript you can think of
26:52 - this as a class and when you make a
26:55 - class which is just a template for
26:57 - creating an object right you're gonna
26:58 - have to define
27:00 - some properties of it right so each
27:02 - create user context is gonna have a user
27:06 - a system program and a clock that might
27:08 - be too much but bear with me let's do
27:10 - something a little bit simpler a user a
27:12 - user on our app what does a user have on
27:15 - tiktok it has a user name right what is
27:19 - another property of a user account it
27:20 - has the wallet address another property
27:22 - of a user account and profile image this
27:24 - is like me writing class user accounts
27:26 - this dot username
27:28 - is a string cool same thing for video so
27:31 - for video account what are some
27:32 - properties of video all right a video is
27:34 - going to need a description or url
27:37 - whoever created it the creator url a
27:39 - comment count all right and another
27:41 - thing you notice with anchor or rust is
27:44 - that we have to define the type right so
27:46 - can you guys tell me what is the type of
27:48 - creator url that's going to be a string
27:50 - so it knows what to expect u64 is an
27:53 - unsigned integer basically numbers that
27:56 - are just positive up to 64 bytes so you
27:58 - can limit how big of a number you're
28:00 - expecting here using u64 okay awesome so
28:03 - there's a lot more little nuances about
28:05 - this but we're going to learn them as we
28:06 - go along so stick with me and we'll make
28:09 - it work so my goal is to completely
28:11 - start over and make a new smart contract
28:15 - so one thing that we can do is clear our
28:17 - cache to get it reset so i went ahead
28:19 - and cleared my cache and now when i hit
28:20 - refresh look how this smart contract all
28:22 - changed so again let's go over the
28:24 - anatomy one more time just to make sure
28:26 - you guys get the idea if you look at
28:28 - line five you see this one one one one
28:29 - one one think of that as the address
28:33 - where your contract lives on the
28:35 - blockchain all right so this is the
28:37 - current address of the
28:39 - default smart contract or program that
28:42 - comes with solano playground so what's
28:44 - the name of this program then hello
28:46 - anchor right cool so what are the
28:48 - functions of this program initialize
28:50 - okay cool so what are the structs
28:53 - there's the initialize struct right
28:55 - there's the new account struct and it
28:56 - just takes in data all right so then
28:58 - this is an even more simplified program
29:00 - so now that you guys understand the
29:02 - anatomy we're going to be building this
29:04 - out and using this as a template to
29:05 - create our spotify smart contract you
29:08 - with me let's get excited let's get to
29:10 - coding okay so now let's set up our
29:12 - solana program all right and before i
29:14 - get started i just want to say big
29:15 - thanks to the solana team and
29:17 - specifically one of the developers for
29:19 - the solano playground his name is
29:20 - acheron he helped me out and i learned a
29:23 - lot about how these smart contracts work
29:26 - from him and the main thing that i want
29:28 - to show you guys is if you look at the
29:29 - top here you're going to see something
29:30 - called use you can think of use as
29:32 - imports all right so here i'm importing
29:35 - anker lang prelude right so there's a
29:37 - couple other imports i'd like to include
29:39 - don't worry too much about what they do
29:40 - because you'll understand as i use them
29:42 - okay awesome so coming over to line
29:45 - eight like i said this is essentially
29:47 - the address where that program lives and
29:49 - when you first start out you're gonna
29:50 - notice that it's one one one one when we
29:52 - build the program it's going to change
29:54 - to the actual address where it lives
29:56 - okay
29:57 - here in line 10 we're defining what is
30:00 - our program what are the contents of it
30:02 - and remember i said that in line 11 this
30:03 - is essentially the name of our program
30:06 - so we can go ahead and change it and say
30:08 - spotify clone so that's just the name of
30:10 - our program i'm going to be using this
30:13 - default or starter contract as the
30:15 - template for creating our own so for you
30:17 - super we're going to need to keep that
30:19 - and if i hit enter here to separate it
30:21 - here is we define all the functions of
30:24 - our program so what can our program do
30:27 - there's two things that our programs are
30:28 - going to do is one it's going to create
30:30 - music and another function is going to
30:32 - be called accept payment right so if you
30:34 - remember the demo the flow is
30:37 - once you connect your solana wallet i
30:39 - want to make sure that the users pay for
30:41 - the service that we're providing which
30:42 - is uploading and hosting songs for them
30:44 - again it's a completely optional feature
30:46 - you don't have to include it if you did
30:48 - want to include a paid service or a way
30:50 - to make users pay for your services this
30:52 - is how you would do it so if this is how
30:54 - you make a function in rust or an anchor
30:57 - all we have to do to make our own
30:58 - function is edit it right for pub
31:01 - function we're going to say accept
31:04 - underscore payment that's the name of
31:07 - this function i want to create so you're
31:09 - going to see parentheses here and it's
31:10 - just the same as any other coding
31:12 - language it's your parameters what does
31:14 - this function take in and when you see
31:16 - ctx colon that's just the type which
31:19 - stands for context when you see data
31:22 - that again stands for what kind of type
31:25 - of data that we're going to see so this
31:26 - is think of this as the parameter ctx
31:29 - data is the parameter and what is the
31:30 - type it's u64 and what is the type
31:33 - context initialize so u64 might make
31:36 - sense to you but you might be like all
31:38 - right what does this mean context
31:39 - initialize right to give you guys some
31:41 - context it's going to be coming from
31:44 - here okay context is essentially just
31:46 - data that we defined throughout the
31:48 - contract so it's going to take in
31:50 - initialize and initialize comes from
31:53 - here we defined it cool so for us
31:55 - if you ask yourself do we want to use
31:57 - initialize to accept our payment you
31:59 - might not know but i'm going to tell you
32:01 - that we're not right what we do need is
32:04 - something called
32:06 - payer context right you might be like oh
32:09 - what the hell is pair contacts well
32:11 - that's because pair context doesn't
32:13 - exist we have to define what pair
32:15 - context is so let's go ahead and do that
32:18 - so hop over to your strokes and again i
32:20 - said structs are like classes in
32:22 - javascript so the first struct that i
32:24 - want to make is going to be this
32:26 - otherwise it's not going to know what
32:27 - pair context is so we're going to say
32:30 - instead of initialize we'll say player
32:33 - context and go ahead and take out these
32:36 - comments but these comments are very
32:37 - helpful to understand what we're doing
32:38 - here one thing to note is that anchor or
32:42 - rust likes to know the exact amount of
32:45 - space that's going into it with
32:47 - javascript it doesn't matter you could
32:49 - put however input size you want into
32:52 - your functions with rust it likes to
32:53 - know the exact what space to expect so
32:56 - here we define a lot of the behaviors of
32:59 - pair contacts is what it's called
33:01 - okay so let's go ahead and remove that
33:05 - and here to get started what we want to
33:07 - do is keep the hashtag account right
33:10 - we're going to just format it because
33:11 - there's a lot of things you want to pass
33:12 - in so we need init that stays we're
33:15 - going to need payer equals not signer
33:19 - but for us it's going to use something
33:20 - called authority which essentially who's
33:22 - paying or the smart contract to exist
33:25 - right okay and then for the space this
33:28 - is going to change as well so for the
33:29 - space like i said we have to define
33:32 - so the size of payer context and what
33:35 - how do we can how can we use sizeof well
33:38 - if you remember we imported it this is
33:40 - how we can use sizeof and just pass in
33:42 - uh contacts in here so sizeof the payer
33:46 - account right i know we didn't see this
33:48 - one either so this is another struct
33:50 - that we're going to have to make right
33:52 - so here's the pair context struct but we
33:54 - also have to define who is the payer
33:56 - account just like with tick tock if you
33:58 - remember we did the
34:00 - create user context and then we also
34:02 - defined who is what is a user so what is
34:05 - a payer whatever the size of pair is
34:07 - plus eight cool so that's going to be
34:10 - the space this is going to be the payer
34:12 - the only other thing we're going to need
34:13 - to do is something called seeds all
34:15 - right so seeds is going to equal and
34:17 - don't to worry about what seeds is
34:20 - exactly seeds essentially generates a
34:22 - unique hash for the payer context and it
34:26 - generates a unique hash by providing it
34:28 - some inputs the best way i can explain
34:30 - it is if you remember dice spare
34:32 - avatars.dice bear
34:34 - how does it generate a unique avatar
34:36 - it's going to make a unique avatar based
34:38 - on what i typed in if i say a that's
34:40 - what comes up s d right if i said lance
34:43 - that's what comes up right it generates
34:45 - a unique image based on what i put in as
34:49 - the seed so here i'm creating a unique
34:51 - hash based on what i put on this array
34:54 - so you don't have to understand what i
34:55 - put in the array just understand what
34:57 - comes out of it so i'm just going to
34:58 - write a couple things b pair
35:02 - dot as underscore ref parentheses comma
35:05 - authority
35:07 - dot key oops dot as
35:10 - ref okay add a comma after surrey and
35:13 - then you want to include something
35:13 - called bump right because i can explain
35:16 - what this is basically if this creates a
35:19 - hash a unique hash and for whatever
35:21 - reason that unique hash already exists
35:23 - bump will increment it by i believe 1
35:25 - through 20 just to get make sure it's
35:27 - very unique okay cool other than that
35:31 - the struct is pretty much set up we just
35:33 - have to define
35:34 - some attributes so it's determined and i
35:37 - basically authenticated the post account
35:39 - so what are the attributes of this
35:40 - you're going to say
35:41 - all right let's put some space around
35:43 - here oh and one thing i forgot to do is
35:44 - close this off so we can close it off by
35:47 - closing the parentheses here and closing
35:50 - the array like that cool so here we
35:52 - provide the properties and the
35:54 - properties that i want to provide
35:56 - is i'm changing the name of this to
35:58 - payer's
35:59 - wallet and it's going to have the value
36:02 - of account info and payer account all
36:05 - right that's the type payer account cool
36:08 - here this is basically a check and we're
36:10 - going to check for a receiver
36:12 - which is going to have our accountant
36:15 - okay the next thing is i want to set up
36:17 - the authority right and again the
36:19 - authority is the signer who paid the
36:21 - transaction fee if you guys are familiar
36:23 - with the blockchain at all anytime you
36:25 - want to store something on the
36:27 - blockchain there is a transaction fee
36:29 - that goes on it who is going to be
36:30 - paying for that that's going to be the
36:32 - authority and for us i'm saying that the
36:35 - authority is the same as the signer
36:37 - right this is
36:39 - signer who paid transaction fee
36:44 - all right who's ever paying so i say pub
36:46 - and then i can say pub authority because
36:48 - that's the that's the name of this
36:50 - property and what it's going to expect
36:52 - is signer info that's pretty we don't
36:55 - need system on this one okay what we are
36:57 - going to need is
36:59 - this account
37:00 - because we want to make sure it's
37:01 - mutable right with rust it's also
37:03 - specific right you have to tell him that
37:05 - hey this authority could change
37:06 - depending on who's using it otherwise
37:08 - it's just going to be
37:10 - constant so i'm letting know that this
37:12 - can change again i'm speaking on a
37:14 - really high level so that you guys who
37:16 - are new to anchor can get started too
37:19 - and eventually you guys are going to be
37:20 - experts as you understand what
37:22 - everything is cool another thing that
37:24 - we're going to have to do is say pub
37:26 - system underscore program and it's going
37:28 - to be the unchecked account and again
37:32 - pass in this info thing here okay next
37:35 - we're going to set up that token program
37:37 - so that library that we imported is
37:39 - going to be used here and if you didn't
37:40 - know spl stands for solana program
37:43 - library it's not a programs library cool
37:46 - so i'm going to set it up we're going to
37:47 - write
37:49 - the account and we're gonna add some
37:50 - constraints here constraint is equal to
37:53 - the token underscore
37:55 - program dot key set it equal to and
37:59 - token id okay now at the top we're going
38:03 - to say pub token underscore program and
38:06 - then write program info comma okay the
38:09 - next property that we're going to need
38:11 - for the pair context is a clock just to
38:14 - save the time so let's say clock to save
38:16 - time right so for this one we'll say pub
38:19 - clock that's the name of it and we're
38:21 - going to use assist bar info all right
38:24 - this is how we get the clock information
38:26 - just say clock all right so that's what
38:28 - you can expect with clock all right this
38:30 - is looking good so far the last thing
38:33 - we're going to need is another struct
38:35 - for payer account basically let's define
38:39 - what the object of a person paying would
38:41 - look like okay awesome so we'll do one
38:43 - more struct before we go back into a
38:46 - nice comfortable familiar front end so
38:48 - coming down over here let's make the
38:51 - like i said the post account structure
38:54 - or define who is the payer account and
38:57 - what are the properties does it have so
38:59 - right now that you guys had the template
39:01 - from before oops so let me just put this
39:03 - back here but now that you guys have the
39:05 - template from before let's try to make
39:07 - this without looking right or using or
39:09 - editing a template so what i want to do
39:11 - is
39:12 - say hashtag right account basically if i
39:16 - write hashtag account and i do obstruct
39:18 - here it's going to inherit all the
39:19 - information of what the account on the
39:22 - contract is then you can say pub struct
39:25 - and say pay your account all right so
39:28 - what is this class what's the name of it
39:30 - all right payer account right so what is
39:33 - the properties of someone that is paying
39:35 - all it's going to do is pub wallet pub
39:39 - key and guess what that's it we define
39:41 - what a pair account is this is all it is
39:43 - okay cool so the real test is when we go
39:46 - to on the sidebar these tools here then
39:48 - we hit build i'm expecting a lot of
39:50 - errors right because you know i haven't
39:52 - checked in a while and rust and anchor
39:55 - is pretty strict so that should be it
39:59 - might be missing a couple things but
40:01 - we're gonna find out now let's hit build
40:03 - ah i got you okay so really quickly one
40:06 - thing i'm realizing before i should have
40:08 - hit build is i made the strokes but i
40:11 - forgot to finish out the function all
40:12 - right so we have all the strokes we need
40:15 - this part should be a lot clearer all
40:17 - right i'm going to replace this
40:18 - with program result it's essentially the
40:22 - same thing as the one i replaced but i'm
40:24 - using program result because i'm
40:25 - importing it anyways and program result
40:27 - is basically defining what comes out of
40:29 - this function all right you could look
40:30 - at it like that okay so from here accept
40:34 - payment right we want users to pay for
40:38 - our services and again you don't have to
40:40 - do that but if you did the first thing
40:41 - we're gonna have to do is let pay your
40:43 - wallet it's just a variable and set it
40:45 - equal to and
40:47 - mute again mute means i'm making
40:50 - whatever i write after this mutable it
40:52 - can change and what's mutable is going
40:54 - to be ctx.accounts.payer
40:57 - underscore wallet okay so the payer
41:00 - wallet is going to be equal to the
41:02 - account the accounts wallet and now that
41:04 - we have the context of what a payer
41:06 - wallet is if i were to write something
41:08 - like payer underscore wallet dot wallet
41:12 - right where is dot wallet coming from
41:14 - well what other class has a wallet
41:16 - attribute it's the payer account so
41:18 - that's why we set up the struct we're
41:20 - going to set equal to
41:22 - the ctx dot accounts
41:24 - dot authority
41:26 - dot key i'm basically saying that this
41:29 - is going to be the value of this payer
41:32 - account at this key of the wallet okay
41:35 - so the wallet should be this are you
41:37 - following so far another thing that i
41:39 - want to mention is
41:40 - you know we're privileged with
41:41 - javascript and like other coding
41:43 - languages with rust and anchor you're
41:46 - gonna have to put a semicolon at the end
41:47 - of the line otherwise it's gonna yell at
41:48 - you and say hey is this the end of this
41:50 - line all right so put semicolons that's
41:53 - something i definitely forgot often
41:55 - after we do that we can make another
41:56 - variable called ix and set this equal to
42:00 - anchor underscore lane colon colon
42:03 - solana underscore program one colon
42:06 - system instruction right
42:10 - again if this is really hard for you
42:11 - guys to follow be on the lookout for a
42:14 - full guide on solana and rust it's a
42:16 - tutorial that we've been working on and
42:19 - it's going to explain a lot of these
42:20 - things more more in depth but for now
42:22 - it's going to be at a high level okay
42:24 - after that we're going to do and ctx dot
42:27 - accounts
42:28 - dot authority
42:31 - dot key and then for there we can say
42:33 - and ctx dot accounts dot receiver dot
42:37 - key basically i'm defining how much
42:39 - they're paying and don't be alarmed by
42:41 - this number i'm gonna put here but this
42:44 - equates to
42:45 - 0.01 salon which is not a lot especially
42:48 - or since we're on the devnet okay cool
42:50 - after that's done semicolon right there
42:52 - then we can say anchor underscore lang
42:55 - calling solana underscore program and
42:57 - then invoke so we're going to invoke the
43:00 - ix that we defined so we say ix and then
43:02 - comma here then say and array all right
43:05 - and pass in this array the authority and
43:08 - the receiver once again so our accounts
43:10 - basically set up who's paying the 0.01
43:13 - solana and where is that 0.01 salon
43:16 - going to that's what we're doing dot to
43:18 - account underscore info yes sir cool
43:22 - then
43:23 - ctx.accounts.receiver there it is dot
43:26 - two underscore account underscore info
43:28 - there it is okay cool so closing array
43:31 - closing parenthesis and closing curly
43:33 - bracket okay
43:35 - all right so again i saw a bunch of
43:36 - errors here i didn't really take a look
43:37 - at it but let's hit build okay so again
43:40 - since this is cache if i hit refresh we
43:43 - still should have everything i created
43:44 - up there's the ix and all my structs now
43:47 - let's hit build now let's tr now let's
43:49 - spend some time troubleshooting all
43:51 - these areas all right we got a whole
43:54 - bunch amazing okay so the first one i'm
43:56 - seeing is line 53 ah it's because it
43:59 - should be
44:00 - the comma instead of the quotes so i
44:03 - think that's a couple of them right
44:04 - there so line 53 should be the quote not
44:06 - the backtick okay same thing on line 60.
44:10 - yep quote not the backtick and that's
44:12 - probably causing issues everywhere else
44:14 - so that should be all the info stuff let
44:16 - me refresh to clear it up because it's
44:18 - hard to read in my opinion okay cool
44:21 - line 53 again this should have a comma
44:24 - line 63 is that right all right so line
44:27 - 53 it should end with the comma all
44:28 - these should have a comma at the end of
44:30 - each one i'm gonna put this one on there
44:32 - just in case refresh comma a lot of
44:34 - these might be typos as well line 65
44:37 - oh yeah i put column by mistake 40 we
44:41 - need a comma after bump and line 40 and
44:43 - this one also needs a comma after bump
44:45 - on line 56 i put
44:47 - contraint but it should be
44:50 - constrained again what i do is i look
44:53 - for compiling because that's the latest
44:54 - one anchor land should be anchored
44:58 - laying this function takes three
45:00 - arguments but two were supplied
45:02 - line 18. see what i'm missing something
45:04 - oh i see comma all right this is why
45:07 - commas are important uh yes
45:08 - significantly less errors no field
45:11 - account in line 27
45:14 - yep it's going to be context accounts
45:16 - cannot be dereferenced
45:19 - okay i'll just try this one cannot add
45:21 - integer to fn line 41. yep pair count
45:25 - should be parentheses here cool i'll
45:28 - build it but now that we have a lot less
45:30 - errors i feel comfortable refreshing it
45:32 - and then building it just should be the
45:33 - one or the two oh what the hell i
45:35 - thought i fixed this there you go let's
45:37 - try building now nice so it's just the
45:39 - one account info cannot be dereferenced
45:42 - okay so i think i got it it was just a
45:45 - typo around here just make sure
45:47 - everything is spelled correctly
45:48 - cool so if you want to take a moment
45:50 - double check what i have make sure it's
45:52 - all spelled the same maybe if i zoom in
45:54 - yep okay how is that cool so let's uh
45:57 - double check if we get any more errors
46:00 - okay cool we can live with the warnings
46:02 - that's fine as long as there are no
46:04 - errors right as long as there are no
46:06 - errors we can go ahead and build so
46:09 - since there was no errors look at this
46:11 - it generated a new program id for us and
46:15 - once it did that all right we're good to
46:16 - go all you have to do now is connect to
46:19 - playground wallet again save the key
46:21 - pair just in case for later okay and
46:23 - what we want to do next is
46:25 - deploy and again once we deploy it's
46:28 - gonna go straight into and live on the
46:30 - solana smart contract solana blockchain
46:32 - officially and the cool thing about
46:34 - salon programs unlike any other chain is
46:36 - that we can actually upgrade the
46:38 - contract all right with solidity once
46:41 - it's on there you're going to have to
46:42 - make a whole new contract with a whole
46:44 - new address just to make some changes
46:46 - but luckily with solana we can upgrade
46:48 - them so i'm going to go ahead and hit
46:50 - deploy let's just open up terminal uh
46:52 - okay cool so this is good to know our
46:54 - smart contract at the moment is going to
46:56 - cost 5.13 sol to deploy onto the chain
46:59 - and store it and only have two solana
47:02 - right so you can see the current balance
47:04 - here and this is the wallet of the salon
47:06 - playground that comes with it so a cool
47:08 - thing i want to show you is if you want
47:10 - more solana for this wallet we can go
47:13 - ahead and click this click this three
47:16 - dots and click airdrop so it's sending a
47:19 - airdrop request and guess what we got
47:20 - two solana
47:22 - right here okay remember this is gonna
47:24 - take five solana so we're gonna have to
47:26 - do that one more time okay for some
47:29 - reason that didn't go through so i'm
47:30 - just gonna try one more time hey there
47:32 - we go now we got six salon you might
47:33 - want to do this a couple of times so you
47:35 - won't have to do it later especially if
47:37 - we're going to be redeploying so good
47:38 - luck i'll do it one more time cool we
47:41 - got tencel now we can go ahead and we're
47:44 - ready to deploy it and again i want to
47:45 - be concerned about deploying it because
47:47 - we can always upgrade it later which we
47:49 - will there's one more function and a
47:50 - couple then i think one more struck that
47:52 - i want to write to completely finish out
47:55 - this program cool the deployment's
47:57 - successful and all we're going to need
47:59 - to do is go over to this idl and hit
48:02 - export all right so it says idl 6 but
48:04 - that's because i have a bunch of ideas
48:06 - from our last build i just know that
48:08 - idl6 is the one i want and what you can
48:10 - do is click on it and it should open up
48:13 - vs code for you this steps pretty
48:15 - important because we want to save this
48:17 - idl because this is what helps us
48:20 - use the functions from the smart
48:22 - contract and essentially connect it with
48:23 - our front end so after you click it it
48:26 - should open up in vs code i'm going to
48:28 - hit control a or i'll see alt z all
48:30 - right this is all of it you can see that
48:32 - it has the function accept payment and
48:34 - all the strokes that we created go ahead
48:36 - and press control a then control
48:39 - c or if you make it feel better control
48:41 - x because we don't need this anymore all
48:43 - right i'll say control c and what i want
48:45 - to do is open up our folder and we need
48:47 - to save this in our
48:49 - or rather yeah our utils so going into
48:51 - utils i'm going to make a new file i'm
48:54 - going to call it spotify.json
48:57 - and in the spotify.json paste all that
49:00 - information save
49:01 - let's see cool it should be the same
49:03 - thing all of the functions and the
49:04 - structs and once that's done in our
49:06 - const what we're going to need to do
49:08 - make this a lot bigger remember how we
49:10 - import a public key we're going to need
49:11 - to use it but first we need to import
49:14 - spotify
49:15 - from
49:16 - the json so there's the we're importing
49:18 - the idl here as spotify and then here we
49:21 - want to say export cons
49:23 - stable
49:24 - pool
49:25 - program id is equal to new public key
49:30 - and what i want to store here is the
49:32 - address of our program so remember what
49:34 - our address of the program is yep
49:36 - exactly this is the address of our
49:38 - program so go ahead and copy that that's
49:41 - not going to change after we deploy it
49:43 - so i'll just hit paste and then from
49:45 - there the last step we can say export
49:47 - const oops export const stable
49:51 - underscore pool underscore idl is equal
49:53 - to
49:54 - spotify there we go so just like solano
49:57 - host holds our endpoint from quick node
50:00 - stable pool program id holds the address
50:03 - stable pool idle holds the idl cool so
50:06 - that's going to come into play later so
50:07 - remember this and after that our smart
50:10 - contract is pretty much set up so give
50:11 - yourself a pattern back if you were
50:13 - following along i know this is hard but
50:15 - we're gonna get through it and i hope
50:16 - you're learning something with me all
50:18 - right guys so i switched to a different
50:19 - setup as you can see but i want you guys
50:21 - to take a look everything is still the
50:22 - same if you take a look let me zoom in
50:24 - this is the same contract address as we
50:26 - had previously but since i've switched
50:28 - to a different desktop i want to show
50:30 - you guys how to redeploy your contract
50:33 - and the best way to do this is let's
50:34 - make a change so
50:36 - taking a look at this i'm realizing we
50:38 - don't need two parameters for this what
50:39 - i'm going to do is erase in line 14 the
50:42 - one that says data64 so it should just
50:44 - say this and then what we do from here
50:46 - is build so if this is the current
50:49 - address
50:50 - and i made a change let's see what
50:51 - happens when i hit build cool so this it
50:53 - becomes this address right so this is
50:56 - the new
50:58 - program id that comes with the cool
51:00 - thing about this is that you don't have
51:02 - to redeploy every time what we could do
51:04 - is hit upgrade and we keep the same
51:06 - address and then right you can just keep
51:09 - making changes to your contract that's
51:11 - actually unique to solana you can't
51:12 - really change your contract and solidity
51:14 - once it's up there or at least not yet
51:16 - so
51:17 - what happened is i took out this
51:19 - parameter because it's no longer needed
51:21 - and as you can see when we hit build
51:23 - there's no warnings right because i took
51:25 - out that uh parameter that we didn't
51:27 - need it just says finished right from
51:29 - here we want to hit upgrade right when
51:31 - you hit upgrade it's going to cost the
51:34 - amount of the contract and i remember if
51:35 - i remember correctly this one cost five
51:37 - sold i have six so it should be enough
51:39 - to deploy perfect okay and again every
51:42 - time you deploy or upgrade your smart
51:44 - contract you can verify it with soul
51:46 - scan or solana explorer we'll click soul
51:49 - scan all right you can see this is like
51:51 - a proof of the transaction and proof
51:54 - that it was successful that we deployed
51:55 - something anytime you put something on
51:57 - the blockchain you're gonna need to pay
51:59 - some best fees to verify the transaction
52:01 - or write to the blockchain
52:03 - okay awesome so we have our new updated
52:06 - contract and remember the step that i
52:07 - told you we're going to need to go to
52:09 - the extras here click idl and click
52:12 - export right and once you click export
52:14 - click on the json file and should lead
52:16 - you here and when i press alt z it's
52:18 - going to wrap the text so you can see it
52:20 - a lot better but notice how it has the
52:22 - function name and all the structs that
52:24 - we created so later when we add more
52:26 - functions double check that your idl
52:28 - includes the new function so as right
52:30 - now we should only have one accept
52:31 - payment which we're going to hook up to
52:33 - our front end now so go ahead highlight
52:35 - everything hit copy all right and what
52:37 - you want to do is if you remember go to
52:39 - your spotify.json
52:41 - and if you don't see again or i mean
52:43 - control
52:45 - b i paste that in there and then do alt
52:48 - right it should look exactly the same as
52:49 - this cool so we're all set we can go
52:52 - ahead x the idl hit save and now it's
52:55 - update but now we have to update our
52:57 - front end so if you remember
52:59 - go to your cons this was the old program
53:02 - id so what's our new program id guys
53:05 - exactly it's this one right here so we
53:07 - can just easily copy this and paste it
53:10 - right over here okay hit save so that's
53:13 - some bug fix we just did some bug fixes
53:15 - over here with this function as well i
53:17 - showed you guys how to redeploy and
53:19 - update your cons js sounds good cool so
53:22 - let's get to the functionality of this
53:24 - okay cool so with our smart contract
53:26 - pretty much done what i want to start
53:28 - thinking about is how can we from our
53:30 - front end call this program so we're
53:33 - going to have to do is first of all open
53:36 - up localhost okay cool we're connected
53:38 - still because we're still i'm still
53:39 - logged on with my phantom wallet and we
53:41 - can go ahead and put it on the side and
53:43 - split screen and let's just make some
53:46 - space here i always do like two thirds
53:48 - one third boom all right this is good
53:50 - enough for me so just to recap we want
53:53 - to make the payment js right i want to
53:55 - show you guys how to make your service
53:58 - payable right so if you want to make it
54:00 - to like with spotify you have to pay to
54:02 - subscribe this is some way a form of
54:03 - that again it's an optional step but
54:06 - something good to learn just for you so
54:08 - to get started hop over to your
54:10 - payment.js and let's get to styling and
54:14 - i know i went to payment but one thing
54:15 - that we're going to have to do is set up
54:17 - our program instance and program
54:20 - instance is going to live under utils
54:23 - right so if you go into your utils
54:24 - folder click new file and i'm just going
54:26 - to make a utils.js
54:29 - this is going to hold the anchor client
54:31 - which is going to grab the program
54:33 - instance okay and now that we're in
54:35 - utils all we're going to need to do is
54:37 - import a couple of things we're gonna
54:38 - import
54:39 - star
54:40 - from our star as anchor so any time we
54:43 - say anchor we're getting everything from
54:45 - the anchor project serum which is
54:47 - essentially the project itself the
54:49 - anchor project we also need to import
54:51 - something called
54:53 - wallet
54:54 - not connected error right and this is
54:56 - coming from solana wallet adapter base
54:59 - okay and then we're also going to import
55:02 - the idl and the program id so where is
55:05 - our idl and program id being stored
55:08 - exactly it's going to be stable pool idl
55:11 - and stable underscore pool underscore
55:14 - program underscore id and this is coming
55:17 - from our cons folder which is within the
55:20 - utils folder cool so that should be it
55:22 - for now don't worry if it doesn't make
55:23 - sense yet once i start plugging it in it
55:25 - should start to make sense to you guys
55:26 - so let's set up our program instance
55:29 - let's say get program instance okay
55:32 - and it's going to be a function and make
55:34 - sure you add this export here and within
55:36 - get program instance we're going to
55:38 - write something called if wallet
55:40 - dot oops if not wallet let's try this
55:43 - again if uh exclamation point which
55:45 - means not wallet dot public
55:49 - key okay
55:50 - and this not basically means if wallet
55:53 - public key doesn't exist what do we want
55:55 - to do we want to throw new wallet not
55:59 - connected error right so if there's no
56:00 - public key show this error yeah is that
56:03 - making sense so far cool then you're
56:04 - probably going to wonder where is wallet
56:05 - coming from the skip program instance is
56:08 - going to expect a connection as a
56:10 - parameter and we're going to also pass
56:11 - in a wallet whatever while it's logged
56:13 - in and we'll be using phantom cool but
56:15 - if there is no wallet public key then
56:17 - throw the wallet not connected error
56:18 - okay that's just our edge case from here
56:21 - let's set up a provider and the provider
56:24 - is going to take in oops it's going to
56:26 - be equal to new
56:28 - anchor a new instance of anchor.provider
56:31 - which makes sense then we're going to
56:32 - put parentheses here and it's going to
56:34 - take in the connection that we passed in
56:37 - so it's going to take in the wallet that
56:38 - we passed in and it's also going to take
56:41 - in anchor dot provider
56:45 - dot default all right you saw it for a
56:48 - second it's a method default option okay
56:50 - that's what the provider is going to
56:52 - take right in this variable we hold this
56:54 - instance with all this information we
56:56 - pass in so after the provider we should
56:58 - also make a variable for the idl what
57:00 - variable holds the idl stable pool ideal
57:03 - okay now we need the address so i'll say
57:05 - cons program id right how do i get the
57:08 - id it's going to be in this variable
57:12 - okay and we also updated it if you
57:13 - remember it's now this instead of the e
57:16 - one okay from there well we can get the
57:18 - const program generate the program
57:21 - client from the ideal so we can do that
57:23 - by saying new anchor dot program and
57:26 - guess what we'll pass in all the
57:27 - variables that we set up so to make a
57:30 - new anchor
57:31 - program a new program client we're gonna
57:33 - need to pass in the idl the program
57:36 - id and the provider so that's the reason
57:39 - we set it up afterwards we can just
57:41 - return program
57:42 - and guess what we're good to go so hit
57:45 - save on utils and that should be good
57:48 - amazing so after utils is set up i feel
57:51 - comfortable going back to payment now
57:53 - and with payment i'm just going to set
57:54 - up the imports and then we're going to
57:56 - explain it later so with the new version
57:58 - of react we actually don't need import
57:59 - react from react sometimes i keep it
58:01 - sometimes i don't depending on how i
58:02 - feel all right so we'll just need use
58:04 - effect and use state all right the two
58:07 - most common hooks and this is going to
58:09 - be coming from of course react so
58:11 - afterwards we're going to do is in utils
58:14 - we exported the function and get program
58:16 - instance because i want to be able to
58:19 - import it right here so let's get
58:21 - program instance from utils okay and
58:24 - then from there we can say import
58:26 - token
58:27 - program id and this is going to come
58:29 - from solana spl token and if you didn't
58:32 - know spl stands for solana programs
58:34 - library and we're getting the token
58:35 - program menu from there okay afterwards
58:38 - let's also get the solana host from our
58:41 - const if you ask you guys what is the
58:43 - solana host what do you can you tell me
58:45 - exactly it is our endpoints that we're
58:47 - using quick note for exactly it's going
58:49 - to connect us to the blockchain so
58:51 - that's what solana host is and we're
58:53 - going to be using it later another thing
58:54 - i want to do is use this custom hook
58:56 - called use wallet that comes from the
58:58 - solana wallet adapter basically this is
59:00 - going to hold the instance of the wallet
59:03 - that is connected
59:04 - with payment yeah okay let's see is
59:07 - there anything else uh that should be it
59:08 - for now what i want to do next is set up
59:12 - a couple variables that we're going to
59:13 - be using in our functions later on so
59:15 - i'm just going to say const anchor is
59:17 - equal to require right and this is where
59:20 - we'll grab the anchor project from
59:22 - github so it's project
59:25 - c
59:26 - slash
59:27 - anchor
59:29 - okay cool so we grabbed anchor it's held
59:31 - in the variable and now i want to
59:33 - destructure a couple things from anchor
59:35 - okay what i want to destructure from
59:36 - anchor is web3 so to destructure an
59:39 - object you're going to say const object
59:42 - empty object equals anchor and then you
59:44 - say what do you want from this object i
59:47 - want web 3 right you're going to see us
59:50 - later make custom hooks and this is how
59:52 - we would make them so use effect and use
59:54 - state is something that we're getting
59:55 - from the react library or react object
59:57 - so this is all destructure okay so we're
59:59 - just structuring web3 from anchor all
60:02 - right guess what if i write something
60:04 - like this what could you say is
60:06 - happening on this line right we're
60:07 - destructuring something from web3 so
60:10 - what do we want from web3 i want system
60:14 - program from web3 right if you're
60:16 - wondering how do i know what's in web3
60:18 - what you could do is console log it i
60:19 - kind of cheated i went ahead of you guys
60:21 - and you could console.log anchor and
60:23 - then you could find a web3 key and then
60:25 - pull from there and then you can get
60:27 - system program from there from web3 okay
60:29 - cool another thing that we're going to
60:30 - need is cons utf-8
60:33 - is equal to anchor dot utilities utils
60:38 - bytes dot
60:39 - utf-8 okay cool one more thing we're
60:43 - going to need something called the
60:44 - default account and if you watch the
60:46 - tick tock video you're going to know
60:48 - that this is something that we had to
60:49 - write a couple times so we're going to
60:51 - write the token program it's an object
60:53 - right and it's going to take in a couple
60:55 - keys the first one is going to be called
60:56 - token program and the value of this is
60:59 - exactly what it sounds like so what does
61:01 - any of our imports hold the token
61:04 - program i think so so that's what we
61:06 - want to put here we're going to say
61:07 - token underscore program underscore id
61:10 - right from here put a comma then you can
61:12 - write clock and then you can say anchor
61:14 - dot web 3 dot
61:17 - sis
61:18 - bar club publicly right this is a key
61:20 - called clock and this is how we get the
61:22 - actual clock from anchor
61:24 - okay from there what i want to do is
61:27 - write system
61:28 - program system program and the value of
61:32 - that key will be
61:34 - this right here which we destruction
61:36 - from web3 so we write system program and
61:38 - that's not it all right we're going to
61:40 - use dot notation to get dot program id
61:43 - awesome so those are all the variables
61:45 - for now all right what i want to do next
61:48 - is set up the
61:50 - states for our payment function all
61:53 - right after that then we can do some
61:55 - nice comfortable front end all right for
61:57 - the states the first thing i want to do
61:59 - is you const wallet is equal to use
62:02 - wallet remember how i said this hook
62:04 - right here is going to grab the instance
62:06 - of the wallet that is connected we're
62:07 - going to store that in a variable so
62:09 - anytime i say wallet think of uh what
62:11 - wall that is connected well so after
62:14 - that we're going to have a variable
62:15 - called connection right so if you
62:17 - remember get program instance what are
62:19 - the two parameters that is that it is
62:21 - expecting a wallet and a connection all
62:24 - right so we're gonna have a variable
62:26 - called connection right and it's gonna
62:28 - be new anchor dot web3 dot connection
62:33 - and what holds the endpoint or our
62:36 - connection to the blockchain drum roll
62:37 - it's going to be solana host exactly
62:40 - that's why i asked you at the beginning
62:41 - salana host thanks to quick note we have
62:44 - our endpoint okay so solana host is for
62:48 - ready for our connection let's write
62:50 - kant's program so how do we get the
62:52 - program then we have a function that
62:54 - does that so let's say get program equal
62:56 - to get program instance and again the
62:59 - two parameters that it's expecting is
63:01 - connection and the wallet alright so i
63:03 - hope it all came together in that moment
63:05 - right if not we're gonna keep it going
63:07 - as i'm building along it should start to
63:08 - make sense if it's still not making
63:10 - sense after that i would suggest like
63:12 - console logging different things and
63:14 - testing it that's how anyone really can
63:16 - learn you just gotta use it a lot and
63:18 - make your own builds you don't have to
63:20 - copy this one exactly right you can make
63:22 - your own projects with what you know
63:23 - from here now for that after all those
63:25 - variables are set up we can set up a
63:27 - couple states so equal so if you
63:30 - remember use state essentially data that
63:32 - can be changed and again this is
63:35 - destructuring but for an array okay
63:37 - because use date returns an array with
63:38 - two things all right the first one is
63:40 - going to be undefined usually until i
63:42 - define it but the variable name is going
63:44 - to be called payers and then set payers
63:47 - what i want to do with this use date is
63:49 - keep track of every single person that
63:52 - pays for our program because if you paid
63:54 - for spotify i'm not going to ask you to
63:55 - pay again so i want to store all the
63:57 - payers in the array the set payers
64:00 - function is going to set literally set
64:03 - the players or update the payers right
64:06 - so say like later on i don't know
64:07 - someone named kevin it pays for spotify
64:10 - i want to update the array to say hey
64:11 - kevin's part of the array now so that's
64:13 - what this function is for what you put
64:14 - in here is what do you want the array to
64:16 - start out as and it's usually the same
64:18 - type that you're expecting so if i'm
64:20 - expecting an array how should it start
64:21 - well it should start empty so the first
64:24 - when i first console log pairs it will
64:25 - be an empty array until i use set pairs
64:28 - to update that so i hope that made sense
64:31 - to you that's just basic react hooks on
64:33 - use state so if you understand that
64:35 - we'll make another state variable here
64:38 - this one is going to be called is paid
64:40 - and set paid so the idea with this state
64:43 - is if
64:45 - you are in the array i want to
64:47 - eventually loop through it or iterate
64:48 - through it and check if you're in the
64:50 - array so i imagine you're logged in over
64:52 - here and there's going to be a function
64:55 - that's going to get all the payers or
64:56 - all the wallets that are paid and if
65:00 - i see your name inside the array then
65:03 - i'm going to make a state that is
65:04 - essentially a toggle that says okay he's
65:06 - good to go is paid is true right
65:08 - but by default like i said i'm going to
65:10 - assume that you didn't pay until i check
65:12 - it then i'll switch it right that's the
65:13 - logic that i want to handle here so
65:15 - those are the states all right we're
65:17 - going to take a break from all the
65:18 - variables and i think let's make the jsx
65:21 - of payment which is not too much okay
65:23 - so to make the jsx of payment we're
65:26 - going to need to make the style object
65:28 - at the top so say con styles is equal to
65:30 - object right so we won't get the error
65:32 - and you can see me edit this live right
65:34 - so we can sue div all right let's clean
65:36 - this up and give this a class name and
65:39 - the class name of this will be
65:40 - styles.main
65:42 - awesome so inside the main div we're
65:44 - going to have another p tag actually
65:47 - with a class name equal to styles.txt
65:51 - and inside the p tag instead of saying
65:53 - payment i want to start saying make
65:55 - payment did it update hey there we go
65:58 - that looks a lot better okay so as a
66:00 - sibling in the next line we're going to
66:01 - say div and this is going to be class
66:03 - name
66:04 - styles
66:06 - dot button or button this is going to
66:08 - container for the two buttons that i'm
66:10 - planning the first button on the left is
66:12 - going to be the make a payment button
66:14 - right make payment here on the right i
66:16 - want to do a verify paid or refresh who
66:20 - paid so this is the container for so
66:23 - inside this div right i'm going to hit
66:25 - enter and then line 35 i'm going to
66:27 - write okay and inside that button we're
66:30 - going to say pay zero point
66:33 - zero point one sold which is not a lot
66:36 - right i wanna make it cheap just for
66:38 - testing purposes you can make this any
66:40 - price and if you're wondering how you
66:42 - can make it any price you go back to
66:43 - solana playground and you go to let me
66:46 - make this a little bit bigger and you go
66:48 - to
66:48 - accept payment right this is where we
66:50 - define that price this equates to 0.1
66:54 - sold if you want to make it bigger you
66:55 - just have to increase the size okay so
66:58 - users to use our service they just have
67:00 - to make a one-time payment of 0.1 sold
67:02 - and again if you're like i don't want
67:04 - people to pay you don't have to include
67:05 - this step cool so pay 0.1 so
67:09 - next we want to do a button and inside
67:12 - that button we're going to do class name
67:14 - is equal to styles dot button right
67:17 - ideally this should also be over here so
67:19 - let me put in the other button class
67:21 - name
67:21 - styles dot button okay so we have a
67:24 - class named buttons and a styles number
67:27 - and this one is going to say verify
67:31 - payment right because once you pay
67:33 - you're gonna i want you guys to want to
67:35 - be able to click this button to
67:37 - essentially
67:38 - make it
67:39 - make the page
67:40 - go through the array and check if it
67:43 - went through so that's what the verify
67:44 - payment is for cool guess what that's it
67:47 - for the jsx all right so if it's saved
67:49 - boom
67:50 - again this is it for the ui but once i
67:52 - have the styling it'll look a lot better
67:54 - so hop over to your con styles object
67:57 - and in line 19 for me we can start
67:59 - writing it out so let me start with the
68:02 - main
68:03 - styling is going to be with
68:05 - screen h screen so i wanted to make sure
68:08 - it takes up the whole width and height
68:10 - of the screen and from there let's make
68:12 - the background white because i don't
68:13 - want this background because this is
68:15 - what it's the background for when you're
68:17 - logged in like the home page okay and
68:19 - now we lost the text but we can easily
68:21 - get it back by say text black all right
68:23 - we're back in business right from here i
68:26 - want to put everything in the center
68:28 - instead of this top left corner which it
68:30 - happens by default so you want to say
68:31 - display flex or entail when you just
68:34 - write flex cool all right disappeared
68:36 - for some reason oh i put a comma here
68:38 - okay now i hit save uh and then it's
68:40 - asking me to log back in no worries cool
68:42 - so now it puts everything in a row but
68:44 - if i change the flex direction to column
68:48 - right now it's back to normal but we
68:49 - still have the ability to move it around
68:51 - with flexbox
68:52 - so if i say justify center it should
68:55 - center these things horizontally since
68:57 - we're in column
68:59 - i mean vertically and then to center it
69:00 - horizontally we're going to do items
69:04 - there we go so now i got it perfectly in
69:05 - the middle just like how i wanted so i'm
69:07 - doing alt c here so you can see the
69:08 - whole css in case i'm going too fast and
69:11 - after we do the main we can style the
69:14 - individual buttons so i want these
69:16 - buttons to look just like the colors of
69:17 - spotify so i'll make it round and the
69:19 - same colors so what i'll write is bg of
69:22 - the back of the button it's going to be
69:24 - hashtag 2 2
69:27 - c
69:28 - 5 5 e so let's save hey there you go
69:31 - that's the color
69:32 - but we also want to form a header right
69:34 - so let's go over in m3 all right so
69:36 - there you go some spacing and now keep
69:39 - putting comma we'll do a text white
69:42 - because we should be able to see it now
69:43 - that it has that background color i want
69:45 - to make sure the font is bold okay and
69:48 - if we do a py-four
69:51 - nice and then a px-7
69:55 - cool so i'm feeling that size i think
69:56 - it's pretty good and i want the buttons
69:58 - to be rounded so i'll say rounded full
70:00 - and we can do a hover effect you can do
70:02 - like a opacity every time i hover if i
70:05 - do opacity dash 70 then when i
70:08 - transition
70:10 - hey okay i like this a lot okay and you
70:13 - can see it's kind of off center but once
70:15 - i style the buttons div it should look a
70:18 - lot better all right for now i'm going
70:19 - to work on the text though so for the
70:21 - text i want to make it a little bit
70:22 - bigger so let's do a text dash for
70:25 - excel
70:26 - right there it is and then again we can
70:29 - write mb-10 there you go and for here
70:33 - now we can talk about buttons and to fix
70:36 - it we can say flex and items center
70:39 - actually looks a lot better it doesn't
70:40 - look as off-center as i thought it was
70:42 - okay but that is the front end of the
70:45 - payment js okay
70:47 - with that done let's work on the
70:49 - functionality so again if you see this
70:50 - button it should be pretty obvious what
70:52 - this should do right we should be our
70:54 - wallet should come up and we should pay
70:57 - 0.1 sold right to whoever's getting the
71:00 - payment right and that function is
71:03 - something that we're going to call from
71:04 - our smart contract that's what accept
71:07 - payment is right so in this section i'm
71:09 - going to show you guys how can we call
71:12 - the smart con the solana smart contract
71:14 - from our front end cool so we're going
71:17 - to want to do first is come to
71:20 - come right over here in line 33 for me
71:22 - and let's set up a function i want to
71:25 - call it const pay okay const pig const
71:28 - pay click is a function that's going to
71:31 - call
71:32 - this function right on the on the
71:33 - blockchain okay so
71:35 - whenever we're making calls to somewhere
71:37 - else that's not local to us we usually
71:40 - make it asynchronous because we want to
71:42 - be able to wait till that it that it's
71:44 - called then we can run the next thing
71:46 - otherwise that could lead to some
71:47 - problem so pay click is an asynchronous
71:50 - function all right so one of the setups
71:52 - that we're going to have to do is do
71:53 - something called let the payer signer
71:56 - right equal to
71:58 - await anchor dot web3
72:01 - dot public key capital
72:04 - dot find program address
72:07 - okay
72:08 - so it's a method called find program
72:10 - address which is going to look for the
72:12 - program id so it's going to we're going
72:13 - to pass in a couple of things first
72:15 - thing is hit enter here enter here boom
72:18 - first thing that we want to pass in is
72:20 - utf-8
72:22 - encode
72:24 - who the pair is right and we also want
72:27 - the wallet dot public key the public key
72:30 - of the wallet and to buffer is
72:32 - essentially a way to convert the public
72:34 - key to what we need and after that array
72:37 - hit comma and here we can say program
72:40 - dot program id all right if you remember
72:42 - where is program coming from it's coming
72:45 - from our instance and in that object we
72:47 - can get the program id awesome okay from
72:50 - there
72:51 - let's set up a variable we can say let
72:54 - pair and set up something called a try
72:57 - catch block right so try catch block is
73:00 - pretty self-explanatory in my opinion
73:02 - essentially you want it's going to try
73:04 - whatever functions in here and if that
73:06 - promise fails it's going to end up in
73:08 - the catch right and we're going to put e
73:11 - here sometimes people write error which
73:13 - you could write is console.log error or
73:16 - you can give it an alert that says
73:18 - right you know promise failed promise
73:21 - all right you can make this whatever you
73:22 - want right but for the first try catch
73:24 - we don't need to write anything in there
73:27 - okay but with this try catch we're gonna
73:29 - say pair info is equal to await dot
73:33 - weights program dot account dot payer
73:36 - account right so we're getting the payer
73:38 - account it looks like and then we're
73:39 - gonna fetch the signer right so fetch
73:42 - the signer okay and that's it for the
73:44 - try block so from there in the catch
73:46 - what we want to write is another nested
73:49 - try catch okay so carry catch is going
73:52 - to take in e again and this time we'll
73:54 - alert right whatever the error is so e
73:58 - dot message right sometimes it says like
73:59 - a pair wallet is not provided or it'll
74:02 - tell you
74:03 - that you know you wrote something wrong
74:04 - or something's undefined that's what the
74:06 - couch is going to say it's going to give
74:07 - it to us in an alert so it's really
74:09 - obvious cool the fun part is in this try
74:12 - catch this nested try all right so once
74:14 - we got the pair info all right we want
74:16 - to use that when we call the function
74:18 - right because what does our accept
74:21 - payment parameter take in and we fixed
74:24 - it right it's just going to take in one
74:26 - parameter and it should be the
74:28 - context of the pair right it's kind of
74:31 - hard to see because of the way it's
74:32 - formatted but that's okay so in the try
74:34 - block let's write a weight oops sweater
74:37 - weight program dot rpc and then what's
74:41 - the name of our function
74:42 - accept payment that's the name of our
74:45 - function on the program
74:47 - and put parentheses here and then object
74:50 - right because this is
74:51 - the payer account that we are passing in
74:54 - this is the parameter right the context
74:57 - so
74:57 - if if we know it's going to be the pair
74:59 - account we're going to write accounts
75:00 - here and we'll switch to this one
75:02 - and it's kind of small i'm going to say
75:04 - counts
75:05 - right because this is an object it's a
75:06 - key called accounts which is going to be
75:08 - another object and this is where the
75:11 - content is important so we got to
75:12 - establish who the pair wallet is and the
75:14 - pair wallet is
75:16 - the payer signer so we'll say payer
75:19 - signer and then for the receiver and who
75:21 - is receiving it right you can say new
75:24 - public key and essentially you could set
75:26 - up what wallet is going to receive the
75:28 - 0.1 so it doesn't really matter who it
75:31 - is you can kind of pick what wallet you
75:32 - want so for me i have an extra wallet if
75:35 - you want to know how to make another
75:36 - wallet you can click this plus add
75:38 - connect wallet create new one and bam
75:39 - you have another wallet that you can put
75:41 - so i have this third one i'll say
75:42 - collection i'll copy the address by
75:44 - clicking the top here and i'll just put
75:46 - a string and i'll just pass this in this
75:48 - should work just fine okay and then i'm
75:50 - also going to switch back perfect so
75:52 - back to all the one passed in and that
75:54 - address as the public key and then a
75:56 - comma here and then we can write
75:58 - authority is gonna be the wallet dot
76:02 - public key right and we're gonna wallet
76:04 - is coming from use wallet so for the
76:06 - public key put a comma here and we also
76:08 - got to get the default accounts that we
76:09 - set up so dot dot default counts comma
76:13 - all right and then that should be it
76:15 - closing curly bracket right and then
76:18 - again we're waiting for this function to
76:20 - run
76:21 - and once that function runs and it's
76:23 - successful i want to have an alert here
76:26 - that says
76:27 - transaction
76:29 - success yeah that'd be nice so let's hit
76:32 - save here right and let's log into our
76:34 - app because i switched wallets cool
76:36 - notice functionality still doesn't work
76:38 - all right why doesn't it work because
76:41 - i didn't add the on click to this
76:43 - yeah cool so let's just i'm not going to
76:46 - fully test it let's just see if my
76:47 - phantom wallet pops up so what i'll do
76:50 - is let's format this button to be more
76:52 - like this okay and now we can add on
76:55 - click
76:56 - equal to the function name which is pay
76:59 - flicked
77:00 - so i'm gonna hit save fingers crossed
77:02 - let's see if it works first try i'll hit
77:03 - pay 0.1 so okay so when it says if this
77:07 - comes up
77:08 - that means we are actually calling a
77:10 - function if it says transaction may fail
77:11 - to confirm right that might not be a
77:14 - good sign this could lead to errors all
77:15 - right but at least i'm going to
77:16 - confirmation that we are communicating
77:18 - to the blockchain right something went
77:20 - wrong this is the this alert coming
77:22 - through okay cool so awesome so the
77:24 - function is somewhat working i can
77:26 - accept that uh what i do want to set up
77:29 - before we fully test it is
77:31 - making use of is paid and set paid right
77:34 - because if i already paid already we
77:36 - should set this to true
77:37 - and we should get directed to the home
77:39 - page cool so if you want to do that then
77:42 - we're going to need to make another
77:44 - function and that other function is
77:46 - going to be called const get wallets all
77:50 - right this one just means all get all
77:51 - the wallets that have paid already for
77:53 - our service and this one's going to be
77:55 - asynchronous as well because we're going
77:57 - to be writing a promise so we're going
77:58 - to write const pay lit pay your list all
78:01 - right
78:02 - you're going to await
78:04 - dot program account that payer account
78:07 - dot all awesome so this is really cool
78:10 - because notice how i didn't make a
78:12 - function on my program that says you
78:14 - know get paid i don't have to because on
78:17 - the program itself right we can get all
78:20 - the accounts that paid using this method
78:21 - so we don't need to write our own
78:23 - function for that it's kind of built in
78:24 - and
78:25 - this is going to return an array of
78:28 - everyone who paid inside this variable
78:30 - so what should we do with that right if
78:31 - i want to use this state exactly so what
78:33 - we want to do is do set players set
78:36 - pairs is equal will not equal
78:38 - parentheses pass in payer list all right
78:41 - what this does is re renders the page
78:44 - and updates the payer list from an empty
78:46 - array to the array of who's ever paid
78:49 - beautiful so
78:51 - now how can i check if the user is paid
78:53 - well like i said i want to look through
78:55 - or iterate through this array to get
78:57 - that answer all right so what we could
78:59 - do is pay your list
79:01 - since it's going to hold the new updated
79:03 - array and do a four each which does
79:05 - exactly what i just said and for each
79:07 - pair right in the array all right what i
79:09 - want to do is if
79:11 - payer dot account dot wallet dot 2 base
79:15 - 58 we have to convert it to something
79:17 - that javascript can read more properly
79:19 - or easily all right and that's a method
79:21 - is equal equal to
79:24 - right so basically it's gonna check is
79:26 - this the wallet that paid is this the
79:28 - wallet that paid is this the wall that
79:29 - paid well how do we get our wallet
79:32 - that's logged in we're gonna make use of
79:33 - this the instance that holds the wallet
79:36 - that's connected so we'll say
79:40 - wallet.publickey.2base58 so they're the
79:42 - same type okay cool so if you know they
79:45 - are equal what should happen all right
79:47 - what should happen if they are equal
79:49 - well we should just write
79:51 - set
79:52 - paid is true
79:55 - all right and when should we call this
79:57 - we should call this
79:59 - on click here yeah checking on click is
80:02 - going to be equal to
80:04 - get all wallets okay and
80:07 - if you ask yourself the question
80:09 - logically do we only want to check get
80:11 - our wallets when i click the button
80:13 - right that that would be awesome right
80:15 - we could do that but what if i already
80:16 - paid and i load the page right it'd be
80:18 - cool if it just checks automatically
80:20 - when we first load this payment
80:22 - component so
80:23 - there's a cool way to do that using this
80:25 - react hook right here use effect if you
80:27 - remember from our previous videos
80:28 - explaining use effect use effect
80:31 - essentially all it does is you use it
80:33 - when you want to want to when you want
80:34 - to run a function at a certain point of
80:37 - the component's life cycle right in
80:39 - english that just means like when the
80:41 - component loads or when my page loads i
80:43 - want to run a function all right that's
80:44 - going to be the use case for this time
80:46 - so at the top here i'm going to write
80:48 - use effect
80:49 - right like this takes in two parameters
80:52 - the first one is what function or what
80:54 - do you want to do when the page first
80:56 - loads you can look at it like that
80:58 - okay well what i want to do is if a
81:01 - wallet is connected that's basically
81:03 - what i'm saying i want to get all the
81:05 - wallets all right so that means if i
81:07 - logged in run the function check if i
81:10 - already paid because if the second i
81:11 - know i paid already we can just skip
81:13 - this whole component and go to the
81:14 - homepage right and that's pretty much
81:16 - what i want to do the next thing because
81:17 - otherwise if the wall is not connected
81:19 - you should just we're not going to get
81:21 - all the wallets then we shouldn't even
81:23 - see this page based on how we loaded it
81:24 - up remember here's the second parameter
81:26 - so i'll put comma here and let's put an
81:27 - array this is called the dependency
81:29 - module right so if i just leave it like
81:31 - this if i leave it blank this function
81:34 - will only run once when the component
81:36 - first floats all right what i could do
81:38 - in this dependency module is write
81:41 - wallet dot connected
81:43 - okay so when i put this here i'm
81:45 - basically saying okay if wallet
81:47 - connected is changed like we disconnect
81:49 - or if we do connect right at this moment
81:52 - then it's gonna run get all wallets
81:53 - right because of the condition if i put
81:55 - a comma here i'm also going to be
81:57 - checking for is paid right is paid by
81:59 - default is false but if that were to
82:00 - ever change for some reason if is paid
82:02 - is true run get all wallets see if it's
82:05 - paid now all right so that's the cool
82:07 - way use effect gives you a lot of
82:08 - control on how your component is going
82:10 - to react right no pun intended that's
82:12 - that's the whole point of it okay
82:14 - cool
82:15 - so
82:16 - that should be good for payment.js
82:19 - let's see what happens what i'm going to
82:21 - do
82:21 - is refresh this page awesome we're still
82:23 - connected and i can even show you guys
82:25 - if i go to get a wallet
82:27 - console log get all wallets
82:31 - is running right you can see right i
82:33 - also want to show you console.log is
82:35 - paid
82:38 - so let's make a refresh here make this
82:40 - guy just a little bit bigger inspect
82:42 - element let's see what comes up cool get
82:44 - get all wallets is running because i hit
82:46 - refresh if i refresh again get all while
82:48 - it's running and you see false because
82:49 - is page should be false right now cool
82:52 - so time to see if this works let's hit
82:54 - the pay so
82:55 - again usually if you see transaction may
82:57 - fail to confirm that usually it doesn't
82:59 - isn't a good sign it should be able to
83:01 - calculate how much you need to pay so
83:03 - let's hit the proof ah okay the program
83:06 - could not
83:07 - deserialize the given instruction okay
83:10 - so that tells me there's something in
83:13 - our function here that we need to figure
83:15 - out could not deserialize the given
83:17 - construction okay so it looks fine in my
83:20 - cons the utils looks good i might just
83:23 - try to redeploy the smart contract
83:25 - because when i'm looking at the smart
83:26 - contract i'm not entirely sure what's
83:28 - wrong so let me just double check by
83:30 - hitting
83:31 - refresh let's just do a build and deploy
83:33 - again so let's build it okay no errors
83:35 - let's upgrade it all right even though i
83:37 - didn't make any changes let's just see
83:39 - if i can just get a new idea
83:41 - okay so it looks like it upgraded we
83:44 - want to get the export the idl
83:46 - open this up so let's see to see it real
83:49 - quick then i'll do ctrl c go to
83:51 - spotify.json control a delete paste
83:55 - save and x out that new one and again
83:57 - this id this address should stay the
84:00 - same
84:01 - yep up till the utils okay
84:04 - and on the payment side there's one
84:06 - thing that i wanted to add and what i
84:08 - want to add is if the user is paid is
84:11 - set to true basically if i did pay i
84:14 - want to load up the home page so
84:16 - we can probably write that right before
84:18 - the return like right here it's already
84:21 - if
84:22 - it is paid right if that's true return
84:25 - home
84:26 - page
84:27 - okay and home page is given to us right
84:30 - it's this lowercase one then at the top
84:32 - here we could import it import home
84:35 - page from i thought
84:37 - pages
84:39 - dot home page
84:40 - cool so if we pay the use effect will
84:43 - take care of it it's going to run get
84:44 - all wallets and if you don't get a
84:46 - wallet is paid is going to be set to
84:48 - true right it's going to be
84:51 - right here wait did we say it's true
84:54 - okay cool perfect
84:55 - so
84:56 - just to make sure as well
84:58 - triple checking i'm going to end the
85:00 - terminal yarndev
85:04 - make this smaller hit refresh
85:06 - double check i have some solana yep i do
85:10 - hit
85:11 - come on come on come on
85:13 - okay all right so it doesn't say a
85:15 - transaction may confirm there must have
85:16 - been something wrong when i went to
85:18 - deploy it let's hit approve and let's
85:20 - see what happens approved transaction
85:22 - successful awesome cool so if we see the
85:26 - alert if let's go scroll down control p
85:29 - control j and let's increase this if we
85:32 - see transaction successful we know that
85:35 - the accept payment function ran and
85:36 - there was no issues right and again if i
85:39 - click verify payment
85:40 - let's go we're in the home page and we
85:42 - paid right so that means we paid and we
85:45 - should we should be good to go right
85:46 - let's go to a wallet that definitely
85:48 - didn't pay let's go to wallet number
85:50 - four
85:51 - right select wallet we connect wallet so
85:53 - should we see the home page no that
85:55 - didn't pay it right we can't pay with
85:57 - wallet 4 because it doesn't have any
85:58 - salon cool but if i were to switch to
86:00 - wallet one let me hit refresh
86:03 - and we are in so this is how you make a
86:07 - subscription
86:08 - to your service right now that that's
86:11 - done we can work on the actual app
86:13 - itself alright so
86:15 - we were able to successfully call a
86:17 - function from the blockchain what we
86:19 - want to do next is start working on the
86:21 - home page so let's take a look at that
86:23 - so if i say control p oops not on that
86:25 - page on this page control p say home
86:29 - page dot js all right this was giving to
86:32 - you right the nav
86:33 - which is this
86:34 - the activity which is this right okay we
86:37 - want to start working on is
86:39 - all of this right that's why it says
86:41 - start coding here so what we want to do
86:44 - from there is import a bunch of
86:46 - different things right let's just set up
86:48 - the front end of the homepage all right
86:50 - so with the home page there's going to
86:52 - actually be a bunch of different
86:53 - components if you remember the demo
86:55 - there's going to be like a table down
86:57 - here that's the player and there's going
86:58 - to be some sort of like header as well
87:00 - as a nav another nav bar a playlist
87:02 - component okay so before we even get to
87:06 - those let's import any hooks that we'll
87:08 - need now i can tell you right now the
87:10 - hooks that we're going to use
87:11 - is going to be
87:12 - use effect which i explained to you
87:15 - earlier and use state okay
87:18 - cool okay so that's pretty much the only
87:21 - hook we'll need anything else we're
87:22 - going to import is going to be a
87:24 - component and our custom hook later on
87:26 - so let's set up a couple states uh the
87:28 - states that i want to set up is going to
87:30 - be over here it's going to say const
87:31 - array equal to ustay so let's talk about
87:34 - what i want to set up for this state
87:36 - variable i want to have a show
87:38 - upload music variable and the purpose of
87:42 - this is kind of like is paid right it's
87:44 - supposed to be a toggle on whether the
87:47 - modal to upload music is up right what
87:49 - if i click create or upload it's going
87:50 - to be at the top here a little modal
87:52 - it's going to be component is going to
87:53 - show up based on the state all right so
87:56 - we set
87:57 - show
87:58 - upload music right
88:00 - and again just like it's paid the
88:02 - default for it is going to be false cool
88:05 - so we're going to do const title right
88:07 - it's going to be title as this name of
88:09 - the state
88:10 - and it's going to be set title right
88:13 - cool let me spell this correctly
88:18 - perfect
88:19 - so this state that title and set title
88:22 - is going to be
88:23 - responsible for when we upload music
88:25 - there's going to be a little model that
88:26 - comes up we want to keep track of what i
88:29 - wrote as the title of the song okay and
88:32 - then for use state what i want to put
88:34 - here in quotes is just going to be empty
88:37 - right because by default the input
88:38 - should be blank and this next state is
88:40 - going to be very similar okay it's going
88:43 - to be music url and set music url and
88:48 - that's going to be equal to use state as
88:50 - well
88:53 - okay oh and there's also one more
88:55 - once we get a list of songs we're going
88:57 - to map through each song and then make a
89:00 - row down here so again we can save that
89:02 - as a state so i'll say
89:04 - songs comma set songs and that's equal
89:08 - to use state and if we're expecting an
89:10 - array of songs we should put the initial
89:13 - state as an empty array okay cool
89:15 - you guys got that awesome all right so
89:18 - from here
89:19 - we can just separate this and again we
89:21 - have the start coding here cool and we
89:23 - don't need these curly brackets perfect
89:26 - all right so from here we're gonna make
89:27 - the rest of the jsx which is gonna be a
89:30 - bunch of different components so the
89:32 - first one i'm just gonna write out the
89:34 - skeleton of the components and then
89:35 - we'll make it together so the first one
89:38 - is going to be the header and the header
89:39 - is going to be this part right here at
89:41 - the top which is going to bring up the
89:43 - modal another thing i want to make i'll
89:45 - make a comment right here there's going
89:46 - to be a component called playlist okay
89:49 - and another one we're going to make is
89:51 - something called like player controls
89:55 - player controls
89:58 - awesome cool look at that the jsx is
90:01 - pretty much done because all of the html
90:04 - css is going to be within these
90:06 - components so let's get started with the
90:09 - header so to get started with the header
90:12 - i'm going to hit save on the home page
90:13 - let's do control b here go to the
90:15 - components make a new file and let's say
90:17 - header.js
90:19 - okay control b again and we can say r a
90:22 - f c e hit tab
90:24 - save and come back to the home page and
90:27 - now we can bring this guy back in oops
90:29 - so if i just say header we can see this
90:32 - little emit abbreviation that's going to
90:34 - give us the shortcut with the import so
90:35 - i click it
90:37 - header is automatically imported and
90:39 - then forward slash close the component
90:41 - so now we got the header so now that we
90:43 - got the header we can start working on
90:45 - it
90:46 - now with the header we're going to be
90:48 - coming back to this what i want to do
90:49 - with the header is again just set up the
90:52 - front end and then we're going to give
90:54 - it more functionality as we go so to
90:56 - start we don't really need this but we
90:58 - do need import image from not down that
91:02 - but from
91:03 - next slash image
91:05 - perfect so with that out of the way
91:08 - we're now able to use images in this
91:10 - component and that should be good for
91:12 - now what i want to do is start styling
91:13 - the jsx
91:16 - okay
91:17 - so for this first div we're going to
91:18 - give it class name of styles dot header
91:22 - and that's style sheet styles that hit
91:24 - all right and if i were to save this
91:25 - we'd see styles is undefined why don't
91:27 - we see that because we need this style
91:30 - object here so i'm just going to put the
91:32 - skeleton of it so we shouldn't get any
91:34 - errors and again there is the error that
91:36 - i was talking about that's because it
91:37 - should be styles cool and within this
91:40 - header div we're going to have a wrapper
91:42 - div so let's call it class name styles
91:45 - dot header wrapper okay and then within
91:48 - the header wrapper another div is going
91:51 - to be the class name and it's not going
91:53 - to have an actual class name it's just
91:54 - going to have a tailwind css already
91:57 - because there's not much so just flex
91:59 - item center on there then we can do
92:00 - another div within that that's going to
92:03 - be class name
92:04 - styles dot arrow
92:07 - button
92:10 - okay and thanks to our cli tool we can
92:13 - give this image a source and it's going
92:15 - to lead to the assets folder which you
92:16 - guys should have over here it just
92:18 - appeared let's open it up to double
92:19 - check we want the chevron
92:22 - uh left over in this one i'll say
92:24 - forward slash oops say forward slash
92:26 - assets slash
92:28 - chevron left and this won't work until i
92:31 - give it a width and height so let's give
92:32 - it a width of 20 height of 20 and alt
92:37 - left okay and see hit save hey there it
92:41 - is yep so this should all be within the
92:43 - div for the arrow button okay from there
92:46 - you can actually just copy and paste
92:48 - that
92:48 - because we're gonna need another arrow
92:50 - button so instead of chevron left let's
92:52 - get chevron right
92:55 - cool
92:56 - yeah so it should make that shape and
92:58 - this should all be within the flex item
93:00 - center okay
93:01 - once that's done we're gonna have
93:03 - another div right here in the middle
93:05 - we'll say class name is equal to style
93:08 - dot header right
93:10 - and after style that header right
93:12 - there's going to be a button here which
93:14 - is a component that doesn't exist just
93:16 - yet so we'll say upload button for now
93:19 - but we'll come back to it don't worry i
93:20 - want you guys to give it to get an idea
93:22 - of what this is for and next let's make
93:24 - the next step okay so after we make that
93:27 - the next div is going to be div
93:29 - with a class name equal to styles dot
93:34 - profile okay cool so after styles that
93:37 - profile we're gonna make another div
93:38 - right here which is gonna have the class
93:40 - name of styles
93:42 - dot
93:43 - profile avatar container this is the
93:46 - header section and i want a little area
93:48 - where you can show your avatar okay
93:51 - cool and then inside of this div here we
93:54 - can have an image tag and then inside
93:56 - that image we can have
93:58 - we're going to use our assets again so
94:00 - do forward slash assets slash
94:02 - and then we need to find avatar.jpg go
94:05 - ahead and hit save let's see oh we need
94:08 - a width and height so let's give it a
94:09 - width
94:13 - hmm
94:14 - it's what 30 for now and a height 30.
94:21 - i'm actually going to put it 20.
94:23 - okay let me do an alt
94:25 - of avatar
94:28 - okay it's been a while let's log in
94:29 - again
94:31 - awesome there's our avatar perfect don't
94:34 - worry once i give it a class name
94:38 - we can say rounded bolt to make it
94:41 - perfectly round there we go awesome okay
94:44 - so after that here you can insert your
94:45 - name
94:46 - so let's put lens
94:48 - okay put my full name plan stiletto
94:51 - perfect okay should be closing div
94:53 - closing div okay and then the one thing
94:56 - we're missing is this shouldn't be
94:58 - closed
94:59 - in it should actually go right here we
95:02 - want to do is take this it should go
95:03 - right underneath upload button there you
95:06 - go that's better and this guy can go
95:08 - like right here yes sir perfect all
95:11 - right so i'm just going to quickly
95:12 - format this so it looks good boom
95:15 - this should line up with profile
95:18 - and these guys should be together there
95:21 - we go so should look something like this
95:23 - and this div should belong to the header
95:26 - wrapper all right looks like we're all
95:27 - set and good to go now the key thing
95:30 - here is after these three closing dibs
95:33 - we're gonna have to make another div
95:39 - and this one's gonna be style
95:40 - style.playlist
95:43 - text content
95:46 - and within that it's also going to have
95:48 - an image and that image will be
95:51 - okay and a source of this link right
95:54 - here you can put whatever you want this
95:55 - is just supposed to represent the album
95:57 - that you're looking at in the header so
95:59 - from here we can give it a width and
96:01 - height it's going to be 220 height is
96:03 - also going to be the same
96:06 - and for the alt we can just put album
96:08 - hit save i put hi
96:11 - there we go so this is the which
96:13 - represents the album that you see in
96:14 - spotify and again if i make it a lot
96:17 - bigger
96:18 - there you go
96:20 - awesome
96:24 - so after the image there's still another
96:26 - div within the playlist text content and
96:29 - that's just supposed to represent the
96:31 - details of the album itself so what
96:34 - we're going to do is make a div class
96:36 - name
96:39 - ml-5 okay within that it's going to be
96:42 - this fragment
96:44 - that just says album okay and from there
96:46 - another div called class name
96:49 - style dot type and after the title it's
96:53 - gonna have the
96:54 - current song current song this is gonna
96:57 - be dynamic later on but for now we'll
96:59 - just make it static okay and as a
97:01 - sibling we're gonna have another div
97:03 - we want to add this dot that i have
97:05 - saved and say 20
97:07 - 22 and then paste and then 46 so i'm
97:12 - just putting random numbers here you
97:14 - could put this as whatever you want
97:17 - it's going to be static and say three
97:19 - hours
97:20 - 20 minutes doing all c here so you can
97:23 - see i said save cool and don't worry i'm
97:26 - going to style all this so it's not all
97:27 - smushed in the corner okay so closing p
97:29 - tag closing div closing div closing div
97:32 - and then here we have a little
97:35 - controllers container so we'll do a div
97:37 - with the class name
97:38 - styles.controlscontainer
97:43 - and inside that div is going to be a
97:45 - couple of buttons so let's do this so
97:48 - i'm gonna have class name styles dot
97:51 - play button
97:53 - okay and inside that play button it's
97:55 - gonna be an image with the source
97:58 - being assets slash should be a play svg
98:02 - next plus play perfect pi svg
98:05 - with width
98:06 - of 30 and a height
98:09 - of the same thing
98:12 - okay after that width and height you can
98:14 - do alt equal to all right there's the
98:18 - play button and now we're going to make
98:20 - a couple divs and we can copy paste this
98:22 - because it's going to have the same
98:23 - class name so the next div it's going to
98:25 - be styles
98:26 - icon container
98:29 - okay and inside that icon container is
98:32 - going to be another image so i'll just
98:33 - copy paste this one since it has the
98:35 - same styling the difference is it's not
98:38 - play svg it is the heart button if you
98:40 - remember the spotify all right so let's
98:42 - do asset slash
98:44 - heart let's see
98:46 - perfect cool so there's the heart and
98:49 - what we want to do after that is copy
98:51 - this two more times and then just change
98:54 - the
98:54 - images here so this one has a download
98:58 - that exists and this one shouldn't be a
99:01 - heart it should be
99:02 - a more perfect then closing div closing
99:05 - div click div and that's it for the jsx
99:08 - right the next step would be to start
99:10 - doing the styling okay so getting
99:12 - started with the styles one thing i
99:14 - noticed really quickly was
99:16 - this should be in curly brackets
99:20 - okay awesome now that's done going back
99:22 - to the styles object we need is the
99:25 - header
99:26 - and the header is going to be
99:28 - maxed with
99:30 - dash 7xl and then it's going to have an
99:33 - ml auto or m.shadow sorry that's
99:35 - basically margin auto and then this p 3
99:38 - ok then after that we can do the header
99:40 - wrapper which is going to have a flex
99:43 - items center and justify dash between
99:47 - okay
99:48 - and then from there let's do
99:52 - we can do the arrow button so let's do
99:54 - the arrow button and the air button has
99:56 - a couple things it's going to have a
99:58 - background
99:59 - black mr-2 and a width 10 height 10 a
100:03 - flex our displayplex item center and
100:06 - then justify dash center and a rounded
100:10 - dash full
100:11 - okay and i also want to give the
100:13 - background and opacity
100:14 - 50.
100:16 - okay cool and then we can do cursor
100:19 - dash pointer right it's supposed to be
100:21 - like the page and i just realized
100:23 - there's another
100:24 - styles arrow button over here in line 14
100:27 - for me that's why it's not taking the
100:28 - styling there we go that's more like
100:30 - yep cursor pointer and let's add a hover
100:33 - effect let's change that opacity
100:36 - to this one when we hover okay
100:39 - nice that feels more natural okay moving
100:41 - on after the arrow button we can go
100:44 - ahead and do the header
100:46 - right which doesn't have much just gonna
100:48 - have a flex and that's pretty much it
100:51 - cool so after i had to write we can do a
100:53 - profile and then profile is going to
100:55 - have flex
100:56 - and item center
100:58 - yep and then a background black and a
101:01 - rounded dash full and ap
101:04 - one and a px-3
101:07 - okay that sounds pretty good to me so
101:09 - far let's give the background a little
101:11 - bit of an opacity dash 50 a cursor dash
101:15 - pointer and a hover
101:17 - of bg
101:19 - opacity
101:20 - of 75.
101:22 - awesome let me just double check
101:24 - something arrow button header right
101:28 - profile
101:29 - oh it's because the profile avatar
101:31 - container okay that's fine we could do
101:32 - that next we could do the
101:34 - profile avatar container and that should
101:37 - fix it up let's do with seven
101:40 - seven and a rounded dash full
101:44 - then we can do a dash ml dash 2
101:47 - 3. okay yeah the image isn't really
101:49 - aligned so what we could do is the
101:51 - container is in
101:53 - profile avatar container so just do a
101:56 - flex item center
101:58 - and there you go that looks good to me
102:00 - perfect okay so after that
102:03 - see we can
102:04 - work on the icon container
102:08 - icon container do we have one yep right
102:11 - here so let's go ahead and install those
102:13 - so the icon container it's just going to
102:15 - have an ml
102:16 - awesome okay from there we're going to
102:19 - do a title and title is going to have
102:21 - text
102:22 - 6-l x6 xl and then a font let's make
102:26 - extra bold extra there we go yeah it
102:29 - should be big and bold like it is on
102:32 - spotify then let's write playlist
102:35 - text content then playlist text content
102:38 - i'm just not sure spelled it correctly
102:40 - and we have it yep it's gonna have flex
102:44 - and items dash and empty
102:47 - cool and we lost the image yep there it
102:49 - is cool so now you're gonna see that the
102:51 - smaller make it that's where the image
102:53 - goes but then when i make it big it's a
102:55 - lot better awesome so it helps with the
102:57 - responsiveness of it okay better come on
103:00 - here let's do the controls container
103:02 - next and the controls container is going
103:04 - to have flex items center mt-10 as well
103:08 - nice and last but not least should just
103:11 - be the play button
103:14 - and the play button is going to have a
103:17 - background green that's spotify green
103:20 - yep with 16 and a height 16. nice and
103:25 - give it a flex property here with pl-2
103:28 - item center center and a justify dash
103:32 - center there we go and now watch this
103:34 - rounded full
103:36 - nice okay cool look how like making
103:38 - buttons rounder makes it way more
103:40 - appealing cool yep so that's looking a
103:43 - lot closer to the header all right
103:45 - awesome and again don't you don't have
103:47 - to use the same exact pictures i do put
103:49 - your favorite album on there and your
103:50 - favorite song and your favorite artist
103:53 - cool all right that's the header front
103:54 - end now the next step i wanted to do is
103:57 - talk about this upload button right by
103:59 - the profile name you should be able to
104:02 - see this little oval button it says
104:05 - upload and when you click it a modal
104:07 - will pop up so one of the things that
104:09 - we're going to have to do is pass down
104:11 - props all right so before i pass it down
104:13 - here let's go back to the home page and
104:16 - remember the show upload music state
104:18 - that's true then that model will pop up
104:21 - it's all gonna depend if you click this
104:23 - button right here so what we're gonna
104:25 - have to do is go to the header and let's
104:27 - pass down
104:28 - this prop right more specifically the
104:32 - set
104:33 - show upload music is going to equal
104:36 - the set show upload music function all
104:39 - right all i'm doing is taking this
104:41 - function
104:42 - and putting it into this component i'm
104:44 - passing it down because it's a child and
104:46 - then what we're gonna have to do is on
104:48 - top here of the header component we want
104:50 - to destructure the prop
104:53 - and literally just write
104:54 - set show
104:56 - upload
104:58 - music right
105:00 - what this does is if i were to console
105:02 - log
105:04 - set show upload music let's do
105:08 - inspect element hey so look at this this
105:10 - is coming from the header component and
105:12 - what's showing is a function so that why
105:15 - is that awesome because now i don't have
105:17 - to make a use state in header i could
105:20 - just pass down what i made in home page
105:22 - to the header so that's the one of the
105:24 - main benefits of props so i'm passing
105:26 - down that function reason being is i
105:28 - want that to i want to set the upload
105:31 - music to true when i click the upload
105:34 - button but how does the upload button
105:37 - know when to
105:38 - show upload music what we can do is
105:40 - first let's make the component so i'm
105:42 - going to do a new file and say upload
105:45 - button.js and this is just base this
105:49 - component right here is basically front
105:50 - end so let's hit save let's comment this
105:52 - guy out all right and let's import
105:55 - upload button from upload button hey
105:58 - there it is all right so now that we
106:00 - have it there let's pass set show upload
106:03 - music the same function to the upload
106:05 - button all right now if i were to
106:06 - console.log it here i have to
106:08 - destructure it first so i can say set
106:11 - show upload button
106:14 - [Music]
106:15 - cool so now we have the upload button
106:17 - what we can do real quick is set up the
106:19 - jsx once again
106:22 - and all it's going to have is another
106:24 - div with an on click
106:27 - this could be a button but we could also
106:29 - just put it on and click on the div so
106:30 - there's no on click i want to make the
106:32 - unclick yet because the function doesn't
106:33 - exist yet but i can make the class name
106:36 - and the class name is going to be styles
106:38 - dot oops styles dot upload button
106:44 - and it's just gonna say upload music
106:46 - just like that oh yeah don't forget to
106:49 - make the styles object all right take
106:50 - out the import react
106:57 - awesome cool so now it says upload music
106:59 - that's totally fine
107:01 - and for the styles we're only going to
107:03 - style upload button
107:05 - and there's not much to it it's just
107:07 - styling the button it's going to have a
107:08 - background of the spotify green yep it
107:11 - may not look much now but once i add
107:13 - some styling to it
107:15 - give it margin
107:16 - padding cursor dash pointer
107:22 - uh-huh full like we always do
107:25 - nice and then
107:26 - we can do a hover
107:29 - scale
107:30 - 95 and add a transition
107:32 - cool
107:33 - it looks a lot better when you stretch
107:35 - it out a bit but this is the upload
107:36 - model and at the moment nothing when i
107:39 - click it right that's because let's add
107:41 - the on click functionality and there's
107:43 - nothing really to click because there's
107:45 - no function so
107:46 - combing at the top here between lines
107:48 - seven and eight let's make the const
107:51 - upload clicked
107:53 - and the upload click all it's gonna do
107:56 - is
107:57 - take our set show upload button
108:00 - and set it to true okay
108:02 - and then all right to show you guys if i
108:05 - go to home page and let's console.log
108:08 - show upload music right what do you
108:10 - think we'll see in the console log if i
108:11 - hit save
108:12 - all right so let's make this guy bigger
108:14 - it's back to console
108:16 - false right so
108:18 - uh show upload music is false when i
108:20 - click upload music
108:21 - it should be true right it's true now
108:23 - come on all right says false oh it
108:26 - doesn't say true yet so let me just move
108:28 - this back i'm going to go over to
108:29 - payment and let's take out the console
108:31 - log here so it's easier to see and then
108:34 - upload we forgot to add on click so
108:35 - let's do that we'll click on click then
108:37 - we do upload clipped
108:39 - okay extending this inspect element now
108:42 - we check all right so hit refresh nice
108:44 - so if it's the home page
108:46 - we should see false if i click upload
108:48 - music set show upload button is not a
108:52 - function okay
108:53 - interesting i'm going to assume it's a
108:55 - typo set show upload button
108:59 - oh there you go i said button instead of
109:01 - music it's a mistake
109:03 - there you go
109:04 - now we should be good hit it refresh
109:06 - again all right false
109:08 - true and it doesn't change it back it's
109:10 - only when i the modal comes up that we
109:12 - can exit out then make it false so
109:15 - that's how we set up show upload
109:17 - and
109:18 - get the
109:19 - state to change okay there we go all
109:22 - right so now that the upload
109:24 - button is finished if i were to full
109:27 - screen this right it's going to set the
109:29 - state to true and from the looks of it
109:31 - we're starting to set up the
109:33 - everything we're going to need in order
109:35 - to upload our own music which is going
109:37 - to be awesome right but the thing is
109:39 - with our smart contract how it is now
109:41 - it's not able to
109:44 - upload any songs we can only accept the
109:45 - payment so i think it's time let's get
109:47 - back into solano playground and work on
109:49 - the smart contract all right so now that
109:51 - we're back and we made the first
109:53 - function together we're going to use
109:55 - that as a template to creating more so
109:57 - let's see if you guys remember what i
109:58 - said a couple minutes ago right so we
110:01 - want to make a new function and the
110:03 - function is going to be called create
110:06 - music and what create music should do is
110:09 - store the reference to the song
110:12 - right onto the blockchain so let's start
110:15 - making a function so how do i make a
110:17 - function in solana right with anchor
110:20 - exactly you're gonna write pub
110:23 - fn all right same thing as we did before
110:25 - so how do i give this function a name
110:27 - well you can do right here create
110:28 - underscore music okay how do i give this
110:31 - function parameters right so again if
110:33 - you know javascript really well this is
110:35 - very similar all right so i it looks
110:38 - like this but i put enter in the
110:40 - parenthesis because i'm going to add a
110:42 - couple parameters what kind of
110:43 - parameters would we need for create
110:44 - music all right let's think about accept
110:46 - payment payment needed who was paying
110:49 - the context of who was paying the data
110:50 - of who's paying right create music is
110:52 - going to need the same thing so there's
110:54 - going to be a parameter called ctx and
110:56 - the type is going to be context but not
110:58 - pair it's going to be create
111:01 - music okay is that it though that's not
111:04 - going to be it i could tell you now i
111:06 - also want to store the name of the song
111:08 - the title right this would be mr sandman
111:12 - the the goosebumps by travis scott like
111:14 - the title
111:15 - right and what is the data type of the
111:16 - title you think exactly it's a string so
111:20 - i also want to store the music
111:22 - underscore irl i wanted to talk really
111:24 - quick about what this means so if you
111:26 - guys are familiar with nfts at all
111:28 - when you guys own an nft
111:30 - what happens is you own
111:33 - the
111:34 - rights to the address on the blockchain
111:36 - right where that the reference to the
111:38 - nft you don't actually own the picture
111:40 - itself right it's essentially you own
111:42 - the link and when you put that link it's
111:44 - going to point to the actual image that
111:47 - you own all right so the same thing
111:49 - applies here it's going to store the url
111:52 - right where your music is being hosted
111:54 - so later i'm going to use a cloud
111:55 - hosting site to host our music the main
111:57 - thing is that
111:59 - solana is going to store that reference
112:01 - nft is the image is stored in ipfs and
112:04 - you own the reference to that image in
112:07 - ipfs so it same sense the music rl is
112:10 - going to be a string so i think that's
112:11 - all the parameters the next thing we
112:13 - want to do is
112:14 - talk about what the program result is
112:17 - which describes
112:19 - what should we expect so let's write
112:21 - program result
112:24 - curly brackets and what we're going to
112:26 - write here is a variable called music
112:28 - right and then we can say it's going to
112:30 - be
112:32 - and
112:33 - mute right what does n mean it means
112:35 - that whatever we're going to write after
112:37 - this mute is going to be
112:38 - changeable or mutable and what it's
112:40 - going to be is ctx right the context dot
112:43 - counts
112:44 - dot music all right so let's pause this
112:47 - function right here right now so if you
112:48 - remember
112:49 - we needed to pass in pair context but we
112:52 - didn't know what
112:53 - like if this is describing ctx we don't
112:55 - know what
112:56 - this even means so what we have to do
112:58 - was create
112:59 - a pair context struct right so if we're
113:01 - going to do context create music what
113:03 - should we do exactly we should create a
113:05 - cree create a creative music okay so
113:09 - it's going to be similar to this and we
113:10 - can use this as a reference if we get
113:11 - lost right so coming down below here
113:15 - let's do the create
113:17 - music context so i'm setting up what
113:19 - that means all right so the first thing
113:21 - we're going to do if you look at the top
113:22 - is something like derive accounts right
113:26 - basically you get all the traits of an
113:28 - account right so derive parentheses
113:30 - accounts
113:32 - and then how do we write a struct or
113:34 - create a in other words a class if you
113:36 - understand what that means in javascript
113:39 - we're going to say pub struct create
113:42 - music and then pass in info okay so far
113:45 - so good
113:46 - there we can add curly brackets right
113:48 - after info and now
113:50 - what did we do here right we wanted to
113:52 - essentially authenticate the account so
113:54 - we're going to get it like this pretty
113:55 - much something pretty much similar to
113:57 - this all right we're going to start it
113:59 - off the same so it'll be hashtag array
114:02 - count
114:03 - parentheses
114:05 - oops yeah so you saw that how it like
114:07 - set up the knit and everything like that
114:09 - we're going to do that as well okay
114:11 - so we'll start off by doing init once
114:13 - again and then after you knit we'll set
114:15 - up our seeds which is going to be
114:18 - generating a unique hash based on the
114:20 - input that you put in here as i
114:22 - explained previously so let's do a b
114:24 - music
114:25 - dot as ref and again you don't have to
114:27 - worry about what all this does exactly
114:30 - just know that it generates that unique
114:31 - hash random key dot key dot as
114:35 - underscore ref
114:38 - okay parentheses after that put a comma
114:40 - here and then you can write bump and if
114:42 - you remember a bump it's supposedly
114:43 - supposed to increment the unique hash if
114:47 - it's not unique right so say like it
114:48 - makes a unique hash from this input
114:50 - then it's just oh if it's not unique
114:52 - it's going to increment 1 to 20. okay so
114:55 - bump and then we're going to set the
114:57 - payer to equal the authority okay and
115:00 - from here
115:01 - let's say this let's define the space
115:04 - right now with rust
115:06 - um one thing they like to do is they
115:08 - like to know exactly how much the
115:10 - exactly the size of the input that's
115:13 - going into the function right with
115:14 - javascript you can either have an array
115:16 - of zero or an array of one million
115:18 - really and javascript will accept it
115:20 - right with rust it needs to know what
115:23 - the maximum size to expect you know is
115:25 - for this space and to start off we can
115:28 - use our size of which we're importing
115:33 - and get the music account which doesn't
115:36 - exist yet so we'll pause this in a
115:37 - second alright so let's define what the
115:39 - music account is if you have no idea
115:41 - what i'm talking about let's remember
115:43 - the
115:44 - payer context right you have to define
115:46 - the size of the pair contacts and the
115:48 - size of pair contact is going to be the
115:50 - whatever is in the payer account and
115:53 - what is pair account that's another
115:54 - struct we made this one right here so
115:56 - with that kind of like pattern
115:58 - recognition what are we gonna have to do
116:00 - for this what is music account music
116:01 - account is gonna just be another struct
116:04 - that we define over here okay so let's
116:06 - define it we're gonna have to do a
116:08 - hashtag account here and after we do
116:10 - hashtag account we can do pub destruct
116:12 - music account that's how you make a
116:14 - class once again and you could think of
116:17 - this as what are the properties of a
116:20 - music object right so one of the first
116:22 - things i do is
116:24 - get the authority so the authority of
116:27 - the music account is simply just going
116:29 - to have the type of pub key pop key like
116:32 - this actually awesome another attribute
116:34 - that might make more sense to you is
116:36 - inside the
116:37 - what i'm going to store on solana is
116:39 - going to be the music title right so pub
116:42 - title and what can you expect from this
116:44 - data type it's going to be a string okay
116:46 - is that making more sense now the music
116:48 - object is going to have a key of title
116:50 - and a value of whatever title we write
116:52 - in the front end okay another thing
116:54 - that's going to have is pub music
116:56 - underscore url which is going to have a
116:58 - string or expecting a string
117:01 - cool so now music count is defined and
117:03 - what i'd like to do next is
117:06 - define how
117:08 - what is the maximum size of title and
117:10 - what should be the maximum size of music
117:12 - url so what we could do is come to the
117:14 - top here between a line of nine and ten
117:16 - make some space and we can say const
117:19 - text length okay and text length is
117:22 - gonna accept the type of view size and
117:24 - the size of text length is going to be
117:26 - 255 bytes all right semicolon you can
117:29 - think of this 255 at one byte which
117:32 - should equal one character it's not
117:34 - going to be exact but that's roughly the
117:37 - estimate that you can look at so my the
117:39 - longest title i can have is up to 255
117:42 - characters about okay same thing for the
117:44 - music
117:45 - underscore url underscore length view
117:48 - size and that's going to be equal to 255
117:50 - all right that's the same reason why you
117:52 - can think of this like twitter where
117:54 - they limit the amount of characters per
117:56 - tweet so that someone can't make a
117:57 - paragraph so we're defining the text
117:59 - length and the music url length that
118:01 - looks pretty good to me so coming back
118:03 - below here right we still have our
118:05 - struct now let's determine the size the
118:07 - total size it's going to be the music
118:09 - account object itself
118:11 - plus the text underscore length plus the
118:15 - music url okay we're adding all the
118:17 - things together to get an exact estimate
118:20 - of the s the space or size of the create
118:23 - music context okay
118:25 - amazing so after the closing stuff right
118:27 - here let's write out the rest of the
118:30 - attributes of create music so we'll
118:32 - write pub music
118:34 - right it's going to be an account type
118:37 - which has the info lifetime variable
118:39 - oops close it off but you can put comma
118:42 - music account all right then we're going
118:44 - to have it checked here which is going
118:46 - to be
118:47 - account parentheses mute and again
118:49 - whenever you see mute that means it's
118:51 - mutable or it can change data that can
118:53 - change so the pub a random key can
118:56 - change and the random key is gonna
118:58 - expect count info again or more
119:01 - specifically account info info i know
119:04 - it's pretty funny all right from there
119:06 - we're going to do another hashtag
119:07 - account
119:08 - mute all right this is essentially the
119:11 - authority that i'm setting up right now
119:13 - i'll put a comma right here the
119:14 - authority and it's going to essentially
119:16 - be the signer who paid the transaction
119:18 - fee that's what i'm defining here so
119:19 - i'll write pub
119:21 - system underscore program
119:23 - is unchecked count
119:26 - info there we go
119:28 - okay from here let's set up the token
119:31 - program
119:32 - sorry not the token program we want to
119:34 - set up the system program it's going to
119:36 - be similar right we did system program
119:39 - the next thing you want to do is let me
119:40 - double check system program oh set up
119:43 - the token program i was right and it's
119:45 - going to be something like this okay
119:47 - quite literally we could copy this
119:49 - because it's the same format and we're
119:50 - also going to save time as well
119:52 - all right as you can see system program
119:54 - is the same the authority is the same so
119:56 - there's some sort of like template going
119:58 - on here
119:59 - [Music]
120:07 - and yeah that's what i was missing
120:10 - okay yeah and i forgot we need the
120:12 - authority here too that's what i was
120:13 - talking about earlier this is the signer
120:15 - who paid the transaction fee boom okay
120:18 - cool so we don't have to reinvent the
120:19 - wheel that's pretty much the template of
120:21 - this okay and of course
120:23 - i can expect a couple bucks here no
120:26 - did all go away nope everything's in
120:28 - there all right we can expect a couple
120:30 - bugs here so let's hit build yep there
120:32 - we go line 79
120:34 - info is never used oh i see okay it's
120:37 - never used because i didn't finish that
120:39 - function remember how i paused it so we
120:42 - set up all our structs
120:43 - when i hop back into the function create
120:46 - music we didn't finish writing this out
120:48 - because i wanted to tell you guys
120:50 - now this should make more sense so music
120:53 - this is a variable it's going to be
120:54 - equal to the context
120:56 - dot accounts and then grabs music all
120:59 - right and that's going to set equal to a
121:01 - variable and then from there this is
121:03 - where it all starts to click for me
121:04 - personally if i say music authority
121:07 - right how can where is this authority
121:09 - coming from this authority we can this
121:12 - is a key
121:13 - right this is like saying uh
121:15 - car dot model
121:16 - is equal
121:18 - to lamborghini right so i'm setting the
121:21 - authority of music the object that we
121:24 - created or destruct right and setting it
121:26 - equal to something okay can we set it
121:28 - equal to if this is the authority we
121:29 - actually have
121:31 - the reference to it so we can say
121:35 - dot ctx.accounts.authority.key there we
121:36 - go so i know if that didn't make sense
121:38 - to you this one might so music right if
121:41 - i say music it's gonna be
121:43 - this right how can i
121:45 - get the title of this music well if it's
121:47 - like an anything like an object that i
121:49 - know i can say music that title cool so
121:51 - that's how we have access to the key now
121:53 - i can then sign a value so what should
121:55 - be the title of the song i could say
121:57 - like goosebumps right but then that
121:59 - means every song that i create is going
122:01 - to have the title goosebumps but that's
122:02 - not good all right we should make it
122:04 - dynamic well how can i get a dynamic
122:06 - title luckily for you we passed that in
122:08 - as a parameter so you can just say the
122:10 - music the title is going to be title
122:13 - there you go is it making sense now so
122:14 - let's put a semicolon right here
122:15 - something going right there and then
122:17 - we're going to say music dot music
122:19 - underscore url is equal to the music url
122:22 - we passed it there we go so i hope it
122:24 - all came together in that moment i had
122:26 - auto saved by accident and then whenever
122:29 - you finish a function we can write ok
122:33 - and usually sometimes you can pass stuff
122:34 - in here but for this you don't have to
122:36 - hit build again expecting some errors
122:38 - it's going to try again build compiling
122:41 - there you go so it's not one used import
122:44 - and line 96
122:48 - line 96 aha because the comma should be
122:51 - here
122:52 - okay expected line 40 yep it would be
122:55 - good to add a semicolon right here
122:58 - [Music]
123:00 - build compiling
123:03 - oh let's go finish no error so let's
123:04 - refresh one more time so we can see a
123:06 - clean console let's see if
123:08 - line 40 had the semicolon yep that's the
123:11 - last thing i added we build then
123:13 - finished no errors let's go so as long
123:16 - as you you know dot your t's and eyes or
123:17 - in other words add your semicolons
123:19 - semicolons and commas you should see
123:22 - finished not even any warnings but
123:24 - awesome now if i ask you this question
123:26 - if i go back to my vs code
123:28 - is it using the latest version of the
123:30 - contract does it have the create music
123:33 - function
123:34 - inside of it no no we have to upgrade it
123:36 - like i showed you earlier so let's
123:37 - upgrade it and again it's going to cost
123:39 - some solana so make sure you have some
123:41 - you could always air drop yourself right
123:42 - here air drop i know at the moment our
123:44 - contract should cost about five sold so
123:47 - it's going to take it and we deploy
123:49 - slash upgrade our contract awesome so
123:51 - looks like a deployment was successful
123:54 - so now that our contract is upgraded
123:56 - we're going to need to export the idl
123:58 - all right and then we can double click
124:00 - this it should open up in vs code we can
124:01 - do an alt z
124:03 - and let's also grab our spotify json
124:06 - right so spotify json is the current
124:08 - idle that we're using so if you look
124:10 - what's the difference between these two
124:12 - all right if you look in terms of
124:13 - functions
124:14 - there is a create music function now and
124:18 - that's how we call it in the front end
124:19 - no underscore right another thing that's
124:21 - also here is the struct okay
124:24 - so what i want to do is press ctrl a to
124:26 - select everything in this idl.json and
124:29 - then ctrl c to copy it all right so then
124:31 - i go to the spotify.json go a delete
124:35 - paste all right that's just to ensure
124:36 - you know i'm not copying anything wrong
124:38 - this looks a lot better cool now did i
124:41 - do i have to change the contract address
124:43 - no since it's the same we just upgraded
124:45 - the same contract in my const this will
124:48 - stay the same and when i import
124:49 - spotify.json that's going to be
124:51 - different so we're already we're
124:53 - actually already done upgrading so now
124:55 - we have the ability to call the function
124:57 - but we haven't quite set that up yet but
125:00 - with that said
125:01 - we're done with a smart contract so if
125:03 - you made it this far in the video
125:04 - congratulations give yourself a pat on
125:06 - the back you were able to write another
125:09 - solana program and if you made it this
125:11 - far let me know you made it this far by
125:13 - saying
125:14 - shark in the chat right digital oceans
125:16 - mascot is a shark named sammy so if you
125:17 - say shark in the comments i'll know but
125:20 - you were making you were watching this
125:21 - and you made it this far so that's the
125:24 - smart contract awesome so we finished
125:26 - the solana program and everything is
125:28 - pretty much set up on the back end what
125:30 - i want to do next is set up the front
125:32 - end so what we can do
125:34 - is let's make the vs code full screen
125:36 - because what i'm about to do is create a
125:39 - custom hook right in react you saw that
125:42 - there's use state use effect all right
125:44 - we can also make our own custom hook by
125:46 - writing something like this so i'm going
125:47 - to say control b and what i want to do
125:50 - next is make a folder so we can close
125:52 - all of these so you can see it a lot
125:54 - better all right we're going to want to
125:55 - make a new folder and this is going to
125:57 - be hooks right the hooks folder again is
126:00 - exactly what sounds like create holds
126:02 - any custom hooks we create so in the
126:04 - hooks folders a new file and i'll call
126:06 - this use
126:07 - spotify and that's what i'm going to
126:09 - call the hook essentially so use spotify
126:11 - control b let's set it up by importing a
126:14 - couple things so i want to import
126:17 - token underscore program id from solana
126:20 - spl token we've imported this before i
126:22 - want to import use wallet so what does
126:25 - use wallet do again yep it holds the
126:27 - instance of the wallet that's connected
126:28 - and usually we put that in a variable we
126:30 - also want to get our connection to the
126:33 - blockchain and that's through solana
126:35 - host coming from utils const we need to
126:37 - get the program instance so how do we
126:39 - get that yep it's the get program
126:42 - instance everything we did previously is
126:44 - all set up for this now it should all be
126:46 - making sense okay
126:48 - now we also want to get anchor so let's
126:50 - just make that in a variable we can say
126:51 - const anchor is equal to require
126:54 - add project serum slash anchor all right
126:57 - that's how we usually get anchor you can
126:58 - get our utf8 set that equal to anchor
127:02 - all right we did this before it's
127:05 - anchor.utils.bytes i believe dot utf8
127:08 - cool now remember how i said we
127:10 - destructured something from anchor we're
127:12 - gonna do that again except this time
127:13 - we're gonna get two things for me we are
127:15 - going to get web3 and something called
127:18 - bn okay next we're gonna do cons system
127:22 - program that's all imports that we've
127:24 - used previously in the build okay after
127:27 - that we're going to set up default
127:29 - accounts again which is the exact same
127:30 - thing as before it has a key called
127:32 - token program and it's going to be set
127:34 - to token program id as clock which is
127:37 - going to be set to anchor dot web three
127:40 - dot sis r all right that's how we get
127:42 - the clock and then it's also going to
127:44 - have a key called system program and
127:46 - that's gonna be system program all right
127:49 - coming from
127:50 - here and then we can get dot program id
127:54 - cool
127:54 - okey-dokey so again a hook is just a
127:57 - function that we can call upon
128:00 - essentially so we can set up the
128:01 - function by saying cons to use spotify
128:04 - because that's the name of the hook is
128:05 - equal to arrow function yeah awesome so
128:08 - what are the parameters of u spotify
128:10 - what does zeus spot if i take it i can
128:12 - tell you that use spotify even if you're
128:14 - not sure or understand why we're making
128:16 - this i'll tell you that spotify is gonna
128:18 - have music url title
128:20 - set title set music url and set upload
128:26 - music okay cool again you might not know
128:28 - where all these are coming from but if
128:30 - you're if you were able to understand
128:32 - code or look at somebody else's code you
128:33 - might be able to determine what we're
128:35 - passing in here where have we seen set
128:37 - title or set music set something right
128:39 - that comes from state and we actually
128:42 - have all of these states already all
128:44 - right i'm just giving it the same name
128:46 - so use spotify is going to take in all
128:47 - this information and some functions from
128:50 - state and do something with it okay so
128:53 - in between the curly brackets in line 22
128:55 - and 24 is the actual logic itself so in
128:59 - the function let's set up a couple
129:01 - variables first one is going to be what
129:03 - is the wallet connected it's going to be
129:04 - a variable called wallet and how do we
129:06 - get the wallet instance get use wallet
129:09 - that's it you guys are pros okay we also
129:11 - want the connection how do i get the
129:13 - connection the connection is going to be
129:15 - new anchor dot
129:17 - three dot connection
129:20 - parenthesis and then pass in your rpc
129:22 - connection which is solano underscore
129:24 - host okay from there we're gonna use
129:25 - const program so the equal to get
129:28 - program instance
129:29 - and remember program instance takes in
129:32 - two parameters and should make sense why
129:34 - i wrote those variables before because
129:36 - it takes some connection all right so
129:37 - now it's lit up and the wallet yes
129:40 - nothing new from here
129:43 - use spotify is going to have a function
129:44 - called get songs alright so const get
129:47 - sung get songs is exactly what it sounds
129:49 - like it's going to fetch the songs that
129:52 - are stored okay so to fetch the songs
129:55 - right marisha konsta log fetching songs
129:58 - just to know that in our console that
130:00 - what it's doing and what this is running
130:01 - and what we could do is ask ourselves in
130:05 - our smart contract is there a fetch
130:06 - songs button there's not we only have
130:09 - accept payment and create music one
130:11 - feature about making a music account but
130:14 - making a music account is that it stores
130:16 - all of that in the program itself so you
130:18 - don't need to make how can we use that
130:19 - to our advantage then so we can say
130:21 - khan's songs it's just the variable i
130:22 - hold it in it's equal to await
130:25 - program which is you know the program
130:27 - that we're referencing dot account okay
130:30 - dot music account right literally called
130:33 - the name of the struct i'm literally
130:35 - calling and i'm trying to get everything
130:38 - stored on there so how do we get all
130:40 - that all of that there's a built-in
130:41 - method called all which will do that
130:43 - just for you then just to prove it to
130:44 - you we can con to log the songs and then
130:47 - return songs right that's what you
130:49 - return from this function so that's the
130:51 - get songs okay
130:52 - after get songs i need a function that's
130:56 - going to upload or store songs into the
130:58 - contract itself so we what do we have in
131:00 - methods that do that except payment no
131:03 - create music right it's storing them or
131:06 - at least setting them to the account
131:07 - right here so let's make that function
131:10 - constant new music is what we'll call it
131:13 - equal to async
131:16 - now what is this going to take in new
131:18 - music is going to be const random key
131:21 - that's the first verb and to get a
131:23 - random key pair we can just generate one
131:25 - using anchor so if we do anchor dot web3
131:28 - dot key
131:30 - pair
131:31 - dot gender okay then we can do that
131:32 - public key okay awesome after that's
131:35 - done we can do music pda and this is
131:38 - going to equal await anchor dot web3 dot
131:42 - public key dot find program address all
131:46 - right parentheses inside here utf8
131:50 - dot code and this is where we put music
131:53 - again and then we'll do the random key
131:56 - dot to buffer all right this is what we
131:58 - did last time when we're doing the
132:00 - accept payment we have to set this up
132:01 - and key to buffer comma and then we had
132:05 - program dot program id okay and i'm
132:08 - seeing that this should actually
132:10 - be used so let's make this lower case
132:12 - and bam so now it's being used okay cool
132:15 - program id that looks pretty good
132:17 - awesome so let's set up a variable
132:19 - called tx for transaction and set that
132:22 - equal to all right the instruction that
132:24 - i want to run on my contract is create
132:27 - music so how do i run create music from
132:29 - my front end we're going to get program
132:31 - right that's the reference of the
132:33 - program if i could spell program
132:35 - dot rpc
132:37 - right remember this from before dot
132:39 - create
132:40 - music there we go all right so create
132:43 - music what are the parameters that it's
132:45 - expecting let me just double check that
132:47 - it's expecting title music url and just
132:50 - to create music context we could do
132:52 - title all right so with that hook done
132:54 - let's remember what we pass in to use
132:55 - spotify the url title the set title the
132:58 - music url and the show upload music okay
133:02 - with the hook done let's head back to
133:04 - the home page and in the home page what
133:07 - i want to do is add another import here
133:10 - let's import
133:12 - use spotify from the hooks use spotify
133:16 - all right so we just imported our custom
133:17 - hook now what are we going to do with
133:19 - that what i want to do is take out this
133:21 - console log right first and then we're
133:24 - going to do some destructuring of use
133:28 - spotify all right seems familiar
133:30 - all right for use spotify what are the
133:32 - imports again the parameters that it
133:34 - takes in it's gonna take in a music url
133:37 - we have that that exists here does it
133:40 - have title do we have that yes we do
133:43 - it's going to take in set title all
133:45 - right we have that and it's going to
133:46 - take in set music url awesome and last
133:51 - but not least it's going to take set
133:52 - show upload music it's not going to glow
133:54 - because we've passed that down to header
133:56 - already alright so we passed in the
133:58 - actual things in the hook but what do we
134:00 - want to take from you spotify what can
134:02 - we take we can take we look
134:04 - the two functions we create constantly
134:06 - music and cons get songs that should all
134:08 - be in the home page to make use of it
134:11 - so we can literally write that by
134:12 - destruction and saying new music comma
134:15 - uh set not sorry get
134:17 - songs yes okay so we destructure two
134:20 - functions from our custom hook so that
134:23 - we can use it in our home page there we
134:26 - go so now it's true
134:29 - at the moment if i click upload music
134:31 - the model doesn't come up because that
134:32 - component has been made yet so
134:35 - let's make the component so we're going
134:36 - to do that next i'm going to i'll tab
134:38 - into here and the trick that i want to
134:41 - do is if you hit enter it should still
134:44 - be in the should be right here in line
134:46 - 31 what i want to do is put curly
134:48 - brackets and say
134:49 - show upload music you guys know what
134:51 - should know what show upload music is
134:52 - right what's the default state of this
134:54 - false when does it turn true when i
134:56 - click the upload button right basically
134:58 - you could set some conditional no
135:00 - rendering saying if show upload music is
135:02 - true right then we want to upload i mean
135:05 - upload show or render the upload
135:09 - modal
135:10 - component right essentially the upload
135:13 - model again this doesn't exist just yet
135:15 - but we can make it exist in the
135:17 - components folder new file upload
135:20 - modal.js rafc
135:23 - okay
135:24 - then we can add the import upload model
135:27 - from there so if i click on upload music
135:30 - we see upload mode hit refresh might ask
135:33 - us to log in because it's been a while
135:37 - now i don't see the upload model why not
135:39 - because by default this is false
135:41 - but if i click this there it is and when
135:44 - should it go away when i hit create new
135:46 - music which isn't set up yet so there we
135:49 - go so we updated the home page now let's
135:50 - work on upload model so with upload
135:52 - model there's a couple things that i
135:54 - want to pass down to it so let's make
135:56 - some space here and let's say the props
135:58 - that i want to pass down it's going to
136:00 - be title and title is going to have the
136:02 - value of title which is the state it's
136:04 - going to have the function to be able to
136:06 - set the title i'm going to have the set
136:08 - show upload music show upload music
136:10 - right because i want to put this
136:12 - function in upload model because i want
136:14 - to set it back to false either when i
136:16 - exit out or when i create a new model
136:18 - right so then let's do music url set
136:21 - this equal to the same thing and set
136:24 - music url also and new
136:27 - music right new music is what guys yes
136:30 - it's the function that we're getting
136:32 - from
136:33 - use spotify as you can see here okay
136:36 - cool all right so we passed down new
136:38 - music into there and now i feel
136:40 - comfortable working on the upload model
136:43 - okay cool so let's start working on this
136:45 - we can take out import react from react
136:47 - and what we will need is put curly
136:50 - brackets here and let's import all those
136:53 - props or destructure them rather so the
136:54 - props is just gonna be it's gonna be
136:57 - title comma
136:58 - music url the set title
137:02 - the
137:03 - set music url
137:05 - set show
137:07 - upload
137:08 - music so that's everything we passed
137:10 - down and destructured all of them and
137:12 - now let's work on the jsx all right so
137:16 - the first thing i want to do is make a
137:17 - class name and on click how's that i
137:20 - want to click and when i click on it
137:22 - what i want to do is set show upload
137:25 - music let me see is it here set show
137:28 - upload music set show upload muse all
137:31 - right does it glow up yep it's going up
137:33 - and we want to set that to default sorry
137:35 - if i click that button which is just
137:37 - cancel there it is so it should be like
137:40 - cancel upload right so the model is
137:42 - showing up it's not exactly nice yet but
137:45 - now the functionality is coming along
137:47 - yeah all right i'm not done yet we need
137:49 - another button here this button will
137:51 - also have it on click this time though
137:54 - it's going to have a function
137:56 - called create and you don't need this
137:58 - arrow here because i'm not directly
138:00 - calling it i'm not putting parentheses
138:02 - or you can leave it like this and this
138:04 - will have a class name of template
138:07 - literal and say style style.button
138:10 - but it also will have another's class
138:12 - name that's why we're doing this of
138:15 - style.create let's put s here too
138:18 - okay and if i save this we're going to
138:19 - see create not clicked how create new
138:21 - click is undefined because we haven't
138:24 - quite made that function yet so what
138:26 - i'll do really quickly though is right
138:27 - create new that's going to be the text
138:29 - for it and it's going to be closing
138:30 - button and that's the jsx so my computer
138:33 - doesn't yell at me i'm going to make
138:34 - that function create new clicked and now
138:38 - i think about it we don't even need to
138:39 - make create a new click
138:40 - actually we can just
138:42 - literally call
138:43 - new music right here yep that makes more
138:46 - sense awesome so now if i hit save hey
138:48 - we got two buttons awesome okay create
138:51 - new and we got the transaction may fail
138:53 - to confirm that's not a good sign we
138:54 - can't really check this yet because even
138:57 - if it did work we don't have any songs
138:59 - to get just yet so we'll hold off on
139:01 - that but it's good to know that the
139:03 - button works okay so i shall open modal
139:06 - i hit cancel boom there we go all right
139:09 - so next we have to do is do the front
139:12 - end now i'm starting to realize that
139:14 - this upload model is something i got
139:16 - from a different project and that one
139:17 - doesn't use tailwind so just to save
139:20 - time this one is not going to be styled
139:21 - with tailwind but we can do an import
139:23 - styles from and then the path so let's
139:26 - do command b
139:28 - go to style and again this it's already
139:31 - here so we don't need to style it
139:33 - already it's already done for us thanks
139:35 - to our cli tool once again so we can say
139:37 - import styles from dot forward slash
139:41 - styles yep upload modal css hey there it
139:44 - is so if you're just a quick overview
139:47 - this was given to you this was not done
139:48 - by me this is the create button
139:50 - everything that you need you can just
139:51 - play around with it and see how it's
139:53 - styled so again if i hit cancel boom and
139:56 - that looks funny so let's just double
139:58 - check our inputs again
140:00 - and put ah input file should be input
140:04 - field
140:06 - save hey there we go that's more like it
140:08 - one thing that was also weird is the
140:10 - modal buttons i think that's because
140:13 - the cancel button should have the same
140:16 - class name let's see if that works
140:18 - instead of create this should be cancel
140:20 - though hey that's more like it so smooth
140:23 - so if i hit cancel we lose the model if
140:26 - i upload music the model is back and
140:28 - that's how you make a model nice with
140:30 - all that done let's start working on the
140:33 - table itself like this area right here
140:35 - that's going to show all the songs that
140:36 - we have so to get started on that what i
140:39 - should do is let's head over to the home
140:41 - page and we can actually just do it by
140:43 - doing ctrl p and click this awesome
140:46 - let's start making playlist.js so we
140:48 - could do is comment this out now we can
140:50 - do control b and then under components
140:52 - let's make a new file
140:55 - playlist.js awesome do a little rafce
140:59 - come back to the home page and do an
141:02 - import import uh playlist from
141:05 - components playlist and they're cool all
141:08 - right so now that we're in the playlist
141:09 - component we can get rid of import react
141:10 - from react but we will import
141:14 - use effect and use state all righty so
141:17 - we know what those hooks do from here
141:20 - that should be fine let's make out the
141:22 - playlist and if you didn't know playlist
141:23 - is the table for all the songs so it's
141:26 - going to start displaying all the songs
141:27 - through here let's set up the jsx for it
141:30 - all right so if we want to set the jsx
141:31 - for it let's make our styles object and
141:34 - i promised we didn't give this one away
141:35 - we're going to do it together all right
141:37 - so the first div is should be called
141:40 - table wrapper so styles dot table
141:43 - wrapper and inside the table wrapper i
141:46 - will have a table and the class name of
141:48 - the table will be
141:50 - styles dot table okay inside of the
141:54 - table div or table tag it's going to be
141:56 - t body the table body which will have a
141:58 - class name styles dot table
142:02 - okay and then we can do a tr and within
142:05 - the tr we have th's and we have a couple
142:08 - of these so we can copy this a couple of
142:10 - times since we have a couple two three
142:13 - four we have a total of four
142:15 - and each one is going to have a class
142:17 - name
142:18 - of
142:19 - pb-3
142:20 - and we can copy this one over too so
142:22 - we'll be listening to this boom and
142:25 - there's four they all have pb-3 and this
142:28 - one will have hashtag this will be title
142:32 - this will be
142:33 - place and this won't be an image so i
142:36 - guess we need to import image or
142:38 - actually we don't have to we could
142:39 - probably use an image tag here so let's
142:40 - just use a regular image tag and just
142:42 - say source is equal to
142:45 - assets
142:46 - time dot svg yeah hey there you go and
142:49 - just put the alt can be time all right
142:52 - so those are all the table headers the
142:54 - number the title plays and the timer
142:56 - looks pretty good now after
142:59 - that
142:59 - we can go next on the tea body and we'll
143:02 - need another tea body okay this is just
143:05 - a spacer so let's give this a class name
143:07 - of dash six
143:09 - block and then the next line
143:12 - here we're gonna map through the songs
143:14 - and for every song we should make a
143:16 - table
143:17 - row table row is just going to be
143:19 - another component that we make so let's
143:22 - save this for now
143:24 - then we can make the component and say
143:26 - table row okay now we have table row r a
143:28 - c e save come back to playlist and now
143:33 - that's the import we're missing table
143:35 - row and we can insert one right about
143:39 - here table pro cool all right looking
143:42 - good to me now before i move on let's do
143:45 - table row and style this one first so
143:48 - that it all comes together so i'm set up
143:50 - the jsx oh and before i do we don't need
143:52 - this okay and for the jsx it's not going
143:56 - to be a div actually it's going to be
143:57 - another tr body so t or t body sorry did
144:01 - i do did i write tr body in the other
144:03 - one no i don't t body we're good so in
144:05 - that t body now it's going to have a tr
144:07 - right and each t r inside of it is going
144:10 - to have a th
144:12 - okay and in that th oh it's gonna have a
144:14 - class name of
144:16 - styles.th and again this doesn't exist
144:19 - yet so let's make the styles object and
144:21 - for now let's put zero here it's gonna
144:23 - be props index or like the index of the
144:26 - song and then the next line we'll have
144:28 - another t with the same class name
144:30 - styles.th and then within that it's
144:32 - going to have a div with p tag so i have
144:35 - a class name
144:36 - font bold i'm only i'm not going to give
144:38 - it a whole class name because it's just
144:40 - once and then we could just do a title
144:42 - here song title we get the class name
144:45 - equals opacity
144:47 - 50 and it's just gonna be the artist or
144:50 - a quote unquote artist this one's
144:53 - actually going to stay static since we
144:54 - don't have access to the artist when we
144:56 - store the song okay and then that next
144:58 - line after line 15 actually not after
145:00 - line 15 i lied after line 16 we want
145:03 - another th
145:04 - so this th class name same thing
145:08 - styles dot th and then inside of that th
145:12 - we'll have ten thousand it's supposed to
145:14 - be like the amount of plays which will
145:16 - be static as well
145:17 - then we can have one more same class
145:19 - name styles.ch
145:22 - and it's just to have however long the
145:24 - song is which is going to be 2 43 which
145:28 - again is static okay
145:30 - cool
145:31 - that should be it for table row let's
145:34 - just quickly style it that's going to
145:36 - have just the th class which will be
145:39 - pb-5
145:41 - and a hover effect of opacity dash 50
145:44 - and a cursor
145:46 - pointer okay cool all right so what i
145:49 - want to do next is head over back to
145:50 - playlist and now that i'm back in
145:52 - playlist let's go ahead and style that
145:54 - table so it looks a little nicer table
145:56 - all right it's this one let's do a table
145:58 - wrapper first actually so table wrapper
146:00 - is going to have a max width of 7
146:04 - xl and m dash of p
146:07 - 3
146:08 - m t
146:09 - 5 and then m b of
146:12 - 40. okay cool all right so after the
146:15 - wrapper then we can do table and the
146:17 - table itself is going to have a width
146:19 - full and text left nice
146:21 - okay comma then we have table header
146:25 - which is just going to have a border
146:27 - dash b let's give it like a gray border
146:30 - there's like a light a slight line that
146:31 - comes in between each song and it should
146:34 - be border dash grade dash 100 divided by
146:36 - 20. then we do
146:38 - pb-5 here and an opacity of 50. hey
146:42 - that's it yeah table header nice again
146:46 - always looks a lot better when we do it
146:47 - like this that's the spotify here's the
146:49 - ten thousand plays and the time it's all
146:51 - lined up so now do you guys get what
146:54 - table row is for it's a component right
146:55 - for every song that i have i wanna map
146:58 - through each song and make a dynamic
147:01 - table row so this is like four songs
147:03 - okay
147:04 - so what we could do
147:06 - is think about where does
147:08 - think about where does playlist come
147:10 - from it's going to be
147:12 - through the home page so it looks like
147:14 - we need to get home page and we're going
147:16 - to need to pass something in the
147:18 - playlist so what we do is if we control
147:21 - b take a look at this data folder this
147:23 - comes with it with our awesome cli tool
147:25 - you're going to see activities which is
147:26 - basically all the songs you hear see
147:28 - here with snoop dogg and travis scott
147:30 - but there's songs js which i already set
147:33 - up i already set up a couple songs that
147:36 - we could test out so these are static
147:37 - songs so we can import this
147:39 - in our home page i'm gonna i use this
147:42 - just to test out the player and before i
147:44 - fetch the songs itself so
147:47 - let's import it temporarily import songs
147:49 - from
147:50 - data slash
147:52 - songs and if that's console log songs
147:54 - while we're here on to log songs songs
147:56 - are here so it's really noticeable click
147:58 - expect element console
148:01 - this should just be in curly brackets
148:03 - import songs from data dot songs now
148:06 - let's check this spect a array of two
148:09 - songs okay that's a good sign so now
148:10 - that we got the songs this is supposed
148:12 - to simulate us fetching the songs from
148:14 - the smart contract but we're using just
148:17 - dummy data for now and it's going to be
148:19 - imported as songs alright it's the same
148:21 - as this all right so let's comment this
148:23 - out for now so you don't get confused
148:24 - but we're going to be using this later
148:26 - but for now we'll use this so when put
148:29 - in playlists let's pass down songs as
148:31 - songs yeah and let's go back to playlist
148:35 - now we can destructure it songs and now
148:38 - if i inspect element let's hit console
148:41 - we can actually inspect the array and
148:42 - say
148:43 - okay so this has an index a title the
148:46 - artiste and let's see it has blink plays
148:50 - cool awesome has all the attributes of
148:52 - that song but one thing to note when i
148:54 - actually fetch the music the songs won't
148:57 - have all of this it'll just have the
148:59 - title or like the name and we'll also
149:02 - just have the url this cloud and
149:04 - everything it won't have index or well
149:06 - it won't have plays or anything like
149:08 - that so the rest of that static but we
149:10 - can make just simulate what that look
149:12 - like by doing
149:13 - songs.title our song is that index side
149:15 - right this way oh i know that's not here
149:18 - this should still be title what i want
149:20 - to do is go to table row and past nine
149:22 - songs so let's pass down songs on this
149:24 - first one and let's say songs is going
149:26 - to be songs and in table
149:30 - row can we get the table row destructure
149:32 - this again songs now we can do it so we
149:35 - can say
149:36 - songs dot index then we can also say
149:40 - songs
149:41 - that title and if you remember the
149:43 - console log this is actually really
149:44 - funny there's a typo it's songs that
149:46 - artiste all right this should also be
149:49 - songs dot plays
149:52 - and songs dot
149:54 - time let me see i already forgot okay
149:57 - song is that
149:58 - song undefined reading index so that's
150:00 - interesting so let me just undo all of
150:02 - that it doesn't know what index is
150:04 - okay let's just cancel out songs on
150:06 - table row oh i see i see so let's put
150:08 - that all back actually so just to show
150:10 - you what i mean if i can songs here we
150:12 - should see the same oh yeah so we should
150:14 - see an array but the reason why we see
150:16 - undefined is because i have table rows
150:20 - without songs so let's take those out
150:21 - for a moment all right now i should be
150:24 - able to just write them all out songs
150:26 - dot index one thing to keep in mind
150:29 - actually this is what i'm passing down
150:31 - is an array right songs is an array and
150:34 - if i just pass it down as an array it's
150:36 - going to be much harder to map through
150:38 - it so this is where i was saying earlier
150:40 - where we're going to have to map through
150:42 - each song so if i write song all right
150:43 - that's the array and if i do a map i'm
150:45 - going to iterate through right now the
150:48 - key here is if i write song and i don't
150:50 - even have to do this but i can console
150:51 - log song so what am i console logging
150:54 - here so this should make more sense to
150:55 - you so in playlist i take the songs map
150:58 - through it for every song console log it
151:00 - so what should i end up seeing
151:02 - refresh here is two
151:04 - objects and i see it twice but i see two
151:07 - objects right the first song and the
151:09 - second song because for every song and
151:11 - there's two it will cancel it so that's
151:13 - why i see it twice
151:14 - and what i want to do is return a table
151:17 - row
151:18 - right with the key being the song and
151:22 - the
151:23 - song info being the song and i'm trying
151:26 - to think of it now once i
151:28 - pass that once i pass down the dynamic
151:31 - props we're going to change this up but
151:33 - for now with the static props this makes
151:34 - more sense i'll hit save table row now i
151:37 - should be able to accept song and let's
151:39 - see if i can console log it it should be
151:42 - the object itself yep two objects and
151:44 - table row
151:45 - and now if i do
151:47 - song
151:48 - dot index look at that one and two what
151:50 - about title change title now song dot
151:53 - title hey there you go i want the artist
151:56 - i remember this one has a typo song that
151:58 - artiste hey okay all right and then you
152:01 - tell me what should i write here song
152:03 - that plays okay and then here
152:06 - song dot
152:07 - song time nope let me just double check
152:10 - that's what happens when you get the
152:11 - object key wrong
152:13 - ah song length makes sense hit save oops
152:16 - not there save here hey there we go guys
152:19 - so now we just made dynamic components
152:22 - using static data so this is what
152:23 - spotify would look like all right one
152:26 - thing to note uh the way that we saved
152:28 - it in the smart contract simplified
152:30 - meaning
152:31 - we won't have the artist name so there
152:34 - won't be and it's going to be a static
152:36 - artist the plays will be static and the
152:38 - time will also be static the only thing
152:40 - that's different is going to be this
152:42 - music title which we can will provide
152:44 - awesome so that's how we can set up the
152:47 - music all that's left now is to fetch
152:49 - all the songs and create one are you
152:50 - guys excited i know i am we're almost
152:53 - done with the project okay
152:55 - so the last thing that we're going to
152:56 - need to do in terms of front end is i
152:58 - want to make the little player that goes
153:00 - so if i click this it's going to play
153:02 - that song okay
153:04 - so let's head over to home page and
153:07 - that's going to be under player controls
153:10 - so let's just even out the space again
153:12 - and uncomment this out and create that
153:14 - component so in the components folder
153:16 - playercontrols.js
153:19 - r-a-f-c-e save and let's import him at
153:23 - the top import player control yep there
153:26 - it is cool so let's get to work on this
153:28 - okay so with player controls obviously
153:31 - it's the player that allows us to play
153:33 - the music we want and there's a lot of
153:35 - functionality because we have to be able
153:36 - to pause the music play the music skip
153:39 - the music and i'll get more into that as
153:41 - i write out the functionality but the
153:43 - main thing that we should do first is
153:45 - import a couple different things so
153:47 - let's import image from
153:50 - next image let's also import the actual
153:54 - image themselves as a name so let's
153:55 - import next from the forward slash
153:58 - assets slash next dot svg and again you
154:02 - should have all these images if you used
154:03 - our cli tool okay then previous from
154:07 - data forward slash assets slash speaker
154:10 - dot svg import
154:13 - speaker from
154:15 - assets slash speaker right it's pretty
154:17 - redundant but you know right this
154:19 - shouldn't be speaker it should be
154:21 - previous okay so you're basically
154:22 - importing the name of the image
154:25 - from that path so import repeat
154:29 - from repeat all right you get the idea
154:32 - we only have a couple more let's do
154:33 - shuffle from the same place assets
154:36 - shuffle play
154:38 - rounded you can do play
154:41 - rounded and then import uh pause
154:45 - icon from assets slash pause.svg okay
154:49 - cool
154:50 - so those are all the images
154:52 - cool now let's just work on writing the
154:54 - jsx what we'll do is set up the styles
154:57 - object clone styles and let's format
155:00 - this okay
155:02 - so for the class name of this first div
155:04 - i'm going to go with the name of main
155:06 - control and then from there we could do
155:09 - class styles dot flex center okay and
155:13 - then within flex center there's another
155:15 - div last name
155:17 - styles dot i'll
155:19 - cover
155:20 - container okay and then from there we
155:23 - can have an image
155:24 - and that image is going to have a source
155:27 - and i have the link for this you guys
155:28 - it's going to be it's going to be this
155:31 - really long thing here and if i hit save
155:33 - i can't save it yet because i'm going to
155:35 - do the height and width the height shall
155:38 - be 200 while the width will be 200 as
155:41 - well let's give it a halt and it's just
155:43 - like a song hit save hey that's our cp
155:47 - logo that's basically what it is that's
155:49 - going to be our album cover okay then
155:51 - it's a closing div followed by an
155:54 - opening this one doesn't have a name but
155:56 - inside of it it's gonna have two p tags
155:58 - with the
155:59 - song
156:00 - current
156:01 - song it's gonna be static for now it'll
156:03 - be dynamic later then another p tag oops
156:06 - another one and this will have the class
156:09 - name of
156:11 - opacity right because there's only one
156:12 - styling on this opacity oh is it because
156:16 - of the backticks don't worry okay and
156:18 - it's just gonna say harvest all right
156:20 - this is static once so that should be
156:22 - closing div closing div followed by
156:24 - another one with no name and then the
156:26 - div inside of that does have a name it's
156:28 - gonna be class name
156:31 - styles dot control icon container and
156:35 - then within that will be a div with the
156:37 - name control icon okay after control
156:40 - icon we can insert this image here and
156:43 - it's just going to have a source
156:45 - of shuffle so the cool part is i could
156:48 - just do source shuffle because we
156:50 - imported it like that and i'll hit save
156:52 - might be hard to see but it's there it's
156:54 - gonna like come off the page but don't
156:56 - worry it's gonna be fixed when i add the
156:58 - styling okay cool so that's the div for
157:01 - that
157:02 - closing div and then hit enter and for
157:04 - line 36 another div it's gonna also be
157:07 - styles dot control icon and it's also
157:11 - gonna have an image with the source of
157:14 - previous which is another image we
157:16 - imported
157:17 - awesome cool
157:19 - all right so i think from here let's add
157:20 - the rest of the images i want to do
157:22 - another div with the control icon again
157:25 - styles.control icon pretty much the same
157:27 - process except this one will be the
157:29 - repeat one
157:31 - awesome all right i think i'm just gonna
157:32 - make this faster by making another one
157:34 - and this should go above before repeat
157:36 - should actually be so make sure you make
157:38 - that change real quick so it should go
157:40 - shuffle previous next repeat yep there
157:42 - you go i like that and after repeat it
157:45 - should be closing div
157:48 - closing div
157:49 - and then
157:51 - another dip okay and that will have the
157:53 - class name of styles dot flex
157:57 - center and then it's gonna have a small
157:59 - right here and this could be a timestamp
158:01 - i'm just gonna say like something random
158:03 - like 130. all right it's gonna be static
158:05 - cool there's gonna be an input here this
158:08 - is really cool like javascript has like
158:10 - the audio tags that you can use to play
158:12 - music and we're going to make use of
158:14 - that
158:15 - right here so let's do
158:16 - value is equal to actually we won't do
158:19 - value yet it doesn't make sense to do it
158:20 - now but we can say type is equal to
158:22 - range though right and then we can say
158:24 - class name is equal to
158:26 - styles so we'll come back to in this
158:28 - input in a second yes so there's the
158:30 - little bar right that's how you can do
158:31 - it you can do it with the input if you
158:33 - guys didn't know okay self closing then
158:36 - there's gonna be a small here which is
158:38 - just gonna be the total length of the
158:40 - song which like i said will be
158:42 - static yep you can see how we're gonna
158:44 - move everything over into a row and
158:46 - format it so then after the small goes
158:48 - closing div closing div enter in line 57
158:52 - we have another div for spacing and then
158:54 - we have div with the class name the div
158:57 - with the class name is going to be
158:58 - styles.flexcenter again and it's going
159:01 - to be an image
159:02 - with the source of the only one we
159:04 - didn't use i believe is speaker and the
159:06 - alt is equal to speaker and the input or
159:10 - another input here it's going to be
159:12 - value equals
159:14 - volume which you don't have yet so i'm
159:16 - going to hold off but the type again
159:18 - should be range right this is the how
159:19 - loud the music should go so we're
159:21 - getting another range type all right but
159:23 - the id we're gonna give this an id
159:24 - though and the id will equal
159:28 - volume
159:30 - and after that should be three closing
159:31 - dips hit save there we go there it is
159:34 - there's our beautiful speaker right here
159:36 - okay as you can see like the skeleton of
159:38 - it's right but all set up we just need
159:41 - to style it all right let's get to
159:42 - styling in the styles object i'm just
159:44 - going to do album cover container and
159:47 - we'll do a width and height 20 and a
159:49 - mr-3 nice we do we can style the main
159:53 - control next and for main control
159:56 - let's do a fixed bottom i always want
159:59 - this player to be at the bottom
160:01 - zero left
160:03 - zero
160:04 - p y
160:05 - of three let's see we need a p
160:08 - five
160:09 - p r dash ten w dash screen and let's
160:13 - give it a background color is gonna be
160:15 - hash tag
160:16 - two
160:18 - four
160:19 - two four two four so just three two
160:22 - fours that's confusing but z
160:24 - 40 give it a flex and items dash center
160:27 - okay we're getting somewhere and justify
160:30 - dash between let me i'll see this so you
160:32 - guys can see that better how's that for
160:34 - my pause people yeah nice so now that
160:38 - play oh main control is there let's do
160:40 - flex center that's gonna be exactly what
160:43 - it sounds like it's gonna be flex items
160:45 - dash center
160:47 - okay and let's do control icon that's
160:50 - definitely there don't forget the comma
160:52 - and then in control icon it's going to
160:54 - be a margin
160:56 - five cursor dash pointer a nice hover
160:59 - effect of opacity dash 100 and just a
161:03 - normal opacity of 50. okay cool now
161:06 - let's do the play icon or actually let's
161:09 - do the container right because i want to
161:11 - make those icons all come together so
161:12 - let's do control icons container now
161:15 - give it a flex where is my control
161:16 - icon's container control icons container
161:19 - hey there we go so that added the s so
161:22 - what i did was go to the jsx add a s to
161:24 - icons container and then it should match
161:26 - up so now that i gave it a flex
161:29 - let's center it like this okay it's
161:30 - already pretty centered let's do a
161:32 - justify center we'll just we'll see this
161:33 - change yep and let's do m b two nice
161:38 - okay all right so we did a control icon
161:40 - but let's do the play icon and the play
161:42 - icon will be mr.5 with dash 10 cursor
161:46 - dash pointer and hover opacity dash 50.
161:52 - then we need the pause icon
161:54 - so where is the pious icon okay and i
161:56 - just double checked there is gonna be a
161:58 - play icon and a pause icon it's just
162:00 - that they don't exist yet but since
162:01 - we're styling i'm just gonna set it up
162:03 - now okay so for the pause icon and it's
162:05 - gonna be called pause icon style
162:07 - actually it's gonna have an
162:09 - mt-3 w-10 h 10 cursor dash pointer
162:14 - opacity dash 50. there you go and you're
162:18 - not going to see this change because
162:19 - there is no pause icon style and
162:21 - remember that cover photo that i erased
162:23 - there actually is going to be a photo i
162:25 - just double checked on the finished
162:27 - build the cover photo is going to have
162:29 - object cover all right so the last view
162:32 - if i organize it this way it doesn't
162:33 - exist just yet but later on when i add
162:36 - functionality it'll make more sense
162:38 - let's get back to our app let's log in
162:40 - cool and if you look at it full screen
162:42 - this is what it looks like a lot closer
162:43 - to the player now but with that done
162:46 - that is essentially the front end for
162:48 - player controls all right this is where
162:50 - we haven't used pause icon and play
162:51 - around yet but once i make the context
162:54 - and the functionality we'll come back
162:56 - and add it alright so as you can see we
162:58 - have the player right here but there's
163:01 - no functionality and i could write all
163:04 - the functions in player controls but
163:06 - that would make player controls
163:08 - essentially really long it's already 79
163:10 - lines of code all right and if i want to
163:12 - make it so i can call these functions
163:14 - from anywhere we're going to be using
163:16 - the context api so i showed you guys how
163:18 - to pass down data through props but you
163:20 - could also use react's contacts api to
163:23 - access data from anywhere so let's go
163:25 - ahead and do that again this is mainly
163:27 - like a functionality thing so let's set
163:30 - up context through here so in our
163:32 - context folder let's make a new file and
163:34 - we'll call it context.js
163:36 - right here all the functions of the
163:39 - player will live which means pause
163:42 - play skip click and any states that we
163:45 - want to keep track of what is the
163:46 - current song playing our react app
163:48 - should our next app should know rather
163:51 - cool so we're going to need to do is
163:53 - import to use the context api we need in
163:56 - the context.js we need to import create
163:59 - on text also we need use state and we'll
164:03 - also need use effect it's all going to
164:06 - come from react okay cool and that's the
164:09 - only import it's going to take but we do
164:12 - need to is export const spotify context
164:16 - and set that equal to the create context
164:19 - hook so we can say
164:20 - equal to create context and then we can
164:23 - do an export const spotify
164:26 - provider it sounds really cool that i
164:28 - don't have to pass things down through
164:29 - props if i have it in context but in
164:32 - order to do we need to wrap our whole
164:33 - next.js app inside the provider set the
164:36 - provider equal to parentheses and it's
164:39 - going to take in children and here we'll
164:42 - do the arrow function and that should be
164:44 - it for now the next the next thing
164:45 - that's important is going to be this
164:47 - return right here
164:49 - okay it doesn't need those parentheses
164:50 - but this return does need to return
164:53 - spotify context dot provider and if i
164:58 - close this off it should look like this
165:00 - and just to show you guys in between the
165:02 - provider this is where the children will
165:04 - go the key thing all right if i format
165:07 - it now this is the same thing just
165:08 - formatted key thing
165:10 - is within the provider though if i hit
165:12 - enter not erase it hit enter boom i want
165:16 - to add a attribute of the provider and
165:19 - it's going to be value whatever i put in
165:22 - value right here is going to be global
165:24 - meaning i can call it from anywhere just
165:26 - like in player control so if i say
165:28 - something like i don't know song
165:31 - right in player controls if i put my
165:34 - context and use it i can grab songs from
165:36 - there if i set it up here so let's leave
165:38 - it blank for now and it starts to make
165:40 - sense once i create some state variables
165:42 - for you guys but that's what you want to
165:44 - set up and it should be like curly
165:45 - bracket like this perfect awesome so the
165:48 - spotify provider is done we're gonna
165:50 - need to hop into the app and wrap it
165:53 - there underscore app so we should be
165:55 - here back in underscore app and you can
165:57 - see we have the wallet connection
165:58 - provider what we want to do now is come
166:01 - below this required they import the
166:04 - spotify provider and you can see the
166:06 - suggestion from our contacts folder okay
166:10 - and what we want to do is the same thing
166:12 - like we did here within the wallet
166:13 - connection we'll say spotify provider
166:16 - and in between the spotify provider
166:18 - we'll put the app so you can see the
166:21 - provider wraps this which wraps this app
166:24 - is within all of that so if you do this
166:27 - we can utilize use context understand
166:31 - cool so now we can start fleshing out
166:33 - our context.js
166:35 - okay so the first thing i'll do is set
166:37 - up a couple states here so let's say
166:38 - const array equals each state and
166:41 - there's a lot of states that we want to
166:43 - keep track of there's about three six so
166:46 - let's make six
166:47 - copy paste three four five six okay what
166:51 - i'll do next is explain what the purpose
166:53 - of each variable is as i go this first
166:56 - one is going to be called the current
166:57 - song it's self-explanatory i want to
166:59 - keep track of what is the current song
167:02 - that is playing so we're going to say
167:04 - current song for this and the initial
167:07 - state of current song should be an empty
167:09 - object because each song is going to be
167:11 - held in an object next i want to have
167:13 - state variable called is plane this is
167:15 - like the toggle or the flag that checks
167:17 - if something is playing like the show
167:20 - music upload music model is playing is
167:23 - going to be true or false so that's
167:25 - going to be set as false right so is
167:27 - something playing right now by default
167:29 - no nothing should be playing unless you
167:30 - want to set it to autoplay which you
167:32 - would then set the initial safe to true
167:34 - okay from there we could do is paused
167:36 - right that's another state we want to
167:38 - keep that set is right what should be
167:40 - the initial state now i'm giving it to
167:42 - you yep false okay
167:44 - cool so now there's another state called
167:46 - progress set progress is literally what
167:49 - it sounds like keeps track of the
167:51 - progress which we'll set to false
167:53 - they're essentially all flags that we
167:54 - want to mess around with we have volume
167:56 - here and it's going to be set volume
167:58 - default of that will be false as well
168:00 - all right so moving right along okay
168:01 - then we got time stamp uh not all of
168:04 - these might be used depending on what we
168:06 - have set up but i'll do this timestamp
168:09 - and this will be false as well okay cool
168:12 - all right so now that we have our states
168:13 - set up let's set up our player function
168:17 - so when thinking about our player
168:19 - functions the first thing i can think of
168:21 - is const pause right that's a function
168:23 - right so how do we implement pause
168:25 - functionality to our hacked what we
168:27 - could do is something like this set his
168:30 - pause is equal to true because if pause
168:33 - is true then it should be paused
168:35 - self-explanatory yeah but then how do we
168:37 - actually pause
168:38 - the player like i said javascript has a
168:41 - lot of that functionality set up we just
168:43 - have to call on what we need to do is a
168:45 - document dot query
168:48 - selector and then do quotes hashtag
168:51 - audioelement and it should grab that
168:54 - player and if we do a dot pause here it
168:56 - will pause the player okay
168:58 - and essentially this is just to keep
169:00 - track of the state if it is paused or
169:02 - not this is actually pausing
169:05 - so that's the pause how about play we
169:07 - want to make a function for play too so
169:09 - we can play music what we can do is
169:11 - document dot query selector again and
169:14 - how do we grab the audio element you
169:16 - just say
169:18 - audio then play right pretty simple i
169:21 - personally don't use this that much i
169:22 - learned this recently right that you
169:24 - could do all this with javascript so set
169:26 - is pause is false cool
169:28 - now this is the fun function it's called
169:30 - cons play on select and it's going to
169:33 - take in our first parameter which is a
169:35 - song and let me explain play on select
169:38 - real quick if you go back to our app log
169:40 - in if i were to click this song right
169:42 - here radiant vibes it should be playing
169:44 - that song so this it was really running
169:46 - as play on select okay so that's what's
169:49 - happening play on select is going to run
169:50 - a try catch
169:52 - block right you know what this is and
169:54 - it's just gonna be e and it shouldn't
169:55 - really be an error so for now we could
169:57 - just console. but in the try block
169:59 - though we can run document query
170:01 - selector once again document.query
170:04 - selector and let's get the audio element
170:07 - and we could say that source
170:10 - equal to
170:11 - song dot music url because that's going
170:14 - to be the music our url of the song
170:18 - object that we pass in i'm setting the
170:20 - source of the audio element to that
170:22 - alright that's what it means from there
170:24 - we also want to do a query selector
170:26 - right because after we set the song to
170:29 - the player we want to be playing the
170:31 - songs and you guys know how to play the
170:32 - song now all you got to do is this
170:35 - dot play okay and then after we start
170:38 - playing the song we can do a set current
170:41 - song to the song that we pass in makes
170:44 - sense and if we're playing a song set is
170:47 - paused should actually be false and i
170:49 - think that's it all right that's the
170:51 - play on select so another function i
170:53 - want to make if you look at our app once
170:55 - again is as the song plays we wanna be
170:58 - updating the progress so in order to do
171:02 - that we're going to need to make a
171:03 - function that converts seconds to
171:07 - minutes seconds to min right then we can
171:09 - say equals arrow function and it's going
171:12 - to take in a value all right this is
171:13 - actually an interview question how can
171:15 - we convert minutes to seconds if we do
171:17 - const minute is equal to math.round
171:20 - right whatever the value is divided by
171:22 - 60. so if it's if some how many seconds
171:26 - are in a minute right there is 60
171:29 - seconds
171:30 - in every minute so we could divide that
171:32 - value by 60 to get the minute then we
171:34 - could also say let second equal math
171:37 - that round that value and get the
171:41 - modulus operator get 60 and from there
171:44 - we can say a second is going to be equal
171:47 - second right greater than or equal to 10
171:50 - all right and all this is a ternary if
171:52 - the second is greater than or equal to
171:54 - 10 then we want to
171:56 - zero
171:57 - plus second then after that we can just
171:59 - return the minute right plus the second
172:03 - okay
172:04 - this should be in quotes there we go
172:06 - right because i don't want to update it
172:07 - every second it should just be like an
172:09 - increment then we can also update that
172:12 - progress right you have to make a whole
172:13 - separate function for that so this is
172:15 - going to be e it's going to take e
172:18 - and essentially we can do const
172:20 - underscore progress
172:21 - is equal to e dot target current time
172:25 - right slash e dot target dot duration
172:30 - and then we can do a set progress right
172:32 - that's another state to underscore
172:35 - progress dot to fixed 2 but basically
172:39 - set it to two decimal places and then
172:41 - times that by 100 to get the type of
172:44 - number we want cool so that's how you
172:46 - update progress next we want to do
172:48 - update the volume to change the volume
172:51 - we can do
172:52 - once again and with e it's going to be a
172:54 - try catch with the catch being eagen and
172:58 - for the catch i'll just do console.log e
173:00 - dot message
173:01 - cool so in the try the main part let's
173:04 - set the volume to a target type value
173:08 - and then we can get the query selector
173:11 - of the audio element and then to access
173:15 - the volume of that audio element it's
173:16 - just dot volume or dot volume yeah and
173:19 - we want to set it to
173:21 - equal p dot target already so
173:24 - essentially whenever i change it we're
173:25 - gonna update the audio volume to
173:27 - whatever
173:28 - range i click okay
173:30 - next we're gonna need another function
173:32 - const on progress change set this guy
173:36 - equal to e arrow then we can say cons
173:38 - underscore volume set that equal to e
173:41 - dot target dot value slash level 100 and
173:45 - then we can do document query selector
173:48 - once again pass in the audio then we can
173:51 - do current time and set that equal to
173:54 - underscore
173:55 - progress
173:57 - times the document
173:59 - query selector we want to get the
174:01 - duration here so to do that i have to
174:03 - write this whole thing out it's hashtag
174:06 - audioelement let's do an alt c cool
174:08 - audio element dot duration there's the
174:11 - duration all right so the progress times
174:13 - the duration is the should be the new
174:16 - current time okay so that's on progress
174:18 - change and we also need on volume change
174:21 - on volume same deal e arrow logic so
174:26 - again const volume all right this is
174:28 - actually this doesn't make sense it
174:29 - should be progress and this one should
174:31 - be const volume and that's going to be
174:34 - equal to he.target
174:36 - value divided by 100 and document.query
174:40 - selector let's grab our favorite element
174:44 - and let's get the volume by saying
174:46 - volume and setting that equal to the new
174:50 - volume all these functions are going to
174:52 - come together okay the next thing if you
174:54 - look if i request this it should play
174:56 - the next song in the array so that's
174:59 - going to be called a const play next
175:01 - it's actually fairly simple it's going
175:03 - to take in the songs and then we can say
175:05 - const id is equal to songs dot find
175:09 - index again there's actually multiple
175:10 - ways to do this right so if you come up
175:12 - with a way that's more efficient than
175:14 - mine i'd love to you guys to share it in
175:15 - the comments below you can do a value
175:18 - here value.account equal equal to the
175:21 - current
175:22 - song okay so that's the id and then if
175:25 - if the id of the current song as long as
175:28 - that length equal to i d plus one what
175:32 - should happen is we should go back to
175:35 - the beginning all right so basically if
175:36 - we're at the end it's the last song and
175:38 - i hit next
175:40 - right this is a check right here and it
175:42 - should reset it back to the first song
175:44 - so we can do a play on select here
175:47 - remember play on select is the function
175:49 - that will play a song that we pass in
175:51 - we're using that here so play on select
175:53 - the songs and the first song of the
175:55 - array is songs bracket zero dot account
175:57 - okay and then we can set the current
175:59 - song to the same thing so songs bracket
176:01 - zero yay okay and then we can just
176:04 - return to just exit but if it's not the
176:07 - last song it should just play the next
176:08 - song so how do we get the next song the
176:10 - bracket zero is the first song right we
176:12 - can play the next song really easily so
176:14 - you can say khan's next song is equal to
176:17 - songs
176:18 - bracket id plus one right that's
176:21 - literally incrementing the index to the
176:23 - next one and from there we can just do a
176:25 - play on select and do the next song
176:28 - account next song dot okay beautiful
176:31 - that wasn't so bad so that's the con to
176:33 - play next and now for the play previous
176:36 - right same kind of logic i could set
176:38 - that to songs and the array here and
176:42 - from there let's write const id equal to
176:46 - songs that find index right same thing
176:48 - value dot account is equal to current
176:51 - okay so now basically if this the id
176:55 - is equal to zero meaning we're at the
176:57 - we're at the very first song at the rear
176:59 - a right what should happen if i go back
177:02 - and it's the first song it should go to
177:04 - the last song in the ray right so if it
177:06 - wants to go on the last song we can do a
177:08 - play on select use that function and we
177:10 - can do songs and this is cool so how do
177:12 - you get the last item in the array you
177:14 - can just do songs dot length
177:17 - minus one that will guarantee always
177:19 - give you the last item in the array so
177:21 - after you got the last item in the array
177:23 - you can do that account okay and then
177:25 - set the current song to the same thing
177:27 - which i'll just copy perfect and then
177:29 - return but that's if it's the last of
177:31 - the first song but if it's just not the
177:34 - first song maybe it's the song in the
177:35 - middle or it is already the last song if
177:37 - you do previous song equals songs id and
177:41 - then how do we go back if we know how to
177:43 - go forward it's just minus one and then
177:45 - we can just do a play on select with
177:47 - previous
177:48 - song dot account you got it so let's
177:52 - play previous and
177:54 - yeah that's actually all the functions
177:56 - nice okay cool so that's all the
177:58 - functions we could do next is go to
178:01 - value and just pass in everything we
178:03 - need so there's a lot to pass in we did
178:05 - we just typed a lot so if you need to go
178:07 - back at all feel free to rewind and
178:09 - pause to get what you missed so we'll
178:11 - need to pass in is playing set is
178:14 - playing
178:15 - current song set current song is paused
178:19 - set is paused right we're passing all of
178:21 - the states play function pause function
178:24 - the update progress one the play
178:28 - on select
178:29 - on progress change on
178:32 - volume change on play next yep you also
178:36 - need play
178:38 - previous you can get timestamp you can
178:41 - get update volume i think we're almost
178:44 - done we have volume and last but not
178:46 - least oh yeah that was it so that's it
178:49 - right there once i pass that in my
178:51 - provider all of that will be global and
178:54 - again whenever i use it somewhere else
178:56 - we don't need to bring in everything
178:57 - just the ones we need so
178:59 - let's hit save and let's figure out
179:01 - where we're going to need this context
179:03 - but what that's all the context.js
179:05 - alrighty so with our context set up
179:08 - let's start using our context in all the
179:11 - places that we need so the first place i
179:13 - want to think of is index.js there is an
179:16 - audio right here and as you can see
179:19 - we have on volume change and on time
179:21 - update but
179:23 - where do we even get those functions
179:24 - from yeah so to get those functions
179:27 - we're going to import
179:28 - use context so let's import these
179:31 - contexts from react and if we import
179:34 - that hook we can then import spotify
179:36 - context so import spotify context and
179:39 - now we can use it right so this update
179:42 - volume and this update progress they can
179:45 - exist
179:46 - if
179:47 - i say const update
179:49 - progress
179:51 - and update and we can set that to use
179:54 - context and then to pass to use spotify
179:56 - context just pass it in here and now we
179:59 - have update progress and update volume
180:01 - and then they exist so we should be able
180:02 - to do that now let me hit save now the
180:04 - next place i can think of where we're
180:06 - going to use context is probably the
180:08 - header let's do a header and at the top
180:11 - of header like i just said we're going
180:13 - to import use context
180:16 - again not that one react and import
180:19 - spotify context okay
180:21 - and the only thing that we're going to
180:23 - need from the header is the current song
180:26 - so how do we just get current song from
180:28 - use context or spotify context you can
180:31 - just destructure it and say i use state
180:33 - to use context pass this in and say
180:36 - current song
180:38 - all ready then what we could do is not
180:41 - that
180:42 - go to
180:43 - where does it say album oh it's right
180:45 - here
180:46 - album where it says current song
180:49 - right now that we actually have it we
180:50 - can just say current song dot album so
180:53 - now it's all coming together the pieces
180:55 - were set up okay
180:57 - that's it for header let's see
180:59 - player controls is probably what's next
181:02 - let's go to player controls yeah this
181:04 - one's to need a lot so prepare for this
181:06 - one let's set up the player controls at
181:09 - the top we're going to need to import
181:12 - our hooks use
181:14 - context
181:15 - from react and then import spotify next
181:20 - then in here
181:21 - it's going to take in a couple things
181:23 - all right so like i was saying we're
181:25 - going to import a couple things to our
181:27 - player controls so let's just set up
181:29 - that object is equal to use context and
181:33 - in order to get stuff from our spotify
181:35 - context we have to pass in spotify
181:38 - contacts okay cool so i'm just gonna hit
181:40 - enter right here so now i can format it
181:42 - to list out a bunch of different things
181:44 - so what i'm gonna get is
181:46 - current song we're going to need
181:49 - is playing essentially we're going to
181:51 - take everything from the spotify context
181:53 - to use here volume on change
181:57 - on volume change sorry time stamp
182:00 - progress
182:01 - see play next we got play previous
182:04 - pervious
182:05 - previous we have
182:08 - is paused we have play
182:11 - pause
182:12 - and of course on
182:14 - on progress
182:16 - change
182:17 - and that should be it awesome so that
182:19 - was a lot of things that's essentially
182:21 - everything we wrote in the context
182:24 - right minus a couple things so you get
182:27 - started right away by using one of them
182:28 - i want to start using is playing and if
182:30 - you remember the initial state of is
182:32 - playing is false and it will become true
182:35 - when we play something so let me just
182:38 - show you what i mean
182:39 - if you open this up again select wallet
182:42 - log in we can see the player down below
182:46 - but we can set up a condition at the top
182:48 - here
182:49 - that essentially says if
182:51 - is playing all right if this
182:53 - it doesn't exist we're gonna return
182:56 - no okay and so you see it was gone and
182:59 - that's because if this is false we're
183:02 - gonna return no and you wouldn't see the
183:03 - player but don't worry i'll come back up
183:05 - when i hook up the front end so that
183:07 - when i click it it starts to play
183:09 - alrighty
183:10 - okay so we also have a variable called
183:13 - current song which is again a state that
183:15 - we kept track of that is going to
183:18 - represent what is the current song that
183:20 - it's on or playing so what we could do
183:23 - is set it up so we can just write
183:25 - current song so we could say current
183:28 - song
183:29 - dot title
183:31 - i'll hit save and let it refresh all
183:33 - right if we just comment this out so we
183:35 - don't see any title here that's because
183:38 - what's the initial state of current song
183:39 - empty object well again once we hook up
183:42 - the rest of it if i were to click this
183:45 - then it would take up that title okay so
183:48 - for now let me just comment this back in
183:50 - okay so looking at the top here the next
183:52 - thing i want to work on is volume and
183:54 - volume we could put inside of
183:57 - whereas it says speaker there you go
183:59 - cool so input
184:01 - right if you remember there's this
184:03 - little thing right here and you can't
184:05 - really see it because of the size of
184:06 - this but this is the volume right we
184:09 - should want to set that volume to a
184:11 - state so what we could do is say that
184:14 - the value of this range is going to
184:16 - equal
184:17 - volume okay that's not all we also want
184:19 - to do on change
184:21 - and on change we're going to have the e
184:24 - and we'll call on volume change so when
184:27 - there's a change in the range we're
184:29 - going to call on volume change okay
184:32 - see that should be it yep nice okay so
184:36 - the next one i want to do is timestamp
184:38 - so timestamp that's going to go
184:41 - somewhere over here let's find it aha so
184:44 - here is timestamp right here instead of
184:46 - 130 we're going to write just time stamp
184:50 - it's gonna be the timestamp of the song
184:53 - that it's on so if we're like one minute
184:55 - into the song that's gonna be the time
184:57 - stamp okay uh while we're here there's
184:59 - also a value that i wanna input right
185:01 - here and it's gonna be progress
185:05 - because we should see the progress bar
185:06 - go up so i'll put that as the volume the
185:09 - value okay and while we're here as well
185:12 - there's going to be an on change and
185:14 - that arm change is similar to volume
185:16 - right except this time it's going to be
185:19 - for
185:19 - on
185:20 - progress change
185:25 - all right
185:27 - yes awesome okay play next and play
185:30 - previous should be pretty obvious play
185:32 - next is going to be on the div with the
185:36 - one that has skip or next
185:38 - right here and always do is right on
185:41 - click on click and this right play
185:45 - next and pass in
185:47 - pass in songs and again uh songs doesn't
185:49 - exist just yet but once i set it up
185:51 - you're gonna understand what i mean oh
185:52 - and i just remembered as i was setting
185:54 - this up
185:55 - there needs to be a pause button so just
185:59 - let me show you what i mean before you
186:00 - comment this out for a second that's why
186:02 - i was looking funny there should be a
186:03 - pause button in between these two
186:05 - right so let's set that up
186:10 - all right so we could do is copy this
186:12 - paste it here instead say pause and say
186:16 - the alt is pause so now let's see what
186:19 - it takes that is
186:20 - okay let me just double check oh pause
186:23 - icon okay pause icon okay and this one
186:26 - that's the reason i left this blank is
186:28 - because there's actually a special thing
186:30 - that we could do here right what i want
186:32 - to do is say curly bracket right here
186:35 - and say is pause right that's the state
186:38 - right because when i pause something all
186:41 - right let me pause the icon so it stops
186:43 - yelling at me
186:44 - okay when i pause something i click this
186:47 - it should turn into the play icon
186:50 - yeah that makes sense so that's why i
186:52 - have it set up right here so what we
186:54 - could do is set up some conditional
186:56 - rendering to change that so we could say
186:58 - if let me just paste this out if is
187:00 - paused is true
187:02 - right if it is true what should what
187:04 - does it mean it means
187:06 - that we should have
187:08 - div
187:09 - class name oops
187:11 - [Music]
187:12 - with
187:13 - styles dot play icon and show
187:17 - we'll also add it on click here while
187:19 - we're here for the play button but more
187:21 - importantly it should have an image tag
187:24 - and that image tag should have the
187:25 - source of play
187:27 - rounded and an alt of quotes
187:31 - then have another closing div right here
187:34 - perfect and then try writing another
187:36 - ternary and to be honest this is
187:38 - actually not going to work what we do
187:40 - need is something like this except with
187:42 - the styles of pause icon style now it's
187:46 - coming together so if i say class name
187:48 - equal to
187:50 - styles dot play pause icon style add in
187:53 - on click to pause pause icon or website
187:57 - pause all right i think that's what it's
187:59 - called
188:00 - yep
188:01 - we can then
188:02 - image tag self close
188:04 - which has a source
188:06 - the pause icon
188:08 - and for the alt
188:10 - we can just say
188:12 - pause and then just close the div off
188:15 - we should be fine okay
188:17 - awesome look at that we got pause and
188:19 - play right so that's why we set it up
188:21 - later because now i could use this pause
188:22 - so that we can do conditional rendering
188:24 - all right now i just need oh i was in
188:27 - the middle of doing play previous right
188:29 - so this
188:30 - and line 63 for me for with the div that
188:33 - holds the previous image we want to make
188:34 - that clickable so if we make it
188:36 - clickable we can add it on click you can
188:38 - say e you can say play
188:41 - previous
188:43 - and pass in the songs array because the
188:46 - previous takes in an array and it's just
188:47 - gonna increment back so that is previous
188:51 - now let's take a look that everything is
188:53 - playing that's gonna be used here and
188:55 - bam there we go so that i know that was
188:57 - a lot but we used a lot of the
188:59 - functionality and gave this app a little
189:02 - bit of life all right cool then if i
189:04 - comment this out play pause play play
189:07 - plus awesome so that is it for player
189:09 - controls the next thing or next place
189:12 - that we want to use this is probably
189:13 - going to be in table row so with table
189:16 - row that if you remember that's going to
189:18 - hold all the songs
189:20 - and i want to be able to click the song
189:22 - and that's the song that's going to come
189:23 - up in the player so
189:25 - what function does that
189:26 - it's going to be play on select i
189:29 - believe so let's do import
189:31 - our use context so we can utilize it
189:34 - from react and then from there it's
189:36 - spotify context
189:41 - cool and coming at the top of table row
189:44 - we can now destructure what we want from
189:48 - you spotify or spotify context and we
189:51 - only need one thing and one thing only
189:53 - like i said it's play on select
189:56 - nice remember table row for every song
190:00 - in the array it's going to make a table
190:02 - row so there's two songs in the array so
190:04 - there's two table rows and the cool
190:06 - thing that we can do is on the tr right
190:09 - here we can add on click and essentially
190:11 - say to play
190:13 - on
190:14 - select
190:15 - and pass in song and i'll just play the
190:18 - song object so that's perfect everything
190:20 - that we did before is set up this fits
190:22 - in nicely okay
190:24 - all right so that should be it with
190:25 - updating all of our components with use
190:28 - context one thing i want to do real
190:31 - quick is come to the home page
190:33 - and for player controls it should also
190:36 - be taking in songs
190:38 - all right remember songs is the array of
190:40 - songs that we get uh right now it's
190:42 - static or the static two songs that we
190:44 - have and then from there go to player
190:46 - controls then we can destructure songs
190:50 - and now when i type in songs this does
190:53 - exist now so this should make more sense
190:55 - so it's going to play the previous songs
190:57 - from the array that we're passing in and
190:59 - play the next songs from the either way
191:00 - we're passing it perfect okay so i'm
191:03 - heading back to the home page because
191:04 - that should be it for updating our
191:05 - context one thing i want to do is go to
191:08 - player controls and this should also
191:10 - take in songs as a prop and if we do
191:13 - that we're gonna have to come back to
191:14 - player control and in the parentheses
191:16 - here the structure songs so it's perfect
191:20 - and now when i type in songs it doesn't
191:22 - make more sense that this exists now so
191:24 - what it's going to do is play the
191:26 - previous song in the array play the next
191:27 - song in theory awesome so looks like
191:30 - that is all set up now okay so with that
191:32 - done the app is pretty much done
191:34 - everybody so if we go to the website
191:37 - once again all right i want to show you
191:38 - guys what it would look like to play
191:40 - these songs because the only thing
191:41 - that's left to do is to utilize or
191:43 - create music like i said
191:45 - and fetch those songs instead of the
191:46 - static ones but for whatever reason you
191:49 - don't want to be using the songs on
191:51 - chain you guys want to use
191:53 - local songs on coming from your computer
191:55 - i'll show you guys how to play to use
191:57 - that right the way we have it set up if
191:59 - i were to click this it wouldn't work
192:00 - mostly because if i go to context go to
192:02 - play on select take a look at this query
192:05 - selector right here right i'm setting
192:07 - the audio element to be song
192:10 - that music url and that makes sense
192:12 - because on our solana playground that is
192:15 - the actual attribute of the music
192:17 - account but if you go to our songs.js i
192:21 - highlighted already but where is the url
192:23 - of the song no music url it's gonna be
192:26 - right here link okay
192:28 - so
192:29 - instead of music url we're gonna have to
192:31 - write song dot link all right and if i
192:34 - hit save here one thing i'm checking is
192:37 - you also wanna set is playing to true
192:40 - okay and then we're gonna have to log in
192:42 - again because we updated the context but
192:45 - now that we set this is playing to true
192:47 - and we set this to
192:48 - song.link let's see if it works first
192:50 - try hey look at that we're literally
192:53 - playing audio using javascript and it
192:56 - looks just like spotify we made spotify
192:58 - guys how awesome is that and you can see
193:00 - composite just as you want and you can
193:02 - see the icon come and change you can
193:04 - also
193:05 - just click on anywhere an app and it
193:07 - will skip to that part this is amazing
193:09 - so all i want to do now is let's see if
193:12 - our smart contract if we can use the
193:14 - functions from our smart contract and it
193:16 - works first try sounds good
193:18 - all right so i just reformatted my
193:20 - windows and all we want to do now is
193:22 - let's make use of this upload music and
193:26 - let's go ahead and put in the music url
193:28 - right again just a quick note music url
193:31 - isn't a loot youtube link or anything
193:33 - like that right i'm going to paste it
193:35 - right here you're going to see that it's
193:37 - this
193:38 - res.cloudenary.com all i did was upload
193:41 - my mp3 file onto a cloud hosting service
193:44 - right from there it's going to generate
193:46 - a link and it's just a reference to
193:49 - where i uploaded it in the cloud you can
193:51 - use whatever cloud service you want the
193:53 - main focus of this tutorial isn't that
193:56 - website it's about how to store stuff on
193:58 - the blockchain so use whatever you want
194:00 - for this i just use cloudinary if you
194:02 - did want to use it just go ahead and
194:04 - make an account and upload your files
194:05 - there
194:06 - got it so let's upload star searcher
194:09 - that's the name of the song it's pretty
194:11 - cool it's this nice low-fi beat let's go
194:13 - ahead and create new okay and then you
194:15 - see transaction may fail to confirm
194:17 - that's usually a bad sign so let's see
194:19 - what happens as an error let's hit
194:21 - approve a mute constraint was violated
194:24 - okay so that error tells me that
194:25 - something in the smart contract so
194:28 - let's go ahead and cancel that let's go
194:30 - into here and we can make this guy
194:32 - bigger let's see what's going on so i'm
194:35 - assuming it's somewhere in create
194:36 - function and it said a mute constraint
194:39 - was violated so something that should be
194:42 - that's that is put as mutable shouldn't
194:44 - be mutable so that's fine this is payer
194:47 - context player account probably
194:49 - somewhere in create music context so
194:52 - let's see what did i make mutable okay
194:54 - random key should be mutable yep that's
194:56 - going to be different every time
194:58 - authority should be mutable because
194:59 - that's going to be the signer who's ever
195:01 - paying which will be different
195:02 - system
195:03 - program
195:05 - that is going to be the same so this
195:08 - should not be mutable so that actually
195:10 - might be it so i made a change to the
195:12 - contract i don't have to redeploy make a
195:15 - brand new one i can keep this address
195:17 - right what i could do though is go ahead
195:19 - and hit build
195:21 - okay and now that it's done building we
195:23 - can just hit upgrade and it looks like
195:25 - we have enough solana that's one thing i
195:27 - do like about developing on selena is
195:29 - that we can upgrade our contracts
195:31 - instead of deploying a whole new
195:33 - contract in a new one imagine if you
195:35 - kept making mistakes and you had to
195:36 - redeploy and you couldn't upgrade it's
195:38 - going to be a lot of faulty contracts on
195:40 - the blockchain but i'm sure in the
195:42 - future as technology improves
195:44 - more and more contracts should be
195:45 - upgradable depending on the chain you're
195:47 - in perfect okay cool so you guys should
195:49 - know the next step after we upgrade
195:52 - we're going to have to export the idl
195:55 - cool then we can just click this and it
195:57 - should open on our bs code so let's move
196:00 - this around control a control c and then
196:03 - we're going to head over to our
196:04 - spotify.json
196:06 - alright oops control or alt z delete and
196:10 - then we're going to paste what we got
196:11 - from ideal
196:13 - boom hit save connects this guy out and
196:16 - we should be good to go all right so now
196:19 - moment of truth just to double check i'm
196:21 - going to click onto this guy ctrl j and
196:23 - let's start our terminal over once again
196:26 - awesome then we can hit refresh okay
196:28 - let's try this upload music the song is
196:31 - called star searcher and we can go ahead
196:34 - and paste
196:35 - create new fingers crossed hey look at
196:38 - that so again if you see this little
196:40 - price estimate and not transaction may
196:42 - fail to confirm there's a good chance
196:44 - that it'll work i want to get my hopes
196:45 - you know too high let's hit approve and
196:47 - let's see what happens prove the modal
196:49 - disappeared which means the rest of the
196:51 - function ran
196:52 - so the only thing that's left to do is
196:54 - let's check if that actually works so
196:56 - what i'll do next is head over to my
196:58 - home page oops not printing head over to
197:01 - the home page and remember we're using
197:04 - songs from
197:05 - the static json data i have we don't
197:07 - need that anymore our songs live on the
197:10 - blockchain right so we're going to
197:12 - get this array back in this huge state
197:15 - and one thing we're going to remember is
197:16 - we never used get songs as a quick
197:18 - refresher it's going to fetch all the
197:20 - music from the music on the pro on the
197:23 - sonata program so we're going to need to
197:25 - do is run a use effect to use it so
197:27 - let's say use effect
197:28 - right and i don't know i only want to
197:30 - run this once so the use effect what i
197:33 - want to do is get songs right from the
197:36 - smart contract and then after we get the
197:38 - songs we'll do a dot then
197:40 - we'll say take the what we get as a
197:42 - return which is going to be an array and
197:44 - then set
197:46 - the songs
197:47 - like so
197:48 - so let's hit save and also just console
197:51 - log what songs are all right we should
197:53 - see an array of one i'm gonna hit save
197:55 - yep so now it's gone that's okay though
197:57 - i'll hit inspect hit console hey look at
198:00 - that we're fetching songs right from our
198:02 - new spotify and then we also get this
198:04 - array of one i don't know if you guys
198:06 - can see that but take a look at this
198:08 - object here the keys and values are
198:10 - different there is an account key right
198:12 - when i open that account key up then we
198:15 - get the music url and title which is the
198:17 - music account that we set up cool so if
198:20 - that's the case we're gonna have to hop
198:22 - over to our context and fix it up right
198:24 - so again i changed it back you're gonna
198:26 - say song that music url right because
198:29 - it's not link anymore so change that on
198:31 - context.js go to your play on select go
198:35 - to where it says equal song that link
198:36 - and change it back to music url another
198:39 - thing is that even though we have songs
198:41 - let's go to home page we are passing it
198:44 - in playlists but the problem that i'm
198:46 - having is on playlist there's no table
198:50 - there's no table rows that are getting
198:52 - populated so let's go to playlist then
198:54 - oops keep printing so i'm going to
198:56 - playlist
198:57 - right the reason we don't see anything
198:59 - is because
199:01 - i'm mapping
199:02 - every song or a quote-unquote song is
199:05 - going to be an object that has the
199:07 - accounts key which holds the count so
199:10 - what we really want to do is go to our
199:12 - home page on our home page sorry go to
199:15 - our playlist component and see if i
199:17 - could just do a song dot account
199:20 - because that should hold the music stuff
199:23 - hey look at that star searcher we did
199:25 - lose the number of plays and the number
199:28 - of the timestamp that's just because if
199:30 - you go to table row now there is no
199:34 - title there's no artiste well there's a
199:36 - title but there's no artiste there's no
199:37 - plays and there's no song link so that's
199:39 - why it's going to see it blank if you
199:40 - did want to have those things this is
199:42 - just the simple bright version if you
199:44 - did want to make those more dynamic you
199:45 - would also store that in your music
199:48 - account on salon okay and you'd have to
199:51 - input all of it manually based on the
199:52 - way we have it set up now the last part
199:54 - that we need to do is see if we're able
199:57 - to play the song that we got from solana
199:59 - so fingers crossed
200:04 - there it is
200:06 - all right you guys can hear that
200:11 - awesome and you can even skip ahead
200:15 - let's go
200:18 - beautiful so
200:20 - that's it that's pretty much the app
200:22 - guys we are successfully able to pull
200:24 - the songs that we store on the solana
200:27 - chain the only thing that's left to do
200:29 - is deploy our app and make it live with
200:32 - digital ocean so let's go ahead and get
200:34 - that done
200:36 - all right so now that we're done with
200:37 - our app the next thing we want to do is
200:40 - like i said upload to digitalocean but
200:41 - before that let's push our code into a
200:44 - repository and if you used our cli tool
200:48 - you're going to notice that if you do a
200:49 - git push you're going to see of denied
200:52 - to your user fatal unable to access blah
200:55 - blah blah that's just because when you
200:57 - use the cli tool you're really just
200:59 - running a git clone of our spotify
201:01 - project so when you get cloned you don't
201:03 - own that repo so there is something that
201:06 - we can do what we could do is go to our
201:10 - browser
201:11 - right head over to github and all you
201:13 - have to do is make a new repo so if i go
201:16 - to your profile i go to repositories go
201:19 - to this repo that i set up right it's
201:21 - just a completely blank repo this is
201:24 - going to be the url without that repo so
201:26 - what we're going to do is just copy it
201:28 - head over to vs code and to
201:31 - change the remote origin you can say git
201:34 - remote
201:35 - set dash url origin 2 and then you're
201:38 - going to paste it boom all right should
201:40 - be connected because now if i do get
201:42 - push
201:44 - hey it worked right you could also do a
201:46 - git status
201:47 - right and we could see
201:48 - all the changes that we made since then
201:50 - so we were able to push to the repo
201:52 - let's see if it did anything boom there
201:55 - it is so the original contributor is
201:57 - david as you can see but now this is my
202:00 - repo and i'm gonna push my changes that
202:02 - i added to it so these are all the files
202:05 - that we edited all right we can do a git
202:07 - add
202:08 - dot to add all of them
202:10 - and we can do a git commit
202:12 - then we can say something like
202:14 - finished
202:15 - spotify clone again it's funny usually
202:18 - you push in between to save your changes
202:20 - but we're doing it all at the end and
202:22 - then we'll do a good push all right so
202:24 - keep in mind what you see here these are
202:26 - the commits from david but if i hit
202:28 - refresh
202:29 - boom right now it's me finished spotify
202:31 - clone that's all the stuff i added yeah
202:33 - pretty cool right so now we have our own
202:35 - repo called spotify blockchain the next
202:38 - thing i want to do is some setup before
202:40 - we move on okay and again like i said
202:42 - we're going to set up some things to get
202:44 - digital ocean right up and running go
202:47 - into your next config and in the next
202:49 - line after domains i have the code
202:51 - snippet save you're going to need to add
202:53 - this pieces of code right here okay then
202:56 - from there let's go to our package.json
202:58 - and we're going to need to write an
203:00 - export script and then for the export
203:02 - script i had a add a comma right here
203:05 - and
203:06 - it should look something like this this
203:07 - is the snippet of code that you'll need
203:09 - take a moment to pause and copy it right
203:11 - and there's one more thing
203:13 - under scripts
203:14 - right here just double check it's not
203:16 - here already okay it's going to be
203:19 - engines
203:20 - right
203:22 - node
203:23 - right there cool
203:25 - so take a moment take this and this
203:27 - export that's new i'm gonna hit save on
203:29 - both and that should be it all right
203:33 - what we want to do next is update our
203:35 - github so how do we do that you can just
203:37 - see we're gonna change we get status all
203:39 - right hit add dot
203:41 - commit dash m
203:42 - all right updated
203:45 - get push
203:46 - perfect so when we go to our github hit
203:49 - refresh now now i can see the update
203:51 - commit messages here awesome so now
203:53 - we're all set up to go for digitalocean
203:55 - so let's head over to digital
203:56 - digitalocean.com
204:00 - awesome let's sign in and again don't
204:03 - forget to sign up if you haven't already
204:04 - okay and to continue on if you guys
204:06 - don't know what digitalocean is or if
204:07 - you forgot from what i said earlier
204:09 - digitalocean is infrastructure as a
204:11 - service all that means is it will
204:13 - provide you with the actual cloud
204:16 - hardware right in english digitalocean
204:19 - runs and maintains a bunch of servers
204:21 - that we as developers can use and
204:23 - reprogram to how we want it so that
204:26 - means it can do a whole bunch of things
204:28 - in short as you can see on the left here
204:30 - there's apps droplets functions
204:32 - kubernetes databases that we can all
204:35 - utilize for whatever we need it can be
204:37 - public it could be private the main
204:39 - thing that we want to talk about today
204:41 - is how to host and deploy a static site
204:44 - using digitalocean so we're going to go
204:46 - into apps and right you're going to see
204:48 - their little shark here i love it his
204:49 - name is sami shark i believe as you can
204:51 - see it's pretty self-explanatory right
204:53 - they're gonna detect what our map needs
204:55 - to run then they're gonna build and
204:56 - deploy it for us so let's create an app
204:58 - and again we're using github so that's
205:00 - the cool feature is that you can connect
205:02 - it to github directly let's see manage
205:04 - access
205:05 - and let's give it access to my account
205:08 - install authorize okay we're greeted by
205:10 - sammy once again perfect so now it's
205:12 - going to load all the repositories from
205:14 - my github account
205:16 - and select one and if you remember the
205:18 - name of it it's not bts it should be
205:22 - under lance or maybe if i could type it
205:23 - up it's going to be spotify clone
205:26 - blockchains this one right here okay
205:28 - cool and also loads all the branches of
205:29 - your app right and for us we know it's
205:32 - going to be cli starter right that's
205:34 - just the branch name that we
205:36 - inherited from the original project so
205:39 - let's click that cool
205:41 - source directory yep it's there then we
205:43 - can do auto deploy this feature is
205:45 - really cool so every time you make an
205:47 - update to our repo the application will
205:49 - actually redeploy so we can go ahead and
205:51 - hit next
205:52 - cool then we can click on this button i
205:55 - believe we'll next do web service all
205:58 - right you want to edit this what we want
206:00 - is a static site right that's something
206:02 - you guys are more familiar with and then
206:04 - for build command we can run our script
206:07 - and just say
206:09 - yarn export pull okay so after we did
206:12 - yarn export and run that script we can
206:13 - just get back then from here we can hit
206:17 - next this looks pretty good to me
206:19 - there's no environment variables that we
206:20 - have to worry about next next
206:23 - perfect and again this is going to cost
206:25 - us 0 dollars because digital ocean
206:27 - provides us with some starter apps for
206:29 - free so let's hit create resource okay
206:32 - and said the app has been created now we
206:35 - can go ahead and go to build logs just
206:37 - take a look good so far
206:39 - running yarn install fetching packages
206:42 - ooh i see the done
206:44 - all it looks like i got all the assets
206:46 - ready okay uploading build cache build
206:48 - complete
206:49 - ooh it says deploying instead of
206:51 - building come on sammy hey
206:54 - right the light app is looks like it's
206:56 - live build complete this is the link
206:58 - this nice oyster app over here let's go
207:00 - ahead and click it aha login to access
207:03 - app that's a good sign we'll click on
207:05 - phantom
207:06 - hit connect
207:07 - and bam there we are guys this site is
207:10 - now live for us to click on and if i
207:12 - click again
207:14 - just for fun awesome take a look at that
207:16 - guys so this site is live you can go
207:19 - ahead and add this link to your
207:20 - portfolio you can send it to your
207:22 - friends like i always say and that's
207:24 - pretty much it guys i hope you enjoyed
207:26 - the video be on the lookout for our
207:28 - upcoming videos we have a lot in store
207:30 - for you guys
207:31 - so i'll see you guys in the next video
207:33 - peace

Cleaned transcript:

you'll build spotify web 3.0 adapt with next.js you'll also learn how to create your own program on the solana blockchain using the anchor framework in the programming language called rust we'll also be storing the music data on the solana blockchain we're gonna use quicknote as our rpc provider to connect to the blockchain you'll use cargo to compile and deploy your own smart contract you're gonna be using phantom wallet to actually authenticate your users that sign in and out of your application phantom wallet i believe is one of the best wallets to pair up with solana and it's so seamless and the ui is an incredible experience that's why we're using that they'll use the solana web3.js package to interact with your smart contract on the blockchain we'll use context api to manage the builtin music player on your spotify app will then deploy this app to digitalocean and host your own spotify web 3.0 blockchain app on the freaking interwebs are you excited because i'm excited with that said smash that like button turn it white hit the subscribe button because it's the best channel on the planet when it comes to you becoming a web 3d developer and with that said let's jump right into it what is up youtube i'm super excited today to demo the spotify app for you guys so let's just get started right away the first thing you'll see is the log in to access this app as you can see we are missing an s but it doesn't mean it doesn't work once you see this button click select wallet and you will need a phantom wallet to connect to this build so i have phantom already and i'll show you guys how to do that later in the video but that's not the focus click on phantom it's gonna prompt you to log in i'm already logged in as you can see and there's a super sick feature where i'll show you guys how to make it so that people need to pay to use your own service that you work hard to make this is an optional thing that you can include but it's something cool to learn so make a payment to get our app it's pretty cheap you're just going to pay point one test solana so let's click on this and only a onetime payment which is cool so i hit approve awesome an alert that says transaction successful and all i have to do is just wait for it to refresh by passing pressing verify payment just give it a second awesome and once you click it it refreshes and look at this beautiful app how amazing this is right you won't even think that this is like the real spotify we have playlists we have songs and beats we have all our favorite songs over here all you need to do is customize it however you want and add it to your portfolio but what is functional are these two songs right here these songs are actually living on the blockchain and are being fetched from the solana network to our frontend app so let's see if they work right i'm gonna click on floating so all right you guys can hear that what if i press pause let's go right there's pause play functionality and best of yet there is a play next and the cool part it's really smart if i were to play next and this is on loop what song should i go to right back to the first one so all of that functionality is included in our app all right and let me show you guys more my favorite feature which is let's add a song right to add a song what you're going to need is to host that mp3 file on the cloud we're using cloudenary for this and also a title for it so this one is called sun kissed blood and then for the music url i have it here feel free to use any cloud hosting site you want i'm again i'm using this one and it's not the main focus of the video but once you have that rest set up all you do is click create new so i'll hit create new right solana is going to ask me to if i want to store it and approve it disappears let's give it a magic minute and there we go do you guys see it the sun kiss glow song that we just added is live in our app and guess what it's playable as well can i hear the file cracker on this one beautiful you guys don't have to add any songs that i add feel free to add whatever you want put this in portfolio do you guys want to learn how to build this i know i do so i'll see you guys in the tutorial hello youtube welcome back to another video it's lance here again and i'm with you today to teach you about the spotify clone i'm super excited about this build because i personally love music and it'd be super cool to teach you how to store songs on the solana network so enough talking i want to show you guys how to build this app so let's head over to your terminal once you open up your terminal let's use our fancy cli tool that we just made i'll have to do is type in npx clever programmer like so and hit enter type in your email address i'll put in my clever programmer account type in your name and look at that so you're going to see two projects at the moment and if you're seeing this in the future you might see a whole list of projects that we've created together so we don't worry about tick tock we want to click on spotify because once i hit enter bam take a look at that so let's make this vs code extension nice and big i didn't open vs code the cli tool did it for us which is super amazing as you can see too it created the next js app for us so one thing you got to make sure is make sure you have the node modules installed for whatever reason you don't have node modules you can take a look at what packages we have over here you can see we have a couple especially if you want to start using solana for this and to double check if you do you can one see if you have the folder and if not you can type in npm install or yarn if you want to use yarn okay so i'm going to install my dependencies i'll check back with you guys in a second okay amazing so if you have your node modules ready to go you can go ahead and type in yarn dev okay so i hit yarn dev looks like it's ready to go at localhost 3000 i hit enter and take a look at that as you can see we gave away some of the front end for the app mainly because i want to be teaching you guys how to integrate your app with solana so don't worry i didn't give away all the front end we're going to be doing some of the main features together like the player and the header this is just static information so you're not missing too much with all of this so now that you have your app up and ready to go we can go ahead and get started all right so one of the first things we're going to do is i'm going to switch these two windows around because usually i have the code on the left and the browser on the right so let's format this real quick don't mind me cool let me go ahead and exit our terminal and boom there we go so i can minimize this and let's just take a quick look around as you can see this is a standard next.js app with some starter files of course right so we have the index.js which comes with every react app and the only thing that it holds is this audio tag which is what we're going to use to set up and play music which is pretty much given to us with javascript with the home page that is a component over here which is going to hold all of this so if i do like an alt c here and do a command b you guys can see i've made a little comment for you that says start coding here so this would be nav this would be activity right that's what's given cool other than that there is a couple components that are made like the activity and nav stuff which again is all this sidebar is right here we're going to be making a lot more components so don't feel like you missed out so one of the first things i'll have you do is let's go ahead and make the login component so i'm going to go over here go over to components and let's just say new file and we can say login.js okay once that's done i'm just going to do an rafce oops did it too fast rafce boom to set up the component i'll hit save and the trick that we're going to do here is if i do control p and head over to the index notice how it's going it loads the home page right it's just to temporarily load it we instead we want to be loading the login page right because they can't get into our app until the user logs in so if that makes sense let's instead of importing this let's import login from components login and we don't want home page we want log okay you can go ahead and erase this comment because that is complete so if i save this now hey look at that it says login that is totally fine so if you remember our demo the login component is going to ask us to connect with our wallet so if we're making a project on solana we typically use phantom wallet so if you don't have phantom installed let me show you guys how to do that now so all you have to do is type in phantom and you can say extension and usually it'll lead you to this chrome website if you didn't know phantom is the wallet where you can hold your crypto especially it's made for the solana chain so i already have it on chrome go ahead and click add once that's done you can open up your phantom and it's going to ask you to create a new wallet and type in a password you're going to see when you type in your password and sign up it's going to give you a recovery phrase don't share that with anyone because that's essentially the key to get into your account besides you know your password so i'm going to type in my password and as you can see i have wallet one right and on top of making an account you can make up multiple wallets the main thing that you're going to need to do is connect to the devnet right if you're on the main net that's going to be using a real solana that you pay for right then that's worth money so when you're developing and you're just testing stuff we don't need to use real money you can just use you know fake or test salon for our apps so let's connect to the devnet you can connect to the devnet by clicking onto your phantom wallet after you've logged in click on the little cog wheel right here and this is your settings here you can rename your wallet or anything like that but scroll down to change network and make sure you are in devnet so again not mainnet beta so i click make devnet and i'm already on there and now you guys are good to go all right so now you have phantom wallet set up let's go over to the login again over here and let's just create the front end for it first okay cool so just to give you guys a better view i'm going to extend this just a little bit more now is that now we're full screen right so with the login there's not much to it all we have to do is make a div here which there already is format it like so and again we're going to be using tailwind for this but for the login i'm just going to use the class name styles dot login page login page and within that div we're gonna have a p tag class name i'm gonna say styles dot text and then we'll just say right i know it says styles is not defined log in to access this app so if you want to put styles on here because we're using tailwind just make that styles object up top say cons styles oops is equal to login page and here we can give it a width screen height screen background white all right because this background should go with the main spotify component i want to fade save here see this should be s there we go so now we can see the background white taking effect here and we want to display flex with a justify center justify dash center give it a flex direction of column and and item centers now it's going to make that box perfectly in the center okay cool then we can see text oops don't forget to put a comma then we can style the text and then we can say text we're going to write text for xl then make sure the text is black with mb 10. cool log in to access this app from here i want to set up the skeleton of the phantom connection so i'll just put a comment here temporarily and inside is going to be a component called wallet multi button right so this component is not something we need to make it's something we're going to import from the phantom library so we're going to need to do is say import wallet multi button from at solana wallet adapter react ui yep the reason why i don't have it uncommented because if i do this we're not going to see anything because i didn't add the wallet connection provider so that we can use this library so you know we could leave it like this but i wanted to just visualize that this isn't working just yet but let me go let me show you guys how to get it up and running okay so what we're going to have to do here is set up a folder called context and our context folder is going to hold our provider so in the new file we'll say wallet connection provider dot js awesome now with that provider i'll just do a control b here boom rafce cool now to get started with the provider we're gonna need to import a couple things as well the first one being import connection provider and the wallet provider and this is going to be coming from at solana wallet adapter react okay can i see that awesome next thing you want to import is the wallet modal provider from solana wallet adapter react ui and then import phantom wallet adapter from the wallet adapter wallets okay cool so in the parameters of the function we're gonna make an object right here and it's gonna take children and then up at the top here we're gonna say const wallets is equal to something called use memo use memo is a react hook so that we only have to render this once so we're going to take advantage of that so we're going to import use memo and while we're here we're also going to import something called fc from react wait sorry never mind we're not importing fc so we're going to take advantage of that and say use memo from react that's what we're going to need so now that this used memo exists all right we can make use of it so inside of used memo we're going to make an anonymous function that is going to be have an array and it's going to say new instance of a phantom wallet okay and make sure you put parentheses right after close the array and put a comma here and put an empty array as well awesome cool so basically i'm saying the wallet that i want to provide is phantom okay now for the return it's pretty important we're going to need to get our connection provider and then inside connection provider we're going to need the wallet provider and then lastly inside the wallet provider we're going to need the wallet modal provider you following so far so close it off and in between this water wallet modal provider there we can put children okay and for inline 13 for me in wallet provider it's going to have an attribute called wallets and it's going to equal what so essentially passing all the wallets that we're using if you look what wallets we're using we're using phantom so say wallets and you're also going to need something called auto connect here so that if you already have phantom it's going to be connected automatically if you're logged in cool there's one more thing we're going to have to do inside of the wall connection provider and this app is to provide an end point for our connection all that means is think of our front end app or our provider here it needs to be connected to the solana network it can do this by becoming a node and using that node to connect to the blockchain so if you're going to make your own rpc node that could take a lot of work for this build we're going to be using a service called quick node which they provided support for solana as an endpoint so what i'm going to do is set equal to endpoint right and then what we need to do next is let's set up our quick node project i just want to take a moment to show you guys what we're going to be using to deploy our app to make it live right so what we'll do is head over to do.co cleverprogrammer and you'll be greeted with this page right so like i said we're going to be using a service called digitalocean to make our app live and as you can see here our friends at digitalocean were very nice and gave you guys a hundred dollars to get started to learn on digitalocean so how cool is that so all you have to do to get this credit is to sign up with your email and once you do you'll be able to use all the services and infrastructure that digitalocean has to offer and if you're not familiar with what digitalocean is as a whole it actually does a lot of different things so let's go ahead and make an account real quick and once you've made an account go ahead and click create free account and it's going to ask you to verify your email and once you are officially signed up you should be greeted with this nice landing page and all you have to do is take a look at this left sidebar and you can see all the digitalocean has to offer our main focus is going to be the app so that we can make our project live like i mentioned before so i'm gonna explain to you what digitalocean is more in depth later in the video when we go ahead and deploy but for now all you need to know is that digitalocean is infrastructure as a service all that means is digitalocean is hosting servers that we as developers can program and make full use out of as you can see here so without further ado let's get on to the next part of the video alright so to get started with quick node and to get the endpoint that we need go ahead and go into the description and click in the link below because quicknote hooked this up with a free endpoint all you have to do is take that link put it into the browser and fill out this quick 45 second survey and as i fill it out i'll go ahead and explain to you what quick note is so let's hit let's go type in your email to where you're gonna this is where you're gonna receive your endpoint go ahead and hit okay and if you didn't know quick node is a web3 development platform that helps us scale our apps right there's a lot of different platforms that do similar things to quick node but one of the main reasons i like quick note and why we're using it today is because they provide support for the solana chain and at the time of this video they're the only ones that i know that are doing it at this moment so we're going to take advantage of that so when it says what change do you plan to build on we're clicking solana so i click solana i hit okay and from there just answer this question are you building a project outside of this tutorial no just this video but feel free to use this for any other builds that you guys want so cool i'm gonna click web 2 engineer because that's going to relate to most of you guys and where are you based just click on what is relevant to you from there go ahead and click submit and you'll be greeted by the quick node web page all right so you should have gotten an email by now i'm going to go ahead and grab my endpoint double check your email to see if you got it yourself all right perfect so i got my endpoint and what we're going to do to make this a lot easier since we're going to be using it in a couple different places i'm going to go ahead and hit ctrl b and what i'll do is in the root of our folder we're going to make another folder called okay and in our utils folder make a new file and we'll say const.js perfect let's just clear out this folder we can make this a little bit bigger awesome and just click this back to our page and what we'll do is import a couple things the idea with the cons folder is going to hold a couple different variables that we'll be using throughout our app let's just import public from at solana slash oops lana slash web3.js perfect okay from there we want to do is export const something called solana underscore host and it's going to equal the quick note endpoint that you got in your email so if i put quotes in here and i hit paste this is mine all right go ahead and paste yours onto there and we're going to be coming back back to this to update it with more things but for now this is perfect so now we have that let's head back to our wallet connection provider and what we'll do is the following so we're just going to import that solana host right so what does a lot of host hold in this variable what do you guys think it's the actual endpoint itself okay so what do we want to pass in here exactly so what we're going to do before we just put it into this value here or this object we're going to set it up like we did with wallets and i'm just going to say const endpoint is equal to use memo so we're going to use the use memo hook again and inside use memo we're going to say solana underscore host perfect so essentially right our quick note endpoint is in solana host and we're going to put that in a variable called endpoint and we're going to take that variable and pass it here so that we can use it all right so that's it that's our wallet connection provider right so our provider is set up but it's not being in use yet so that we can use it we're gonna need to do is go to our app and let's import that provider and wrap it around our application so what we need to do is import dynamic from next dynamic right this is something similar like we did on the tick tock clone if you guys watch that video we also need to import or like actually require at solana we need the wallet slash adapter react that's the one i want to adapt wallet adapter so react one yep react ui and then it's gonna be slash styles.css hit save and what we can do from there is say const wallet connection provider is equal to and here comes dynamic parentheses and then we can say import quotes dot dot context dash wallet connection provider okay we're almost done what you want to do after this is add a comma then put this little object here and say sr is false okay cool awesome so now we have the provider imported to us what we need to do is wrap it around the app so to do so i'm going to put quotes and after we put quotes what we need to do is take the provider so i'll say call the what's it called the less than symbol wallet connection provider right now it's not grayed out close it and just simply put your app in between this okay cool so now that we have our provider set up we can go ahead and use that wallet connection button over here so what i'll do is head back to login and we can comment this one out so i said save hey there it is we now we can select wallet and you can see that it detects that i have phantom right i didn't write any code for this wallet multi button this is provided through us through the solana wallet adapter and it can already detect what wallets are connected so that is pretty sick we can do take this one step further before i make the connection is that once you log in you should be sent to the home page yeah that makes sense but another thing that we could do and i want to show you case in this video is what if you wanted to make it so users have to pay for your service or whatever app that you create so i'm going to show you guys how to do that with a payment component right so users will pay some solana to use your app you can think of it like subscribing to spotify so that you can get their music so let's hit ctrl b and what i'll do it under components i'll make a new file i'll call it payment.js we can just say rafce perfect hit save and once that's done all right it should just look just like this go back to login and here's what we'll need to do we're going to import a hook and report right here and import something called use wallet from solano wallet adapter react okay use wallet is a hook provided by solana because and what it does is it's gonna get the instance of the wallet that's connected and we can use that object to check different things like is the wallet connected is it not connected and so forth so like i said if we select wallet we connect the wallet i want to be redirected to a payment js so that users can pay and once they pay they're free to use our service whenever they want it sounds pretty cool i'll show you guys how to do that so it's actually pretty simple all i have to do now that you imported that is go ahead and write an if statement right here in line 11 for me and you want to write is if right wallet dot connected okay wallet dot connected is wallet defined right i hope most of you say no as you can see it says wallet undefined right so where do we get the wallet and how do i tell if it's connected like i said this is where the hook comes in so all right actually i move this if statement by the way inside your login button right here so put it in line 17 and what i want to do so that we can make this defined is get the instance of the wallet so we can get that by saying const wallet is equal to use wallet right so now while it exists this is a hook that's checking what wallet is connected and if the wallet.connected is true which means i'm logged in we want to return payment yes the component needs imported of course so let's import payment from payment so let's hit save i'll hit refresh just for and what should happen once i hit this button we should be returning payment you can hook this up to send to you to whatever component you want you can have this to home a different landing page right it's up to you but let's hit phantom type in my password unlock and bam look at that we are now logged in and we are looking at the payment js this is how you set up the rider thanks to quick node and phantom cool so now that's done before i go ahead and write out the payment component and make it all nice and pretty what i want to do next is start writing our solana smart contract if you guys know what a smart contract is go ahead and move on if you guys don't know what i'm saying what is a smart contract let me ask you guys this do you guys know what a regular contract is yes of course you do a smart contract is essentially a programmable agreement that lives on the blockchain so a solana smart contract is usually called a program let me show you guys by showing you the smart contract that we created solana in the last video so what i'm going to do is go to this website called beta.soulpg.io if you guys are coming from solidity this is essentially remix but for solana it will make it easier for you to write the smart contracts all from your browser without any you know tedious installations for your computer right so a lot of playground uses the anchor framework which is a framework of rust just the native coding language to develop on salon okay cool so what does this smart contract do in particular this is the tiktok clone if you see something called pub fn this is no different from a function right you guys are developers you guys know what functions are so what does this function do take a moment to take a look exactly it creates a user right what does this one do it creates a video right what does this one do it creates a comment okay so yeah i'm going to take this time to go on net to go over the anatomy of a smart contract so where can i find the smart contract's name well if i scroll up at the top here you can see that here's the program and again that's what a smart contract is on solana and you're going to see mod ticktock clone so you can look at this as the name of our smart contract or program i'm gonna start saying now okay cool so when you create a user how does it know what a create user is well if you come down to the below here you're gonna see that something called pub struct right the closest thing i can think of when it's coming from javascript you can think of this as a class and when you make a class which is just a template for creating an object right you're gonna have to define some properties of it right so each create user context is gonna have a user a system program and a clock that might be too much but bear with me let's do something a little bit simpler a user a user on our app what does a user have on tiktok it has a user name right what is another property of a user account it has the wallet address another property of a user account and profile image this is like me writing class user accounts this dot username is a string cool same thing for video so for video account what are some properties of video all right a video is going to need a description or url whoever created it the creator url a comment count all right and another thing you notice with anchor or rust is that we have to define the type right so can you guys tell me what is the type of creator url that's going to be a string so it knows what to expect u64 is an unsigned integer basically numbers that are just positive up to 64 bytes so you can limit how big of a number you're expecting here using u64 okay awesome so there's a lot more little nuances about this but we're going to learn them as we go along so stick with me and we'll make it work so my goal is to completely start over and make a new smart contract so one thing that we can do is clear our cache to get it reset so i went ahead and cleared my cache and now when i hit refresh look how this smart contract all changed so again let's go over the anatomy one more time just to make sure you guys get the idea if you look at line five you see this one one one one one one think of that as the address where your contract lives on the blockchain all right so this is the current address of the default smart contract or program that comes with solano playground so what's the name of this program then hello anchor right cool so what are the functions of this program initialize okay cool so what are the structs there's the initialize struct right there's the new account struct and it just takes in data all right so then this is an even more simplified program so now that you guys understand the anatomy we're going to be building this out and using this as a template to create our spotify smart contract you with me let's get excited let's get to coding okay so now let's set up our solana program all right and before i get started i just want to say big thanks to the solana team and specifically one of the developers for the solano playground his name is acheron he helped me out and i learned a lot about how these smart contracts work from him and the main thing that i want to show you guys is if you look at the top here you're going to see something called use you can think of use as imports all right so here i'm importing anker lang prelude right so there's a couple other imports i'd like to include don't worry too much about what they do because you'll understand as i use them okay awesome so coming over to line eight like i said this is essentially the address where that program lives and when you first start out you're gonna notice that it's one one one one when we build the program it's going to change to the actual address where it lives okay here in line 10 we're defining what is our program what are the contents of it and remember i said that in line 11 this is essentially the name of our program so we can go ahead and change it and say spotify clone so that's just the name of our program i'm going to be using this default or starter contract as the template for creating our own so for you super we're going to need to keep that and if i hit enter here to separate it here is we define all the functions of our program so what can our program do there's two things that our programs are going to do is one it's going to create music and another function is going to be called accept payment right so if you remember the demo the flow is once you connect your solana wallet i want to make sure that the users pay for the service that we're providing which is uploading and hosting songs for them again it's a completely optional feature you don't have to include it if you did want to include a paid service or a way to make users pay for your services this is how you would do it so if this is how you make a function in rust or an anchor all we have to do to make our own function is edit it right for pub function we're going to say accept underscore payment that's the name of this function i want to create so you're going to see parentheses here and it's just the same as any other coding language it's your parameters what does this function take in and when you see ctx colon that's just the type which stands for context when you see data that again stands for what kind of type of data that we're going to see so this is think of this as the parameter ctx data is the parameter and what is the type it's u64 and what is the type context initialize so u64 might make sense to you but you might be like all right what does this mean context initialize right to give you guys some context it's going to be coming from here okay context is essentially just data that we defined throughout the contract so it's going to take in initialize and initialize comes from here we defined it cool so for us if you ask yourself do we want to use initialize to accept our payment you might not know but i'm going to tell you that we're not right what we do need is something called payer context right you might be like oh what the hell is pair contacts well that's because pair context doesn't exist we have to define what pair context is so let's go ahead and do that so hop over to your strokes and again i said structs are like classes in javascript so the first struct that i want to make is going to be this otherwise it's not going to know what pair context is so we're going to say instead of initialize we'll say player context and go ahead and take out these comments but these comments are very helpful to understand what we're doing here one thing to note is that anchor or rust likes to know the exact amount of space that's going into it with javascript it doesn't matter you could put however input size you want into your functions with rust it likes to know the exact what space to expect so here we define a lot of the behaviors of pair contacts is what it's called okay so let's go ahead and remove that and here to get started what we want to do is keep the hashtag account right we're going to just format it because there's a lot of things you want to pass in so we need init that stays we're going to need payer equals not signer but for us it's going to use something called authority which essentially who's paying or the smart contract to exist right okay and then for the space this is going to change as well so for the space like i said we have to define so the size of payer context and what how do we can how can we use sizeof well if you remember we imported it this is how we can use sizeof and just pass in uh contacts in here so sizeof the payer account right i know we didn't see this one either so this is another struct that we're going to have to make right so here's the pair context struct but we also have to define who is the payer account just like with tick tock if you remember we did the create user context and then we also defined who is what is a user so what is a payer whatever the size of pair is plus eight cool so that's going to be the space this is going to be the payer the only other thing we're going to need to do is something called seeds all right so seeds is going to equal and don't to worry about what seeds is exactly seeds essentially generates a unique hash for the payer context and it generates a unique hash by providing it some inputs the best way i can explain it is if you remember dice spare avatars.dice bear how does it generate a unique avatar it's going to make a unique avatar based on what i typed in if i say a that's what comes up s d right if i said lance that's what comes up right it generates a unique image based on what i put in as the seed so here i'm creating a unique hash based on what i put on this array so you don't have to understand what i put in the array just understand what comes out of it so i'm just going to write a couple things b pair dot as underscore ref parentheses comma authority dot key oops dot as ref okay add a comma after surrey and then you want to include something called bump right because i can explain what this is basically if this creates a hash a unique hash and for whatever reason that unique hash already exists bump will increment it by i believe 1 through 20 just to get make sure it's very unique okay cool other than that the struct is pretty much set up we just have to define some attributes so it's determined and i basically authenticated the post account so what are the attributes of this you're going to say all right let's put some space around here oh and one thing i forgot to do is close this off so we can close it off by closing the parentheses here and closing the array like that cool so here we provide the properties and the properties that i want to provide is i'm changing the name of this to payer's wallet and it's going to have the value of account info and payer account all right that's the type payer account cool here this is basically a check and we're going to check for a receiver which is going to have our accountant okay the next thing is i want to set up the authority right and again the authority is the signer who paid the transaction fee if you guys are familiar with the blockchain at all anytime you want to store something on the blockchain there is a transaction fee that goes on it who is going to be paying for that that's going to be the authority and for us i'm saying that the authority is the same as the signer right this is signer who paid transaction fee all right who's ever paying so i say pub and then i can say pub authority because that's the that's the name of this property and what it's going to expect is signer info that's pretty we don't need system on this one okay what we are going to need is this account because we want to make sure it's mutable right with rust it's also specific right you have to tell him that hey this authority could change depending on who's using it otherwise it's just going to be constant so i'm letting know that this can change again i'm speaking on a really high level so that you guys who are new to anchor can get started too and eventually you guys are going to be experts as you understand what everything is cool another thing that we're going to have to do is say pub system underscore program and it's going to be the unchecked account and again pass in this info thing here okay next we're going to set up that token program so that library that we imported is going to be used here and if you didn't know spl stands for solana program library it's not a programs library cool so i'm going to set it up we're going to write the account and we're gonna add some constraints here constraint is equal to the token underscore program dot key set it equal to and token id okay now at the top we're going to say pub token underscore program and then write program info comma okay the next property that we're going to need for the pair context is a clock just to save the time so let's say clock to save time right so for this one we'll say pub clock that's the name of it and we're going to use assist bar info all right this is how we get the clock information just say clock all right so that's what you can expect with clock all right this is looking good so far the last thing we're going to need is another struct for payer account basically let's define what the object of a person paying would look like okay awesome so we'll do one more struct before we go back into a nice comfortable familiar front end so coming down over here let's make the like i said the post account structure or define who is the payer account and what are the properties does it have so right now that you guys had the template from before oops so let me just put this back here but now that you guys have the template from before let's try to make this without looking right or using or editing a template so what i want to do is say hashtag right account basically if i write hashtag account and i do obstruct here it's going to inherit all the information of what the account on the contract is then you can say pub struct and say pay your account all right so what is this class what's the name of it all right payer account right so what is the properties of someone that is paying all it's going to do is pub wallet pub key and guess what that's it we define what a pair account is this is all it is okay cool so the real test is when we go to on the sidebar these tools here then we hit build i'm expecting a lot of errors right because you know i haven't checked in a while and rust and anchor is pretty strict so that should be it might be missing a couple things but we're gonna find out now let's hit build ah i got you okay so really quickly one thing i'm realizing before i should have hit build is i made the strokes but i forgot to finish out the function all right so we have all the strokes we need this part should be a lot clearer all right i'm going to replace this with program result it's essentially the same thing as the one i replaced but i'm using program result because i'm importing it anyways and program result is basically defining what comes out of this function all right you could look at it like that okay so from here accept payment right we want users to pay for our services and again you don't have to do that but if you did the first thing we're gonna have to do is let pay your wallet it's just a variable and set it equal to and mute again mute means i'm making whatever i write after this mutable it can change and what's mutable is going to be ctx.accounts.payer underscore wallet okay so the payer wallet is going to be equal to the account the accounts wallet and now that we have the context of what a payer wallet is if i were to write something like payer underscore wallet dot wallet right where is dot wallet coming from well what other class has a wallet attribute it's the payer account so that's why we set up the struct we're going to set equal to the ctx dot accounts dot authority dot key i'm basically saying that this is going to be the value of this payer account at this key of the wallet okay so the wallet should be this are you following so far another thing that i want to mention is you know we're privileged with javascript and like other coding languages with rust and anchor you're gonna have to put a semicolon at the end of the line otherwise it's gonna yell at you and say hey is this the end of this line all right so put semicolons that's something i definitely forgot often after we do that we can make another variable called ix and set this equal to anchor underscore lane colon colon solana underscore program one colon system instruction right again if this is really hard for you guys to follow be on the lookout for a full guide on solana and rust it's a tutorial that we've been working on and it's going to explain a lot of these things more more in depth but for now it's going to be at a high level okay after that we're going to do and ctx dot accounts dot authority dot key and then for there we can say and ctx dot accounts dot receiver dot key basically i'm defining how much they're paying and don't be alarmed by this number i'm gonna put here but this equates to 0.01 salon which is not a lot especially or since we're on the devnet okay cool after that's done semicolon right there then we can say anchor underscore lang calling solana underscore program and then invoke so we're going to invoke the ix that we defined so we say ix and then comma here then say and array all right and pass in this array the authority and the receiver once again so our accounts basically set up who's paying the 0.01 solana and where is that 0.01 salon going to that's what we're doing dot to account underscore info yes sir cool then ctx.accounts.receiver there it is dot two underscore account underscore info there it is okay cool so closing array closing parenthesis and closing curly bracket okay all right so again i saw a bunch of errors here i didn't really take a look at it but let's hit build okay so again since this is cache if i hit refresh we still should have everything i created up there's the ix and all my structs now let's hit build now let's tr now let's spend some time troubleshooting all these areas all right we got a whole bunch amazing okay so the first one i'm seeing is line 53 ah it's because it should be the comma instead of the quotes so i think that's a couple of them right there so line 53 should be the quote not the backtick okay same thing on line 60. yep quote not the backtick and that's probably causing issues everywhere else so that should be all the info stuff let me refresh to clear it up because it's hard to read in my opinion okay cool line 53 again this should have a comma line 63 is that right all right so line 53 it should end with the comma all these should have a comma at the end of each one i'm gonna put this one on there just in case refresh comma a lot of these might be typos as well line 65 oh yeah i put column by mistake 40 we need a comma after bump and line 40 and this one also needs a comma after bump on line 56 i put contraint but it should be constrained again what i do is i look for compiling because that's the latest one anchor land should be anchored laying this function takes three arguments but two were supplied line 18. see what i'm missing something oh i see comma all right this is why commas are important uh yes significantly less errors no field account in line 27 yep it's going to be context accounts cannot be dereferenced okay i'll just try this one cannot add integer to fn line 41. yep pair count should be parentheses here cool i'll build it but now that we have a lot less errors i feel comfortable refreshing it and then building it just should be the one or the two oh what the hell i thought i fixed this there you go let's try building now nice so it's just the one account info cannot be dereferenced okay so i think i got it it was just a typo around here just make sure everything is spelled correctly cool so if you want to take a moment double check what i have make sure it's all spelled the same maybe if i zoom in yep okay how is that cool so let's uh double check if we get any more errors okay cool we can live with the warnings that's fine as long as there are no errors right as long as there are no errors we can go ahead and build so since there was no errors look at this it generated a new program id for us and once it did that all right we're good to go all you have to do now is connect to playground wallet again save the key pair just in case for later okay and what we want to do next is deploy and again once we deploy it's gonna go straight into and live on the solana smart contract solana blockchain officially and the cool thing about salon programs unlike any other chain is that we can actually upgrade the contract all right with solidity once it's on there you're going to have to make a whole new contract with a whole new address just to make some changes but luckily with solana we can upgrade them so i'm going to go ahead and hit deploy let's just open up terminal uh okay cool so this is good to know our smart contract at the moment is going to cost 5.13 sol to deploy onto the chain and store it and only have two solana right so you can see the current balance here and this is the wallet of the salon playground that comes with it so a cool thing i want to show you is if you want more solana for this wallet we can go ahead and click this click this three dots and click airdrop so it's sending a airdrop request and guess what we got two solana right here okay remember this is gonna take five solana so we're gonna have to do that one more time okay for some reason that didn't go through so i'm just gonna try one more time hey there we go now we got six salon you might want to do this a couple of times so you won't have to do it later especially if we're going to be redeploying so good luck i'll do it one more time cool we got tencel now we can go ahead and we're ready to deploy it and again i want to be concerned about deploying it because we can always upgrade it later which we will there's one more function and a couple then i think one more struck that i want to write to completely finish out this program cool the deployment's successful and all we're going to need to do is go over to this idl and hit export all right so it says idl 6 but that's because i have a bunch of ideas from our last build i just know that idl6 is the one i want and what you can do is click on it and it should open up vs code for you this steps pretty important because we want to save this idl because this is what helps us use the functions from the smart contract and essentially connect it with our front end so after you click it it should open up in vs code i'm going to hit control a or i'll see alt z all right this is all of it you can see that it has the function accept payment and all the strokes that we created go ahead and press control a then control c or if you make it feel better control x because we don't need this anymore all right i'll say control c and what i want to do is open up our folder and we need to save this in our or rather yeah our utils so going into utils i'm going to make a new file i'm going to call it spotify.json and in the spotify.json paste all that information save let's see cool it should be the same thing all of the functions and the structs and once that's done in our const what we're going to need to do make this a lot bigger remember how we import a public key we're going to need to use it but first we need to import spotify from the json so there's the we're importing the idl here as spotify and then here we want to say export cons stable pool program id is equal to new public key and what i want to store here is the address of our program so remember what our address of the program is yep exactly this is the address of our program so go ahead and copy that that's not going to change after we deploy it so i'll just hit paste and then from there the last step we can say export const oops export const stable underscore pool underscore idl is equal to spotify there we go so just like solano host holds our endpoint from quick node stable pool program id holds the address stable pool idle holds the idl cool so that's going to come into play later so remember this and after that our smart contract is pretty much set up so give yourself a pattern back if you were following along i know this is hard but we're gonna get through it and i hope you're learning something with me all right guys so i switched to a different setup as you can see but i want you guys to take a look everything is still the same if you take a look let me zoom in this is the same contract address as we had previously but since i've switched to a different desktop i want to show you guys how to redeploy your contract and the best way to do this is let's make a change so taking a look at this i'm realizing we don't need two parameters for this what i'm going to do is erase in line 14 the one that says data64 so it should just say this and then what we do from here is build so if this is the current address and i made a change let's see what happens when i hit build cool so this it becomes this address right so this is the new program id that comes with the cool thing about this is that you don't have to redeploy every time what we could do is hit upgrade and we keep the same address and then right you can just keep making changes to your contract that's actually unique to solana you can't really change your contract and solidity once it's up there or at least not yet so what happened is i took out this parameter because it's no longer needed and as you can see when we hit build there's no warnings right because i took out that uh parameter that we didn't need it just says finished right from here we want to hit upgrade right when you hit upgrade it's going to cost the amount of the contract and i remember if i remember correctly this one cost five sold i have six so it should be enough to deploy perfect okay and again every time you deploy or upgrade your smart contract you can verify it with soul scan or solana explorer we'll click soul scan all right you can see this is like a proof of the transaction and proof that it was successful that we deployed something anytime you put something on the blockchain you're gonna need to pay some best fees to verify the transaction or write to the blockchain okay awesome so we have our new updated contract and remember the step that i told you we're going to need to go to the extras here click idl and click export right and once you click export click on the json file and should lead you here and when i press alt z it's going to wrap the text so you can see it a lot better but notice how it has the function name and all the structs that we created so later when we add more functions double check that your idl includes the new function so as right now we should only have one accept payment which we're going to hook up to our front end now so go ahead highlight everything hit copy all right and what you want to do is if you remember go to your spotify.json and if you don't see again or i mean control b i paste that in there and then do alt right it should look exactly the same as this cool so we're all set we can go ahead x the idl hit save and now it's update but now we have to update our front end so if you remember go to your cons this was the old program id so what's our new program id guys exactly it's this one right here so we can just easily copy this and paste it right over here okay hit save so that's some bug fix we just did some bug fixes over here with this function as well i showed you guys how to redeploy and update your cons js sounds good cool so let's get to the functionality of this okay cool so with our smart contract pretty much done what i want to start thinking about is how can we from our front end call this program so we're going to have to do is first of all open up localhost okay cool we're connected still because we're still i'm still logged on with my phantom wallet and we can go ahead and put it on the side and split screen and let's just make some space here i always do like two thirds one third boom all right this is good enough for me so just to recap we want to make the payment js right i want to show you guys how to make your service payable right so if you want to make it to like with spotify you have to pay to subscribe this is some way a form of that again it's an optional step but something good to learn just for you so to get started hop over to your payment.js and let's get to styling and i know i went to payment but one thing that we're going to have to do is set up our program instance and program instance is going to live under utils right so if you go into your utils folder click new file and i'm just going to make a utils.js this is going to hold the anchor client which is going to grab the program instance okay and now that we're in utils all we're going to need to do is import a couple of things we're gonna import star from our star as anchor so any time we say anchor we're getting everything from the anchor project serum which is essentially the project itself the anchor project we also need to import something called wallet not connected error right and this is coming from solana wallet adapter base okay and then we're also going to import the idl and the program id so where is our idl and program id being stored exactly it's going to be stable pool idl and stable underscore pool underscore program underscore id and this is coming from our cons folder which is within the utils folder cool so that should be it for now don't worry if it doesn't make sense yet once i start plugging it in it should start to make sense to you guys so let's set up our program instance let's say get program instance okay and it's going to be a function and make sure you add this export here and within get program instance we're going to write something called if wallet dot oops if not wallet let's try this again if uh exclamation point which means not wallet dot public key okay and this not basically means if wallet public key doesn't exist what do we want to do we want to throw new wallet not connected error right so if there's no public key show this error yeah is that making sense so far cool then you're probably going to wonder where is wallet coming from the skip program instance is going to expect a connection as a parameter and we're going to also pass in a wallet whatever while it's logged in and we'll be using phantom cool but if there is no wallet public key then throw the wallet not connected error okay that's just our edge case from here let's set up a provider and the provider is going to take in oops it's going to be equal to new anchor a new instance of anchor.provider which makes sense then we're going to put parentheses here and it's going to take in the connection that we passed in so it's going to take in the wallet that we passed in and it's also going to take in anchor dot provider dot default all right you saw it for a second it's a method default option okay that's what the provider is going to take right in this variable we hold this instance with all this information we pass in so after the provider we should also make a variable for the idl what variable holds the idl stable pool ideal okay now we need the address so i'll say cons program id right how do i get the id it's going to be in this variable okay and we also updated it if you remember it's now this instead of the e one okay from there well we can get the const program generate the program client from the ideal so we can do that by saying new anchor dot program and guess what we'll pass in all the variables that we set up so to make a new anchor program a new program client we're gonna need to pass in the idl the program id and the provider so that's the reason we set it up afterwards we can just return program and guess what we're good to go so hit save on utils and that should be good amazing so after utils is set up i feel comfortable going back to payment now and with payment i'm just going to set up the imports and then we're going to explain it later so with the new version of react we actually don't need import react from react sometimes i keep it sometimes i don't depending on how i feel all right so we'll just need use effect and use state all right the two most common hooks and this is going to be coming from of course react so afterwards we're going to do is in utils we exported the function and get program instance because i want to be able to import it right here so let's get program instance from utils okay and then from there we can say import token program id and this is going to come from solana spl token and if you didn't know spl stands for solana programs library and we're getting the token program menu from there okay afterwards let's also get the solana host from our const if you ask you guys what is the solana host what do you can you tell me exactly it is our endpoints that we're using quick note for exactly it's going to connect us to the blockchain so that's what solana host is and we're going to be using it later another thing i want to do is use this custom hook called use wallet that comes from the solana wallet adapter basically this is going to hold the instance of the wallet that is connected with payment yeah okay let's see is there anything else uh that should be it for now what i want to do next is set up a couple variables that we're going to be using in our functions later on so i'm just going to say const anchor is equal to require right and this is where we'll grab the anchor project from github so it's project c slash anchor okay cool so we grabbed anchor it's held in the variable and now i want to destructure a couple things from anchor okay what i want to destructure from anchor is web3 so to destructure an object you're going to say const object empty object equals anchor and then you say what do you want from this object i want web 3 right you're going to see us later make custom hooks and this is how we would make them so use effect and use state is something that we're getting from the react library or react object so this is all destructure okay so we're just structuring web3 from anchor all right guess what if i write something like this what could you say is happening on this line right we're destructuring something from web3 so what do we want from web3 i want system program from web3 right if you're wondering how do i know what's in web3 what you could do is console log it i kind of cheated i went ahead of you guys and you could console.log anchor and then you could find a web3 key and then pull from there and then you can get system program from there from web3 okay cool another thing that we're going to need is cons utf8 is equal to anchor dot utilities utils bytes dot utf8 okay cool one more thing we're going to need something called the default account and if you watch the tick tock video you're going to know that this is something that we had to write a couple times so we're going to write the token program it's an object right and it's going to take in a couple keys the first one is going to be called token program and the value of this is exactly what it sounds like so what does any of our imports hold the token program i think so so that's what we want to put here we're going to say token underscore program underscore id right from here put a comma then you can write clock and then you can say anchor dot web 3 dot sis bar club publicly right this is a key called clock and this is how we get the actual clock from anchor okay from there what i want to do is write system program system program and the value of that key will be this right here which we destruction from web3 so we write system program and that's not it all right we're going to use dot notation to get dot program id awesome so those are all the variables for now all right what i want to do next is set up the states for our payment function all right after that then we can do some nice comfortable front end all right for the states the first thing i want to do is you const wallet is equal to use wallet remember how i said this hook right here is going to grab the instance of the wallet that is connected we're going to store that in a variable so anytime i say wallet think of uh what wall that is connected well so after that we're going to have a variable called connection right so if you remember get program instance what are the two parameters that is that it is expecting a wallet and a connection all right so we're gonna have a variable called connection right and it's gonna be new anchor dot web3 dot connection and what holds the endpoint or our connection to the blockchain drum roll it's going to be solana host exactly that's why i asked you at the beginning salana host thanks to quick note we have our endpoint okay so solana host is for ready for our connection let's write kant's program so how do we get the program then we have a function that does that so let's say get program equal to get program instance and again the two parameters that it's expecting is connection and the wallet alright so i hope it all came together in that moment right if not we're gonna keep it going as i'm building along it should start to make sense if it's still not making sense after that i would suggest like console logging different things and testing it that's how anyone really can learn you just gotta use it a lot and make your own builds you don't have to copy this one exactly right you can make your own projects with what you know from here now for that after all those variables are set up we can set up a couple states so equal so if you remember use state essentially data that can be changed and again this is destructuring but for an array okay because use date returns an array with two things all right the first one is going to be undefined usually until i define it but the variable name is going to be called payers and then set payers what i want to do with this use date is keep track of every single person that pays for our program because if you paid for spotify i'm not going to ask you to pay again so i want to store all the payers in the array the set payers function is going to set literally set the players or update the payers right so say like later on i don't know someone named kevin it pays for spotify i want to update the array to say hey kevin's part of the array now so that's what this function is for what you put in here is what do you want the array to start out as and it's usually the same type that you're expecting so if i'm expecting an array how should it start well it should start empty so the first when i first console log pairs it will be an empty array until i use set pairs to update that so i hope that made sense to you that's just basic react hooks on use state so if you understand that we'll make another state variable here this one is going to be called is paid and set paid so the idea with this state is if you are in the array i want to eventually loop through it or iterate through it and check if you're in the array so i imagine you're logged in over here and there's going to be a function that's going to get all the payers or all the wallets that are paid and if i see your name inside the array then i'm going to make a state that is essentially a toggle that says okay he's good to go is paid is true right but by default like i said i'm going to assume that you didn't pay until i check it then i'll switch it right that's the logic that i want to handle here so those are the states all right we're going to take a break from all the variables and i think let's make the jsx of payment which is not too much okay so to make the jsx of payment we're going to need to make the style object at the top so say con styles is equal to object right so we won't get the error and you can see me edit this live right so we can sue div all right let's clean this up and give this a class name and the class name of this will be styles.main awesome so inside the main div we're going to have another p tag actually with a class name equal to styles.txt and inside the p tag instead of saying payment i want to start saying make payment did it update hey there we go that looks a lot better okay so as a sibling in the next line we're going to say div and this is going to be class name styles dot button or button this is going to container for the two buttons that i'm planning the first button on the left is going to be the make a payment button right make payment here on the right i want to do a verify paid or refresh who paid so this is the container for so inside this div right i'm going to hit enter and then line 35 i'm going to write okay and inside that button we're going to say pay zero point zero point one sold which is not a lot right i wanna make it cheap just for testing purposes you can make this any price and if you're wondering how you can make it any price you go back to solana playground and you go to let me make this a little bit bigger and you go to accept payment right this is where we define that price this equates to 0.1 sold if you want to make it bigger you just have to increase the size okay so users to use our service they just have to make a onetime payment of 0.1 sold and again if you're like i don't want people to pay you don't have to include this step cool so pay 0.1 so next we want to do a button and inside that button we're going to do class name is equal to styles dot button right ideally this should also be over here so let me put in the other button class name styles dot button okay so we have a class named buttons and a styles number and this one is going to say verify payment right because once you pay you're gonna i want you guys to want to be able to click this button to essentially make it make the page go through the array and check if it went through so that's what the verify payment is for cool guess what that's it for the jsx all right so if it's saved boom again this is it for the ui but once i have the styling it'll look a lot better so hop over to your con styles object and in line 19 for me we can start writing it out so let me start with the main styling is going to be with screen h screen so i wanted to make sure it takes up the whole width and height of the screen and from there let's make the background white because i don't want this background because this is what it's the background for when you're logged in like the home page okay and now we lost the text but we can easily get it back by say text black all right we're back in business right from here i want to put everything in the center instead of this top left corner which it happens by default so you want to say display flex or entail when you just write flex cool all right disappeared for some reason oh i put a comma here okay now i hit save uh and then it's asking me to log back in no worries cool so now it puts everything in a row but if i change the flex direction to column right now it's back to normal but we still have the ability to move it around with flexbox so if i say justify center it should center these things horizontally since we're in column i mean vertically and then to center it horizontally we're going to do items there we go so now i got it perfectly in the middle just like how i wanted so i'm doing alt c here so you can see the whole css in case i'm going too fast and after we do the main we can style the individual buttons so i want these buttons to look just like the colors of spotify so i'll make it round and the same colors so what i'll write is bg of the back of the button it's going to be hashtag 2 2 c 5 5 e so let's save hey there you go that's the color but we also want to form a header right so let's go over in m3 all right so there you go some spacing and now keep putting comma we'll do a text white because we should be able to see it now that it has that background color i want to make sure the font is bold okay and if we do a pyfour nice and then a px7 cool so i'm feeling that size i think it's pretty good and i want the buttons to be rounded so i'll say rounded full and we can do a hover effect you can do like a opacity every time i hover if i do opacity dash 70 then when i transition hey okay i like this a lot okay and you can see it's kind of off center but once i style the buttons div it should look a lot better all right for now i'm going to work on the text though so for the text i want to make it a little bit bigger so let's do a text dash for excel right there it is and then again we can write mb10 there you go and for here now we can talk about buttons and to fix it we can say flex and items center actually looks a lot better it doesn't look as offcenter as i thought it was okay but that is the front end of the payment js okay with that done let's work on the functionality so again if you see this button it should be pretty obvious what this should do right we should be our wallet should come up and we should pay 0.1 sold right to whoever's getting the payment right and that function is something that we're going to call from our smart contract that's what accept payment is right so in this section i'm going to show you guys how can we call the smart con the solana smart contract from our front end cool so we're going to want to do first is come to come right over here in line 33 for me and let's set up a function i want to call it const pay okay const pig const pay click is a function that's going to call this function right on the on the blockchain okay so whenever we're making calls to somewhere else that's not local to us we usually make it asynchronous because we want to be able to wait till that it that it's called then we can run the next thing otherwise that could lead to some problem so pay click is an asynchronous function all right so one of the setups that we're going to have to do is do something called let the payer signer right equal to await anchor dot web3 dot public key capital dot find program address okay so it's a method called find program address which is going to look for the program id so it's going to we're going to pass in a couple of things first thing is hit enter here enter here boom first thing that we want to pass in is utf8 encode who the pair is right and we also want the wallet dot public key the public key of the wallet and to buffer is essentially a way to convert the public key to what we need and after that array hit comma and here we can say program dot program id all right if you remember where is program coming from it's coming from our instance and in that object we can get the program id awesome okay from there let's set up a variable we can say let pair and set up something called a try catch block right so try catch block is pretty selfexplanatory in my opinion essentially you want it's going to try whatever functions in here and if that promise fails it's going to end up in the catch right and we're going to put e here sometimes people write error which you could write is console.log error or you can give it an alert that says right you know promise failed promise all right you can make this whatever you want right but for the first try catch we don't need to write anything in there okay but with this try catch we're gonna say pair info is equal to await dot weights program dot account dot payer account right so we're getting the payer account it looks like and then we're gonna fetch the signer right so fetch the signer okay and that's it for the try block so from there in the catch what we want to write is another nested try catch okay so carry catch is going to take in e again and this time we'll alert right whatever the error is so e dot message right sometimes it says like a pair wallet is not provided or it'll tell you that you know you wrote something wrong or something's undefined that's what the couch is going to say it's going to give it to us in an alert so it's really obvious cool the fun part is in this try catch this nested try all right so once we got the pair info all right we want to use that when we call the function right because what does our accept payment parameter take in and we fixed it right it's just going to take in one parameter and it should be the context of the pair right it's kind of hard to see because of the way it's formatted but that's okay so in the try block let's write a weight oops sweater weight program dot rpc and then what's the name of our function accept payment that's the name of our function on the program and put parentheses here and then object right because this is the payer account that we are passing in this is the parameter right the context so if if we know it's going to be the pair account we're going to write accounts here and we'll switch to this one and it's kind of small i'm going to say counts right because this is an object it's a key called accounts which is going to be another object and this is where the content is important so we got to establish who the pair wallet is and the pair wallet is the payer signer so we'll say payer signer and then for the receiver and who is receiving it right you can say new public key and essentially you could set up what wallet is going to receive the 0.1 so it doesn't really matter who it is you can kind of pick what wallet you want so for me i have an extra wallet if you want to know how to make another wallet you can click this plus add connect wallet create new one and bam you have another wallet that you can put so i have this third one i'll say collection i'll copy the address by clicking the top here and i'll just put a string and i'll just pass this in this should work just fine okay and then i'm also going to switch back perfect so back to all the one passed in and that address as the public key and then a comma here and then we can write authority is gonna be the wallet dot public key right and we're gonna wallet is coming from use wallet so for the public key put a comma here and we also got to get the default accounts that we set up so dot dot default counts comma all right and then that should be it closing curly bracket right and then again we're waiting for this function to run and once that function runs and it's successful i want to have an alert here that says transaction success yeah that'd be nice so let's hit save here right and let's log into our app because i switched wallets cool notice functionality still doesn't work all right why doesn't it work because i didn't add the on click to this yeah cool so let's just i'm not going to fully test it let's just see if my phantom wallet pops up so what i'll do is let's format this button to be more like this okay and now we can add on click equal to the function name which is pay flicked so i'm gonna hit save fingers crossed let's see if it works first try i'll hit pay 0.1 so okay so when it says if this comes up that means we are actually calling a function if it says transaction may fail to confirm right that might not be a good sign this could lead to errors all right but at least i'm going to confirmation that we are communicating to the blockchain right something went wrong this is the this alert coming through okay cool so awesome so the function is somewhat working i can accept that uh what i do want to set up before we fully test it is making use of is paid and set paid right because if i already paid already we should set this to true and we should get directed to the home page cool so if you want to do that then we're going to need to make another function and that other function is going to be called const get wallets all right this one just means all get all the wallets that have paid already for our service and this one's going to be asynchronous as well because we're going to be writing a promise so we're going to write const pay lit pay your list all right you're going to await dot program account that payer account dot all awesome so this is really cool because notice how i didn't make a function on my program that says you know get paid i don't have to because on the program itself right we can get all the accounts that paid using this method so we don't need to write our own function for that it's kind of built in and this is going to return an array of everyone who paid inside this variable so what should we do with that right if i want to use this state exactly so what we want to do is do set players set pairs is equal will not equal parentheses pass in payer list all right what this does is re renders the page and updates the payer list from an empty array to the array of who's ever paid beautiful so now how can i check if the user is paid well like i said i want to look through or iterate through this array to get that answer all right so what we could do is pay your list since it's going to hold the new updated array and do a four each which does exactly what i just said and for each pair right in the array all right what i want to do is if payer dot account dot wallet dot 2 base 58 we have to convert it to something that javascript can read more properly or easily all right and that's a method is equal equal to right so basically it's gonna check is this the wallet that paid is this the wallet that paid is this the wall that paid well how do we get our wallet that's logged in we're gonna make use of this the instance that holds the wallet that's connected so we'll say wallet.publickey.2base58 so they're the same type okay cool so if you know they are equal what should happen all right what should happen if they are equal well we should just write set paid is true all right and when should we call this we should call this on click here yeah checking on click is going to be equal to get all wallets okay and if you ask yourself the question logically do we only want to check get our wallets when i click the button right that that would be awesome right we could do that but what if i already paid and i load the page right it'd be cool if it just checks automatically when we first load this payment component so there's a cool way to do that using this react hook right here use effect if you remember from our previous videos explaining use effect use effect essentially all it does is you use it when you want to want to when you want to run a function at a certain point of the component's life cycle right in english that just means like when the component loads or when my page loads i want to run a function all right that's going to be the use case for this time so at the top here i'm going to write use effect right like this takes in two parameters the first one is what function or what do you want to do when the page first loads you can look at it like that okay well what i want to do is if a wallet is connected that's basically what i'm saying i want to get all the wallets all right so that means if i logged in run the function check if i already paid because if the second i know i paid already we can just skip this whole component and go to the homepage right and that's pretty much what i want to do the next thing because otherwise if the wall is not connected you should just we're not going to get all the wallets then we shouldn't even see this page based on how we loaded it up remember here's the second parameter so i'll put comma here and let's put an array this is called the dependency module right so if i just leave it like this if i leave it blank this function will only run once when the component first floats all right what i could do in this dependency module is write wallet dot connected okay so when i put this here i'm basically saying okay if wallet connected is changed like we disconnect or if we do connect right at this moment then it's gonna run get all wallets right because of the condition if i put a comma here i'm also going to be checking for is paid right is paid by default is false but if that were to ever change for some reason if is paid is true run get all wallets see if it's paid now all right so that's the cool way use effect gives you a lot of control on how your component is going to react right no pun intended that's that's the whole point of it okay cool so that should be good for payment.js let's see what happens what i'm going to do is refresh this page awesome we're still connected and i can even show you guys if i go to get a wallet console log get all wallets is running right you can see right i also want to show you console.log is paid so let's make a refresh here make this guy just a little bit bigger inspect element let's see what comes up cool get get all wallets is running because i hit refresh if i refresh again get all while it's running and you see false because is page should be false right now cool so time to see if this works let's hit the pay so again usually if you see transaction may fail to confirm that usually it doesn't isn't a good sign it should be able to calculate how much you need to pay so let's hit the proof ah okay the program could not deserialize the given instruction okay so that tells me there's something in our function here that we need to figure out could not deserialize the given construction okay so it looks fine in my cons the utils looks good i might just try to redeploy the smart contract because when i'm looking at the smart contract i'm not entirely sure what's wrong so let me just double check by hitting refresh let's just do a build and deploy again so let's build it okay no errors let's upgrade it all right even though i didn't make any changes let's just see if i can just get a new idea okay so it looks like it upgraded we want to get the export the idl open this up so let's see to see it real quick then i'll do ctrl c go to spotify.json control a delete paste save and x out that new one and again this id this address should stay the same yep up till the utils okay and on the payment side there's one thing that i wanted to add and what i want to add is if the user is paid is set to true basically if i did pay i want to load up the home page so we can probably write that right before the return like right here it's already if it is paid right if that's true return home page okay and home page is given to us right it's this lowercase one then at the top here we could import it import home page from i thought pages dot home page cool so if we pay the use effect will take care of it it's going to run get all wallets and if you don't get a wallet is paid is going to be set to true right it's going to be right here wait did we say it's true okay cool perfect so just to make sure as well triple checking i'm going to end the terminal yarndev make this smaller hit refresh double check i have some solana yep i do hit come on come on come on okay all right so it doesn't say a transaction may confirm there must have been something wrong when i went to deploy it let's hit approve and let's see what happens approved transaction successful awesome cool so if we see the alert if let's go scroll down control p control j and let's increase this if we see transaction successful we know that the accept payment function ran and there was no issues right and again if i click verify payment let's go we're in the home page and we paid right so that means we paid and we should we should be good to go right let's go to a wallet that definitely didn't pay let's go to wallet number four right select wallet we connect wallet so should we see the home page no that didn't pay it right we can't pay with wallet 4 because it doesn't have any salon cool but if i were to switch to wallet one let me hit refresh and we are in so this is how you make a subscription to your service right now that that's done we can work on the actual app itself alright so we were able to successfully call a function from the blockchain what we want to do next is start working on the home page so let's take a look at that so if i say control p oops not on that page on this page control p say home page dot js all right this was giving to you right the nav which is this the activity which is this right okay we want to start working on is all of this right that's why it says start coding here so what we want to do from there is import a bunch of different things right let's just set up the front end of the homepage all right so with the home page there's going to actually be a bunch of different components if you remember the demo there's going to be like a table down here that's the player and there's going to be some sort of like header as well as a nav another nav bar a playlist component okay so before we even get to those let's import any hooks that we'll need now i can tell you right now the hooks that we're going to use is going to be use effect which i explained to you earlier and use state okay cool okay so that's pretty much the only hook we'll need anything else we're going to import is going to be a component and our custom hook later on so let's set up a couple states uh the states that i want to set up is going to be over here it's going to say const array equal to ustay so let's talk about what i want to set up for this state variable i want to have a show upload music variable and the purpose of this is kind of like is paid right it's supposed to be a toggle on whether the modal to upload music is up right what if i click create or upload it's going to be at the top here a little modal it's going to be component is going to show up based on the state all right so we set show upload music right and again just like it's paid the default for it is going to be false cool so we're going to do const title right it's going to be title as this name of the state and it's going to be set title right cool let me spell this correctly perfect so this state that title and set title is going to be responsible for when we upload music there's going to be a little model that comes up we want to keep track of what i wrote as the title of the song okay and then for use state what i want to put here in quotes is just going to be empty right because by default the input should be blank and this next state is going to be very similar okay it's going to be music url and set music url and that's going to be equal to use state as well okay oh and there's also one more once we get a list of songs we're going to map through each song and then make a row down here so again we can save that as a state so i'll say songs comma set songs and that's equal to use state and if we're expecting an array of songs we should put the initial state as an empty array okay cool you guys got that awesome all right so from here we can just separate this and again we have the start coding here cool and we don't need these curly brackets perfect all right so from here we're gonna make the rest of the jsx which is gonna be a bunch of different components so the first one i'm just gonna write out the skeleton of the components and then we'll make it together so the first one is going to be the header and the header is going to be this part right here at the top which is going to bring up the modal another thing i want to make i'll make a comment right here there's going to be a component called playlist okay and another one we're going to make is something called like player controls player controls awesome cool look at that the jsx is pretty much done because all of the html css is going to be within these components so let's get started with the header so to get started with the header i'm going to hit save on the home page let's do control b here go to the components make a new file and let's say header.js okay control b again and we can say r a f c e hit tab save and come back to the home page and now we can bring this guy back in oops so if i just say header we can see this little emit abbreviation that's going to give us the shortcut with the import so i click it header is automatically imported and then forward slash close the component so now we got the header so now that we got the header we can start working on it now with the header we're going to be coming back to this what i want to do with the header is again just set up the front end and then we're going to give it more functionality as we go so to start we don't really need this but we do need import image from not down that but from next slash image perfect so with that out of the way we're now able to use images in this component and that should be good for now what i want to do is start styling the jsx okay so for this first div we're going to give it class name of styles dot header and that's style sheet styles that hit all right and if i were to save this we'd see styles is undefined why don't we see that because we need this style object here so i'm just going to put the skeleton of it so we shouldn't get any errors and again there is the error that i was talking about that's because it should be styles cool and within this header div we're going to have a wrapper div so let's call it class name styles dot header wrapper okay and then within the header wrapper another div is going to be the class name and it's not going to have an actual class name it's just going to have a tailwind css already because there's not much so just flex item center on there then we can do another div within that that's going to be class name styles dot arrow button okay and thanks to our cli tool we can give this image a source and it's going to lead to the assets folder which you guys should have over here it just appeared let's open it up to double check we want the chevron uh left over in this one i'll say forward slash oops say forward slash assets slash chevron left and this won't work until i give it a width and height so let's give it a width of 20 height of 20 and alt left okay and see hit save hey there it is yep so this should all be within the div for the arrow button okay from there you can actually just copy and paste that because we're gonna need another arrow button so instead of chevron left let's get chevron right cool yeah so it should make that shape and this should all be within the flex item center okay once that's done we're gonna have another div right here in the middle we'll say class name is equal to style dot header right and after style that header right there's going to be a button here which is a component that doesn't exist just yet so we'll say upload button for now but we'll come back to it don't worry i want you guys to give it to get an idea of what this is for and next let's make the next step okay so after we make that the next div is going to be div with a class name equal to styles dot profile okay cool so after styles that profile we're gonna make another div right here which is gonna have the class name of styles dot profile avatar container this is the header section and i want a little area where you can show your avatar okay cool and then inside of this div here we can have an image tag and then inside that image we can have we're going to use our assets again so do forward slash assets slash and then we need to find avatar.jpg go ahead and hit save let's see oh we need a width and height so let's give it a width hmm it's what 30 for now and a height 30. i'm actually going to put it 20. okay let me do an alt of avatar okay it's been a while let's log in again awesome there's our avatar perfect don't worry once i give it a class name we can say rounded bolt to make it perfectly round there we go awesome okay so after that here you can insert your name so let's put lens okay put my full name plan stiletto perfect okay should be closing div closing div okay and then the one thing we're missing is this shouldn't be closed in it should actually go right here we want to do is take this it should go right underneath upload button there you go that's better and this guy can go like right here yes sir perfect all right so i'm just going to quickly format this so it looks good boom this should line up with profile and these guys should be together there we go so should look something like this and this div should belong to the header wrapper all right looks like we're all set and good to go now the key thing here is after these three closing dibs we're gonna have to make another div and this one's gonna be style style.playlist text content and within that it's also going to have an image and that image will be okay and a source of this link right here you can put whatever you want this is just supposed to represent the album that you're looking at in the header so from here we can give it a width and height it's going to be 220 height is also going to be the same and for the alt we can just put album hit save i put hi there we go so this is the which represents the album that you see in spotify and again if i make it a lot bigger there you go awesome so after the image there's still another div within the playlist text content and that's just supposed to represent the details of the album itself so what we're going to do is make a div class name ml5 okay within that it's going to be this fragment that just says album okay and from there another div called class name style dot type and after the title it's gonna have the current song current song this is gonna be dynamic later on but for now we'll just make it static okay and as a sibling we're gonna have another div we want to add this dot that i have saved and say 20 22 and then paste and then 46 so i'm just putting random numbers here you could put this as whatever you want it's going to be static and say three hours 20 minutes doing all c here so you can see i said save cool and don't worry i'm going to style all this so it's not all smushed in the corner okay so closing p tag closing div closing div closing div and then here we have a little controllers container so we'll do a div with the class name styles.controlscontainer and inside that div is going to be a couple of buttons so let's do this so i'm gonna have class name styles dot play button okay and inside that play button it's gonna be an image with the source being assets slash should be a play svg next plus play perfect pi svg with width of 30 and a height of the same thing okay after that width and height you can do alt equal to all right there's the play button and now we're going to make a couple divs and we can copy paste this because it's going to have the same class name so the next div it's going to be styles icon container okay and inside that icon container is going to be another image so i'll just copy paste this one since it has the same styling the difference is it's not play svg it is the heart button if you remember the spotify all right so let's do asset slash heart let's see perfect cool so there's the heart and what we want to do after that is copy this two more times and then just change the images here so this one has a download that exists and this one shouldn't be a heart it should be a more perfect then closing div closing div click div and that's it for the jsx right the next step would be to start doing the styling okay so getting started with the styles one thing i noticed really quickly was this should be in curly brackets okay awesome now that's done going back to the styles object we need is the header and the header is going to be maxed with dash 7xl and then it's going to have an ml auto or m.shadow sorry that's basically margin auto and then this p 3 ok then after that we can do the header wrapper which is going to have a flex items center and justify dash between okay and then from there let's do we can do the arrow button so let's do the arrow button and the air button has a couple things it's going to have a background black mr2 and a width 10 height 10 a flex our displayplex item center and then justify dash center and a rounded dash full okay and i also want to give the background and opacity 50. okay cool and then we can do cursor dash pointer right it's supposed to be like the page and i just realized there's another styles arrow button over here in line 14 for me that's why it's not taking the styling there we go that's more like yep cursor pointer and let's add a hover effect let's change that opacity to this one when we hover okay nice that feels more natural okay moving on after the arrow button we can go ahead and do the header right which doesn't have much just gonna have a flex and that's pretty much it cool so after i had to write we can do a profile and then profile is going to have flex and item center yep and then a background black and a rounded dash full and ap one and a px3 okay that sounds pretty good to me so far let's give the background a little bit of an opacity dash 50 a cursor dash pointer and a hover of bg opacity of 75. awesome let me just double check something arrow button header right profile oh it's because the profile avatar container okay that's fine we could do that next we could do the profile avatar container and that should fix it up let's do with seven seven and a rounded dash full then we can do a dash ml dash 2 3. okay yeah the image isn't really aligned so what we could do is the container is in profile avatar container so just do a flex item center and there you go that looks good to me perfect okay so after that see we can work on the icon container icon container do we have one yep right here so let's go ahead and install those so the icon container it's just going to have an ml awesome okay from there we're going to do a title and title is going to have text 6l x6 xl and then a font let's make extra bold extra there we go yeah it should be big and bold like it is on spotify then let's write playlist text content then playlist text content i'm just not sure spelled it correctly and we have it yep it's gonna have flex and items dash and empty cool and we lost the image yep there it is cool so now you're gonna see that the smaller make it that's where the image goes but then when i make it big it's a lot better awesome so it helps with the responsiveness of it okay better come on here let's do the controls container next and the controls container is going to have flex items center mt10 as well nice and last but not least should just be the play button and the play button is going to have a background green that's spotify green yep with 16 and a height 16. nice and give it a flex property here with pl2 item center center and a justify dash center there we go and now watch this rounded full nice okay cool look how like making buttons rounder makes it way more appealing cool yep so that's looking a lot closer to the header all right awesome and again don't you don't have to use the same exact pictures i do put your favorite album on there and your favorite song and your favorite artist cool all right that's the header front end now the next step i wanted to do is talk about this upload button right by the profile name you should be able to see this little oval button it says upload and when you click it a modal will pop up so one of the things that we're going to have to do is pass down props all right so before i pass it down here let's go back to the home page and remember the show upload music state that's true then that model will pop up it's all gonna depend if you click this button right here so what we're gonna have to do is go to the header and let's pass down this prop right more specifically the set show upload music is going to equal the set show upload music function all right all i'm doing is taking this function and putting it into this component i'm passing it down because it's a child and then what we're gonna have to do is on top here of the header component we want to destructure the prop and literally just write set show upload music right what this does is if i were to console log set show upload music let's do inspect element hey so look at this this is coming from the header component and what's showing is a function so that why is that awesome because now i don't have to make a use state in header i could just pass down what i made in home page to the header so that's the one of the main benefits of props so i'm passing down that function reason being is i want that to i want to set the upload music to true when i click the upload button but how does the upload button know when to show upload music what we can do is first let's make the component so i'm going to do a new file and say upload button.js and this is just base this component right here is basically front end so let's hit save let's comment this guy out all right and let's import upload button from upload button hey there it is all right so now that we have it there let's pass set show upload music the same function to the upload button all right now if i were to console.log it here i have to destructure it first so i can say set show upload button cool so now we have the upload button what we can do real quick is set up the jsx once again and all it's going to have is another div with an on click this could be a button but we could also just put it on and click on the div so there's no on click i want to make the unclick yet because the function doesn't exist yet but i can make the class name and the class name is going to be styles dot oops styles dot upload button and it's just gonna say upload music just like that oh yeah don't forget to make the styles object all right take out the import react awesome cool so now it says upload music that's totally fine and for the styles we're only going to style upload button and there's not much to it it's just styling the button it's going to have a background of the spotify green yep it may not look much now but once i add some styling to it give it margin padding cursor dash pointer uhhuh full like we always do nice and then we can do a hover scale 95 and add a transition cool it looks a lot better when you stretch it out a bit but this is the upload model and at the moment nothing when i click it right that's because let's add the on click functionality and there's nothing really to click because there's no function so combing at the top here between lines seven and eight let's make the const upload clicked and the upload click all it's gonna do is take our set show upload button and set it to true okay and then all right to show you guys if i go to home page and let's console.log show upload music right what do you think we'll see in the console log if i hit save all right so let's make this guy bigger it's back to console false right so uh show upload music is false when i click upload music it should be true right it's true now come on all right says false oh it doesn't say true yet so let me just move this back i'm going to go over to payment and let's take out the console log here so it's easier to see and then upload we forgot to add on click so let's do that we'll click on click then we do upload clipped okay extending this inspect element now we check all right so hit refresh nice so if it's the home page we should see false if i click upload music set show upload button is not a function okay interesting i'm going to assume it's a typo set show upload button oh there you go i said button instead of music it's a mistake there you go now we should be good hit it refresh again all right false true and it doesn't change it back it's only when i the modal comes up that we can exit out then make it false so that's how we set up show upload and get the state to change okay there we go all right so now that the upload button is finished if i were to full screen this right it's going to set the state to true and from the looks of it we're starting to set up the everything we're going to need in order to upload our own music which is going to be awesome right but the thing is with our smart contract how it is now it's not able to upload any songs we can only accept the payment so i think it's time let's get back into solano playground and work on the smart contract all right so now that we're back and we made the first function together we're going to use that as a template to creating more so let's see if you guys remember what i said a couple minutes ago right so we want to make a new function and the function is going to be called create music and what create music should do is store the reference to the song right onto the blockchain so let's start making a function so how do i make a function in solana right with anchor exactly you're gonna write pub fn all right same thing as we did before so how do i give this function a name well you can do right here create underscore music okay how do i give this function parameters right so again if you know javascript really well this is very similar all right so i it looks like this but i put enter in the parenthesis because i'm going to add a couple parameters what kind of parameters would we need for create music all right let's think about accept payment payment needed who was paying the context of who was paying the data of who's paying right create music is going to need the same thing so there's going to be a parameter called ctx and the type is going to be context but not pair it's going to be create music okay is that it though that's not going to be it i could tell you now i also want to store the name of the song the title right this would be mr sandman the the goosebumps by travis scott like the title right and what is the data type of the title you think exactly it's a string so i also want to store the music underscore irl i wanted to talk really quick about what this means so if you guys are familiar with nfts at all when you guys own an nft what happens is you own the rights to the address on the blockchain right where that the reference to the nft you don't actually own the picture itself right it's essentially you own the link and when you put that link it's going to point to the actual image that you own all right so the same thing applies here it's going to store the url right where your music is being hosted so later i'm going to use a cloud hosting site to host our music the main thing is that solana is going to store that reference nft is the image is stored in ipfs and you own the reference to that image in ipfs so it same sense the music rl is going to be a string so i think that's all the parameters the next thing we want to do is talk about what the program result is which describes what should we expect so let's write program result curly brackets and what we're going to write here is a variable called music right and then we can say it's going to be and mute right what does n mean it means that whatever we're going to write after this mute is going to be changeable or mutable and what it's going to be is ctx right the context dot counts dot music all right so let's pause this function right here right now so if you remember we needed to pass in pair context but we didn't know what like if this is describing ctx we don't know what this even means so what we have to do was create a pair context struct right so if we're going to do context create music what should we do exactly we should create a cree create a creative music okay so it's going to be similar to this and we can use this as a reference if we get lost right so coming down below here let's do the create music context so i'm setting up what that means all right so the first thing we're going to do if you look at the top is something like derive accounts right basically you get all the traits of an account right so derive parentheses accounts and then how do we write a struct or create a in other words a class if you understand what that means in javascript we're going to say pub struct create music and then pass in info okay so far so good there we can add curly brackets right after info and now what did we do here right we wanted to essentially authenticate the account so we're going to get it like this pretty much something pretty much similar to this all right we're going to start it off the same so it'll be hashtag array count parentheses oops yeah so you saw that how it like set up the knit and everything like that we're going to do that as well okay so we'll start off by doing init once again and then after you knit we'll set up our seeds which is going to be generating a unique hash based on the input that you put in here as i explained previously so let's do a b music dot as ref and again you don't have to worry about what all this does exactly just know that it generates that unique hash random key dot key dot as underscore ref okay parentheses after that put a comma here and then you can write bump and if you remember a bump it's supposedly supposed to increment the unique hash if it's not unique right so say like it makes a unique hash from this input then it's just oh if it's not unique it's going to increment 1 to 20. okay so bump and then we're going to set the payer to equal the authority okay and from here let's say this let's define the space right now with rust um one thing they like to do is they like to know exactly how much the exactly the size of the input that's going into the function right with javascript you can either have an array of zero or an array of one million really and javascript will accept it right with rust it needs to know what the maximum size to expect you know is for this space and to start off we can use our size of which we're importing and get the music account which doesn't exist yet so we'll pause this in a second alright so let's define what the music account is if you have no idea what i'm talking about let's remember the payer context right you have to define the size of the pair contacts and the size of pair contact is going to be the whatever is in the payer account and what is pair account that's another struct we made this one right here so with that kind of like pattern recognition what are we gonna have to do for this what is music account music account is gonna just be another struct that we define over here okay so let's define it we're gonna have to do a hashtag account here and after we do hashtag account we can do pub destruct music account that's how you make a class once again and you could think of this as what are the properties of a music object right so one of the first things i do is get the authority so the authority of the music account is simply just going to have the type of pub key pop key like this actually awesome another attribute that might make more sense to you is inside the what i'm going to store on solana is going to be the music title right so pub title and what can you expect from this data type it's going to be a string okay is that making more sense now the music object is going to have a key of title and a value of whatever title we write in the front end okay another thing that's going to have is pub music underscore url which is going to have a string or expecting a string cool so now music count is defined and what i'd like to do next is define how what is the maximum size of title and what should be the maximum size of music url so what we could do is come to the top here between a line of nine and ten make some space and we can say const text length okay and text length is gonna accept the type of view size and the size of text length is going to be 255 bytes all right semicolon you can think of this 255 at one byte which should equal one character it's not going to be exact but that's roughly the estimate that you can look at so my the longest title i can have is up to 255 characters about okay same thing for the music underscore url underscore length view size and that's going to be equal to 255 all right that's the same reason why you can think of this like twitter where they limit the amount of characters per tweet so that someone can't make a paragraph so we're defining the text length and the music url length that looks pretty good to me so coming back below here right we still have our struct now let's determine the size the total size it's going to be the music account object itself plus the text underscore length plus the music url okay we're adding all the things together to get an exact estimate of the s the space or size of the create music context okay amazing so after the closing stuff right here let's write out the rest of the attributes of create music so we'll write pub music right it's going to be an account type which has the info lifetime variable oops close it off but you can put comma music account all right then we're going to have it checked here which is going to be account parentheses mute and again whenever you see mute that means it's mutable or it can change data that can change so the pub a random key can change and the random key is gonna expect count info again or more specifically account info info i know it's pretty funny all right from there we're going to do another hashtag account mute all right this is essentially the authority that i'm setting up right now i'll put a comma right here the authority and it's going to essentially be the signer who paid the transaction fee that's what i'm defining here so i'll write pub system underscore program is unchecked count info there we go okay from here let's set up the token program sorry not the token program we want to set up the system program it's going to be similar right we did system program the next thing you want to do is let me double check system program oh set up the token program i was right and it's going to be something like this okay quite literally we could copy this because it's the same format and we're also going to save time as well all right as you can see system program is the same the authority is the same so there's some sort of like template going on here and yeah that's what i was missing okay yeah and i forgot we need the authority here too that's what i was talking about earlier this is the signer who paid the transaction fee boom okay cool so we don't have to reinvent the wheel that's pretty much the template of this okay and of course i can expect a couple bucks here no did all go away nope everything's in there all right we can expect a couple bugs here so let's hit build yep there we go line 79 info is never used oh i see okay it's never used because i didn't finish that function remember how i paused it so we set up all our structs when i hop back into the function create music we didn't finish writing this out because i wanted to tell you guys now this should make more sense so music this is a variable it's going to be equal to the context dot accounts and then grabs music all right and that's going to set equal to a variable and then from there this is where it all starts to click for me personally if i say music authority right how can where is this authority coming from this authority we can this is a key right this is like saying uh car dot model is equal to lamborghini right so i'm setting the authority of music the object that we created or destruct right and setting it equal to something okay can we set it equal to if this is the authority we actually have the reference to it so we can say dot ctx.accounts.authority.key there we go so i know if that didn't make sense to you this one might so music right if i say music it's gonna be this right how can i get the title of this music well if it's like an anything like an object that i know i can say music that title cool so that's how we have access to the key now i can then sign a value so what should be the title of the song i could say like goosebumps right but then that means every song that i create is going to have the title goosebumps but that's not good all right we should make it dynamic well how can i get a dynamic title luckily for you we passed that in as a parameter so you can just say the music the title is going to be title there you go is it making sense now so let's put a semicolon right here something going right there and then we're going to say music dot music underscore url is equal to the music url we passed it there we go so i hope it all came together in that moment i had auto saved by accident and then whenever you finish a function we can write ok and usually sometimes you can pass stuff in here but for this you don't have to hit build again expecting some errors it's going to try again build compiling there you go so it's not one used import and line 96 line 96 aha because the comma should be here okay expected line 40 yep it would be good to add a semicolon right here build compiling oh let's go finish no error so let's refresh one more time so we can see a clean console let's see if line 40 had the semicolon yep that's the last thing i added we build then finished no errors let's go so as long as you you know dot your t's and eyes or in other words add your semicolons semicolons and commas you should see finished not even any warnings but awesome now if i ask you this question if i go back to my vs code is it using the latest version of the contract does it have the create music function inside of it no no we have to upgrade it like i showed you earlier so let's upgrade it and again it's going to cost some solana so make sure you have some you could always air drop yourself right here air drop i know at the moment our contract should cost about five sold so it's going to take it and we deploy slash upgrade our contract awesome so looks like a deployment was successful so now that our contract is upgraded we're going to need to export the idl all right and then we can double click this it should open up in vs code we can do an alt z and let's also grab our spotify json right so spotify json is the current idle that we're using so if you look what's the difference between these two all right if you look in terms of functions there is a create music function now and that's how we call it in the front end no underscore right another thing that's also here is the struct okay so what i want to do is press ctrl a to select everything in this idl.json and then ctrl c to copy it all right so then i go to the spotify.json go a delete paste all right that's just to ensure you know i'm not copying anything wrong this looks a lot better cool now did i do i have to change the contract address no since it's the same we just upgraded the same contract in my const this will stay the same and when i import spotify.json that's going to be different so we're already we're actually already done upgrading so now we have the ability to call the function but we haven't quite set that up yet but with that said we're done with a smart contract so if you made it this far in the video congratulations give yourself a pat on the back you were able to write another solana program and if you made it this far let me know you made it this far by saying shark in the chat right digital oceans mascot is a shark named sammy so if you say shark in the comments i'll know but you were making you were watching this and you made it this far so that's the smart contract awesome so we finished the solana program and everything is pretty much set up on the back end what i want to do next is set up the front end so what we can do is let's make the vs code full screen because what i'm about to do is create a custom hook right in react you saw that there's use state use effect all right we can also make our own custom hook by writing something like this so i'm going to say control b and what i want to do next is make a folder so we can close all of these so you can see it a lot better all right we're going to want to make a new folder and this is going to be hooks right the hooks folder again is exactly what sounds like create holds any custom hooks we create so in the hooks folders a new file and i'll call this use spotify and that's what i'm going to call the hook essentially so use spotify control b let's set it up by importing a couple things so i want to import token underscore program id from solana spl token we've imported this before i want to import use wallet so what does use wallet do again yep it holds the instance of the wallet that's connected and usually we put that in a variable we also want to get our connection to the blockchain and that's through solana host coming from utils const we need to get the program instance so how do we get that yep it's the get program instance everything we did previously is all set up for this now it should all be making sense okay now we also want to get anchor so let's just make that in a variable we can say const anchor is equal to require add project serum slash anchor all right that's how we usually get anchor you can get our utf8 set that equal to anchor all right we did this before it's anchor.utils.bytes i believe dot utf8 cool now remember how i said we destructured something from anchor we're gonna do that again except this time we're gonna get two things for me we are going to get web3 and something called bn okay next we're gonna do cons system program that's all imports that we've used previously in the build okay after that we're going to set up default accounts again which is the exact same thing as before it has a key called token program and it's going to be set to token program id as clock which is going to be set to anchor dot web three dot sis r all right that's how we get the clock and then it's also going to have a key called system program and that's gonna be system program all right coming from here and then we can get dot program id cool okeydokey so again a hook is just a function that we can call upon essentially so we can set up the function by saying cons to use spotify because that's the name of the hook is equal to arrow function yeah awesome so what are the parameters of u spotify what does zeus spot if i take it i can tell you that use spotify even if you're not sure or understand why we're making this i'll tell you that spotify is gonna have music url title set title set music url and set upload music okay cool again you might not know where all these are coming from but if you're if you were able to understand code or look at somebody else's code you might be able to determine what we're passing in here where have we seen set title or set music set something right that comes from state and we actually have all of these states already all right i'm just giving it the same name so use spotify is going to take in all this information and some functions from state and do something with it okay so in between the curly brackets in line 22 and 24 is the actual logic itself so in the function let's set up a couple variables first one is going to be what is the wallet connected it's going to be a variable called wallet and how do we get the wallet instance get use wallet that's it you guys are pros okay we also want the connection how do i get the connection the connection is going to be new anchor dot three dot connection parenthesis and then pass in your rpc connection which is solano underscore host okay from there we're gonna use const program so the equal to get program instance and remember program instance takes in two parameters and should make sense why i wrote those variables before because it takes some connection all right so now it's lit up and the wallet yes nothing new from here use spotify is going to have a function called get songs alright so const get sung get songs is exactly what it sounds like it's going to fetch the songs that are stored okay so to fetch the songs right marisha konsta log fetching songs just to know that in our console that what it's doing and what this is running and what we could do is ask ourselves in our smart contract is there a fetch songs button there's not we only have accept payment and create music one feature about making a music account but making a music account is that it stores all of that in the program itself so you don't need to make how can we use that to our advantage then so we can say khan's songs it's just the variable i hold it in it's equal to await program which is you know the program that we're referencing dot account okay dot music account right literally called the name of the struct i'm literally calling and i'm trying to get everything stored on there so how do we get all that all of that there's a builtin method called all which will do that just for you then just to prove it to you we can con to log the songs and then return songs right that's what you return from this function so that's the get songs okay after get songs i need a function that's going to upload or store songs into the contract itself so we what do we have in methods that do that except payment no create music right it's storing them or at least setting them to the account right here so let's make that function constant new music is what we'll call it equal to async now what is this going to take in new music is going to be const random key that's the first verb and to get a random key pair we can just generate one using anchor so if we do anchor dot web3 dot key pair dot gender okay then we can do that public key okay awesome after that's done we can do music pda and this is going to equal await anchor dot web3 dot public key dot find program address all right parentheses inside here utf8 dot code and this is where we put music again and then we'll do the random key dot to buffer all right this is what we did last time when we're doing the accept payment we have to set this up and key to buffer comma and then we had program dot program id okay and i'm seeing that this should actually be used so let's make this lower case and bam so now it's being used okay cool program id that looks pretty good awesome so let's set up a variable called tx for transaction and set that equal to all right the instruction that i want to run on my contract is create music so how do i run create music from my front end we're going to get program right that's the reference of the program if i could spell program dot rpc right remember this from before dot create music there we go all right so create music what are the parameters that it's expecting let me just double check that it's expecting title music url and just to create music context we could do title all right so with that hook done let's remember what we pass in to use spotify the url title the set title the music url and the show upload music okay with the hook done let's head back to the home page and in the home page what i want to do is add another import here let's import use spotify from the hooks use spotify all right so we just imported our custom hook now what are we going to do with that what i want to do is take out this console log right first and then we're going to do some destructuring of use spotify all right seems familiar all right for use spotify what are the imports again the parameters that it takes in it's gonna take in a music url we have that that exists here does it have title do we have that yes we do it's going to take in set title all right we have that and it's going to take in set music url awesome and last but not least it's going to take set show upload music it's not going to glow because we've passed that down to header already alright so we passed in the actual things in the hook but what do we want to take from you spotify what can we take we can take we look the two functions we create constantly music and cons get songs that should all be in the home page to make use of it so we can literally write that by destruction and saying new music comma uh set not sorry get songs yes okay so we destructure two functions from our custom hook so that we can use it in our home page there we go so now it's true at the moment if i click upload music the model doesn't come up because that component has been made yet so let's make the component so we're going to do that next i'm going to i'll tab into here and the trick that i want to do is if you hit enter it should still be in the should be right here in line 31 what i want to do is put curly brackets and say show upload music you guys know what should know what show upload music is right what's the default state of this false when does it turn true when i click the upload button right basically you could set some conditional no rendering saying if show upload music is true right then we want to upload i mean upload show or render the upload modal component right essentially the upload model again this doesn't exist just yet but we can make it exist in the components folder new file upload modal.js rafc okay then we can add the import upload model from there so if i click on upload music we see upload mode hit refresh might ask us to log in because it's been a while now i don't see the upload model why not because by default this is false but if i click this there it is and when should it go away when i hit create new music which isn't set up yet so there we go so we updated the home page now let's work on upload model so with upload model there's a couple things that i want to pass down to it so let's make some space here and let's say the props that i want to pass down it's going to be title and title is going to have the value of title which is the state it's going to have the function to be able to set the title i'm going to have the set show upload music show upload music right because i want to put this function in upload model because i want to set it back to false either when i exit out or when i create a new model right so then let's do music url set this equal to the same thing and set music url also and new music right new music is what guys yes it's the function that we're getting from use spotify as you can see here okay cool all right so we passed down new music into there and now i feel comfortable working on the upload model okay cool so let's start working on this we can take out import react from react and what we will need is put curly brackets here and let's import all those props or destructure them rather so the props is just gonna be it's gonna be title comma music url the set title the set music url set show upload music so that's everything we passed down and destructured all of them and now let's work on the jsx all right so the first thing i want to do is make a class name and on click how's that i want to click and when i click on it what i want to do is set show upload music let me see is it here set show upload music set show upload muse all right does it glow up yep it's going up and we want to set that to default sorry if i click that button which is just cancel there it is so it should be like cancel upload right so the model is showing up it's not exactly nice yet but now the functionality is coming along yeah all right i'm not done yet we need another button here this button will also have it on click this time though it's going to have a function called create and you don't need this arrow here because i'm not directly calling it i'm not putting parentheses or you can leave it like this and this will have a class name of template literal and say style style.button but it also will have another's class name that's why we're doing this of style.create let's put s here too okay and if i save this we're going to see create not clicked how create new click is undefined because we haven't quite made that function yet so what i'll do really quickly though is right create new that's going to be the text for it and it's going to be closing button and that's the jsx so my computer doesn't yell at me i'm going to make that function create new clicked and now i think about it we don't even need to make create a new click actually we can just literally call new music right here yep that makes more sense awesome so now if i hit save hey we got two buttons awesome okay create new and we got the transaction may fail to confirm that's not a good sign we can't really check this yet because even if it did work we don't have any songs to get just yet so we'll hold off on that but it's good to know that the button works okay so i shall open modal i hit cancel boom there we go all right so next we have to do is do the front end now i'm starting to realize that this upload model is something i got from a different project and that one doesn't use tailwind so just to save time this one is not going to be styled with tailwind but we can do an import styles from and then the path so let's do command b go to style and again this it's already here so we don't need to style it already it's already done for us thanks to our cli tool once again so we can say import styles from dot forward slash styles yep upload modal css hey there it is so if you're just a quick overview this was given to you this was not done by me this is the create button everything that you need you can just play around with it and see how it's styled so again if i hit cancel boom and that looks funny so let's just double check our inputs again and put ah input file should be input field save hey there we go that's more like it one thing that was also weird is the modal buttons i think that's because the cancel button should have the same class name let's see if that works instead of create this should be cancel though hey that's more like it so smooth so if i hit cancel we lose the model if i upload music the model is back and that's how you make a model nice with all that done let's start working on the table itself like this area right here that's going to show all the songs that we have so to get started on that what i should do is let's head over to the home page and we can actually just do it by doing ctrl p and click this awesome let's start making playlist.js so we could do is comment this out now we can do control b and then under components let's make a new file playlist.js awesome do a little rafce come back to the home page and do an import import uh playlist from components playlist and they're cool all right so now that we're in the playlist component we can get rid of import react from react but we will import use effect and use state all righty so we know what those hooks do from here that should be fine let's make out the playlist and if you didn't know playlist is the table for all the songs so it's going to start displaying all the songs through here let's set up the jsx for it all right so if we want to set the jsx for it let's make our styles object and i promised we didn't give this one away we're going to do it together all right so the first div is should be called table wrapper so styles dot table wrapper and inside the table wrapper i will have a table and the class name of the table will be styles dot table okay inside of the table div or table tag it's going to be t body the table body which will have a class name styles dot table okay and then we can do a tr and within the tr we have th's and we have a couple of these so we can copy this a couple of times since we have a couple two three four we have a total of four and each one is going to have a class name of pb3 and we can copy this one over too so we'll be listening to this boom and there's four they all have pb3 and this one will have hashtag this will be title this will be place and this won't be an image so i guess we need to import image or actually we don't have to we could probably use an image tag here so let's just use a regular image tag and just say source is equal to assets time dot svg yeah hey there you go and just put the alt can be time all right so those are all the table headers the number the title plays and the timer looks pretty good now after that we can go next on the tea body and we'll need another tea body okay this is just a spacer so let's give this a class name of dash six block and then the next line here we're gonna map through the songs and for every song we should make a table row table row is just going to be another component that we make so let's save this for now then we can make the component and say table row okay now we have table row r a c e save come back to playlist and now that's the import we're missing table row and we can insert one right about here table pro cool all right looking good to me now before i move on let's do table row and style this one first so that it all comes together so i'm set up the jsx oh and before i do we don't need this okay and for the jsx it's not going to be a div actually it's going to be another tr body so t or t body sorry did i do did i write tr body in the other one no i don't t body we're good so in that t body now it's going to have a tr right and each t r inside of it is going to have a th okay and in that th oh it's gonna have a class name of styles.th and again this doesn't exist yet so let's make the styles object and for now let's put zero here it's gonna be props index or like the index of the song and then the next line we'll have another t with the same class name styles.th and then within that it's going to have a div with p tag so i have a class name font bold i'm only i'm not going to give it a whole class name because it's just once and then we could just do a title here song title we get the class name equals opacity 50 and it's just gonna be the artist or a quote unquote artist this one's actually going to stay static since we don't have access to the artist when we store the song okay and then that next line after line 15 actually not after line 15 i lied after line 16 we want another th so this th class name same thing styles dot th and then inside of that th we'll have ten thousand it's supposed to be like the amount of plays which will be static as well then we can have one more same class name styles.ch and it's just to have however long the song is which is going to be 2 43 which again is static okay cool that should be it for table row let's just quickly style it that's going to have just the th class which will be pb5 and a hover effect of opacity dash 50 and a cursor pointer okay cool all right so what i want to do next is head over back to playlist and now that i'm back in playlist let's go ahead and style that table so it looks a little nicer table all right it's this one let's do a table wrapper first actually so table wrapper is going to have a max width of 7 xl and m dash of p 3 m t 5 and then m b of 40. okay cool all right so after the wrapper then we can do table and the table itself is going to have a width full and text left nice okay comma then we have table header which is just going to have a border dash b let's give it like a gray border there's like a light a slight line that comes in between each song and it should be border dash grade dash 100 divided by 20. then we do pb5 here and an opacity of 50. hey that's it yeah table header nice again always looks a lot better when we do it like this that's the spotify here's the ten thousand plays and the time it's all lined up so now do you guys get what table row is for it's a component right for every song that i have i wanna map through each song and make a dynamic table row so this is like four songs okay so what we could do is think about where does think about where does playlist come from it's going to be through the home page so it looks like we need to get home page and we're going to need to pass something in the playlist so what we do is if we control b take a look at this data folder this comes with it with our awesome cli tool you're going to see activities which is basically all the songs you hear see here with snoop dogg and travis scott but there's songs js which i already set up i already set up a couple songs that we could test out so these are static songs so we can import this in our home page i'm gonna i use this just to test out the player and before i fetch the songs itself so let's import it temporarily import songs from data slash songs and if that's console log songs while we're here on to log songs songs are here so it's really noticeable click expect element console this should just be in curly brackets import songs from data dot songs now let's check this spect a array of two songs okay that's a good sign so now that we got the songs this is supposed to simulate us fetching the songs from the smart contract but we're using just dummy data for now and it's going to be imported as songs alright it's the same as this all right so let's comment this out for now so you don't get confused but we're going to be using this later but for now we'll use this so when put in playlists let's pass down songs as songs yeah and let's go back to playlist now we can destructure it songs and now if i inspect element let's hit console we can actually inspect the array and say okay so this has an index a title the artiste and let's see it has blink plays cool awesome has all the attributes of that song but one thing to note when i actually fetch the music the songs won't have all of this it'll just have the title or like the name and we'll also just have the url this cloud and everything it won't have index or well it won't have plays or anything like that so the rest of that static but we can make just simulate what that look like by doing songs.title our song is that index side right this way oh i know that's not here this should still be title what i want to do is go to table row and past nine songs so let's pass down songs on this first one and let's say songs is going to be songs and in table row can we get the table row destructure this again songs now we can do it so we can say songs dot index then we can also say songs that title and if you remember the console log this is actually really funny there's a typo it's songs that artiste all right this should also be songs dot plays and songs dot time let me see i already forgot okay song is that song undefined reading index so that's interesting so let me just undo all of that it doesn't know what index is okay let's just cancel out songs on table row oh i see i see so let's put that all back actually so just to show you what i mean if i can songs here we should see the same oh yeah so we should see an array but the reason why we see undefined is because i have table rows without songs so let's take those out for a moment all right now i should be able to just write them all out songs dot index one thing to keep in mind actually this is what i'm passing down is an array right songs is an array and if i just pass it down as an array it's going to be much harder to map through it so this is where i was saying earlier where we're going to have to map through each song so if i write song all right that's the array and if i do a map i'm going to iterate through right now the key here is if i write song and i don't even have to do this but i can console log song so what am i console logging here so this should make more sense to you so in playlist i take the songs map through it for every song console log it so what should i end up seeing refresh here is two objects and i see it twice but i see two objects right the first song and the second song because for every song and there's two it will cancel it so that's why i see it twice and what i want to do is return a table row right with the key being the song and the song info being the song and i'm trying to think of it now once i pass that once i pass down the dynamic props we're going to change this up but for now with the static props this makes more sense i'll hit save table row now i should be able to accept song and let's see if i can console log it it should be the object itself yep two objects and table row and now if i do song dot index look at that one and two what about title change title now song dot title hey there you go i want the artist i remember this one has a typo song that artiste hey okay all right and then you tell me what should i write here song that plays okay and then here song dot song time nope let me just double check that's what happens when you get the object key wrong ah song length makes sense hit save oops not there save here hey there we go guys so now we just made dynamic components using static data so this is what spotify would look like all right one thing to note uh the way that we saved it in the smart contract simplified meaning we won't have the artist name so there won't be and it's going to be a static artist the plays will be static and the time will also be static the only thing that's different is going to be this music title which we can will provide awesome so that's how we can set up the music all that's left now is to fetch all the songs and create one are you guys excited i know i am we're almost done with the project okay so the last thing that we're going to need to do in terms of front end is i want to make the little player that goes so if i click this it's going to play that song okay so let's head over to home page and that's going to be under player controls so let's just even out the space again and uncomment this out and create that component so in the components folder playercontrols.js rafce save and let's import him at the top import player control yep there it is cool so let's get to work on this okay so with player controls obviously it's the player that allows us to play the music we want and there's a lot of functionality because we have to be able to pause the music play the music skip the music and i'll get more into that as i write out the functionality but the main thing that we should do first is import a couple different things so let's import image from next image let's also import the actual image themselves as a name so let's import next from the forward slash assets slash next dot svg and again you should have all these images if you used our cli tool okay then previous from data forward slash assets slash speaker dot svg import speaker from assets slash speaker right it's pretty redundant but you know right this shouldn't be speaker it should be previous okay so you're basically importing the name of the image from that path so import repeat from repeat all right you get the idea we only have a couple more let's do shuffle from the same place assets shuffle play rounded you can do play rounded and then import uh pause icon from assets slash pause.svg okay cool so those are all the images cool now let's just work on writing the jsx what we'll do is set up the styles object clone styles and let's format this okay so for the class name of this first div i'm going to go with the name of main control and then from there we could do class styles dot flex center okay and then within flex center there's another div last name styles dot i'll cover container okay and then from there we can have an image and that image is going to have a source and i have the link for this you guys it's going to be it's going to be this really long thing here and if i hit save i can't save it yet because i'm going to do the height and width the height shall be 200 while the width will be 200 as well let's give it a halt and it's just like a song hit save hey that's our cp logo that's basically what it is that's going to be our album cover okay then it's a closing div followed by an opening this one doesn't have a name but inside of it it's gonna have two p tags with the song current song it's gonna be static for now it'll be dynamic later then another p tag oops another one and this will have the class name of opacity right because there's only one styling on this opacity oh is it because of the backticks don't worry okay and it's just gonna say harvest all right this is static once so that should be closing div closing div followed by another one with no name and then the div inside of that does have a name it's gonna be class name styles dot control icon container and then within that will be a div with the name control icon okay after control icon we can insert this image here and it's just going to have a source of shuffle so the cool part is i could just do source shuffle because we imported it like that and i'll hit save might be hard to see but it's there it's gonna like come off the page but don't worry it's gonna be fixed when i add the styling okay cool so that's the div for that closing div and then hit enter and for line 36 another div it's gonna also be styles dot control icon and it's also gonna have an image with the source of previous which is another image we imported awesome cool all right so i think from here let's add the rest of the images i want to do another div with the control icon again styles.control icon pretty much the same process except this one will be the repeat one awesome all right i think i'm just gonna make this faster by making another one and this should go above before repeat should actually be so make sure you make that change real quick so it should go shuffle previous next repeat yep there you go i like that and after repeat it should be closing div closing div and then another dip okay and that will have the class name of styles dot flex center and then it's gonna have a small right here and this could be a timestamp i'm just gonna say like something random like 130. all right it's gonna be static cool there's gonna be an input here this is really cool like javascript has like the audio tags that you can use to play music and we're going to make use of that right here so let's do value is equal to actually we won't do value yet it doesn't make sense to do it now but we can say type is equal to range though right and then we can say class name is equal to styles so we'll come back to in this input in a second yes so there's the little bar right that's how you can do it you can do it with the input if you guys didn't know okay self closing then there's gonna be a small here which is just gonna be the total length of the song which like i said will be static yep you can see how we're gonna move everything over into a row and format it so then after the small goes closing div closing div enter in line 57 we have another div for spacing and then we have div with the class name the div with the class name is going to be styles.flexcenter again and it's going to be an image with the source of the only one we didn't use i believe is speaker and the alt is equal to speaker and the input or another input here it's going to be value equals volume which you don't have yet so i'm going to hold off but the type again should be range right this is the how loud the music should go so we're getting another range type all right but the id we're gonna give this an id though and the id will equal volume and after that should be three closing dips hit save there we go there it is there's our beautiful speaker right here okay as you can see like the skeleton of it's right but all set up we just need to style it all right let's get to styling in the styles object i'm just going to do album cover container and we'll do a width and height 20 and a mr3 nice we do we can style the main control next and for main control let's do a fixed bottom i always want this player to be at the bottom zero left zero p y of three let's see we need a p five p r dash ten w dash screen and let's give it a background color is gonna be hash tag two four two four two four so just three two fours that's confusing but z 40 give it a flex and items dash center okay we're getting somewhere and justify dash between let me i'll see this so you guys can see that better how's that for my pause people yeah nice so now that play oh main control is there let's do flex center that's gonna be exactly what it sounds like it's gonna be flex items dash center okay and let's do control icon that's definitely there don't forget the comma and then in control icon it's going to be a margin five cursor dash pointer a nice hover effect of opacity dash 100 and just a normal opacity of 50. okay cool now let's do the play icon or actually let's do the container right because i want to make those icons all come together so let's do control icons container now give it a flex where is my control icon's container control icons container hey there we go so that added the s so what i did was go to the jsx add a s to icons container and then it should match up so now that i gave it a flex let's center it like this okay it's already pretty centered let's do a justify center we'll just we'll see this change yep and let's do m b two nice okay all right so we did a control icon but let's do the play icon and the play icon will be mr.5 with dash 10 cursor dash pointer and hover opacity dash 50. then we need the pause icon so where is the pious icon okay and i just double checked there is gonna be a play icon and a pause icon it's just that they don't exist yet but since we're styling i'm just gonna set it up now okay so for the pause icon and it's gonna be called pause icon style actually it's gonna have an mt3 w10 h 10 cursor dash pointer opacity dash 50. there you go and you're not going to see this change because there is no pause icon style and remember that cover photo that i erased there actually is going to be a photo i just double checked on the finished build the cover photo is going to have object cover all right so the last view if i organize it this way it doesn't exist just yet but later on when i add functionality it'll make more sense let's get back to our app let's log in cool and if you look at it full screen this is what it looks like a lot closer to the player now but with that done that is essentially the front end for player controls all right this is where we haven't used pause icon and play around yet but once i make the context and the functionality we'll come back and add it alright so as you can see we have the player right here but there's no functionality and i could write all the functions in player controls but that would make player controls essentially really long it's already 79 lines of code all right and if i want to make it so i can call these functions from anywhere we're going to be using the context api so i showed you guys how to pass down data through props but you could also use react's contacts api to access data from anywhere so let's go ahead and do that again this is mainly like a functionality thing so let's set up context through here so in our context folder let's make a new file and we'll call it context.js right here all the functions of the player will live which means pause play skip click and any states that we want to keep track of what is the current song playing our react app should our next app should know rather cool so we're going to need to do is import to use the context api we need in the context.js we need to import create on text also we need use state and we'll also need use effect it's all going to come from react okay cool and that's the only import it's going to take but we do need to is export const spotify context and set that equal to the create context hook so we can say equal to create context and then we can do an export const spotify provider it sounds really cool that i don't have to pass things down through props if i have it in context but in order to do we need to wrap our whole next.js app inside the provider set the provider equal to parentheses and it's going to take in children and here we'll do the arrow function and that should be it for now the next the next thing that's important is going to be this return right here okay it doesn't need those parentheses but this return does need to return spotify context dot provider and if i close this off it should look like this and just to show you guys in between the provider this is where the children will go the key thing all right if i format it now this is the same thing just formatted key thing is within the provider though if i hit enter not erase it hit enter boom i want to add a attribute of the provider and it's going to be value whatever i put in value right here is going to be global meaning i can call it from anywhere just like in player control so if i say something like i don't know song right in player controls if i put my context and use it i can grab songs from there if i set it up here so let's leave it blank for now and it starts to make sense once i create some state variables for you guys but that's what you want to set up and it should be like curly bracket like this perfect awesome so the spotify provider is done we're gonna need to hop into the app and wrap it there underscore app so we should be here back in underscore app and you can see we have the wallet connection provider what we want to do now is come below this required they import the spotify provider and you can see the suggestion from our contacts folder okay and what we want to do is the same thing like we did here within the wallet connection we'll say spotify provider and in between the spotify provider we'll put the app so you can see the provider wraps this which wraps this app is within all of that so if you do this we can utilize use context understand cool so now we can start fleshing out our context.js okay so the first thing i'll do is set up a couple states here so let's say const array equals each state and there's a lot of states that we want to keep track of there's about three six so let's make six copy paste three four five six okay what i'll do next is explain what the purpose of each variable is as i go this first one is going to be called the current song it's selfexplanatory i want to keep track of what is the current song that is playing so we're going to say current song for this and the initial state of current song should be an empty object because each song is going to be held in an object next i want to have state variable called is plane this is like the toggle or the flag that checks if something is playing like the show music upload music model is playing is going to be true or false so that's going to be set as false right so is something playing right now by default no nothing should be playing unless you want to set it to autoplay which you would then set the initial safe to true okay from there we could do is paused right that's another state we want to keep that set is right what should be the initial state now i'm giving it to you yep false okay cool so now there's another state called progress set progress is literally what it sounds like keeps track of the progress which we'll set to false they're essentially all flags that we want to mess around with we have volume here and it's going to be set volume default of that will be false as well all right so moving right along okay then we got time stamp uh not all of these might be used depending on what we have set up but i'll do this timestamp and this will be false as well okay cool all right so now that we have our states set up let's set up our player function so when thinking about our player functions the first thing i can think of is const pause right that's a function right so how do we implement pause functionality to our hacked what we could do is something like this set his pause is equal to true because if pause is true then it should be paused selfexplanatory yeah but then how do we actually pause the player like i said javascript has a lot of that functionality set up we just have to call on what we need to do is a document dot query selector and then do quotes hashtag audioelement and it should grab that player and if we do a dot pause here it will pause the player okay and essentially this is just to keep track of the state if it is paused or not this is actually pausing so that's the pause how about play we want to make a function for play too so we can play music what we can do is document dot query selector again and how do we grab the audio element you just say audio then play right pretty simple i personally don't use this that much i learned this recently right that you could do all this with javascript so set is pause is false cool now this is the fun function it's called cons play on select and it's going to take in our first parameter which is a song and let me explain play on select real quick if you go back to our app log in if i were to click this song right here radiant vibes it should be playing that song so this it was really running as play on select okay so that's what's happening play on select is going to run a try catch block right you know what this is and it's just gonna be e and it shouldn't really be an error so for now we could just console. but in the try block though we can run document query selector once again document.query selector and let's get the audio element and we could say that source equal to song dot music url because that's going to be the music our url of the song object that we pass in i'm setting the source of the audio element to that alright that's what it means from there we also want to do a query selector right because after we set the song to the player we want to be playing the songs and you guys know how to play the song now all you got to do is this dot play okay and then after we start playing the song we can do a set current song to the song that we pass in makes sense and if we're playing a song set is paused should actually be false and i think that's it all right that's the play on select so another function i want to make if you look at our app once again is as the song plays we wanna be updating the progress so in order to do that we're going to need to make a function that converts seconds to minutes seconds to min right then we can say equals arrow function and it's going to take in a value all right this is actually an interview question how can we convert minutes to seconds if we do const minute is equal to math.round right whatever the value is divided by 60. so if it's if some how many seconds are in a minute right there is 60 seconds in every minute so we could divide that value by 60 to get the minute then we could also say let second equal math that round that value and get the modulus operator get 60 and from there we can say a second is going to be equal second right greater than or equal to 10 all right and all this is a ternary if the second is greater than or equal to 10 then we want to zero plus second then after that we can just return the minute right plus the second okay this should be in quotes there we go right because i don't want to update it every second it should just be like an increment then we can also update that progress right you have to make a whole separate function for that so this is going to be e it's going to take e and essentially we can do const underscore progress is equal to e dot target current time right slash e dot target dot duration and then we can do a set progress right that's another state to underscore progress dot to fixed 2 but basically set it to two decimal places and then times that by 100 to get the type of number we want cool so that's how you update progress next we want to do update the volume to change the volume we can do once again and with e it's going to be a try catch with the catch being eagen and for the catch i'll just do console.log e dot message cool so in the try the main part let's set the volume to a target type value and then we can get the query selector of the audio element and then to access the volume of that audio element it's just dot volume or dot volume yeah and we want to set it to equal p dot target already so essentially whenever i change it we're gonna update the audio volume to whatever range i click okay next we're gonna need another function const on progress change set this guy equal to e arrow then we can say cons underscore volume set that equal to e dot target dot value slash level 100 and then we can do document query selector once again pass in the audio then we can do current time and set that equal to underscore progress times the document query selector we want to get the duration here so to do that i have to write this whole thing out it's hashtag audioelement let's do an alt c cool audio element dot duration there's the duration all right so the progress times the duration is the should be the new current time okay so that's on progress change and we also need on volume change on volume same deal e arrow logic so again const volume all right this is actually this doesn't make sense it should be progress and this one should be const volume and that's going to be equal to he.target value divided by 100 and document.query selector let's grab our favorite element and let's get the volume by saying volume and setting that equal to the new volume all these functions are going to come together okay the next thing if you look if i request this it should play the next song in the array so that's going to be called a const play next it's actually fairly simple it's going to take in the songs and then we can say const id is equal to songs dot find index again there's actually multiple ways to do this right so if you come up with a way that's more efficient than mine i'd love to you guys to share it in the comments below you can do a value here value.account equal equal to the current song okay so that's the id and then if if the id of the current song as long as that length equal to i d plus one what should happen is we should go back to the beginning all right so basically if we're at the end it's the last song and i hit next right this is a check right here and it should reset it back to the first song so we can do a play on select here remember play on select is the function that will play a song that we pass in we're using that here so play on select the songs and the first song of the array is songs bracket zero dot account okay and then we can set the current song to the same thing so songs bracket zero yay okay and then we can just return to just exit but if it's not the last song it should just play the next song so how do we get the next song the bracket zero is the first song right we can play the next song really easily so you can say khan's next song is equal to songs bracket id plus one right that's literally incrementing the index to the next one and from there we can just do a play on select and do the next song account next song dot okay beautiful that wasn't so bad so that's the con to play next and now for the play previous right same kind of logic i could set that to songs and the array here and from there let's write const id equal to songs that find index right same thing value dot account is equal to current okay so now basically if this the id is equal to zero meaning we're at the we're at the very first song at the rear a right what should happen if i go back and it's the first song it should go to the last song in the ray right so if it wants to go on the last song we can do a play on select use that function and we can do songs and this is cool so how do you get the last item in the array you can just do songs dot length minus one that will guarantee always give you the last item in the array so after you got the last item in the array you can do that account okay and then set the current song to the same thing which i'll just copy perfect and then return but that's if it's the last of the first song but if it's just not the first song maybe it's the song in the middle or it is already the last song if you do previous song equals songs id and then how do we go back if we know how to go forward it's just minus one and then we can just do a play on select with previous song dot account you got it so let's play previous and yeah that's actually all the functions nice okay cool so that's all the functions we could do next is go to value and just pass in everything we need so there's a lot to pass in we did we just typed a lot so if you need to go back at all feel free to rewind and pause to get what you missed so we'll need to pass in is playing set is playing current song set current song is paused set is paused right we're passing all of the states play function pause function the update progress one the play on select on progress change on volume change on play next yep you also need play previous you can get timestamp you can get update volume i think we're almost done we have volume and last but not least oh yeah that was it so that's it right there once i pass that in my provider all of that will be global and again whenever i use it somewhere else we don't need to bring in everything just the ones we need so let's hit save and let's figure out where we're going to need this context but what that's all the context.js alrighty so with our context set up let's start using our context in all the places that we need so the first place i want to think of is index.js there is an audio right here and as you can see we have on volume change and on time update but where do we even get those functions from yeah so to get those functions we're going to import use context so let's import these contexts from react and if we import that hook we can then import spotify context so import spotify context and now we can use it right so this update volume and this update progress they can exist if i say const update progress and update and we can set that to use context and then to pass to use spotify context just pass it in here and now we have update progress and update volume and then they exist so we should be able to do that now let me hit save now the next place i can think of where we're going to use context is probably the header let's do a header and at the top of header like i just said we're going to import use context again not that one react and import spotify context okay and the only thing that we're going to need from the header is the current song so how do we just get current song from use context or spotify context you can just destructure it and say i use state to use context pass this in and say current song all ready then what we could do is not that go to where does it say album oh it's right here album where it says current song right now that we actually have it we can just say current song dot album so now it's all coming together the pieces were set up okay that's it for header let's see player controls is probably what's next let's go to player controls yeah this one's to need a lot so prepare for this one let's set up the player controls at the top we're going to need to import our hooks use context from react and then import spotify next then in here it's going to take in a couple things all right so like i was saying we're going to import a couple things to our player controls so let's just set up that object is equal to use context and in order to get stuff from our spotify context we have to pass in spotify contacts okay cool so i'm just gonna hit enter right here so now i can format it to list out a bunch of different things so what i'm gonna get is current song we're going to need is playing essentially we're going to take everything from the spotify context to use here volume on change on volume change sorry time stamp progress see play next we got play previous pervious previous we have is paused we have play pause and of course on on progress change and that should be it awesome so that was a lot of things that's essentially everything we wrote in the context right minus a couple things so you get started right away by using one of them i want to start using is playing and if you remember the initial state of is playing is false and it will become true when we play something so let me just show you what i mean if you open this up again select wallet log in we can see the player down below but we can set up a condition at the top here that essentially says if is playing all right if this it doesn't exist we're gonna return no okay and so you see it was gone and that's because if this is false we're gonna return no and you wouldn't see the player but don't worry i'll come back up when i hook up the front end so that when i click it it starts to play alrighty okay so we also have a variable called current song which is again a state that we kept track of that is going to represent what is the current song that it's on or playing so what we could do is set it up so we can just write current song so we could say current song dot title i'll hit save and let it refresh all right if we just comment this out so we don't see any title here that's because what's the initial state of current song empty object well again once we hook up the rest of it if i were to click this then it would take up that title okay so for now let me just comment this back in okay so looking at the top here the next thing i want to work on is volume and volume we could put inside of whereas it says speaker there you go cool so input right if you remember there's this little thing right here and you can't really see it because of the size of this but this is the volume right we should want to set that volume to a state so what we could do is say that the value of this range is going to equal volume okay that's not all we also want to do on change and on change we're going to have the e and we'll call on volume change so when there's a change in the range we're going to call on volume change okay see that should be it yep nice okay so the next one i want to do is timestamp so timestamp that's going to go somewhere over here let's find it aha so here is timestamp right here instead of 130 we're going to write just time stamp it's gonna be the timestamp of the song that it's on so if we're like one minute into the song that's gonna be the time stamp okay uh while we're here there's also a value that i wanna input right here and it's gonna be progress because we should see the progress bar go up so i'll put that as the volume the value okay and while we're here as well there's going to be an on change and that arm change is similar to volume right except this time it's going to be for on progress change all right yes awesome okay play next and play previous should be pretty obvious play next is going to be on the div with the one that has skip or next right here and always do is right on click on click and this right play next and pass in pass in songs and again uh songs doesn't exist just yet but once i set it up you're gonna understand what i mean oh and i just remembered as i was setting this up there needs to be a pause button so just let me show you what i mean before you comment this out for a second that's why i was looking funny there should be a pause button in between these two right so let's set that up all right so we could do is copy this paste it here instead say pause and say the alt is pause so now let's see what it takes that is okay let me just double check oh pause icon okay pause icon okay and this one that's the reason i left this blank is because there's actually a special thing that we could do here right what i want to do is say curly bracket right here and say is pause right that's the state right because when i pause something all right let me pause the icon so it stops yelling at me okay when i pause something i click this it should turn into the play icon yeah that makes sense so that's why i have it set up right here so what we could do is set up some conditional rendering to change that so we could say if let me just paste this out if is paused is true right if it is true what should what does it mean it means that we should have div class name oops with styles dot play icon and show we'll also add it on click here while we're here for the play button but more importantly it should have an image tag and that image tag should have the source of play rounded and an alt of quotes then have another closing div right here perfect and then try writing another ternary and to be honest this is actually not going to work what we do need is something like this except with the styles of pause icon style now it's coming together so if i say class name equal to styles dot play pause icon style add in on click to pause pause icon or website pause all right i think that's what it's called yep we can then image tag self close which has a source the pause icon and for the alt we can just say pause and then just close the div off we should be fine okay awesome look at that we got pause and play right so that's why we set it up later because now i could use this pause so that we can do conditional rendering all right now i just need oh i was in the middle of doing play previous right so this and line 63 for me for with the div that holds the previous image we want to make that clickable so if we make it clickable we can add it on click you can say e you can say play previous and pass in the songs array because the previous takes in an array and it's just gonna increment back so that is previous now let's take a look that everything is playing that's gonna be used here and bam there we go so that i know that was a lot but we used a lot of the functionality and gave this app a little bit of life all right cool then if i comment this out play pause play play plus awesome so that is it for player controls the next thing or next place that we want to use this is probably going to be in table row so with table row that if you remember that's going to hold all the songs and i want to be able to click the song and that's the song that's going to come up in the player so what function does that it's going to be play on select i believe so let's do import our use context so we can utilize it from react and then from there it's spotify context cool and coming at the top of table row we can now destructure what we want from you spotify or spotify context and we only need one thing and one thing only like i said it's play on select nice remember table row for every song in the array it's going to make a table row so there's two songs in the array so there's two table rows and the cool thing that we can do is on the tr right here we can add on click and essentially say to play on select and pass in song and i'll just play the song object so that's perfect everything that we did before is set up this fits in nicely okay all right so that should be it with updating all of our components with use context one thing i want to do real quick is come to the home page and for player controls it should also be taking in songs all right remember songs is the array of songs that we get uh right now it's static or the static two songs that we have and then from there go to player controls then we can destructure songs and now when i type in songs this does exist now so this should make more sense so it's going to play the previous songs from the array that we're passing in and play the next songs from the either way we're passing it perfect okay so i'm heading back to the home page because that should be it for updating our context one thing i want to do is go to player controls and this should also take in songs as a prop and if we do that we're gonna have to come back to player control and in the parentheses here the structure songs so it's perfect and now when i type in songs it doesn't make more sense that this exists now so what it's going to do is play the previous song in the array play the next song in theory awesome so looks like that is all set up now okay so with that done the app is pretty much done everybody so if we go to the website once again all right i want to show you guys what it would look like to play these songs because the only thing that's left to do is to utilize or create music like i said and fetch those songs instead of the static ones but for whatever reason you don't want to be using the songs on chain you guys want to use local songs on coming from your computer i'll show you guys how to play to use that right the way we have it set up if i were to click this it wouldn't work mostly because if i go to context go to play on select take a look at this query selector right here right i'm setting the audio element to be song that music url and that makes sense because on our solana playground that is the actual attribute of the music account but if you go to our songs.js i highlighted already but where is the url of the song no music url it's gonna be right here link okay so instead of music url we're gonna have to write song dot link all right and if i hit save here one thing i'm checking is you also wanna set is playing to true okay and then we're gonna have to log in again because we updated the context but now that we set this is playing to true and we set this to song.link let's see if it works first try hey look at that we're literally playing audio using javascript and it looks just like spotify we made spotify guys how awesome is that and you can see composite just as you want and you can see the icon come and change you can also just click on anywhere an app and it will skip to that part this is amazing so all i want to do now is let's see if our smart contract if we can use the functions from our smart contract and it works first try sounds good all right so i just reformatted my windows and all we want to do now is let's make use of this upload music and let's go ahead and put in the music url right again just a quick note music url isn't a loot youtube link or anything like that right i'm going to paste it right here you're going to see that it's this res.cloudenary.com all i did was upload my mp3 file onto a cloud hosting service right from there it's going to generate a link and it's just a reference to where i uploaded it in the cloud you can use whatever cloud service you want the main focus of this tutorial isn't that website it's about how to store stuff on the blockchain so use whatever you want for this i just use cloudinary if you did want to use it just go ahead and make an account and upload your files there got it so let's upload star searcher that's the name of the song it's pretty cool it's this nice lowfi beat let's go ahead and create new okay and then you see transaction may fail to confirm that's usually a bad sign so let's see what happens as an error let's hit approve a mute constraint was violated okay so that error tells me that something in the smart contract so let's go ahead and cancel that let's go into here and we can make this guy bigger let's see what's going on so i'm assuming it's somewhere in create function and it said a mute constraint was violated so something that should be that's that is put as mutable shouldn't be mutable so that's fine this is payer context player account probably somewhere in create music context so let's see what did i make mutable okay random key should be mutable yep that's going to be different every time authority should be mutable because that's going to be the signer who's ever paying which will be different system program that is going to be the same so this should not be mutable so that actually might be it so i made a change to the contract i don't have to redeploy make a brand new one i can keep this address right what i could do though is go ahead and hit build okay and now that it's done building we can just hit upgrade and it looks like we have enough solana that's one thing i do like about developing on selena is that we can upgrade our contracts instead of deploying a whole new contract in a new one imagine if you kept making mistakes and you had to redeploy and you couldn't upgrade it's going to be a lot of faulty contracts on the blockchain but i'm sure in the future as technology improves more and more contracts should be upgradable depending on the chain you're in perfect okay cool so you guys should know the next step after we upgrade we're going to have to export the idl cool then we can just click this and it should open on our bs code so let's move this around control a control c and then we're going to head over to our spotify.json alright oops control or alt z delete and then we're going to paste what we got from ideal boom hit save connects this guy out and we should be good to go all right so now moment of truth just to double check i'm going to click onto this guy ctrl j and let's start our terminal over once again awesome then we can hit refresh okay let's try this upload music the song is called star searcher and we can go ahead and paste create new fingers crossed hey look at that so again if you see this little price estimate and not transaction may fail to confirm there's a good chance that it'll work i want to get my hopes you know too high let's hit approve and let's see what happens prove the modal disappeared which means the rest of the function ran so the only thing that's left to do is let's check if that actually works so what i'll do next is head over to my home page oops not printing head over to the home page and remember we're using songs from the static json data i have we don't need that anymore our songs live on the blockchain right so we're going to get this array back in this huge state and one thing we're going to remember is we never used get songs as a quick refresher it's going to fetch all the music from the music on the pro on the sonata program so we're going to need to do is run a use effect to use it so let's say use effect right and i don't know i only want to run this once so the use effect what i want to do is get songs right from the smart contract and then after we get the songs we'll do a dot then we'll say take the what we get as a return which is going to be an array and then set the songs like so so let's hit save and also just console log what songs are all right we should see an array of one i'm gonna hit save yep so now it's gone that's okay though i'll hit inspect hit console hey look at that we're fetching songs right from our new spotify and then we also get this array of one i don't know if you guys can see that but take a look at this object here the keys and values are different there is an account key right when i open that account key up then we get the music url and title which is the music account that we set up cool so if that's the case we're gonna have to hop over to our context and fix it up right so again i changed it back you're gonna say song that music url right because it's not link anymore so change that on context.js go to your play on select go to where it says equal song that link and change it back to music url another thing is that even though we have songs let's go to home page we are passing it in playlists but the problem that i'm having is on playlist there's no table there's no table rows that are getting populated so let's go to playlist then oops keep printing so i'm going to playlist right the reason we don't see anything is because i'm mapping every song or a quoteunquote song is going to be an object that has the accounts key which holds the count so what we really want to do is go to our home page on our home page sorry go to our playlist component and see if i could just do a song dot account because that should hold the music stuff hey look at that star searcher we did lose the number of plays and the number of the timestamp that's just because if you go to table row now there is no title there's no artiste well there's a title but there's no artiste there's no plays and there's no song link so that's why it's going to see it blank if you did want to have those things this is just the simple bright version if you did want to make those more dynamic you would also store that in your music account on salon okay and you'd have to input all of it manually based on the way we have it set up now the last part that we need to do is see if we're able to play the song that we got from solana so fingers crossed there it is all right you guys can hear that awesome and you can even skip ahead let's go beautiful so that's it that's pretty much the app guys we are successfully able to pull the songs that we store on the solana chain the only thing that's left to do is deploy our app and make it live with digital ocean so let's go ahead and get that done all right so now that we're done with our app the next thing we want to do is like i said upload to digitalocean but before that let's push our code into a repository and if you used our cli tool you're going to notice that if you do a git push you're going to see of denied to your user fatal unable to access blah blah blah that's just because when you use the cli tool you're really just running a git clone of our spotify project so when you get cloned you don't own that repo so there is something that we can do what we could do is go to our browser right head over to github and all you have to do is make a new repo so if i go to your profile i go to repositories go to this repo that i set up right it's just a completely blank repo this is going to be the url without that repo so what we're going to do is just copy it head over to vs code and to change the remote origin you can say git remote set dash url origin 2 and then you're going to paste it boom all right should be connected because now if i do get push hey it worked right you could also do a git status right and we could see all the changes that we made since then so we were able to push to the repo let's see if it did anything boom there it is so the original contributor is david as you can see but now this is my repo and i'm gonna push my changes that i added to it so these are all the files that we edited all right we can do a git add dot to add all of them and we can do a git commit then we can say something like finished spotify clone again it's funny usually you push in between to save your changes but we're doing it all at the end and then we'll do a good push all right so keep in mind what you see here these are the commits from david but if i hit refresh boom right now it's me finished spotify clone that's all the stuff i added yeah pretty cool right so now we have our own repo called spotify blockchain the next thing i want to do is some setup before we move on okay and again like i said we're going to set up some things to get digital ocean right up and running go into your next config and in the next line after domains i have the code snippet save you're going to need to add this pieces of code right here okay then from there let's go to our package.json and we're going to need to write an export script and then for the export script i had a add a comma right here and it should look something like this this is the snippet of code that you'll need take a moment to pause and copy it right and there's one more thing under scripts right here just double check it's not here already okay it's going to be engines right node right there cool so take a moment take this and this export that's new i'm gonna hit save on both and that should be it all right what we want to do next is update our github so how do we do that you can just see we're gonna change we get status all right hit add dot commit dash m all right updated get push perfect so when we go to our github hit refresh now now i can see the update commit messages here awesome so now we're all set up to go for digitalocean so let's head over to digital digitalocean.com awesome let's sign in and again don't forget to sign up if you haven't already okay and to continue on if you guys don't know what digitalocean is or if you forgot from what i said earlier digitalocean is infrastructure as a service all that means is it will provide you with the actual cloud hardware right in english digitalocean runs and maintains a bunch of servers that we as developers can use and reprogram to how we want it so that means it can do a whole bunch of things in short as you can see on the left here there's apps droplets functions kubernetes databases that we can all utilize for whatever we need it can be public it could be private the main thing that we want to talk about today is how to host and deploy a static site using digitalocean so we're going to go into apps and right you're going to see their little shark here i love it his name is sami shark i believe as you can see it's pretty selfexplanatory right they're gonna detect what our map needs to run then they're gonna build and deploy it for us so let's create an app and again we're using github so that's the cool feature is that you can connect it to github directly let's see manage access and let's give it access to my account install authorize okay we're greeted by sammy once again perfect so now it's going to load all the repositories from my github account and select one and if you remember the name of it it's not bts it should be under lance or maybe if i could type it up it's going to be spotify clone blockchains this one right here okay cool and also loads all the branches of your app right and for us we know it's going to be cli starter right that's just the branch name that we inherited from the original project so let's click that cool source directory yep it's there then we can do auto deploy this feature is really cool so every time you make an update to our repo the application will actually redeploy so we can go ahead and hit next cool then we can click on this button i believe we'll next do web service all right you want to edit this what we want is a static site right that's something you guys are more familiar with and then for build command we can run our script and just say yarn export pull okay so after we did yarn export and run that script we can just get back then from here we can hit next this looks pretty good to me there's no environment variables that we have to worry about next next perfect and again this is going to cost us 0 dollars because digital ocean provides us with some starter apps for free so let's hit create resource okay and said the app has been created now we can go ahead and go to build logs just take a look good so far running yarn install fetching packages ooh i see the done all it looks like i got all the assets ready okay uploading build cache build complete ooh it says deploying instead of building come on sammy hey right the light app is looks like it's live build complete this is the link this nice oyster app over here let's go ahead and click it aha login to access app that's a good sign we'll click on phantom hit connect and bam there we are guys this site is now live for us to click on and if i click again just for fun awesome take a look at that guys so this site is live you can go ahead and add this link to your portfolio you can send it to your friends like i always say and that's pretty much it guys i hope you enjoyed the video be on the lookout for our upcoming videos we have a lot in store for you guys so i'll see you guys in the next video peace
