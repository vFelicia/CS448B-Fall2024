hello welcome back to part four of my evolutionary steering something food and poison system thingy now guess what this creature here has violated the laws of my universe and in the chat I don't remember who it was I can give credit to somebody pointed it out Thank You somebody with a youtube name I apologize keep better track of that somebody will tell me who was the first point that's out now it's violating the laws of the universe you can just wander across a piece of poison and not even eat it now why is that there's a couple reasons why literally one reason why but look at this remember I was like oh I'm going to let them have a perception radius all the way down to zero well what if it's perception radius was like point zero zero zero zero zero one or even one zero then it can never even see the poison and it actually will only eat the poison if it can see it now there's one thing my perception radius my desire was that for that perception radius to only be that something that it occurs to either be attracted or repelled to it but if it wanders across the poison by accident it should still eat it and same for the food honestly you should get to eat the food whether to perceive it or not so one thing I should really do here I mean I really should have this checking to eat be a separate check I mean I do have this distance here so I could check it whether it's like the closest or not like I really should just check it here should eat it whether it's attracted or not let's do that so I'm going to just take this there's a lot I could also just make a minimum perception radius but I feel like doing it this other way for some reason like I'm just going to check right here like hey right before I check if it's something it should be attracted to because eating and being attracted to or different things like I cannot be attracted to it but I can walk across it and I've eaten it I suppose in this the way that I'm thinking about this world so I'm going to say if the distance is less than five I'm going to eat that thing and it doesn't even matter if there's like three in a row I'm just going to eat it whether I'm attracted to it or not so I'm going to do that and then also I really should be more thoughtful about this number you know what would make sense is this a look at at its maximum speed is five but this actually makes sense because if it can go Matt five pixels at a time anytime it's within that maximum speed it's not going to be able jump over it so I'm going to use that just in case I change the maximum speed later I'm going to just change that to this max speed and then I've got that same problem if I'm removing stuff while I'm iterating through it I should really iterate through that list backwards so I'm going to put this here length minus one I'm going to say go all the way down to zero and instead of going up while iterating now let's just see if everything works say ah error so what did I do cannot read property copy of undefined seek line 81 so this is a problem maybe what I should do so if it eats it and that happened to be the closest one it's not there anymore so it also if it's eating it it doesn't count if something that's attracted to any more okay so it can't eat something and also be attracted to it so again probably this could be refactored yet again but uh still problem okay so part four was supposed to be about the evolutionary stuff but now I'm just debugging problems I realize this is not going to work oh boy you know got a really watch out for I it's actually start part four over no I'm going on here this is what's happening you're watching this you're still here this is no good because remember I'm saving something that's the closest and then I'm going backwards through the array if I take something out stuff moves around the array and I save the closest index which is no longer the index anymore here's the thing though I don't need to I can fix this I don't need to delete it down here so I don't need to save the closest index what I want to do is actually save that closest location so closest is actually list index I so I need I needed to save the I because of removing it later but now that I'm removing it here I just want to save that particular location doesn't matter if you're a shifts around and now I can just seek the closest I'm pretty sure now Oh if closest is not know right now use the check not if the index is valid but if it's not no there we go so now I should not I should no longer be able to have something that violates the laws of the universe everything should eat the food and the poison whether it's seeking it or not and this one you can see I died so like I made it kind of hard for them and we might need to make it easier but i am i hoping my hope is that there's actually a kind of optimal and this one looks pretty good there's an optimal one that it's going to need to really be able to see the food better that's not optimal because it needs a bigger radius of food anyway so let's add the evolution it's time for evolution did I just really do that in my video I guess I did okay here we go so so okay first of all if you've watched any other genetic algorithm videos you will note that there is a process to a genetic algorithm in the traditional sense that process is create the initial population evaluate the population for fitness apply crossover and mutation to create a new population now run it again but if you watch through all of my videos towards the end and I'll link to this also in the description I discuss another way of thinking about an evolutionary system which is a more continuous system right there is no fitness function these agents these elements these creatures just have a random chance while they live to reproduce so the longer they live the more likely they are to reproduce and so things that live longer that gather more health and resources will have more chances of reproducing and hopefully over time the things that aren't so great are going to die out because they won't have a chance to reproduce so something that more mirrors the way that an evolutionary process might happen in the natural world okay so let's add that so the first thing that I need to do is I need to add a function and I'm going to call it I don't know if I should call it clone because is that like a that seems to be like some kind of JavaScript actual word so I could call it copy which is also some sort of key word I'm going to say clone clone me I'm going to make a function called clone me oh did it just not turn blue because I'd gotten rid of it yet okay that's fine I'm gonna take a function call clone and what that does is it returns a new vehicle at my location with my DNA so the idea is that there's a function that creates a new vehicle it doesn't have to be at the same location but that makes sense the idea that suddenly I'm just going to copy myself and by copying myself I need to copy my DNA so here's the thing there's a lot of one thing that you might think about is like oh maybe there's some scenario where they there's two and they actually have to be next to each other and then the DNA gets used as cross over to like combine the DNA to make a new vehicle but I'm going to just do this simply by having just a copy but that would be an interesting thing for you to try and then maybe they have to evolve some kind of attraction force where in addition to eating the food and avoiding the poison they also have to be attracted to each other so that they can manage to copy themselves so but I'm just going to write this function called clone and what I'm going to do right now is I'm going to say for every single vehicle and you know what I'm going to do I'm going to say if random I'm going to build this into the function maybe every frame they just have a 1% chance of returning a copy of themselves otherwise I return nothing no and a JavaScript function by defaults going to return undefined probably so I would just want to say just want to do this like 1% of the time so what I'm going to do here is I'm going to say var I'm going to call it child or copy child I'll just call it new vehicle equals vehicles index I clone if new vehicle is not equal to null then vehicles dot push new vehicle money this evolutionary aspect is like the simplest artifice and boy I mean there's some more pieces that I haven't done yet so this idea of every so often one out of a hundred frames if it lives four hundred frames there's a good chance that at least one of those it'll make a copy of itself and then it will add that to be right and luckily I got it oh this is a problem look at this vehicles no no no that's okay because I starts with that so there really could be an issue where if I'm adding to an array one iterating through it it's never going to get to the end but because I've already going through backwards I can add stuff to the end and just still go down to zero and I'll be fine so okay so I think I'm not going to get stuck at some infinite loop here let's now try running this so we should see let's make it really happen really often just so we can see that there's these new vehicles 10% of the time we should be overwhelmed right we're overwhelmed with stuff so that's clearly absurd and I'm going to crash the computer so 1% of the time it might be too often as well but let's leave that for right now 1% of the time kind of want to add a piece of food ooh what happened there cannot Oh so why I think that happens look at this so it's possible right now for a vehicle to die and then clone itself so I can put this just before I check for or I could say like maybe it's about the diet it's not allowed to like show I should let it like have one last shot let's let it have one last shot to clone itself okay so as long as I clone before I delete it we should be okay okay so now you can see this stuff now here's the thing actually copying its DNA so I could write this function as much as I want that's called clone and I could pass in DNA supposedly copy but my constructor does not have an argument so I need to add a third argument called DNA and what I want to do is if write what I want to do is if DNA exists is not is not undefined I think that's okay if it's just a it'll be any array is going to be defined it's going to return true right so but maybe what I'll do just to be now that's fine if DNA I'm just gonna say if DNA is equal to undefined so if I didn't pass in that argument then make the DNA randomly right this is what I should do otherwise otherwise this DNA now I don't want to say DNA I could do this but this is a bit of a problem because what I actually want to do I might want to adjust and one have like a little chance of mutation so what I want to do is I want to say this DNA index so no matter what I always want to make it an array and then I want to say disdain and I really should do this in a loop but I'm not going to for a very silly reason in a second so in there's only four properties so I'm going to just do these manually Tara I can't even look at this there we go very very weird feeling in my stomach very uncomfortable I think this without a loop but here we go now I should be copying the DNA oh boy boy they really like to make copies of themselves so I also think that this needs to be much less often let's make this much less often phone is ringing again okay a bunch died out now one looks like it's going to do pretty well copy yourself come on get that food make a copy of yourself come on you can do it they could copy of yourself because that's like one every a thousand frames that's way too little I kind of want to get lucky and like have a do it and have it a copy of itself but this one look at this off of all their did okay so we can see it works you can see that one that copies up now it died immediately because they were both right there and they like consumed themselves so yeah it's a little bit of an issue there one thing that I think would be really helpful I've done this with these kind of systems before is to add this idea of if one dies I'm going to create a piece of food right where it dies so let's create a piece of food at x equals vehicle's index position dot X so let's get the XY of that vehicle and let's create a piece of food there this is really going to help because this is really going to help because that way if there's like a bunch then like a whole bunch died there's a lot of food for the one that survives so let's add that and let's be hopeful that we get something good now here's the thing one of the key principles of evolutionary system is variation I'm really not getting that much variety to start with so one thing that I might do there's two things I really do add to this to have more variety one is that let's make how many vehicles do I make I make ten so let's make 50 to start with and you can see that's kind of too many and also that reproduction amount was like way too little so let's not make it point one but let's make it point zero five so there's a lot of them now so you can see like a whole bunch to hide all at once and left some food so let's see kind of like who survives so I'm gonna let this run for a little bit and see how it goes now it's really not there's not a lot of food so I don't know if I need to add which is fine because they're really copying themselves a lot so they're gonna die this one's good this one should be able to like kind of pick up a bunch of a lot of food now and then there's more food getting at it's going to die so anyway so you can see here there's a lot of stuff to tweak and I got to stop myself from tweaking and tweaking and tweaking alright so I have one last thing to add one thing that doesn't have there is no mutation right now and mutation is a key aspect of an evolutionary system because what if the initial population doesn't have the right amount of variety and or enough variety the optimal thing that we're searching for is not there in the initial population so as these elements clone themselves if they adjust their properties a little bit we can introduce additional variation now there's a lot of ways I could do this number one is I could just randomly pick new weights a steering weight and randomly pick new perception radii if raising the plural of raises but what I'm going to do just to demonstrate and I've done that and that happens in some of my other videos but in this one what I'm going to demonstrate is like just adjusting those values a little bit because I think that'll be interesting to see so and I'm going to do this in kind of a very inefficient silly way and I can leave it as an exercise for you guys to write the code in a nicer way but for example I'm going to say oh I mean I could mmm I hate what I've done here so one thing I would be better would be to have all of these have a normalized range like if all of these values were always between zero and one I could just tweak all of these randomly the same way but because do you have a different range than this but I'm going to do this in a very longwinded way and you guys can imagine and I'll refactor this code another time in another video or just in a different example or you can do this as your own exercise but I'm going to say if random one is less than and let's make a global variable I'm going to call it mr for mutation rate and I'm gonna say there's a 1% mutation rate which is probably too low but if random one is less than the mutation rate then this DNA 0 adjust it by some tiny small amount move between negative point 1 and point 1 now I'm going to do that for this one for the second weight during wait and then I'm going to do the same thing for these last two things but the range I might want to adjust it is between negative 10 and 10 maybe I'm going to and I probably should cap it so it can't go below zero but whatever good enough for right now so I'm going to this I don't there's so many things about this that I don't like but it's good enough for right now I could rewrite this into a nice reusable function where I pass in the mutation rate and the amount of change I'll leave that as exercise for you so this now randomly they should be adjusted okay here we go now let's run this let's see how it behaves so we're just let this run for a little bit we're gonna do some deep breathing didn't you do to do I'm back from the past to the future speaking in a falsetto everything died out so this is this is the sad truth of this as much as I have this idea of like you know artificial general intelligence they're going to sort of like learn how to do it so much of this right now is a topdown design system and getting this to behave in a way that's going to be interesting is really adjusting and finetuning that system and you may I'm going to publish this code and the things that I would like you to think about doing is you might be able to adjust create a whole interface with sliders to adjust like the rate of how food is added how poison is added adjust the different ranges are just how much the health goes down let me try to at least get this to behave a little bit better one thing I'm going to do is I'm going to add food at a much higher rate which will make it easier I'm going to have the and also have the nutritional value of the food be a bit higher and so I'm going to make that point 3 and I'm going to actually make the poison really bad seven five okay so I'm gonna make a poison little worse and it's kind of bothering me how big those dots are which is so unnecessary but I'm going to draw them a little bit smaller I don't know why it's like designs clearly not my forte but let's let's let this run and also I could add something where I could click the mouse often add new vehicles but let's see what we get over time here there should be a lot of food you can see you know there's gonna there's some element of balance here if there's too many good things they're going to eat all the food but you can see what's left right there's a bunch let me travel to the future again doo doo doo doo doo doo doo doo doo doo doo doo doo I'm back with that one more feature where I could say just in the main sketch I'm going to say where as where the vehicles here I'm going to add the mouse drag function and I'm going to make it so that whenever I drag the mouse I'm adding new vehicles at Mouse X and mouse Y so I can run the sketch in hopes and whoops vehicles I get I just say vehicles dot push ok so I'm going to let this run for a bit hello from the future so I made some tweaks to various variables in the same like how much is the help increase and you can see now something rather optimal has kind of appeared which is what I had suspected all along and said which is that you can see here's a whole bunch of vehicles with a strong attraction to food not being so attracted a strong repulsion to poison and being able to see food much farther than be able to see poison you can see this is just propagated and they're just kind of eating up all the food now at some point they're bunch of those are going to die out but when they die they add more food so I think we have arrived now here's the thing a lot of stuff that I didn't do one thing is this would be much nicer to look at and I'm going to if I just made a little checkbox that I could check here and then I don't see the debugging information cuz I really don't watching the debugging information is just for me to have a sense of what's going on and I can barely understand where the food is and what the vehicles are doing so it would be nicer to look at it we've got add that after this video is over and have it as part of the code then of course there's all sorts of interesting possibilities here what are other things you could add to the system what are somebody suggested having the probability of reproduction be related to actually their health value so that if they're really healthy they're more likely to reproduce then if they're quite close to having a health of zero so I'm sharing that lots of creative ideas and at an interface to play with different parameters design is in a different way make this into a game somehow somebody suggested oh well the user to save them by adding food who's all sorts of possibilities here so I hope you enjoyed this really long four part coding challenge I hope that you make something creative with this evolutionary system expand on it I would love to share results of things that you guys make in future live streams or videos and so thanks for watching stay in touch leave a comment I'll be back more videos of lessons okay good bye you