hello in this video I'm gonna look at how if you have a live capture coming in from a camera into a web page how you can add a button to that page and save snapshots overtime photobooth like kind of sketch and I'm using p5 to s so this is where I'm starting I have a simple p5 example which has a canvas which is here it has a video Dom element over here the Dom element is grabbing the image from the camera and then I'm drawing it into the canvas so let's go over to the code and I've got the code here you can see that create capture video change the size of 320 by 240 and draw that onto the canvas so first thing I want to do is just stop drawing it onto the canvas and we can see this is what I've got now and I want to add a button to the page so I'm going to say create button snap and if i refresh it you can see there's that button and make this a little bit bigger and you can see there's that button snap so the idea here is that I want is whenever I hit the button I want that image to be saved and populated into the canvas so how do we do that so the first thing I need to do is bind some sort of event to the pressing of this button and the way that that's done in p5 is with well first of all once again if I want to do anything with that button I now need a variable to keep track of that button over time so I'm gonna add a variable called button at the top and I'm gonna say button equals create button and then I will say button dot Mouse pressed and I'll call this take snap so what goes in here is the name of a function that I want to execute when I press the mouse on that button and this is PFI specific there are lots of ways in JavaScript with other frameworks and native JavaScript and jQuery to do this same sort of thing but np5 has a nice simple hook for a binding an event to the press of the mouse which is naming a function that goes into the mouse press function that's an that's called on the button object itself so once I've done that it's now my job to write a function called take snap and in that function what could I do I could take exactly this line of code that just draws what is currently in the video to the canvas so if I save this and I go back and run this again we should see now that the video is playing if video is capturing there's nothing in the canvas but you can see that as soon as I hit that button I get the current image into the canvas and now I can do this and you can see I can kind of create a little like stopmotion dance animation so we make it get out of this if they want to know what I'm doing anymore got lost in my own little world therefore sigh can we turn off the video and just dance the night away even though it's 11 o'clock in the morning which is not really the morning I digress so let's try to make this though a little bit more interesting here which is that I didn't really save anything I don't know what it means to save anything you certainly could like download the image to the computer we could ask that actually that could be a feature we could add but what I think might be interesting to look at is how might I save those images over time so since I have this white board over here I feel obligated to use it let's think about this for a second I need some sort of nap this out for myself so we have the canvas we have the video and the only thing that I'm doing is that particular moment in time I'm drawing you know the image from the video to the canvas but what if I could do something in the interim over here and the thing that I want to do is actually call the function get so get is a function that maybe I'll get to a little more later which is a way of like grabbing pixels from the image itself but if I call get with no arguments what it does is it grabs an entire copy of that image so what if I had a array when I called it history so a blank array like this and every time I press a button I add a copy of the image to that array so I'm actually storing image after image after image whenever that button is pressed that way I could potentially in my canvas I could see a whole bunch of images snapshots over time so let's take a look at how we might do that okay so let's go back to the code what are some things I want to add the first thing I want to add and audio still working is a variable called history which will just be an array so an empty array and now I said instead of instead of right here just drawing the image drawing the image to the screen when the button is pressed what I want to do instead is say something like this history dot push video push being a function history is an array video is the video Dom element push being a function that adds something to that array so I'm going to add the video Dom element add the video Dom element every time I press the button only that's not what I want to do so this looks kind of right like Oh every time I press the button add you know the image from the video to the right but this the variable video is not the image it's the entirety of that Dom element live capture stream thing itself so that's not what I want in the array what I want is just a copy of that image so I need to use that get function so if I come back over here and I say video dot get this is what I want so you know I can run this right now but oh history dot push is not a function why is that not a function yes it is is is history some other variable a name for something let's call this as snapshots is is something else called history in the world of JavaScript yeah that's strange somebody will tell me what that was so sometimes if you get that error you know this is by the way I made a video about namespacing linked to it now but something you could walk into by accident which apparently I just did in JavaScript especially working with p5 is that making up all these like global variables and there's a lot of default stuff yeah history browser history I'm sure there's a global variable that just exists in web browsers called history that has to do with the browser history and I just messed up by overriding that so watch out danger danger don't do that so I'll call it snapshots and what I want to do now is we can look at here snapshots is an empty array so this is the chrome developer console I recently made a video about how to use that and now if I hit snap a couple times and look at snapshots again you can see that now it has an array with a bunch of p5 images in it and there's more stuff with these p5 images that up that we can kind of look into width and height and all of that but let's not worry about that right now now how can I do something with these images well one thing I could do let's um let's do one thing with it let's make the canvas wider and in draw let's add a loop that says for VAR I equals 0 I is less than snapshots dot length I plus plus let's draw image snapshots index I let's draw all of those images so this is gonna I don't know what this is really gonna accomplish but let's run this and you can see now it's only showing the last one why is it I did a loop to draw every single one it's only showing the last one well it's drawing them all the the but it's drawing them all on top of each other so one thing I could do that would be kind of interesting I've no idea if this is gonna work is I could add some alpha so look at that now you can see that it's drawing them on I'm getting a nice little ghost averaging thing I got because I'm tinting them as I'm drawing them let's draw them next to each other so one thing I might want to do is draw them a lot smaller like maybe I'll just draw them at 80 by 60 and maybe I'll actually make that a variable 80 and 60 and use those variables and I'll say let me have an x and a y so what I'm doing here is I want to draw each image at a particular x and a y as I'm looping through the array the first one at 0 0 the second one at x equals x plus W so now what you would see is you can see here that each one is drawing next each other now when it gets to the edge of the window which is over here maybe what I wanted to do if X is greater than W then I want to reset X back to 0 and have Y go up by H so I'm just making a little algorithm inside this loop that no matter how many images there are they're each being drawn X is moving over when X gets to the end X goes back to 0 and Y goes down so now I can run this and we should see here's the video down here and I can ooh what happened there if X is greater than W that's not correct if X is greater than the width of the canvas not W which is just 1 over so that's no good so let's run this again and then I'm gonna you can see my little kind of stopmotion boy bridge sequence now incidentally it's kind of funny that I'm doing this right here like pressing the button because I could just as easily do this so so anyway so you get the idea here there's a lot of possibilities I have this whole array I can mix and match them I could create a puzzle could chop it up I mean my mind just bursting with ideas and I hope yours is as well but and you can see also like that the I don't know if you can see this in this recording of the video but the program is running a bit slower now I have this big array of images but but I wanted to do one more thing which what I want to do let's say I this is a little bit insane these you should just stop watching this now but I want to see if I can make these be in motion so I want to see just sort of like the last however many images and I want them all to be on a delay and moving let's just see if we can do this 10 minutes into this video you can think of this as completing the lesson but let's just see if we can make this happen so let's think about this for a second what I might want to do is first what happens if I just put this in draw itself okay so I'm saying push video dot get and let's and let let's let's run this for a second and count it and I'm gonna run this for a second we complained so one thing that happened is that the video a draw happens immediately but the video wasn't actually ready just yet so I need a sad sad world we live in what I need is an event I wonder if I can add an event here called ready and I make a variable called go equals false and now I'm gonna said go so I think there should be a callback to create I don't know if this exists in p5 we're about to find out there should be most of these functions in JavaScript have a callback like create the capture and use but it's not what I need to know when you're done creating it so I could use it and so I passed a callback called ready and I'm just gonna set a boolean variable equal to true so I can say only if go then start capturing those snapshots and I can take this out here as I've gotten rid of the button and I'm gonna have to we don't need this button anymore that worked so you can see what's happening here so now let me pause this let me say no loop so I need to do something ridiculous which is count this 1 2 3 4 5 6 7 8 9 10 times for there are 40 so I need an array with 40 so I only want to what I want to do is actually I want to change and have a counter so I want to create a counter because I don't want to I only want to have 40 images at a time so what I want to do is add a counter so instead of just always adding an image to the array or what I want to say is snapshots index counter equals video get so this is going to do the same exact thing I'm going to be I'm going to add images to that array and run this again counter equals 0 why didn't that work somebody let's see what this error is a sketch dot 4 I have a syntax error oh it boy my land isn't my mind is in Java land var should be the name of the variable so I'm going to do this and we can see ah so it's working but I didn't increase the counter so I need to say counter plus plus and now you can see this is working now what I could do is say aha when counter gets to 40 go back to zero so now I could say if counter equals 40 because there's only 40 total counter should go back to zero okay so now this is a good time to do jumping jacks I have to do them over here right you can see my trail of jumping jacks is happening up here you know there may be like a second spaced apart you can see it's still doing it and do I still have that tint in there that's funny I still have the tint let's get rid of that and refresh I forgot that I had that the whole time no wonder this is what I expected it to look like I'll do some jumping jacks so you can see now I don't know why the bottom maybe I did my math wrong there 43 did I get the math wrong there uh counter equals 43 let's try that you know I obviously could do some actual correct math there we go so now you can see I've got this like history of the last 43 images always continuously there and I want to do something a little bit weird so this is pretty good and I think you could probably make some creative experiments with this and make it bigger or smaller or whatever but and I'm just like off the deep end here by Billy a fifteen minutes so this is fine so let's think about how to make this notice that I'm always just drawing the images 0 through 243 and let's make that I don't know why that's the VAT let's make this total equal 40 let's make that a variable I swear I don't understand my math here but just gonna go with it so one thing I want to do is that in addition to drawing the images I want to offset them this is gonna like seem weird but let me let me just do this and maybe it's gonna makes it's making sense in my head right now because I think I've done this before many years ago but I'm going to what if I said I plus frame count so in other words I want the zero image to be here then the zero image to be there then image to be there every frame but as soon as we get past 43 I need you to use the modulus operation boy modulus might not be familiar some of you I believe I made a video only about modulus at one point and so let's make this a separate variable just so we can kind of discuss what's going on here pretty sure this is gonna work so let me run this see if this does what I expect look I have an error so I must have got oh so first of all I could only do this once counter has got I need I need 40 images first to start with so so this is only going to work once 43 or whatever once I have the total amount so this one so I wouldn't think of like a really simple way to approach this I'm just gonna say if if oh you know what I don't never mind right this is silly all I need to do is say snapshots dot length because I can just do this based on how many elements are currently in the array so now you can see that ah that's what I was hoping for okay so you can see that everything's moving why did this work I mean I so this is uh this is a pretty standard kind of like trope I would say in kind of creative coding looking at this video and seeing like many many copies of it on a slight delay we could make that delay bigger or smaller we could kind of cycle it around I made a project like 10 years ago that does exactly this I think I called it time frame and I I just have to do like my sub weird like though dancing I think to see what this looks like okay but let's try to think about why this is working for a second and again you know I don't know if anyone's still watching this video like 20 minutes in but I hope that you make some creative projects with this you might run into an issue by the way if you don't have that p5.js bug fix but I can help you with that but let's think about this so remember this is the array and let's just pretend the array has one two three four five things in it and you know the animation looks something like this now supposed to be me with one arm so you can see like the of an animation of a dial going like this so this is the canvas and this is continuously also shifting and getting new elements in it but what's happening is so the current the actual current frame is is going in one at a time so without that strange modulus really it's trying to make this make sense I don't know that this is the best drawing but without that modulus what I was seeing here is just literally the array copied into the window so we see these static images that are getting updated every once in a while but if what I'm doing is actually the zero element of the array gets drawn here then it gets drawn here then it gets drawn here then it gets drawn here you're actually saying end of one element is also moving you're actually seeing that animation it's in the array play out because each spot on the screen that static is seeing different elements from the array but the array is also being updated by the current elements from the camera and so how is that working basically what I want this is gonna I now I know how to make sense of this right I'm gonna put the index values here so first the index values go like this then the next time the index values go like this and then the next time oops I only have four here I messed up but you get the idea then go like this so then the next time it's three four zero one one two so those are cycling so how do you do that if you always have if you have that loop this is I so okay sorry this is i 0 1 2 3 this is I plus frame count which would be 0 1 2 3 and then 1 2 3 4 then 2 3 4 5 then 3 4 5 6 right so this is I plus frame cap the modulus operation if I was saying this music my hand terrible I didn't wash my hands in a second if I am saying now I plus frame count modulus for the modulus operation is like division but not like division it's the remainder of division so if I say for example three modulus for three modulus for is the 3/4 is zero remainder 1 4 divided by 4 is 1 remainder 0 5 divided by 4 oh sorry 0 divided by 3 sorry 3/4 at is 0 remainder 3 5 modulus 4 is 1 remainder 1 6 divided by 4 is 1 remainder 2 so what the modulus operation does is it cycles everything back between to keep everything within the original range of the array boy I got a reaiiy this video was going so well till I went off and did this but hopefully you found this interesting I'm gonna publish the code with this as I upload this video and I hope that you guys will make some experiments with this particular idea and share them so I can see what you made ok I'm gonna hit stop I got a I got to come back to that that you know something I should just do this again I'll make more sense but I do