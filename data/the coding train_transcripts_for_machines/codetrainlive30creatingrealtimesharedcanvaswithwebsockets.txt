trying again I had a failed stream wh but that's not a good way to start hello good morning evening afternoon I'm looking at you you are in the form of a Canon lens but you are a real person I am a real person my name is Dan I am here in the world uh this afternoon I'm ready to talk about code and various things um before I get started um let me just see first of all let me see if things are are uh working here I don't think that my streaming to Twitch is working unfortunately but I'm I think I'm just not going to worry about that right now um uh can so the first thing I would like to know is if the audio is okay how's the audio uh the second thing I would like to know is if you can see things okay let me ah I'm on this computer let me open up processing because I'm going to do something in processing first uh it is about 1 15 2 p.m. eastern time on Tuesday April 12th uh can you see this processing sketch can you read this font if I walk over here oh I'm I didn't oh I didn't do my uh usually I wash the Whiteboard uh can you see this whiteboard can you read what's on it doesn't seem that bright but um let me know how everything looks and sounds I'm going to check out the chat audio seems okay yep works uh I'm GNA say uh try tonight 11 people I actually set out sent out an a MailChimp announcement I don't know if anybody got it saying I was going to come on and do this at uh 145 and it is um and I'm going to just see if twitch oh great so twitch is working um if you're I guess I am streaming to Twitch if you're watching on Twitch I see things in the chat saying you are so great um okay so um let me let me uh introduce what's going to happen today so I um I think probably everybody who's watching are people who have watched before um but um uh this helps me figure out who I am and what what place I have in the world but I uh live here in New York City I teach at a program called ITP at New York University I am on a leave for the semester and I'm spending time at a place called the school for poetic computation which is in the West Village uh it's um sfpc doio encourage you to check out their website um but I set up a recording studio here and I'm trying to dedicate myself to uh experiments in education online um and other types of experiments but in particular through this live streaming it's important to me to have have personal interaction so I'm trying to do stuff live with a chat uh I'm going to record some stuff as tutorials the topics are generally creative coding Graphics web JavaScript processing Java that sort of thing so I want to try something different today I don't have any coffee which is usually a good thing for me because the coffee is a problem um and usually I have a glass with water on it water in it instead I have this bottle which is very bad for the environment so maybe I'm going to try not to do that in the future um but what I want to do today is I want to start a new segment which I call the 10minute coding challenge so um I got a message on Twitter asking for help about creating a warp speed simulation I don't know if I just Google uh or Starfield kind of thing so like if I Google like a Starfield uh simulation uh and like uh JavaScript or something uh this so you can see here uh this is what I'm interested in trying to create uh sort of Starfield simulation like this oh this is a nice one in uh 10 minutes um I'm like looking over here at my hair um so and I also have figured out how to make a timer appear in the Stream that you're watching in the corner up there so let's so I'm going to try to get that set up uh I've got 14 people watching so uh the topic that I said I was going to do today which has been highly requested is p5js uh so like a drawing canvas in a browser that communicates over websockets so that if you're drawing and somebody else is drawing you can see what the other person is drawing so I am going to get to that but first I want to try this idea of a 10minute excuse me coding challenge just to see if it works so the first thing I need to do is I need to run this thing called desktop presenter oh um and uh so hold on ah because I need to hit save so I had to set up so I'm using something called wirecast and wirecast allows me to take multiple inputs combine this green screen with my computer screen move back and forth between different cameras and what I want to do is uh using something now that I found called desktop presenter which allows me to capture a portion of another application and overlay it so I'm just going to make I'm having a timer running in the browser for example um yeah so let me see if I can get this going so I need to go to uh uh so you'll have to bear with me for a second I'm going to do something that you can't see but you'll be able to see it in a moment uh so I've got desktop presenter going ah this worked earlier uh aha okay so let me see here sorry everyone this is going to take me a second because this is new and I had this I had this set up and working before I started the stream and wirecast crashed and my settings didn't get saved so I'm going switch to this got it okay this is good this is good oh no no no no uh oh yeah uh okay uh that's fine oops okay hold on this is working differently than it did before but I think it should be okay um and now let's see here uh edit shot I'm going to add please work uh new desktop presenter Source new local desktop presenter source and I'm going to hold on you'll see everything will be okay in a second output output settings no no that's not output settings Source settings oh never never configure your stream e e okay sound should be back sound should be back am I back can you hear me okay good okay so so I'm getting ready close this umh okay so I'm gonna do my first ever I'm going to call this Starfield I'm G oh so this is bad where I have this hold on a second everybody uh because this will block the code um I got to do a better job I think of that's probably fine right okay uh there we go this I don't need here oops I can't click on that this I don't need here can move these Down clean up okay how are we doing everybody you see the timer above my head you can hear me again and I'm G to do this uh 10 minute coding challenge okay uh I see in the chat ask does anyone know how long this is going to be so my plan it's now 200 is to stream until approximately 315 330 so perhaps an A little over an hour or so um so I'm going to first do this 10minute programming Challenge and then I'm going to take a break and uh start talking about node and sockets and p5js all together okay uh let me just check twitch here uh okay it's back audio is back uh there's only one person watching in twitch I'm not sure if I should keep the twitch stream thing going but okay so uh here we go all right hello okay so uh I've only wasted 11 oh you know what I this here is that's okay maybe it doesn't bother you so much if you see my laptop a little bit here big deal right um okay all right let's do this so the first thing I have to do is uh I'm gonna hit record refresh all right let me give it um I have an idea I'm going to give it a that do that okay uh now I have 30 seconds till it's time for me to begin okay I'm going to begin this oops once it hits 10 minutes I'm GNA start here we go I need M themed music hello welcome to the 10minute coding challenge this is a new segment that I'm starting here on the coding rainbow uh where I'm given a programming problem and I'm given 10 minutes to solve that problem and when the timer goes I've got to stop recording so uh someone uh I'm not prepared for this but normally I get a coding Challenge from somebody so insert person's Twitter handle here uh wrote in and asked how do you make a Starfield warp speed simulation visualization so I'm going to do this in the processing programming environment I will also make a p5js version of it but not in this 10 minutes and I'm talking way too much I got to get started programming so the first thing I want to do and I'm going to skip a few steps here that I might normally do just because I feel like I'm in a little bit of a hurry and I see the clock I already a minute of starting I haven't started programming yet I'm going to make a oops NOP don't rename I'm going to make a new tab here and I'm going to call that tab star because what I want to do is make a star class and I want my star class and I probably could use a p Vector but um I'm not going to use a p Vector at the moment I want to have an X and A Y and a z um and when I make a star object I want to make uh I want the uh X to have a random value between uh zero and the width of the window and why i' have a random value between zero and the height of the window and truth of the matter is for Simplicity sake I wonder if anyone was going to watch this video on YouTube on like two time speed because it's G to be a f minute programming challenge I'm already talking really fast so when I talk really fast than the five minut okay now I'm GNA do void draw and I'm going to say size uh 400 400 so I want to have a window that's a square so I don't have to worry about width versus height maybe we could figure that out later but I need a random um and then I'm also going to make Z some random value Now you kind of wondering wondering if I have an X and Y and a z shouldn't I be in 3D space and probably I should be in 3D space to really create this Starfield simulator but but I'm going to try to do this in 2D because eventually I want to import this to JavaScript and canvas I don't want to deal with webgl or 3D rendering just want to kind of create the illusion of stars moving quickly past my face so let's keep going here uh so now what I want to do is I want to make an array and I could make an array list because I want to add stars when they get off the screen I'm going to remove them but I'm going to do something simpler just going to have an array array of stars uh I'm going to put like a hundred of them in there um because uh I think what might make the most sense uh is when a star goes off the window to just reuse that same star in the array but reset its location back um and I'm going to say uh Stars index I equals a new star and then in draw space is what color the Blackness of space so I will make the black background and I'm just going to say like uh update and uh draw display show I'll just do show um so this is the basics outline of the program I make a bunch of stars I update them and I show them now these functions don't exist yet so I need to go back to my star object and I need to say update how am I doing on time six minutes left and I need to say uh show and the main thing I want to do is uh fill 255 no stroke I want to draw an Elipse uh at that X and Y location and I'm going to make that ellipse just like eight uh and I'm going to run this and make sure this is working good okay so I do see uh a bunch of things that look like they could be stars now I need to make them move so they really should move like they should move going to move this closer to myself this is bad for me to start talking I really just got to keep programming but I want them to move like Fanning out from the center and as they go out to the center I want them to go faster and faster and that's what I'm going to use that Z value for I'm essentially going to divide you can think of you can think of the ratio of their location from the center to the edge and I want to divide by some value so they're so that value I'm dividing by is getting bigger and bigger and they're moving out to the edge I think this is going to work and I I saw an example like a year ago um I'm going to find that example and link to it in the video because now I'm realizing this is kind of based on that um um uh it was um anyway I'll find it okay but I can't talk about it too much right now because I only got five minutes left so what I want to do is I want to say something like this I want to say uh I'm going to make a new value called like uh SX and I want to say x ided z um and then I want to uh map that value kind of like a ratio which goes between zero and one uh to between zero and the width and and I wanted to do the same thing for y y / C right because Z and let's just like let's just pretend they're all starting really far away right so basically what I'm saying is that I want them to start the they're the I almost shouldn't use Z I just use the Z because I'm thinking of them as being closer or farther away but I really want a value between zero and one and um let's run this again and we should see kind of looks the same but now the difference is I could say here zal Z minus uh 1 and oh you know what I've done here that's bad everything is happening according to the top left corner this is a terrible this is this is a problem and we've got to correct this because I only got four minutes left so I can translate in draw width divided two height divided two this makes a lot more sense because really what I want is to be translating to the um I want everything to be Fanning out from the center not the top left so if I do this you can see things are Fanning out but still from there so all I need to do now is really think about this as like negative width to width and negative height to height that should that should do well and you can see here um and and let that only um 100 Stars wasn't so many so let's make 400 and you can see things are moving out from the center you can see as they move out they start getting faster and faster and faster because I'm dividing by this number oops and you can see them now so they're coming back they're getting sucked in Back to the center and I also divided by zero because I got this Infinity problem so I need to do a couple things number one is um I need to deal with the fact that when Z gets down to zero I want to uh reset Z back to somewhere else and also let's have them all start at a random Z and then if Z is let's just say less than one because I don't want to divide by zero Z should get a random uh actually should just go all the way back and uh you know we could give them a new X and Y also and I could put this into another function now look at this so now things are moving out and you can see as they as they come back they're they're reappearing now here's another thing I could do uh first of all uh let's make this whole thing bigger and let's make uh more more stars just to be able to see more uh so you can see how this is looking now they're moving kind of slowly so I also think that it would make a lot more sense for this to be like the number 10 and you could see ah there we go we're so we got something that's really starting to look like a Starfield right uh you could but the thing is they're kind of like popping up like they just appear so one thing I could do is also change their size right if they're farther away they should be small if they're closer they should be big so right now the ellipse is always drawn the ellipse is always drawn at oh my God I only have two minutes left the ellipse is always drawn at 8 pixels so what I want to do is make another variable called R and uh Rand not random I want to map their uh zv value which goes between zero and wi to when they're uh close being zero they should be big like 16 and when they're far away being uh withd they they I shouldn't be able to see them at all and so now if we if we do that you can see they're far away they're small and as they come closer they get bigger and bigger now this is like a Starfield and let's just by the way let's make this uh really quickly uh whoops uh let's make this just like uh how Z changes a global variable and let's be able to control that by the mouse so I'm going to say uh I'm going to add a variable called speed and I'm going to say speed equals map the mouse X Mouse X which goes between zero and width to between zero and I don't know uh 20 so now I can control the speed right as I move the mouse over I'm moving faster I'm slowing down I'm moving faster I can to get to warp speed and I've got one minute left because I want to do one more thing I want to see these streaking I want to see line streaking with one minute left 59 seconds so what do I need to do them have them streaking well I want their current location I want their previous location I want to connect those things with the line so I'm actually going to make more variables I'm going to say PX and py and I'm going to set those uh variables here to um PX = SX pyal Sy y oh um and uh and then I want to um also draw a line oh I realize I'm going to have a problem and I only have 26 seconds left I'm gonna oh I can do this line PX py SX Sy y so this is fine uh you can see there's a problem though which is when they get to the edge uh when they get to the edge um when they get to the edge they're drawing they're connecting a line uh to their um to their previous locations so uh so really what I should be doing is saying this uh what the hell I I failed okay the the you know whatever so that was the 10minute coding challenge you should stop now i i i i this is really like so dramatic and exciting and yet I totally failed but I'm gonna I'm GNA give myself I'm gonna give myself a bonus two minutes bonus two minutes bonus two minutes to solve this problem so I kind of was screwing around here because I was trying to be tricky and get the previous location but really I don't want the previous I I need to keep track right every time the previous location when it starts should just be its X location and the previous and then each time after it moves and I draw it then I should update its previous location then it gets its new location but really what I want to do here for that line is say PSX PSY and it's not oh my goodness the X doesn't matter the X doesn't this is the whole problem it's the Z Z the Z all I care about is the previous Z I knew something was going on here I want previous z boy previous Z because the Z is the only thing that's changing it's X is like its position in the world the Z is what's actually causing it to change um so I want pz to start being previous Z to start at Z and I want to draw and then the whole point is oh and the camera goes off and I have 54 seconds left we're going to make this happen in my bonus 2 minutes um I'm going to um I'm going to say here float yeah yeah PX equals and this exact same formula but now I want x divided by pz and py I want x divided y divided by pz so now I'm drawing a line between the two locations we don't care about this although it's probably a good time here to to give it its previous location also whoa something lunacy is happening what did I miss I have 19 seconds left X x divided pyz oh height no but that shouldn't matter oh x x here we go here we go here we go so close six seconds left what did I miss PX oh SX XX SX s y here we go there we go so you can see now in all of its Glory the warp speed streakiness but it said 1 second there for a while cuz it doesn't actually say time expired until like click over here okay uh interestingly enough something is definitely not working because ah I forgot to say pz equals z there we go so you can see it's streakiness uh let's uh make it go faster I'm really failing with the 10minute thing we'll see how long this video is in the end it's only I it can't be more than 15 minutes otherwise I really feel like a total failure I'm going to turn off the ellipse for a second and here we go this is what I was sort of hoping to see you can see the streaks as this draws the lines and I can slow down and I can put those circles back in there there's all sorts of possibilities here so I hope you enjoyed this video about how to make a Starfield I'm also going to upload a JavaScript version of this that will run in the browser uh the links to both the code for both of those will be in the description if they're not there write a comment reminding me and I will see you in the next edition of 10minute coding challenge which is is probably going to be 15 minutes us tweet me with a challenge I'll keep track of a list of them and I will do it in the next time okay all right I'm afraid to look at the chat here uh okay uh right semitransparent background that's a good idea cheating there's lots of cheating going here uh uh okay yes sound is okay okay people seem to be sort of enjoying this uh uh I didn't see the Tweet about the Matrix rain wolf ABP but that's a good idea I would definitely consider that if if bonus points for has a rainbow associated with it uh somebody wrote that the problem is when you write a comment in the chat and when I go back to read the chat it was from like 5 minutes ago so I have no idea what you're referring to so if it's a comment that's relating to something I'm doing that you really want me to be able to see and respond to you're going to have to say someone wrote that's cheating there's lots of that's cheating by the way I have a specific point of view I should make this its own video about what's cheating in programming here's my point of view it's all cheating it's all cheating there's no actual Starfield so it doesn't matter whether you're using quote unquote real 3D math or fake cheating 3D math it's the illusion the magic of what you're making that counts so there is no such thing as cheating I suppose the only thing that would be cheating is copying somebody else's code and not giving credit to them but even copying somebody else's code if it's open source blah blah blah is not cheating as long as you give credit little rant there for a second um okay so uh time expired um so I'm gonna um minimize my timer now and I'm going to uh close close this I'm going to leave this let me just uh maybe I should make the P5 GS version right now really quick well I don't I I'll do that later I don't want to make sure I have time um yeah okay so I'm just curious what happens if I now do this yeah still seems fine although it's probably a little bit skewed because I'm actually using height in the calculation which I probably shouldn't probably only works if it's a square like I really should be doing this for it to look whoa uh correct just picking one value but anyway uh I'm not going to worry about that too much plus I should I should pick randomly uh anyway I'm not going to worry about this too much this worked and the um I'm pretty sure I'm GNA find I need to find the thing that this is based on uh I think it was from a brinar uh example um okay uh so all right so that was today's uh 10minute coding challenge hello 22 people watching live in the YouTube stream uh I hope you all are uh please uh feel free to share with your friends if this is happening sign up for my oh so I I'll plug this now uh that on my uh uh new website there's a place here where if you want to uh sign up for live streaming updates you know I I I haven't really I probably should just have a set time every week where I'm doing this but I'm I seem to not be capable of that um and for example I just sent an email this morning being like it's going to be at 145 today so I'm going to try to do better scheduling this sort of stuff I can tell you that 100% this week I will not be doing any live streams on Thursday and I hope to be doing one tomorrow as well as possibly Friday um okay um so I lost a few viewers there and plugging my own website I am now going to switch gears and what I want to do I'm going to show you an example uh I've got to somehow grab this uh okay hold on a second I made an example earlier um uh so I'm finding something that I'm going to show you and sockets I'm going bring that over here and it's probably GNA do something where oh good okay um so um uh uh sorry I should I have to turn my phone off when I do this because I'm like looking at people's Twitter messages um desktop sockets okay uh let's see if this works uh and so open up Chrome so I just want to show you what it is I want to now do a tutorial about oh that's too tiny um so let me hold on a sec uh desktop uh sockets um black index okay I'm going to show you uh okay what I want to show you is the following whoops I have two browser windows each open to the same p5js sketch these could easily be two browser windows on separate computers in separate parts of the world they are both connected to a server that server is also running on this laptop but it could be running in the cloud anywhere else in the world as I draw on one you can see what I'm drawing appears on the other one uh a different color is used just so you can kind of see that more specifically so this is what I want to demonstrate how to do how do you host a p5js sketch from a server how do you have that server uh how do you have that server uh how do you have the sketch connect to the server send messages to the server in real time have that server send messages to other clients um and obviously I've made this example already I made this probably like a year ago I updated it this morning so now I need to make a bunch of video tutorials that go through the steps of how to build this um uh okay um somebody in the chat asks um can I watch the can I can I rewatch this later so U let me just quickly answer that question uh yes you can rewatch this later as soon as the stream ends the entire stream is archived on YouTube on my channel youout shiftman I also what I usually do is edit the stream to take a few key chunks of videos and um uh uh make those separate like Standalone tutorials so right now I'm in my I'm trying to sort this out phase uh of this project and let me open let's figure out um together I think I can these are links by the way let's figure out what would make sense here so the first thing I need to do is you know I have tons of sketches that already introduce P5 so I'm not going to include that in this particular tutorial but um the first thing would be what uh what is server side programming node and sockets so like that's the first thing I need to cover right what is you know why do you need server side programming for this what's this thing called node which I'm going to use for Ser side programming I have a what is node video for my twitterbot tutorial series but I think I might kind of like redo that content a bit as part of this particular section because I also Imagine a lot of other things that you would do with server side programming np5 with um so then um adding Express and hosting uh files adding socket.io uh connecting okay that could be one tutorial Express and hosting files another tutorial could be adding socket.io uh package with events and then adding sockets to p5js client okay so I think this is four videos in my mind the first so four like 10minute tutorials do I have time for this in an hour boy this going to be rough well if I don't finish all this I'll come back and finish it tomorrow but we I'll do as much as I can today so a basic kind of just introduction to this idea um you know one and two could probably be combined I might just sort of improvise that uh I think that that number three and number four definitely need to be two separate distinct uh videos so this is my plan um a lot of people have requested this yes um um uh uh jonko is it yonko or jonko there's H someone in the chat named jonko Bosch who uh was one of the people who had asked for sockets maybe you sent me an email today that I haven't responded to yet I think we'll get back to you um uh okay so this is my plan I'm going to uh take a really really quick break uh before I get started if um if um you uh have any ideas or thoughts about this list please write them in the chat I am going to mute my microphone and I will be back in one minute e e e okay I'm back apologies for any audio glitchiness that happens right now I am trying to re add the microphone here it was kind of tugging on me in a weird way um I am back hello okay so if you're just joining um I'm looking checking the chat uh stuck at loading uh Matrix rain oh there somebody has a matrix rain okay uh okay um okay so if you're just joining I'm about to record a set of videos about how to make something like this which is I'm going to hit refresh here this is a p5js sketch that's communicating with another instance of itself running in a separate browser which could be in a on another computer somewhere else um one thing I wanted to look at really quickly to refresh my memory is um uh because I the first thing I want to do yeah is look at uh here so um so large data set I guess so I'm trying to think of I'm trying to think of uh reasons why you need serers side programming so what are reasons why you need server side programming so you can do a lot with just p5js client side JavaScript what I've been doing in most of my videos got an HTML file got some Javascript file you draw stuff you connect to apis all that sort of things but things that you might need to do is one is Real Time Communication so that's what I'm going to focus on today other things are like dealing with uh large data sets right you might want a server to like process those and return the results um saving data although you could use somebody else's server for that um ah uh uh scraping web pages and other things you cannot connect to from client uh tell me in the chat what are some other things that you need server side programming for that might be important to mention um and then um uh and then what I need to have up here are so let me close this I don't need this right now got to get myself ready here I need to have uh node .js the website and I need to also have terminal open uh and okay and what I'm going to do is create a I want to uh I want to create a blank sketch and I'm going to put it on the desktop as uh sockets coding rainbow okay that's good I'm just getting myself set up here I want to open up Sublime Text which I have already uh remove folder from project and let's go get uh this one here uh okay um now uh let's close this I don't need that close this close this um okay what else do I need to be ready to do this I have Sublime going I have terminal going um but I'm actually going to just do this and I have a processing I'm going to quit I have the browser with with node running and now I need to what I want to do is uh remember although am I going to do that in this particular video I'm uh okay adding Express and hosting you know what I'll do that in the next one okay great I'm it's going to get set up basics node short video and the next one we're going to add Express and hosting files so that's fine I think this is good uh so okay I am ready to go how's everybody doing yes so okay so um uh Mr Guru asks are we able to play along in real time you should be able to play along in real time uh if you want to play along in real time the two things you should do to get ready are number one uh download node and install it on your computer because I'm going to I'm going to mention that you have to do that but I'm not going to do that in the video in the tutorial um and then you should have terminal open uh and if you should have a folder with a blank p5js sketch you don't actually even really need that just yet but that that I'm going to use um that I'm going to start start with like the assumption that I already have like an HTML file a Javascript file and a folder called libraries um okay um and I think uh unfortunately what I want to do is also uh secretly run I think I should mention at the beginning what it is I'm doing and uh going to have another instance of it running over here okay okay I think I'm ready for this first video I'm going to cycle these cameras on and off and I'm going to start with the first tutorial uh oh first um let me just check here I'm going to check the that's not good so I'm definitely going to use the Whiteboard um there's some weird shadowy stuff going on that's probably better still weird shadowy stuff whatever um and I'm going to sorry I'm spacing out uh let me just make sure this looks okay can you read and see that looks like it's okay um all right wish I had a darker is this marker better let's see oh yeah much better I'm me use this one for sure okay okay here we go all right I know I'm sorry like I really have trouble getting started because I feel kind of freaked out uh but I'm going to do it okay hello oh I sore I I swear I would never swear and then somebody edit that out in this video I'm here to look at something new uh something kind of exciting to me which is and let me just demonstrate it for you first what I have here right over here is a HTML 5 canvas it's using something called p5js and I can move my mouse around it and I can click and draw on that canvas but look what happens when I do that when I click and draw on that canvas there's another canvas over here where that same drawing appears and if I come over here and I draw here something in this canvas appears and you can see the color is inverted now this might not seem so magical to you but I I I'm I'm making the case to you that these two browser windows with these two canvases could be on separate computers in separate parts of the world so what I'm here to demonstrate to you today in a series of short tutorial videos is how to use server side programming with your p5js creative sketch to allow for realtime communication between multiple users of your sketch so this could be used for playing a game or a collaborative something or other you could have video Al there's lots of possibilities of things you could do but I'm going to demonstrate it with a basic collaborative shared drawing space so I have we have to add if if you're coming to this video having only ever done the basics of programming in JavaScript with p5js you're in the right place we're going to add something to this which is serers side programming with node.js now if you've watched any of my videos I have done some stuff about node in some videos about making Twitter Bots but we're going to do something slightly different with node here and I'm going to start a bit from scratch again so let's um let me talk about what the pieces of this are so for example uh the idea here is that you have a laptop and that laptop has a browser window with a canvas that you're drawing in and somewhere else in some other part of the world there is another laptop with that canvas and with this canvas and as you draw that same drawing appears over there so somewhere else there needs to be a server what happens is this particular instance of your p5g sketch talks to that server with something known as a socket socket being a real time connection between two applications that can send data back and forth this particular client also talks to that server with a socket so that when the user moves the mouse and an event is triggered where the x and y coordinate of the mouse is sent to the server the server sends the x and y coordinate of that mouse back to this other one and then this other one receives that message and draws so the issue is you we know how to write a JavaScript program where you move the mouse and you draw stuff that's what's the thing that's happening over here what maybe we don't know how to do what I haven't covered in any of my videos before is how to write this server program and the platform that I'll write the server program is something called node.js there are lots and lots and lots and lots and lots of different ways and languages and Frameworks and things you can do server side programming with building big giant web applications is a huge massive scary weird but not but friendly and nice topic Way Beyond the scope of what I'm doing here what I want to do is just look at a a simple framework node um which will allow me to host the files the p5js sketch as well as make those socket connections so this is the basic sketch of what I want to do and so the first thing I need to show you how to do is download node install node and run something in node and then I'll get to more after I do that questions you can't ask a question because this is a video but but but uh but but find me somewhere okay um so I'm back over here I'm going to close uh here's my computer I'm going to close this and I'm going to close this and oh look where I am I am here on the nodejs website so if you go to nodejs.org uh for quick access place your bookmarks here blah blah blah um download your appropriate version of node run the installer you can see that I'm doing it here on Mac on a Mac operating system an Apple operating system OSX I've downloaded I've installed it once you've done that you should be able to go to a command line view of your computer now on the Mac the easiest way to do this is with an application called terminal which looks like this and it's usually found in applications utilities on Windows insert annotation here which will say the thing you should use on Windows um and uh oops you can see H that I already have ah terminal open and when you see it it'll look something like this and I'm going to make the font bigger boy I'm not prepared for this video I'm going to make the font bigger so you can see it better so this is ah Come Back to Me computer um this is a terminal window and terminal window is a place where you can type all sorts of commands in now I'm going to leave uh you know someday I should make just like introduction to terminal and unix commands type thing but right now I'm just going to give you some basic stuff that you need to know the first thing you want to do realize is that if you've installed node properly you can just type the word node into terminal and hit run I hit run hit enter and then suddenly you see this other line strangely enough this is now a place where I can type JavaScript like I could say 5 + 6 = 11 or I could say VAR x = 100 and then I could say x++ and then I could say x is now uh1 somehow um I know I meant to say x equals X Plus but anyway no no X plus plus I digress the point is I'm somehow now in JavaScript land in terminal but this is not really what I want to do what I really want to do is write JavaScript programs in a text ad that I can trigger from uh from this node command in terminal and I and I and I I I I forgot something important over here which is to say that the point of all this is this might be ultimately how you eventually want your application to live a server somewhere in the internet clients all over the world connecting to that server but what I'm doing right now and if you're following along and doing it too is running all of these pieces on one single machine so I'm going to run the server on my laptop using node I'm going to run the client in the browser on my laptop I'm going to run another client in a separate browser window on my laptop just for testing and making sure it all works okay so over here one of the commands that I uh control C by the way is how you quit uh uh clear will get me back up to the top one of the commands that's really important that I want to use is CD for change directory and I want to go to a folder where I have some p5js files because eventually I'm going to be using a p5js sketch in connection with what I'm doing so I want to go there and then I'm going to go to the finder and I'm going to go to my desktop because I already made a folder on my desktop called sockets coding rainbow and the only thing in that folder is just kind of like the stuff that you would have for a p5js sketch an HTML file a sketch. JS file a libraries folder so if you're like trying to follow along you know pause the video now get yourself a a folder with the stuff that you would have with the p5js sketch in there and then you can keep going so what I want what I can do is when I type CD is I can take this folder and drag it into terminal and you can see now this is the full path to that directory users processing desktop slocks coding rainbow so if I hit enter I now in that directory another command that I could type is LS I can see that's listing all the files that are in that directory and in fact I already have hopefully a text editor open to that directory right here you can see because what I want to do in this directory is now make a new file I want to make a file and I'm going to call it uh server.js notice I now have a new text file called server.js I'm going to open that up and I'm going to just say something like console.log my socket server is running so here's the magic of node node is a JavaScript program that you can execute from the command line it doesn't involve a browser it doesn't involve a window Graphics I mean all those things are possible in the sort of landscape of things you might do but this program now that has one line of code in it I can go back to terminal and I can say node server.js I can hit enter and I can see that my socket server is running now my socket server is not running because I don't have any of the code for the socket server here so this is what I'm going to get into in the next video so what if you're following along what you should have now in your head is a general sense of what is going on serers side programming with node.js conveniently by the way one of the reasons why I picked node.js is because it's JavaScript so you don't have to learn a new programming language um so server side program with node.js you've got that installed on your laptop you've got the idea of making a p5js sketch so and then you have a directory that has both a node program in it under sketch. JS and your p5js sorry under server JS and your p5.js files and once you have that maybe put some test code in server.js run that test code you've got node running you've got your p5js empty p5js sketch ready to go and you'll be ready for the next step which is starting to add the actual code for the socket server okay that was my first um um oh okay um okay so um sorry I'm just like checking the chat for a second so let me know if you guys have any questions about that or if I missed something important because I can pick it up in the next video um I'm I'm sorry I am looking through the chat to see if there are any questions I know you know somebody once told me if you want to have a lot of YouTube followers just swear more but you know swearing is not really in my personality I'm very quiet person who just wants to make rainbows in the world and swearing just doesn't seem like the thing for me to do I I mean I don't have any problem swearing everybody should swear everyone should feel free to swear I just want a family a family stream whatever that means uh okay connect AUD video uh will I ever do this for languages like C probably not anytime soon but I would consider doing that at some point but I've got a long list of stuff before um uh okay um okay so uh I think that's pretty good so I'm going to go to the next stage which is to actually start to add the server code and what I need to do is take a peek at the example I made earlier today um which is um um I need require Express app equals Express uh okay so oh I don't need that this okay this I can make simpler uh you know and I can actually like remove this this is just this is probably a bad idea let me make sure this still works uh I'm just like simplifying my example from earlier U uh yeah it seems to work just fine so I just want to simplify it U you know even though it's good probably good practice to have a lot of extra uh so uh sorry I'm just simplifying this example uh okay yes got it got it okay I I'll deal with this later uh oops okay um okay so I am getting ready to do the next piece of this which is ah Untitled here maybe NOP uh videos to do uh which is I didn't talk about all this other stuff but I'll I'll do a different video where I get to this other stuff uh add Express and hosting files okay so that's the next thing uh uh will you talk about sockets in processing Java or some other language I'd be glad to let me get through some more of this stuff and maybe uh um yes no I'm only getting rid of the comments right now in order to uh be able to like look at the code for myself when I upload the example it will have lots of comments in it of course I'm in favor of comments okay but I'm I'm trying to actually just memorize this because I'm going to type this out from scratch um and right now this is all that I need uh I'll get to this other stuff in the next video okay whoops uh require Express okay um so here we go uh there we go and close all this stuff uh save and open this require Express express. apppp no app equals Express server app. listen app.use Express static public I'm never going to remember all that okay um okay everyone any other questions in the chat I should check uh twitch oh the channel is I'm the YouTube channel I'll put it I'm putting it in the twitch chat is this okay um okay so I'm going to do the next segment it's almost 3 o'clock moving along here I think we're in pretty good shape um okay what is Express anyway I'm G to look that up real quick uh Express no not clothing web application framework that's what it is web application framework good for you express okay um all right everybody I'm going to have an error with my function name yeah I'll find out what that is later okay uh here we go welcome to part two of making a socket server for the shared collaborative canvas thing in HTML so what we had so far before is we just had a server application uh that when I go into start over hold on welcome to part two of making a shared collaborative canvas drawing space in JavaScript with p5g and not and sockets and all that stuffff so what I had so far before was just a simple node program that had one line of code and I said node server.js and it prints out that line of code the console gets logged uh my socket server is running now we need to actually add the actual code for an actual web server that we could connect to with socket so there's one thing that I didn't mention before which I'll come back over to this diagram that I had right I talked about the server really as its sole job being this entity that connects to these things with sockets but actually web servers perform uh another role in the sort of L I'm just going to start this video over because now I know what I want to talk about and I was I kind of lost my train of thought and rambled too much and everything's going to be okay here we go um welcome to part two of making a shared collaborative drawing space thing in the browser with p5js node and sockets so what I had before was just a simple node program the only thing that it does is spit out my socket server is running but our job right now is to actually add code to this program that starts a web server and makes sockets available for the p5js drawing thing to connect to but here's the thing I missed something in my previous video where I talked about the fact we're going to have this node server we're going to have this p5js sketch the p5js sketch is going to connect to the node server with sockets but interestingly enough if you could just forget about sockets for a second there's another reason why you might like to write your own node server to host your actual files as well right when you do client side programming the JavaScript code executes on the browser but the browser has to get that JavaScript code from somewhere like when you type in google.com and there's some JavaScript running on your browser that Google wrote you know the JavaScript is sitting on Google server gets sent to your browser via an HTTP request hypertext transfer protocol so one thing that we want the server to actually do Beyond just sockets is host the HTML and JavaScript files for the sketch itself so before I even get to the sockets I want want my server to be come to be a web server and I could write some node code to do that but an a way to do that that's a little bit easier than writing node code from scratch is to use something called a node framework a node package a node framework or package I think are good words something called Express so the first thing I want to do is show you how to install Express use express and write some Code Express is a I guess a minimalist web application framework a lot of things that you want to do very commonly like host files or set up you know a query or route or all the kind of stuff that I might get to in other videos instead of having to write all the code for them you can call on some functions and express that handle a lot of that stuff for you so let's come back over here and I'm going to the computer's over here I'm going to go back to terminal and one thing I want to do first I'm going to attempt to be a proper citizen in the world of node programming and I'm going to run you don't you no my node program worked without doing this but it's often a good idea to to to uh to write this command called npm init what npm init does is it sets up npm stands for by the way node package manager and I'm going to need the node package manager to install Express and what npm init does is it allows me to um sort of set up a configuration file that says some stuff about my project and you know what this looks good my project is is going to be called sockets coding rainbow uh can no longer contain capital letters so I will rewrite that without capital letters version 1.0 is good description sockets example Live on YouTube made entrypoint server.js test command I don't worry about that I'll worry about that later uh sockets p5js node author is me and license I don't know figure that out later yes this seems fine so I went through this npm init thing and it what that actually did is it created this new file called package.json and what package.json is is it's a Json file with information about my project again I could probably do this without this completely look at that how does it know that the dependencies are expressed in socket.io whoa some crazy internet thing just happened did I put that oh no I'm in the wrong place I opened the wrong I opened my earlier example okay this was my earlier example by the way I'm not I did this earlier today I'm not just figuring it out right now okay close that I should go here this is the package.json file that just got created and you can see here there is the information that I typed in the title The version and you don't see what you're what you don't see are dependencies so the first thing that I need to do in order to be able to add this thing oops dramatic moment add this thing called Express is I need to put in this package.json Json file that I'm going to use a node package called Express only I don't actually have to type it in there because what I'm going to do is I'm going to just say npm can you see this got to move this over npm install Express now I want to do one more thing I want to dash I want to write saave and what this command is going to do is it's going to say put save Express as a module that should be associated with this project I'm going to do this it's going to blah blah blah blah magic magic and then if I go back to here you can see now in this file it has a dependency on Express so this is just a lot of I mean this is like the least interesting thing I could probably ever do with my day is talk about like package.json and package manager Express blah blah blah but these are the steps you want to do to kind of set up your project before you write code you'll also also notice by the way that there's this new directory here called node modules so node modules is where the all the code and stuff for Express actually got placed by when I typed um when I typed npm install Express okay so later I'm going to add the socket module but right now I'm just going to keep the express module okay so I hope that cough wasn't too loud into the microphone uh what's next everybody so now we can start to oh that's that's my secret code no not here so now we can start to actually write we can actually start to write some code uh into our server itself so one thing that I'm going to do is I'm going to say VAR Express equals require Express so this is a way is that that what I wrote over here yeah this is a way of importing the module that you're using so the module name name is Express and I want to require that Express is something that I have access to in my node program and essentially I want to import all that is the live all that is the framework Express and I want all of that into a single variable called Express the reason why I can do and that variable by the way is a function call I mean the variable is a variable but it's it's it's storing a function a JavaScript function you know what that JavaScript function does it makes an express application so I can trigger the express function and store the result of that in a variable called app and then even better what I can do is I can say um server equals app. listen Port 3000 so now dare I say if I run the server my socket server is running and look at that it didn't go back to terminal something's happening something is there on Port 3000 and I can go to my browser and say Local Host right this Local Host being the servers running on my local computer if this server were running on you know the New York Times website I would go to New York times.com col Port 3000 but I'm not the New York Times in case you were wondering and now I'm going to hit enter and now it's like ah it doesn't know what to do but this is reasonable right because I haven't told it what to do there's no files there's no instructions for it to follow but this is the basic idea the basic idea is that I want to and and by the way you could do this without Express but it would be like 10 11 12 lines of code so I'm using Express to set myself up for the future of Life of less worry Express will give you less worry in your life so I require the library I create the app I listen on Port 3000 and now what do I want to do what I want is when the user goes to my website I want them to see my p5js sketch so the main thing I want to happen is I want want to send my HTML file along with my JavaScript file and everything else so they can experience my sketch well one thing I need to do in order to do that is I need to go to this directory right this directory has a lot of stuff in it right now it has both the node stuff like server.js and package.json and the node modules and it also has the p5js stuff an HTML file sketch. JS and a library I don't like this everything's mixed and a mess so I want to make a folder and I'm going to make that folder called sketch now truth be told probably if you see examples most people are going to call that folder public let's call it public the reason why I'm going to call it public is this is like going to be where I put files that I want the public to be able to see when the public goes to my web server they get these files and so what are the things I don't want them to see my server code but I want them to see my p5js sketch so I want the HTML file the libraries and my Javascript file and I want to put that here in public now what I need to do here is add another line of code which allows which says I want to host those F whenever anybody goes to my website I want them to see those files so the way that I do that I'm just going to copy it from over here um and I'm going to put it right here so this is what the code looks like app. use express. static publ so what's the word static for so the word static here is hosting static files so those are files that aren't Dynamic and changing they're just like here's an HTML file here's a Javascript file here's some images I want to host everything I want I want the app to use to to host everything in that public directory so that when the user goes to my website they see what's in the public directory so I'm going to hit save and now I'm going to hit control C I'm going to run the server again my socket server is running I'm going to hit refresh and look at that I don't see cannot get anymore but I don't see anything in there why don't I see anything in there well I don't see anything there because there's no actual sketch so let me go into public let me go into sketch. JS let me say create canvas 200200 let me say uh background 51 let me say ellipse like Mouse X Mouse y 6060 and Let me refresh again and you can see there we go so now I actually am hosting a p5g sketch from node with just with Express with just an uh you know four four slash five lines of code so by the way I have another video which I would like to reference somehow with a link where I looked at how you can run a local server on your computer using python simple server well now here's another way you can run just a local server on your own computer with node with Express with four lines of code so we've got the basic idea now we know what node is we've installed it we've got Express we added a little bit of code we are now seeing our sketch in the browser the next thing I need to do is add the side socket package I need this server to be able to make socket connections to the browser the client itself to be able to send message messages back and forth and that's what I will do in the next video okay uh okay um I don't know if that was that I feel like had some problems but it'll just have to do you know honestly like I used when I used to make these videos I wouldn't live stream them and I would do the video and then I would just immediately delete it and I would just do it again and the second one would always be a little smoother and with less Stakes but it is what it is hopefully people will find these useful I could always rerecord it later some other time it's very hot in this room because I'm using these H hallogen lights which seem to do well for the keying and everything I wonder if uh I'll be fine though okay um let me look at the time here um it is 38 let me look at my list can I finish this today that is the question um delete this uh uh yes so I need to add socket.io package with event so let me go back I wish I knew that this is It's funny like a lot of stuff that I do I just like have it know it by heart having done it so many times but this I've only ever really done to make an example I don't know it that well so what I want to do is open up this file all right and look down here now somebody was telling me I was going to have a problem oh yeah thank you there's the problem uh and I don't like as a matter of course I don't really like um Anonymous functions for I mean it's useful for for teaching so I'm going to do something like this just kind of just so I can look at this here okay and so this should do the trick change this to this uh okay um so okay all right so now hold on and I need to look also at this connect Local Host 3000 on Mouse okay that's fine that I can do okay um okay I think I'm ready mentally ready to add the New pieces uh and I would prefer to write it like this I guess I should make sure this still works but I I feel confident it will okay let me look at the chat see if there's any questions uh app. uses middleware okay thank you Sako okay let me check twitch okay guys are quiet today um but I am ready to do the the next stage of this um and do that over here um hold on let me close all this stuff I need that and this can be a little bit bigger and I need this and what is going on here do the trick uh okay how's that plenty of room okay and let me cycle the cameras okay I think I am now uh I think I am now ready for the next phase this is the good part of getting the socket actually to work and have the communication happening so let's let's make that happen um let me just I want to look at one thing here on Mouse yes draw okay okay send Mouse data init Mouse data okay close enough okay I don't know I'm never going to remember this all this but let's do it okay so first I need to install socket.io and then create the socket connection um with the server and then create a um create a uh iio docket. on connection okay all right let's do this uh here we go here we are part three of making a collaborative canvas socket connection p5js drawing thing and we are at the point now where we have a node server that is serving a p5js sketch if I run that server it start over I don't think I'm GNA just go right into it okay um and actually one thing I want to do I what I meant to do by the way and I'm going to fix this now is put this here this and uh doesn't really matter and okay and sorry I'm being like really pnic about this but okay uh part three of making a collaborative drawing canvas thing in the browser with p5js node and sockets so where we last left off was we had a node server working with oops not this code we had a node server using Express to host a directory and in that directory was a p5js sketch the thing that I need to add is now that socket connection between the sket skch and the server so that if I have another sketch I can have messages going between the from one client to the server to the other client so let's see how we get that working so the first thing I need to do is add the socket.io package to my uh Whatchamacallit node package application thingy so if I go back to terminal I want to say npm install socket.io D saave that's can install socket.io install install install and you should see now here in package.json we now have added socket.io as a dependency for this particular node application so now that that's there and I go back to my server I can now start doing stuff with sockets so the first thing I want to do is say uh socket equals requir socket.io so this is like an import statement in the same way that I wanted to use a Express Express equals require Express I now want to say socket socket equals requir socket.io now what I want to do though actually is open a create an actual socket that's part of this server so the server that's listening on Port 3000 that's in the variable server now I have access to this socket Library which socket is of course a function and so I'm going to call this variable IO it's going to be the thing that's going to keep track of inputs and outputs messages in and out and I want to say socket I'm going to call the socket function and give it the server as an argument so I've imported the library and the library exists it's just like a big function I call that function with the server that's listing on Port 3000 and I've got that in a variable now once I have that I want to start dealing with certain events and the main event the first event that I just want to deal with is if I have a new connection so I think what I do is I say io. on connection so sockets work based on different types you have to write the idea here is that there's this socket that's a connection and in J the way that everything in JavaScript always works is like there's an event and this code is the stuff that happens when this event is triggered events for sockets are like hey I'm connected to you so that's an event another event is hey here's a message another event is oh I'm disconnected now so these are all the events the first event I want to deal with is just a new connection event and I want to have a function to handle that event and of course I could put an anonymous function just inside right here but I'm going to try to make things a little simple and explicit and I'm going to say new connection and so that means and this is wrong I'm g go look up in my answer key io. sockets Doon I knew I was missing something so I need to I uh this is the syntax for that I have my and did I get the other stuff right yes I did okay uh so what I I need to say IO which is the object now the whole input output object that's created by that socket function I want to go inside that object to this thing called sockets call the function on to set up a connection event and I'm now going to say function new connection and what is the thing that is exists when there's a new connection a socket so an argument is placed in that function and I can could say something like you know console.log socket let me run this server now I'm running the server my socket server is running okay the socket server is running I'm now going to go into the browser here we go into the browser I'm going to refresh this page gonna connect with a socket I don't see anything so here's the thing I can set up a socket server all I want to wait for connections but I've also got to write the code in the client to connect to the the server like let's go back and look at my client code uh I don't see anything in here about connecting to a socket so here's the thing that I need to do I need to also have a reference to the sockets library in the client what libraries is so socket so let's let's this is this I'm already confused and I and I I supposedly know what I'm doing which I don't really but you know whatever um so I can look at socket.io go to the socket.io website come on internet don't fail me now um and you can see socket 1.0 is here and I can go down and uh there was something that I was going to look I could go to download ah so here it right so there is both a socket.io server and a socket.io clients this is what I need I need the socket.io server to run here I've already written the code for that now I need socket. IO to run on the client so I need to add that to my client code and one thing that you'll notice here is a quick way to do that is actually just to copy this line here which is referencing the s.i. JS Library uh via a CDN a Content delivery Network so I could download the file and put it in my libraries folder but this is going to be a little bit simpler so I'm going to do that and then I'm going to go to my index.html file right this is where I'm referencing libraries excuse me P5 libraries P.D libraries P5 do sound let me now add another line of code here that just references socket.io so now I'm referencing that socket Library I can once again hit refresh let's open up the browser console nothing there nothing there right I've got the library but now I need to write some actual code H it's so sad when you just like can't remember what the code is to write good thing I already have the example prepared so I'm going to go to my sketch. Js I'm going to go to the one that I did uh earlier and I know that I need the thing that I need is to create a variable called socket and then in setup I want to say socket equals socket.io doc connect and then what do I want to connect to oh hey uh I think I want to connect to Local Host colon 3000 so that's what I've set up my node server to run on it's running on this local computer and it's opening up on Port 3000 so uh did I get that right let me just like briefly oops wrong place let me briefly peek over here wrong place again io. connect uh oh because I've I've uh what did I do okay because I've imported I've imported the library which gives me access to a global variable called IO which should connect so now let me hit refresh and let me go here whoops fail all right let's see what I missed here uh that should matter connect Local H let me just copy this directly uh and uh server let me look at my server uh let me just see maybe there was nothing to see that was printed out in that uh oh yes there we go I don't know why that didn't work before maybe I didn't restart the server uh okay hold on I'm gonna I have to like edit out this part of the video hold on I'm gonna pause for a second uh oh my goodness I've lost my mind here okay I'm gonna uh oops oh it's getting refused connection am I running the other one no okay hold on a second everybody let me just go back for a second oops that looks good okay so things are working all right uh I'm just checking the chat now for a second uh Local Host is the same uh yes this is really helpful comments in the chat uh uh let me check twitch for a second here uh okay uh Dan I wrote local host.com 3000 is that wrong uh oh yeah you're right it should just be local yeah why do I why would I write local host.com that's totally wrong so where can I I need to go back um somehow yeah why did I write because I'm a lunatic um I'm gonna I I gotta just record from somewhere and then I'll splice it it's so much nicer by the way when I go home and I'm like I'm gonna upload the videos from today and I didn't do this thing where I stop in the middle and hit record again but I'm GNA do that uh where did I write.com did I write it I wrote it here uh yeah that was the problem okay I'm going to just cop to that this is what I did right uh okay right because if I do that right and that doesn't work and that's where I didn't start getting errors because it can't connect to that okay okay got it all right I'm going to come back to correct this error and we should be okay and but I want to look up one another thing socket on on no no no that's in the sketch what I want to do is uh oh that's what I'm writing Mouse message yeah okay socket. on mouse mouse message okay socket. on disconnect yeah I to dis we have a new client socket. ID okay uh okay great okay uh um okay oops back after a mistake that I couldn't see which is now quite obvious to me for some reason I wrote local host.com here there should be no do Local Host is the full name of my local computer I could also write by the way uh the the 127.0.0.1 which is a special reserved IP address for a local computer but I'm going to keep that as Local Host so once I now am connecting in my client I should be able to hit refresh here and go here and you say oh all this stuff spit out now so here's the thing what did I do in the code I if in the server code I said right here in a new connection console.log the socket object the socket object has a ton of metadata associated with it uh you know the IP address and all sorts of information about uh what's been what's connecting one thing that I'll do here is just we could evaluate look at all that stuff but that's a sort of for another day perhaps I'm going to say socket. ID and I'm going to say new connection socket. so this is a nice way uh every single new connection to a web server new Saka connection to the server gets automatically assigned an ID number for tracking it over time that might be something you make use of so I'm going to put that in here I'm going to run I'm going to uh whoops I'm going to run the server again I'm going to go back to the browser I'm going to hit refresh and we should see new connection I don't know why I got two new connections I probably by accident still had it open but um then I can go open up another browser window and another browser window and another browser window and you can see all of these connections are coming in so all of those instances are all connected to the server all with a socket connection so we are in good shape now we have added the socket.io library to both the client and the server let's review that for a second in the server we need to require socket.io connect it to this particular webs server and write a function to handle new Connections in the client we need to make sure we've o sorry imported socket. i. JS in the HTML file and we also need to make sure that we create a open a connection to the server that has the socket server on it so that sort of concludes the add sockets to your thing and the next thing that we need to do the very last piece is we want to add code from this client ient to send a message to the server we want to add code to the server to receive that message and send it out to all other clients and that's what I'll do in the next video okay I decided to break this up into two videos it's 330 by golly I'm going to finish this today uh even though I sort of said I had to go at 330 I'm going to give this another 15 minutes I think I can do this last piece um Okay so I'm going to um let me recap for myself uh okay so I'm going to now what I'm going to do is uh create a new browser window yeah so you know what the library is just smart enough that those they somehow the socket stuff is smart enough that it just reconnects uh I just want to okay just want to not have any okay so this is what we're starting with uh here sorry everybody I'm just trying to okay okay good so I'm ready for this last piece um okay okay here we go go here we go here we go here we go um here we are the Moment of Truth part four we now have a node server running it's a socket server I have two clients going in two different browser windows both connecting to the server but if I move my mouse around here to draw I don't see the result of that drawing in this one over here so what I need to do now is add the last piece as I move the mouse in a client I need to send a message once I and then in the server I need to receive that message and send it out to everybody else so let's see if we can make that happen so the first step is let's add code in the client to send the message so I'm going to go to Sublime here where I have all my different pieces and this is my client code I have a socket variable and I connect to the server so what I want to do is I'm what I'm going to do is in I'm I'm going to write a function called Mouse dragged the mouse drag function uh you'll see uh is a function the event function that's triggered whenever I drag the mouse and so if I add that in and put the console whoops wrong console put the console in and I hit refresh you can see oh when I whenever I drag the mouse and uh you can see that I'm printing out those Mouse coordinates so that's where I want to send I just realized there's sort of a flaw in my program which is that I also want to draw in Mouse dragged as well so now right if I move the mouse nothing happens but if I drag I move the mouse and I see the coordinates spitting out in the console so now what I want to do is I need to create a message that I'm going to send and the way you create a message is two things you need a name for the message which is a string of text and you need the data for that message which is just a JavaScript object so the data for that message is I'm going to say x is mouse X and Y is mouse y so this is the content of my message I want to send the mouse X and mouse y value and then I also need a name so I think I say socket. emit Mouse do dat and so I'll change this to saying sending so now in the code you see this is really the sort of crucial part right here which is that I when I want to send a message I create a JavaScript object with the data in it I then say socket. emit I name the message the name is important because it's a you're making a protocol like what if you have a whole lot of different messages and you do different things based on what the name of the message is that's a way to uh in this case I don't really have to worry about that but that's kind of important um and then I attached the data to it so now I've sent the message now let's first even just run run the sketch to make sure uh there aren't any weird errors you know sending you can see that it's sending that stuff seems to be working I don't get any errors and the server I don't see anything happening in the server because I haven't written the code to receive the message so now I need to go to the server to write that code server code right here this is the function where that is triggered when there's a new socket connection so what if this particular socket connection sends a message right not just any message I want what if a message comes from this particular client so I should be able to say socket. on Mouse you know Mouse message I don't know if that's right let me look at my cheat sheet over here ah look that's right so what I what I'm saying is if this if there is a message called Mouse uh trigger this function so I'm going to write that function now and I'm just going to say console.log data so this is now I have a server the server is waiting for connections when there's a new connection I say there's a new connection when there's a message it logs that particular message so let's take a look at this working now so one thing I need to do is I need to restart the server you incidentally there's a way using a tool called nodemon which maybe I should show you at some point to Auto restart a server every time you you change code but I'm not going to worry about that right now I can hit control C and start it again so I'm running the server everything is connect reconnected automatically but I'm going to refresh anyway and you can see it's sending sending sending and look at this receiving come on you can do it let me move this over here I'm going to move the mouse around here you can see look I'm sending and I'm receiving boy this is getting good I'm sending and I'm receiving I'm sending and I'm receiving but I am not sending again to receive over here right the message went from here and then it went to here now I need it to go here and incidentally if a message from here goes to there I need it to go to there let's see is that happening move this back over here right it's happening here it's happening here you can't see it but it is so the messages are coming into the server but they're not going back out so what do I need to do to have them go back out so I'm going to go to my code and I don't have this memorized so well so I'm going to go to my the example I made earlier and I'm going to grab this bit of code oops sorry everybody I'm in the wrong place a million times over and I'm going to add this back in right I could have remembered that so so what do I want to do when a message comes in when a mouse message comes in I want to call the broadcast. emit function to send a message back out what do I want to send back out that exact same message and what do I want to call it Mouse so you can see that there's a lot of possibilities here a message that comes in could be parsed altered changed renamed sent back out but I'm not doing that in this sort of simple example I'm just taking the literal message in the name and the data and I'm sending the exact same back out name in the data now incidentally we have this question here I'm going to go back to all this let's say the message comes from this client into the server do I want that message then to go back out to whoa back back out to both of them or do I want so message comes in goes back out to both of them or do I want message to come in and only go to this one or if there was another one to go to the other two in this case I don't want the message to come back to myself but in other cases you might but I want to show you I'm going to keep this in the code example that I upload that there is this is another way of writing this code I'm going to put it right here if I were to say instead reference the global the more not the specific socket to emit to everyone else but this iio do sockets which kind of refers to everything it will also include the client that sent the message so I'm going to leave that in there as a sort of separate side possibility but really we're kind of golden here we've got messages coming in and the message going back out but the message does not get received by the client so I've got to also go back to the client now and I've got to add something that handles the message coming in socket. on Mouse and I'm going to say new drawing so now if this particular so ET receives a message called new drawing what should it do well uh it should draw and I'm just going to grab exactly this same code it should draw something but at data. X data doy and let's make it a different color just so we can see it's different so this is now saying in addition this particular sketch should set up an event handler for when a message comes in right it's kind of confusing the same sketch is both has functions for sending out and receiving because it's not like there's two different sketches running there's two different instances of the same sketch so if this one sends this one receives but they both have but if this one sends this one receives they both have the sending and receiving code in them now I might have missed something I'm going to feel ambitious though and just run it because I don't have this stuff memorized so these uh whoops let's go to the browser here I'm going to refresh and refresh and see oh no I didn't miss anything so you can see it works beautiful oh that's so nice so you you know there's so much possibilities here and you know incidentally we are being really uh there is absolutely no reason why I shouldn't add a third one just to demonstrate what's really going on here so now if I hit refresh here right you can see and let me Let me refresh all of these okay here we go uh I'm going to draw a heart because I love you all for watching this video two hearts for the two people left who are still watching this video and then I'm going to fill in the heart here because that will make it Pink on the other two look at this this is way too much fun I'm going to mess around with this later after I turn this video off but you can see the idea here is we have all the pieces we have a node you can now remember we have a node server that's hosting a P5 sketch the node server is running Express and opening socket connections whenever a client runs it connects via socket to the server if it sends messages to the server the server receives that message and sends it back out to all the other clients not including the original one let me show you again where all the pieces of that the code are so here uh this is U let me look at the directory of files right this is everything you need the server.js has the code for running the server and receiving socket messages and sending them back out to the clients inside public is my p5js sketch in sketch. JS I have the client code which sends messages to the server and then also receives messages from the server so if I go to that server we can see all I'm doing is I have new connection um I have a a function that handles new connections and a function that receives messages and sends them back out immediately and if I go to the client I have a I have a variable that connects to the server uh it handles new messages and also has a function when the mouse is dag for sending messages so sending receiving sending receiving server client node Express socket P5 JJs all of those things make this particular example I will have all of the code on GitHub I hope that you make something with this do something different uh I'm sure I missed some stuff so leave things in the comments I will add some addendum videos to pick up items I missed or maybe how to deploy this somewhere or other kinds of messages that you could send um and let me know uh and have a good day with your sockets and hearts and things like that okay I got through that um all right everyone um so uh it is uh 345 I have to leave but I'm going to uh stay for five two or three minutes um to copy the video files into Dropbox so that they'll upload to me so I can put them on YouTube later um and also to wait and see if there's there's a lot of chat going on right now so uh I if there I'm GNA I'm kind of I'm scrolling through it to look but wow 13 people watching on um twitch which is really kind of cool um I'm going to um get all my video files sorry sorry everybody so ask your questions in the chat I'll come look at them in a second right now I'm doing something that you can't see which is I am uh uh I am sorry checking to see how much space I have in my Dropbox it should be okay and now I'm looking at all the videos I made today how much space they take up up which shouldn't be that much uh today today today boy I recorded a lot today that was good let's see if that is going to work oh too much problem we've got a problem Oh No it should be okay what's in here oh because it's got the cash okay no no we're fine I'm fine those should all upload okay I'm going to check the chat um thank you people are just writing nice things in the comments which is really great I appreciate that very much um so let me explain to you for those of you who are new or wondering what's going to happen I made basically I would say five or six so first of all as soon as I hit stop on the streaming button this YouTube stream will close down and the archive of the stream will be on my channel which is uh youtube.com chman uh and there's also an archive that's kept on Twitch uh you can communicate with me questions or feedback on Twitter um so as soon as I hit stop on the stream this whole one hour and 55 minutes will be on YouTube it takes an hour or so to process then probably not until tonight uh after my children go to bed um I then will go through the like video files that I saved to disk and I'll trim them and do one quick little edit then I will upload them as separate videos and make a playlist so that the um there will be a playlist for the four or five videos that I recorded of the steps so you'll be able to watch that later um also and um you know one thing that I need to do about you know I need to add annotations and write better descriptions and that sort of thing but just uh if you can't find something uh Twitter is the best way to uh reach out to me um and that sort of thing and um you know you don't need to do anything but spread the word I'm trying to I've got this semester where I have more time to make videos I'm trying to see like what this can really uh become if this is a kind of a sustainable model to just make learn to program videos I really enjoy doing it so tell people to subscribe or watch or whatever and I'm going to be back doing so I hope to be back here tomorrow I didn't really expect to do this one which and I might do some more oh boy I have some other stuff I have to do to do this week but I hope to be back here tomorrow um to do actually some more node videos um because I'm doing a workshop on Saturday and so I meant for this to be stuff preparing for the workshop but I realized I went off on a different topic but I'll be back tomorrow and possibly on Friday uh but perhaps just tomorrow this week uh you can subscribe to my email notification list I always post on Twitter which is at shiffman Donnet and uh I'll send an email probably tomorrow morning about or later tonight about the timing of the next live stream okay um yeah I'm definitely not going to delete the live stream it will be there it's just uh it's not as easy to watch it's you know two hours as opposed to um if somebody really wants to come just find the tutorial they'll find four or five 10minute videos so they'll both be there for sure um definitely um uh someone asked about videos based on Kai library and running processing on Android I'm definitely interested in that I have a long list of topics um so I I don't know that's not high on my list but um uh uh let me let me but uh I I keep a GitHub gist and you can see uh this is sort of the topic list that I'm working with uh uh uh somewhere here I have sockets I guess I didn't have it on this list but there's a lot of things that I'm kind of uh want to to get to uh let look at the comments database stuff yes I will definitely do database stuff uh that is definitely um important on my list of things to get to um so I have by the way the the I will upload the socket example soon um um okay and that's about it for today so get in touch leaveing messages on Twitter don't send me emails I you can but it's like email is like kind of impossible um but but I love to be in touch so ways that are um that's that uh um Twitter is a good thing I guess for that um YouTube comments I I always try to answer the YouTube comments questions there often if it's a big complicated question I'll just say ask this at the processing forum and head um because the YouTube comments is sort of best for sort of targeted questions based on a specific video and especially if you send me something like you referred to another video at this Tim stamp or you referred to a link at this Tim stamp it'll help me add like the annotations to the video so that um that is also really helpful in the comments if you're watching them okay uh I will see you guys soon I'm going to hit stop um everything uploaded to Dropbox so later tonight I will be putting this stuff on YouTube The Stream will go live immediately and I will see you all soon oh four this is going to be a 2our stream two one two hours