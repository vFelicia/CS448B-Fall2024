part three of making a collaborative drawing canvas thing in the browser with p5js node and sockets so where we last left off was we had a node server working with oops not this code we had a node server using Express to host a directory and in that directory was a p5js sketch the thing that I need to add is now that socket connection between the sketch and the server so that if I have another sketch I can have messages going between the the from one client to the server to the other client so let's see how we get that working so the first thing I need to do is add the socket.io package to my uh Whatchamacallit node package application thingy so if I go back to terminal I want to say npm install socket.io ddave that's going to install socket.io install install install and you should see now here in package.json we now have added socket.io as a dependency for this particular node application so now that that's there and I go back to my server I can now start doing stuff with sockets so the first thing I want to do is say uh socket equals requir socket.io so this is like an import statement in the same way that I wanted to use express Express equals require Express I now I want to say socket socket equals requir socket.io now what I want to do though actually is open a create an actual socket that's part of this server so the server that's listening on Port 3000 that's in the variable server now I have access to this socket Library which socket is of course a function and so I'm going to call this variable IO it's going to be the thing that's going to keep track of inputs and outputs messages in and out and I want to say socket I'm going to call the socket function and give it the ser as an argument so I've imported the library and the library exists is just like a big function I call that function with the server that's listing on Port 3000 and I've got that in a variable now once I have that I want to start dealing with certain events and the main event the first event that I just want to deal with is if I have a new connection so I think what I do is I say IO Doon connection so sockets work based on different types you have to write the idea here is that there's this socket that's a connection and in J the way that everything in JavaScript always works is like there's an event and this code is the stuff that happens when this event is triggered events for sockets are like hey I'm connected to you so that's an event another event is hey here's a message another event is oh I'm disconnected now so these are all the events the first event I want to deal with is just a new connection event and I want to have a function to handle that event and of course I could put an anonymous function just inside right here but I'm going to try to make things a little simple and explicit and I'm going to say new connection and so that means and this is wrong I'm g go look up in my answer key io. sockets Doon I knew I was missing something so I need to this is the Syntax for that I have my and did I get the other stuff right yes I did okay uh so what I I need to say IO which is the object now the whole input output object that's created by that socket function I want to go inside that object to this thing called sockets call the function on to set up a connection event and I'm now going to say function new connection and what is the thing that is exists when there's a new connection a socket so an argument is placed in that function and I could say something like you know console.log socket let me run this server now I am running the server my socket server is running okay the socket server is running I'm now going to go into the browser here we go into the browser I'm going to refresh this page GNA connect with a socket I don't see anything so here's the thing I can set up a socket server all I want to wait for connections but I've also got to write the code in the client to connect to the the server like let's go back and look at my client code uh I don't see anything in here about connecting to a socket so here's the thing that I need to do I need to also have a reference to the sockets library in the client what libraries is so socket so let's let's this is this I'm already confused and I and I I supposedly know what I'm doing which I don't really but you know whatever um so I can look at socket.io go to the socket.io website come on internet don't fail me now um and you can see socket 1.0 is here and I can go down and uh there was something that I was going to look I could go to download ah so here right so there is both a socket.io server and a socket.io clients this is what I need I need the socket.io server to run here I've already written the code for that now I need socket.io to run on the client so I need to add that to my client code and one thing that you'll notice here is a quick way to do that is actually just to copy this line here which is referencing the s.i. JS Library uh via a CDN a Content delivery Network so I could download the file and put it in my libraries folder but this is going to be a little bit simpler so I'm going to do that and then I'm going to go to my index.html file right this is where I'm referencing libraries excuse me P5 libraries P.D libraries P5 sound let me now add another line of code here that just references socket.io so now I'm referencing that socket Library I can once again hit refresh let's open up the browser console nothing there nothing there right I've got the library but now I need to write some actual code H it's so sad when you just like can't remember what the code is to write good thing I already have the example prepared so I'm going to go to my .js I'm going to go to the one that I did uh earlier and I know that I need the thing that I need is to create a variable called socket and then in setup I want to say socket equals socket.io doc connect and then what do I want to connect to oh hey uh oops back after a mistake that I couldn't see which is now quite obvious to me for some reason I wrote local host.com here there should be no Local Host is the full name of my local computer I could also write by the way uh the the 127.0.0.1 which is a special reserved IP address for a local computer but I'm going to keep that as Local Host so once I now am connecting in my client I should be able to hit refresh here and go here and you say oh all this stuff spit out now so here's the thing what did I do in the code I if in the server code I said right here in a new connection console.log the socket object the socket object has a ton of metadata associated with it uh you know the IP address and all sorts of information about uh what's been what's connecting one thing that I'll do here is just we could evaluate look at all that stuff but that's a sort of for another day perhaps I'm going to say socket. and I'm going to say new connection socket. ID so this is a nice way uh every single new connection to a web server new Saka connection to the server gets automatically assigned an ID number for tracking it over time that might be something you make use of so I'm going to put that in here I'm going to run I'm going to uh oops I'm going to run the server again I'm going to go back to the browser I'm going to hit refresh and we should see new connection I don't know why I got two new connections I probably by accident still had it open but um then I can go open up another browser window and another browser window and another browser window and you can see all of these connections are coming in so all of those instances are all connected to the server all with a socket connection so we are in good shape now we have added the socket.io library to both the client and the server let's review that for a second in the server we need to require socket.io connect it to this particular web server and write a function to handle new Connections in the client we need to make make sure we've sorry imported socket.io JS in the HTML file and we also need to make sure that we create a open a connection to the server that has the socket server on it so that sort of concludes the add sockets to your thing and the next thing that we need to do the very last piece is we want to add code from this client to send a message to the server we want to add code to the server to receive that message and send it out to all other clients and that's what I'll do in the next video