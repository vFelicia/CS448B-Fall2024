hello welcome to another video with p5.js sound as you can see the previous video this is the result of that one where I have this talking ellipse which moves as I speak is really just responding not to my voice but any sound and so what I want to do is now connect this same volume listening thing to an mp3 file instead of my voice and see what happens when we get that so let's take a few steps to do that the first thing I need to do is well make sure I have an mp3 file which I do you can see it right here it's called this dash dot dash K P it's a little song about not forgetting the this dot and JavaScript that Christian Petersen on soundcloud created I'll include a link in this video to that song if you want to mess with it let me go to the code and what I want to do is I want to say I'm going to create a variable called song and I'm just going to use the preload function to load that sound this dot Kate KP dot mp3 and then I'm going to say a here song dot play so let's just run it like that make sure the sound plays as always I always forget the dis stop this stop this stop just duck Energy's this stop is a this fist stop this dock just done I'm gonna do the phrase easy stop is done so of course it's working so to speak because the mic is listening the sound is coming out of the speakers and the mic hears that but I think what you might ultimately really want to do here is not listen to this song through the microphone but actually connect the song itself and to do that you need something in p5 called an amplitude object so I'm going to in this example now get rid of the mic completely and I'm just going to set the volume equal to one here and we can see if I run this again as always I always forget to this stop this stop this stop just done in order for the song to be able to pause so we don't I don't have to we don't to listen to constantly while I'm talking or whatever I'm just going to add quickly a button and I'm going to call it a toggle and I want to say button mouse pressed toggle toggle song and so I need to write a function called toggle song where if song is playing song pause otherwise song dot play so I think if I just add that really quickly my unmute the tab as always I always forget this stop this stop this stop just dr. Randi so I should now I can at least play him pause the song really easily right there in the browser and that'll make working with you you watching this video presumably a little easier okay so now I have this song loaded and I have it playing now how do I listen to the amplitude so I need to add another variable I'm going to call it a mp4 amplitude amplitude being another word for volume and in setup I can create amplitude equals new p5 amplitude object now here's the thing the next step should probably be or might likely be in many spheres of existence connect the amplitude analysis object to the song so there's an amplitude object and a song object and they need to be connected so the amplitude object can listen to the amplitude of the song the thing about is what p5 will do I think if I've got this correct automatically behind the scenes is just kind of that amplitude object is just going to listen to the stuff that's playing by default so I really only have to get into the detail of this if I have multiple songs playing at the same time and only want to listen to one but we don't really have to worry about this I should just be able to say a and P get level let's see what we've got here now as always I always forget to this stop this stop this stop this duck and indeed this style is Dido Vegas stop sir make a little bit character this stock will stop is enough this stock okay but before I do that I think something that might be interesting to try in this video is a to graph that volume level so let's think about how we might do that so there's a variety of ways we could do that but I think something a useful way might be I'm going to create a variable called history which is just an array and I'm going to say each time through draw I'm going to say history dot push volume so let's run this again as always I always forget to this stop it's not push is not a function line 30 history dot push bar history ah you know what I think history is probably the worst name of anything I could ever come up there with there because and this happens a lot of JavaScript I'm working with p5 in the global namespace meeting I'm just like I'm just writing variables I'm doing whatever I want borrow this borrow that function this and you know it this can get you into it's great for prototyping and getting started and make it stuff and sketching out ideas but you do there are things like what if I were to say var window that's a big problem I have a feeling history is a kind of built in global variable in javascript in the browser that is related to the browser's history or some so I'm going to say volume history vol history and I'm gonna do this now it's always I already miss stopped this stuff and I got this stuff looking again so here's stop this stop is this dis daca see already I've cut this is giant array with every single volume value from whenever this program started so let's go back to the code and let's do something with that so what I want to do is I'm going to say for VAR i equals 0 is less than vol history dot length i plus plus let's just draw a little point point i comma whatever the volume is so let's do that let's comment out the ellipse and here we go as always I always forget the dis daughter stop that kids don't get going on this stuff is Stowe why not so one thing that's going on here is what I want is I want that volume but just between zero and one when it's at point five I want to see it in the middle of the screen maybe when it's at one I want to see it at the top when it's at zero I want to see it at the bottom so really what I should do is I should get a yvalue which is mapping of all history which goes between zero and one and I want to say when it's one when it's zero I want it to be at the bottom of the window and when it's one I want it to be at the top and so I'm kind of inverting that mapping and now I should be able to do this now let's run this as always I always get to this stop this stop I add a stroke I think this stop this stuff as always I always forget to this stop this stop this source in that ball you wrapped over time but this is no less the pace done you know a couple things that I want to do here number one is I want to actually draw this as a continuous form so I'm going to say begin shape and end shape and change this to vertex and I'm gonna say no fill because I just want it I don't want to I don't want to fill in the vertex so I'm gonna do that as always I always forget the dis stop this stop this stop just up and see them all you be a stop there and that's what I can do is I can just say yeah this is top of all history da this time if ball history dot length is greater than width then I can just save all history dot splice I want to get I want to up the the first element so I'm kind of like building up the history and then once I get to the end I want to delete the oldest one and get the new history because I just want to see the graph from what it's been with it with this then this or the most recent history so if I run this again as always I always forget to this stop this stop this stop this done this stock the stock singers rappers stop this stop just stop this stop just stop I just got this job yeah I could Center it so mikalai in the chat mentions I could Center it o clappy bird that was the idea yeah so I'm going to Center it meaning when it's zero I want it to be at a height / right as always I always forget to do so but it stopped it stopped actually what I really want is like this naturally I guess search throughout the range is done have about the center vibe well this time guys came to stop make this work this table this table I should make a red vertical line to show a realtime style then I like that idea okay so oh I could Center it like yes so what if I did something like but you guys are giving me all sorts of silly idea so those if I were to make a red line that is where that is is line at the end with which is really uh with comma zero with comma one of course it's really with minus one so if I run this as always I always forget the dis stop this stop this stop this duck an easyaccess stop is savvy on this this stop is docked is done this falls this dock starts on this dog this dock is God as always I always forget to this stop now just stop just stop and indeed this stop is dying I mean yes when I could you know just docking today is if it's greater than we always stop if you talk as always I always forget to this stop this stop this stop just stop and indeed this stop this stop is this this stop this dock kill anyway I can keep going with this I think this ends this video and in the next video I'm gonna work that stop how I can listen to more information about the sound other than just the volume so what would it mean instead of listening to the overall amplitude to listen for the amplitude at various different frequency levels okay see you in a future video and we're back some of the chat had a great suggestion I misunderstood that your suggestion which is not sort of centering the graph on the page but what if this does discuss maybe that rat this is the first volume I'm always drawn at the center point and so the whole thing is kind of shifts up and down that might visually create an interesting effect so I'm going to use translate for this so what if I were to say let me give myself a little more space here this is where I'm calculating the Y value so this is the Y position that's where that vertex is being set but before I do any of this okay so let's do this let's map it between zero and height and let me say though translate to height divided by two so in this case as always I always forget the dis stop it stop it stop just done whoops did I do that in the wrong place Oh can't translate sorry zero height divided by two as always I buy that it is negative rates with you as always I always forget live now translate put it on this stuff energy this stop is let's get rid of the red line is done I'm gonna do this and what I want to do though is actually take the current volume right what's the current Y level so the current y whatever the newest right current y is whatever that actual current volume is and what if I translate everything up but shifted by that volume negative height divided by 2 plus that current Y as always I always forget about this stop this stop this stop just done I just want to translate back by current Y right as always I always forget to this stuff if I want to get off this duck and ejector is stop this stop as always I always forget the dis stop let's stop this stop just done and then he's talking with the vista red line that just stuck gonna forget to this stop this stop this stop this duck and then that got put up this dis stop it stop this dotted red line should not be affected by this this stop as always I always forget you this stop this stop this stop I don't know if this is better or worse I'm glad I kind of imagined this little different attack this dog Athena okay we'll be back this next video this stops