hello welcome to another video which is part 2 of my linear regression tutorial and in this video I am going to take this beautiful blank canvas that is the web browser and make linear regression happen in it before I begin coding I just wanted to mention if you just jumped into this video I walk through a full explanation of what linear regression is and the formula that I'm about to use in the previous video so check this video's description to link to that prettiest previous video otherwise keep watching them and get started coding so first thing that I need is I need to boy this is always more complicated than you think could be so simple okay I did some thinking there for a second and we have to do a little more thinking if you see the wheels turning actually I was just kind of overdoing it there like I was thinking about you know locating for dinner ok so here's the thing that happens a lot in a machine learning and computer graphics this thing that I've drawn over here is sort of as an arbitrary scale there's a temperature which I botched by doing it in Fahrenheit which is like the worst measuring system ever I don't want to be insulting it just you know and Fahrenheit you're wonderful too you have many good qualities just like Celsius I love all my temperature systems anyway um but let's say I wanted to actually graph this data you know what do I have I have a canvas that I'm going to draw in the web browser which you know has like 0 to 600 pixels and 0 to 400 pixels 0 zeros in the top left it points down it points to the right I think I need to nap my pixel space so what I mean by that is I want to have my pixel space represent 0 0 being in the bottom left and I want the xaxis to be kind of go from 0 to 1 and the y axis go from 0 to 1 so I need to have kind of scale a data scale and then the a graphic scale and I'm sort of making this up so it can be anything but when you go and apply this with real data you need some way of mapping from your data to pixels if you want to graph it you know a lot of systems for doing data visualization if you're using R or d3 you know or some Python graphics I'm going to do this for you automatically but we're in JavaScript land we're gonna use p5 or and do the math ourselves okay okay so so I'm going to first Lebanon so I'm going to make a canvas and I'm going to make a canvas that's 400 by 400 and I'm going to draw the background with a gray value of 51 okay wow that's a giant canvas okay that's better so I'm gonna make it a square just to make things simpler right now and then what I'm going to do is I'm going to say mousepressed and whatever I press the mouse I'm going to create a new data point so I'm going to say x equals map mouse X which goes between 0 and width to a value between 0 and 1 so this is me mapping the x values between 0 and width to 0 and 1 because the pretend data if this were real data I'd want to know what the actual range weather would be getting it from mouse click but I'm going to save our y equals map mouse Y from 0 to height now however I'm going to say from 1 to 0 because I want to have the bottom of the window be 0 right if I come over here this is 0 0 right over here so that's height which is 0 0 is 1 ok so then what I'm going to do is I'm going to say var data equals creed I'm going to use the p5 vector object just to store both of these things and I'm going to say point call this a point and I'm going to make an array called data and I am going to say data dot push point so what I've done here is every time I click I create a data point based on where the mouse is so what do I want to do in the draw function you know it's a little unnecessary to have an animation loop here because I could potentially only redraw but whenever I have a new piece of data what I'm going to do here is I'm going to I'm going to iterate over all of the data so VAR I equals 0 I is less than data length I plus plus and now what I need to do is do the reverse mapping so when I put the data into that array I want to map it to the appropriate range and when I get it out and you can map it back to the pixel range so I'm going to say VAR x equals map data index X which has a range between 0 and 1 to between 0 and width and I'm going to do the same thing for y map data dot Y which has a range between 0 and 1 and map that to arranged from height down to 0 if you're if you haven't seen this map function before I have a whole video just on what is map so you could go child link to that in the description as well then I'm going to draw an ellipse at X comma Y that's you know 8 pixels by 8 pixels I'm going to say fill 255 and Stroke 255 and now what we should see here is just the visuals that I want which is wherever I click I get a point so you know this would be a lot simpler without that mapping but the mapping is going to be useful for us as we start to try to compute the formula for the line with the least squares criteria all right so what's the next thing that I need to do we need to calculate M and B so when should we do that so let's make a global variable and let's call it I think I could call it M equals 0 and VAR b equals 0 and let's actually make m equal 1 so let's see if we have an admin of b write the formula for a line is y ok so let's let's uh um what are we going to do okay I got it I got it I got okay so here's the thing I want to draw that line so how am I going to do that well I could just take the x value here and then the x value at the end calculate the corresponding Y values for both of those points and then draw a line between them so let's do that so let's write a function called draw line and what I'm going to do is I'm going to say var X min equals zero bar Y min sorry X max equals one then I'm going to say Y min equals M times X min plus B and Y max you know this is really just like x1 x2 y1 y2 you like I'm really trying to get two points x1 y1 and x2 y2 so in fact this would make more sense to write it this way y1 equals M times x1 plus B and y2 equals M times x2 plus B and now all I need to do is say stroke 255 well I could make it a different color just like I had two different colors market Curtis and I could say line x1 y1 x2 y2 only I can't write what's the problem I calculated this line with my units my scale my mapping of the data of having this range between 0 and 1 and so I need to unmask it to the pixel stuff so this is a little bit awkward but let's just do it this way let's say X 1 equals map X 1 which has a range between 0 1 2 between 0 and width and by the way I could just multiply it by width but I'm keeping the map function in here because you might have a very different scale Y y1 is the same thing but go from height down to 0 and then we're going to do the same thing for x2 and y2 are you asleep yet and now we're going to draw so we're going to calculate those values map them to pixels and then draw the line and so let's uh in the draw function let's have draw a line so now oops uh I have an error line 50 looks like I guess I have an extra bracket somehow whoops y2 is not defined to draw a line what did I mess up here okay this should be y2 thank you very much yeah so you can see there's the line so I mean that's what the line is always going to be so now I know that if I have the N and the B for the formula for a line I can visually represent that line now all I need to do is use this formula here to calculate N and B based on the actual x and y values let's do that okay so let's remind ourselves so let's do let's write a function and let's call it linear regression I want to talk about where the term regression comes from French thing regression to the mean you can look it up ok so what are we going to do okay so if we look at the formula and this I went through all of this from the previous in the previous video where I talked about this formula something that I really need is X bar and y bar and X bar is the mean or the average of all the X values and Y bar is the mean of all the Y values so adding them all up together dividing by the total number so I might as well add those up I mean get a calculate those first so the first thing I want to do is say X sum equals 0 and we're going to go through all of the data I'm going to iterate over all the data Y sum equals 0 we're going to say X sum plus equals data index I dot X Y sum plus equals data in there so we're adding up all of the excise and all the Y values and then we're going to say X mean equals x sum divided by data lengths and the same thing for the Y mean so this is 4 this is the average so we now have the average of all the X values and the average of all the Y values now what we need to do is we need to calculate the numerator and the denominator let's do the numerator first so the numerator is so first I need to I'm gonna have to sum up some stuff here so what am I definitely need to loop through all the data but we can doing a lot of looping through all the data so I'm gonna say numerator equals 0 so the numerator is going to add up all together each data points X minus X mean times each data point and you know what I'm going to do I'm going to just use some extra variables here which I think will make things a little cleaner just we can look at the formula this is now the numerator right this is exactly this is in code right here exactly what's written in the formula here it's adding up all of the X's minus the average of X's and all the Y's so amount of Y multiplied together ok so we've got that and now all we need to do is we also we label to the denominator at the same time why not write denominator can I say de n for that we're going to add up the denominator is X x mean times X x mean it's just that added up squared and then M equals Oh M equals a numerator divided by denominator looks denominator so let's think about this could we have an issue where the denominator is 0 you know it's going to have a wish protect against it if like if all the xvalues were the same then the average would be that value and then the difference between all the values and the average would be zero but let's not worry about that too much right now okay now okay now once we've done that we can now say B equals y means minus M times X B right is that right B equals y me minus M times X mean which we get because y equals MX plus B so now that we have that we've got everything so I should be able to we're going to have a problem this is actually going to happen instantly so if there's this is only worth doing if there's more than one data point so I think we should say here in so where is in draw we're going to say if data length is greater than one then calculate the linear regression and draw the line all right let's give this a try Hey look at Matt that was amazing nothing ever works in the first try this kind of makes sense right you can see I can add a bunch of points and it's always fitting that line to the points this is linear regression interactive linear regression in the browser it's probably not anything I hear should be too excited about but it's making me happy right now okay so this this video is really complete we see that I have this linear regression that's calculated now here's I think what can you do with this so first of all you might think of some more interesting interactive ways of playing with the data whether it's being able to click and move these points around drag and drop randomize all the points I'm sure you could come up with some more interactive possibilities but one thing that I think is really important to talk about is whether it actually makes sense to use linear regression a linear regression model your data okay so let's think about a scenario where you wouldn't worry where you wouldn't all right hair I am where you wouldn't want to use linear regression so what if your data happened to kind of look like this so I could fit this present get better as a multicolor I could fit this with a line and I might still get even like the same sort of line but actually if we really looked at this data I could see that hi you know what this data I could fit a curve to this data I could fit something like y equals n x squared plus B or even plus you know M 0 x squared plus M one times X plus B and I'm probably using the wrong I should I should start using this is b0 b1 b2 right so if you can I could essentially create a polynomial formula a formula that has not just X but x squared and maybe X cubed or X to the fourth power and I'm actually going to look at that in a future video so I will do a video where I do polynomial regression I'm just going to use a JavaScript library that has it built into it so just to sort of demonstrate the idea but this is something that I might want to do and what's interesting about linear regression and this this has been demonstrated there's a wellknown famous data set called Aman's combs quartet where let's look I'm going to look at these four graphs each one of these has the same exact linear regression line right you can see that with this data the line is the same but that's it does this line really make sense so this one it kind of does right you can see that it's a nice approximation of the data with this one it does but you can see it's kind of off because there's just an anomaly and maybe we should build something into our model to account for that anomaly or this one over here even the linear regression have that same line it's actually we could figure out that we could use a polynomial function to estimate that in here we got some kind of like crazy nonsense wary of all the same xvalue so this is an important thing to realize that linear regression is not kind of magic it's not a recipe for all data is for all inputs and outputs but it is a simple model that will work for a lot of data data that is linear one way to evaluate whether or not the linear model is useful for your data set is to look at something called the residuals and a coding train viewer extraordinaire Kaede week mon you can go to k week bond github k weekend github i'll include a link to this in the video description created a much more sophisticated demonstration this is the same exact idea i can move these points around and I can kind of an randomize them and I can see the same linear regression but what this is showing is a residual plot the residual plot shows the magnitude of the difference from the line to the data point for each and every data point and if and we can actually up that the ants comb data is built into this and you can see this makes sense if you have a kind of random residual plot that's a good sign if you have a highly pattern residual plot then it's most likely that some other model could be useful for your regression so something you might consider doing as an exercise is researching more about different data sets trying to implement me you could find K weak ones code on github as well but try to make your own residual plot from my scatter plot code and one of the types of interactive features for importing or using different data sets whether they're colorful and creative ways can you explore visualizing the process of linear regression ok so thanks for watching this video I'm going to do a couple more videos on this topic number I'm going to look at polynomial regression with a JavaScript library and then I'm going to use a different technique to calculate only regression known as gradient descent and the main reason I want to do that is gradient descent as opposed to this least squares methodology I used here is a fundamental method for neural work based learning for learning method for neural network based systems so we're going to do that for linear regression which will set us up well for neural network stuff later