hello and welcome to another computer vision video this is a followup video on my previous one where I'm going to talk about something called I don't know it's called I'm gonna fix a problem with this particular video look what happens if I like shake this blob around a lot notice how the ID numbers going up and up and up and up and up because even though it's the same blob it's the computer vision algorithm and it doesn't detect it for a brief moment so it deletes it and then it comes back and it gives it a new ID but I want to build something into the algorithm so that even if the blob leaves for a very short period of time it doesn't actually get a new ID unless it's really gone for a significant period of time and that's the difficulty of time could just be like a few milliseconds but I'll getting used to us a minute I'm not a minute a second or five seconds or 10 seconds so the first thing that I need to do is I just need to add to the blob I'm gonna add this idea do you have an idea idea of a timer I'm gonna set the timer equal to 100 and then what I want to do is the other thing I want to do just for debugging purposes is I want to take a look I want to be able to see the timer and I'm gonna put it above the blob I mean why minus 10 and I'm gonna just make it half the size Oh what I'm going to do and let's just see if this works now we should see that every blob now has a timer associated with it now nothing's happening with that timer but maybe what I'll do is write a function in the blob I don't know what to call it uh fadeout huh I don't fade well I'll just call it update update sort of weird that's not the right whatever somebody somebody will come up with a good a good name for that function and suggest it I'll think of it later in the chat maybe somebody will notice and tell me okay so what I'm gonna do just for the sake of argument right now I'm gonna call update always and you'll see what's going on so now when a blob comes up you could see that the timer is going down and every time I get a new blob the timer starts back at 100 so here's the thing I don't want to actually delete the blob unless it's Oh 20 and I don't actually want its timer to always go down I only want its timer to go down if it can't find something to match to so this actually should just be here right in this last scenario right the last scenario is if option through yet I could delete this right if there are more blobs than the computer vision algorithm is currently detecting then whatever whatever blobs did not get matched get deleted in this case don't actually delete them just update the timer so I'm gonna call update and then I'm gonna say if I do you know I'm gonna do I'm just gonna write a function called check check timer that's what I'll call it and then because I'm also gonna have a return true or false and then only if it returns true then actually remove it so in this case and there's gonna be some issues with this so I'm gonna call this boolean check timer and then timer if timer is less than 0 then return true otherwise return false and I know I know I could just say return timers less than zero because it evaluates to true or false but I'd like to be just sort of longwinded about this just so people can really see what's going on yeah timer isn't really something that Chad is saying that timer isn't really related to time and that's actually true so actually why don't I call it like lifespan and that way check life that way I'm just sort of if I could have said counter but I don't know why I didn't so and I'm gonna just do this okay so so check life always up so no so let's take a look at this unless eoqs and now I just need to update this with lifespan as well so let's see now what happens here let's see what this gets us so look you can see that that blob exists and it's got a lifespan currently of now if I take it away it's timers going down hope it went to one but if I come back but look at that its lifespan is now at forty five so up up it's two so one of the thing is when it gets matched I need its lifespan needs to go back to one hundred so wait how do I know when it gets matched here is when it gets matched so if and this should really go into a function probably but I'm gonna just gonna be a little hacky about this right now I'm just gonna say lifespan equals 100 so that'll reset its lifespan back to 100 another thing I'm gonna do is I'm actually just gonna make the lifespan to 55 because I think what would be nice is to look at this to debug this actually when I'm drawing it where do I draw the blob I can't even find it anymore I'm gonna actually use its lifespan as its alpha actually going to leave it at 200 and then maybe I won't bother to draw the I won't bother to draw the lifespan right now so let's take a look at this and let's see how this works so I now have two blobs 0 & 1 they're gonna leave the screen and I'm gonna come back and there's still 0 in one they're gonna leave and they're gonna come back and there's still 0 1 I could do this and it's probably not being detected but they're still there they're still 0 & 1 now what if I really what if they really leave I don't think the lifespan got reset properly right let's come back right it still looks like it's alpha II ah so there's a bug there the idea is right but I have a still have a bug in the code my lifespan didn't get set correctly what did I what what happened mmm matched lifespan hmm Oh 100 that's why because I'm starting to the 200 okay so that should be a variable and I should have that as a function so I don't make that mistake okay so so let me try this again 0 & 1 leave they're fading out whoops does they come back I love this so this is nice these are my blobs 0 & 1 where's my other cup wait I had a third no it's on the floor let's see does it do 0 & 1 still exist I was fast enough so you can see how I've got 2 3 there we go 0 1 2 & 3 I don't know why that one disappeared for a while so you can see how the the IDs are actually interestingly enough they even they even keep themselves as they kind of overlap a little bit so I don't know you get the idea so this I think is a pretty robust solution for ID numbers here's the thing by the way all of this effort in will hurt guess what if I just had a red cup and a blue Cup I could use the color to keep track of which one is which but you know you might have the case where you're using like multitouch with figures and you're using infrared light you're just seeing these bright white blobby things and you want to which finger it's which and again my system the other thing I should mention here is my system for determining which is which is just based on distance so in other words like this is 7 & 8 right now but let me cross them over that I don't think that worked right yeah oh no it kind of somehow did but you could see like I might a better you know I hit add more sophisticated things like I could use the blob size to kind of try to help match like oh well Bob should have a similar size to what it had previously or I could actually try to predict where it's going to be next because I could keep track of that blobs velocity over time so if anyone makes these improvements or adds to these examples of sort of refinements of this code please let me know and otherwise this is now lobbed I think this ends my blob detection with persistence video oh maybe we need a good thumbnail for this I don't need to be doing this during the video wait Bob 15 go away there we go I should mention by the way that a variable that really makes a big difference here and I'm gonna actually add this I'm gonna say max life I had it at 200 right so let me look for 200 I'm gonna say max life and then also here max life you know playing with this variable is going to make a really big difference because maybe you actually do want it to be a new blog if it leaves the screen like and comes back rather quickly but you don't want really really quick losses to result in a new blob so how you how long you let a blob survive is really kind of a crucial variable in this kind of system okay and so thanks for watching this computer vision tutorial and there will be more in the future there you might have been watching this like at some point where there already are a lot more goodbye