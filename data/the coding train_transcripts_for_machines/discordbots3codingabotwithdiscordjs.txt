oh dear i gotta get that other whistle back hello welcome back this is the third video oh we're getting to the good stuff in my how to make a discord bot series uh at this point by the end of this video i want my bot to say hello back to me say hello back to me bot please talk to me i'm lonely um and so that's going to happen by the end of this video so hopefully if you've come through the first two you've already created your own discord client application and bought and also you hopefully have terminal access to your computer with node installed so if you don't have those go back to the previous videos or look for the video descriptions for those steps that you need to follow but if you've got all that you're ready to go so i want to write some code i'm going to create a node application what is what do i mean by node application so typically in a lot of my other videos i've used node to write a web server to host a website or to maybe actually communicate with twitter in a twitter bot series so i tend to use node as a kind of catchall javascript programming environment as a glue that connects different projects so maybe i want to talk to an api i want to set up a web server most of my videos are just using p5.js which is all clientside code that operates in the web browser this code that i'm going to write in my text editor and run from my console is just running locally here on this computer and it's running because i'm typing in commands to tell it to run and eventually we'll get to how we might deploy it somewhere else later but that's really the way i'm using node it's a programming environment to write my own software that runs on this computer it just so happens that the software has no interface whatsoever so i happen to have a folder on my computer called choo choo bot it's completely empty my console is now pointed at that folder and i can say pwd to confirm it's on the desktop of the coding train user choo choo bot and if i have node installed in order to start my node project the first thing i want to type is npm init so npm is node package manager it is a part of node and it allows you to manage your packages that makes sense now right but basically this is the command for i want to start a node project um so if i run that it's going to give me some prompts to say like oh why don't you tell me some stuff about this project like its name and its license and the author of it and you should be thoughtful and you can even set up some like settings on your computer to have it auto fill with key information but just to move through this kind of quickly right now i'm just gonna hit enter and i'm gonna say okay so all the defaults are now there uh and entered in for this project and if i go back to the folder i'll see that oh look at that i have a package.json file that is the configuration file for this particular project let's take a look at that file and to do that i can open up this folder in my text editor visual studio code i'm in code i go to file open and i select choo choo bot hit open let's look at package.json and there it is i also need to create now another file in package.json it says the main script that's part of this program the spot is index.js so of course i could name this anything i want and just to make that point let me change this to bot.js and then i'm going to create a new file called bot.js and i'm just going to say console.log beep beep and now i've got index.js package.json and if i go back to my console and i run the command node bot.js this is me running the code that's in bot.js beep beep now for this project i want to make use of something called discord.js discord.js is a node module that allows you to interact with the discord api very easily and that's exactly what i want and i've got the command right here to get going with it npm install discord.js i can type that command here this is going to add that module to my project i can go back and check package.json and you'll see right here it is now one of the dependencies so i have access to using the discord.js node module in my project now amazingly i have a full example right here i could just copy base this whole all of this code and i'm basically done with the bot already but i kind of want to work on it uh piece by piece um so i'll bring in these these elements uh one at a time but let me at least start by just copy pasting these first two lines of code which are a little hard for me to just sort of memorize the require function is a function that essentially imports the discord.js module and then i want to create a client the client is the object the javascript object that connects to the discord api itself to manage to run the bot but i need to very specifically authenticate with the discord api with that particular bot so this is now where i need to say client.login and this is where i need to put my bot token so i would say generally speaking it's a pretty bad idea to just hard code your bot token right into your code ultimately i'm going to want to like keep that in a separate configuration file a dot env file is something that i've used before and i have other video tutorials about that i'll come back and do that with this project but just to get it working and if you're following along just for testing i'm just going to paste my token right in there and of course by the time you're watching this i'll have regenerated my token so that won't be the valid one that you that you so you know so that nobody could watch this video and take over my bot so i'm back on the discord developer portal in my application on the bot page and i can click copy to get my token and then i can paste it right here and let's run this again well it's just sitting there how do i know if it worked so probably i want to have a callback a function that's called when it's successfully authenticated probably i would get an error if i had used the wrong token but it's not very helpful to have no message here the way that i implement this is with an event handler and there's actually lots of different kind of events i can handle like i want to handle event when somebody emoji reacts to my message or when a new uh user joins the discord right now i just want to know when i'm ready so i could say client dot on this is to handle any particular event and the event has to have a name and this event this event is called ready and then i want a function that is called when that event happens and i could put an anonymous function in here and that's probably what i should do i could use the arrow syntax i'm going to call that function ready discord and we'll define that function ready discord and i'll just put a console log with a nice little like heart i like to console vlog emojis that's how i debug and so hopefully now if i run this again ah we got the heart so it authenticated successfully and it's ready to go let's go back to the discord server choo choo bot look at that choo choo bot is online right now so choo choo bot is online because it's connected so what's next i mean there's so many things i could have the spot do one thing i should really mention is that this might be a point where you pause and go take a look at a website called discord.js.guide this website has a ton of resources and examples for things you can do and how to do more advanced stuff and all sorts of ideas so there's a lot there i'm gonna just do the most basic basic kind of hello world thing with the bot where if it reads a particular message that i say it responds in a particular way typically the message the example that you'll see here on the um the discord.js website is you say ping i say pong um well i'll do something train themed probably but let's basically do that in order to make that happen i'm going to write another event handler this time the event is message this event will happen anytime anyone sends a message to the discord whatsoever so this is going to happen a lot all the channels all the users like if i were to just write uh console.log message we're gonna see just like crazy stuff happening in the console let's try let's see what happens i'll wait there we go now i've got a message and probably there'll be some more coming along but you see there's tons of metadata associated with all the various uh messages that are being sent reactions and mentions and there's something called a web hook and flags time stamps so much stuff we could begin to work with but i want to be simple about things and i'm going to just look at the message content so let's just say for example if the message content is equal to choo choo i will send a message so message.content is one of the properties in the message object i happen to know that but there's a lot of properties and i'll as i do some more videos with some more functionality you'll see more so i'm just going to check anytime the messages choo choo i'm going to reply with train rainbow sparkly heart all right if you say choo choo exactly case sensitive everything about javascript and string comparison applies here if you say choo choo i will say this back to you let's run this again and i'm going to go over to discord and i'm going to type choo choo yay and here's all these people who are now participating uh by entertyping in choo choo and getting replies from the bot now let's just be sure about this if i type in choo choo with the capital c i'm not going to get a reply and if i go back over here into the console we'll see that the messages are coming through i'm console logging the message content and by the way i'm not just console logging the choo choo the replies are also being console logged one thing you have to be really careful of is if you wrote your code like if i wrote the code like this i commented this out and i just say reply to every message first of all be spamming the server like crazy but also the bot messages itself will trigger message events so if the bot says this the bot then replies to that which then replies to that which then replies i'll be stuck in an infinite loop so you can really wreak havoc on your server by starting to do this but having this protection here is pretty good i want to add before i wrap this video up one additional feature i want to only reply to the message choo choo in that particular channel so if i come back to discord one thing i can do under the bot testing channel is i can right click and i can go all the way down to the bottom here and you can see there's an option for copy id now you won't necessarily see that you're only going to see that is if you have your developer mode enabled in the discord client where you do that is under settings under appearance and then scrolling down under advanced so you can see i have developer mode enabled as soon as you have that enabled i can go back and i can right click and i can get copy id the reason why i want that id is because i'm going to go back to my code and i'm going to also say if message dot channel dot id equals that particular id and let's take out this console log now i'm adding another check only if the message is part of this channel and the contents is choo choo then reply with that reply let's see what happens back to discord and let's mention uh choo choo i've got my reply right there and i'm actually going to go to this other channel called bot talk i don't know what's going on in here ah guess what it's the disstream bot this is one of the bots that maintains and does has a lot of functionality for the coding trained server let me come back to that in a second so you can see another example here and i'm going to go type choo choo here and i do not get a reply because now i have limited the replies only to bot testing i should also mention one thing you notice here is that it's always at mentioning me which is something that you might want but not necessarily what you want so something that i could do in this particular case is i could change the way i'm replying by saying message.channel so a particular channel and then send and then let me just use the same emojis i think this is the code so instead of using the reply function which is a quick way to just immediately reply and at mention the particular person who wrote that message i can just change it to this let me restart the server i'm going to type choo choo and there we go now i just get the emoji reply without the app mentioned just to make this do something slightly more interesting what if i were to create an array called replies and i were to repo put a few different replies in there like this here i now have an array with four different replies maybe what i want to do is pick a random number multiply with this math.random picks a random number between 0 and 1 multiply it by the length of the array and then also make sure that's an integer index to an array so i'm going to add math.floor around that math.floor takes any decimal number like 3.6 and just takes off the decimal makes it 3. so now i can say send replies index r and maybe i want to call this variable index and now what i'm doing is i can see like this is this is what i'm getting to get your creative juices flowing the world is your proverbial oyster your bot oyster right here where you can actually um add any logic you want for how you want to interact with that particular user who wrote that message all right here we go restart the server type choo choo never forget this dot we can see now the different messages come up okay what should you try to do so one thing that you could do and this comes from the coding garden with cj example that i made with cj in a live stream on on his channel um what if you made a magic eight ball bot so if you ask the bot a question the magic 8 ball is an old toy i think from the 80s or so maybe the 90s who knows i definitely had one when i was young you ask it a question you shake it up and it gives you an answer to that question could you make a magic 8ball bot that answers your questions from a list of of premade replies also let's go into bot talk and let's see what some of the features of the bot that's in coding train right now the disk stream bot are so for example i can type exclamation point ping and this is actually pretty good practice for your bot if it's receiving messages to have some kind of set of characters that indicate it's a bot message as opposed to just general chatter so for example if i typed ping like maybe that's not something that i actually want to be communicating with a bot but exclamation point ping will actually give me message back from the bot it will say pong back it will say how long it took um to receive that message and to reply i don't know there's a bunch of metadata here that's going on i can ask for help now i'm getting a list of available commands that i can use with this particular bot let's try uh user info it's telling me about me my name is shiffman i am not playing a game i created my account about a year ago and this person is not a bot i am not a bot can i say user info choo choo bot there we go i'm getting the user info about choo choo bot and it says bleep bleep i am a bot so this is something you could think about as an exercise like how could you make a bot reply with all this kind of information using the discord api um how could you make a magic 8 ball bot what kind of creative ideas do you have so many possibilities and if you want to look at the disk streambot source code and learn more about what this streambot is this is a bot and also a chat manager for streamers it's created by kobe and david two members of the coding train community it has a ton of features and lots of things you could do with live streaming on twitch and with discord and bot i won't get into all that but check out the website so this really wraps up this video um i haven't shown you very much i mean this is an exciting moment if you've gotten all these pieces to work you actually have a bot that listens to messages and sends messages but there are so many things more things that i want to show you honestly i haven't really learned how to do all the things so it might be a little while before the next videos come out but please give me your suggestions or ask your questions about features you'd like to see implemented in the future videos leave those in the comments join the discord community and chat with us there i'd absolutely love to hear about any discord bots you make poetry bots creative art spots weird weird strange useless bots or maybe you've made something very practical or useful that that has a in a particular context um i'd love to just hear about all of the stuff so you could tweet me at shiffman why am i talking about twitter or this is the discord bot series join the disc coding discord um you can share stuff there there's also a webpage associated with this video that has a way of if you if you have documentation or information about your bot online somewhere you can link to it from there um so i'll see you it'll be a little while i'll be wearing a different shirt but in the next videos hopefully more exciting things to come in particular i definitely have to show you how to hide your token but if you want to do that right now um check out my video already about the sort env node package that's what i'm going to use in this series as well all right thanks everybody see you soon make your pot beep beep beep beep bye but sheep goodbye you