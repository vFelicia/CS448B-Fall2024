oh hello good afternoon welcome to part two of today's coding training lives dream Internet coding show episode thing my name is Dan and I will be here with you for the next approximately one hour and thirty minutes I don't have the YouTube chat going I just realized so let me see if I can pull that up all right hmm I don't see anybody say anything like you see me and you hear me but I assume that live streaming so what's going to happen so first of all welcome I think I already said that okay yes see the third people in the chat this morning I spent some time talking about my new favorite subject linting universal sign for lifting up my phone is okay notification YouTube notification YouTube notification watch now the coding train is notification I probably always get that I don't notice so this morning I talked to Bill about linting which is kind of new I did a little video about github not github sorry get remotes one of which can be a github repository and you're gonna have multiple different the same repository as part of different accounts on github as different remotes boy that was like it was like a thrilling topic that crowd was in front of me they were standing they were cheering was suspenseful they were crying or tears and now it was me with the terminal typing like git remote add but someday we can all dream can't we that I'll be here with my tuxedo and the masses out there will be with their laptops coding along tears because they're so moved by the coding train no no yeah very unlikely now I'm really not sure I think I better stick to what I said I was gonna do because I I know that'll be disappointing but I'm a little bit concerned with the smallish amount of time that I have so I'd like to just get started but let me make an announcement there will be no this is the bad news there will be no coding train next Friday March 16 however the good news is there will be a coding train next Wednesday March 14th which as you may know is pi day 314 so I'm gonna be out of town on Friday I'm not available scratch that I'm just not I'm not gonna be available right hey edit that out never mind good dark fun Friday I'm not available on Friday but I will be yes but I will be on Wednesday and since it's pi day I thought what I would do is do some PI themed coding challenges I was hoping that maybe I could also have somebody I'll come here with like an actual PI and it could open the door and I could get like this one of the pie in the face thing anybody knows a way for me to make that happen I don't think that'll be an excellent thing to do in a livestream on pi day but I'm looking for what I'm looking for our suggestions for things that are sip like phyllotaxis is a good good example of that of like it's a little algorithm it's kind of got it's got pie in it blueberry pie my favorite kind of pie and so some things that I might maybe I know that stand up maths the YouTube channel Matt Parker did an interesting video I think last year about like calculating all the digits of pi maybe I could make a piece of code that does that and displays them in the browser so so I am hey Jen maybe do Python know that does not count Python does not count as something for pi day especially because I I mean actually it does totally does but I don't know if that's gonna happen but I'm sorry I would like to take your suggestions so where can you leave your suggestions for let's do this for now rainbow topics I probably should come up with a better system but I am going to create a new issue pi day coding challenge suggestions please um add your suggestions for a pi day coding challenge in the comments below and you know maybe we can do some kind of like I guess I could do like a maybe I should do a reddit subreddit thread because there is a coding train reddit should we try that I don't know I'm so used to github I'll close this and move it there if somebody has a better suggestion but I'd like to let me just do this right now so you could add your suggestion here on github and then people can like you thumbs up the ones that they like and I can kind of look through and pick them that way you could do a tag on the github topics I could also do that that might be better for me to just do a label yeah let's not do it in the comments let's close this issue nevermind let's use a label I just thought it might be nice to go see them all in one place but with labels you can do that to use a label instead alright the trolls are out in full form today let's quickly quickly lock this conversation that's too heated it's definitely too heated probably and let's add a label oh let's go to issues labels new label pie day challenge for three I'm gonna be very your I'm gonna I'm gonna do this because this is the kind of person I am I'm gonna put my date with the day then the month that's what I'm gonna do and I'm gonna let's get a color here oh that's perfect okay so now you can file an issue and I will label it as pi day like this okay so send me your ID now next up moving right along let's see am I in the correct directory let's just see what's been merged thank you again to me I am Sammy who's been merging some up merging some of these flappy bird pull requests put git pull github master and we got some stuff I think we have some unicorn horn pipes loading loading loading horn filled flip dot PNG mmm looks like we're missing a file let's see what I can figure out their graphics horn body filled horn tip filled horn body filled horn tip fill ooh horn tip filled flips do I need that one paint pant dot ooh horn tip filled horn tip oh those are like I don't know what that is paint.net um these were made by a github user these were made by github user um just wanna k1j Julian Kay 1g Julian King Julian and we can see them here these lovely unicorn horns so I'm a little bit concerned I might really actually just want to replace these with just like drawing rectangles mostly because I'm a little concerned about having the collision I don't want to introduce extra complexity with the collision detection maybe me I am so me maybe whoops get pull get pull I can't like I almost can't do without saying origin I just keep till somebody fixes it and I just keep doing this I'm just kidding just kidding let's take a look here let's look at the pipe where is it being drawn draw this became incredibly came very complicated the good news is I was okay with all this becoming complicated because it's all just in the pipe class and I actually don't really mind if the pipe class is the super complicated thing because what I need to demonstrate will happen can be applied to any game whether the code is very simple or complicated so let me see here what is the image that's missing I'm sure there's a crack team of coders working ok now is fixed okay thank you me I am so we let's there we go looks like we've got that fixed let's go here and there we go so now we have our beautiful flappy bird game so slow on my machine and so let's see about this collision stuff yeah that's make sense but let's see let's see let's see yeah so it's it's it's using the rectangle up to the height of the tip of the unicorn horn I almost look like candy here but now I'm gonna change these two rectangles I can't tolerate it I'm sorry everybody this is I really like these designs and I will maybe come back to them if I don't know if me I am so me while you're watching if you while I'm kind of getting I'm gonna explain the github maybe maybe make it a separate branch or just like push push these unicorn horns into another branch but let's just make these a nice purple green blue rainbow colored rectangles there's also something running really slow and I don't know why because it's not yeah it's running at 30 frames per second just reasonable so let's do that if anybody can do a pull request I so cuz I think these are a problem there they're lovely beautiful unicorn horns but I think the collision stuff and yeah they kind of they resemble the poop emoji with but they're pink there's you know there's a lot of there's a lot of it's just gonna I'm just gonna be uncomfortable the entire time okay use of instead of Adam okay let's get let me let's go over to the whiteboard for a minute here and let's do some erasing or let's not do some erasing I'm thinking so I want to talk about neuro I want to talk about neuro evolution and I think that to start talking about neuro evolution it wouldn't be the worst thing in the world for me to have my left over ending diagram from the doodle classification example because one of the key things I want to talk about is the difference between train whistle what about like a train whistle for the pipe here somebody can like right I don't know just make it a dis a rectangle a plain rectangle okay is the chat going on in here okay so what I want to talk about is how back propagation and gradient descent while the sort of standard or probably most well known technique for training the weights of a neural network is not the only technique and so having this as a reference is good and then I need to I'm gonna and then what I'll do is erase this and diagram out how a genetic algorithm can be used to train a neural network okay so I think I'm gonna get started with this right now let's let's take a look here oh let's look at Simon's pull request so here's the thing this is very useful Thank You Simon for this I'm gonna not oh I'm gonna not merge this right now because I want to I'm gonna have to sort of like the mechanics of the way the game works once I'm doing the evolution thing is gonna be pretty different okay okay just push to change bath two pipes great thank you so now I'm gonna do this get pull origin master ah kit pull I just renamed it back to origin and let's go here there we go oh look at those green pipes perfect Oh green pipes everything is right with the world this is very quite hard to play but I'm also probably in the end gonna change this into circles but okay that's good I also let me just see something here yeah now this is great okay perfect okay thank you for that now let us begin I'm trying to think if I want to what am I doing here let's go to so I'm gonna go away from flappy bird for a second let's get rid of this come on computer terminate you okay then I want to open this up and Adam what's going on in here because I changed some stuff at one point and I need the neural network library and that's good XOR so desktop your own network coding train up am I in the wrong I've been in the wrong camera screen all this time again as I always am sorry everybody sorry everybody sorry buddy you know I don't know I'm doing my best doing my best okay let's see what do I need now examples XOR let's copypaste that and let's just do what's called neuro evolution so I'm gonna have an example and I'm gonna I want to do it with XOR but but let's leave that out for right now okay all right and so now I also want to yeah no kidding examples doodle classification oops train alright alright tests pretty good let's get the rainbow here yeah here we go alright so that's gonna be okay so this is weirdly not Chea for when you and everybody watching this is weird this is a new chapter that I so the nature of codebook if I go to the books website I am currently working on a there chapter 9 is all about genetic algorithms and I have a video tutorial series about genetic algorithms chapter 10 is about the basics of neural networks and that the content that's currently in the book at the moment is pretty its from 2012 lots happened in the fields machine learning since then you might have noticed and so and so I'm trying to rewrite this chapter and I've been making these video tutorials and examples in this neural network library and working on this other thing called ml v with just built on top of deep learned j yes all of which I am trying to get through and to do more and more stuff with um that I'm currently working on as part of a new chapter 10 and now so chapter 9 being about genetic algorithms I don't I think calling it the evolution of code is sort of silly and I should just call it evolutionary computing or genetic algorithms but that aside chapter 10 about neural networks chapter 11 which does not exist is going to be about using genetic algorithms with neural networks so I'm about to start the first video for chapter 11 and repeat exactly what I just said because I think that would be useful for part of the context because weirdly typically in the past the for all my other nature of code content the book came first and the videos came after the fact and this is a little bit strange that I'm going to make the videos and then hopefully write that content into the book all right so I'm about to get started and I'm will get started I'm just looking at my phone because ah because as I mentioned I have a very exciting guest video that will be released to this channel hopefully next week sometime but certainly sometime in the next week or two and that guest is coming to record at around 500 p.m. today so I've got to finish up by then and just in case you were on the fence of whether you wanted to be a patron of the coding train sometimes when especially when I have guests I'll keep a livestream going just to get a back up onto YouTube and I'll let people in the patron group kind of listen in on that as well but don't worry there's no need to be a patron of the coding training the video will be released but if you like a little advanced stuff water no I don't have any water this this this liquid beverage will have to do it's so Slurpee can you hear that like terrible coding train brought to you by anonymous cup of coffee I usually don't drink coffee while I'm livestreaming because it only leads to bad things but every once in a while it's just it's just necessary all right so let's close this out let's leave whoops how would I do no I don't want you to move anything let's leave this here move this out here I'm just getting everything ready come on come on Adam behave I'll do this okay all right here we go oh oh yeah it's fine it's fine I don't have a marker but I will I don't know if I need one this second but it's like a some people have like a lovey or a teddy bear that's their comfort object it helps them sleep at night I have a whiteboard marker it's my comfort object hello welcome to the first video in a new chapter of the book nature of code chapter 11 only strangely chapter 11 does not exist so I'm doing something a little different here where all my previous other nature of code videos that go along with this nature of code book the book was written first came out in 2012 and and this is the current version of it and then I made videos after the fact now what I'm going to do I want so chapter 9 is about genetic algorithms and chapter 10 is about neural networks and I have a set of video tutorials that go along with both of those chapters today I'm going to start talking about something that I want to be in the next edition of the nature of code in Chapter 11 called neuro evolutions so I want to take the idea of a genetic algorithm and a neural network and use them together in a magical way to make wonderful things happen on the screen or or doesn't have to even be on the screen in some other capacity that I can't even imagine right now so what is it that I am going to do so first of all okay so if you are on keyboard if you have watched some of my previous someone might other neural network tutorials you the most recent thing before the recording of this video that I made was a doodle classifier it's kind of the classic machine learning classification example I have some images maybe they're handwritten digits maybe they're doodles of cats and rainbows and unicorns and all that sort of stuff and I want to feed those things into a neural network and I want the neural network to classify them and if you've watched those videos you might have noticed that there's this whole elaborate training process the training process involves making that guess having some labeled correct data and then feeding that and then looking at the error like what is it supposed to be versus what it guessed and feeding that error back through the neural network just timeout for a second okay I really take seriously the at messages to my watch so little notes to me don't look thank you for the kind comments okay come back come back to my momentum so try not to a direct message during the live streams well yeah I probably should set up a separate slack user that just sends the notifications so that regular other messages don't get here all right all right all right let's see here looking at the guest output versus the correct label calculating an error and setting that error backwards through the network through a process known as back propagation where all of the weights are tuned and changed so while this is the most wellknown and probably most common and sort of standard technique for training a neural network back propagation with gradient descent very fancy sounding there are many other ways I mean there there's other ways that you can train a neural network one of which is using a genetic algorithm so what if we just threw away all of that calculus math and all of this sort of like error this error that and back propagation and we just said hey I've got an idea why don't I make it's never having one neural network why did I make a thousand of them and I'll try them all maybe some of them will classify image when one will classify images better than another one does maybe I'll keep that one and one just really gets everything wrong maybe I won't keep that one at all and maybe I'll pick from the ones that kind of do well and take those and duplicate them or mix them up to make a new population of neural networks and see how those do and this is the central idea of a genetic algorithm now I might suggest if you want to if you jetta carbs are totally new to you you might want to pause this video right now and go watch a genetic algorithm tutorials if the concept of a neural network is totally new to you you could pause and go watch those tutorials but you could probably also just keep going good I'm gonna I'm gonna cover almost all of this stuff anyway and as I try to sort this out so I'm gonna take a break for a minute I'm gonna erase this whiteboard here what's there right now left over from the doodle classification and then I'm gonna diagram out how a neural network can be trained using a genetic algorithm and then through that diagram I will discover things I need to add to my neural network code base and at some point if all goes according to plan you know I have this particular this was the doodle classifier example where did you see it's classifying my rainbow but what I want to do is take this version of the game flappy code egg train it's not very flappy I guess and see if I can use a neural network that is that evolved to play this particular game so that's going to be the goal of this series and then I have all sorts of other ideas for other types of neuro evolution tutorials I believe this is often also referred to as neat neat algorithm because it's neat neuro evolution of it see here's the thing I was just saying gyro evolution and all the while that could sound so much smarter by saying neuro evolution of augmenting topologies that's totally neat alright be back in a minute um okay I'm looking at the chat everything seems okay so now I need to do is go erase this man this copy is so slurpy alright so let's do some erasing if anyone has any questions I knew there is a reason why I shouldn't Rex this whiteboard for like two weeks I knew my microphone is this like some horrible scratching sound that I'm making you do it's really better if I erase it immediately after I use it anybody has any suggestions maybe there's like a squeegee company and I could hire to come in here just like big this shiny and new spickandspan you know I said earlier today that my passion in life is indentation and spacing and this is why linting this idea of linting your code is bringing such joy and happiness to me and yet in this moment right now I think I might have discovered that my true passion his whiteboard erasing there's nothing more soothing and meditative it's a good exercise it's good physical therapy for my broken elbow that's pretty much all the way just water my hair look nicer no nasty chemicals no cleaning anything just new water paper towel but now isn't so good for the earth but I guess the earth will have to survive means like in paper towels I can get a nice cloth or rag that's more reusable how am i doing how's this whiteboard look to you all clear pretty dirty to be honest with you I don't know what it looks like yeah you can see all those like smudges and things come at you I'm sure you want to edit a highlight reel of be erased important you do what are those like things in the video where like you do it really really fast instead of just doing a jump cut I don't know we've gotta get we gotta we gotta up our coding train game here okay all right I'm glad to see that the chat has moved on from discussing which coding language is the best to how to effectively clean a whiteboard that's actually not discussing that it's just that's what I wish for we're still like discussing MATLAB versus Pascal versus Java and yes do you think I could have a YouTube channel where I just clean stuff and I'm like happy about it all the time I really like that I think I'm starting a gaming channel because I recently acquired a Nintendo switch my kids and I we play it a lot and I was thinking I don't know maybe I'll make a gaming channel that's what that's all the rage a 44 year olds human who can have a youtube gaming channel people might watch probably not that's a terrible idea okay I don't know how to set that up I gotta like get the output into the input to the output this sort of thing a twitch channel and a little bit afraid of twitch but I am a kind of a twitchy person alright let's see take a second I'm getting a very excellent suggestion in the chat take a second and mark the edges of the whiteboard so you don't draw off the camera but what would be the fun in that that's all we should be living on the edge here don't you think alright let's see let's make this happen yeah I have um I think I'm kind of all better or worse I don't think that I can manage to like do different platforms and I've kind of got the YouTube thing going so that's probably what I'm gonna stick with but I don't know I'm always conflicted about this sort of thing okay so let me use a different color to mark the edges this is actually already marked up here I do actually have some markings already this is Mark's here this is probably more correct and this is mark down here it's not right I could promise I can't see my monitor down down down down down down down there and over here maybe over here this is really this is really the important one this is the one that I mess up all the time can you see that line to be where the tip of my finger is I think I got it right okay now that'll hopefully do okay so I'm just checking the chat doesn't your current streaming setup not take the output it's vegan but it does the output goes into the input here uhhuh it does it totally does and then the input goes back to the output and back into a different input also I'm really inputoutput things totally working I have all the plugs going from one electronic machine to the other electronic machine and they're connected to the Internet tube that's how I'm livestreaming so I could probably set that tube inputoutput plug based system up in my place of residence I should really get content what time is it 355 okay okay okay everyone okay so let's work okay now that I have them now that I have a blank whiteboard let me review the steps of a Janek algorithm and think of them in the context of a neural network so the first thing in a genetic algorithm that I need to do is create a population and the population is going to be a whole lot of neural networks neural networks are the individual elements so maybe that population is 100 neural networks I need to evaluate fitness of neural networks okay so this is kind of like again this is kind of like the setup I know that's kind of getting close to the top there it's the thing that I'm going to do once at the beginning of the program I sort of initialization state and this is this thing that I'm going to do for a loop you know generation after generation in you know in p5 this might be called the draw loop I mean to evaluate the fitness of all the neural networks and then create a new population and the way I will do that is by pick quoteunquote parents based on my handwriting is getting worse and worse over time based on pick parents based on fitness scores maps of probability it's so much room in this direction probability and then I want to apply crossover which is a way if I pick two parents for example I can take half of their socalled digital DNA of one and half of the other or some random amount of one and random out another and combine them into a new entity and then I can apply mutation which would be which is the step of saying hey let me look at the D let me I have this child DNA that is made from two parents let me randomly just change some of it up as if it's spontaneously mutating to continue to have variation in the system so again you could go watch my genetic algorithm tutorials where I describe all this stuff in much greater detail of different techniques and why and how but this is the basic idea but you might remember if you did watch those tutorials that this is kind of like the algorithm and it you know obviously you could change it and be creative with it but it's kind of somewhat of a standard the really tricky thing when you're making your own genetic algorithm and applying it to your own project is as follows number one is this idea of genotype versus phenotype what is that socalled digital DNA the genotype what is the data of that DNA and what is that data do how does it express itself into a system so this is really key in thinking okay with a neural network is somehow the genotype what could be the data so in fact thinking back to my simplest neural network which is just has a two layers really a hidden layer and output layer the inputs come into the hidden layer they get processed from the hidden to the output they get processed and then we have a final result so the core elements of those layers are weights and biases so all the weight matrices and the bias vectors those things which I described a detail of my neural network tutorials make up the genotype of the neural network the core aspect of it now the phenotype is the expression it's really really what am I using the neural network for so for example the expression of the neural network might be in the game flappy / bird the decision whether to jump or not jump that's the expression that's how it's going to be used applied in a given scenario in a classification example could be it's classifying an image that's how the data from the neural network is going to be used to make a guess based on this image and and and turn it into a string so that's a spec number once we've got that so what that means is when I write the code I need to somehow figure out how to do crossover and mutation with weights and biases I think I can create probably a population of random neural networks that's just gonna be like new neural network new neural network new neural network evaluating the fitness I've got to get to I can pick two random ones but I need to apply crossover mutation and to be honest what I might do it first in my first implementation is not even bothered with crossover and not even bother with picking more than one parent so one technique to simplify the genetic algorithm is just to make copies so I can pick the good ones and make copies of them mutate a little bit and keep going it may not work as effectively as if I use crossover but it'll certainly be easier to code so the other thing that's tricky with with when you're making your own genetic algorithm applying it to your own project is the fitness function question mark witness mark question mark so this is crucial if you don't have a good fitness function this whole selection process this quarter goat natural slice not very natural here it's like digital selection this I'm not gonna be able to distinguish between members of the population that do really well that should be that their digital DNA should be passed down the next generation versus ones that don't so I want a good fitness function that gives me a good range of probabilities and so in this case we could think about the classification it could be okay well this neural network give it 100 images its Fitness is how many of those it classified correctly and we could even go into it deeper and somehow score the fitness in court according to its confidence level about classifying them correctly but that might that might be flawed in some ways also so that's one thing with the flappy bird scenario if we think about the flappy bird game what is the fitness here well the fitness could would simply be the score so I'm a neural network I am a neural network playing floppy coding train now pee pee booboo input/output people my cell like cordial so it could just be like how long am I able to go through this world without running into a pipe so that could be the fitness so I could say hey why don't you thousand of you try playing this game a thousand of you electronic neural network magic machines try playing his game and and your fitness is how long you last before you run into a pipe and so that is the fitness function so we have all the pieces so what do I have already like if I'm going for this flappy bird example I already have the flappy bird game so I have the flappy bird code I have my genetic algorithm examples but ultimately there's not really I don't really have a genetic algorithm library per se so I'm probably gonna have to build the genetic algorithm stuff in the code but I do have a neural network library so I don't have to write I don't have to write the flappy bird game I don't have to write the neural network library however it might make sense for my neural network objects to know about crossover a mutation that might be something that probably should go into the neural net library so that any moment I could say like hey you neural network a new neural network get together make another or hey you neural network mutate yourself so I probably should that's something so that's the first thing I think I'm gonna do in in the next video is add crossover and mutations or maybe just start more simply I'm just gonna start with like a copy function just to kind of get going here a copy function and mutation so those things need to go into the neural network library and then the third thing is I just need to apply the GA so this I really need to do a lot of work to write the genetic algorithm code so I'm gonna start with my flappy bird code import the neural network library add crossover slash copy mutation and then start to implement the idea of a genetic algorithm in this particular program that started with the flappy bird code that imported the journal not look library that my father bought for two zeusie anyway never mind random reference okay because it's like the flappy bird that imported the neural network library that that added the genetic algorithm that there's that there's a song going on there that somebody else will finish for me alright Passover is coming up okay so that's that okay so you've made it to the end of this first video for chapter 11 of the nature of code which doesn't even exist yet but maybe by the time you're watching it oh I'll be so happy if it exists by the time you're watching this and so in the next video I'm going to revisit the neural network library and add functions for copy and mutation I'll see you there alright how we doing everybody okay everybody okay I'm like done okay go home now no echo 34 hello Dan did you have a chance to check my firework program on Twitter I think that I did that was a couple weeks ago I remember seeing it I remember it was beautiful ascend to me again just in case I missed it I recognized her name though echo 34 you've made a lot of great contributions thank you Dan many questions about the ethics of neural nets yes I have many questions about the ethics of neural networks itself and I but I so I don't necessarily have questions about the ethics of neural networks I have questions about the ethics of the people who have access and the ability to program neural networks and how those programs are applied in society so hopefully I hope or that the work that I'm doing to provide educational materials about neural networks will provoke that discussion and make it easier and more accessible for understanding of these algorithms to be in the hands of more people and so we can ask the right questions and work together to make sure the power of these algorithms and the way that they can be applied and the datasets that can be used with them is not abused that's what I have to say about that okay I suggest you override the weights when you apply crossover all right so I think that's good so anybody have any comments or questions before oh this is not his computer's not plugged in alright anybody have any close up so let me get set up I guess for the next video again I don't think we're gonna have I just want to be honest here it seems very unlikely at this point that I'm gonna have a finished flappy bird neuro evolution tutorial by the end of today but I certainly this is a project that I intend to I intend to write a chapter for the nature of codebook about it and and yes so don't worry even though I don't finish today I will also mention that if you go to github.com slash Schiffman neural network p5 so you'll notice I have a repository called neural network p5 which says this repository is archived by the owner it has now read only and I wrote this has been deprecated and it links to the coding train neural network Jas the reason why I mentioned this is I started doing this work last year and then decided I wanted to rebuild it again from scratch in video tutorial forum but there are for example the there is a neuro evolution tutorial here example here and let's see if I go to lick click this link this is actually running what I intend now to build and so let's take a look at this so and one thing that I built into this is I can like speed it up and blow away made it very easy to play you notice that so this over time we can see like the alltime high score and what I can do now is I can also say run best so far so this is now going to just show this is the current member of the population that has been that has the best neural network so far to effectively play this game so I probably should have shown this in the video tutorial itself but yeah you know comes next come easy come easy go or something like that alright so you can look at this for reference I think there's flaws and mistakes and weirdness in here but it's something oh I forgot to tweet that I was livestreaming again this is the worst thing that I do while livestream which is that I look at my phone in notifications but sometimes I just want to make sure that my guest which I'm very excited about it's not lost and figuring out where to go okay alright so neat nature of code doodle classifier so let's go to the code here and go to this neural evolution sketch and just make sure it's importing the neural network library in the matrix library and I also need to open up P and let me do something here what changes I just want to like do some get clean up for a second cuz this is gonna go into the repo get status here what did I change so first let me add and commit the let me add neuro evolution and let me say adding new nur neuro evolution tutorial neuro evolution example nothing to see here yet and oops escape alright now let me put get push origin master this and now let me see what's going on here let me say get diff there's some weirdness I don't know what know what's going on here I'm gonna just stash this because I don't want to deal with that and now I think I'm good and I want to have the library code open neural network okay whoa oh right I have the activation function thing this I don't know no so am i call them there or no semicolon there what to do about that look never never decide I guess this is really should have a semicolon there yeah yeah that's alright just want to see what the randomize function does oh that's in the matrix library oh it's really the matrix library that I want to randomize ah I really should change this to a Gaussian distribution so it's the point I need to do that guess I will not worry about it right now boy this has had some nice changes to it oh it has you realizing that wait a second here forgot that that was in there I've had some nice pull requests and also a lot of pull requests that I haven't had a chance to look over and figure out what to do about yeah here's the thing yeah I'm up to date one of the reasons why I haven't merged some of the pull requests which are amazing pull requests is that I feel like what I want to do with crossover and mutation is going to be much simpler to demonstrate with just a single hidden layer than if there were multiple hidden layers and to be honest this sort of flappy bird scenario is so simple it's just a few inputs I'm not gonna do I'm not gonna I could do all the pixels as input that would be interesting actually that would be really I got it I remember to mention that when I get to that but I think it's gonna be easier if there is just a single hidden layer and an output later then I can just do the sort of copying and mutation stuff pretty manually you know I don't know but I like you know I think that's good I think that's a good decision that's a decision I'm making right now all right sorry I'm looking at the chat um okay yeah I can just know I can just do map right right right all right all right all right it's all right all right okay so so really what I want is some new stuff in the matrix class copy okay I found a wire on the floor can you see this wire look someone's been making some physical computing tutorials in this room that is you can't even see it because of the focus all right hello welcome to part 2 of my neuro evolution series where I am attempting to look at how I can train a neural network or more accurately a population of neural networks with a genetic algorithm I talked about this in the previous video which you could go back and watch if you haven't but the main thing that I want to do in this video is look at okay well if I have a neural network if I have a neural network how can I apply crossover or a mutation to that neural network so that will be the focus of this video I do sort of remember though I did kind of remember that there's a lot of stuff that I haven't talked about yet because one of the reasons why I use the neural network is to be able to give it some inputs and to get some output so that makes sense in the context of the dual classification example probably but may not make sense to you immediately in terms of this idea of a flappy bird game so I will get to all that but right now I'm gonna focus on saying new neural network and you know what I'm gonna stick with copy like is that I'm gonna get to crossover in a future video I'm gonna stick with copy for simplicity and mutation so let's go back let's go over to the code and let's take care of that now let's start by having I'm gonna create a variable called brain and I'm using the p5 I'm using I mean using the p5 GS library though what I'm gonna do right now it's totally unnecessary for but because the flappy bird gained this program in p5 that's going to be helpful later also I use it all the time so I don't need a canvas I'm just gonna say no canvas and I'm gonna say brain equals new neural network now when I create a new neural network object if you remember the three arguments I need to give it and this is just for this particular neural network implementation it'll work differently if you're using you know say like a different machine learning framework like Kerris or somebody else's neural network library maybe you might want to look at deep learned Dutch is I will come back to that in a future video so I need to give it a cert number of inputs well all of a sudden now we're back to that question so let's actually not worry about that right now it's not worry about that question I'm going to go back to that question and I'm just gonna make something up so let's take the XOR example sort of like a trivial example of okay it has two inputs they're either true true true false false true false false so there will be two inputs let's just have a hidden layer with four nodes and one output so we can create some simple neural network and what I want to be able to do is I want to say let a cultlike child equal brain copy like I want to be able to say let me make a copy of that neural network and I also want to say something like child uh mutate so let me take that copy and apply a mutation in it mutation which is something I described more in the genetic algorithm video series so what this means is this neural network class needs to have two new functions it needs to have a copy function and needs to have a mutate function so let's go into the neural network library code this is the class there's a lot of stuff in here I have a way to many videos going through all this code luckily we can kind of ignore all of this and I'm just gonna go down to the bottom here and I'm gonna say something like adding functions for neuro evolution now the truth of the matter is what is it that I really want to copy well if you recall the neural network structure is such that if there are two inputs and four hidden nodes and one output the neural network looks like this it's connections between the inputs and the hidden layer and connections between the hidden layer and the output and these connections the the the sort of dials of the neural network the date of the neural network what controls how the information flows from the inputs and out through the output are all of these weights and these are stored in matrices it's just a whole bunch of numbers so I have a weight matrix which goes from input to hidden I have a weight matrix that goes from hidden to output and with each of these I also have this thing called a bias and if you recall the bias is something you know really all I'm doing in the end is like all of this really boils down to like hey there's a whole bunch of points just fit a line to those points and the plastic to be like move the line a little bit up move the line a little bit down so that's really even though this all seems like fancy magic ultimately that's what it just boils down to in the end so I also have the bias for the hidden and I have the bias for the output I don't know I don't know what the best way to write the notation for this is or yeah so all of these things when I want to copy the neural network what I'm really saying I want to do is copy all this stuff so let me go ahead and so what I need probably is a function inside of all these are all matrix objects I need a function probably in the matrix class to say copy so let's start here and say copy and you know clone could be used and I want to make a deep copy I think not a shallow copy these terms get thrown around a lot in computer science deep versus shallow but I don't want to like just point to the data I want just giving my own version of all of those numbers because I'm gonna mess around with them and I want you to keep your numbers I want to mess with your numbers so instead of just saying like I I'm a new neural network can I just point over to your numbers I really want a whole version of those so and if we go back to here so things that I need to do is I need to keep track of these properties input/output the total input output and hidden nodes so I want to say let let's just put this in here so I want to say let input nodes equal this dot input nodes let hidden nodes equal this dot hidden nodes and let output nodes equal this dot I'll put in you know what this this is very poorly named this is sort of silly what I'm doing but I'm going to do it anyway input nodes this is very this is me this is how I like to code I like to make things as longwinded and as possible so that I can really think it through and explain it like all I'm doing right now is taking the properties of the neural network I wanna cop and put them into local variables why because I want to say neural network copy equals new neural network with what I have a better idea how to do this I have a better idea how to do this so this could work but I have a better idea so actually what I want to do is I kind of just want to say this return new neural network this now you might be asking me like I mean this is this isn't gonna be mad this isn't just gonna work but what I'm sort of realizing here is maybe I don't want to copy everything here what I actually want to do is call the constructor but give it a reference to the existing neural network and then have that constructor instead of creating a new a new wait new weight matrices that are random it'll create weight matrices that are copies of the existing one in other words let me go back up to the constructor and look at this so what if so the constructor gets three things right a B I could just like rename these the parameters of the constructor function for a second and just call them ABC right a being the input nodes B being the hidden nodes C being the output nodes but before I do that what I actually want to say is is a an instance of instance of a neural network else in other words this is how I want to create oh I turn a pause I want to put a preference back that I turned off this morning and when I got to check the time for 2222 packages beautify I just I really like having it beautify on save so I'm so used to that on some put that back okay this here so what I want to do is if if I'm being sent three integers then I want to make the neural network the way I always have however if I'm being sent the first argument and this is this is kind of this is known as overloading typically in a programming language like Java if I had to overload the constructor like there's two different ways I could call the constructor I could give you three numbers to make a brandnew neural network or I could give you a neural network to make the copy of yourself I would write two versions of the constructor but in JavaScript you can only have one version of the constructor but you can kind of check what you're passing in and just to be clear about this let me just make sure this instance of thing is correct so if I were to say let a be a new new neural network 4 4 3 2 just arbitrarily and I could say a instance of its without a capital instance of a string I should get false instance of a neural network I should get true ok so that's right this this of should be lower case though if a is an instance of a neural network then what am i doing then I'm saying this dot input nodes equals a dot input nodes like I can start right here's where if it's not a neural network I'm actually assigning at the numbers that are coming in if it is I can just keep going Oh actually what am i doing I can say this and this should be hidden and now I can say this maybe I should have somebody has a suggestion for how to name these in a better way I just I didn't want to name them hidden input hit in output anymore because a could be either of those things so you know this this may be like to do document what a B C our output nodes that's a little note to myself that I don't like what I've written here and then now let's look at these so I'm not going to need to in demise the weight matrices because I'm just gonna say equals what am I gonna do here a dot weights dot dot copy write what I want to do is say hey my weights are your weights and now my input to hidden weights are your weights and my hidden to output weights are your weights now is this gonna run I don't think so because I probably have to add a copy method to the matrix object but I'm getting somewhere now what else do I need I need the biases so I need to set the biases so the same thing I'm just doing a lot of little like copy/paste stuff here so I need to set the hidden bias values and the output bias values okay so this is me creating this new copy of a previously neural network and then you know right now it looks like learning rate and activation function or at the moment even though I have different activation functions I can kind of write is this default is getting set to sigmoid as default is getting set to 0.1 so I probably should copy those as well I'm just gonna just be simple about this right now and just assume that my program is never going to change learning rate or activation function I should that should be a to do to do copy these as well at some point but I don't need to worry about that right now and to be honest the learning rate isn't gonna play a role anymore the learning rate is completely irrelevant the learning rate is specifically a tied to the tied to the gradient descent algorithm which I'm no longer really using with the with the with the genetic algorithm that's what I'm doing now okay we're getting somewhere all right so just out of curiosity remember this is the code I'm making a new neural network and I'm let I know I haven't done mutate yet but is this even working is that was there but did I maybe in some other universe happened to write a copy function already into the matrix class I seriously doubt it but let's see yeah copy is not a function so what this means is I need to also go into the matrix library and I think this this I think is worth having in here that's not just this isn't exclusive to genetic algorithms our Nura evolution like so I'm adding this stuff you know copy and mutate and crossover will be here specifically because of genetic algorithm but the matrix I can the matrix object I can be a little less formal about this so what do I want to do I want to write a function copy and what do I do I'm going to say let m equal a new matrix with this dot rows this dot columns so I create a matrix object with the same number of rows and columns and somebody in the chat I know is going to tell me there's some very fancy way that I could just instantly use some higherorder array function to copy the whole thing over but because I am Who I am I'm gonna say I'm going to write a nice little nested loop I can always refactor this later I just know this is gonna work and I'm going to say m dot data index I index J equals this this dot data index I index J so this is manually me looping through the entire matrix it's a grid of numbers it's all the weights of the connection of the neural network and just manually copying them over one by one and I think this will work I have some breaking news from the chat that I need to mention it's that good but it's not relevant to what I'm doing right now so I will come back to that alright so let's see let me hit refresh there we go so does this work I have two neural networks they both seem to have two for one two for one you know I could go let me look at one of these biases look at these values so this is bias H these are the values can you memorize those can you remember them let's go down here okay nope nope something is wrong so this stuff did not get copied guess what guess what I forgot I forgot something quite important in this function I did not forget to return the thing that's new but in the matrix I forgot to say in the return end so this new matrix that I'm making I've got to actually return it I made the copy you can make the copy you can take the reservation but you can't hold the return of the copy and I'll sign people Seinfeld reference for all of you try should have said that it'd be more interesting if I didn't say that okay so now I can look here and I can see okay look at these numbers memorize these numbers this is the way I actually let me look at I'm just gonna look at one of the biased ones this will be a little bit simpler so here's the bias bias hhas these values memorize them memorize them I could write a nice unit test to actually see if this function works I'll be much better but this has been I ball it 0.20 eight four one five yep these look like the same numbers same numbers say members so I'm gonna just choose at the moment to believe that this worked this is probably a bad idea but this is the reality of what I'm going to do and I'm okay with that so let's move on so we have now implemented copy when I next need to do is implement mutation now I do need in order to do mutation I need to have something called a mutation rate and that mutation rate is essentially a probability of how likely it is for each element of every of sorry each element of every sort of DNA to alter itself randomly when that child DNA is made so what that means in this context is for every single number that's a weight in these matrices for every single number that's in the bias there is a say one percent chance point five percent chance 10 percent chance then I'll pick a new random number I could also with mutation like a nudge to the values so sort of picking an entirely random new number I could like push it a little higher push a little lower but for simplicity right now let's just pick a new random number so what do I need to do I need to go back to neural network J s and I'm going to add a function called mutate what am I gonna do here I'm going to say there are four things that I need to mutate so I'm gonna say let's think about this what are all those things called there's I just got to go back up to here there's weights ih weights H Oh bias H bias Oh so I need to say what I need to do is say weights I'm gonna map a mutation function so remember there's the the V sorry I'm not able to type to talk at the same time so if you recall the matrix the matrix library has a function called map and what it allows you to do it's a little unfortunate that there's also a JavaScript native function called map which I'm using everywhere it allows you to apply a function to every single element of the array so I can pass in a function and apply it to every single element of the right and the function that I'm gonna pass in is mutate so let's write this function now and it's going to get it receives a value but to be honest I don't care about I do care about what the value is if I were planning to nudge it higher and nudge it lower but what I'm going to do right now is I'm just gonna return a random number so let me actually I sort of for that should probably link these better in some way but when I have this function called randomized and this is the kind of random number that I'm asking for so I am going to just return this ah but am I always going oh I do need the Val guess what if I do this it'll completely randomized every single element so this mutation function needs a mutation rate and what I'm going to do is I'm gonna pick a random number if math dot random is greater than or less than the rate right so only so let's say math dot random will give me a number between 0 & 1 so if the mutation rate is 0.1 that random number between zero and one will be less than 0.1 ten percent of the time otherwise stick with the same value so this is now the function that I want to apply to every element of all of the weight matrices I want to say hey mutate these weights mutate these weights mutate these biases mutate these biases and perhaps there's a more elegant way to write this and I will consider that all in the future with your many comments and pull requests and complaints I look forward to them but this is what I'm gonna leave it at right now so let's see now if what I can do if I go back to this particular program and I say child now just out of curiosity I'm gonna say child mutate one so I'm giving it a mutation rate of 1 which means everything should be completely random and what I'm gonna do just as a kind of like a way of testing actually is I'm gonna change this to I'm gonna multiply it by like a thousand just cuz I want to see like totally different numbers to see that this is working so I'm gonna go back and I'm gonna refresh the code weights I H is not defined oh right I forgot about that this dot that won't surprise any of you you've probably been saying this in the chat all along there we go so let's take a look so here we have once again the bias ease there all reasonable numbers between negative 1 and 1 which is how I started the neural network and now if I look at the child neural network and I look at the bias ease we can see yep so that mutated now let's change the mutation rate let's change it to 0.5 so we have kind of I mean we're not going to get exactly 50% of them because it's supposed to be random but we'll least see some of them didn't mutate and some of them did so let's change now the mutation rate to 0.5 just to see that this is working this is instead of me writing unit tests manual unit testing let's look here we can see wonderful here's some original values and now let's go down to here in the child object and let's look at the bias ease again and we can see hey it actually worked out exactly as planned it mutated two of them and did you take two of them which is what you know most commonly with a 50% probability we're gonna see and I suspect that if I go into the output bias though the alibis just has one value it didn't get mutated right because this is such a simple little neural network if we go into these weights we can see you know three out of four got mutated I think it's working so we are in good shape here we now and so I went up probably the actual mutation rate I'm going to want to use something like 1% because I want to do it pretty rarely but we now have the ability to both copy a neural network again as the Nexus if you're watching this and the future videos of this tutorial aren't released yet or if you don't feel like watching them just yet try as an exercise to yourself go and implement crossover how could instead of instead of copy could you create a new neural network that's a mixture of all of these weight matrices that would be a really interesting thing to try I will do that hopefully in a future video so I've got copy I've got mutation I've got the flappy bird game I've got the neural network library I've added cross the room mutation so we're ready now we're actually ready to implement the genetic algorithm I'm going to say this twice I'm someone in the chat pointed out that the neat algorithm neural evolution augmented topology things refers to a very specific implementation of neuro evolution in a specific paper and honestly being much more informal about this here so technically this probably isn't the neat algorithm and maybe I'll mention that the beginning of the next video just to emphasize it a bit more alright thanks for watching and I will see you when I continue all right let me look at the time where are we time was it's 440 I think I should stop because the next aspect of this I think I should stop because I don't have very much time left and it's definitely going to take longer than 20 minutes to finish a neuro evolution let me just check some things he let me just check some things here I'm just looking to make sure I don't have any important messages that I need to deal with right now and I don't seem to okay I do see that some people have suggested pi day to calling challenges which I'm excited about so what have I done so far today I have done one video about linting which needs a followup I have done one video about remote maybe I could do my load bites pull request this could fail this is probably gonna fail horribly because I mean more time for this yeah it's a bad idea III want it I I let me just say what I was thinking about doing I think it better for me to just it's not good for me to try to do something I have a very limited amount of time especially anything that's complicated that this will be way more complicated but I want to go to up what I want what I was what is thinking about doing that I think would make a useful video tutorial and so let me add a comment here about this at least load bytes so so this by the way is a github issue that I opened for the process for the open source project p5.js which is a project that I'm very much involved with a wonderful community and open source project where I created a version of the load bytes function to load a binary file to a JavaScript program which doesn't at present exist but doesn't at present yeah which doesn't at present exists in p5 if you go and look in the p5 source code will say like to be implemented and so some people gave me some feedback here and I just keep it's been on my list like every day oh let me pull request this and then I thought oh it would be useful to actually make this contribution to p5.js in a video tutorial but I also feel like oh what am I ever gonna get to that so let me make a note here and just say FYI I am writing this while livestreaming I would like to make a video tutorial where I walk through the steps of how to contribute this in enhancement but I did not get to it today I I think this would be useful so I am holding off on submitting until another recording session so this looks right okay so wonderful so out of that note there thank you to everyone who has been monitoring the YouTube chat today I it's not an easy thing to do and I really appreciate it it's very important to me that the community that participates in the channel is kind and welcoming to everyone and so as always if you're running into any issues during any of the live streams please send me a tweet or an email you probably can figure out a way to get in contact with me I'm happy to do anything I can to help so I think what I'll do is so I'm gonna go in about five or ten minutes I'm happy to maybe take a few questions let me actually also I don't think anything that I've done has broken any of my existing examples wouldn't it be nice to have unit testing here to see but I'm going to say get add and did I say to everything that I've done and I'm gonna say get commit oh let me do something this is my new thing that I do that I like git commit and Adam editor wait so let me do this I want to make a video about this but yes this is what I want so what I'm doing is I'm associating Adam as my core text editor with git and so I'm going to do this and the weight is there because when I say commit I want it to wait to make the commit till I finish typing in Adam so now if I say git commit it'll open up the message in adamant actually I'm gonna I'm gonna do ctrl C because what is the thing where I say V is a V or verbose somebody must know where it I should really just make this a video right now 15 minutes I I just like when I have a nugget of something I think people find it better if it's in the right place and it's an edited chunk as opposed to a random thing all of this is a bad idea and the chat of being told that ass usually Adam for this is a bad idea guess what yeah it's all a bad idea we should all just go back relax by the fire with our friends and read a book frankly you know playing the violin is something that I did for 12 years and I approached should spend more time doing that what is it for both nobody's answered my question I was oh you already is asking when is the next ITP show I think it's May 15th and 16th you should come to it in person but I will plan on doing a live stream from it again I guess I could just try B yeah that was it shows me all the discs look at that boom boom boom I like that it's good okay so alright why not all right use a sensible editor like VI but i but but but but but oh nice lollipops you can't really do that it takes time and googling all your questions you need a violin coach am i you know I can't tell with you but whether I'm doing alright fine I'm not gonna do my video about commit right now you guys have thrown me off I'm gonna just use Adam because that's the way I like it and I would say commit V so what I like about this is it opens up the text editor where I can write my commit message adding and it'll actually even like do stuff like hey start that with a capital adding adding code from March 8th live stream on neuro evolution because it doesn't like that I went so far on one line or too many yeah adding code for March 8th live stream this here is the start of code I need for my neuro evolution examples so far I guess it wants me to so far I have only implemented copy and I've only implemented copy and mutate I I still need to do to do crossover these I don't know I feel like that I don't know where the period should go I'm having a grammar moment the period I thought should go inside but then the print these threw me off ah I still need in lacrosse I'll have an ant ear how about this okay met up I still need to do crossover and and implement the GA itself of course for for for reference the live stream is here live stream is here so how do I get YouTube the coding train yeah I really got to go actually cuz and so if I go to code and train live this will be the York this URL will go on forever and so this I think is a nice thoughtful commit message that explains everything I am now going to hit close and it added that is it March 8th hope it's part its virgin I mean nobody noticed that there's like an ax men thing right get commit amend wonderful thing ever it just happened this would have been so good for me to make this into a video tutorial you all of you who shamed me for using Adam as my text editor you are depriving the world of a nice standalone tutorial I'm gonna tweet a link to this time code in this video for people to see and find adding code for March 9th live stream and I'm going to close that and there we go get log 1 we can see here's my message and now I could say git push origin master and we will go to the toy neural network and I will look at the commits and look see ix is right oh it's running some tests I forgot that I have oh I should have pushed it I forgot I meant to push it to a different branch and then merge it oh well at least the test passed and we can see look see look at this this is the world we should be living in where people write thought full and kind commit messages the date is right I know the dates below the dates in there but it's fine all right I've got to go I even just got a calendar warning I've got to read some and I'm just reminder that I'll be back on march 14th for pi day submit your coding challenge pi day coding challenge ideas rainbow topics link in the description below 7705 2050 490 1961 five hundred fifty eighty four thousand seventy one three thousand five hundred seventeen twenty eight thousand nine hundred fourteen forty eight thousand seven or sixty to seventy two thousand nine fifty to ninety six thousand thirty seven alright I read some random numbers and I'm gonna put this song on goodbye everyone but it now has a different commit date to its creation date or something oh boy I don't know I don't know just I can't get it right to everybody it is what it is thank you to Darius cos Amy who gave me a lot of great tips on open source stuff in the last couple weeks I'm working by the way on an idea for a course about contributing to open source that I wanted to go and teach next year and then why you have a github repository with ideas in it it's a point out puppies you could find it probably few want but I'm soliciting contributions and ideas for that so and I will continue to make more video tutorials I'll be back next Wednesday there will be a surprise for you because I am going to shortly record a guest video for the coding train channel that will come out sometime in the next couple weeks so stay tuned for that and I'll see you all I'm still here looking at my phone now alright everybody I'm gonna hit stop screaming now so I probably won't return to the neuro evolution thing next week that'll come two weeks from now so the next live stream there also be a guest two weeks from now I mean I have a lot of guests scheduled that I'm excited about like three or four so far coming up okay next live stream Wednesday March 14th probably in the morning of my time and then March whatever it is like 23rd I think is the next Friday alright bye everyone