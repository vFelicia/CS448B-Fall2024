welcome to part 2 of my asteroids coding challenge if you watch the previous one I have I had a ship and I had asteroids but no pew pew pew pew pew lasers so in this particular second part of the coding challenge I'm going to add the lasers which hit the asteroids and break them up into small pieces and don't forget if you're interested in a machine learning after I finish this video which I've already finished I don't know I've got some timetravel thing going on you can go to the link in the description to Suraj's channel where he has will have at some point soon a video word that trains a bot to play my asteroids game okay so enjoy part two of this asteroids challenge did I do okay so let's see if we can manage to add that so I'm going to add a another javascript file call it laser Jas and here what I want is once again I need a position and I need a velocity and I need an update function I need all the same sort of things which is this dot position dot add this dot velocity and so and then I need a render function and I'm just going to draw it as a point this dot point this this dot X this dot Y and a stroke 255 I'm going to say stroke wait for to make it a little bit thicker and so now if what I need also now just the same way I made the asteroids I need and you know what hmm I'm tempted to put these in the ship object like the ship keep tracks of its own lasers but just for simplicity sake I'm going to make an array out here so I'm going to make an array and I'm going to in draw just like with the asteroids I'm going to loop through all the lasers the laster's the lasers and I'm going to render and update them the doesn't need an edges function and now when do I create them so I want to let's say I want to create them when I hit the spacebar so I don't know what the key code is for the spacebar but I can also just say if key equals space so I can add to this key pressed function and I can say lasers dot push new laser now here's the thing where should the laser start well the laser should start wherever the ship is so I actually in this case want to pass something in to that laser constructor and I want to pass ship dot position so I want to say create a laser where the ship is so now if I go into that laser I can receive an argument like a ship pas ship I could just call this pup mount ship s pause for like ship position starting position and I can say create a vector s pause X s pause Y so I'm copying essentially by making a new vector with the same x and y and so now if i refresh this and I hit space ok laser is not defined I'm not going to ring the bells uh I now what I need to do is make sure I have a reference also to laser day s I add a new JavaScript file in my in my index.html file my brain is know thing about doing this for too long ok this is a long coding challenge ok here we go let's see spacebar oh look at that it changed the stroke weight of everything that was kind of exciting but but uh it did not I don't see any dots on the screen so let's let's have a look here let's look in the console for lasers I definitely added a bunch and their positions are on the screen why am I not seeing them so a couple things one is uh am i calling this dot render sketch j/s am i calling this dot render draw lasers I make our lasers that render I am lasers i dot render let's okay and oh you know what I did wrong this is like total nonsense this dot X and this dot Y doesn't exist what does the laser have it has a position vector and a velocity vector so this is this dot pause X and this dot pause dot Y and by the way let's add the push and pop here so that stroke weight doesn't affect anything else whoops and now I can it so you can see as I move it creates little dots where where the where the ship is now here's the thing I want those dots to move and I want them to point in the direction of the ship itself so in addition when I make one of these laser objects where did I do that right here and not only need to make it the laser with the ship's position but I should really pass in that heading as well right I want to give it the angle because the angle is going to tell it which way should it be pointing when it creates a vector to start moving so if I add ship dot heading to the constructor I can now say that's an angle that I'm getting in the laser I can say P five dot vector from angle angle now did I call update in the main sketch I don't want to make the same mistake I did so now we should have yeah they're kind of slow but they do work look at that this is fun okay so first of all they're coming out of the center which is a little bit weird should probably make them come out of the front but I could offset them I'm not going to worry about that too much I am going to make them move much faster though because that's ridiculously slow so I'm going to say this dot velocity dot multiply I'm going to multiply it by like ten so they're ten times as fast that's really fast and you know I could do a little trick I bet you won't notice if with the ship if I actually set when I draw the ship instead of no fill if I said it's fill to zero so I give it a black fill it's actually cover over the lasers as long as in sketch j/s mimimimi wherever I need to make sure the ship is drawn after the lasers so that it covers them now we should see yeah that looks a little bit better so now all I need to do is figure out when the lasers hit those asteroids and when they hit the asteroids I need the asteroids to break apart ooh this is exciting okay here we go here we go so ah boy so many features I think this might be the last feature I'm going to do so I need I do need some kind of collision detection here um so how do I do that well here is a loop where I here's a loop where I am looping over all the asteroids here's a loop where I'm looping over all the lasers I need to check every single laser against every single asteroid right I need to do something like if lasers index eye hits asteroids index J right for every laser I check every single asteroid hmm now here's the thing I need another loop so I need my asteroids loop inside inside the lasers loop mmhmm oh and this should be J I can't use I for both loops otherwise my program will get wildly confused so now I'm saying now hits is not some automatic function that just exists I almost want to just like run this code and it'll work I'm writing up the code again to tell me what I need to put into my objects if I was using some kind of game programming framework or library there's one for p5 called p5 play it might have collision detection built into it but I'm just going to do something simple here myself lasers index eye hits asteroids index J so that means in the laser object I need a function called hits that expects an asteroid object so I go to laser and I say this this dot hits equals function a asteroid and then now how do I determine if the two things are colliding well there's an actually easy way for me to do this because what I have is I have a like circular like thing and I have a dot so if this was a perfect circle I could just determine is the dot is the distance from the dot to the center less than the radius or greater than the radius if it's greater than the radius it's outside if it's less than the radius it's inside and you know it's going to be a slightly off for some of these jagged edges but it all happened so fast I bet no one will notice you could do like complex elaborate polygons thing yourself if you want write it in the comments and 7year corrections okay so now I want to say var D equals distance which is a p5 function between this dot Paz X this dot Paz y and the asteroid dot Paz X asteroid Paz dot Y so I want the distance between the positions X Y and the asteroids that the laser is XY and the asteroids X Y if the distance is less than this dot R plus asteroid are the know this this doesn't have an are just the asteroids are if the distance is less than the asteroids radius then then it's colliding hit so I'm just going to and I'm gonna just console.log hit for a second and see if this works come on hit no I don't oh yeah is it actually working and I'm just losing my oh it is working I think it's been working all along I just like didn't actually hit any of them so you can see it's working sorry everybody whoo so the whole point of what I wanted to do here I'm not sure if some of that should have gotten edited out or not but it's working out has been working I just didn't have the console log in the right place or something ooh so what I actually want to do if you look at my sketch j/s is that if the laser sit I visit an if statement so I want that to evaluate to true or false so what I want to do is return true if that's the case now there's another thing I could actually return the result of D less than asteroid R but I like to be annoying and write extra code but I don't need to and also I just think for teaching purposes it's sort of something that makes a little more readable to see the whole thing written out because what I'm doing is I'm returning true or false based on whether the distances in that threshold or not so if it is within that threshold what do I need to do I need to do a couple things in sketch j/s I need to say asteroids index J like break up so what happens in the game asteroids when your laser hits the asteroid it like breaks into two smaller asteroids so how am I going to do that oh this is tricky tricky tricky boy this is not as easy as I thought okay so first of all one thing I need to do is I want to I think the way to do this is to remove derive an array of asteroids so I want to remove the bigger asteroid from the array and add two smaller ones in the same spot so what I can do is I can maybe have this function break up new asteroids return two new asteroids that are smaller but look the same and then what I can do is I can say asteroids dot push new asteroids so it's going to add and then what I want to do is say ask asteroids dot splice I comma one oops so by the way I'm using the wrong index here I goes with lasers J goes with asteroids so this has to be J and this has to be J as well okay so up above above so now this should work the same issues here first of all I have to write this function break up that generates two new asteroids so this won't work let's do that first so I need to go to the asteroid object and I need to write a function called this that break up equals function and I'm going to say var asked new a for new asteroids is an empty array so what I need to do is I basically need to two new asteroids at this particular location so this is an issue like the asteroids constructor function can does not receive any arguments I wanted to if it doesn't receive an argument create an asteroid at a random location if it does receive an argument create an asteroid at a specific location so I'm going to add an argument pause here and I'm going to say this dot pause equals pause let's see hmm um I'm just going to say right now if pause this dot pause equals pause I could be more efficient about this with like a an or kind of in the statement but just so what I want to say is if this constructor received an argument set its position to that position otherwise make a random position here's the problem though I don't want to just set the vectors equal to each other because they're objects and they will both actually point to the same object and things won't move properly so I need to make sure I copy this vector when I bring it in so this will create the asteroids at that location no there's a bunch more thing I need to add here but let's just see how that does okay so and then so what I need to do here is say new a index 0 equals new asteroid at this one's position and then a second one also at this one's position and then return those two so this should now give me two new asteroids whenever I hit one of them okay cannot read property ex of undefined lasered I bet you up missing on this or a pause laser J a slide 18 laser J s line 18 ah whoa X of undefined oh okay there's a big problem here which is that I'm looping through the asteroids and adding new asteroids at the same time so that's really a big problem because I I'm gonna like I'm adding some asteroids then I'm gonna check those and I might add some more asteroids then I check those so I really need to loop through the array backwards so that when I add stuff I don't check them again so I'm going to start the loop at asteroids length minus one go all the way to J is greater than or greater than or equal to zero and J minus okay so that should help the other thing I'm going to do is I'm actually not going to add them right now because I want to just go say console dot log new aster new asteroids I'm getting some nice messages of tips in my chat okay so so I just want to see okay it's gone and I got and I'm seeing two new in the console so that's a good sign so I'm seeing two new asteroids and so I should be able to add those now but there's a problem when I add them the laser is going to be right there and it's going to be intersecting with those two new and then it's going to add two more so I'm gonna get to stuck the reason why confident as I could see this like recursive loop happening or laser hits asteroid Laser disaster and laser asteroid and it's going to go crazy so fortunately what I need to do here is also loop through the lasers backwards I and then I also need to say lasers dot splice I comma one right I want to remove that one laser so let's see if that works now oops okay cannot read property hits of undefined so I think this is not working properly oh I forgot to push them in no where did that happen oh so many bugs sketch line 26 so my asteroids are undefined for oh the lasers are undefined for whatever reason because I'm removing it and oh look at this you know what this is kind of unbelievable but there's a problem here where I need to just break out of this loop I'm done with that laser so I so I need to just hit a break because I think I'm going back and checking things that don't exist anymore let's try that yes there we go so now you can see the laser and the asteroid goes away and now I should be able to push okay so I thought of that in my head you might be wondering what did I just do the problem is I'm safe lasers index I and then I delete that laser immediately but I'm still in this loop because there's a bunch of asteroids that I'm checking for each laser so I need to make sure I like get out of that asteroids loop because I'm done immediately so break will do that for me I hope that makes sense so now I should be able to say asteroids push new asteroids and we should see uh asteroid stop Index Ida render is not a function okay so I removed the asteroids and and I was which loop and like breaking out up I'm breaking out of so let's look at the asteroids array and see what it looks like and I need to have a bit more room here okay oh look at this so it doesn't do what I thought it would do I just thought if I called bush and gave it an array it would add both them to the array but it doesn't actually do that it added a fourth element which is an array which is two so how do I add an array I thought push would do that but I guess it doesn't concatenate if there's like I concatenate two arrays together function right JavaScript concatenate two arrays I could also just write my own little loop concat method so can cat takes one array and can cat sit with the other one okay so what I want to do this should work that I should be able to say instead of push asteroids equals asteroids concat the asteroids so merge those two arrays together oops I'm in the wrong place here we go let's see how if I get this to work all right now it's splitting apart now here's the thing in addition to having them split apart they should get smaller so what I want to do is in the asteroids I should also optionally receive an R value and I should say if R and let's just have it always be divided by two so times 0.5 whoops I lost what I had there so if it's not receiving an R value it's a random value if it is I get R times 0.5 so now they should be getting smaller each time oops that didn't look like that worked okay I can't tell let this is a big one well you know what it is here's the other thing oh the offsets the offsets are always between negative 15 and 15 they really should be a function of the R itself it should be between negative this R and and positive this dot R so like the offset maybe also times 0.5 so it can't so the offset because as I get smaller the offset shouldn't be as much I should probably just use scale why are they not getting much smaller let's see oh that seemed to work what am I missing here okay do I I forgot to add it so I didn't actually pass in the vert the value so when I make the tube at new asteroids not only do I need you can't just like put something there and then forget to call it as I seem to do a lot this dot R this dot R do this for the little so I don't I don't know anyone still watching this but this out are this dot R okay so now that should get me what I want which is there we go they're smaller look at that each time I hit them they're smaller now I could also copy the offsets so the shapes are exactly the same but this is sort of close enough for me the other thing is once I get to a certain size they should just be removed so another thing that I should do is in sketch j/s is I should have some sort of threshold and I should say as long as asteroids index J dot R is greater than what's a good R let's say 10 as long as it's greater than 10 then you can do all this breaking up stuff otherwise increase the score you know otherwise do nothing increase the score so I'm still always going to remove the asteroid and the laser but I only want to like double it if there are actually I should always be increasing the score because so whatever so I only want to do that if the asteroids are greater than 10 so now let's try to play this a little bit 10 is really small but you can see they're gone after a certain amount I getting distracted by playing this game ok this is totally fun ok I think basically I've done everything now except for one thing I should probably add something where you die maybe not die you just start over do something different if the ship hits the asteroids and this will be the last feature that I'm going to add in this coding challenge ok so now what I need is somewhere out here in the asteroids loop I could say if ship dot hits asteroids index I then uh I'm just gonna consult I look I'm just gonna add a console dot log because I'm feeling tired this will be an exercise console dot log oops so I need to now add a function in ship which says this dot hits equals a function which expects an asteroid and I can also calculate the distance again between this pause X this type of dot Y asteroid pause X asteroid pause Y and now now if d is less than I'm like losing my mind here this dot R right plus asteroid R so I'll just add the two like cite you one's a triangle once a strange polygon this isn't exactly right but it's pretty close I'm going to say return true otherwise return false and now here we go let's just see we're going to look in the in the console if I died let's see if I can win this game I should probably test it sooner than later but I haven't died yet okay I'm getting hit so you can see that I'm getting hit so I've got something close enough I could change I should actually probably like drop change its color something so we could sort of see some visual feedback but this is the basic game mechanic so remember here there I did it go to challenge programmed asteroids in JavaScript using the p5 GS framework in the browser I would love it if anybody takes this game the code for this will be on github and I hope I might try to make a code pen out of it as well so look in this video's description you can find the code play with it tweet me a revision add stuff for me like what I need to do now because this as I mentioned at the beginning of this video this asteroids game is part one of a collaboration with Suraj Suraj has a YouTube channel who can make videos about machine learning and I'm going to pass this game off to him and he's going to train a bot to play it and get a super high score so the bots going to learn how to turn the ship push it shoot you know destroy all the asteroids so I need to add really just like a score mechanism and alive lives mechanism so if anybody wants to volunteer to do that you can you can fork its code on github make some variations on it and I'll pass that off to Suraj and I'll see you in another coding challenge oh wait don't go anywhere I forgot something in the patreon chat on slack somebody points out my lasers array is getting just bigger and bigger and bigger and bigger this is a definite problem so I do need to do something which also says this video is not over you thought it was over I really should add something that says if lasers index I offscreen then also laser splice I index one so I'm going to do that I'm going to do that uh yeah I think if I just do that here that should be ok but if I've already removed it here that's fine I'm just checking the next one that's fine I think we'll see so I'm gonna now now I need an add a function and it's actually very similar to the edges function so I'm going to look for like one of the edges function in like ship and I'm going to go into laser and I'm going to say this offscreen equals function if pause dot X is great I don't need any of this this dot R stuff just if it's greater than with this is probably more trouble and it's worth less than zero if it's greater than height or less than zero if any of these are true and I can put these together in or which maybe I'll do here so or this return it true if it's either one of these this is a really ridiculous way of writing this then also return true otherwise digit to the return false so let's now look at what I want to do now just to see that this is working is I want a console log Lazer's dot length to see if that array is growing or shrinking so and also I think I have some extra weird console logs somewhere but that's fine so we should see there's zero lasers right now and does it get back to zero yeah now it's back to zero so you can see this is working great so now that laser array oops uh off screen of undefined ah sketch as line 39 so ah if it doesn't exist because it possibly could have been removed here this is this is a oh you don't I can just do is here and then I can break so if it's offscreen no no that's go to the next one don't bother otherwise there's got to be a better way to write this this is like the it's like an hour into this video ah nobody's watching this anyway anymore so I got to think of a better way to do this but my brain has melted but so what I'm doing is I'm saying if it's off the screen get rid of it otherwise you can start to check at it check check against all these asteroids and that should fix that problem I don't know why my eye tubes opened people are going to start complaining now that I'm using a Mac I get back at that good played a lot so now I should be able to say uh you know the lasers are now that array is not I'm trying to win this game hmm oh you don't need to watch me play this game anymore I'll play it on my own time thanks for watching this coding challenge go and watch as soon as it's available there'll be a link in this video's description to Suraj's video where he trains a to play this game I'm super excited to see how that works and what happens and I hope to see you back in another video sometime soon thanks again