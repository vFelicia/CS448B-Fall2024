so now that we've looked at a lot of different scenarios and possibilities around retrieving data a data feed from an external source I want to talk about a problem that happens when you are trying to update your updated data feed while and it program that's animating is running so for example we have we have a simple processing sketch with like setup and draw and maybe here is where we have our call to load XML and some URL goes here we load all sorts of data we calculate it we get everything we do all we want and then we do all this work here and we get this beautiful you know design spiral pattern colorful things on the screen what if in what if this data that we use to draw this it changes every five minutes or every five seconds or every half a second what if every so often I want to ask in draw for new data well this is this is an asynchronous call meaning it takes time when I say load XML I've got a request this URL pull the data back and once I've got it and that takes time and the server's gotta like here my request response and and it might not take very long it might be like half a second for us that's no problem but for an animation program that's trying to run 30 frames per second this can be a huge problem and what you'll see is that your program will stutter so let's take a look at kind of a fake scenario here whoops so I'm gonna I've got a program here where I have okay so I have a fake function called load data which does nothing and if I were to take that load data function and put it in setup we've got no problem my program runs even if I create now I'm Kecia this function delay exists in processing and basically you should never ever ever use it the only valid use i've ever fasting delay is exactly this demonstrating something that takes longer so let's say there was something in here that takes a thousand milliseconds or one second to execute it's no problem if that happens to setup a second by before the program starts now however if I were to now put that load data function into draw and run this my program is like crawling to a halt because every time before it draws it's got a request data wait till it comes back and then draw the next frame this is no good and what we want is instead for the call to load data to go off and do its own thing however long it takes while draw continues to execute and this is what's known the solution for this is called threading a thread being a sequence of instructions that's happening one at a time while the program is running that's like the worst definition of thread ever it's like that's a string and we've got one string and we're just going along it if I could have two strings one going and reeving the data the other animating if this one's taking a long time this one would still go fast so and this by the way the processing a processing program is a single thread it's often referred to as the animation thread setup then draw over and over again every line of code one at a time so what we want is for load data to happen off in another thread so now if I jump over here for a second again I'm gonna kind of show you a program that's rather complex that we could kind of mostly ignore but I want to show you this because here I made these two like thread objects and I'm giving them some values like a thousand and cat and 1500 dog and when I run this program what you're actually going to see is that cat is count and dog are both counting up but they are cat is counting every 1000 milliseconds dog is counting every 15 hundred milliseconds so these are actually separate threads that are happening in the background and I'm just drawing their status onto the screen this is I probably should have shown this to you first this is kind of how you do threads in Java and you can see there's a class here and it extends thread and there's all these variables like how long to wait and whether it's running or not this is something you might look into at some point if you need a more sophisticated thread that's keeping lack of a lot of information however if we go back to this problem of simply wanting to execute a function and have it have draw keep going while that happens in a separate thread there's actually quite a way to do this and if you ever done any programming in JavaScript this almost kind of mirrors how JavaScript works javascript is has a really easy time with these types of multiple events and asynchronous things all happening so let me come back to here and let's go back to our program where we were loading data now one thing I want to change about this is I want to say like I'm going to use the modulus operation I don't know if in any of these videos I've covered the modulus operation but just very briefly modulus is the % it gives you the remainder of division so 60 divided by 60 equal or 120 divided by 60 is 2 remainder 0 121 divided by 60 is 2 remainder 1 modulus is 0 or 1 that remainder so if the frame count module is 60 we'll only equal 0 at 0 60 180 240 etc so every 60 frames I want this to happen and what you'll see is every 60 frames there's a onesecond pause while it loads the data and then keeps going so instead of calling load data directly I'm going to use Processing's thread function and pass into the thread function the name of the function I want to execute as a separate thread so this code down here is going to execute however it's not gonna stop here it's going to keep going processing is gonna keep going or in the hallway talking very loudly or if you could hear them so you can see now I'm getting my data but this animation is never stopping so this is a case uh you know again this is not what you'll be doing presumably you're going to have like kind of a massive amount of stuff you know you're making a request for some data source something that actually takes a small amount of time the reason why I said massive amount of stuff is I was kind of thinking of another example which I'm just gonna pull up really quickly it's inside of processing under threads and I'm gonna run this one you can see what happened so fast let's let me let me put it like a delay in here just sometimes so this is a scenario where I have this like loading bar going and then it's it's finished loading click the mouse to load again so this is also a nice use for a thread if you have something that's going to take a really long time at the beginning of your program and you don't want it to just be this blank screen while the user is waiting you could potentially have that go off in a separate thread and draw is continuing so it knows if it's not finished draw this loading bar if it is finished draw this other stuff and you can see here the what a nice sort of trick here and I'm gonna come back to here to explain this is if this is pedestal good if this is my load data function and if I have a global variable sorry maybe called finished which I must say is equal to false if this takes a long time to execute and at the very very end I say finished equals true then inside of draw I can be doing stuff draw looping while it's inside this code here and I could say is if you're not finished draw this loading bar and as soon as that gets to the end the thread will be done and it then draw can draw something else so this is also a common technique that you might take a look at so if you're looking for a kind of example that kind of brings all this together I might take a look at example 18.9 in the learning processing github set of examples there's this one thing that's very hard to do is find a data source that changes very often like the weather feeds you know the temperature is not changing on a like second to second basis but this is actually if you're just looking to practice this is a pretty good one it's time JSON test calm and this is a JSON feed that all it does is give you the actual current time you can see milliseconds since the epoch and you can see the actual here so this is a data feed that's changing very very very very rapidly and so this particular processing sketch is requesting the time every so often and one and and you can see that this request is being done in a separate thread so what you what you can kind of see here this is a little bit goofy but this little animation right above my head it's animating whenever it's waiting to load the time so this is also something you could think about if you have a program that's looking for a piece of data you might show an animation while like you know updating and then it's done and it has the new data it's kind of indicate to the user what's going on but you need to be drawing so that request has to be in a separate thread anyway there's so much more kind of scenarios and possibilities and different kind of configurations of how this might work actually one thing I just thought of that might be worth mentioning is what if you want to load an image and loading an image can take quite a bit of time it's a large file you might need a thread for that actually processing has a little known function that will take care of this for you you could use the thread function but one thing I just should mention is that you can also use this request image function so request image function will launch the loading of the image in a separate thread so if you have a very large image that allow processing to continue and what you can actually do is you know the image is ready as soon as the width is not zero so the width is zero it hasn't loaded yet if it's negative one it means actually it failed to load there was a problem otherwise draw the image so that's something you might take a look at it for something that you're doing so anyway thus ends this sort of section of videos on data threads being a last little piece there and what I might suggest is if you did something where you're where you've loaded data try putting that loading data into draw and see if you can make it happen in a different thread and that's it you know you need to find the button that I press to stop