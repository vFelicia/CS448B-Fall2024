hello welcome to another matter j/s physics engine tutorial video in this video I'm going to attempt to make something like this now you might be wondering oh look at that that's a matter J s page so one in rods in my previous videos is that matter dot yes on the website has a patient you can click on called demos where you can actually look at these different examples one by one and one of them is for creating these chains otherwise known as bodies connected by constraints and those constraints can be springy elastic constraints and so there's a lot of things you can build from this particular idea now another thing else to notice about this demo page which is great is that it actually has an interface for manipulating a lot of these particular variables so you know I've been kind of in the code just changing numbers and refreshing obviously building an interface to sort of tweak and test different values is much better and this is built in right from the demo page so what I'm going to do is essentially what I want to try to do is recreate exactly this a chain by connecting a bunch of these circular bodies by constraints and here's the thing so looking at the matter digest documentation and it actually has something called composites so composites are a composites module it says right here contains factory methods for creating composite bodies so this is what you can use actually I just want to have a change of things or won't have a stack of things and there's even a composite for a car which is really just like a couple shapes and some wheels maybe but here's the thing I'm going to do this video and make this tutorial without using the built in composites certainly is what I want is a chain using the built in composite chain like make this easier but I want to build this in a flexible way that I could kind of make anything you know I could make a chain and has branches coming out of it so I want to have total flexibility to see what happens if I individually create all the particles and constraints one by one and attach them in a completely customizable way maybe this is a bad idea but I'm going to give it a try ok so what do I need to do so the first thing just to sort of work that that so okay this is my program currently this is where I am all it does all it has is a single ground body the same Brown body that I've had in previous videos I also made a change from the previous videos where that circle object is now called particle but I haven't put any particles into the world I could however put one so I could say var P equals a new particle and I'm just going to make it at a 200 comma 100 with a radius of 10 and then I could just say in draw P oh well it's actually pushing particles into an array so what happen is not defined oh yeah but Noah why should I be using that array so let me say particles dot push P and then let me actually iterate over that array with mine on for each loop and just say particles index I show so let me just get one thing so there's my one particle now I want to add a second one what I want to do is I'm gonna make that p1 and I'm going to say p2 is 200 150 and I'm going to push both of those into the array so there's two of them now these have no relationship they bounce off of each other and move apart what I want to do is I want to use something in matter chance and this exact same idea so it's called a constraint I didn't spell that right constraint like train is in there I think some whatever height I can just constrain it's called that in matter dodging but if I were in box 2d this would be called a joint if I were in toxic lives it would be called a spring so there's a lot of other terms for the same thing it's an entity that connects two bodies now it does not have any geometry so the idea is if there are two particles I want to be able to connect them with this thing called a constraint but one thing to note about the constraint is it doesn't have geometry so something will fall through it so there are other scenarios where what you might want to make like a bridge and but it's sort of like a springy bridge where you could what you could do is make a bunch of rectangular bodies that abut each other and then you could actually put connected with constraints but leaves very little space between them um so that's another scenario I could do in a coda challenge or something but here I just want to be able to attach these two bodies now this is always much more complex than you think because there's a lot of things I need to set I need to say body which which your body so body a and body B but also I did say where is the constraint attached is it at its center or you know I could I might want to do something like this where I kind of connect them from the edges so in a matter digest I pretty sure has a way of doing this and I think it's called point a and point B so there's the bodies and then the point is not the location of the constraint but the offset of the constraint relative to maybe the central point of the body then I also need usually a property called leg length which is often the rest length so you think about a spring you know if you pull out a spring it starts to bond and I'll wear well but eventually it comes to a rest so what is it sort of resting point where there will be no force either contracting or expanding it so if using the rest length there's also what else would there be maybe there's a kind of like strength torque option like how is it very rigid is it like a rubber band that type of thing so all just to make this single thing that connects the two bodies I need to set a lot of parameters so let's go try to do that over here okay so what I want to do is now I want to try to make a constraint so let's go look constraint I have that page open matter that constraint module contains methods for creating and manipulating constraints grenades are used to specify a fixed distance between two bodies model all the sorts of stiffness Springs or elastic so I think that's why one matter constraint create so I'm going to say I'm going to just make a variable called option then I want to say matter dot strengths create now what I what I could do here is say I could add another alias just constraint equals matter dot constraints right I think that's what I want here and then now I can just say I'm sorry constraint create so var completion here var constraint equals I want so now I'm just going to that word constraint the more you look at it the more it looks like it's spelled wrong I think it's right I want to create a constraint and with options so create options so I could certainly put the object with all the parameters right in here but I just want to have a separate object where I keep track of them so what are the options see what properties see property section below for detailed information on what you can pass via the options object properties body a body B ID label these are probably things to keep try that don't need length so these are things that I need so let's look to body a I want to connect p1 that's the first one oh but it's not p1 right my particle is my own object particles the body is the thing that matter cares about so P one's body to body be p2 body and then I also have point a which is that offset which I'm just going to make how do I set the offset the offset is an object maybe with an x and a y so I'm going to just have that offset be an X and the y of 0 it probably does that by default so actually let's just not put it in there but if I wanted to offset it differently I think I would put this in as an option and then a length is probably good so let's do a length let's let's give that as like 50 pixels between them and then what was the last one stiffness one means the constraint is very stiff 0.2 means it acts like a soft spring so let's try that stiffness let's try like point three four so now i assuming what i then have to do is through world dot add world comma constraints so i've also got to tell the physics engine to put that constraint in the world so now I've created a constraint between those two bodies with a specific rest length and a stiffness I've created it and I put it in the world so now let's run it Brooks constraint oh because it is spelled wrong the more you look at it the more if you got to spell bronze because I saw her on country yeah that's why I spelled it up so let's see look at dad well so you can see that that constraint now let's let's let's offset it a little bit so we can maybe see more what's going on there we go so you can kind of get the feeling like secure constraint together now the thing is I can't see anything but I could draw a line between them so now in draw I could do something like line this is a terrible way to do it particles zero dot dot body dot position this is like the worst thing I could ever possibly do right draw a line between this first one x and y whoops and the second one's x and y and let's see what we get here now I've got a line so you can sort of see now it sort of feels more like it's working so this is the whole thing again I can't say this enough about physics engines there's the actual physics and then there's what you're drawing mostly you want those things to match but sometimes you maybe want to not reveal what's connecting what or maybe you want to draw that in a different way so there's a lot of possibilities how do you think about it so now here's the thing what I actually want to do is create a chain of these so there's a bunch of different ways we could think about approaching this but let's just build with what we have so first of all this idea of creating two separate particles and pushing them and then creating this constraint here I need a kind of loop to do this and again I could use the builtin natural gas composite but I'm going to I'm going to be stubborn here and do this in my own way so I'm gonna say far let's think of it as going let's actually have it go horizontally so let's start at an X at like 20 pixels let's have X go all the way to you know the width minus 20 which is like 380 and then I'm going to go I'm going to go every 20 pixels so every 20 pixels and I'm going to comment a lot of this stuff out I want to create a particle at X comma 100 so I want to put a whole row a row of particles across there we go now ignore the fact that that line is drawn there there's no I'm going to I'm going to where where is that line drawn let's take that out comment that out and that's a lot that's a lot of stuff let's let's let's move every 40 pixels okay great so we can see here there's a whole bunch of things now we're not really it's there's not a lot of interplay here because they're all perfectly falling so it's almost like there is a constraint but let's change this now so what do I want to do I want to also make a constraint and what I want is for I want to say var P and then I want to save our previous equals particles oh looks ok let's create let's create a variable before the loop called previous and it's going to be equal to no then after I create that particle and in theory creates a constraint I'm going to say previous is equal to P so what I want to do is I want to connect each particles with the previous one that's all I want to do so every time I go through this loop make a particle at it and connect it to the previous one however I don't want to do that for the first one right so I do want to say only do this if if previous exists so only make this constraint if previous exists so now if I were to do that we could see look at this it's kind of you can see well they're definitely connected there's a constraint and they're all like moving along that's what now so that's pretty good now here's the thing what if I were to allow what if I were to allow one of them to be static so I could say I could I could add an artless static the bat is a keyword in JavaScript so let me what's another word I can use for static fixed so I'm going to say is static fixed so I could pass in you know I could say here like if there is no previous make a let's see trying to think of like there's like I just want the first one in this kind of I'm doing this it's probably there's a nicer way to do this I'm sure but let's just say let's just say fixed equals false so I'm going to pass in there's none of them are fixed but if previous if not previous then fixed equals fixed equals true so I'm just going to make the first one there's no previous then I want it to be fixed so if I do this whoops I've got an error on particle judges line number five which is oh there needs to be a comma here because I add another property and there we go so you can see that first one is fixed so what I also want to do is now I'm just going to like kind of change where they are I'm going to start this one in I'm going to start it more in the center and maybe I'll add more of them but make them smaller and do something like this so you can see whoa and maybe that rest length should actually be something more like 20 and there we go so now you can see there's what I was kind of looking do I created this idea of a chain that are all connected and if I made it much longer like if I went all the way up to 600 to add even more right you're going to see it's going to kind of even it's going to collide with the ground and kind of stop there that's sort of weird oh you know what it went through the bottom because the bottom it's around the bottom because the bottom doesn't extend past the screen so anyway you this could be obviously fixed in a lot of ways but let's just leave it a bit so this is what I was attempting to do now here's the thing there's a lot of improvements that I could make for this potentially number one is you know I've kind of got a lot of code just in the weeds here in the main program so in the same way that I had this idea of encapsulating this idea of a matter KS particle a body into an object that keeps track of its own body and other things I could now make a chain object and it's chain is an object that keeps tracking an array of particles and those constraints also the way that I'm created these constraints I didn't you know I didn't the same way I wrapped the body into a particle I could wrap a constraint into a spring so I could write my own show function so I could draw lines between those things that might be a bit more interesting you know and so you know because maybe what I actually want to do is is render this in a different way so there's a lot of possible ways but this hopefully gives you the basic idea now the thing that I want to add in the next videos how can I actually click on this and drag it around so and and you know the other thing that you I might think about doing is what if I were to connect them from the left to the right and then make it a kind of bridge that things fall in kind of restaurant so that would be another thing to maybe try play with the spring value so many things you try here so hopefully this shows you how constraints work in matter chess to give you a basic idea of what you could do and in the next video I'm going to add a mouse constraint see you there you