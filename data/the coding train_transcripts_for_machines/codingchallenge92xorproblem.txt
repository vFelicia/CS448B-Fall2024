hello welcome to a coding challenge in this coding challenge I am going to it's gonna sound really weird solve X or with a neural network now why would anyone want to do this why would I want to do this well what this is actually this is a video in which I am going to test a neural network library I've been building in JavaScript and in fact if you want to follow along with that process of building it there is a giant playlist here starting with 10.1 introduction to neural networks and I start building that library actually around play the video around 10.4 so this video is a standalone video where I'm going to make use of that library in a coding challenge you don't have to have watched all those but if you want the background with a bit more to go deeper in how the internal mechanics of this neural network that I'm going to use works I would refer you to those videos now what is this crazy weird visualization going on over here so let's I'm going to come back to in a second but let's come over to the whiteboard so this is an example a very beginning basic rather trivial example of machine learning and what do I mean by that I mean I'm going to draw a circle here and I'm going to write ml short for machine learning you can think of this as a place where there exists some machine learning recipe some algorithm you might have heard of K nearest neighbor or neural network fillintheblank support vector machines so fill in the blank with your machine learning algorithm there with a machine learning algorithm something goes into it data how you collect your data how you're thoughtful about that what the data is how you call them quote normalize your data there's so many questions ethical questions scientific questions that go into this piece I am not covering that B's in this video but there needs to be some data something that I want to analyze or learn with that's the data portion then that data goes into the magical machine learning recipe and out comes some output now what that output could be it could be a piece of music that I've generated it could be a classification of an image it could be the price of a house that I'm trying to predict based on some data so there's so much possibility here and this output doesn't have to be a single thing but can be multiple things the input obviously the data can be multiple things this is the idea of machine learning now I spent all this time building what is mostly like a toy neural network library it's written JavaScript there's nothing about it that's optimized but just to kind of understand the pieces of how it works so what I want to do is have my recipe be in there be a neural network and I want to create some scenario where I have some training Dana so what I'm going to do this is going to be a demonstration also of the machine learning process called supervised learning supervised learning meaning I am the supervisor and I am going to teach this machine learning recipe to produce output that appropriate output for a given inputs now what well if I just know all the answers why would I even do this well likely there's a scenario machine learning is gonna be used with a scenario where I have a lot of labeled data I have a known data set that I can use to train this system so that if I give it some unknown data it will give me out cut to give me an output a relevant output the classic example of this of course is I have a whole bunch of images here's a bunch of cats here's a bunch of dogs now here's a new image which one is it and along with this process we will typically have training data this is labeled data for which we know the answer we will have testing data this is data that we know the labels for but we aren't using in the training set so that we can see is it working this does it actually give us good we're good outcomes with unknown data and then of course we have the actual unknown new data that we want to use okay so what's the scenario that I'm going to use the trivial realms rather ridiculous example that I'm going to use in this video is the X or a or stands for exclusive or it's a boolean operation that resolves to true only if so you can think of true and if true X or true is actually false I didn't finish my sentence it resolves to true only if one of the two boolean expressions value is true so false X or false also is false and if you go back to my video that's linked here about the perceptron the lib you'll see that this is this is a special problem because a single simple perceptron a single neuron machine learning system cannot solve this problem it is not linearly separable the solution space is not a space where you can just draw a line and see all the categories of one on one side and all the categories of the other on the other side so you can dive into that deeper but this is where a neural network that involves a hidden layer can be used as the machine learning recipe so what I mean by this is I need my training set my training set is going to be 0 0 0 1 1 0 1 1 I'll have 4 elements in my training set and each one of these is labeled this is labeled with a 0 this is labeled with a 1 this is labeled with a 1 and this is labeled with a 0 this is the known data right again this is a sort of trivial you know I could build you could build a circuit right imagine what it would take to build a circuit with two switches and the led only lights up if one switches on they're both on it doesn't light up if they're both off it doesn't light up think about how you might build that that's essentially going that that diagram of that circuit is essentially what we want the neural network to look like so the way that it's going to look and let me erase this here is we can see here in my labeled data set that there are two inputs and one output so the neural network structure has to have two inputs and one output I'm going to send in X 1 and X 2 these are true and true true and false false or true and somehow out of this I should get a y I should get a true or false so how you architect and structural a neural network system this is something that I've gone into much more depth in the other videos but the key to this problem is having what's known as a hidden layer so the inputs come in here I want to look at the output here but these neurons are going to exist in between so everything this is also it's known as a fully connected Network so as the inputs come here they both go into this hidden layer some math happens this is the math that I go over in a previous video it has to do with multiplying by weights these are all weighted connections then the then those go into this output layer and we get the answer and then there is a training process we say try it with this so what internally in the training process what it does is if I give it zero zero with a zero and it outputs a 1 it's like I tell it hey you got that wrong adjust all those weights to try to see if you could get it more correct so we're gonna do is over and over again to Train it to see if we can then later we don't have a separate training and testing set in this scenario we're just going to say I'm gonna train it and see if you can start producing the correct answers for all of these numbers okay that's the background for XOR now I'm actually going to go and write the code to do all of this it works ok so you might recall that I started the video I had this thing up here so this is actually an example that I made in the processing Java based programming environment I probably like almost eight years ago at this point so it's not using the same code base but it's actually solved the XOR problem and what's interesting about this and I'm gonna I'm gonna come back to the white board just for one more moment here we find some room here if I draw a plane and I consider this to be 0 0 and this to be 1 1 so this is 1 comma 0 and this is 0 comma 1 right notice that if I take this idea of exor and map it to here I've got false here false here true here and true here and by the way that what I read r1 there to here and true here this by the way is why it's not linearly separable you can't draw a line I can draw two lines like this or I can draw two lines like this and you're gonna see that result happen actually as I start to program this I hope if it works but what this this idea of a plane this is a plane that's describing the whole solution space for the problem and if you come back over here you'll see look at that those corners if I bring this over closer to me I can try to point to it these corners are the true corners anymore practice and these corners are the false corners and this plane is all the other solutions now this is a 3d rendering it soon some fancy stuff I'm gonna create a simpler version of this so let's just actually start doing that so what you're going to need first of all is if you're writing this code along with me you're going to need to have the toy neural network j/s library it has really just two files that you need it has neural network J s and n n dot J's and matrix such as you could ignore this this is for testing that's something I cover in some other videos that you could probably find and you'll see that in my index of HTML file I am referencing those two JavaScript files I've got like a weird path thing going on but when I published the code I'll publish that all as one one thing okay so now I need to go over to sketch KS let's do some stuff here let's write a setup function let's write a draw function let's say let I'm gonna have a neural network variable I'm going to say create canvas 400 400 let's draw a background of 0 and let's let's go to the browser and see there we go there it is step 1 now what I want to do is create a neural network and I've written out how I want to create it I want two inputs two hidden neurons and one output so the neural network library the toy library that I've built expects those as arguments to the constructor so I guess a neural network equals a new neural network with two inputs two hidden neurons and one output neuron now I should mention that modern socalled deep learning systems often have many many many hidden layers hundreds of hidden nodes big massive networks this is a very small simple one the library only supports networks with these two layers the input did well if you consider the input you could say three but really these were the layers the hidden in the output plus the inputs three things okay now what do I do I need my training data so I'm gonna say let training equal and I want to have it be in an array and each element of the array I want it to be an object and it's gonna have the inputs which would be like this and the outputs now even though I only have one output right one output outputs can be an array they're also referred to as a vector so a list of numbers but in this case 0 0 gives me just a single up or I'd have single outputs when I put the array the library expects an array so I have that inputs out 0 0 I have 0 1 and 0 0 gives me a 0 not a one I have 0 1 which gives me a 1 I have 1 0 which gives me a 1 and then I also have what's the last one 1 1 which should give me a 0 so this is my training data now ordinarily this data might be in a spreadsheet it might come from an API it might be in a JSON file but I'm just hard coding the training data directly into my program just to demonstrate the idea now what do I want to do well in the draw function what I want to do is and now if you're look at how machine learning algorithms work typically you'll see something called you'll have a batch training process where you give it a large batch of data and then you adjust then you adjust the weights and do the training and then another batch I'm gonna do everything just one at a time and the way I'm going to do that is with a function called train that's in the in the neural network library so if I say neural network trained this expects two arguments what it expects to say train the neural network with this input and this expected output and so the easy thing here that I could do is I could what it what it should look like is something like this train it with 0 0 and with 1 oh right so this is what I'm saying these inputs should produce this output train yourself on that but I have so I have that all stored in an array what I'm gonna do is I'm going to say data equals random training and what did I call that up here I called it training I just called the training let's call it training underscore data training underscore data so the random function in p5 will pull a random element from that array and it will put it here in data so then I could just say train it with these inputs and expect these outputs it's only one output but outputs so this is the process this is the training process of course all of the work to adjust the weights of the neural network it's in the library and you can go head stop saying this refer to those videos that go through that process ok we've got that now I am going to let's just run this and see if I get any errors ah syntax error sketch dodge ass line for oh I have semicolons here these should be commas my syntax is completely wrong if you're watching this you are probably screaming at me or saying very nicely and sweetly to the computer ok there we go now let's run again all right it's running its training so what I can do is right here in the console just to test it I can type and and dot and there's a function called predict and what predict expects in the neural network library is the input data with no output because it's not labeled training data it's just input data so let's see if we can get results that makes sense and hasn't trained for very long and I don't know but let's see let's just write predict 00 0.45 that's not right so I should be seeing 0.1 right it's changing 0.43 so my guess here is that we really needed to just train a lot more what I'm going to do is just for right now is I'm gonna say I in the draw loop itself I'm gonna say I equals 0 I is less than a thousand I'm gonna have it do every time through draw a thousand a thousand of these training points so this will hopefully get us there a little faster and I can look at this now we can see aah whoo now that's wrong right oh no that's correct oh no I should be getting I should be getting false yeah so that's right I'd it got it backwards for a second it shouldn't be getting true I should be getting a false zero zero so let's try one zero and I've got something that's close to one so you can see that this work okay so the library is working but let's say I want to visualize it okay I want to visualize it I want to see it working I want to see it animating as it works so one way I could do that is I could basically let's create some variables like resolution I'm gonna make a grid of 10 by 10 pixels so the columns is the width of the canvas divided by the resolution and the rows is the the height of the canvas divided by the resolution then I am going to say x equals 0 X or unnies I I equals 0 I is less than the number of columns I plus plus and I'm gonna say J equals 0 it's less than the number of rows I'm gonna do a nice little nested loop here just to now I'm gonna say fill random 255 and I'm gonna say rectangle I times resolution J times resolution resolution I shoulda picked a less long variable name resolution so with this should do is this is a nice little nested loop to just draw a grid of rectangles ten by ten and a little warning this will be kind of flashy so you can see all these all of these elements are flashing out with a random color but I don't want a random color what I want to do is I want to create some inputs so I'm going to say let x1 equal I divided by columns right from 0 to 1 let x2 equals J divided by rose and the inputs then is an array x1 x2 so what I want to do is I want to create a scenario let me just say no loop here so this stops I want to create a scenario where I am inputting in 0 0 here and at this corner 1 0 and 1 1 and 0 1 down here and all the numbers in between right so now and then I what I can do is I can say let y equal neural network predict and this should be an equals here it's this particular predict those inputs and then fill Y times 255 so I should get a brightness value out that's between I should get a Y value that's between 0 and 1 and I should get that a brightness value I can broke my I'm at 255 to get a brightness value okay let's run this boom so we can see now and let's let's let's be a little more thoughtful about this and say no stroke then I'm gonna refresh it and very quickly now ah so this I'm so glad this happened so here's a thing it works for me a bunch of times but actually here you can see it's totally getting stuck let's refresh it again and I got stuck in a slightly different way I hit refresh again whoa it's just like going around the Horde and getting stuck in every possible way now how it worked so here's the thing remember how I said a neural network is an interconnected set of nodes which each connection being a weight so there's a couple important factors here what is those weights are initialized randomly and it there are thoughtful ways that you could initialize those weights but I kind of like initialize them in a certain way the problem is there's multiple solutions here so there's one solution here where there's white all the way along this way and if i refresh bunch of times you'll see there's another solution where there's black all the way down through the middle because honestly the only thing that's correct is the core is what's in the corners so I've run this a bunch of times isn't this the opposite of what we got before I can't remember so there's a bunch of different solutions here and it sometimes can get stuck in that middle so I might one thing I might be able to do is play with something called the learning rate so there is a variable in the the library called learning rate and I could say neural network learning rate equals so I forgot the library actually has a function called set learning rate and so what I can do is I can set this to some value now what should that learning rate be the learning rate is like how big are these steps how big are these adjustments and so maybe what I'll do here is I will create a LR slider for learning rate slider and I'm going to say LR slider equals create slider and so I'm gonna have learning rates that go between 0 and 0.5 that's probably a ridiculous range with an incremental step of oh it will start at 0.1 and an incremental step of 0.01 so this is a p5 Dom function create slider that creates an html5 slider puts it on the page and so now I could just say LR LR underscore slider dot value so this should if I'm right always set the learning rate according to this so let's see if I put it up here and I say neural network learning rate it's 0.5 and if I go down to here it is zero now I shouldn't let it be 0 right so the lowest the learning rate should be is probably 0.01 so let's see if we can get it stuck now of course it well I'm gonna hit refresh a bunch ok it's stuck let's see if just like allowing you to take bigger steps one way or the other will sort of fix the problem that didn't really seem to fix it's really stuck here so one thing I could do is I could just like start it over like new neural network 2 to 1 and now I've just started it over and it's still stuck let's try it again let's leave it at like point one so I could write this as an in a function to like if to like restart it a bunch of times and just get lucky with the first weights another thing I could try though just to see if this really helps the thing is I point I probably need to do is be more thoughtful about how the weights are initialized which is something I would need to probably want to build into the neural network library but just out of curiosity let's add four hidden nodes so do we make the network smarter by giving it more things to learn about right so I'm adding in all of these whoops this goes to here right there are more connections more connections more possible things for it to learn about let's see what happens ooh look at this look at that it's nice and curvy it's sort of like learned it and slightly every way and I suspect that I'm gonna have a lot harder time having it get stuck now you can see that there's multiple quote unquote correct solutions to how the space looks but it's really able to figure it out now that's really the end of this video the point of this mostly was just to test the neural network library so it works I can use it I can give it data to learn I can try it with other day and I can visualize its result now so here's the thing you're watching this video what should you do next well first of all I'm gonna new another challenge which is the kind of classic hello world neural network machine learning example which is to recognize handwritten digits and they're so well known test set called M nest that I will use okay kind of don't want to but I think it's worth me just doing that just to do it but and that will be a think more interesting problem and then we can even make it so that if I draw a digit can the neural network detect what digit it is so anyway so that's coming but could you on one come up with your own data set trying to train the neural network with your own data set and then how does it perform you also might think about visualizing this output using color in some way you know you could use 3d as I showed you with this process example which is no longer open so you could try a variety of different ways of visualizing this and maybe or animating it or changing the way you would build an interface to it there's so many possibilities so I encourage you to explore it I encourage you to dig in also to the neural network library code if you want to see how that works and check out those other videos as well so thanks for watching this coding challenge I think that's it that's it that's it I'm done