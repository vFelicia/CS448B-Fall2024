welcome to a coding challenge now you must go to challenge some indeterminate amount of time I'm going to attempt to build a simple cloth simulation I'm going to use a variety of tools for this I'm going to use something called processing and I have a little bit of code that I'm actually starting with that I will talk to you about it rarely has anything in it I'm also going to use a library called toxic lives so look in the description of this video find the link to this page download toxic libs complete zero zero two zero and you'll have the same exact version of library that I'm using now this library cannot be installed currently through the processing contributions manager so you've got to go to your finder you've got to go to your processing sketchbook and go into your libraries folder and take that thing that you downloaded and put it in there so I already have manually install that if you have trouble asking the comments maybe I'll make a side video that just shows you how to install toxic lives but once you have toxic libs installed you can go up into processing under sketch and you can go to import library and you can go to now scroll down here toxic libs complete and I what I want is verlet physics I'm going to use the verlet physics library now what is verlan physics why am I using the toxic libs library well I might refer you to my nature of code playlist that has a whole set of videos that covers the basics of what is verlan physics and the basics of how toxic goods works but the short one sentence summary here is Berlocq physics is going to give me a physics engine that has particles and Springs and i'm going to make my cloth essentially as a grid of particles now this is a terrible grid but you can see it that's a weird spiral and then have all of these connected with Springs so these particles all connected with Springs gravity goes into the world and suddenly everything's hanging down cloth like so let's see if we can make that happen so now I have started this up already just with two ArrayList I have a ray list of particle object and an ArrayList of spring objects now you might be asking yourself huh toxic lips has Berlet particle objects in it and toxic lips has Berlitz spring objects in it so why do you have your own particle in your spring objects well the way that I'm going to do this which is just a particular style is that what I'm going to do in my particle class is I'm going to say extends ver lit particle to D so I'm going to take a much do this in two dimensions first so I'm going to take the twodimensional verlet particle and extend it and then I'm going to say super X Y so I'm using objectoriented programming inheritance I refer you to my video on inheritance of you aren't familiar with this particular concept and I probably have called this wrong but I'll let me look in here I'm going to all go to the Java Docs here and look for berlet particle 2d did I so what's wrong here in my errors the hierarchy of type particle is inconsistent oh I'm missing I'm sorry I'm missing so little did I know that I am also missing some classes I need from toxic libs core so I need to also import toxic libs core 2 actually don't need all of this stuff so I could probably get rid of most of it but I'm just going to leave it all in there there's a lot of extra import statements and that should fix that error yes because Berlet particle actually extends something called BEC to D which is a vector which I would refer you to my tutorial series on vectors but I got to get moving with this coding challenge so I've got now a particle and the reason I want to do this is because I want to write a function that is capable of just displaying an ellipse wherever this particle is so I'm going to say fill 255 just going to have a white white ellipse wherever that particle is and what I'm going to do is I'm going to write on let's have let's think about our meshes the particles being like 10 pixels apart so I'm going to create a variable called W for each particle being 10 pixels apart and I'm going to say something like for int I equals 0 I let me just start them and just pick I could to be thoughtful about the math here but I'm just going to say let me have 40 particles and I'm going to say a particle P is a new particle and I need an X and a y so I'm going to start X at like pixel 100 and I'm going to start Y maybe at like pixel 10 I'm going to make those new particles and then what do I want to do I want to add those particles to my ArrayList and now I want to say for every particle in my ArrayList I want to display those particles so let's run this and you can see ah whoops knock over a light you can see I forgot to move them around so I want each particle to move over by 10 pixels and you can see there we go these are all my particles so my particles right now thou however are not experiencing any physics I want them to experience physics so in order for them to experience physics I need to create a physics object I'm looking over here I need to create a verlet physics object I'm going to make a 2d one I'm going to say Berlet physics 2d physics and then in setup I'm going to create that physics world is a new verle it and I'll extend this into 3d later I'm going to make a new physics world and then what am I going to do I need to say physics dot add particle P so what I've got here is I want all the particles to also experience physics but they don't seem to be doing anything yet okay well let's put in some gravity so one of the things that's also available in the toxic clubs library is a gravity behavior and a gravity behavior is just like a vector and I can now I can say let me add a gravity let me create a vector called gravity whee is a new vector that points where down so zero comma 10 it's going to point down and I'm going to say gravity behavior GB is a new gravity behavior with what that gravity vector and then I'm going to say physics and I guess that is a what did I spell wrong gravity behavior do I spell that correctly oh yes yeah why is it not know what it is it's ambiguous because there are more than one there's toxic physics behaviors and there's toxics physics 2d behaviors so I'm going to go here and right now we're going to live in 2d so I'm just going to do everything in 2d so that fixed that and now I'm gonna say physics dot add behavior GB ok how we doing here now we have gravity let's run this still nothing why well I think I probably forgot a really crucial step I made particles I added them to the physics I made gravity I added to the physics but I forgot to say physics move forward with time so I need to say I think in draw physics dot step I'm guessing it's physics dot step and let me run this whoops I'm in the wrong place ok so that does not exist so let's go to in my documentation here vertol it known overlayed physics 2d let's look at the functions get get time step setting on a set time step update ok so I need to update not step update and should hopefully have some default time step yeah there we go did you see how those particles fall super fast well may I can make the gravity a little less strong and you can see they're all falling now they all just fell because there's nothing holding them anywhere so what I want to now do is put springs between them so what I need to do I made 40 particles and what I want to do now is go through and say I'm going to go through that array and what I'm going to do is and I'm going to not go all the way to the end of it what I want to do is I need to create okay so I need particle a is element I so I want to get the first thing from the array which is I and it's with an ArrayList it's dot size so I want to get particle I and then I also want to get particle B to be the next one I plus one and what do I want to create I want to create a verlet spring 2d so a spring is a connection between those two particles is a new verlet spring between a and B and then I think the last argument are there's two arguments maybe there's like the strength or a minimum distance I don't really remember let's go look here I'm going to click on Berlet spring 2d and look at the constructor and it says a B length and strength ah so a default length what's the resting length of a spring right if you pull a spring and it kind of bounces back where does it rest and then the strength like how long how strong is it so so I don't see really a particular variable range for strength so we're going to have to guess so I'm going to say the default length is W and the default let me just add a strength of 0.5 okay and then what I need to do is add that spring to the springs ArrayList and then say physics add spring s oh and I actually want this to be a spring so I actually forgot that I have my own spring object my own spring object just connects to Springs and in there this should extend Berlet spring to D and then what I want to do is call super a B and then W 0.5 so I want to make it a spring but these two particles with a distance of resting length of W and a strength of 0.5 and then I also want to write my display function and my display function is stroke 255 line between a and B so what have I done I now made my own spring which extends the Toxic lips Berlet springs it's a spring that connects two particles and a display it is just a line so now we should be able to go back here and I should be able to say let's also display all of the springs okay so you see that's falling down now here's the thing what's exciting about this now that they're connected with Springs is if one is not moving the others should kind of stay connected to it somehow so one thing that I can do is I can lock particles so I'm going to say just a random particle it's not a random one it's the first one I'm going to say P lock I think this will take this particle and lock it in place meaning it never moves even if the physics moves there you go so you can see I have this nice springy string right now so just from locking that first particle let's lock also let's lock another one whoops p1 this should be p1 this should be p2 I'm going to lock both of these particles here we go we have this nice little springy thing now I actually don't really want to display the particles I really just want to see the springs because that's what I have right now and I could maybe just so you could see it a little bit better I could make strokeweight we can look and we see we have this nice bungee cord like thing bounces and rests now here's the thing this is just a string and I want to program a cloth and I want that cloth to be in 3d so we've kind of cut I've kind of done the core mechanic here in a way I'm done but what I need to figure out now is okay what I did was I said particle particle particle particle particle particle particle particle connect with the spring connected the spring connect with a spring connect with the spring connect with the spring connect connect with a spring what I need to do now is say particle particle vertical vertical vertical particle and then have another one another row of particles and all these are connected and all these are connected and then this is they're also connected to the particle above it so this is going to be a little bit trickier but I think totally doable let's see if we can work this out in our head and by our head I keep by head right now so one thing that I might like to do is okay so here's where I'm creating the particles so you know one possibility would be I think an easy way to do this would actually be to use a 2d array so this was now this would now be particles that are 40 by 40 and I always want them to start with X at 100 and why it's sorry X so only think about this so for the very first particle we want them to start at x and y equals 100 V for the outer loop I will have B the columns I guess so first the inner loop we go down so we always start with Y is 10 here and then Y gets set back to 0 so Y gets it back to a Y goes up sorry Y goes up y equals y i plus w so for every i so this is what are we doing here why we started x as 100 y equals 10 and then we go down all the Y's then we increase over by X and reset Y so I'm doing this as columns first I could room I could put J on the outside but this should give me a particle now and I'm going to get rid of the springs we should at least and I'm going to get rid of the gravity we should at least see a grid of particles now okay I don't see any particles because I turned off particles not display why did I delete that I should just commented it out okay that's perfect I see my grid of particles and maybe 40 by 40 somehow I magically like centered it with math I don't know by accident 600 by 600 yeah you can see okay so that you see there you see that's my grid of particles so now I need to figure out how to connect all of the Springs properly so I think for me right now there's a lot of different ways I could do this but I'm actually just going to change this to a twodimensional particle array which is 40 by 40 and honestly I should 100% be using variables for those numbers but just for simplicity right now 40 by 40 and what I'm going to do here is not I just need to say now particles I index J equals P and I can simplify this I don't need two lines of code here actually no I do because I want to also add it to the physics so I just changed to a 2d array and then in this no longer works because I now need to and let me make these variables I'm going to make in columns equals 40 in rows equals 40 so I'm going to use those and columns because these are going to appear in a lot of places columns rows and because what I want now is to just to check to make sure it's working I need this I need this loop again in a lot of places to display all them I want to have this loop and draw to loop through the twodimensional array and this should be a dot obviously so I still should have oh oh so this is not going to work anymore the locking I'll fix that it's going to make things easier so now okay now I have my two dimensional array of particles brilliant okay so what do I do now now what I need to do is take this loop and connect everything whoops so what I'm going to do is similar to what I did down here for every single particle I need to connect to the right and down so what I can do is actually I only want to go from zero to columns minus 1 and then rows I want to skip every row right because if I'm over here and I connect this particle to this one oh no no I don't want to skip any row I just don't need to connect back up so as I connect each particle to the right and the below everything will be connected yeah yeah this is going to work and then we stopped at rows minus one so this is actually not so bad so I first need a particle a one is particles I J and particle a two is particles I plus 1 J now be B 1 a 1 and B 1 and then I want a 2 and B 2 so that's connecting to the right and then connecting down is J plus 1 so these are particles a and B connect to the right a 1 and B 1 a 1 and B and and actually don't need a 2 I just need a and B 1 and B 2 so that one particle gets connected to the right and below so how did I make a spring this is how I made a spring so I'm going to say spring s1 spring Springs add add to the ArrayList and add to the physics and then this should all comment out it goes from A to B 1 a 2b this is spring there's probably some like slightly more efficient thing I can do here but this is now be going through every particle and connecting to the right and connecting it down so and I can delete what I had here and eventually I'm going to want to lock particles again but let's let's run this one more time so we can see okay all the particles there they're all connected let me not display the particles anymore so you can see there's the grid there's the grid of everything being connected with Springs so what if I add gravity back in everything falls but now what if I lock and what I want to lock is what I want to lock particles zero zero lock and then I also want to lock another particle on the top which is zero which is the end which is columns 1 index 0 so this there we go oh look at that look at my crazy swinging hanging cloth there we go you know I could lock one in the middle too if I wanted so this is now interesting where we could start to play with this value like the strength of the springs you can see whoa the string is like soot the spring excuse me are really strong probably way too strong maybe the max is supposed to be one you can see here you know very different if I make this 0.01 like whoa look how could you saying that is it ever going to bounce back up it's so weak look at the craziness that it's doing but now we do we least and let me let me make this like I'm going to make this like point eight I think it's a kind of reasonable number so you can see there's my cloth hanging and it looks very threedimensional but everything that I've done here is twodimensional so let's just see briefly if we can make this threedimensional okay let's see if we can make this threedimensional push forward in this particular coding challenge I have no idea how long I've been doing this for but you will know this by how long the video is eventually when it's published so I'm going to save this I'm going to say this that was actually the 2d one so I'm going to just say this is three cloth underscore so I'm saving both of those I also want to I want to kind of clean up now I'll clean this up later so I'm going to clean up the imports and all of that later and what I'm going to do is sketch when I publish the code on github I'll clean up all the imports that are unnecessary I'm going to go back to Verla physics and great and I don't want the 2d physics anymore so let's see now if we could convert this to 3d so this should now be just a Verla particle and I should now say X Y Z let's not worry about the display for a second and the spring should just be a ver lit spring this should not change at all it's just not a 3d spring anymore and here I should say verlet physics to have 3d physics gravity behavior and now this needs to be a 3d vector for 3d and I'm still going to point along the y axis for now and everything else should just be the same especially if I make that zero and I'm going to say P 3d and I'm going to run this so this should be identical so this is now running in P 3d and it's actually technically happening the math is happening in 3d but I'm just seeing the same exact 2d visualization I will make it more 3d in a second so what I want to do here is first in spring I want to add this and you know technically I should fix this like I should have this draw in 3d somehow and I should say translate XYZ but to be honest with you I'm not going to display the particles so I can ignore that so I'm going to run this and make sure this is still working there we go now let's think about this what I want now is to maybe pin the cloth on four corners on the top and see it fall down from the from the middle so there's a couple ways I could do this number one is let's think about our view here we've created all of these I think what I want to do is at the beginning of draw I want to translate to the center so I want 0 0 to be the center of my window right now and what I actually want to do it's let's not use x and y anymore I want to start let's use X which is horizontal and Z which is forward so I want to turn Y into Z so X should actually start at negative 50 and this should now become Z and I'm going to have Z start like kind of far away from us I'll start it at negative 100 and then I want to create these particles at X and I'm going to have Y just be 0 so I'm going to create the particle at X 0 Z now let's see what happens ooh ok well first of all I want to let's take out the gravity behavior and just see if things look right so it looks kind of reasonable but it's sort of hard to say let's start Z at negative 50 and let me add some rotation here and draw so let me rotate along let me spin around the xaxis by some angle and I could add PZ cam just to like spin around things that might actually even be better oh so it looks like all the particles are in a line so what did I mess up here oh this is this is look at this this is needs to be X change both of those things to Z somebody already mentioned that in the chat ok good so now we can see my mesh I don't have it in exactly centered in the right place I'm going to just speculate i40 particles separated by 10 right do I have 40 particles and they're separated by 10 I should go back I was going to say negative 200 yeah so I think negative 200 and let's just start it much further away there we go so you can see there is my mesh now it's spinning around and let me take out this rotation and actually let me wear let me let me take out this rotation and let me actually move Y up so where I just want to move Y up by like negative 100 so now there it is there's my mesh sitting there that's my cloth it's now in 3d Springs are all attached I should be able to put gravity back in I forgot what parts of it I pinned so we'll find out and you can see oh there it is in 3d it's kind of like a flag waving thing now I was going to pin all the corners so let's pin one more corner just for fun so I'm going to pin a columns minus 1 rows minus 1 think that'll Det now I'm going to pin 3 corners ooh what did I that didn't work uh isn't that another corner let's try whoops I don't know why that didn't work there we go now I pinned so let's think about this oh now that should still work that last corner columns minus 1 am i off by one somehow because of the way I did there we go so I don't know why did so you can see there's my cloth now it's like a hammock this is a this is a coding challenge hammock generator but you get the idea now I'm not I haven't done anything with drawing here I could really turn this in to a mesh with begin shape and shape and triangle mesh I could put lighting in it toxic libs actually has these constraints so I could put like a sphere constraint have the cloth just fall on it and fold over the sphere and fall on to a ground toxic lips has a lot of features also for turning these into graphics meshes and texturing them but you get the right eye people in the chatter telling me oh it has no Springs I don't know oh it has no springs so I lock that so that's what the issue is that bottom right hand particle I don't actually attach it with any Springs because I'm not doing diagonal Springs the kind of doing this for a half an hour now that these cameras go across so that's the reason why that bottom one isn't working just to come back over here for a second right let's say this is the bottom particle these particles are connected and these particles are connected but this is not connected to anything now if I were connecting them also to the right which would be interesting let's add let's do that I know this video was over but if you're already watching this for a half an hour you will watch it a few more minutes but let's go and add a particle B 3 which would be I plus 1 J plus 1 and then spring s3 so now I'm adding a third spring and then I can go ahead and now first let me and lock that last particle but let's let's take these out and run this and just see how it pays so that's kind of interesting oh it has this like it's sort of like off to the side because like the last particles aren't connected down I should really do I really need to do the last row so there's lots of little flaws here that's sort of interesting to see how how much that changes it so I need to take that last row and connect down but not to the right you can see look what I've done now connecting them I've just like mutant hammock but you get the idea I'll clean up this and make it sort of nicer and have all the springs connected properly before I post it but you get the idea I hope you've learned something from watching this video I skipped over a ton of things that are part of toxic libs and Berlin physics but you know I'll try to link back to my other videos that cover vectors and toxic libs but hopefully you'll be able to do something with this and create some sort of interesting simulation or plot project and share it with me thanks for watching this coding challenge