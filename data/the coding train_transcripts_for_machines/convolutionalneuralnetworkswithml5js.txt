good morning and welcome to the coding train with me your host coding train person I do have a name it's Dan and we begin as we always begin with the ceremonial reading of today's random numbers coding training today is brought to you by the random numbers fifty nine thousand one hundred ninety four nine thousand and twenty seven ninety five thousand nine hundred twenty two fifty five thousand four hundred and sixteen twenty four thousand two hundred and fortyone maybe thousand this is what I look at the chat oh wait I'm in the wrong chat channel to see if like there's anything terribly wrong going on let me switch there we go brand el Mac says hello everyone by the way I'm looking at the discord chat which is for disc members of the coding train but I also seen the YouTube chat where I see ninety four thousand nine hundred thirty from our naav are now sends another random number seventy thousand nine hundred forty eight I wonder if we had you know a random number for every person if every person watching thought of a random number between 0 and 90 9999 inclusive of that what the distribution would be and whether we would have a a good random number pseudorandom number generator a random number generator or not interesting question interesting theory I could loot my outoffocus I thought I was on focus everything is definitely on fire the roof the roof it's up there bunch of floors up I guess if the roof is only technically the top of the building I mean there's a ceiling that's not really a roof no says Oliver once again I will remind everybody watching that when you say yes or no is if you were replying to me I have no idea what you're talking about because it happens about 30 seconds later and my memory apparently my shortterm memory is not nearly that long I forgot to wash my glasses it's very important that I wash my glasses before I livestream these very bright lights which reflect in them which is a problem I need to get some anti reflective lenses but also as soon as those lights come on if there's like a little bit of dirt it's much better refocus yeah why is that alright so let's try using the random digits book I thought I focused and this book possibly prop itself up oh by the way this is a YouTube show livestream thingamabob where I code stuff and talk about things and I'm still on a little machine learning kick so that's what's happening today let me see if I can fix this focus because I cannot be in two places at once one of these days maybe I'll get a like a robot assistant to be in here and to focus the camera for me so weird I think this random number book is not very good for helping me focus in more ways than one better I can't tell let's go with mine oh wait wait wait let's try my other special focus device oh good it's transit all right I'm just gonna have to go with my usual Elgato streamed box not a sponsor today's sponsor by the way is audible if you go to audible.com slash coding trade or text coding drain 500 500 you can get a free audio book you can listen to a free audiobook and I listening to one right now which is called your a thing I love you bye Jenelle Shane I'm gonna talk about that book it's a amazing AI book or you can also text coding train 500 500 I love audible it's so wonderful to listen to books when I'm on the subway and jogging and all that stuff so I will come back and talk about that I do also love stream deck although they are not a sponsor so I don't have a link for you but I do have a link for you audible.com slash Kodi drain all right let me see if I could focus the camera now on this you would think I did this I do I have my list of things to do before I start focusing the camera is one of them it looks good I also want to take a if I think this is better now I feel like I look out of focus tell me if I'm okay I mean I'm not okay this is clear I've got lots of issues many many many many issues okay don't worry about me I'm fine I'm okay my life is fine but I am very much out of focus in so many ways literally and figuratively but hopefully I've literally in focus right now if somebody in the member channel under live chat in the discord could let me know that would be super helpful if I'm not I will fix it I might like want to take just a short break to go clean my glasses all right I think we have a new member who just joined Scott Bauer related baby Jack Bauer no that's like a label you probably an unmet you should definitely just like cancel your membership that I made some sort of like lame ridiculous joke I'm going to talk about what I'm gonna do today which is examine something called convolutional neural networks david says I'm good that reminds me I'm gonna show a community contribution from David which should be a fun little experiment it's okay but not perfect let me mention the discord just because I'm gonna take like a second here so this is the new coding train discord this is the all aboard channel so if you join the coding train discord you are required to read this will be welcome map message and the code of conduct which is here I'll also note like I get a ton of questions on the videos which I appreciate the comments and I do scan through all them and I try to reply here and there when I can but if you're looking for coding help to places for you one is the that I'll mention first is the processing discourse so if you go to the processing foundation forum which is a discourse dot processing org if you have a processing or p5 specific question a search this forum it's probably been asked and answered but you can also ask it here this is a great place but if you're something if you want to if you're interested in discord or something more coding trained specific this is a great place to get help and you can see the different channels here we have um HTML CSS p5 processing Oh if these you bike okay node for a serverside stuff of machine learning Python which is not my area of expertise get not not that any of this is really my area of expertise maybe processing I had one area of expertise that I might actually claim it would be processing so if someone could post is anybody a moderator currently in the chat who can post the discord link if not oh wait I can I can I'm gonna do that right now I should get up I have a button actually right here which whenever I press it it posts you to the chat I should have that post like the discord lake or I could make another but let's see if I can get that to work so I am going to go over here to useful links so this is where I'm I'm gonna I'm actually gonna show you where I'm going but I'm doing it on a different computer useful links here which these are all the various coding train links that you might be interested in I'm gonna grab this discord link I'm gonna hit copy and paste it into the chat just so it's there then I am going to go to my where am I going to my stream deck and I'm going to go down to YouTube YouTube but YouTube and put in chat message just call it discord I have so many keyboards and buttons then I'm going to paste the link here to the discord and I think now if I just hit save anytime I want I am I don't know I'm afraid to say this name cuz I feel like there might be something hidden in there that I'm not aware of cuz I'm not really thinking he is going to code in the next few minutes and you would be right you are the winner of a trip for two on the cutting train choochoo and you'll also get with your trip for two on the Kotick train random numbers and what was I doing Oh welcome Japs thanks Jeff for joining the coding train on the cookie speaking did you take like an improv class or something cuz I'm absolutely terrible at this with your coding trade membership you will receive in the mail stickers much love from Tanzania Africa thanks Scott welcome aboard to the kodi train with your super chat message you'll now receive a reading from the kodi train okay I was doing something I'm testing this button did it work I pressed the button I to post a link to this chord so let me just quickly mention a couple other things in here under store oh no wrong wrong link wrong link discord you failed me I guess I should edit that this is the new so that's the old store I mean actually still exist I might take it down I don't know but this is the new store I just wanted to mention that there are coding train hoodies available I would really liked one of these so this is my pitch to you these are expensive to make I'm not using a print on demand service anymore standard TV helped me design and produce this merchandise which I'm told this high quality and so this they're gonna do actually a print run of these I don't know what the process is but so it's only taking three orders so if people don't order them they won't get made I've already ordered a whole bunch for myself maybe I've ordered enough that it'll get made but that's my pitch to you if you want me to see me wearing one of these but I would like to I'm wearing my ITP camp hoodie right now then other people need to order them and there's other stuff here if you're interested standard TV I don't a button to post on the chat okay so I am you know I'm sure I want to get started sooner than later or not I mean all of this is goofing off on some level but not waste not I want to get started with the content because a little bit behind all the things I want to do it next week is nature of Code times so I need to move on from some of the machine learning stuff although it will circle back to it because some of the stuff in nature of code towards the end uses AI but so I'm gonna do as much as I can today on some of the ml 5 stuff that I've been doing and see where I get thank you Oliver for posting the store link in the chat and that's that so if you will bear with me Oh watch my glasses it should just take a minute and I'm gonna put on intermission animation this is not actually the intermission though there will be an intermission about an hour to an hour and a half in is so loud all right I'm back sorry about that I just thinking I might be the first person in the history of universe in the universe to say watch watch watches their class yes I went down to the lake with my washing board all right so one more thing I wanted to attempt to do which is I always like to show community contributions I'm going to go to coding challenges gar IO a new one came in from David which is here so tictactoe with friends so I would like to return to doing more some more content and examples with WebSockets which is a way of having a way of having a continuous realtime network connection from the browser from JavaScript and I did a shared whiteboard and I look out of focus I'm gonna I'm gonna examine that again I did a shared whiteboard I did this sort of agario Agora IO and how to say it example and let's look at this and then I did tictactoe challenge I didn't do that let's take a look so my name is a coding train and then I don't know if this matters but I'm gonna just not show you the secret code I'm going to put in to join the game in case that makes it like sort of hackable in some way so now I put pacing in that code I'm hitting join game join game oh I don't see where oh there is no open game did I already join it hello Oh oh wait I'm in it I'm in it okay laptop come back alright I'm now in the game uhoh X's turn I'm oh uh oh it's gone again we found a bug I failed I failed he had the focus is up is it just like drifting the focus let's try it one more time where'd I put my focus device it's weird I could put it on to autofocus I thought that that's going to cause more problems than oh and I'm oh okay yes I'm so not yeah I can see that it's out of focus that's better all right I don't know I don't know I don't know all right sorry David I messed up in the discord thank you okay we'll try again later but you should make your commute let's see I don't think the to the latest video I released by the way is under the ml5 beginner's guide playlist and it should be down here ml5 pose regression I don't think there any oh there are oh you know it this is a mistake actually here's a bug bug report I'm not sure why this happened but this particular video ml5 pose regression and this pose classifier one oh no no no no oh no yes yes they're showing the same community contributions so there is a way for that that's supposed to happen and and actually so is this one maybe that's okay actually so maybe that's the point so maybe the all of the pose videos should have the same community contributions that's a nope now I don't know if that's a bug report that's an open question focus or not I have to resolve this you know where is the focus does this look more in focus am I getting more or less in focus as I come forward from like this is back middle forward middle back where is the focus the best worst or am I just like way all too much in my head and I'm fine oh it's really going well today I'm trying to give myself a reference point I was expecting some messages about the focus but I didn't get any that's loves like let me go through the whiteboard for a minute you got blurred I be not I saw like a math blank was typing and sarcasm as a service was typing but then no messages appeared I'm gonna give this one more shot this can I focus on have an idea have an idea we try the train whistle I really need to figure out tricks I need to figure out how to zoom the camera in used like I don't know what button will do that for me on this camera so I'm like looking really closely at the screen that's way out of focus I used to be able to zoom the camera way way way way way in and then on the confidence monitor I could really see it it's just better and that's out of focus I'm gonna get this I mean a soft focus might be good for me I think that's a little bit better can come over here no that's like totally blurry so weird what is going on I'm losing my mind this always happens to me it's weird with the camera today I think some settings changed on this camera I wonder if somebody people have been using this room and maybe settings got changed hold on let's see is it auto focusing oh it's on auto focus so the camera gotcha somebody changed to semi it's on auto focus I oh maybe I'm not oh I'm not scrolled all the way down on discord oh I'm not scrolled all the way down oh no wonder I'm nods good all right so I've determined the problem this this room has been used and the camera settings were changed ah right I'm not crazy it's on a foot is it Auto focusing on me yeah I know everybody's saying you want me coding but I I have a problem and I have to address it yeah it's autofocusing right so how do I change it back to manual I can't see the back of the camera I don't know what to do about this is alright I'm caution to the wind everybody a little I'm just gonna go I just got to go for it go behindthescenes action here so I can see the camera settings and also really test this autofocus theory oh yes yeah all right I'm gonna switch it to manual focus menu it says manual focus that was wrong about that oh this is autofocus this is what autofocus looks like maybe I should try it on auto focus it was not an autofocus I'm really interesting I think I need to go to the eye doctor that's the worst let's actually just try it on auto focus for a second not gonna tighten it in place this is this is now how to focus does it do a good job of finding me in autofocus so let's just pretend I'm coding for a little bit like I'm walking around and I'm tukya I'm talking about the coding I'm type type type in the coding type type type in the coding hey it's on autofocus is that actually like sort of staying in focus as I move around and talk talk talk about the code stuff I feel like actually the autofocus looks pretty sure auto focus or the wind I'm gonna wait for the so it's been brand Lmax Simon does not like the autofocus no it's blurry as hell so the autofocus was not good it seems to be good when I'm up here people I really do I really I realize everyone's having fun I really need help with this because I can't both stream and see and I haven't had this issue before and I can I have to change the settings on the camera I have to pull it all the way out from the wall which is not a great setup Oh brand Lmax saying it was good okay I mean the cameras in the wrong place so the moving is not in issues because the moving is it's because I didn't tighten it so that I'm not worried about it is a little bit and let me I need to get the level okay only if you're not in screen it jumps around so on autofocus right now which is what I think I'm gonna do I mean so let me just level the camera that's just not level right now which way is level that's level loosen it actually again so I can actually that's actually better for it to be pointed up because I can raise the desk thank you all for bearing with me I'm tightening it in place okay okay I think I have to get started I'm sorry everybody oh we were having fun till I ruined everything I saw an autofocus now I can't believe someone just joy interesting it does seem to asking me too well oh my god what just happened okay I have it locked what did it just do oh I'm so in focus right now I'm losing my mind I'm very very in focus and if I move over here I'm still in fact alright this is good I think if I'm still and which I am for most of the time it focuses better alright I have to give up on the focus and this is just gonna be good enough am I about the same size as I usually have just randomly changed a little it doesn't really matter because yeah I do see the laptop moving around I think though if I stay mostly I mean I do move around a lot but I don't move around a lot I don't know what just changed but it's like totally in focus now interestingly I do think that maybe some of the settings on the camera did change and I will investigate that at some point all right oh we mentioned I'm gonna get started I apologize to everyone it's ty can't believe this 1015 I do have two hours left so it should be time for me to do some stuff I do want to mention one thing which is that I did make another coating in the Cabana video about the hilbert curve so if you were waiting for that stay tuned I programmed this particular continuous spacefilling curve it makes a lovely example I also did something where I used Pross the alpha version of processing for there's a you're a little too high there's a purple line at the bottom okay yeah yeah thank you that's that's easy to fix position why's that Oh weird I'm less concerned with that stuff because Matthew when we edit we can fix that but I think I have now fixed it okay all right putting everything to side I am now going to talk about conflation of neural networks Oh my brain was sucked in the headspace for this and I've lost it a little bit okay looking here okay yeah these are the these are the links I'm interested in and these are slides and this is the example I made before and then I'm looking for us this particular post it's a really excellent one oh this was the diagram yeah yeah okay okay Wow focus is life's better than it's ever been I'm so focused I am focused on the task at hand I always get this thing where people say and an Ashwin just said it that I look like a character from the show called money heist which I've never watched maybe I need to watch that or maybe I just act like that character I don't know hello and welcome to hello welcome to another beginner's guide to machine learning with ml5 jazz video and in this video I am going to talk about something called a convolutional neural network what is a convolutional neural network what are the new operations in a convolutional neural network that are different from the kinds of neural networks we've looked at and I've talked about before and how can this particular example which I made in a previous video that just takes the pixels of an image feeds them into a plane neural network so to speak I'm not a convolutional neural network what would happen if I changed it to a convolutional neural network would it perform better what would what what what are the outcomes that's the point of this video that I'm making let me start by looking at let me start by diagramming the kinds of neural networks let me start by diagramming the neural networks that I've used before let me start by diagramming the neural networks that I've used in some of my let me start by diagramming what the neural networks looked like with ml5 neural network to date and all in the videos that I've made so there's been two layers a hidden layer and an output layer and then also there's some data coming into the neural network and in this case in the previous example it was an image which was flattened so I use the example of 10 by 10 pixels each with an R a G and a B so that made an array of of 300 inputs all these all these pixel values those are the inputs and those go into the hidden layer but just for the sake of argument let me simplify this diagram and I'm just going to consider an example with 4 inputs I'm going to consider that example as having 5 hidden nodes hidden units and then it's let's say it's a classification problem and there's three possible categories a vanilla no sorry us the ml 5 neural network by default creates so this has 4 inputs 3 outputs and 5 I don't know if I need that so when I call the function ml 5 neural network it creates this architecture behind the scenes and connects every single input to every hidden unit and every hidden unit to each output twit hi so this is what the neural network looks like each one of these connections has a weight associated with it each neuron receives the sum of all of the previous inputs to it in the previous sir each each unit receives the sum of all of the inputs times the weights passed through an activation function which then becomes the output which then all of those with those weights are summed into the next layer and so on and so forth so this is what I have worked with before the whiteboard camera is skewed no no it's fine it's fine it's fine I can't be bothered to like fix the cameras anymore let me use my level did you have a level here and let's just see it's pretty it's not so bad oh it is skewed I can I can I can turn it a tiny bit that's gonna make it a little bit better okay yeah that's better all right while in the previous example I was able to get this kind of architecture to work with image input and get results that that produced something if the output this can be improved upon and the reason why this can be approved upon is there is an aspect to this data that's coming in that that is lost there is there is there is information in this data that's coming in that is lost when it is flattened to just a single flat array and the information that's lost is the relative spatial orientation of the pixels it's meaningful that these colors are near other colors something in what we're seeing in the image has to do with the spatial arrangement of the pixels themselves in two dimensions at so there's um in order to address that we want to add into this architecture I really spent a lot of time drawing this diagram which I've now good at mostly a race which is also a hidden layer anything in between the inputs and outputs is a hidden layer but we want to add something called a convolutional layer so in this video I want to explain what are the elements there are units nodes neurons so to speak in a convolutional layer but what are they and one of the word that's typically used is actually called a filter which makes a lot of sense now convolutional neural networks can be applied to lots of scenarios besides images and there's a lot of research into different ways that they can be used effectively but I'm gonna stick with the context of working with images because the word filter really fits with that we're filtering an image how is this layer filtering an image there's another step here called Knoll implement I'll come back to it all right pretty sure that so much your factcheck for this for me but this is now the idea of a convolutional layer is not a new concept it dates back to the it predates this deep learning boom so to speak boom this other so the idea of a convolutional layer is not a new concept and it predates this era that we're in now a so called deep learning and in fact if you want to like go back and find the and if you want to go back and find the and if you want to go back and look at the origins of convolutional neural networks you can find them in this paper called gradient based learning applied to document recognition from 1998 section two convolutional neural networks for isolated character recognition convolutional networks and here we can see this diagram which is I'm attempting to kind of talk through and create my own version of over here on the whiteboard itself I think someone's at the door hi looking for something ah okay this is a recording studio that's actually live live broadcasting yeah no problem okay I probably should have muted my microphone before I answer the door this is also the original paper associated with the EM mist dataset a dataset of handwritten digits that's been choose umpteen amounts of times in research papers over the years related to machine learning this is another yeah okay so this is what I want to talk about next which I'm going to come back to okay okay let's go back let's I know I'm going back and forth a lot here but let's go back to thinking of the input as a twodimensional image itself so this twodimensional image and let's not say it's ten by ten let's use what the Emnes data set is which is a 28 by 28 pixel image and of course now much higher resolution images are used and this is what is coming in to the first convolutional layer this image is being sent to every single one of these filters the filter is a the filter is a matrix of numbers and it can be the matrix is the fill a filter is a matrix of numbers and let's just for example let's have a three by three matrix so each one of these filters represents each one of these filters represents nine numbers a matrix that's three by three you could have a five by five filter or and so on and so forth but is sort of standard size or a nice example size for us to start with is three by three each one of these filters is then applied to the image each one of these filters is then applied to the image through a convolutional process this by the way is not this by the way is not a concept exclusive to machine learning this idea of a convolutional filter to an image has been part of image processing in computer science and computer vision algorithms for a very long time to demonstrate this let me actually open up I can't believe I'm gonna do this but I'm gonna open up Photoshop sign in oh I have a creative cloud account hold on a second I didn't think I'd have to sign in to legit you're gonna watch apex legends videos now when I'm here talking about convolutional neural networks okay um Adobe oh no that's the wrong or oh I have to like login wait I wonder if I log in it's through my NYU account just give me a second here let me try to login I just want to show you this this is such a fail I do have an Adobe Creative Cloud account I very lucky to have that through New York University I logged it to by NYU account let's just do that figure out how to log in properly so what I want to do is let's get an image this is how I it's way too vain all right whatever let's let's get an image of a kitten and more settings where's that thing usage rights labeled for reuse with modification actually I should get the quickdraw I should maybe I should I thought let's use the kitten okay what you can't go wrong with a kitten didn't I just download this kitten let's do this doesn't hurt to have the highresolution one for Photoshop save image oh my god I never never been so difficult to open a kitten image I don't need to uh I mean I do need to learn Photoshop all right now in Photoshop you might notice there's a filter menu why because all of many now in Photoshop so here I have in Photoshop and I've opened this image of a kitten and there's a menu option called filter this word is not filter by accident it's not called filter by accident over here either there's a connection so all of these types of operations that you might do for example like blur an image these are filters convolutions applied to the image I'm gonna go down here under other and select custom all of a sudden you're going to see here I have this matrix of numbers this matrix of numbers in Photoshop is exactly the same thing as this matrix of numbers I'm drawing right here each one of these filters in the convolutional layer represents a matrix of numbers that will be applied to the image so let me actually just put some numbers in here I know how easy that is to see if I I mean this shouldn't if I do this does it actually make it yeah I'm looking at the chat this particular set of numbers happens to be a filter for finding edges in an image and you can think of it as these are all weights for a given pixel so for any given pixel I want to subtract colors that are to the left of it and emphasize colors that are at that pixel and above and below this draws out areas of the image where the neighboring pixels are very very different interestingly enough I could switch these to 0 and these to negative 5 can you see the difference let me do it top let me do actually I think would actually be better for me to show you like like do one above whoa yeah switching the convolution to have the negative numbers on the top sorry switching the filter to have the negative numbers on the top you can see now I'm still detecting edges but I'm detecting horizontal edges if you go back and look at the cat that I had previously versus this one you can see vertical edges versus horizontal edges so there are known filters which draw out certain features of an image and that's exactly what each one of these filters does if all of the nodes of a neural network can draw out and highlight different aspects of an image those can be weighted to indicate and classify the image in certain ways the big difference here the big difference between a convolutional layer in a neural network and what I'm doing here by hard coding into known filters is a neural network is going is that the neural network is not going to have filters hardcoded into them it's going to learn filters that do a good job of identifying features in an image so this relates to the idea of weights I think so if I if I go back to my previous diagram where every single input is connected to each hidden note where every single input is connected to each hidden neuron with a weight now the input image is connected to every single one of these filters and the weights are are the in a way there are now nine weights for every single one instead of learning goal weight it's going to learn a set of weights for an area of pixels to identify a feature in the image all of those all of these filters will start with random numbers all of these filters will start with random values and then the same gradient descent process the error back propagated through the network adjusting all the dials adjusting all the weights in these matrices and all of these filters works in exactly the same way exactly works in the same way so in the ml five series I haven't really gone through and looked at the gradient descent learning algorithm to adjust all the weights in detail I do have another set of videos that do that if you're interested but the same gradient descent algorithm that is applied to these weights is applied to all of the different values in each of one of these filters okay anybody watching this one add one a show Gaussian blur filter yeah me actually that's actually kind of a useful one to do I'm not going to show a Gaussian blur one one one one one one one one one oh it doesn't do I do this uh yeah okay this is like dividing by so how do i oh yeah oh yeah no I see it down there incidentally just to show a very common convolution album to album incidentally just to show a very common convolution operation to blur an image blurring an image is taking the average of a given pixel and all of its neighbors so here you can see if I give the same weight to a 5x5 matrix of pixels around a center pixel and then divide that scale is divided by 25 because there's 25 that's averaging all the colors if I click on preview blurred not blurred blurred not blur of course there are other more sophisticated convolutions like a Gaussian blur you can take a look at Gaussian blur and some ways to pronounce it you could take a look and research what that is but again I'm not going down the road to look at common image processing convolutions instead talking about that concept of a convolution as applied to an image in the process of a convolutional neural network middle one should be it doesn't need to be George it could be if I wanted it to have a higher weight but it doesn't mean there's no right or wrong answers to this as far as I'm concerned kittens and kittens are getting to get into Guinness alright so here's the thing I want to take a small digression here and program the convolution algorithm sort of outside of a neural network you can't tell the difference I can tell the difference there maybe maybe you need to like look at it at super high much higher resolution was that not an effective demonstration let me say this I wish it would like up it's always previewing it here zoom in on a little bit more yeah just to serve that zoomed in a little more I mean Matt sure can do his own zooming when we edit it but if this is helpful to record this okay if you're watching it on your phone I can't help you yeah okay it is a subtle blur all right let me go out of here and let me get let me get something here where's this example okay so like how these are through the second one save in the save cat oh no stop stop I put it in draw sorry about that just want one cat image this one so let me go back to here duplicate this convolution I don't know why I started with this example but oh it's no P image you I actually don't need the ml5 library for this I'm like a little bit a little bit silly would I why do plants let's do with this okay I'm going I'm just setting up the base coat I'm going to start with cat equals load image cat dot PNG and now let's draw and okay okay where are we 1050 all right so today I'm gonna do this convolution example and then take a short break I'm out of my copier so our knob is asking why 280 times 2 because the example I'm going to make is going to show the image and then the convolution applied to it okay just to take this Oh just to take this a little bit further going on my hair they seem like a weird like line see it over here this in my anyway just to take this a little bit further I'm going to demonstrate how to code the convolution algorithm in p5.js in truth ml 5 and tensorflow GS are going to handle all of the convolution operations for us and creating all the filters we're just going to configure a convolutional layer from a high level but I think it's interesting to look at how you might code an image processing algorithm in p5 I have some videos that do things like this previously but let's look at it in this context so I took a very low resolution 28 by 28 image of a cat this comes from the quickdraw dataset which I've made videos about before and I will also use to see if we can create a doodle classifier as part of this series and all I want to do is apply a convolution to that image so first I'm going to create a variable and I'm going to call it filter so this is going to be our filter and I'm going to make it a two dimensional array so let me just put all zeros in it to start you so this is the filter and let's go with that one that looks for edges let me make a separate image that is the same resolution as the cat image but oh you know what's interesting here I just realized something weird that's going on I'm not actually blowing up the 28 by 28 you created it to 80 by 280 image with like big blocks in it it's a little bit weird let me let me fix that I think if I do adjust I think it's gonna be more I don't let me just change this to 28 by 28 hit save and that's really the drawing of the cat then let me delete this one add file reupload it so now if I do this again we're gonna see just the little cat up there which is what I want but I want to draw it at all right that's a little blurry hmm now I have to start this whole thing over why did it because it's trying to smooth it there we go okay this looks so the code is gonna kind of like change a teeny bit in the middle of this video but that's fine the cat image itself is just 28 by 28 pixels I'm using a very low resolution version of that drawing but I'm drawing it I'm drawing it 10 times the size the cat image is actually quite low resolution just 28 by 28 pixels but I'm drawing it at twice the size I want to write the code to apply this filter to the image and draw the filtered image to the right I'm gonna create a variable called dim for dimensions and just call this 28 Oh and then I that I'm all out of order here but and then I want another variable to store the filtered image and in setup I can create that image so this creates a blank image at the same this creates a blank image of the same dimensions as the original cat drawing then I can write a loop and this loop is going to look at every single pixel from for all the columns X and all of the rows why I wrote int there because I am half the time programming in Java but one thing that's important here if we're going to take this 3 by 3 matrix and apply it to every single pixel of the original image if we're applying it to that first pixel 0 0 there's no pixel to the left and no pixel above it it doesn't have all of its neighbors so there's various ways around this but I'm just going to start with I'm gonna I'm just gonna ignore all the edge pixels so this loop will go from so the loop will go from 1 to dimensions minus 1 and stop using this autoformat okay now there's a lot more work to be done here just to apply this filter to any given pixel crime thing I think a way that might make sense to do this is to actually have a new function I would call the function filter let's just call it convolution I'm gonna write a function called convolution it receives an image an X and a Y and a filter and it returns a RG it returns a new color so the idea of this function is it receives ooh why did that shut off I'm turning that fan on is that it receives all the things that needs it receives the original image the filter to apply to it which particular pixel we want to process and then we'll return back to new RGB value after that after that pixel is processed and the reason why I'm doing that in a separate function is I need another nested loop to go over the filter so I need to go from I need to go to eat I need to go from 0 to 3 0 1 2 columns in the filter 0 1 2 rows in the filter and we're beginning to be quite a lot had 4 nested loops right in here now I probably shouldn't have some of this hardcoded in here the number 3 and that sort of thing but you can imagine how you might need to use variables if the filter size is flexible the Auto formatting of the editors driving me crazy okay there should be this yeah I'll leave I'll fix that later this is wrong there are 500 people watching no now now we have it really sort of like sad fact which is true about most cases where you're doing image processing with some framework and in this case our framework is JavaScript in canvas and p5.js and the sad fact is though even though all of this is built up all this discussion is built upon the fact that we are retaining the spatial orientation of the pixels we're thinking of it as a 2dimensional matrix of numbers the actual data is stored in one array and so I've gone over this in probably countless videos but there's a simple formula to look at if I have a given X Y position in a two dimensional in a two dimensional array in a two dimensional matrix how do I find the one dimensional look up into that matrix assuming that the pixels were counted wrote by rows 0 1 2 3 4 5 6 7 8 about next row you know twenty eight twenty nine 20 31 and that formula is let index well I need to do that before this nested loop because I'm looking at that right now I just want the center pixel that XY let index equal X plus y times image dot with so this is the foreman you think about it makes sense right because it's all the X's and then the offset along the Y's is how many rows times the width of the image but there's another problem which is that in JavaScript in canvas for every single pixel in this image there are actually four numbers being stored an R a G a B and an alpha the red green and blue channels and the alpha channels channel singular so each pixel takes up four spots so this index actually needs to say times for it so guess what you know what's gonna make a lot of sense I'm gonna need this operation a lot let's write a function for it index I'll just call it index and it receives an X Y and a width and it returns you know what the width is never gonna change in my sketch so I don't want to be so crazy as to have to pass it around everywhere so let's just gonna pull it from a global variable return X plus y times image dot width and that's not image it's cat dot with okay so once again this is terrible what I'm doing but I'm just saving myself a little bit of heartache here and there so this index ooh mmm let's call this this pixel is okay this should be x for this pixel is that function index XY ah I keep auto formatting and it does this thing that's fine I'll leave that there it's it's gonna be what its gonna be somebody must have shared this live stream because the viewership did just jump up really high and I wonder why okay now I have something I could do to simplify this but I might as well write the code for if this were a full RGB image this is a grayscale image but it has all the channels in it so what I need to do to perform this convolution operation if you go back and think about the Photoshop example that I showed is I need to add up all of the pixel values of the thing that I need to do to perform this convolution operation is to take all of the weights the numbers that are in the filter matrix and I need to multiply each one times the pixel value of all of the neighbors and their corresponding locations add them all up together and maybe divide by something if I'm if I want to sort of like average it out but in this case I actually don't want to divide by anything I'm just gonna leave the weights or the weights or the weights are their weights and actually this right here is irrelevant I don't know I need to do this inside the loop you'll see in a second I think it's gonna make sense so I need some I'm gonna make a sum of all the R values a sum of all the green values and a sum of all the blue values then I need to get the R so now I need to get the pixel which is this is not 0 to 3 oh yes it is I'm looking up in the filter oh yeah all right wait a sec wait a sec wait a sec let's actually I think this is gonna be make more sets look go from negative 1 to 2 you'll see why let me I'll explain why and negative 1 to 2 let's do that instead and maybe it's more clear to say less than or equal to 1 less than or equal to 1 because and let me draw this diagram once again if this is pixel 0 0 this is pixel negative 1 negative 1 this is 1 comma 1 this is 1 comma 0 this is a 1 comma negative 1 I guess I'll do them all right so you can see that the neighboring pixels are offset by negative one and one and negative one and one so the pixel X value is X plus I the pixel y value is y plus J and then the pixel index is call the index function X which returns the actual index into that array for pixel X and pixel Y and actually maybe it makes more sense for me to just say that I don't necessarily need separate variables it might actually be just as clear just to put this right in here okay am I missing chat messages no okay so ombre is asking can't you load grace that images that's grayscale for simplicity I could I absolutely could but I'm gonna just go with this because then me I could also demonstrate this with an RGB image a little bit extrapolate better but yes I absolutely could so now I just need to add the red green and blue values at this particular pixel to the sum so some are plus equal image dot pixels at that pixel index and then G and B G is the next one and B and B blue is the next one and let's add a plus zero here just to be consistent so ultimately what I'm actually returning here is our is some our G is some B and B is some good some of us are G is some g and b sm b so this is the process now of adding up all the pixels I've gone through every single pixel in a 3x3 neighboring area and added up all the reds greens and blues and returning those back guess what though I'm missing the aah why is this camera going off it's not the coding train if the cameras don't just go off every once in a while or all the time but I'm missing the crucial component which is as I'm adding all the pixels up in that area I need to multiply each one by the value in the filter itself incidentally I should also mention that this what I'm the operation that this really is is the dot product and in an actual machine learning system all this would be done with matrix math but I'm doing it sort of like longhand just to sort of see the process and look at it so what's what should I call this in the filter like the factor now I need to look up in the filter I comma I J only here's the thing because I decided to go from negative 1 to 1 negative 1 to 1 the filter doesn't have those index values it goes 0 1 2 0 1 2 so this has to be I plus 1 J plus 1 so it's all six of one halfdozen to the other whether I go from 0 to 2 there and do the offset in the pixels but the point is the pixel array I'm looking actually to the negative and positive to the left and right but the filter is just a three by three array starting with 0 0 in the top left so now I should be able to multiply by factor can I fit this all in one little spot yep and there we go I have the full convolution operation I might have made a mistake here I think this is right when I run it we'll find out if I made a mistake I'm take I'm summing up a 3 by 3 neighborhood of pixels all multiplied by weights that are in a 3 by 3 filter oh but I actually have to call that function here now which should be relatively easy because all the work was in there so if I say let I'm just going to call this RGB equal convolution the cap at a given X and y with the filter then the new image which is called filter oh I have to look up it's okay no problem the pixel is index XY and then filter and so I have to look up the one dimensional location in the new image and then at dot pixels at that pixel is the RGB the red value that came back plus zero plus zero plus one plus two green and blue and then if all goes according to plan I should be able to draw the filtered image at offset to the right with the same size I did miss something kind of important which is that if I am working with pixels of an image in p5 I need to call load pixels so cat dot load pixels filter dot load pixels and thence I haven't changed the pixels of the original cat image but since I changed the pixels of the filtered image afterwards then you just call update pixels and now is the moment of truth never never good when I pressed the snare drum button to run the sketch all right well I've already got an error cannot read properly load pixels of Oh filter filter filtered that should be filtered also this isn't right create canvas the size of the canvas is times ten times two times ten remember the image is just 28 by 28 let's try this again a little bit better didn't get any errors I'll see in image where did I go wrong do I need to give it a hardcoded transparency of 255 yes oops so uh it was fully transparent so I'm not pulling the transparency over I could pull it over but I just know I don't want to be transferred look at that look at how it found the oh oh look at this that doesn't look like it's finding the vertical edges pixels that are different to the left looks like it's finding horizontal edges and you know Oh Simon saying do you know that 10 times 2 is 20 I know I know Suraj is really asking me to say their name so I guess I have just to get that to stop please don't post things like that I mean I appreciate your kind thoughts but it does fill up the chat but let's say the name Sir Roger schwa so that we can move on okay thank you for all of your support and for watching the channel now the wreath the reason why this is detecting horizontal edges and not vertical ones is because of the way that I'm doing my loop I is first in the loop I don't know why is that I mean if I think of why yeah because if I is the xvalue oh it's the yeah yeah yeah the reason why it's finding the horizontal filters rather than the vertical filters is even though I wrote it out this way the inner loop down here is looking at right is yeah but shouldn't it match up I'm like I'm like I my brain is a little fuzzy here no I know I know how to fix it I'm just trying to get the words to explain this why is it doing not doing it because x+ I mean if I is changing cuz I corresponds to the outer the outer array okay yeah so even though I've written it this way so visually these negative ones appear as if they're like a vertical column the inner loop is actually iterating over the the the smaller arrays inside the inner loop is actually entering over for these smaller arrays inside the larger array so I not the inner loop no no one more time with feeling even though even though I've typed this out in a way that visually these negative ones appear in a column it's actually those correspond not to the J index but to the I index so I think one way to fix that would just be to swap it here and and maybe I just like a more elegant way of doing this but this now if I run it this way you'll see ah look at those horizontal edges no need to apologize Suraj I appreciate your interest so now we see how this convolution is applied to the image what's actually happening is to go back for a moment to this neural network process is we don't know what filter is going to produce a meaningful output to recognize what's in the image oh this camera must be overheating I don't know why I'm it's not that hot today 77 degrees in this room but we don't know what filter is going to produce a meaningful output in order to recognize or highlight something that's in the image and sometimes we might need multiple filters to highlight different things all right I've got a fan for this in case of emergency so let me blow this fan I think the camera is overheating which usually doesn't happen with this amount of like so hold on I'm just you know just to blow the air around here for a bit it's a little bit loud but I don't want it to you can always process the audio later the difference in the neural network here the convolutional neural network is we're not hard coding in specific filters that we know highlight things in an image the neural network is going to learn what values for the filters highlight important aspects of the image to help the machine learning tasks at hand such as classification so it might draw out you know cats tend to have you know ears that appeared a certain way and this kind of filter like brings that out and then leads to the final way final layer of the network activating with a high value for that particular classification so just to keep my example simulating the neural network process a bit more let's just every time I run it give it a random filter because that's what the layer would begin with just like a neural network begins with random weights and learn to the right weights the filters begin with random values and it learns optimal values so right here and setup sorry right here so right here and setup I'll write a nested loop and give it a random value between negative and one now in truth convolutional neural network but in truth there are other mechanisms and strategies for starting for the initial weights of a convolutional neural network but picking random numbers will work for for us right now just to see so every time I run it you can see we get a different result image that is filtering the image in a different way okay so I'm it's 1120 I have an hour in 15 minutes left the next thing that I'm going to do is talk about one more operation called a max pooling that's another the operation that happens after this filtering process then I will zoom back out and look at the the full architecture of a convolutional neural network and that will finish this first tutorial if I have time I'll then actually show how do we nem l5 add a convolutional layer to a neural network so let butBut I want to take a short break and I want to take this time to thank whoops the sponsor of today's coding training episode oh look everybody left only thank you short breaking I want to take this time to thank the sponsor of the coding train today which is audible.com so I happen to be already I'm so excited about this because I happen to already be a audiobook listener I do try to read books as well I mean that's a thing but I do I spent a lot of time on the subway I spent a lot of time jogging exercising I don't spend as much time as I would like and I find that listening to something music is the thing to listen to but for me listening to audiobooks is a way to a have a chance to to to learn something that I don't have the time to read the physical book and it's just it keeps it's energizing I really love it and I am so excited cuz I didn't know this I listen to a lot of different kinds of audiobooks I listen to you know detective novels and strange non and historical nonfiction and different kinds of things but I hadn't really looked into whether there were machine learning audiobooks and so the exciting thing that I'm gonna tell you is that if you go to audible.com slash coding train or text coding training to 500 500 you will get a free audio book a 30day free trial of the audio audible subscription which every month you get a free audiobook and two audible originals which are original content for by audible but there's a book that I want to recommend which I'm going to see if I'd bookmark yet before I started which is called you look like a thing and I love you which is how artificial intelligence works and why it's making the world a weirder place by gianelle shame I started listening to this yesterday and verso books so a wonderful about this book is a lot of the work of Janelle Shane is generating text with AI and she's going through in the book how a lot of like how a lot of times she gets nonsense and the audiobook narrator she's say I don't know it pronounced sexy sands performs all this like nonsense speak and it's kind of hysterical and wonderful and delightful so this book both has a wonderful set I mean it's a really great companion to the stuff that I'm teaching about because it goes through the concepts but it also looks at in the context of creative arts and sort of making weird stuff so I couldn't couldn't recommend it enough for you to listen to let me see here if I'm missing anything else that I want to tell you about audible so audible members can choose three titles every month a one audio book like this two exclusive audible originals that you can't hear anywhere else and you also marble gnomes also get access to exclusive guided fitness programs so just start to start the new year off it's still it's not February yet you can still start the new year off of the news resolution to listen to an audio book to listen to an audiobook once per month so you can start listening with a thirty dre 30day audible trial choose one audiobook and two audible originals absolutely free at audible.com slash coding trade or text coding train to 500 500 okay so I'm gonna take a short break to refill my bug of I don't know what I'm gonna put in it water tea coffee who waits to be seen what I'm gonna find in the kitchen over there if you have a chance and to give audible a try while if you're still hanging around for the second half of this live stream you can take your time to do this in this break and I will be back in just about five minutes to continue this convolutional neural network example hi everybody it's gonna just be three or four minutes more so I'm just this song heads in about 30 seconds so I'm just gonna scrub it back in the beginning I'll be back in just about three or four minutes moving as quickly as I can okay thank you for your patience I am back so again thank you to audible.com you can get a free trial at audible.com slash coding trained and I look this book is so wonderful I actually ordered I'm listening to the audiobook right now and I also ordered the hard copy but it hasn't come yet otherwise I'd wave it in front of you okay close this and we are back here so I'm going to save this as is and now I'm going to say duplicate convolution max pooling okay oh and this I can remove maternal coder says the viewer instant rise happen twice what if someone is viewbotting that seems kind of unlikely that someone is viewbotting I mean why would anybody do that I mean it did that the fact that I've been twice in it was very consistent with the numbers a little bit odd usually when this happens it's because just somebody happens to share something on social media or YouTube is doing like weird stuff with its recommendations and all of a sudden it sends a whole bunch of people who all like calm and then instantly leave when they realize it's not what they're looking for so who knows hip chocolate chip hope your midterms went well and marshmallow is asking can I post two links of a project so I don't know maybe you're asking about posting links to the YouTube chat I will mention that what am I saying ah so if you want to share stuff the two ways to do it or there's lots of ways to share stuff but in terms of coding training community is the discord so I will post the discord link I have a button that does that now so that discord link should appear in the chat but it's actually going to appear before I say this chat is a realtime but there's a 30 second lag from what I say and when it reaches your ears and then also at the coding train comm there are ways of adding links to projects that relate to particular videos or challenges okay everyone wants to know what's in the cup so this is why I took a little bit longer I was like I feel like I need some coffee and I was like no coffee I was like I you know what I don't you drink coffee I just need water I filled up with water at a nice full mug full of water but I really love this bug so much I'm waiting for it to be a sponsor so kind of three hit me up fellow mug I think it's called so I figure what the company is anyway audible.com slash Cody great um mostly saying ah but then I was like I need a couple more minutes I need to make a quick little bit of coffee so I made a little coffee sort of coffee hello to or and prom and other people in the chat 232 and the chat is asking can you give temporary permission I could but it's is I can't manage that while I'm livestreaming so I prefer people to share links I just keep the YouTube protective settings on and that's the way it is and welcome to Brian's heart all aboard on the kodi train with your kodi train membership you have received a random number sixty five thousand and seventy six oh thanks for watching the promises videos says or appreciate it alright now what am i doing so just so you know I have look kind of like a hard stop at 1230 and there's a there's a workshop happening in this space I'm starting at 100 so I need to get out of here and kind of clean up plus I need to move on my day and eat lunch and do other things as much as I would like to livestream my voice is starting to hurt I might talk for a lot but I'm good thing for you is hopefully maybe even as soon as next week a video that's not edited out of a live stream will be coming live on the channel a coating in the Cabana video it's very cold during that video it's snowed so stay tuned for that all right what am I looking for max pooling back to this paper or there's this yeah okay okay oh by the way this is just from Wikipedia but this is you can see just a lot of additional these are a lot of sort of common convolution filters for certain kinds of operations okay so I this is sort of my notes I hesitate to use a lot of these diagrams and images in the edited version of the video that's coming out I mean certainly I would credit them but they're not ones that I've made and I want to be thoughtful about you know I want to feature the work of others but I also want to be thoughtful about having permission to use theirs other's work but I think this paper where did the paper go where is the alright I just want to see I like a kind of like using the the yawn Laocoon paper with other authors there are as well where's the oh here we go I just want to see if max pooling us in here sub Oh is subsampling is sub sampling the same as the max pooling operation cuz it doesn't say in this oh no I have to do this every time now welcome loonies pouch to the cutting trees aboard the cody train cheers you have entered the cafe cars where I will be drinking my coffee say hello to you Kate week Mon writes I think so I'm pretty sure that he's referring to my question I'm so happy that King week joins Minh is watching because it's it really helps me to stay sane and know that what I'm saying is not completely crazy is this actually oh this is I can search this PDF pooling pooling does not show up my guess is it's the subsampling if anybody knows this for sure I would appreciate okay all right so okay I was indeed all right okay now that I've wrapped up talking about the convolutions there's one other there's many other aspects to this diagram but there's one other really important operation that happens in a convolutional neural network that's described in this diagram it's subsampling that I want to add to my diagram and my code demonstration and that is and I'm not going to call it sub sampling I'm the common term for this now is called pooling and in particular the operation that I want to add is max pooling so there are different kinds of pooling you could do but max pooling is the standard pooling operation for a convolutional neural network so max pooling I mean it's another layer it can happen at any given point so we could max pool before we apply the convolution but I've typically speaking the convolutional filters are applied and then after those are applied we get new images out of those and those go through a max pooling layer so I think to describe I think I need to erase this whole diagram so that I can look at max pooling and then we could kind of come back to this when we look at the full architecture so let's begin with our 28 by 28 image then let's assume I have one filter just to simplify things I had one filter that was three by three one thing I didn't discuss and it's gonna be more relevant with the max pooling layer because I'm gonna do something specific with it is there's a term you'll see called stride and stride refers to remember this filter you know I'm not gonna actually do this 28 by 28 but this filter is applied to each and every pixel we take we take this filter apply it to this pixel and this gives us a new image pixel apply filter take the result into a new pixel pixel apply filter take the result put it into the new pixel here's the thing this is 28 by 28 this is a 3 by 3 filter I had to start with this pixel right here right because the edges don't have neighbors on all sides so ultimately this and stride sorry stride refers to how far I pass the filter along as I'm going through the image I don't really have enough spots here but you know I could I could take the filter and jump over pixels as I'm applying it to reduce the resolution of the image in this case I had a stride of 1 in my code that I wrote the stride was 1 I just slid over by 1 and we can actually see where the stride would go if I go back to my example this ultimately right there the X plus plus y plus plus that's the stride so I could say X plus equals stride y plus equals stride and set the stride equal to one so that's what was happening here but even with a stride of one if I'm skipping the edge pixels my new image is 27 by 27 so one thing that's really key to how a convolutional neural network works is that the image over time as it goes from layer to layer to layer so this is the convolutional layer with the filters and now I'm going to talk about the pooling layer the resolution is reduced and this has a number of benefits one is images are high resolution with millions of pixels so this the this learning space of a neural network to learn all the parameters of every pixel connected to every filter throughout multiple layers it would just be much too big to realistically be computationally realistic to do so this process of reducing the image down and down and down as the layers is effective in keeping things manageable but it also has another benefit which is we're trying to boil the essence of the image down into something that will highlight key features in that image and so this is really what the what pooling does what max pooling does a 11 thing it does is it really reduces the resolution which I'll show you in a second but it also picks and chooses the pixels that have the highest values to emphasize those what is really being activated so pooling comes with a matrix as well it's not really a filter but it's a matrix and a standard matrix might be two by two and so let's take the case and actually let me erase all this just to zero in on pooling I'm gonna try to let's come up with a simple scenario what if I did 8 by 8 terrible 1 2 3 4 5 6 oh I'm the worst one two three four five six seven oh so close eight one two three four five six seven eight so describe this I'm going to start with an 8x8 image and I'm gonna do max pooling with a two two by two max pooling with a stride of two so there are no weights this is not a filter it's two by two is just describing how much of the how many pixels am I looking at at one given time so if if I'm looking at a 2x2 area of pixels for each iteration of this algorithm and then my stride is to the next set of pixels on look at us here the next one is here the next one is here so for for the for the columns I end up looking at four and for the rows it's the same it's eight by eight four so actually the result I just want to point out that after max pooling and actually I don't know I don't need to draw it that far over the result after max pooling is four by four four by four now how does the algorithm works but this sounds like some fancy thing this is actually the simplest thing ever basically for each one of these areas of two by two pixels take the largest value the brightest color and put it in there so so I'm gonna fill in some arbitrary values here I don't know how easy this will be to see but let me just write some values so I'm not gonna fill this whole thing out but you see I don't know how well you can see this but I have the numbers for 8 negative 1 to the highest one is 8 it goes here I have the numbers 3 3 1 9 the highest one is 9 the highest one is 1 the highest one is 10 and so the max pooling algorithm takes these little neighborhoods 2 by 2 max pooling skips goes from one to the other with a stride of two I could have just moved these neighborhoods just by one or by even a larger amount but this is pretty typical and then takes it down this has to be this has the benefit of sub sampling the image reducing it but not just we can do average pooling so you could do average pooling averages all of these but it turns out convolutional neural networks perform better with max pooling over average playing maybe not in all cases but in sort of like the standard image classification case and this is because what we're looking for our features in the image that we want to highlight and so by looking at an area of pixels and seeing which pixels were have activated the most and keeping that one that's going to really emphasize then help boil the essence of the image down into something lower resolution oh just no one use max pooling anymore am I so like out of date me I am so me I will I will do it really likes my member joining bit which I very much appreciate the spontaneous thing I thought of today I will happily when if I have some time so just to be accurate in my video here should I add a little sentence about what is now more commonly used in max pooling truth teller says me tells me truth teller is name is truth teller so truth teller I know because when I see something on the internet I definitely read it without being critical or thinking about whether it could be accurate at all right no but I you know I have no reason to doubt truth teller K weak bonds confirmation could really help me though I don't wanna put too much pressure on K weak mine max pool plus average pool is better dilated is dilated pooling the same thing dilated pooling whoa max pooling dilated pooling all right max pull is most common all right I should add just to be really accurate here and the chat is tell this is offering some different opinions about this that while max pooling is the most sort of like common historical example of while max pulling is the most common historical example of pooling in a convolutional neural network there are other other researches showing promising results from things like dilated pooling which is a new concept to me that I just looked up and read about some combination you can also do a combination of max pooling and average pooling so there is I think some discussion and research happening there and I'm not here to tell you what is the optimal way to architect your convolutional neural network I just want to talk about and explain the process and look at an example of it which is very common like max pooling in particular okay I think that's enough that's enough for me to say an ADD so now so let's add max pooling okay I'm trying to think of how to do this would IMAX pull the our G's and be is separately I think I would write or would I take the pixel value that is the would I take the pixel value from whatever from the one that has the highest like brightness like the average RGB like could I take different ARS and G's and beats from different pixels in the neighborhood or do I have to take the full RGB from one that happens to have the highest brightness I don't know can someone answer that for me before I move on and I have about a half an hour left this might be the last thing that I do today I'll wait terrible thing for you to do just like have a question and not bother trying to research it or think about it just like ask it wait to the National for me in the past I guess I'll start writing this code maybe take RGB separately so maybe I'll just ask this question as I make the video and I'll just pick one way of doing it since there doesn't seem to be a consensus in the last few seconds so I'm gonna write another function much like convolution but call it pooling and the same thing it goes here I want to receive an image I want to find a certain XY I want to same thing happens here I want to receive an image I want to give an X Y I want to return some RGB value that is the highest RGB values within that neighborhood now there's an interesting question here do I take the RGB values from the brightest pixel whatever they might be or do I just take the the highest are the highest gee and the highest be independently and they could be from different pixels I don't know the answer to that right now let me take the RGB from the brightest pixel no that's gonna be more work let me just go with actually picking the brightest are the brightest G and the brightest B separately independently so I'm gonna start with the brightest RG and B and I could start with zero but just to be really really safe you absolutely absolutely absolutely in the convolutional process there's the the idea of pixels is gone really just dealing with numeric data and so I really should if I'm gonna try to find the brightest a start with in negative infinity because that's the lowest possible number you know in JavaScript that is then I want to look at this 2x2 area and the same thing that I did before in convolution I and the same thing that I did before in the convolution I want to look at the given pixel and its neighbors yes starting with the color II which definitely made life difficult for myself it's silly cuz the image itself it's great scale but whatever at the end I'll load my color image to see that this actually works with color and then I could get the RG and B from that pixel and now I just want the maximum I want if this R is greater than that print that what is being stored as the brightest are then that are should be the brightest are which I can do with the max operation right R is the biggest between bright R and R and the same for G and B oh and the same for G and B oh and that has to be 1 & 2 so this is actually all that I need to do this is max pooling right here but now I just need to return bright are bright G and bright B all right next I'm going to create yet another image I'm going to call it pooled and pooled is also a blank image however if you recall I'm going to use a stride of two so the resolution of that image is reduced further by half so I'm actually going to take out the stride from here and I'm going to create a global variable for stride but this stride is only referring to the pooling process because then I can say create image dim / stride dimensions / stride sorry I'm lost here so just to add some comments for a moment this is convolutional layer i mean i'm simulating the idea of a convolutional layer i'm not actually there's a neural network here there's no machine learning here I'm just going through these particular algorithms without matrix operations I should add then let's add the pooling operation so same thing here I'm going to go through all of the pixels in this case I can start at zero but I still need to only go to dimensions 1 because maze I'm going to skip every 2 pixels and I don't want to end up here so this is plus equal stride and this is plus equal stride I can do the same exact thing I can create a variable called RGB which equals now pooling I want to pool what were my arguments the image and the XY Y is there oh and I should probably call this like max pooling but whatever oh no no I'm not pulling the cat the cat was filtered with convolution and then the filtered image is pooled so I'm pulling filtered at this given X Y then I need to figure out where am I putting the resulting RGB values I'm putting them in the I'm putting them in the image called pooled but that image has the dimensions of half so the pooled X is X divided by the stride the pooled Y is y divided by the stride and then the index is and yeah so this is why this function really needs the image passed with it i I should not have used the global variable it was terrible idea because I want to reuse it but I have a different resolution of image so I'm gonna go back to making this image and then where did I call it here it's image dot with here it's cat oh I don't need to do the dot dot with it's just the the particular image that I'm calling the operation with I needed here image anywhere else oh here image so now I could say index of pixel X pixel Y in the pooled image because I want to say pooled dot pixels pix plus 0 equals RGB are and I need to add the load pixels and update pixels and now this should be the max pooling operation go over the filtered image by the stride for every 2x2 area find the highest RGB values and then add those to the pixel the corresponding pixel in the lower resolution pooled image let me make the height of my canvas times two so I can put the pooled image at the bottom right so the filtered image went off to the right and now the pooled image should go also off to the right and let's give this a try I don't see the pooled image lines think of the chat zombie line 61 is an error this should be a G what did I miss oh I forgot to add the Alpha again I always forget this so I need to give it the Alpha there we go so let's go back to a known filter instead of having random filters so that was my edge detection and you can see this is just I mean visually what I'm seeing right now is kind of like a lower resolution version of what you have above but if I were to rewrite this with say average pooling I think you would see it different it wouldn't come at the most features these edge features that it's you know in a neural network would be discovering here I'm telling it to look for those are highlighted even more than they would be with just average pooling itself right so now that I've shown you the code for both applying a convolution filter to an image and then a pooling algorithm to that image with a variable stride I think that I can now go back and look at the larger rket the larger diagram of the full story of a convolutional neural network that has these components in it and again our reference point is this diagram from the 1998 paper which is called the 99 1998 paper gradient based learning applied to document recognition but Matt Joe when we edit this we can just leave this there I've just needed to read what the paper was gone and then so what where was I okay just want to also I also just want to highlight for you a blog post that was super helpful for me in like figuring out what to do and talk about in or was it I also want to highlight for you a blog post that was really helpful for me when I was reading up and researching and trying to learn about convolutional neural networks it's this blog post right here an intuitive explanation of convolutional neural Oaks from night from 2016 this diagram is super helpful this is exactly what I want to talk through basically and there are a lot of nice visual diagrams and animations of the convolution process convolutional filters as well as the max pulling algorithm itself as well okay forget that that research as it worked very well let's look at the here's my best attempt now at the full story of the convolutional neural network we start with an image the first layer is a convolutional layer and I'm writing 2d because a lot of times in a machine learning library you can have convolutions in different dimensions and we're working with a two dimensional convolution here the convolutional layer has a number of filters the image is sent to every one of those filters and the these filters are applied I should say that the pixel the values that come out of the filters aren't just the raw values from the convolution process they're also then passed through an activation function the same kind of activation function that is in a standard neural network our standard dense layer the let's just assume the same kind of the same kind of activation function that's in a standard layer or a dense layer so typically this would be rectified linear unit or raloo typically this would be rectified linear unit or e Lu then the next step is max pooling I'll represent that with little squares so the image that comes out of the convolution and the activation function is then max pooled and then the output there is another image so we take this first image pass it through a bunch of filters max pool then and then we have a whole bunch of new images that aren't most likely if I'm using the stride if the a whole bunch of other image that if I'm using a stride of two now have half the resolution as the original image so the question becomes what to do next well we could be done and pass this to what I what is the last layer and if we're doing that at some point the Dana does have to be flattened so everything I did in my previous video about ml5 neural network with an image that just gets flattened and passed in that is what happens in the last layer the last dense layer takes these images and makes and has a hidden a hidden layer of neurons and each image is flattened and sent into all of those and then sent to the output layer yeah and then sent to the output layer and pass through the softmax activation function that I've described which gives it a probability for a classification if this were a classification problem but what's interesting is in most cases if you look at a lot of these diagrams for example this diagram on the blogpost I referred to or this particular diagram here you'll see convolutions subsampling convolutions subsampling so it's actually quite common in a convolutional neural network I really didn't give myself enough space here if we have another convolutional layer let's say there's just three convolutions filters this image goes into all of them I'm confused somebody help me out here for a second so let's say we have another set of filters this many filters this these images that come in there's one image that goes into all these initiatives initial filters then that gets max pooled and and we get a new set of images each one of these images would go into all of the filters but does that mean does that mean then I'm actually producing I now have one two three four five times four 20 images that get max pulled that must be right yeah we can see that happening here because there's this many images that get subsampled and then the convolutions are excellent name is saying they're stacked into a 3d image but ultimately that's the same idea filters must be 3d but here in this diagram it's showing it expand out right oops yup says Isaac let me redraw this to give myself a little bit room I'm running out of room and I want to diagram the full story I used so much space here for this image okay so here's the same diagram but squashed a little bit to the left here because what I want to do now is add another convolutional layer and another max pooling layer actually so here's the same diagram but squashed a little bit to the left because I want to add another convolutional layer and another max pooling layer so I'm gonna add some more filters here but something interesting is gonna happen here so let me actually do fewer filters in this next layer and I'm gonna be really I'm gonna just do only use there's only two filters here well these images that result from the first convolutional max pooling process they need to be tested are not tested they need to be sent to both filters so this image goes here this image goes here so in essence we have 1 2 3 4 times 2 times 2 filters and I'm not really drawing this well to have 8 in total so we get 8 new outputs out of this convolutional layer and each one of those needs to be max pooled so now I have eight images and remember let's say this was 28 by 28 these are all seven by I'm sorry 14 by 14 then after this convolution process and this max pooling these are all now seven by seven so we get these progressively lower and lower resolution feature maps of the original image with lots of different filters applied in lots of different ways finally and this is exactly and then the final result is essentially everything that I did in my non convolutional neural network with an image just that one hidden layer it's called a fully connected or dense layer and one output layer all of that gets put right here but instead of some original image being flattened and sent to it this whole process has happened and we're sending the data from these 7x7 images through the one dense layer and one and I've totally run out of room here so I'm just gonna put oh here output layer and this is where we would finally see is it a cat or is it a dog we would see probability values for the particular classification task and again if I come back to this diagram I just want to thank the author of this blog post because this is a much nicer more sort of like elegant way of drawing this and you can see actually this has two fully connected layers which is also a things so there are different ways you could architect this only drew seven somebody's saying one two three four five six seven eight one two three four five six seven oops I'm missing one here okay even though this is a bit of a mess let me go back and refer to the and thank the author of this blog post for this much more thoughtful and precise diagram showing these different layers how the images become lower and lower resolution become these final feature maps and then get passed through what's here is actually two fully connected layers so there are a lot of reasons why you might have different numbers of convolutional layers different numbers of fully connected layers different strides different filter sizes that another word for filter is kernel so this is it I really all I want to do this video was talk through all the pieces as well as show you some code that actually runs through and does those processes to an image itself which I think opens up a lot of interesting possibilities for you if you wanted to create a project around visualizing the process of a convolutional neural network as it's learning now this would be a much bigger endeavor than what I've done here because you need to create these visuals out of all of the pieces as the training process is happening but ultimately what I want to do next is 2/3 things and it might take a while for me to get to them but they will be eventually hopefully in subsequent videos one is I want to just create this exact architecture with ml5 I want to show you how the ml5 I can make ml5 neural network with a convolutional layer maybe two convolutional layers and then a dense layer and an output layer then I can take that and apply it to the previous example where I didn't use convolutional layers and just see how that looks I also would like to look at creating something called that I'll call I also like to look at something that we could call a doodle classifier so using the quickdraw dataset that I've referred to in a number of different videos could I train a classifier to recognize particular drawings and in fact ml five has built into it a doodle app retrain dual classification model that's pretty robust so you know I might try to train a sort of like smaller version of that write all the code for that with ml five but ultimately then show you how to use the pre trained that's in ml5 as well but that uses convolutional layers okay Soho thank you so much if you somehow made it all the way to the end of this rather long explanation and kind of tinkering around with code demonstration of what the process of convolution and pooling is in a convolutional neural network I hope to see you in a future coding training video I mean I don't really see you but I I feel your presence somehow and as long as you write a nice comment it brings me a little happiness to my day so I will see you in that virtual way in a future video and thanks for watching and have a great day that's not convoluted at all Oh Jean Cogan's what neural networks see ah let me reference that I meant to thank you yeah this is what I meant to reference yeah this is maybe we could fly in a little clip of this what I'm describing actually is really what I'm describing really has been implemented with gene Kogan's us video and lecture series called what convolutional neural networks see and you can see over here a visualization of all the filters being applied to genes a webcam image in real time so I've maybe given you the pieces now of what it would take to actually create a project like that yourself okay truthteller escape is spouting some total truth online to be fair that's a better cat than the cats in the cat's movie all right Simon Tiger points out for 32 by 32 images you can bring it down to a 1 by 1 pixel image in only 5 convolutional layer blocks which is a term ok it's a peek into the black box yeah yeah okay okay everyone thank you for tuning in I've got to go I didn't get so listen up listen if I go now let's just go to hear this I had a little guide here of what I think it's like under missing videos let's see a sort by recently updated missing visitor oh so oh oh my god so many things to do yeah let's revise this oh boy edit what are CNN's that was done well I was hoping to check off whoops that was I was hoping to check off more boxes but clearly I just I added more boxes and checked off one so I've actually gone back in time like they have Lord to do that what I had to do before I started today here's the thing I'm unfortunately gonna leave this stuff aside I would like to over the course of this semester fill in gaps here but next week with like when I'm back next week for a live stream which hopefully be next Friday although I am planning to switch to Thursdays but I think next week is actually gonna be Friday's I am going to start looking at it's gonna be a fairly beginner hopefully fairly beginner friendly a session on create vector and vectors in p5.js so all this stuff at least I have this list to keep track of stuff but and I will try to return to it hopefully I would over the course of this semester we'll see how that goes whoo thank you for tuning in let me put on this little song remind you that you can sign up for the discord and I have just posted the discord link in the chat also once again remind you to thank I mean I'm thanking and remind you that you could get a free 30day trial of audible a premium audible subscription at audible.com slash coding train and that gives you a free audiobook and two audible originals I highly recommend you now book that I talked about your a thing I love you what else do I want to mention any questions in the YouTube chat or the discord member chat I will gladly address in the next minute or two I'm not five minutes over so I really do need to stop gosh I hope the recording is fine from today to find out I didn't check it in the middle which I will sure did I mention the store standard TV / coding training I really you know I only want people to get stuff if they would enjoy it but I do have a vested interest and people buying the hoodie because they'll only make them if enough people buy them and I want one guess I could figure out a way to make my own today strange usually I can't keep up with the questions now there's just no questions well thank you very much and I am going to sign off in about 48 seconds I'm tired three hours is a long time live streaming pieces in four hours but we nice if I had another hour to keep going you try to get a little further but I think my brain is a little bit dead anyway time to do some gross stuff alright thank you everybody I will see you next week be on the lookout for edited versions of these livestream sessions as well as hopefully soon in the Cabana video see you in the discord I'm gonna do this this stock this start the starter this start song never forget the Vista autotuned and the internet will fix that for me coordinates so this is random this is noise Perley noise that is in the core random algorithm the actual random algorithm itself those numbers aren't related at all you pick like I'm picking random numbers between zero and ten nine two seven six one nine four eight nine to one thirty I think nine why apparently but with curly noise I might pick numbers like this two three four three four five six five four five six seven five six seven five six seven eight nine eight seven six well this is like pearly noise performance part these like girls and boys performances but with curly noise I might pick numbers like this by purling noise that is Hurley noise this is Hurley noise that is Hurley no this is this is Hurley noise that is Hurley no so this is Hurley noise that is her pearling know her Perlin noise that is Hurley noise this is Hurley noise that is Hurley noise so this is but with curly noise I might pick numbers like this this is like Perlin noise performance part unicorns and rainbows and cupcakes what else is there yes kids thank you very much kittens and rainbows and cupcakes notice that look what I get really losing my mind I feel just sort of like a nice feeling of relaxation everything's gonna be okay today dream is not broken it has not frozen this isn't this is a wonderful thing okay we're gonna do it I'm really getting to something I need my sound I will use it over and over again all sorts of text generation analysis states that I will use continuously over and over again