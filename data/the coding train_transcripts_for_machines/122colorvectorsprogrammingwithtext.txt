(bell dinging) Hello, part two. I think I'm on part two of my word2vec series. I'm talking about word vectors, word embeddings, words and numbers and how they go together. Now, let me be very clear here. This particular section, this video is directly based on this wonderful tutorial by Allison Parrish called Understanding word vectors, released under the Creative Commons by a 4.0 license. If you also use this stuff, please attribute it according to the license to Allison Parrish. I will include a link to this in the video's tutorial. I talked a bit about word vectors in general, and about this tutorial, and other things that you might look at for inspiration in the previous video, and now. So what I want to do is a direct port of this example from Allison Parrish that looks at language with a vector's colors. Now, let me be clear about something for a second. In the previous video, I talked a little bit about this example which was looking at animals in a two dimensional space with the xaxis is like their size, or their yaxis is the size, and xaxis is their cuteness. And is that word2vec? Well, not exactly. These are word embeddings, meaning there is a word embedded with some numeric data. I don't know if that's the best way to describe it. But it's not exactly what you will find if you look up the term word2vec. Word2vec is a particular algorithm, a machine learning algorithm to take a large body of text and produce these word embeddings, high dimensional arrays of numbers based on how the words appear in context in that text. And I'm going to get to that a little bit later. So sort of in theory, the theory of it is we'll end up with this essence of the word, and words that are similar in meaning, or context, or what, if it's a big question mark are going to live close to each other in that 100, or 300, or a thousand dimensional space. But I'm making the case, and this is really from Allison Parrish's tutorial, that we can maybe understand this concept or practice this concept in a simpler way to start. And that simpler way will be to use a data set. I want to use this data set. It's the xkcd color set. It's the 954 most common RGB monitor colors as defined by hundreds of thousand participants in a color name survey. You can see more information about that survey here. So anyway, but the data set itself is over here in Darius Kazemi's open source project Corpora, which has a lot of interesting JSON data sets. So I have downloaded that data set and I have it right here. So the question is, can we turn this into a word2veclike scenario? And what kind of strange outcomes can happen if we compare each one of these words, or sets of words, like cloudy blue, with a set of numbers? All right so, let's write some code. So first thing I'm going to do is I'm going to add to this preload function. And I am going to just create a data set. I want to say data equals loadJSON xkcd.json. And then I'm going to say here in setup, console.log data. So let's make sure this works. I'm going to go to the browser where I have my code running. Okay, so we can see here that I have now loaded into that variable that array of 949 colors. Each one is an object with a label, cloudy blue, under the color property, and an actual hex value. So my goal right now is to turn that into a list that looks more like this. The label with a number. All right so, let me first write a little bit of code to kind of process that data. So I am going to, let's write a function. You know, processData. Put in a separate function. And I'm going to create a variable. Call it vectors. It's going to be an object. In this object, I first want to go through everything in data. And actually, everything that's in data is in data colors. So I'm going to say let colors equal data.colors. Then I'm going to say colors.length. Ah, oh autofill. Autocomplete, you do not complete me. Colors and then I'm going to get an individual color. It's colors index i. And then what I want to do is say vectors. Create, oh, oh, oh, oh. I'm going to use createVector. So this is what's kind of interesting about this. I forgot while I was doing this. All right, so here's the thing. Right now the data. The data from that data file is just in a big array. And the array has a bunch of objects in it. Color, you know, blue, comma RGB, I forgot what it is, and then like the hexadecimal, you know, value like this. It looks like this. I want this to be in a associative array, a dictionary. But I'm just going to use a JavaScript object for that. So just an object where the color blue is the property name. And the value of that property... And originally in my head I was like, oh I just need to convert this into numbers and then I can make a little array like zero, comma zero, 255 But guess what. I want to do vector math. My vector is three dimensional, 'cause there's an R, a G, and a B. There happens to be in p5 itself a class called p5 vector. I can make an instance of it with the createVector function. So even though eventually later, if I'm going to be doing vector math on a 100 dimensional vector, an array with 100 numbers in it, this createVector won't work. It's a nice coincidence that RGB has three components, just like a three dimensional space, coordinate, x, y, z, a three dimensional vector. So I can put in here that p5 vector. createVector zero, comma zero, comma 255. So that's what I'm trying to write the code to do. So I can say vectors. So I'm going to actually say label equals colors index i dot color. And then, rgb equals colors index i dot. And what is it in here? It is hex. It's under hex. And actually, I'm pretty sure that in p5, if I have a string, like let s equal zero, zero, zero. This is the hexadecimal code for red. I can say color s and it will give me a color object that has the RGB values in it. So what I'm going to do is... This is a little confusing 'cause everything is called color. So there's the colors inside of the JSON file. And each element of the colors array has a color label. And now there's a p5 color function. So there's a lot of stuff called color. It's all different. But I'm going to say rgb equals the color function with the hex thing passed through it. And then I can say, rgb.r, rgb.g, rgb.b. And then the vectors with that label, there we go. So this is just a little bit of data cleanup to a format that I want to have it. I don't know if it really matters so much. But I think this is going to help. I create an empty object. I look at all the data, the way it's in the JSON file, and then one at a time, I make a p5 vector out of the RGB values. And then I'm going to say, return vectors. I suppose that it would be nice to like pass in this argument. And I could say, let vectors. And then I'm going to say vectors. Can't read property length of undefined sketch.js line 13. Let's console log data. I must have been confused. Oh boy, I'm doing this in the wrong place. The whole point of preload is that it's a function that you call to make sure the data is ready before you get to setup. Because loading data, loading a text file, loading a media file is asynchronous in JavaScript. And I'm trying to simplify that. This needs to be in setup. And now I should be able to say this here as well. Okay, here we go. There we go, now. Oh wait, okay, hold on. Weird, what's going on. Oh, there is a setup down here. Too many setups Mozart. Too many setups. Okay, here we go. This is going to be right eventually. There we go. Now I have basically a dictionary where every single one of these colors is paired with a p5 vector with these x, y, and z values. Now that's not right. That is not right at all. A lot of zeros in there. Let's see. So there is no .r, .g, or .b property of a p5 color. I made that up completely. (Daniel laughing) Red, it can call the red function and pass in the color. Green, blue. This should work now. Just makin' up stuff that doesn't work. Okay, r is not defined. This is rgb. There we go. And there we go. Now this is looking right, right. And algae lives in the vector space 84, comma 172, comma 104. Now that I have this data set, we can begin to imagine a physical space, a three dimensional space where all of these colors live. Right, so there's an xaxis, well a yaxis, an xaxis, and a zaxis which is actually coming out from the wall here. And one color might be over here. And another color might be here. One might be off in the distance. One might be very close up, all right. So you could imagine this. I'm trying to draw this three dimensional space on a two dimensional surface. But you could imagine now that I could do certain things by, what if I just did a random walk? What if I did a random walk throughout this space? What colors would I find? Let's try that. Why not? Excellent starting point. Okay, so let's say where I'm going to start is I am going to have a position. And in setup, I'm going to say position equals createVector random 255, random 255, random 255. Now, what I want to do basically is what if I pick a random space, random vector in that three dimensional space. Let me find the word, the color that is closest to that. So I'm going to write a new function which is I'm going to say call, findNearest. And this function is going to take in a vector. We'll call it v. So the first thing that I want to do is I want to get a list of all of those colors into an array. So it's important to note that it looks like I have an array of all these things. But this is actually an object where the key, all the keys of the object are the names of the colors paired with the value which is the vector. But what if I could sort this list by proximity to that other vector? Well I need an array to be able to do that. And so a quick way I can an array is I can say, keys equals Object.keys from vectors. This gives me, if I just console log this and I say findNearest, you can see now I just have an array of all the keys. But I can sort this. I can say keys.sort. And now guess what. If I call a sort function, I can always sort by an array by my own arbitrary comparison of the two elements. So I'm going to use the arrow syntax here and I'm going to write a function that compares two arbitrary elements, a and b. If you're not familiar with this arrow notation, it's like declaring, it's a new way to declare a function in ES6, not so new. And I'll refer you to my video about the arrow function. But what I'm going to do now is I want to say the distance, distance one is the distance between, the distance between... I'm going to pretend I have a distance function for a second. Vectors key a, and vectors key b. Oh no, no, no, I'm sorry. The distance between v and vectors. Oh my goodness. Yeah, yeah, yeah, yeah. Between a, yeah sorry, I got confused for a second. Remember, I'm trying to tell the array which one is closer to v. So I somehow need to compute the distance between my random walker, v, and either a or b. Which one is closer? And then I can return d1 minus d2. Because, what sorting will do, sorting, when you have two elements, if you return a negative number, it puts a before b. A positive number puts b before a. It might be the other way around. I can't remember. And if it returns zero then they're the same. It doesn't need to swap them. So you're just telling the sorting algorithm which one goes before the other one. So I'm going to get a negative number by comparing these two values. Now of course, I need to have a distance function. So I need to have a distance function that can take a vector and, two vectors. v1 and v2. And I could just say return p5.Vector.distance. This is a little silly, v1, v2. So I really just am wrapping. There is a distance function already. Function distance. That will take two p5 vectors and I can get the distance between them with p5.Vector.dist. But I just want to... And I'm doing that exactly here. So I think, let's look at this. Now I should be able to look here. So let's look at this again and findNearest. Cannot read property dist of undefined. All right, so hold on a second. Let's make sure I have a vector here. Let me actually call findNearest from the code. Oh, I have to call it with something. No wonder it was undefined. You can't just call... The whole point of calling findNearest with a particular vector, oye. Okay, so this now, does this look sorted to you? Let me actually unfold it. It's a lot of things. There's a lot of colors in here. Greenish blue, tealish, greenish teal, greenblue, aqua marine, sea. Right, I picked some arbitrary spot. Now what is that color actually? So here's the thing, did I sort it in the correct order? That would be a question. So let's console log v and then console log also vectors, sorry. Vectors, keys index zero. This would be the first one. So in theory, these should be two very similar values. Let's see. Whoa, I'm console logging v in too many places. 64, 78, 250, 253, 69, 84. So that makes sense. That's pretty close. You know, 172, 189. Right, so this looks right. If I sorted it the other way. I can never remember which way the sorting works so I just try it both ways. If I sort it the other way you'll see I'm getting the furthest thing, the color that's the most different, okay. So now. What I'm going to do is I'm going to add a draw loop. And now this function I want it to return keys index zero. I just want to get the closest one. And so what I'm going to do is I, in draw, I'm going to say findNearest. And then I'm going to create a div with that color in it. I'm going to say call it colorName. 'Cause I don't want to override the color variable, colorName. And then I'm going to say, let r equal p5.Vector.random. Is it random3D that gives me a random vector? I think random3D will give me a random vector. And then I will say pos.add r. So this is random walk. I'm just going to randomly change that vector and create a div for a new color name. And let's change the frameRate to like one so it does this once per second. And let's take a look. So look at this. This is my random walk. You can see that it's not getting very far away. It started with sepia. So I should probably take a bigger step, right. The step is so small that it's mostly wandering around the same color. There aren't that many colors. So I'm going to say r.multiply by 10. So I'm going to make that step much bigger. (Daniel laughing) Ah, it changed, oh okay. Boy, let's try this one more time. Let's make it much bigger. We can go a little faster. There we go. So we can see now I'm walking around. There should be like each one of these steps is a fairly similar color to the previous one. So this is the idea. I'm performing a mathematical operation in vector space, walking around a 3D vector. I'm finding the word that is most closely associated with that one by Euclidean distance, and then I am rendering that word on the screen. Before I move on, let's actually just test something. Like let's say for example I want to instead of... 'Cause it's random, just to make sure this is really doing what we think. Let me start with like blue. So I am going to start with... Not color, sorry, createVector. I'm going to start with blue and let's see what we get. Primary blue, pure blue, true blue, pure blue, pure blue, primary blue. Now one thing, one thing that's an issue is I shouldn't, I really can't allow negative numbers. 'Cause if I'm wandering off to negative land, there's no negative numbers in my data set. So probably to make this a bit more accurate in terms of this random walk. Where do I have that, in draw? It's right here. I probably want to say, pos.x. There's probably a more thoughtful way of doing this. Equals, um. Oh, I could I see. This I could, equals. I need to stay in sort of positive land. So constrain pox.x between zero and 255. Or I could do like an absolute value or something of the vector. That would be weird. But let's just do this. There's like a sort of a quick solution. So this'll keep me in that space. And let's run this again. So even though I start with primary blue, you can see I start walking around and getting... I'm going to end up somewhere else eventually. But these colors are related as I'm going. Okay, so this is working pretty well the way I imagined it. And of course. (bell dinging) Steve and meiamsahme, both with chatter like uh hello, set the text to that color. So let's do that. So that I think will be more interesting. So where I create the div, where do I do that. I create the div here. And I'm going to say, let div equal createDiv. And I'm just going to use the p5 DOM library and say style, backgroundcolor, oh. Backgroundcolor. Now too bad I didn't keep that hex code. 'Cause if I kept the hex code, I could put it right there. I could just say, I'm going to use a template literal rgb. What is it? The vector is vectors, colorName. 'Cause I just returned it. I just returned the key. So I probably should, I could have returned the whole vector. So many ways you could do this, ah. And now, rgb red, yeah no v.x. Okay this is easy. This is a fine way to do it. This is like the CSS syntax. v.y, v.z. All right, let's try this. And that should do the trick. All right, here we go. Oh, I put the background color. All right, I meant to set the text color, but. How do I set the text color? Color, should probably just color. There we go, okay. So now we can see really how it's also, we can see how this is a random walk through a color space. And I would love to let this go for a little while and end up somewhere. Okay, so Allison Parrish in her tutorial actually does something very similar to this. And I might as an exercise suggest doing this. She actually takes this poem, this idea of a poem, roses are red, violets are blue, and walks through the color space for each of these. I've done just a little piece of that. So what kind of creative idea can you do visualizing this three dimensional color space through words, through color, through a random walk? I think I should do one more. I'm not sure. Yeah, I think I'm going to try to do one more demonstration with this data set and I'll do that in a separate video, and then I will come back and actually finally go to the point where we look at what does it mean to take a pretrained set of word embeddings that's actually used the word2vec machine learning model, training process. Okay, see you there. (bell dinging) (upbeat techno music) (bell dinging)