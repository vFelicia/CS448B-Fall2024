With timestamps:

00:00 - hi there on today's episode of coding
00:02 - together the future of computer graphics
00:09 - [Music]
00:22 - I am going to attempt to render a
00:25 - three-dimensional rotating cube right
00:27 - here on the screen of this apple two
00:29 - plus computer I'm gonna see if I can
00:30 - program it all in basic but before I get
00:33 - started I would love to highlight some
00:35 - of the wonderful messages I've been
00:37 - receiving from viewers just like you
00:39 - Kelly Murphy writes the variable name
00:42 - link used by Apple basic is two
00:45 - characters
00:46 - what does this mean exactly let me write
00:48 - a little program here with a variable
00:50 - called start X
00:51 - and then maybe a variable called start y
00:59 - if I print the both out I should see
01:01 - what 10 and then 50.
01:03 - but I only see 50. this is because what
01:06 - the computer is storing is the actual
01:08 - variable name is just those first two
01:10 - characters St David frischneck writes I
01:13 - remember typing in a mandelbrot plotting
01:16 - program listing from a copy of Insider
01:18 - magazine and letting it run all day
01:20 - while I was at school I too have been
01:22 - working on a mandelbrot plotting program
01:24 - on the Apple II plus and I'm going to
01:26 - show you a time lapse of it running
01:27 - right now it's so beautiful many of you
01:30 - also mentioned beagle Brothers basic
01:33 - which was an enhancement utility for an
01:35 - apple 2E or a 2 or 2 plus with an
01:38 - additional RAM card one of my favorite
01:40 - enhancements that beagle basic has is a
01:42 - swap command which will swap two
01:45 - variables and it even includes elf many
01:48 - of you commented on how there is a way
01:51 - to edit a line of code you've already
01:54 - written other than retyping the whole
01:56 - thing Mark Miller explains it as what I
01:59 - remember is you had to hit escape and
02:01 - then basic would allow you to use the IJ
02:03 - AK and M keys on the keyboard to move
02:06 - the cursor around to the line you wanted
02:08 - to edit okay so I think what I need to
02:12 - do is I need to hit Escape
02:15 - move up with I I've got to now press J
02:19 - to move over the one and then I can't
02:22 - use JK to move across the characters I
02:25 - have to now switch to the arrow key well
02:27 - first I press escape to get out of
02:28 - moving the cursor then I press the arrow
02:31 - key all the way over here now I could
02:33 - change this number to 25 now I could hit
02:36 - enter
02:37 - home list
02:40 - here we go I've edited a line of Code by
02:45 - Piper
02:47 - Mark Miller this is going to improve my
02:49 - life as a programmer tremendously I
02:52 - should also mention that I have since
02:54 - acquired something very exciting you'll
02:56 - notice here that I have these beautiful
02:58 - disk drives and countless of my old
03:00 - floppies super text Daniel schiffman
03:03 - December 4th 1982.
03:06 - beagle basic there it is this is my
03:09 - fifth grade science project
03:11 - she tried to load this and see if I
03:13 - could get it to run unfortunately I
03:15 - haven't been able to get these disk
03:17 - drives to work so I would really like to
03:19 - restore them to access what's on these
03:21 - discs but in the meantime I have
03:24 - acquired from Big Mess oh wires
03:27 - something called the floppy emu the
03:29 - floppy emu here is a device that takes
03:33 - an SD card that I can load any Apple II
03:37 - disk image onto and I can also write to
03:40 - it so I can load programs and write to
03:42 - it and on this SD card I basically can
03:44 - store the equivalent of thousands of
03:46 - floppy disks and it has a little menu
03:48 - here so if I go to Apple 2 stuff I'm
03:52 - going to go to five and a quarter inch
03:54 - discs let's go to games let's try
03:57 - Frogger and now you can see Frogger is
03:59 - loaded in to the floppy emu in the same
04:03 - equivalent way that it would be for a
04:05 - disc I'm going to restart the computer
04:09 - I can see here that it is reading
04:12 - Frogger we've got the start screen here
04:15 - space to play
04:24 - and here we go
04:38 - I am the king of Frogger maybe I'll
04:41 - start streaming these games over on my
04:43 - twitch Channel I am going to go over
04:46 - here and go to Apple II stuff five and a
04:49 - quarter inch disc and I've made a little
04:51 - folder myself called shift men and I've
04:53 - got a Dos sample disk that loads a bunch
04:56 - of sample programs and will allow me to
04:58 - save whatever code I write today onto
05:02 - this SD card and release it to all of
05:04 - you the first thing I want to talk about
05:06 - is double buffered animation now I've
05:09 - talked about this a bit in previous
05:10 - videos and we did something like this in
05:14 - my bouncing ball in basic example right
05:17 - every time I move the ball the rectangle
05:19 - to the next location I had to erase the
05:22 - previous one so we wouldn't see the
05:23 - trail of it we just see this rectangle
05:25 - moving from spot A to B to C to D Etc
05:28 - most P5 or processing sketches have a
05:31 - draw Loop happens over and over again at
05:33 - the beginning of draw the background
05:35 - function is called to erase the
05:36 - background the stuff is drawn when it
05:38 - Loops back background is erased again
05:40 - stuff is drawn background draw
05:42 - background draw background draw but we
05:44 - don't see that flickering of background
05:46 - then put the shapes this is because
05:48 - double buffered animation happens behind
05:50 - the scenes the screen is not actually
05:52 - updated until the end of the draw Loop
05:55 - so all of that stuff is happening in an
05:57 - off-screen buffer that then all at once
05:59 - gets put to the screen for you to see if
06:02 - I want that same functionality in an
06:05 - applesoft basic program I've got to
06:06 - implement that double buffering myself
06:08 - so let me find where in my manual here
06:12 - or maybe in this tutorial where I can
06:15 - find some information about it aha I
06:18 - have found the part of the manual that I
06:20 - need commands affecting Graphics so I
06:23 - know that the Apple 2 plus in memory has
06:26 - two pages for high resolution Graphics
06:29 - so one of those pages can be off screen
06:32 - and I can draw to it and then when I put
06:34 - that one onto the screen I can start
06:36 - using the other page then I can swap
06:38 - them and that's how I'm going to
06:39 - implement this I can poke the memory
06:42 - address to show one page versus the
06:45 - other so the first thing that I want to
06:47 - do is start a new program that both
06:50 - initializes high resolution Graphics
06:52 - page one and high resolution Graphics
06:54 - page two
07:00 - great there's the line now what if what
07:03 - I want to do is animate the line moving
07:05 - across there's one more step that I need
07:09 - and it's here on this beagle Brothers
07:11 - poster for selecting which plotting page
07:14 - I'm going to draw to I need to poke
07:17 - address 230 32 page 1 64 page two I've
07:23 - also printed out for myself a little
07:25 - reference with all the correct poke
07:27 - addresses that I need let's think about
07:29 - how we're going to adapt this program to
07:31 - have a line animating across with double
07:34 - buffered animation let's actually start
07:36 - over for a second
07:39 - foreign
07:42 - how high is the screen again 192 pixels
07:46 - I think
07:51 - so here's a program that should start by
07:54 - plotting a line moving X and doing that
07:56 - over and over again
07:58 - whoops oh H plot
08:03 - 192 is correct
08:05 - because it's 192 pixels high but it's
08:08 - zero to 191 what am I thinking
08:15 - there we go so now this line is
08:17 - animating across the screen if I wanted
08:20 - to erase the previous line I could go
08:23 - ahead and do that ultimately my future
08:25 - goal is to draw this elaborate Cube and
08:29 - I know this is not going to be very
08:30 - efficient and it will probably slow down
08:33 - the program enormously but when I draw
08:36 - the cube I'd rather not individually
08:38 - erase each line I'd rather just wipe the
08:41 - whole page and I can do that with a call
08:44 - call negative 3086
08:47 - clear high-res screen to Black so that's
08:50 - what I want to do and the positive
08:53 - integer value of that is 62450 so I'm
08:57 - going to in line 25 say call 62450
09:03 - and then let's go to 25.
09:07 - now this is not double buffered
09:10 - animation this is exactly the problem
09:12 - we're seeing it clear draw clear draw
09:15 - now we need to figure out how to do this
09:18 - process on two separate pages I'm going
09:20 - to have a variable keep track of which
09:23 - page we're on or which screen so let's
09:25 - call it SC
09:27 - and we're going to think of it as screen
09:29 - zero and Screen one so what if I were to
09:33 - write a subroutine
09:35 - where the very first thing in a
09:37 - subroutine I do is show the page that
09:41 - I'm on actually the thing is I've done
09:43 - this before so I know what I need to do
09:46 - in this subroutine is actually show the
09:49 - other page because I want this
09:51 - subroutine to be the subroutine that
09:53 - swaps so I'm thinking about it I've
09:55 - already drawn it off screen now I want
09:57 - to show that other page and start
09:59 - working with the other other page
10:02 - this will make sense so I'm gonna say
10:05 - poke so it's either 49236 or 49237 those
10:11 - are two integers that are separated by
10:13 - one my screen is either zero or one and
10:16 - by the way I can turn zero into one or
10:18 - one into Zero by saying not screened
10:21 - because on the Apple 2 plus false to
10:24 - zero true is one so not one is zero not
10:28 - zero is one so poke four nine two three
10:32 - six plus not SC comma zero so this will
10:38 - display the screen that is not the value
10:42 - of the variable SC and then I need to
10:45 - poke memory address two three zero and
10:47 - then going back to setting the page that
10:51 - I'm plotting on so it's either 32 or 64
10:54 - which is the same as 32 plus 32 times SC
11:00 - right because if SC is zero that will be
11:02 - 32 if SC is 1 that'll be 32 plus 32
11:06 - which is 64. then the what I'll do in
11:09 - this subroutine is clear that one call
11:12 - six two four five zero
11:16 - okay let's look at our program so get
11:18 - rid of 25 and I need a return
11:20 - [Applause]
11:22 - so this subroutine starting a line 1000
11:25 - is just switching which screen we're
11:26 - drawing to so presumably I will do that
11:29 - at line 50.
11:31 - and then on line 60 I can go to 30 and
11:35 - draw again let's just see what happens
11:37 - if I run this
11:39 - hello so what's happening here I'm just
11:42 - seeing one line that's because the value
11:44 - of SC never changes so I start with
11:47 - screen zero I draw the line and then I
11:49 - switch to drawing on the other screen
11:51 - but I never switched back so somewhere
11:53 - in there I need to swap screens
11:57 - after I draw
11:58 - yeah
12:00 - right before I go to 1000
12:05 - ah look at that look at it beautifully
12:08 - moving across with no flicker it's just
12:11 - very very very slow this does not bode
12:15 - well for my Cube now I sort of feel like
12:18 - the way that I've done this it's silly
12:20 - to have this s sequel not SC be not part
12:24 - of the subroutine but I'm sad that I
12:26 - made this first line of the subroutine
12:28 - line 1000 would it be silly for me to do
12:31 - this I don't like this at all
12:36 - so my draw Loop in processing terms is
12:39 - essentially lines 30 and 40. so you know
12:43 - if I want to like really have this be
12:44 - more like ah be more like processing
12:47 - bear with me let me retype some of this
12:49 - [Music]
12:50 - [Applause]
12:51 - [Music]
12:53 - look at me editing
12:56 - that's right
12:57 - to edit that line yes
13:02 - then line 25 would be call what's the
13:07 - address to erase again six two four five
13:09 - zero
13:13 - this now is my draw Loop erase the
13:17 - background draw a line move X then I
13:21 - need to go and oh 999 is no longer go
13:25 - sub 1000
13:27 - then this is the line of code that's
13:30 - invisible in processing a P5 the thing
13:33 - that goes in swaps the buffers which I
13:35 - do there come back and then repeat the
13:38 - draw Loop that's got to be you got to
13:40 - erase the background so 60 should be go
13:42 - to 25. all right here we go
13:47 - it's still running really slow
13:49 - but I'm so excited that we have double
13:51 - buffered animations this is amazing I
13:54 - think we're gonna need this book
13:55 - programming the 6502 so basic is a
14:00 - language that's fun to use and really
14:01 - easy for me to demonstrate and explain
14:03 - but to squeeze out the efficiency of
14:07 - this computer I'm probably going to need
14:09 - to start looking at Assembly Language I
14:12 - have a feeling also and I'll show you a
14:14 - version of this that if I were to just
14:16 - erase that single line instead of
14:18 - clearing the whole Graphics buffer it
14:20 - would also run a lot faster but that
14:22 - seems like way too much work for me we
14:24 - are however ready now to see if we can
14:27 - start applying some 3D transformations
14:30 - to this line and probably see it run
14:34 - really slow and then can we make a cube
14:36 - out of a whole bunch of lines why not
14:38 - right so I'm going to remove right now
14:42 - uh everything from line 20 to line 60.
14:50 - and let's start by rotating a single
14:53 - line now I know that eventually I'm
14:56 - going to want to have a bunch of lines
14:59 - so even though I could just have X1 y1
15:01 - and X2 Y2 for a single line I'm going to
15:04 - have an array that is multi-dimensional
15:07 - that has two spots each with two values
15:12 - and then when I have two lines I'd have
15:14 - four spots each with two values so on
15:16 - line 20 I'm going to create an array
15:19 - we'll call it points that has two points
15:22 - in it each with two oh you know what
15:24 - three values because the whole idea of
15:26 - this is we're doing this in three
15:29 - dimensions now the other thing I want to
15:31 - do here is I want to think of the space
15:34 - of the window as zero zero being in the
15:36 - center so if I want to draw a horizontal
15:39 - line from a chord of the way to three
15:40 - quarters of the way my points would be
15:43 - points 0 comma zero which is X would be
15:47 - let's just consider this line to go from
15:50 - 0 zeros in the center and this line is
15:52 - going to go from negative one to one
15:53 - we'll scale it later
15:55 - zero comma one which would be the Y
15:58 - would equal zero because it's going to
16:00 - be in the center I wonder if this is
16:02 - eventually going to be a cube though
16:04 - let's have it be a line along the top of
16:06 - it so let's have that be negative one
16:08 - and then
16:10 - points 0 comma two which would be the Z
16:14 - we're just going to have the Z be zero
16:16 - so that's the first point the second
16:18 - point is going to be the same but the x
16:21 - value will be positive one
16:26 - foreign
16:33 - we'll start it at line 500 which draws
16:37 - whatever's in the points array no no no
16:39 - no no no let's have a subroutine that
16:42 - draws a line between any arbitrary two
16:45 - values in the points array in other
16:48 - words H plot and forget about the Z for
16:51 - a second points a comma zero points a
16:57 - comma one two and the a doesn't exist
17:00 - yet I'm going to add that in so this is
17:03 - X and Y of point a to the
17:07 - X
17:09 - and Y of point B
17:14 - then watch this on line 50 I can say a
17:20 - equals zero
17:22 - b equals one go sub 500. so this is
17:26 - essentially a way of having arguments to
17:29 - a subroutine I'm going to set two
17:31 - variables A and B right before I go to
17:33 - the subroutine that's drawing a line
17:35 - between a and b
17:37 - and then line 60 I'm I'm just gonna go
17:42 - to 50.
17:44 - just do it again we're not doing the
17:46 - swapping yet just want to see if this
17:48 - works oh no no no no no no no no no but
17:50 - I need to do the scaling oh okay so I
17:54 - need to do this a different way it's
17:55 - nice that I typed all that but
17:57 - essentially what I want to do in line
17:58 - 500 is say X1 is a
18:02 - zero and then I'm going to multiply it
18:05 - by some scaling value let's use SZ
18:09 - plus half of the width which is what was
18:12 - the width again 280 so plus 140 I
18:16 - probably should put that in a variable
18:18 - Center X we're going to have that be a
18:20 - variable so times the size so negative 1
18:24 - becomes whatever size it's like negative
18:26 - 1 is 50. so negative 50 plus whatever
18:30 - that Center offset is so that would be
18:32 - over here okay that's X1
18:38 - the center y
18:42 - [Music]
18:49 - then I can just say h plot X1 y1 to oh
18:55 - no X2 Y2 all right everybody ready for
18:58 - some editing
18:59 - [Music]
19:05 - then 550 is a return I think this is
19:08 - good oh but I need these variables now
19:10 - let's just at the very beginning uh line
19:13 - 12 let's just use 50 pixels for the size
19:16 - Center X is 140 and Center Y is half of
19:22 - 192.
19:26 - oh I've got a line there I must have
19:29 - messed something up oh no boy this has
19:32 - been a mistake for a very long time all
19:35 - right ready everybody this is to be
19:37 - index one
19:38 - I initialized the zero element of this
19:42 - array twice I'm gonna retype it
19:51 - okay that looks good let's run this
19:54 - there we go
19:56 - congratulations you've watched 45
19:59 - minutes of somebody on YouTube drawing a
20:01 - line so we're in really good shape here
20:04 - the bulk of the work is just going to be
20:06 - typing out a lot more coordinates and
20:09 - then writing a loop to go through and
20:11 - draw all the lines connecting all the
20:13 - coordinates but before we do that there
20:15 - is one step here which is what if I want
20:18 - to see this Cube that I'm going to draw
20:21 - or whatever the shape is or rotate and
20:23 - there is no unlike in processor P5
20:26 - translate and rotate and push and pop so
20:29 - I'm going to need to do that with the
20:32 - math behind rotation itself this is
20:35 - something that I've covered extensively
20:37 - in another video where I did 3D
20:40 - rendering in a 2d renderer by writing
20:43 - all of the Matrix math I'm not going to
20:45 - rehash all that in this video but I do
20:48 - want to show you the basic math behind
20:51 - rotation
20:53 - foreign
20:55 - let's say we have a Cartesian plane
21:00 - and we have some point
21:03 - X comma Y in that Cartesian space we can
21:07 - think of that point
21:09 - relative to the origin and rotate about
21:13 - the origin by some angle called Theta
21:17 - and it would end up over here this would
21:19 - be the new X and Y position I've
21:22 - demonstrated how to do this in previous
21:24 - videos looking at the concept of polar
21:26 - coordinates ultimately the way to apply
21:29 - this kind of 2D rotation transformation
21:32 - is with Matrix math
21:41 - foreign
21:42 - this rotation Matrix rotates the point x
21:46 - y counterclockwise according to the
21:50 - angle Theta the X Y point is written as
21:54 - a column vector and the new point is the
21:57 - result of that Vector multiplied by the
22:00 - rotation Matrix we're going to get a new
22:03 - single column vector
22:06 - and the first element the new X is x
22:09 - times cosine of theta
22:12 - plus y times minus sine Theta
22:16 - then the new y position is x times sine
22:20 - of theta
22:21 - plus x times cosine of theta
22:25 - notice how if X and Y was the point 0 0
22:29 - the new point would be zero zero because
22:31 - rotating 0 0 around 0 0 the point stays
22:34 - the same this is not applying any kind
22:36 - of translation only a rotation
22:39 - counterclockwise by the angle Theta in
22:41 - the context of computer Graphics we
22:43 - might be going clockwise because the
22:44 - y-axis is flipped in three dimensions we
22:47 - don't just have a single plane and a
22:48 - single angle if we apply a rotation we
22:51 - need to know around what axis X Y or Z
22:54 - interestingly enough this is actually
22:57 - the rotation Matrix for the z-axis only
23:02 - we need to extend it out to account for
23:05 - Z
23:10 - so to get the new X we would say x times
23:12 - cosine of theta plus y times negative
23:15 - sine of theta plus Z times zero the new
23:17 - y x times sine plus y times cosine plus
23:21 - Z times zero and then the new Z is x
23:24 - times 0 plus y times zero plus Z times
23:26 - one so Z does not rotate around the Z
23:29 - axis we can look at the rotation Matrix
23:31 - for the y-axis
23:39 - as well as the rotation Matrix for the
23:41 - x-axis
23:48 - now that we've covered what the math is
23:51 - the things that I need to add to this
23:54 - program are a variable for the angle
23:56 - that I'm going to rotate we'll start
23:57 - with just rotating along the z-axis as
24:00 - well as a whole second set of points
24:04 - because I need another variable to apply
24:08 - that transformation into so right at
24:11 - line 25
24:13 - let's go rotation Z points RZT and we're
24:18 - gonna have two of them and there they
24:20 - have an x y and z Oh my goodness I did
24:22 - forget an important step which is once
24:24 - I've rotated the point in three
24:26 - dimensions I need to project it into two
24:29 - Dimensions to draw the correct X and Y
24:31 - but guess what I'm just going to use the
24:34 - simple way of doing that by taking off
24:36 - the Z so it won't be perspective it'll
24:38 - be orthographic but it'll be good enough
24:41 - for us right now now I have a whole
24:43 - separate array for the rotated points
24:46 - line 50 is where I'm drawing so in line
24:50 - 55 let's do another subroutine
24:54 - two thousand
24:55 - and that's where I'll apply the rotation
24:58 - math we just went through
25:00 - so 4 n equals 0 2 and I just have two
25:05 - points right now there's two points in
25:07 - the array oh I forgot about an angle
25:12 - running out of lines of code here at the
25:14 - beginning but let's do a line 18 an
25:17 - angle do I dare no I can't use a because
25:20 - I use that here I could use angle the
25:22 - word angle angle equals
25:25 - zero then line 2000 to 2010 the rotation
25:30 - point for Z
25:33 - of I the x value equals so
25:37 - [Music]
25:40 - I need to use cosine of theta but as
25:44 - soon as I go to do I comma 1 the Y value
25:47 - I'm going to want to use cosine of theta
25:49 - again and I don't want to calculate that
25:51 - twice so actually what I should do even
25:54 - before I do the loop in line 2000 is say
25:58 - CS for cosine of theta is cosine of and
26:02 - it's not Theta I called it angle sorry
26:04 - and SN for sine is sine of that angle
26:09 - now I could do that Loop for n equals 0
26:14 - to 1 and then r z p right the rotation Z
26:20 - point x o n for the end point x equals
26:25 - negative cosine you might notice that my
26:29 - original Matrix had positive cosine
26:31 - Theta and yet I just typed negative
26:33 - cosine Theta I'm also going to type
26:35 - positive sine instead of negative sign
26:37 - this is because in the graphics world of
26:40 - the Apple II plus y points down the
26:43 - pixels are positive in the downward
26:44 - Direction and I want it to match y
26:47 - pointing up so I've just swapped the
26:49 - sign there and the rotation happens in
26:51 - the correct direction who's to say
26:53 - what's correct anyway though as long as
26:55 - I'm consistent but I just want to let
26:56 - you know that's why that changed times x
27:00 - which is point zero plus
27:03 - sine
27:05 - times
27:06 - Y which is one plus Z times zero now
27:11 - since I'm multiplying by zero you don't
27:14 - need to have that operation in there
27:15 - probably should just leave it out but I
27:17 - feel like just to have the math be
27:19 - consistent I should say zero times
27:22 - points n comma two then let's do the Y
27:29 - y equals sine of theta times X plus
27:35 - cosine times y plus zero times points
27:41 - times Z
27:44 - and then you know to be consistent
27:47 - I should do the Z which is just zero
27:52 - times x
27:54 - again this is a lot of extra stuff zero
27:57 - times y
28:00 - plus one times Z
28:04 - next n to go on to the next point now
28:10 - the question is where in the code do I
28:13 - want to apply this rotation so right
28:15 - here starting at line 50 that's
28:16 - essentially my draw Loop draw the line
28:19 - rotate the point then go back and do it
28:22 - again draw the line rotate draw the line
28:23 - rotate but I'm missing the swap the
28:25 - buffers and there's another issue that
28:27 - I'm thinking about so let's clean up our
28:30 - code a little bit refactor if you will
28:32 - and start putting a proper draw loop at
28:36 - line 100. I'm even going to use some
28:38 - comments here draw Loop
28:40 - the first thing in the draw Loop should
28:43 - be rotate the line
28:46 - then draw the line
28:49 - I should probably put remarks on all of
28:50 - these but
28:52 - I don't got a lot of time right now
28:55 - then swap the buffers
28:58 - which is the subroutine at one thousand
29:02 - that's what a comment would look like
29:03 - let's put it in for the ghost Subs
29:06 - oh oops ah
29:12 - rotate the points draw the line swap the
29:15 - buffer
29:17 - and start over all right let's see what
29:19 - happens if we run this
29:21 - great we've got the line it's not
29:23 - rotating why because I didn't increase
29:25 - the angle so on line 140 angle equals
29:29 - angle plus 0.1 and then line 150 go to
29:33 - 100. Aha
29:36 - it's still not working I know why do you
29:39 - know why think about it let's go to that
29:42 - subroutine at line 500.
29:45 - this is where I take point a and point B
29:49 - and connect them by plotting a line but
29:51 - I'm looking up the location of index A
29:55 - and B in the points array and the
29:57 - rotated values are in the rzp array
30:00 - rotated by Z points rzp if only there
30:05 - were some generic way for me to pass an
30:07 - argument I don't think this is going to
30:09 - work I know it's not going to work
30:11 - because I just tried to do it for like a
30:12 - half an hour so I'm just going to hard
30:14 - code in the rotated Z array and we'll
30:18 - see later if I have to do multiple
30:19 - rotation time I'm going to handle that
30:21 - and guess what Now's the Time for a
30:24 - beautiful fancy editing
30:27 - Escape all the way over and then r z p
30:31 - and then of course I have to Arrow over
30:33 - to the episode line go do something else
30:36 - for a little while it'll be it'll be a
30:37 - bit
30:38 - [Music]
30:51 - looks good
30:54 - okay so there's a nice little Point all
30:56 - of a sudden that happened here this is
30:58 - not working
31:00 - oh my goodness
31:02 - I made a ridiculous mistake look at this
31:04 - I left my old draw Loop in there the one
31:07 - that is not applying the rotation or
31:10 - doing anything so I've got to get rid of
31:11 - that 50 55 60. now I just pray here oh
31:16 - oh wow oh
31:21 - I believe the first swapping is not
31:23 - working but I don't I don't care because
31:25 - that is totally awesome
31:28 - thank you I'm done I'm out of here it's
31:31 - the end of this video you figure it out
31:33 - yourself
31:34 - why did the buffer swap not work look at
31:38 - some of my reference research here
31:41 - oh my goodness and it was running so
31:44 - fast you know why I forgot to have the
31:46 - clear the background step
31:49 - should the clear the background be part
31:51 - of the swapping of the buffer I don't
31:53 - think so because ultimately it's really
31:55 - part of the draw Loop
31:57 - yeah I like swapping the buffer at the
32:00 - end so 150
32:02 - swap the buffer 160 go to 100 and then
32:06 - what I'm missing there at 105 is not
32:09 - swapping the buffer it is call the erase
32:12 - the background which is call 62450
32:17 - and this is gonna I think fix it but
32:19 - also make it run unbelievably slow
32:25 - that's not that bad actually to be
32:27 - perfectly honest there's my rotating in
32:30 - 3D line
32:34 - a whole Square that's rotating so now my
32:37 - points and my rotated Z points need to
32:40 - have four points in them
32:43 - four comma three four xyz's it's funny
32:46 - I'm not doing anything 3D but I will I
32:49 - will then let's do let's just change it
32:52 - now let's change it to a rotation by X
32:55 - so let's just do those all in one line
32:59 - do we want to see it rotate by let's do
33:01 - y let's do y
33:04 - so now when we're initializing the
33:06 - points which should probably be a
33:08 - subroutine because I'm going to run out
33:10 - of space but that's fine yeah I should
33:12 - that should be a dumb subroutine let's
33:14 - make that at um five thousand
33:17 - and I'm gonna do do all the points
33:23 - negative one negative one zero
33:31 - I should really use a z value since I
33:35 - have to fix that one anyway because if
33:37 - I'm eventually going to make a cube
33:38 - there's got to be
33:39 - Four Points in front and four points in
33:42 - back with like the center of the Cube
33:44 - It's the center of our 3D World
33:47 - so let's have let's draw a cube in front
33:50 - to start let's draw one in the back to
33:52 - start
33:53 - okay and then
33:56 - so I'm missing I call in there and then
34:01 - this should be negative one because it's
34:03 - important to have this D do something
34:08 - now I'm doing the third point the bottom
34:11 - right one one one one negative one
34:19 - foreign
34:21 - negative one one negative one
34:31 - whoops
34:36 - I hope this works
34:38 - [Applause]
34:44 - so instead of initializing the points
34:46 - here and line 30
34:49 - we're just gonna say go sub 5000 and
34:53 - then I forgot I need a return there so
34:55 - even if I run this ooh I was gonna say
34:58 - it should work with just the first two
34:59 - points
35:01 - syntax errand line 25.
35:03 - oh I forgot the dim
35:07 - I got so excited I forgot to type Den
35:09 - dim r-yp
35:13 - 4 comma three
35:16 - so exactly what we had before but now
35:19 - where is that where's my draw Loop oh so
35:24 - first rotating them all 2020 needs to be
35:26 - zero to three because there's four
35:29 - points and then 120. so now I'm gonna
35:33 - need a lot more things there so that
35:36 - should also be a sub 14. I mean that's a
35:38 - little bit nuts but that's fine do I
35:40 - have anything at six thousand no okay so
35:43 - six thousand
35:44 - draw lines oh REM draw lines
35:46 - [Applause]
35:48 - so first connect zero and one
35:51 - foreign
36:00 - then connect two and three
36:04 - then connect three and zero so I could
36:06 - do this in a loop but I just want to
36:08 - hard code it to know that it's right
36:12 - I'm also anticipating having a lot more
36:14 - points with a more elaborate shape and
36:16 - uh at this point right now I'd rather
36:18 - just type it all out
36:20 - and then 6050 return so that's my
36:25 - subroutine here to connect all those
36:28 - lines and let's go back to my draw Loop
36:31 - and instead of Line 120 being this we're
36:35 - going to say go sub 6000 REM lines
36:39 - okay I'd run this
36:43 - hey hey hey guess what we've got to make
36:45 - this make the 3D so I need to add rotate
36:47 - X you remember the Matrix math we did
36:50 - now we just need to add that in where
36:52 - does that happen where was that
36:53 - subroutine 2000
36:57 - so right after line 2050 that's where
37:00 - I've applied The Matrix rotations for a
37:02 - z rotation I just need to do the matrix
37:04 - multiplication for an X rotation a y
37:08 - rotation I mean a y rotation so let's
37:10 - wipe out 2060 and 2070 right now and
37:13 - 2060 would be ryp n comma 0 equals
37:19 - cosine 0 sine zero one zero negative
37:23 - sine zero cosine I think that's right
37:25 - [Music]
37:41 - then 20 90 would be next and true we
37:46 - should apply the Y rotation first I
37:49 - guess it's six of one half dozen to the
37:50 - other because now I'm gonna have to
37:51 - adjust the uh when I'm drawing the line
37:54 - oh whoops
37:55 - 2090 is next and 2100 is returned let's
37:58 - just run this it should we shouldn't see
38:00 - the Y rotation yet because I'm still
38:03 - just drawing the rzp points and you can
38:05 - see it's actually running
38:07 - I thought it would I'm quite impressed
38:08 - with the speed of this
38:11 - uh um but where is that that's here the
38:15 - subroutine of line 500
38:17 - I now
38:19 - need to change this again
38:21 - Talk Amongst yourselves
38:23 - [Music]
38:26 - foreign
38:30 - moment of truth I can't imagine that I
38:33 - didn't make a mistake but that's
38:34 - happening before let's just run it and
38:36 - see
38:40 - who where's it going
38:43 - goodbye where are you going I mean I see
38:45 - some kind of 3D rotation there I think
38:48 - it's because it is out from the center
38:50 - what it's doing is imagine it's this
38:52 - piece of paper what I'm doing is
38:54 - rotating it
38:55 - like this
38:58 - as well as doing this so it's really
39:00 - doing this
39:01 - which I think is what I'm seeing let me
39:03 - show it to you sped up
39:05 - [Music]
39:09 - very slow but working all that's left
39:12 - for me to do now is really a lot of
39:14 - typing I need to add four more points so
39:16 - to have all the points of a cube I need
39:19 - to draw eight more lines so we see the
39:21 - full cube and then maybe if I feel a
39:23 - little Saucy I might like to add the
39:26 - x-axis rotation we'll see step one
39:29 - increase the size of my arrays I realize
39:33 - I did something a little wonky here it's
39:35 - correct in that I have four points and
39:37 - three dimensions but the index values
39:40 - are zero one two three and zero one two
39:43 - and applesoft basic expects me to put
39:46 - not the length of the array but the
39:47 - maximum index which is weird but that's
39:49 - how it wants it to be let's correct it
39:51 - as I expand it
39:53 - oh that looks wrong but seven comma two
39:57 - is a two-dimensional array eight by
40:00 - three
40:05 - let's add an X rotation
40:10 - my arrays are bigger now where do I
40:12 - initialize them I think in the
40:14 - subroutine at five thousand
40:17 - Yep this is where I initialize 0 1 2 3.
40:21 - let's keep going I have what might be a
40:24 - clever idea instead of typing four more
40:27 - lines of code I can edit these lines of
40:29 - code changing the line number the array
40:32 - index and the Z location right these are
40:35 - the four points at the back of the cube
40:37 - negative one to the Four Points at the
40:39 - front of the cube positive one
40:44 - foreign
40:47 - index four
40:48 - [Music]
40:50 - who knows if this is actually any better
40:52 - but it is going to work I think
40:55 - oh there's a bracket there I have to get
40:58 - rid of
41:07 - let's see if that works
41:10 - I think I got it I have now all the
41:13 - points of the cube in my array where do
41:16 - I process those points
41:19 - the subroutine at 2000 is where I rotate
41:22 - them
41:23 - for once I've actually done something in
41:25 - a way that makes this really easy to
41:27 - edit the only thing I need to change
41:29 - here is the loop now goes instead of
41:31 - from zero to three to from zero to seven
41:37 - now that I'm storing all the points
41:39 - processing all the points I need to draw
41:42 - all of the lines to connect the full
41:45 - cube that happens in subroutine line
41:48 - 6000.
41:51 - so I need to connect the back of the
41:53 - cube
41:53 - [Music]
42:01 - and then I need to connect the corners
42:04 - of the back to the corners of the front
42:06 - [Music]
42:13 - there we go great exercise for any of
42:15 - you watching is what's an algorithm you
42:17 - could design to do this in some kind of
42:19 - nice Loop and I've forgotten the return
42:21 - which is very important
42:26 - uh oh
42:28 - I I made a mistake with certain lines
42:31 - that I've connected let's check that out
42:33 - wow this is kind of cool though I made a
42:35 - weird shape I must have messed up my
42:37 - point definitions
42:42 - ah I have found the culprit
42:45 - I have a index off here in this line 50
42:49 - 60. it is index six and I left the two
42:53 - there
42:55 - foreign
42:59 - [Applause]
43:03 - rotate now
43:09 - look at that beautiful three-dimensional
43:12 - orthogonal Cube I feel like the x-axis
43:16 - is feeling left out let's add rotation
43:18 - around that axis
43:22 - I'm not going to add all that multiply
43:23 - by zero this time let's just do it the
43:26 - simplified way
43:35 - then I need next n and return
43:41 - all right all three axes
43:44 - [Music]
43:50 - there are some ways I could get this to
43:52 - run faster
43:53 - sure I could look into programming with
43:55 - Assembly Language but are there even
43:58 - some things that I could do in the code
44:00 - to optimize it would not using the call
44:03 - to wipe the graphics background and
44:05 - instead erase the individual lines be
44:07 - faster what about pre-computing all the
44:10 - values of sine and cosine that I might
44:12 - need and storing them in a big array a
44:13 - lookup table essentially this would also
44:16 - have the advantage of allowing me to
44:17 - maybe use different angles for each of
44:19 - the axes to get a more complex rotation
44:23 - I would love to hear from you how would
44:25 - you optimize this code I will include a
44:27 - link to an emulator and this code that
44:29 - you could run there and try out
44:31 - different ideas and if you've got
44:33 - something let me know in the comments I
44:35 - will definitely address it in a future
44:36 - video or live stream another challenge
44:38 - I'd love to offer you is to add
44:41 - perspective projection this is kind of
44:43 - flat because it's orthographic
44:45 - projection and the math for doing that
44:47 - it's all described in my 3D rendering
44:50 - processing video and I will include
44:52 - information about how to do that in the
44:54 - video description see if you can get
44:55 - that to work I'll show you what it looks
44:57 - like also over here
44:58 - hope you enjoyed another episode of
45:00 - coding together what should I do in the
45:02 - next one I'm thinking what about music
45:04 - could I play a delightful tune here with
45:06 - my Apple 2 plus computer stay tuned and
45:10 - I'll see you next time on coding
45:11 - together oh and let's not forget to save
45:14 - our code
45:17 - disc full
45:18 - oh no
45:20 - no I've got 32 gigabytes on this SD card
45:22 - what are you talking about don't worry
45:24 - I'll have this figured out by the next
45:26 - time you're watching this video and the
45:27 - code will be linked in the description
45:28 - see you next time
45:31 - foreign
45:34 - [Music]

Cleaned transcript:

hi there on today's episode of coding together the future of computer graphics I am going to attempt to render a threedimensional rotating cube right here on the screen of this apple two plus computer I'm gonna see if I can program it all in basic but before I get started I would love to highlight some of the wonderful messages I've been receiving from viewers just like you Kelly Murphy writes the variable name link used by Apple basic is two characters what does this mean exactly let me write a little program here with a variable called start X and then maybe a variable called start y if I print the both out I should see what 10 and then 50. but I only see 50. this is because what the computer is storing is the actual variable name is just those first two characters St David frischneck writes I remember typing in a mandelbrot plotting program listing from a copy of Insider magazine and letting it run all day while I was at school I too have been working on a mandelbrot plotting program on the Apple II plus and I'm going to show you a time lapse of it running right now it's so beautiful many of you also mentioned beagle Brothers basic which was an enhancement utility for an apple 2E or a 2 or 2 plus with an additional RAM card one of my favorite enhancements that beagle basic has is a swap command which will swap two variables and it even includes elf many of you commented on how there is a way to edit a line of code you've already written other than retyping the whole thing Mark Miller explains it as what I remember is you had to hit escape and then basic would allow you to use the IJ AK and M keys on the keyboard to move the cursor around to the line you wanted to edit okay so I think what I need to do is I need to hit Escape move up with I I've got to now press J to move over the one and then I can't use JK to move across the characters I have to now switch to the arrow key well first I press escape to get out of moving the cursor then I press the arrow key all the way over here now I could change this number to 25 now I could hit enter home list here we go I've edited a line of Code by Piper Mark Miller this is going to improve my life as a programmer tremendously I should also mention that I have since acquired something very exciting you'll notice here that I have these beautiful disk drives and countless of my old floppies super text Daniel schiffman December 4th 1982. beagle basic there it is this is my fifth grade science project she tried to load this and see if I could get it to run unfortunately I haven't been able to get these disk drives to work so I would really like to restore them to access what's on these discs but in the meantime I have acquired from Big Mess oh wires something called the floppy emu the floppy emu here is a device that takes an SD card that I can load any Apple II disk image onto and I can also write to it so I can load programs and write to it and on this SD card I basically can store the equivalent of thousands of floppy disks and it has a little menu here so if I go to Apple 2 stuff I'm going to go to five and a quarter inch discs let's go to games let's try Frogger and now you can see Frogger is loaded in to the floppy emu in the same equivalent way that it would be for a disc I'm going to restart the computer I can see here that it is reading Frogger we've got the start screen here space to play and here we go I am the king of Frogger maybe I'll start streaming these games over on my twitch Channel I am going to go over here and go to Apple II stuff five and a quarter inch disc and I've made a little folder myself called shift men and I've got a Dos sample disk that loads a bunch of sample programs and will allow me to save whatever code I write today onto this SD card and release it to all of you the first thing I want to talk about is double buffered animation now I've talked about this a bit in previous videos and we did something like this in my bouncing ball in basic example right every time I move the ball the rectangle to the next location I had to erase the previous one so we wouldn't see the trail of it we just see this rectangle moving from spot A to B to C to D Etc most P5 or processing sketches have a draw Loop happens over and over again at the beginning of draw the background function is called to erase the background the stuff is drawn when it Loops back background is erased again stuff is drawn background draw background draw background draw but we don't see that flickering of background then put the shapes this is because double buffered animation happens behind the scenes the screen is not actually updated until the end of the draw Loop so all of that stuff is happening in an offscreen buffer that then all at once gets put to the screen for you to see if I want that same functionality in an applesoft basic program I've got to implement that double buffering myself so let me find where in my manual here or maybe in this tutorial where I can find some information about it aha I have found the part of the manual that I need commands affecting Graphics so I know that the Apple 2 plus in memory has two pages for high resolution Graphics so one of those pages can be off screen and I can draw to it and then when I put that one onto the screen I can start using the other page then I can swap them and that's how I'm going to implement this I can poke the memory address to show one page versus the other so the first thing that I want to do is start a new program that both initializes high resolution Graphics page one and high resolution Graphics page two great there's the line now what if what I want to do is animate the line moving across there's one more step that I need and it's here on this beagle Brothers poster for selecting which plotting page I'm going to draw to I need to poke address 230 32 page 1 64 page two I've also printed out for myself a little reference with all the correct poke addresses that I need let's think about how we're going to adapt this program to have a line animating across with double buffered animation let's actually start over for a second foreign how high is the screen again 192 pixels I think so here's a program that should start by plotting a line moving X and doing that over and over again whoops oh H plot 192 is correct because it's 192 pixels high but it's zero to 191 what am I thinking there we go so now this line is animating across the screen if I wanted to erase the previous line I could go ahead and do that ultimately my future goal is to draw this elaborate Cube and I know this is not going to be very efficient and it will probably slow down the program enormously but when I draw the cube I'd rather not individually erase each line I'd rather just wipe the whole page and I can do that with a call call negative 3086 clear highres screen to Black so that's what I want to do and the positive integer value of that is 62450 so I'm going to in line 25 say call 62450 and then let's go to 25. now this is not double buffered animation this is exactly the problem we're seeing it clear draw clear draw now we need to figure out how to do this process on two separate pages I'm going to have a variable keep track of which page we're on or which screen so let's call it SC and we're going to think of it as screen zero and Screen one so what if I were to write a subroutine where the very first thing in a subroutine I do is show the page that I'm on actually the thing is I've done this before so I know what I need to do in this subroutine is actually show the other page because I want this subroutine to be the subroutine that swaps so I'm thinking about it I've already drawn it off screen now I want to show that other page and start working with the other other page this will make sense so I'm gonna say poke so it's either 49236 or 49237 those are two integers that are separated by one my screen is either zero or one and by the way I can turn zero into one or one into Zero by saying not screened because on the Apple 2 plus false to zero true is one so not one is zero not zero is one so poke four nine two three six plus not SC comma zero so this will display the screen that is not the value of the variable SC and then I need to poke memory address two three zero and then going back to setting the page that I'm plotting on so it's either 32 or 64 which is the same as 32 plus 32 times SC right because if SC is zero that will be 32 if SC is 1 that'll be 32 plus 32 which is 64. then the what I'll do in this subroutine is clear that one call six two four five zero okay let's look at our program so get rid of 25 and I need a return so this subroutine starting a line 1000 is just switching which screen we're drawing to so presumably I will do that at line 50. and then on line 60 I can go to 30 and draw again let's just see what happens if I run this hello so what's happening here I'm just seeing one line that's because the value of SC never changes so I start with screen zero I draw the line and then I switch to drawing on the other screen but I never switched back so somewhere in there I need to swap screens after I draw yeah right before I go to 1000 ah look at that look at it beautifully moving across with no flicker it's just very very very slow this does not bode well for my Cube now I sort of feel like the way that I've done this it's silly to have this s sequel not SC be not part of the subroutine but I'm sad that I made this first line of the subroutine line 1000 would it be silly for me to do this I don't like this at all so my draw Loop in processing terms is essentially lines 30 and 40. so you know if I want to like really have this be more like ah be more like processing bear with me let me retype some of this look at me editing that's right to edit that line yes then line 25 would be call what's the address to erase again six two four five zero this now is my draw Loop erase the background draw a line move X then I need to go and oh 999 is no longer go sub 1000 then this is the line of code that's invisible in processing a P5 the thing that goes in swaps the buffers which I do there come back and then repeat the draw Loop that's got to be you got to erase the background so 60 should be go to 25. all right here we go it's still running really slow but I'm so excited that we have double buffered animations this is amazing I think we're gonna need this book programming the 6502 so basic is a language that's fun to use and really easy for me to demonstrate and explain but to squeeze out the efficiency of this computer I'm probably going to need to start looking at Assembly Language I have a feeling also and I'll show you a version of this that if I were to just erase that single line instead of clearing the whole Graphics buffer it would also run a lot faster but that seems like way too much work for me we are however ready now to see if we can start applying some 3D transformations to this line and probably see it run really slow and then can we make a cube out of a whole bunch of lines why not right so I'm going to remove right now uh everything from line 20 to line 60. and let's start by rotating a single line now I know that eventually I'm going to want to have a bunch of lines so even though I could just have X1 y1 and X2 Y2 for a single line I'm going to have an array that is multidimensional that has two spots each with two values and then when I have two lines I'd have four spots each with two values so on line 20 I'm going to create an array we'll call it points that has two points in it each with two oh you know what three values because the whole idea of this is we're doing this in three dimensions now the other thing I want to do here is I want to think of the space of the window as zero zero being in the center so if I want to draw a horizontal line from a chord of the way to three quarters of the way my points would be points 0 comma zero which is X would be let's just consider this line to go from 0 zeros in the center and this line is going to go from negative one to one we'll scale it later zero comma one which would be the Y would equal zero because it's going to be in the center I wonder if this is eventually going to be a cube though let's have it be a line along the top of it so let's have that be negative one and then points 0 comma two which would be the Z we're just going to have the Z be zero so that's the first point the second point is going to be the same but the x value will be positive one foreign we'll start it at line 500 which draws whatever's in the points array no no no no no no let's have a subroutine that draws a line between any arbitrary two values in the points array in other words H plot and forget about the Z for a second points a comma zero points a comma one two and the a doesn't exist yet I'm going to add that in so this is X and Y of point a to the X and Y of point B then watch this on line 50 I can say a equals zero b equals one go sub 500. so this is essentially a way of having arguments to a subroutine I'm going to set two variables A and B right before I go to the subroutine that's drawing a line between a and b and then line 60 I'm I'm just gonna go to 50. just do it again we're not doing the swapping yet just want to see if this works oh no no no no no no no no no but I need to do the scaling oh okay so I need to do this a different way it's nice that I typed all that but essentially what I want to do in line 500 is say X1 is a zero and then I'm going to multiply it by some scaling value let's use SZ plus half of the width which is what was the width again 280 so plus 140 I probably should put that in a variable Center X we're going to have that be a variable so times the size so negative 1 becomes whatever size it's like negative 1 is 50. so negative 50 plus whatever that Center offset is so that would be over here okay that's X1 the center y then I can just say h plot X1 y1 to oh no X2 Y2 all right everybody ready for some editing then 550 is a return I think this is good oh but I need these variables now let's just at the very beginning uh line 12 let's just use 50 pixels for the size Center X is 140 and Center Y is half of 192. oh I've got a line there I must have messed something up oh no boy this has been a mistake for a very long time all right ready everybody this is to be index one I initialized the zero element of this array twice I'm gonna retype it okay that looks good let's run this there we go congratulations you've watched 45 minutes of somebody on YouTube drawing a line so we're in really good shape here the bulk of the work is just going to be typing out a lot more coordinates and then writing a loop to go through and draw all the lines connecting all the coordinates but before we do that there is one step here which is what if I want to see this Cube that I'm going to draw or whatever the shape is or rotate and there is no unlike in processor P5 translate and rotate and push and pop so I'm going to need to do that with the math behind rotation itself this is something that I've covered extensively in another video where I did 3D rendering in a 2d renderer by writing all of the Matrix math I'm not going to rehash all that in this video but I do want to show you the basic math behind rotation foreign let's say we have a Cartesian plane and we have some point X comma Y in that Cartesian space we can think of that point relative to the origin and rotate about the origin by some angle called Theta and it would end up over here this would be the new X and Y position I've demonstrated how to do this in previous videos looking at the concept of polar coordinates ultimately the way to apply this kind of 2D rotation transformation is with Matrix math foreign this rotation Matrix rotates the point x y counterclockwise according to the angle Theta the X Y point is written as a column vector and the new point is the result of that Vector multiplied by the rotation Matrix we're going to get a new single column vector and the first element the new X is x times cosine of theta plus y times minus sine Theta then the new y position is x times sine of theta plus x times cosine of theta notice how if X and Y was the point 0 0 the new point would be zero zero because rotating 0 0 around 0 0 the point stays the same this is not applying any kind of translation only a rotation counterclockwise by the angle Theta in the context of computer Graphics we might be going clockwise because the yaxis is flipped in three dimensions we don't just have a single plane and a single angle if we apply a rotation we need to know around what axis X Y or Z interestingly enough this is actually the rotation Matrix for the zaxis only we need to extend it out to account for Z so to get the new X we would say x times cosine of theta plus y times negative sine of theta plus Z times zero the new y x times sine plus y times cosine plus Z times zero and then the new Z is x times 0 plus y times zero plus Z times one so Z does not rotate around the Z axis we can look at the rotation Matrix for the yaxis as well as the rotation Matrix for the xaxis now that we've covered what the math is the things that I need to add to this program are a variable for the angle that I'm going to rotate we'll start with just rotating along the zaxis as well as a whole second set of points because I need another variable to apply that transformation into so right at line 25 let's go rotation Z points RZT and we're gonna have two of them and there they have an x y and z Oh my goodness I did forget an important step which is once I've rotated the point in three dimensions I need to project it into two Dimensions to draw the correct X and Y but guess what I'm just going to use the simple way of doing that by taking off the Z so it won't be perspective it'll be orthographic but it'll be good enough for us right now now I have a whole separate array for the rotated points line 50 is where I'm drawing so in line 55 let's do another subroutine two thousand and that's where I'll apply the rotation math we just went through so 4 n equals 0 2 and I just have two points right now there's two points in the array oh I forgot about an angle running out of lines of code here at the beginning but let's do a line 18 an angle do I dare no I can't use a because I use that here I could use angle the word angle angle equals zero then line 2000 to 2010 the rotation point for Z of I the x value equals so I need to use cosine of theta but as soon as I go to do I comma 1 the Y value I'm going to want to use cosine of theta again and I don't want to calculate that twice so actually what I should do even before I do the loop in line 2000 is say CS for cosine of theta is cosine of and it's not Theta I called it angle sorry and SN for sine is sine of that angle now I could do that Loop for n equals 0 to 1 and then r z p right the rotation Z point x o n for the end point x equals negative cosine you might notice that my original Matrix had positive cosine Theta and yet I just typed negative cosine Theta I'm also going to type positive sine instead of negative sign this is because in the graphics world of the Apple II plus y points down the pixels are positive in the downward Direction and I want it to match y pointing up so I've just swapped the sign there and the rotation happens in the correct direction who's to say what's correct anyway though as long as I'm consistent but I just want to let you know that's why that changed times x which is point zero plus sine times Y which is one plus Z times zero now since I'm multiplying by zero you don't need to have that operation in there probably should just leave it out but I feel like just to have the math be consistent I should say zero times points n comma two then let's do the Y y equals sine of theta times X plus cosine times y plus zero times points times Z and then you know to be consistent I should do the Z which is just zero times x again this is a lot of extra stuff zero times y plus one times Z next n to go on to the next point now the question is where in the code do I want to apply this rotation so right here starting at line 50 that's essentially my draw Loop draw the line rotate the point then go back and do it again draw the line rotate draw the line rotate but I'm missing the swap the buffers and there's another issue that I'm thinking about so let's clean up our code a little bit refactor if you will and start putting a proper draw loop at line 100. I'm even going to use some comments here draw Loop the first thing in the draw Loop should be rotate the line then draw the line I should probably put remarks on all of these but I don't got a lot of time right now then swap the buffers which is the subroutine at one thousand that's what a comment would look like let's put it in for the ghost Subs oh oops ah rotate the points draw the line swap the buffer and start over all right let's see what happens if we run this great we've got the line it's not rotating why because I didn't increase the angle so on line 140 angle equals angle plus 0.1 and then line 150 go to 100. Aha it's still not working I know why do you know why think about it let's go to that subroutine at line 500. this is where I take point a and point B and connect them by plotting a line but I'm looking up the location of index A and B in the points array and the rotated values are in the rzp array rotated by Z points rzp if only there were some generic way for me to pass an argument I don't think this is going to work I know it's not going to work because I just tried to do it for like a half an hour so I'm just going to hard code in the rotated Z array and we'll see later if I have to do multiple rotation time I'm going to handle that and guess what Now's the Time for a beautiful fancy editing Escape all the way over and then r z p and then of course I have to Arrow over to the episode line go do something else for a little while it'll be it'll be a bit looks good okay so there's a nice little Point all of a sudden that happened here this is not working oh my goodness I made a ridiculous mistake look at this I left my old draw Loop in there the one that is not applying the rotation or doing anything so I've got to get rid of that 50 55 60. now I just pray here oh oh wow oh I believe the first swapping is not working but I don't I don't care because that is totally awesome thank you I'm done I'm out of here it's the end of this video you figure it out yourself why did the buffer swap not work look at some of my reference research here oh my goodness and it was running so fast you know why I forgot to have the clear the background step should the clear the background be part of the swapping of the buffer I don't think so because ultimately it's really part of the draw Loop yeah I like swapping the buffer at the end so 150 swap the buffer 160 go to 100 and then what I'm missing there at 105 is not swapping the buffer it is call the erase the background which is call 62450 and this is gonna I think fix it but also make it run unbelievably slow that's not that bad actually to be perfectly honest there's my rotating in 3D line a whole Square that's rotating so now my points and my rotated Z points need to have four points in them four comma three four xyz's it's funny I'm not doing anything 3D but I will I will then let's do let's just change it now let's change it to a rotation by X so let's just do those all in one line do we want to see it rotate by let's do y let's do y so now when we're initializing the points which should probably be a subroutine because I'm going to run out of space but that's fine yeah I should that should be a dumb subroutine let's make that at um five thousand and I'm gonna do do all the points negative one negative one zero I should really use a z value since I have to fix that one anyway because if I'm eventually going to make a cube there's got to be Four Points in front and four points in back with like the center of the Cube It's the center of our 3D World so let's have let's draw a cube in front to start let's draw one in the back to start okay and then so I'm missing I call in there and then this should be negative one because it's important to have this D do something now I'm doing the third point the bottom right one one one one negative one foreign negative one one negative one whoops I hope this works so instead of initializing the points here and line 30 we're just gonna say go sub 5000 and then I forgot I need a return there so even if I run this ooh I was gonna say it should work with just the first two points syntax errand line 25. oh I forgot the dim I got so excited I forgot to type Den dim ryp 4 comma three so exactly what we had before but now where is that where's my draw Loop oh so first rotating them all 2020 needs to be zero to three because there's four points and then 120. so now I'm gonna need a lot more things there so that should also be a sub 14. I mean that's a little bit nuts but that's fine do I have anything at six thousand no okay so six thousand draw lines oh REM draw lines so first connect zero and one foreign then connect two and three then connect three and zero so I could do this in a loop but I just want to hard code it to know that it's right I'm also anticipating having a lot more points with a more elaborate shape and uh at this point right now I'd rather just type it all out and then 6050 return so that's my subroutine here to connect all those lines and let's go back to my draw Loop and instead of Line 120 being this we're going to say go sub 6000 REM lines okay I'd run this hey hey hey guess what we've got to make this make the 3D so I need to add rotate X you remember the Matrix math we did now we just need to add that in where does that happen where was that subroutine 2000 so right after line 2050 that's where I've applied The Matrix rotations for a z rotation I just need to do the matrix multiplication for an X rotation a y rotation I mean a y rotation so let's wipe out 2060 and 2070 right now and 2060 would be ryp n comma 0 equals cosine 0 sine zero one zero negative sine zero cosine I think that's right then 20 90 would be next and true we should apply the Y rotation first I guess it's six of one half dozen to the other because now I'm gonna have to adjust the uh when I'm drawing the line oh whoops 2090 is next and 2100 is returned let's just run this it should we shouldn't see the Y rotation yet because I'm still just drawing the rzp points and you can see it's actually running I thought it would I'm quite impressed with the speed of this uh um but where is that that's here the subroutine of line 500 I now need to change this again Talk Amongst yourselves foreign moment of truth I can't imagine that I didn't make a mistake but that's happening before let's just run it and see who where's it going goodbye where are you going I mean I see some kind of 3D rotation there I think it's because it is out from the center what it's doing is imagine it's this piece of paper what I'm doing is rotating it like this as well as doing this so it's really doing this which I think is what I'm seeing let me show it to you sped up very slow but working all that's left for me to do now is really a lot of typing I need to add four more points so to have all the points of a cube I need to draw eight more lines so we see the full cube and then maybe if I feel a little Saucy I might like to add the xaxis rotation we'll see step one increase the size of my arrays I realize I did something a little wonky here it's correct in that I have four points and three dimensions but the index values are zero one two three and zero one two and applesoft basic expects me to put not the length of the array but the maximum index which is weird but that's how it wants it to be let's correct it as I expand it oh that looks wrong but seven comma two is a twodimensional array eight by three let's add an X rotation my arrays are bigger now where do I initialize them I think in the subroutine at five thousand Yep this is where I initialize 0 1 2 3. let's keep going I have what might be a clever idea instead of typing four more lines of code I can edit these lines of code changing the line number the array index and the Z location right these are the four points at the back of the cube negative one to the Four Points at the front of the cube positive one foreign index four who knows if this is actually any better but it is going to work I think oh there's a bracket there I have to get rid of let's see if that works I think I got it I have now all the points of the cube in my array where do I process those points the subroutine at 2000 is where I rotate them for once I've actually done something in a way that makes this really easy to edit the only thing I need to change here is the loop now goes instead of from zero to three to from zero to seven now that I'm storing all the points processing all the points I need to draw all of the lines to connect the full cube that happens in subroutine line 6000. so I need to connect the back of the cube and then I need to connect the corners of the back to the corners of the front there we go great exercise for any of you watching is what's an algorithm you could design to do this in some kind of nice Loop and I've forgotten the return which is very important uh oh I I made a mistake with certain lines that I've connected let's check that out wow this is kind of cool though I made a weird shape I must have messed up my point definitions ah I have found the culprit I have a index off here in this line 50 60. it is index six and I left the two there foreign rotate now look at that beautiful threedimensional orthogonal Cube I feel like the xaxis is feeling left out let's add rotation around that axis I'm not going to add all that multiply by zero this time let's just do it the simplified way then I need next n and return all right all three axes there are some ways I could get this to run faster sure I could look into programming with Assembly Language but are there even some things that I could do in the code to optimize it would not using the call to wipe the graphics background and instead erase the individual lines be faster what about precomputing all the values of sine and cosine that I might need and storing them in a big array a lookup table essentially this would also have the advantage of allowing me to maybe use different angles for each of the axes to get a more complex rotation I would love to hear from you how would you optimize this code I will include a link to an emulator and this code that you could run there and try out different ideas and if you've got something let me know in the comments I will definitely address it in a future video or live stream another challenge I'd love to offer you is to add perspective projection this is kind of flat because it's orthographic projection and the math for doing that it's all described in my 3D rendering processing video and I will include information about how to do that in the video description see if you can get that to work I'll show you what it looks like also over here hope you enjoyed another episode of coding together what should I do in the next one I'm thinking what about music could I play a delightful tune here with my Apple 2 plus computer stay tuned and I'll see you next time on coding together oh and let's not forget to save our code disc full oh no no I've got 32 gigabytes on this SD card what are you talking about don't worry I'll have this figured out by the next time you're watching this video and the code will be linked in the description see you next time foreign
