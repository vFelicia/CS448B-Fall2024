With timestamps:

00:00 - here we are again well this is the third
00:03 - video in this series about nearest
00:06 - neighbor and similarity scores and we're
00:08 - finally finally kind of figure out which
00:11 - Star Wars movie you should watch so how
00:16 - are we going to do that what I need to
00:18 - do first is I need a forum where a new
00:21 - user could enter this world hi my name
00:24 - is user that's my name user and I have
00:30 - only seen episodes 4 5 & 6 of Star Wars
00:34 - so I'm going to make some ratings and
00:37 - that is going to predict which Star Wars
00:41 - movie I should watch or how I like Star
00:43 - rated something like that okay so first
00:45 - a sort of it's unfortunate for you that
00:47 - I didn't cause her to do this before is
00:48 - very nice we could fast forward a little
00:50 - bit if you don't want to bother with me
00:51 - building the form to get the stuff but
00:54 - I'm going to do that now so what I'm
00:56 - doing here is I'm adding and I need a
00:58 - comma I added to the JSON file just a
01:01 - list of all the titles obviously I can
01:05 - extrapolate that from the data set in
01:06 - different ways but this is just going to
01:08 - make my life so much easier right now
01:10 - let's do this let's be happy let's just
01:12 - make our lives easier why worry so much
01:15 - let's do it this way okay happy JSON
01:19 - file so I'll have easy happy easy JSON
01:22 - files okay so now that I've done that
01:24 - what I want to do is where am I
01:28 - it was set up I want to create I first I
01:31 - want to do is I want to get all the
01:34 - titles is now data titles and I want to
01:39 - loop through them titles dot length I
01:46 - plus plus and I want to say I took it
01:53 - this way I'm going to do it this way
01:55 - though it's looking ahead gonna be fine
01:57 - I'm going to say VAR div equals create
02:01 - div yeah this is going to be fine
02:04 - creative with the title let's look at
02:09 - what I got so far
02:10 - alright see I got to deal with all these
02:11 - titles okay okay this is great
02:13 - this is good VAR select equals create
02:17 - select select parent the div so that's
02:23 - that drop down this should I'm going to
02:25 - call this a drop down that drop down
02:27 - should go in the div well look there is
02:32 - the worst design for ever but it's fine
02:35 - yeah there's so many better somebody's
02:37 - going to save me on the internet someday
02:39 - and make a really nice version of this
02:40 - with better data and better design and
02:43 - then what I want to do is save our you
02:46 - know star what are the possible stars
02:49 - because 0 stars one star I didn't give
02:53 - in I didn't give it a star is let you
02:58 - could have 1 to 5 stars
02:59 - so I'm going to say drop down dot option
03:02 - star so now what what's wrong oh this
03:08 - needs to be parentheses I'm giving all
03:10 - these stars and this is not start it
03:12 - star that's hot I star my brain is
03:15 - melting now look at it so I could say I
03:19 - want to rate this movie this way and
03:22 - this movie this way and this movie this
03:23 - way and this is it this way now then
03:25 - it's submit ba ba ba ba ba and what I'm
03:29 - going to get what I want to see is the
03:31 - movies that I didn't rate I want to see
03:35 - what it would guess my rating should be
03:38 - so I'm going to actually add an option
03:40 - where I'm going to say drop-down option
03:44 - I'll just call it not seeing I guess so
03:48 - I can just rate the movies that I've
03:50 - seen and get a prediction for the other
03:52 - movies that's where we are so far okay
03:55 - weird we're good we're good now we're
03:57 - ready to do something so now I don't
04:02 - need any of this stuff from before but I
04:03 - need to handle the mousepressed so what
04:06 - I want to do is I need this find nearest
04:11 - neighbors function so when I press the
04:14 - mouse what I want to do is what predict
04:19 - ratings so I need a function that's
04:24 - predict radix
04:26 - okay and what am I going to do in this
04:31 - function okay so first of all I need to
04:33 - create I need to create a new user new
04:36 - user is me and then what I need to do is
04:42 - make a user object that has a rating so
04:46 - how is the data organized originally
04:48 - it's to each user object as the user's
04:51 - name and the a lookup of the movie title
04:55 - and the rating okay so now what I need
04:57 - to do is I need to say for so what would
05:02 - be nice is if I put all of these drop
05:05 - down somewhere in like a variable so I'm
05:08 - going to say drop downs equals an array
05:12 - and I'm going to I mean I could select
05:15 - them but I'm going to say drop downs dot
05:18 - push drop-down so this is where I can
05:23 - now get I can get for all I can look at
05:27 - all of the dropdowns and I can say new
05:33 - user new user oh okay
05:41 - interesting what do we need to do I need
05:43 - to figure out how to pair when I look
05:47 - for each of these dropdowns I'm going to
05:49 - get this number but I need to be able to
05:52 - pull out the actual value so hold on
06:00 - everybody I'm thinking so I need to
06:02 - actually pair it with it so I'm going to
06:05 - just do something silly but I'm going to
06:07 - do is I'm going to attack them and when
06:10 - I make this drop-down I'm going to say
06:12 - drop-down dot title I'm just going to
06:15 - title index I so any a JavaScript object
06:20 - the drop-down is an html5 of people I've
06:22 - element I can just attach another
06:24 - variable to it and put some data in it
06:26 - so I'm going to do that and I'm going to
06:29 - now say new so as I go through this new
06:33 - user so the title is
06:38 - drop downs index I dot title the value
06:47 - the rating is drop downs index value the
06:54 - function this is a function that returns
06:56 - the current selected value out of those
06:58 - options so new user index title equals
07:03 - the rating so let's just now console.log
07:06 - that new user here we go let's take a
07:10 - look at this so I am now going to say
07:13 - three five and I'm going to submit and
07:17 - look I now have an I know I have a new
07:19 - user object that has all of these movie
07:21 - ratings and not seen now here's the
07:23 - thing
07:24 - I think previously the way I had written
07:26 - this is I use no to ignore a similarity
07:30 - score too so what I should do here is I
07:34 - think it might be useful is to say if
07:41 - rating equals not seen let's just
07:48 - instead of using the string not seen
07:50 - let's say rating equals null so I'm just
07:54 - going to change that to be null in that
07:55 - user object so let's just see if that
07:58 - works so I'm just going to only rate one
08:02 - and we should see now okay so now I have
08:04 - known for all the other ratings perfect
08:06 - so now what I could do is I could
08:08 - definitely see who are the most similar
08:11 - users to my particular rating here
08:14 - because that we just did so let's do
08:16 - that so what I'm going to do is now I'm
08:18 - going to say once I've done that I want
08:22 - to say find nearest neighbors but what
08:29 - is fine nearest neighbors do before well
08:31 - it got the user from a drop-down menu
08:34 - but I don't want to do that anymore
08:36 - actually what I want to do is give
08:40 - myself get this I'm going to pass in a
08:43 - particular user so what I want to do is
08:46 - I want to say find nearest neighbors for
08:48 - this
08:48 - to our user when a buying the nearest
08:50 - neighbors for this particular user so
08:52 - here where did I get the user like I
08:55 - said sort of I got the user from the
08:57 - name Euclidean distance name ah so the
09:00 - Euclidean distance function it looks up
09:03 - so many problems so many things I have
09:06 - to fix you like to restructure the way I
09:08 - did it this is the life of programming
09:11 - it just seems like oh this won't be any
09:12 - good just going to add this one little
09:14 - feature and then I've made all these
09:15 - weird kind of not-so-great decisions
09:18 - earlier so we got it we got to do better
09:21 - okay so I'm going to I'm just going to
09:23 - have to live with myself but I'm gonna
09:25 - try to make my life is easy and friendly
09:27 - and happy as possible this function
09:29 - Euclidean distance should really receive
09:32 - to user objects so what I'm going to do
09:36 - is now have this receive ratings 1 and
09:39 - ratings 2 so these should be to user
09:42 - objects with all of the readings it's
09:46 - stripping out the name and timestamp
09:48 - thing but that's fine the titles that
09:50 - the titles I could actually just use so
09:53 - now one thing I can do to simplify since
09:55 - I have that movie title thing is I can
09:58 - get ok when I look for the title to save
10:01 - our titles equals data titles ok so that
10:05 - simplifies it so I want to get the two
10:07 - user objects so I'm going to come back
10:10 - up and I'm going to so what I want to do
10:15 - is back up to where I call Euclidean
10:17 - distance this is where I call it I call
10:20 - it between two names but now the user is
10:25 - coming here so I want to call it between
10:27 - user and not and I don't have to worry
10:34 - about this anymore if this new user
10:37 - can't be the same
10:38 - aha so I can actually this is actually
10:39 - simplifying things I can get rid of this
10:41 - and other can actually be the full user
10:45 - object and so now I want to say
10:47 - Euclidean distance between this new user
10:50 - and other similarity scores etc etc okay
10:56 - so the rest should be fine what if I
10:59 - must have missed something right but
11:01 - let's try this
11:02 - so I'm going to rate a few movies just
11:06 - picking random numbers and not even
11:08 - thinking about it
11:08 - hit submit okay sketch that yes line
11:11 - forty-six users not the pint shouldn't
11:14 - know better just try this line forty-six
11:17 - oh this is right here I'm passing a new
11:19 - user let's say I lost track of so many
11:22 - things here and maybe you've lost me
11:23 - let's come back and say what we're doing
11:25 - predict ratings happens as soon as I
11:28 - press the mouse I build a new user with
11:31 - a bunch of ratings based on the
11:33 - interface and then I say find the
11:35 - nearest neighbors for that new user and
11:37 - buying the nearest neighbors for that
11:38 - new user means go through and check all
11:40 - of the users in my database in that JSON
11:42 - file and good player compare the
11:44 - including distance sort all of them and
11:46 - show me show me the five nearest ones
11:49 - and one thing I want to do is now I'm
11:53 - gonna just leave this like this I'll fix
11:54 - this in a second okay let's try this now
11:56 - I'm going to rate a few random ones hit
11:59 - submit and okay so this is good I got a
12:03 - bunch of users it looks like these are
12:05 - users in the chord undefined so
12:08 - something didn't work here I would have
12:10 - to debug this uh so the lookup is no
12:15 - longer by name because other is the full
12:18 - user but I want the lookup to be by
12:21 - other dot name so let's just see if this
12:23 - works now great
12:25 - so I'm exactly the same as all three of
12:28 - these people because all three of these
12:30 - people rated Star Wars Episode one with
12:33 - a two and we can see here's the here's
12:35 - poor people here here's four is this
12:37 - five people all three five people okay
12:39 - but now I could start to get some more
12:41 - interesting similarity scores by rating
12:43 - more movies so here are the five most
12:48 - similar users to be here something that
12:50 - I'm just really bothering me once a nice
12:53 - little function at least for like
12:54 - looking at stuff is a number format so
12:58 - what I'm going to do is I'm going to say
13:00 - score equals number format and I'm going
13:03 - to format the similarity score and what
13:07 - number format does is I could say give
13:09 - me this many leading decimals and this
13:11 - many trailing decimals so I could say
13:13 - something like you know
13:16 - one comma two and so if I do that what
13:20 - I'm going to get now is this so here now
13:24 - what I'm doing if this looks so horribly
13:26 - ugly but design aside at least I'm
13:29 - getting just the similarity scores with
13:31 - and I could with just two decimal places
13:33 - even if they go on for much more okay
13:36 - what is you're getting so many of the
13:37 - same score because it's just a very
13:39 - small small data set this would work so
13:41 - much more this would work so much better
13:43 - if I had if raises a thousand movies and
13:46 - then I had a huge database of other user
13:48 - ratings now scale is also a problem the
13:50 - algorithm then went really slow and
13:52 - there's ways around that but I will get
13:53 - to at some point I forgot the force
13:56 - awakens oh yes but no but I didn't
13:58 - forget it in the data set right it's in
14:02 - movies JSON yeah yeah I just forgot it
14:05 - in here okay so let me add that in thank
14:06 - you let's include the force awakens'
14:09 - here and force awakens' things back
14:12 - there we go okay thank you for that okay
14:16 - we're finally ready now what I can do is
14:21 - get a rating for a particular movie that
14:27 - I the new user has not seen and after
14:31 - all isn't that what we're here for to
14:34 - figure this out and make me you fast
14:35 - forwarded all the way to this point of
14:37 - the video if you did we're good we're
14:39 - here okay what do I need to do I need to
14:43 - find the place where I I need to find
14:47 - the place in the code where I create all
14:49 - those divs I need to refactor this
14:52 - because I don't want to look at the five
14:54 - nearest people I want to use the five
14:57 - nearest people to compute some guesses
15:00 - for movies I haven't rated so first of
15:01 - all you need to keep track of the movies
15:03 - that I haven't read it so let's do that
15:06 - where cuz I do that here is so so let's
15:10 - just do that here so first let's create
15:13 - an array so called new titles and what
15:17 - I'm going to do is Bauer ie equals zero
15:20 - I equals data titles do I already have
15:23 - titles here somewhere I think I have
15:24 - just this is a very silly way of doing
15:27 - this but
15:29 - titles you know I don't need to create a
15:32 - separate array I need to go through all
15:33 - the titles I had less than what I want
15:37 - to do is go through all the titles and
15:38 - find out have I not seen that movie yet
15:42 - so I'm going to save our title if bar
15:48 - title equals titles index I if a my new
15:55 - user in here where am i phone user if
15:59 - and do I have access to titles now I
16:01 - need to say data titles data titles if
16:08 - user index title equals equals null now
16:15 - with the time create div title creative
16:23 - title so I want to do a result P parent
16:30 - Oh No
16:31 - yeah no no no did this should be div
16:34 - parent results P I had that wrong so I
16:36 - want to put the div inside that but
16:38 - that's something I want to do this
16:42 - creative title result gives push and
16:46 - then div dot parent title I just want to
16:49 - see the title we're going to get to this
16:51 - in a second this tough way that should
16:53 - be a really long time what brain is
16:55 - melting this should just give me on the
16:59 - HTML page of movies that I want to have
17:01 - my predicted ratings for ready here's a
17:07 - rating here's a rating submit okay
17:10 - cannot read property appendchild of know
17:13 - div dot parent not title result P try
17:19 - this again okay so now what is what is
17:26 - the button go up here and holiday went
17:29 - down here that is craziness
17:32 - what is craziness this is somehow
17:35 - getting parented what have I done what
17:39 - crazy weird thing have I done
17:43 - oh I know why so I need to put the head
17:48 - a variable and parentage okay
17:50 - everything's going to be okay can you
17:53 - hear my stomach rumbling okay here we go
17:56 - great so I should see a list of
17:58 - everything but episode 1 in episode 4
18:01 - perfect so now I need to predict the
18:04 - star rating for those we're getting so
18:06 - close so now that I know this is a title
18:09 - I need to get a prediction for this is
18:12 - where I now want to look at the five
18:15 - nearest neighbors okay it's gotta be
18:21 - okay so let's get rid of this div for a
18:24 - second and right now I am going to look
18:28 - at five nearest neighbors okay so I
18:34 - don't care about their name but I do
18:37 - care about their score don't care about
18:41 - number formatting it because what I want
18:45 - to do is I want to okay how do I do this
18:50 - prediction I want to basically take a
18:53 - weighted average of all of the neighbors
18:55 - so let's think about this in using the
18:59 - whiteboard for a second okay so for
19:03 - example if we imagine just a
19:05 - 2-dimensional space and if there were
19:12 - just two movies like episode 4 and
19:14 - episode you know 7 you know I could put
19:17 - plot everybody's you know this is
19:19 - somebody who rated episode 4 with 4
19:22 - stars but episode 7 with 1 star right
19:25 - would be over here so what I want to do
19:28 - is I'm a new user and I'm somewhere here
19:30 - what I want to do is and I've only rated
19:35 - well this is good getting confusing okay
19:38 - so what I want to do is I want to look
19:40 - at the people who are nearest to me
19:42 - maybe the five nearest ones
19:43 - this is and make a prediction but I want
19:47 - to wait I don't have to do this I could
19:49 - just take the average of all of these
19:50 - but what I want to do here is I want to
19:53 - wait this person who's
19:55 - to me I want to wait the prediction that
19:58 - I have for there I want to wait their
20:00 - movie rating more heavily than somebody
20:02 - who's a little bit further so how am I
20:04 - going to do that
20:05 - so first let's actually just take an
20:07 - average of the K nearest neighbors
20:09 - ratings over that particular title so
20:11 - what do I want to forget about the
20:13 - similarity score for a second what am i
20:17 - doing here
20:17 - so what I want to do is get all of the
20:20 - ratings user title isn't right okay
20:24 - so how do I done the ratings are from
20:27 - that users my variable naming is pretty
20:30 - poor here and I need to do a better job
20:32 - with that but users remember is the
20:34 - lookup table of all of the users user
20:37 - right now is me I should probably not
20:39 - call it your really regain this stuff
20:41 - and I maybe I'll refactor this when I
20:43 - publish the code okay I want to get some
20:46 - ratings from all of the users for one
20:49 - particular so that's Nate okay so these
20:54 - are all the ratings for one particular
20:55 - four and now what I want to get is the
20:59 - actual rating is the ratings index two
21:05 - title right so first I need the user the
21:09 - k-nearest user where's name coming from
21:13 - wait a second users okay hold hold your
21:19 - horses
21:20 - I I went a little nuts here users index
21:24 - K forget about the name I can get the
21:28 - simple I'm gonna get the similarity
21:29 - score but the name K is what I want
21:33 - come on we can do this I want to look at
21:36 - that particulars it's sorted I'm going
21:41 - to get the ratings for that particular
21:42 - user I'm gonna get the rating for this
21:44 - particular title then I'm going to add
21:47 - them all together some plus equals that
21:53 - rating then what do I do some divided it
21:57 - equally k and now here we go
22:00 - I can make a nice little div and what
22:04 - does that div going to have in it it is
22:07 - going to have the title
22:09 - whoever I look at you're over there it's
22:11 - going to have the title plus a colon
22:14 - plus some and I'm going to just say
22:18 - stars equals that sum divided by K
22:25 - that's going to be the stars and I'm
22:27 - also going to number format it so that
22:30 - it's with a with a one leading digit and
22:36 - two decimal places
22:37 - okay here we go now this isn't good if
22:42 - there's a lot there's a bunch of things
22:43 - I want to do this to make this better
22:45 - and then talk about whole sorts of
22:46 - things that I've missed but I think
22:48 - we're somewhere there with me
22:55 - the like episode one don't like F so ii
22:58 - don't like episo-- - and like episode 5
23:00 - for a bit ah cannot read proper TV of
23:09 - undefined at fine years neighbours okay
23:12 - let's see if we can fix this sketch -
23:14 - line 83 oh this is it
23:19 - what is ratings is okay let's think
23:25 - about this users is the lookup table
23:29 - data dot users I see I've done a lesson
23:34 - learned I may be what I'm going to do
23:37 - after this video is do a separate video
23:39 - where I just refactor this to make it
23:41 - with better variable names and make it
23:43 - more organized in a way that I could
23:45 - fall I've done a terrible job this is
23:46 - really the lesson in poor code
23:49 - management but hopefully you're learning
23:51 - something I see me - what I wanted to
23:53 - look at the array is actually data dot
23:55 - users data is the stuff I loaded from
23:57 - JSON so data dot users is my array users
24:00 - was my lookup table so this is what I
24:04 - want - let's see how this goes
24:14 - I can't 700 no I think why infinite loop
24:22 - right I think I froze in the browser
24:25 - Oh Oh terrible terrible terrible error
24:30 - look at this I I'm not paying close
24:33 - attention and I'm in a loop within a
24:36 - loop and I use I twice which is
24:38 - absolutely absolutely a disaster so no
24:42 - wonder I had an infinite loop let's
24:44 - change this to J okay I'm feeling
24:47 - slightly more confident now
24:53 - I really should stop doing
24:57 - [Music]
25:05 - I got these star ratings so and so I
25:10 - really think that I should have so I
25:14 - should really be seeing episode 5 or 6
25:16 - and I'm really not going to like the
25:18 - holiday special this ten by the way has
25:20 - been in the way all the time
25:21 - okay so we're doing well this is pretty
25:25 - good and I really should quit while I'm
25:27 - ahead even though I'm not very far ahead
25:28 - I'm Way behind but we've now got a
25:32 - prediction engine I would be nice to
25:33 - sort these I'd probably want to sort
25:35 - these I can leave that as an exercise
25:36 - for you but I absolutely should do the
25:39 - weight I should do a weighted sum so
25:41 - let's at least add this and I'm seeing
25:43 - it in the chat I'm going to do it right
25:45 - now okay and I should add some emojis to
25:49 - this because can you receive some some
25:53 - happiness some smiles hearts in my chat
25:56 - okay
25:57 - here we go okay so now what I want to do
26:00 - is let's use that similarity score score
26:04 - equals similarity scores okay similarity
26:09 - scores in next name that what is the
26:11 - name so okay so the name is data users
26:18 - index J name so remember the name again
26:24 - I don't know I love the way I've
26:25 - organized this the similarity scores are
26:28 - in a separate lookup table than the
26:30 - original data so the data which I really
26:33 - Clyde should have put that in the
26:34 - original data but anyway the name is
26:36 - coming from the sorted array of users
26:38 - the score then it's coming from the
26:41 - similarity scores and then the rating is
26:43 - also in that original lookup table so
26:45 - now the weighted sum okay so a couple
26:50 - things I should do I need the I need
26:53 - this the weighted sum and then I need
26:58 - the similarity some I'll try to explain
27:01 - this I think in a minute so I need two
27:04 - different sums here so what I need to do
27:07 - is add up the weighted sum equals the
27:11 - ratings
27:12 - times the similarity to score and I
27:18 - don't know maybe I'll call this
27:19 - sin for similarity so this is the
27:22 - weighted sum its the rating time now
27:24 - remember if they're really similar the
27:26 - similarity score is 1 if they're not
27:28 - very similar the similarity score is 0.1
27:30 - the reason why I also this reason why I
27:32 - need this similarity thumb
27:34 - is that what this is what to get the
27:40 - average like if I add up five things and
27:42 - divide by five I have an average but I'm
27:46 - not adding up five things now and adding
27:49 - up five things weighted by similarity so
27:52 - what I actually want to do is the number
27:54 - of stars is the weighted sum books is
27:57 - the weighted sum divided by the
27:59 - similarity sum so this is actually going
28:02 - to give me the weighted average does
28:04 - this make sense to you if it doesn't ask
28:06 - in the comment maybe I can sort of
28:08 - answer this again another time or make
28:10 - another video but now I have the weight
28:12 - of something the other thing here is
28:14 - it's very likely in a more elaborate
28:16 - system that the user is not going to
28:18 - have rated all every user is not going
28:19 - to have rated every other movie so I
28:21 - would add need to do an error check to
28:23 - make sure I should do that here so I
28:25 - should check as long as rating is not
28:30 - equal to null that could be no then I
28:33 - add this up and this is going to work so
28:35 - there could be a thousand movies it's
28:37 - only going to add up the ones that that
28:39 - particular user has rated okay okay here
28:43 - we go okay here we go here we go here we
28:47 - go here we go and I am now going to rate
28:52 - some movies ah stuff using the sound
28:54 - effects for no no I really don't like
28:57 - episode one or two three was kind of
29:00 - okay you know these are all good
29:04 - no that's this is a good one come on
29:06 - Empire Strikes Back Return of the Jedi I
29:09 - like Alex seven okay here we go so what
29:13 - will be my estimated star rating for
29:16 - rogue one in the 1977 I think that's on
29:21 - whatever the Star Wars Holiday Special
29:24 - my the guess is I'm going to rate road
29:27 - one and three point nine six stars and
29:30 - holiday at one
29:31 - 26 stars we did it okay I wish I could
29:40 - play some Star Wars sound effects but
29:41 - I'll get a copyright problem so this is
29:44 - now a recommendation engine it has got a
29:48 - very limited data set there's a lot of
29:50 - problems with this but let's think about
29:51 - what are some things you could do with
29:53 - this going forward first of all you
29:56 - could think about a whole other context
29:58 - of what you might use this in I mean
30:00 - think about similarities and predictions
30:04 - of Ray it doesn't have to be you know
30:06 - product ratings moving ratings you can
30:08 - think about any property associated with
30:11 - a person a thing you know think about
30:15 - word counts what if you look at like all
30:16 - the emails sent to yours all the emails
30:19 - sent for all of your friends and you
30:20 - counted all the words in all those
30:22 - emails essentially those word counts are
30:25 - equivalent of star ratings for each word
30:29 - can you find similarities between your
30:31 - friends can you predict so this is sort
30:33 - of laying the foundation of how you
30:34 - might do spam filtering for example so
30:37 - there's a lot of ways you could think
30:38 - about a data set that's full of key
30:42 - value pairs and how you might have a lot
30:44 - of data points and make predictions
30:45 - based on that and that's what's
30:47 - happening here that said maybe you're
30:50 - interested in doing something really
30:51 - close to this like a movie
30:52 - recommendation system getting your own
30:55 - data set now here's a challenge for you
30:56 - I've met a lot of this code I should
30:59 - thank again I'm building this based on
31:02 - after having read this collective
31:03 - intelligence book I put a link to this
31:05 - book in this video's description
31:06 - something you might think about is okay
31:11 - what makes you think about movie lens so
31:14 - there is a website called movie lens and
31:17 - movie lens has a giant dataset with 20
31:21 - million ratings so you could actually
31:23 - build this exact same program with a
31:26 - large massive data set now you're going
31:29 - to have a lot of issues all of a sudden
31:31 - with performance and so how do you
31:33 - approach that now that's a topic for a
31:35 - whole other video but that's kind of a
31:37 - challenge for you and something that
31:39 - you'll notice here is I have to go
31:42 - through every single other user because
31:45 - this is all and looking up everything by
31:47 - user but I could have some pre-computed
31:50 - look-up tables that kind of know
31:53 - something about how movies are similar
31:55 - based on user ratings and calculate
31:58 - calculate the predictions based on movie
32:02 - similarities as well so I think it up
32:05 - this is covered in this book maybe I'll
32:08 - come back and do another video on that
32:09 - and explain that very well but this is
32:11 - user base you can do something that's
32:13 - item based and that's going to really
32:15 - improve speed maybe if you use a
32:17 - database and have some pre computed
32:19 - look-up tables in certain ways it's
32:20 - other ways you could approach it write
32:22 - in the comments ways that you think
32:23 - about like how you might do this with a
32:25 - large data set but even just redesigning
32:28 - doing a better interaction building a
32:31 - like actual server-side program that
32:33 - saves stuff in a database I would
32:35 - encourage you to go do something
32:37 - creative with this something strange
32:39 - something useless something playful and
32:41 - share with me so thanks for watching and
32:44 - I'll see you in a future coding
32:46 - challenge video thing etc good bye
32:53 - [Music]
33:00 - you

Cleaned transcript:

here we are again well this is the third video in this series about nearest neighbor and similarity scores and we're finally finally kind of figure out which Star Wars movie you should watch so how are we going to do that what I need to do first is I need a forum where a new user could enter this world hi my name is user that's my name user and I have only seen episodes 4 5 & 6 of Star Wars so I'm going to make some ratings and that is going to predict which Star Wars movie I should watch or how I like Star rated something like that okay so first a sort of it's unfortunate for you that I didn't cause her to do this before is very nice we could fast forward a little bit if you don't want to bother with me building the form to get the stuff but I'm going to do that now so what I'm doing here is I'm adding and I need a comma I added to the JSON file just a list of all the titles obviously I can extrapolate that from the data set in different ways but this is just going to make my life so much easier right now let's do this let's be happy let's just make our lives easier why worry so much let's do it this way okay happy JSON file so I'll have easy happy easy JSON files okay so now that I've done that what I want to do is where am I it was set up I want to create I first I want to do is I want to get all the titles is now data titles and I want to loop through them titles dot length I plus plus and I want to say I took it this way I'm going to do it this way though it's looking ahead gonna be fine I'm going to say VAR div equals create div yeah this is going to be fine creative with the title let's look at what I got so far alright see I got to deal with all these titles okay okay this is great this is good VAR select equals create select select parent the div so that's that drop down this should I'm going to call this a drop down that drop down should go in the div well look there is the worst design for ever but it's fine yeah there's so many better somebody's going to save me on the internet someday and make a really nice version of this with better data and better design and then what I want to do is save our you know star what are the possible stars because 0 stars one star I didn't give in I didn't give it a star is let you could have 1 to 5 stars so I'm going to say drop down dot option star so now what what's wrong oh this needs to be parentheses I'm giving all these stars and this is not start it star that's hot I star my brain is melting now look at it so I could say I want to rate this movie this way and this movie this way and this movie this way and this is it this way now then it's submit ba ba ba ba ba and what I'm going to get what I want to see is the movies that I didn't rate I want to see what it would guess my rating should be so I'm going to actually add an option where I'm going to say dropdown option I'll just call it not seeing I guess so I can just rate the movies that I've seen and get a prediction for the other movies that's where we are so far okay weird we're good we're good now we're ready to do something so now I don't need any of this stuff from before but I need to handle the mousepressed so what I want to do is I need this find nearest neighbors function so when I press the mouse what I want to do is what predict ratings so I need a function that's predict radix okay and what am I going to do in this function okay so first of all I need to create I need to create a new user new user is me and then what I need to do is make a user object that has a rating so how is the data organized originally it's to each user object as the user's name and the a lookup of the movie title and the rating okay so now what I need to do is I need to say for so what would be nice is if I put all of these drop down somewhere in like a variable so I'm going to say drop downs equals an array and I'm going to I mean I could select them but I'm going to say drop downs dot push dropdown so this is where I can now get I can get for all I can look at all of the dropdowns and I can say new user new user oh okay interesting what do we need to do I need to figure out how to pair when I look for each of these dropdowns I'm going to get this number but I need to be able to pull out the actual value so hold on everybody I'm thinking so I need to actually pair it with it so I'm going to just do something silly but I'm going to do is I'm going to attack them and when I make this dropdown I'm going to say dropdown dot title I'm just going to title index I so any a JavaScript object the dropdown is an html5 of people I've element I can just attach another variable to it and put some data in it so I'm going to do that and I'm going to now say new so as I go through this new user so the title is drop downs index I dot title the value the rating is drop downs index value the function this is a function that returns the current selected value out of those options so new user index title equals the rating so let's just now console.log that new user here we go let's take a look at this so I am now going to say three five and I'm going to submit and look I now have an I know I have a new user object that has all of these movie ratings and not seen now here's the thing I think previously the way I had written this is I use no to ignore a similarity score too so what I should do here is I think it might be useful is to say if rating equals not seen let's just instead of using the string not seen let's say rating equals null so I'm just going to change that to be null in that user object so let's just see if that works so I'm just going to only rate one and we should see now okay so now I have known for all the other ratings perfect so now what I could do is I could definitely see who are the most similar users to my particular rating here because that we just did so let's do that so what I'm going to do is now I'm going to say once I've done that I want to say find nearest neighbors but what is fine nearest neighbors do before well it got the user from a dropdown menu but I don't want to do that anymore actually what I want to do is give myself get this I'm going to pass in a particular user so what I want to do is I want to say find nearest neighbors for this to our user when a buying the nearest neighbors for this particular user so here where did I get the user like I said sort of I got the user from the name Euclidean distance name ah so the Euclidean distance function it looks up so many problems so many things I have to fix you like to restructure the way I did it this is the life of programming it just seems like oh this won't be any good just going to add this one little feature and then I've made all these weird kind of notsogreat decisions earlier so we got it we got to do better okay so I'm going to I'm just going to have to live with myself but I'm gonna try to make my life is easy and friendly and happy as possible this function Euclidean distance should really receive to user objects so what I'm going to do is now have this receive ratings 1 and ratings 2 so these should be to user objects with all of the readings it's stripping out the name and timestamp thing but that's fine the titles that the titles I could actually just use so now one thing I can do to simplify since I have that movie title thing is I can get ok when I look for the title to save our titles equals data titles ok so that simplifies it so I want to get the two user objects so I'm going to come back up and I'm going to so what I want to do is back up to where I call Euclidean distance this is where I call it I call it between two names but now the user is coming here so I want to call it between user and not and I don't have to worry about this anymore if this new user can't be the same aha so I can actually this is actually simplifying things I can get rid of this and other can actually be the full user object and so now I want to say Euclidean distance between this new user and other similarity scores etc etc okay so the rest should be fine what if I must have missed something right but let's try this so I'm going to rate a few movies just picking random numbers and not even thinking about it hit submit okay sketch that yes line fortysix users not the pint shouldn't know better just try this line fortysix oh this is right here I'm passing a new user let's say I lost track of so many things here and maybe you've lost me let's come back and say what we're doing predict ratings happens as soon as I press the mouse I build a new user with a bunch of ratings based on the interface and then I say find the nearest neighbors for that new user and buying the nearest neighbors for that new user means go through and check all of the users in my database in that JSON file and good player compare the including distance sort all of them and show me show me the five nearest ones and one thing I want to do is now I'm gonna just leave this like this I'll fix this in a second okay let's try this now I'm going to rate a few random ones hit submit and okay so this is good I got a bunch of users it looks like these are users in the chord undefined so something didn't work here I would have to debug this uh so the lookup is no longer by name because other is the full user but I want the lookup to be by other dot name so let's just see if this works now great so I'm exactly the same as all three of these people because all three of these people rated Star Wars Episode one with a two and we can see here's the here's poor people here here's four is this five people all three five people okay but now I could start to get some more interesting similarity scores by rating more movies so here are the five most similar users to be here something that I'm just really bothering me once a nice little function at least for like looking at stuff is a number format so what I'm going to do is I'm going to say score equals number format and I'm going to format the similarity score and what number format does is I could say give me this many leading decimals and this many trailing decimals so I could say something like you know one comma two and so if I do that what I'm going to get now is this so here now what I'm doing if this looks so horribly ugly but design aside at least I'm getting just the similarity scores with and I could with just two decimal places even if they go on for much more okay what is you're getting so many of the same score because it's just a very small small data set this would work so much more this would work so much better if I had if raises a thousand movies and then I had a huge database of other user ratings now scale is also a problem the algorithm then went really slow and there's ways around that but I will get to at some point I forgot the force awakens oh yes but no but I didn't forget it in the data set right it's in movies JSON yeah yeah I just forgot it in here okay so let me add that in thank you let's include the force awakens' here and force awakens' things back there we go okay thank you for that okay we're finally ready now what I can do is get a rating for a particular movie that I the new user has not seen and after all isn't that what we're here for to figure this out and make me you fast forwarded all the way to this point of the video if you did we're good we're here okay what do I need to do I need to find the place where I I need to find the place in the code where I create all those divs I need to refactor this because I don't want to look at the five nearest people I want to use the five nearest people to compute some guesses for movies I haven't rated so first of all you need to keep track of the movies that I haven't read it so let's do that where cuz I do that here is so so let's just do that here so first let's create an array so called new titles and what I'm going to do is Bauer ie equals zero I equals data titles do I already have titles here somewhere I think I have just this is a very silly way of doing this but titles you know I don't need to create a separate array I need to go through all the titles I had less than what I want to do is go through all the titles and find out have I not seen that movie yet so I'm going to save our title if bar title equals titles index I if a my new user in here where am i phone user if and do I have access to titles now I need to say data titles data titles if user index title equals equals null now with the time create div title creative title so I want to do a result P parent Oh No yeah no no no did this should be div parent results P I had that wrong so I want to put the div inside that but that's something I want to do this creative title result gives push and then div dot parent title I just want to see the title we're going to get to this in a second this tough way that should be a really long time what brain is melting this should just give me on the HTML page of movies that I want to have my predicted ratings for ready here's a rating here's a rating submit okay cannot read property appendchild of know div dot parent not title result P try this again okay so now what is what is the button go up here and holiday went down here that is craziness what is craziness this is somehow getting parented what have I done what crazy weird thing have I done oh I know why so I need to put the head a variable and parentage okay everything's going to be okay can you hear my stomach rumbling okay here we go great so I should see a list of everything but episode 1 in episode 4 perfect so now I need to predict the star rating for those we're getting so close so now that I know this is a title I need to get a prediction for this is where I now want to look at the five nearest neighbors okay it's gotta be okay so let's get rid of this div for a second and right now I am going to look at five nearest neighbors okay so I don't care about their name but I do care about their score don't care about number formatting it because what I want to do is I want to okay how do I do this prediction I want to basically take a weighted average of all of the neighbors so let's think about this in using the whiteboard for a second okay so for example if we imagine just a 2dimensional space and if there were just two movies like episode 4 and episode you know 7 you know I could put plot everybody's you know this is somebody who rated episode 4 with 4 stars but episode 7 with 1 star right would be over here so what I want to do is I'm a new user and I'm somewhere here what I want to do is and I've only rated well this is good getting confusing okay so what I want to do is I want to look at the people who are nearest to me maybe the five nearest ones this is and make a prediction but I want to wait I don't have to do this I could just take the average of all of these but what I want to do here is I want to wait this person who's to me I want to wait the prediction that I have for there I want to wait their movie rating more heavily than somebody who's a little bit further so how am I going to do that so first let's actually just take an average of the K nearest neighbors ratings over that particular title so what do I want to forget about the similarity score for a second what am i doing here so what I want to do is get all of the ratings user title isn't right okay so how do I done the ratings are from that users my variable naming is pretty poor here and I need to do a better job with that but users remember is the lookup table of all of the users user right now is me I should probably not call it your really regain this stuff and I maybe I'll refactor this when I publish the code okay I want to get some ratings from all of the users for one particular so that's Nate okay so these are all the ratings for one particular four and now what I want to get is the actual rating is the ratings index two title right so first I need the user the knearest user where's name coming from wait a second users okay hold hold your horses I I went a little nuts here users index K forget about the name I can get the simple I'm gonna get the similarity score but the name K is what I want come on we can do this I want to look at that particulars it's sorted I'm going to get the ratings for that particular user I'm gonna get the rating for this particular title then I'm going to add them all together some plus equals that rating then what do I do some divided it equally k and now here we go I can make a nice little div and what does that div going to have in it it is going to have the title whoever I look at you're over there it's going to have the title plus a colon plus some and I'm going to just say stars equals that sum divided by K that's going to be the stars and I'm also going to number format it so that it's with a with a one leading digit and two decimal places okay here we go now this isn't good if there's a lot there's a bunch of things I want to do this to make this better and then talk about whole sorts of things that I've missed but I think we're somewhere there with me the like episode one don't like F so ii don't like episo and like episode 5 for a bit ah cannot read proper TV of undefined at fine years neighbours okay let's see if we can fix this sketch line 83 oh this is it what is ratings is okay let's think about this users is the lookup table data dot users I see I've done a lesson learned I may be what I'm going to do after this video is do a separate video where I just refactor this to make it with better variable names and make it more organized in a way that I could fall I've done a terrible job this is really the lesson in poor code management but hopefully you're learning something I see me what I wanted to look at the array is actually data dot users data is the stuff I loaded from JSON so data dot users is my array users was my lookup table so this is what I want let's see how this goes I can't 700 no I think why infinite loop right I think I froze in the browser Oh Oh terrible terrible terrible error look at this I I'm not paying close attention and I'm in a loop within a loop and I use I twice which is absolutely absolutely a disaster so no wonder I had an infinite loop let's change this to J okay I'm feeling slightly more confident now I really should stop doing I got these star ratings so and so I really think that I should have so I should really be seeing episode 5 or 6 and I'm really not going to like the holiday special this ten by the way has been in the way all the time okay so we're doing well this is pretty good and I really should quit while I'm ahead even though I'm not very far ahead I'm Way behind but we've now got a prediction engine I would be nice to sort these I'd probably want to sort these I can leave that as an exercise for you but I absolutely should do the weight I should do a weighted sum so let's at least add this and I'm seeing it in the chat I'm going to do it right now okay and I should add some emojis to this because can you receive some some happiness some smiles hearts in my chat okay here we go okay so now what I want to do is let's use that similarity score score equals similarity scores okay similarity scores in next name that what is the name so okay so the name is data users index J name so remember the name again I don't know I love the way I've organized this the similarity scores are in a separate lookup table than the original data so the data which I really Clyde should have put that in the original data but anyway the name is coming from the sorted array of users the score then it's coming from the similarity scores and then the rating is also in that original lookup table so now the weighted sum okay so a couple things I should do I need the I need this the weighted sum and then I need the similarity some I'll try to explain this I think in a minute so I need two different sums here so what I need to do is add up the weighted sum equals the ratings times the similarity to score and I don't know maybe I'll call this sin for similarity so this is the weighted sum its the rating time now remember if they're really similar the similarity score is 1 if they're not very similar the similarity score is 0.1 the reason why I also this reason why I need this similarity thumb is that what this is what to get the average like if I add up five things and divide by five I have an average but I'm not adding up five things now and adding up five things weighted by similarity so what I actually want to do is the number of stars is the weighted sum books is the weighted sum divided by the similarity sum so this is actually going to give me the weighted average does this make sense to you if it doesn't ask in the comment maybe I can sort of answer this again another time or make another video but now I have the weight of something the other thing here is it's very likely in a more elaborate system that the user is not going to have rated all every user is not going to have rated every other movie so I would add need to do an error check to make sure I should do that here so I should check as long as rating is not equal to null that could be no then I add this up and this is going to work so there could be a thousand movies it's only going to add up the ones that that particular user has rated okay okay here we go okay here we go here we go here we go here we go and I am now going to rate some movies ah stuff using the sound effects for no no I really don't like episode one or two three was kind of okay you know these are all good no that's this is a good one come on Empire Strikes Back Return of the Jedi I like Alex seven okay here we go so what will be my estimated star rating for rogue one in the 1977 I think that's on whatever the Star Wars Holiday Special my the guess is I'm going to rate road one and three point nine six stars and holiday at one 26 stars we did it okay I wish I could play some Star Wars sound effects but I'll get a copyright problem so this is now a recommendation engine it has got a very limited data set there's a lot of problems with this but let's think about what are some things you could do with this going forward first of all you could think about a whole other context of what you might use this in I mean think about similarities and predictions of Ray it doesn't have to be you know product ratings moving ratings you can think about any property associated with a person a thing you know think about word counts what if you look at like all the emails sent to yours all the emails sent for all of your friends and you counted all the words in all those emails essentially those word counts are equivalent of star ratings for each word can you find similarities between your friends can you predict so this is sort of laying the foundation of how you might do spam filtering for example so there's a lot of ways you could think about a data set that's full of key value pairs and how you might have a lot of data points and make predictions based on that and that's what's happening here that said maybe you're interested in doing something really close to this like a movie recommendation system getting your own data set now here's a challenge for you I've met a lot of this code I should thank again I'm building this based on after having read this collective intelligence book I put a link to this book in this video's description something you might think about is okay what makes you think about movie lens so there is a website called movie lens and movie lens has a giant dataset with 20 million ratings so you could actually build this exact same program with a large massive data set now you're going to have a lot of issues all of a sudden with performance and so how do you approach that now that's a topic for a whole other video but that's kind of a challenge for you and something that you'll notice here is I have to go through every single other user because this is all and looking up everything by user but I could have some precomputed lookup tables that kind of know something about how movies are similar based on user ratings and calculate calculate the predictions based on movie similarities as well so I think it up this is covered in this book maybe I'll come back and do another video on that and explain that very well but this is user base you can do something that's item based and that's going to really improve speed maybe if you use a database and have some pre computed lookup tables in certain ways it's other ways you could approach it write in the comments ways that you think about like how you might do this with a large data set but even just redesigning doing a better interaction building a like actual serverside program that saves stuff in a database I would encourage you to go do something creative with this something strange something useless something playful and share with me so thanks for watching and I'll see you in a future coding challenge video thing etc good bye you
