With timestamps:

00:00 - okay here we are it is time I am going
00:04 - to draw into this canvas a kitty cat and
00:07 - then I'm going to have something show me
00:09 - here tell me is that a cat or is that a
00:12 - rainbow or is that a train now before I
00:15 - can get to that I want to first at least
00:17 - make this somewhat interactive that I
00:18 - can train for an epoch just by pressing
00:21 - this button I can press this button to
00:23 - run the test to see how many things I've
00:25 - got correct so I did some things in
00:27 - between the last video in this video I
00:29 - added the buttons here in HTML
00:32 - I used my magical advanced CSS abilities
00:36 - to to alter how those buttons appear I'm
00:39 - now I am now officially a graphic
00:42 - designer and I have also by the way
00:47 - moved some of my code into separate
00:49 - JavaScript files so the trainee pok
00:51 - function and the test all function are
00:53 - in this javascript file and I have this
00:56 - data prep javascript file just to kind
00:58 - of move things around so the first thing
01:00 - that I want to do is I want to be able
01:03 - to attach events to those buttons so I
01:06 - want to say train button equals select
01:10 - and I'm using the p5 Dom function train
01:13 - and then I'm going to say train button
01:15 - mouse pressed and I will yeah yeah I'm
01:23 - just gonna say write train epoch so this
01:27 - will run the Train epoch function once
01:30 - and the if you don't know about arrow
01:36 - notation or then you can check out my
01:40 - video about that but I'm trying to use
01:41 - it a bit more in cases like this test
01:45 - button a select test and then I can say
01:51 - test button dot mousepressed and do the
01:55 - same thing now here's the thing that I'm
02:01 - gonna actually write this function out a
02:03 - little bit actually so hold on a second
02:07 - I like I want to use the arrow functions
02:12 - but I really just
02:13 - refactor refactor later let's make this
02:15 - let's make this easier to read
02:18 - EPOC so well I'll write an anonymous
02:22 - function that's okay I can handle that
02:25 - you can convert it in your head to an
02:28 - arrow function I'm going to call train
02:30 - epoch I'm gonna have a variable called
02:33 - epoch counter which is equal to zero I'm
02:37 - going to say epoch counter plus plus and
02:41 - then I'm just gonna say create it
02:43 - actually I'm just gonna console.log it
02:45 - console.log and I'm gonna do exactly
02:48 - what I did here but I'm gonna say
02:52 - console.log epoch counter so every time
02:56 - I press that button it's going to train
02:59 - for an epoch increase the counter and
03:01 - console.log that and I'm gonna do almost
03:06 - the same sort of thing with the test
03:08 - button and test button test all and then
03:15 - I want to get the percentage correct
03:19 - test all I'm gonna say
03:22 - percent is percent and let me let me at
03:26 - least number format that number format
03:28 - percent - comma - and then let me also
03:33 - add a percent sign and one of these days
03:36 - what's that thing you can do in es6 now
03:38 - the back ticks I'll get to that at some
03:39 - point okay so this is what I'm doing
03:44 - I'll have a train button and a test
03:46 - button let's see let's see how this goes
03:51 - I am going to train let me just test
03:56 - cannot read property length of undefined
03:59 - all right so one goofy thing that I set
04:01 - up here is I've got to pass in the data
04:03 - that I'm using which I sure I could
04:07 - refactor in a way which I don't need to
04:08 - do that but 30 to pursue do I not have
04:12 - the 100 times in there let's I thought
04:15 - in my train test I thought oh let me let
04:20 - me multiply it by 100 so the percent
04:22 - right is point 35 but I want to multiply
04:24 - it by 100 so I see
04:26 - 35% 35.5%
04:29 - so we could see test test test no matter
04:32 - what
04:32 - now I'm gonna train unfortunately this
04:35 - is all blocking I would want to do
04:37 - something and I could use es6 and
04:41 - promises or I could probably set time
04:42 - out there various ways that I could make
04:44 - this asynchronous so that it didn't look
04:46 - browser didn't freeze up while it's
04:48 - doing the training but I trained for one
04:50 - epoch I test it again and I got 78% so
04:53 - now at least we've got this interactive
04:55 - I can kind of keep pressing train if I
04:59 - have the patience to do it and see if it
05:02 - improves a little bit 80% now here's the
05:05 - thing let's do something really exciting
05:08 - what I'm going to do right now is I'm
05:11 - going to add a draw function actually
05:14 - I'm not even gonna add a draw function
05:15 - I'm gonna add a mouse drag function
05:19 - right whenever yeah I'm gonna add a draw
05:23 - function know how to draw function and
05:25 - I'm gonna say stroke weight eight line P
05:33 - Mouse X P Mouse Y so this is in p5 the
05:38 - previous Mouse position then I'm going
05:41 - to add Mouse X Mouse Y then I'm gonna
05:48 - see what that looks like I don't see
05:50 - anything probably because I need to say
05:52 - I want what I'm drawing to be white
05:57 - there we go
05:59 - but now I want to only draw if I'm
06:01 - pressing on down on the mouse so I'm
06:03 - gonna say if mouse is pressed so now if
06:11 - mouse is pressed so I could draw my own
06:15 - cat
06:20 - I'm gonna work really hard on this I
06:23 - don't have a way so now all I need to do
06:25 - right all you need to do is grab the
06:28 - pixels of what I've just drawn and turn
06:31 - it into a 28 by 28 image that I sampled
06:35 - down and normalize to 780 for inputs
06:39 - give it to the neural network and have a
06:41 - neural network say so let's see if we
06:46 - can make that happen
06:47 - okay so what do I do now I'm gonna need
06:50 - another button and I'm gonna call this
06:56 - button guess and now I'm gonna say I'm
07:02 - gonna just grab all this code and I'm
07:05 - gonna say guess button equals select
07:08 - guess and when I press the mouse on that
07:13 - button what do I need to do so the first
07:15 - thing I need to do is I need to somehow
07:17 - make an inputs array I thought I need I
07:20 - need an input array with a bunch of
07:21 - numbers between 0 and 1.0 according to
07:24 - the pixels of what I've drawn what would
07:27 - be the best way to do this I could just
07:30 - read the pixels but it's 280 by 280 I
07:34 - think I can use copy I think are get I
07:38 - got an idea I think I can say let image
07:43 - equal get so I think the get function in
07:48 - p5 just grabs all the pixels from the
07:52 - canvas and makes it into a p5 image
07:54 - object so let's see what that does if
07:57 - I'm right about that yep I got an image
08:01 - that's 280 by 280 now what I could do is
08:05 - I could say image dot resize to 28:28
08:10 - let's take a look at that now I have an
08:13 - image that's 28 by 28 now let me load
08:19 - the pixels and guess what
08:21 - guess what everybody we are just right
08:23 - back to where we were earlier when we
08:25 - instead of reading in those bytes and
08:28 - turning them into pixels I now have
08:29 - pixels that I essentially want to turn
08:31 - into bytes so what I'm going to do is
08:33 - right
08:33 - a nice little loop I equals zero I is
08:36 - less than image pixels dot length and
08:40 - I'm gonna do something a little goofy
08:41 - here I'm gonna say I plus equal four so
08:45 - here's the thing this is by definition a
08:48 - grayscale image right I can't put
08:53 - anything but black white or grey in
08:55 - between here and so what what I want to
09:02 - do I'm thinking here I'm thinking here
09:04 - is that the red the green the blue
09:06 - values of each pixel are all going to be
09:08 - the same so I can actually just skip
09:10 - every four elements in that pixel array
09:12 - because the pixel array is RGB a RGB a
09:16 - RGB a so I should be able to look at
09:19 - just every fourth pixel every fir not
09:22 - every fourth pixel every fourth element
09:24 - of the array and say the the brightness
09:28 - is that image dot pixels index I and
09:34 - then inputs now here's the thing that's
09:39 - a little bit awkward I should be able
09:40 - say I divided by four mmm you know what
09:42 - I'm gonna do I prefer to say remember
09:46 - that variable I had called length let me
09:49 - use that that should be 784 another way
09:52 - I could do it is just say I times four
09:55 - right to skip ahead every four and then
09:58 - say inputs index I equals bright / 255
10:04 - now let me just say console dot log
10:07 - inputs I just want to look at that did I
10:11 - am I getting an array that is 200 that
10:14 - is 784 floating point numbers long with
10:18 - each value normalized between 0 and 1
10:19 - let's see let me just draw some stuff in
10:22 - here good guess and there we go now can
10:26 - I find ooh oh yeah yeah there we go look
10:30 - at this so it is working I mean I could
10:33 - have made a mistake somewhere but this
10:34 - seems about right so you know I I could
10:36 - be more thoughtful about drawing in a
10:38 - softer way that mirrors the doodles a
10:40 - little bit more and the thickness is
10:41 - really going to matter so I'm going to
10:44 - have to figure it out now I'm
10:46 - being asked in the chat shouldn't it be
10:48 - the other way around black-on-white well
10:50 - here's the thing in all of my previous
10:52 - videos if I open up my processing sketch
10:56 - and this is a sort of point of confusion
11:00 - if you recall this is going to take a
11:04 - little while to load so I'm gonna talk
11:07 - while it's loading if you recall when I
11:10 - did all this stuff previously you did
11:12 - see a black pencil doodle on a white
11:17 - background which is this however what I
11:20 - did the moment I wanted to offer draw
11:22 - the pixels was I reversed it the data
11:25 - actually in the data set is the other
11:27 - way around
11:28 - so so machine learning wise I'm matching
11:33 - it correctly what I might choose to do
11:36 - just to like make this a bit visually
11:38 - more appealing is I might choose to just
11:42 - to be consistent here is let me go back
11:44 - to sketch where's my draw function where
11:48 - is that draw function what just happened
11:54 - did I put that draw function like Oh put
11:56 - the draw function in train test that was
11:59 - by accident let me move that back to
12:01 - sketch I'm gonna change the background
12:06 - to 255 and I'm going to change the
12:12 - stroke to zero and then I'm gonna do
12:15 - something weird which is I'm actually
12:17 - say 255 minus bright I'm gonna reverse
12:19 - it when I turn it into the data so I can
12:22 - actually look at it like this you know I
12:25 - kind of now in the canvas is white but I
12:28 - have an idea I'm gonna go I'm gonna say
12:31 - body can I say like background color and
12:34 - let's just make this some like light
12:36 - gray look at me look at me by CSS yeah I
12:39 - could see now you know this is what I'm
12:42 - drawing my cat so let's press so let's
12:46 - press guess and we can see it's still a
12:48 - whole lot of zeros so I think I'm good I
12:51 - think things are looking good okay now
12:55 - what I need to do is now let
13:00 - guess equal neural network dot predict
13:03 - those inputs and remember I did this in
13:06 - the testing I then already figured out
13:09 - the code in the testing to get that
13:15 - classification right remember this I
13:17 - have to find the highest in the in the
13:19 - outputs I have to find the highest one
13:21 - and what index that is and so now I am
13:26 - going to say maximum classification and
13:31 - this is really goofy but I'm just gonna
13:33 - say if classification equals cat this is
13:39 - like the worst code anybody could ever
13:41 - write but I'm just going to do it this
13:45 - way just to get this done and I'm gonna
13:49 - let those of you watching create your
13:51 - own variation of this with an actual
13:53 - interface and be more thoughtful about
13:57 - how you how you end end this up I got
14:01 - one more train console.log train ok are
14:08 - we ready are you ready are we ready I
14:11 - think we are so here we go so I'm gonna
14:14 - draw what I think is a cat some whiskers
14:24 - some whiskers I don't know and a little
14:28 - smiley old okay now I'm gonna guess what
14:31 - is that it's a rainbow of course it's a
14:34 - rainbow
14:35 - I haven't trained it yet so I shouldn't
14:37 - give I got the right answer we'd have
14:39 - gotten just very very lucky now I am
14:42 - going to run the training ok it's
14:46 - training it's thinking it's gonna train
14:49 - for one it would be nice to have an
14:51 - animation I'm doing a different one
14:52 - let's just run the testing you know it's
14:55 - getting the test data right 80% of the
14:57 - time so even if at best this is going to
15:02 - fail one out of twenty percent of the
15:04 - time which is quite often you remember
15:07 - recent events in our history here ok a
15:09 - guess a train
15:13 - let's train it one more time please II
15:16 - didn't think it was a rainbow this time
15:18 - let's train for another epoch try to get
15:20 - a little more accuracy here I think I
15:23 - can Orma lies the data correctly let's
15:29 - run the tests again 82% let's guess
15:31 - train so a sound board doesn't work it's
15:37 - a train everybody and goodnight thank
15:41 - you very much this is the end of this
15:42 - video
15:42 - alright alright well let's go back and
15:47 - do that again I mean I thought I'm very
15:49 - happy with it to fail but at least now I
15:51 - have the sound effects it'll be more
15:52 - entertaining okay all right I'm going to
15:57 - draw for myself a cat you know what I
16:00 - think this isn't thick enough one thing
16:03 - I should do let's let's actually let's
16:04 - take a look one thing that I could do
16:06 - here I want to see the resized image so
16:12 - let's make this a little bit thicker
16:14 - when I'm drawing I think that's gonna
16:16 - help where am i drawing again in the
16:17 - draw function let's make this 24 I think
16:22 - this is gonna be oh I don't know that's
16:24 - I'd have to look back at the training I
16:26 - don't know I think it was actually fine
16:27 - let's just make it 16 okay that's a
16:28 - little bit better so I'm gonna try to
16:30 - make a cat but actually one thing that I
16:35 - wanted to is when I press the guest
16:37 - button I kind of want to see that
16:39 - resized image where is that so let me
16:43 - also let's just see if I can I'm just
16:47 - gonna draw it image guess 0 0 I just
16:51 - want to be able to see it like whoops
16:55 - execute draw image on mmm oh not the
17:00 - guess image image I just want to see
17:06 - what it looks like yeah that's the
17:07 - smaller version of it I think that's
17:08 - okay that kind of feels like what the
17:10 - doodles look like so let's try ok I'm
17:15 - gonna draw a cat
17:16 - I really should probably use the rainbow
17:21 - give it some nice whiskers
17:25 - and now I'm gonna guess what is this now
17:27 - I haven't trained the neural network at
17:29 - all so I really I just have like a one
17:31 - out of three chance of getting it right
17:35 - it's a train and look there's my doodle
17:40 - sample down so that's not correct but of
17:44 - course it shouldn't be correct
17:46 - now let's train the neural network and
17:49 - it's gonna have to wet we're gonna train
17:50 - for a bebop here we're training okay
17:59 - we trained let's run the testing just to
18:03 - see 75% okay that's pretty good
18:06 - let's guess it's still a train I do want
18:10 - to point out though whoa what am i
18:13 - console logging here and why was it
18:15 - different something weird is good oh you
18:18 - know what because it's got all these
18:20 - pixels there now in the canvas ah so
18:22 - that was bad idea for me to draw that up
18:24 - there that was sort of just for
18:25 - debugging let's try this again let's
18:29 - draw a rainbow rainbow my people were
18:31 - recognizable okay so I'm gonna draw my
18:34 - rainbow right that's my rainbow I'm
18:40 - gonna guess it's it always thinks it's a
18:42 - train let's run the test data set it got
18:46 - 33 percent correct let's actually train
18:49 - the network not a rainbow probably it's
18:57 - very unlikely that this will work in any
18:59 - way
19:00 - oh we finished okay now here we go I'm
19:05 - now gonna guess again I can't brother
19:09 - look
19:12 - alright fine five five months let's
19:14 - train it one more time you need to e box
19:19 - for it not to just always think it's a
19:21 - train I'm kind of suspicious here that
19:23 - something might be going wrong it always
19:25 - thinks it's a tree it's a conspiracy
19:27 - because its second coding train alright
19:30 - we did two epochs
19:32 - let's run the test again hey art our
19:35 - accuracy went up from 33% to 80% I
19:38 - really should get rid of these
19:38 - unnecessary console logs and I'm gonna
19:41 - guess again here we go definitely gonna
19:45 - just say train it's me oh I get trained
19:50 - by accident you pok3 test 81% okay here
20:01 - we go yeah at least I got cat I mean we
20:11 - got to be happy that we got cat right
20:12 - let's train again I mean 20% of the time
20:17 - it's gonna be wrong and most likely more
20:21 - than that now is it did I do it is my
20:23 - data is the new data formatted exactly
20:26 - right
20:28 - okay did another epoch 81%
20:39 - all right I'm gonna pause for a minute
20:42 - here and investigate to make sure there
20:43 - isn't anything horribly wrong because
20:46 - what could be wrong I mean I'm not
20:48 - surprised as isn't working but if my
20:50 - data the way that I'm passing it and
20:52 - formatting the data is not the way it
20:55 - was trained then we've got an issue hold
20:58 - on everyone there's actually kind of a
21:01 - major problem right here I was being all
21:05 - fancy refactor we got to use this map
21:07 - function but that makes these inputs
21:11 - restricted to you into eight thingies
21:14 - integers only a zero or one I really
21:16 - want to just divide by 255 and make them
21:19 - nice floating-point numbers so I could
21:20 - go back to my loop or apparently I could
21:25 - say array from data dot map I believe
21:34 - this will create a new array and let me
21:36 - just check that in the testing I'm gonna
21:40 - say console dot log inputs and let me
21:46 - run test and now we can see yes this is
21:49 - a regular array with numbers that are
21:55 - somewhere in here oh let me look in the
21:58 - middle that are floating point numbers
21:59 - okay this is good this could be the
22:01 - source of a lot of our problems so let
22:05 - me take this and put this also here so
22:10 - that fixes it for the training and now
22:12 - oh and by the way while I was taking
22:17 - that break I added a Clear button and
22:19 - let me just show you the code for that
22:24 - trying to figure out what was wrong in
22:27 - sketch AS there is now a Clear button
22:31 - and all that Clear button does is draw
22:33 - the white background so we are ready to
22:36 - attempt again hopeful let's just see by
22:42 - the way what does it think an empty
22:44 - image is it thinks it's a train because
22:47 - as we know it's always a train
22:51 - maybe I should try drawing a tree let me
22:54 - draw the rainbow I feel like the
22:56 - rainbows got to be the most recognizable
22:57 - and I meet by the way I made the stroke
22:59 - a little bit thinner and I don't know
23:02 - let's make this the rainbow okay so now
23:05 - first of all I haven't trained it yet
23:07 - let's guess it still thinks of to train
23:09 - obviously
23:11 - let's test oh I forgot to have that
23:12 - console.log 31% I want to get rid of
23:16 - that console.log in train test let's get
23:24 - rid of that so let me start over here
23:26 - for a second and let me draw my rainbow
23:29 - and let me guess it is of course a train
23:33 - as it always is let's run the test we
23:36 - got 30% right because we're just
23:38 - guessing let's train for an epoch
23:48 - oh it's finished I get so involved with
23:54 - my dance let's we got 84 85 percent
23:57 - correct this is good
23:59 - let's now guess it's a cat watch look
24:06 - it's got whiskers and a little like
24:11 - little ears and it is totally I catch it
24:16 - has guessed a cat
24:18 - let's clear and let's try drawing a
24:21 - train this is my train it's got a big
24:26 - choo-choo thing
24:28 - there's my train this is the coding
24:38 - train so I'm there's so much that could
24:41 - be improved here the real problem is
24:44 - that I am using a tiny data set the
24:48 - other problem is I haven't been really
24:51 - so thoughtful about thinking about this
24:53 - spatially I'm flattening this image into
24:57 - one vector of pixels and you know where
25:01 - where it's the using a so called
25:04 - convolutional layer in advance of this
25:07 - what this is over this like final layer
25:09 - is something that could actually help
25:11 - this to work much more accurately I hope
25:13 - to come back to that in a future video
25:15 - also probably adding softmax and
25:18 - cross-entropy are going to be a way to
25:20 - sort of squeeze out a little bit more
25:22 - accuracy but ultimately what i wouldn't
25:25 - be curious for you to do if you're
25:27 - watching this I'm gonna there's gonna be
25:28 - more videos in this playlist but this is
25:30 - if you're watching this you're gonna and
25:33 - they don't exist yet what I would love
25:35 - for you to do is think about a way that
25:37 - you can try this with larger data try
25:41 - this with animation and think about ways
25:45 - to make this a bit more robust make it
25:48 - more creative and goofy and fun but
25:50 - we've got the basic idea here so share
25:53 - with me what you make all the code for
25:55 - this will be published there's so much
25:57 - more to do with it
25:58 - but we've got a basic
26:01 - doodle classifier that mostly thinks
26:04 - things are trains so thanks for watching
26:06 - the coding train after this video ended
26:11 - I went and tried a whole bunch of other
26:14 - drawings and they worked so right now
26:16 - you're going to see a quick montage of
26:18 - those moments where it worked
26:20 - let me draw a cat well I'm hungry I'm
26:25 - tired it's been a long week I'll be back
26:26 - next Friday this is my cat look at this
26:35 - this is getting okay you know I got a 1
26:39 - out of 3 chance
26:48 - [Music]
26:52 - you

Cleaned transcript:

okay here we are it is time I am going to draw into this canvas a kitty cat and then I'm going to have something show me here tell me is that a cat or is that a rainbow or is that a train now before I can get to that I want to first at least make this somewhat interactive that I can train for an epoch just by pressing this button I can press this button to run the test to see how many things I've got correct so I did some things in between the last video in this video I added the buttons here in HTML I used my magical advanced CSS abilities to to alter how those buttons appear I'm now I am now officially a graphic designer and I have also by the way moved some of my code into separate JavaScript files so the trainee pok function and the test all function are in this javascript file and I have this data prep javascript file just to kind of move things around so the first thing that I want to do is I want to be able to attach events to those buttons so I want to say train button equals select and I'm using the p5 Dom function train and then I'm going to say train button mouse pressed and I will yeah yeah I'm just gonna say write train epoch so this will run the Train epoch function once and the if you don't know about arrow notation or then you can check out my video about that but I'm trying to use it a bit more in cases like this test button a select test and then I can say test button dot mousepressed and do the same thing now here's the thing that I'm gonna actually write this function out a little bit actually so hold on a second I like I want to use the arrow functions but I really just refactor refactor later let's make this let's make this easier to read EPOC so well I'll write an anonymous function that's okay I can handle that you can convert it in your head to an arrow function I'm going to call train epoch I'm gonna have a variable called epoch counter which is equal to zero I'm going to say epoch counter plus plus and then I'm just gonna say create it actually I'm just gonna console.log it console.log and I'm gonna do exactly what I did here but I'm gonna say console.log epoch counter so every time I press that button it's going to train for an epoch increase the counter and console.log that and I'm gonna do almost the same sort of thing with the test button and test button test all and then I want to get the percentage correct test all I'm gonna say percent is percent and let me let me at least number format that number format percent comma and then let me also add a percent sign and one of these days what's that thing you can do in es6 now the back ticks I'll get to that at some point okay so this is what I'm doing I'll have a train button and a test button let's see let's see how this goes I am going to train let me just test cannot read property length of undefined all right so one goofy thing that I set up here is I've got to pass in the data that I'm using which I sure I could refactor in a way which I don't need to do that but 30 to pursue do I not have the 100 times in there let's I thought in my train test I thought oh let me let me multiply it by 100 so the percent right is point 35 but I want to multiply it by 100 so I see 35% 35.5% so we could see test test test no matter what now I'm gonna train unfortunately this is all blocking I would want to do something and I could use es6 and promises or I could probably set time out there various ways that I could make this asynchronous so that it didn't look browser didn't freeze up while it's doing the training but I trained for one epoch I test it again and I got 78% so now at least we've got this interactive I can kind of keep pressing train if I have the patience to do it and see if it improves a little bit 80% now here's the thing let's do something really exciting what I'm going to do right now is I'm going to add a draw function actually I'm not even gonna add a draw function I'm gonna add a mouse drag function right whenever yeah I'm gonna add a draw function know how to draw function and I'm gonna say stroke weight eight line P Mouse X P Mouse Y so this is in p5 the previous Mouse position then I'm going to add Mouse X Mouse Y then I'm gonna see what that looks like I don't see anything probably because I need to say I want what I'm drawing to be white there we go but now I want to only draw if I'm pressing on down on the mouse so I'm gonna say if mouse is pressed so now if mouse is pressed so I could draw my own cat I'm gonna work really hard on this I don't have a way so now all I need to do right all you need to do is grab the pixels of what I've just drawn and turn it into a 28 by 28 image that I sampled down and normalize to 780 for inputs give it to the neural network and have a neural network say so let's see if we can make that happen okay so what do I do now I'm gonna need another button and I'm gonna call this button guess and now I'm gonna say I'm gonna just grab all this code and I'm gonna say guess button equals select guess and when I press the mouse on that button what do I need to do so the first thing I need to do is I need to somehow make an inputs array I thought I need I need an input array with a bunch of numbers between 0 and 1.0 according to the pixels of what I've drawn what would be the best way to do this I could just read the pixels but it's 280 by 280 I think I can use copy I think are get I got an idea I think I can say let image equal get so I think the get function in p5 just grabs all the pixels from the canvas and makes it into a p5 image object so let's see what that does if I'm right about that yep I got an image that's 280 by 280 now what I could do is I could say image dot resize to 2828 let's take a look at that now I have an image that's 28 by 28 now let me load the pixels and guess what guess what everybody we are just right back to where we were earlier when we instead of reading in those bytes and turning them into pixels I now have pixels that I essentially want to turn into bytes so what I'm going to do is right a nice little loop I equals zero I is less than image pixels dot length and I'm gonna do something a little goofy here I'm gonna say I plus equal four so here's the thing this is by definition a grayscale image right I can't put anything but black white or grey in between here and so what what I want to do I'm thinking here I'm thinking here is that the red the green the blue values of each pixel are all going to be the same so I can actually just skip every four elements in that pixel array because the pixel array is RGB a RGB a RGB a so I should be able to look at just every fourth pixel every fir not every fourth pixel every fourth element of the array and say the the brightness is that image dot pixels index I and then inputs now here's the thing that's a little bit awkward I should be able say I divided by four mmm you know what I'm gonna do I prefer to say remember that variable I had called length let me use that that should be 784 another way I could do it is just say I times four right to skip ahead every four and then say inputs index I equals bright / 255 now let me just say console dot log inputs I just want to look at that did I am I getting an array that is 200 that is 784 floating point numbers long with each value normalized between 0 and 1 let's see let me just draw some stuff in here good guess and there we go now can I find ooh oh yeah yeah there we go look at this so it is working I mean I could have made a mistake somewhere but this seems about right so you know I I could be more thoughtful about drawing in a softer way that mirrors the doodles a little bit more and the thickness is really going to matter so I'm going to have to figure it out now I'm being asked in the chat shouldn't it be the other way around blackonwhite well here's the thing in all of my previous videos if I open up my processing sketch and this is a sort of point of confusion if you recall this is going to take a little while to load so I'm gonna talk while it's loading if you recall when I did all this stuff previously you did see a black pencil doodle on a white background which is this however what I did the moment I wanted to offer draw the pixels was I reversed it the data actually in the data set is the other way around so so machine learning wise I'm matching it correctly what I might choose to do just to like make this a bit visually more appealing is I might choose to just to be consistent here is let me go back to sketch where's my draw function where is that draw function what just happened did I put that draw function like Oh put the draw function in train test that was by accident let me move that back to sketch I'm gonna change the background to 255 and I'm going to change the stroke to zero and then I'm gonna do something weird which is I'm actually say 255 minus bright I'm gonna reverse it when I turn it into the data so I can actually look at it like this you know I kind of now in the canvas is white but I have an idea I'm gonna go I'm gonna say body can I say like background color and let's just make this some like light gray look at me look at me by CSS yeah I could see now you know this is what I'm drawing my cat so let's press so let's press guess and we can see it's still a whole lot of zeros so I think I'm good I think things are looking good okay now what I need to do is now let guess equal neural network dot predict those inputs and remember I did this in the testing I then already figured out the code in the testing to get that classification right remember this I have to find the highest in the in the outputs I have to find the highest one and what index that is and so now I am going to say maximum classification and this is really goofy but I'm just gonna say if classification equals cat this is like the worst code anybody could ever write but I'm just going to do it this way just to get this done and I'm gonna let those of you watching create your own variation of this with an actual interface and be more thoughtful about how you how you end end this up I got one more train console.log train ok are we ready are you ready are we ready I think we are so here we go so I'm gonna draw what I think is a cat some whiskers some whiskers I don't know and a little smiley old okay now I'm gonna guess what is that it's a rainbow of course it's a rainbow I haven't trained it yet so I shouldn't give I got the right answer we'd have gotten just very very lucky now I am going to run the training ok it's training it's thinking it's gonna train for one it would be nice to have an animation I'm doing a different one let's just run the testing you know it's getting the test data right 80% of the time so even if at best this is going to fail one out of twenty percent of the time which is quite often you remember recent events in our history here ok a guess a train let's train it one more time please II didn't think it was a rainbow this time let's train for another epoch try to get a little more accuracy here I think I can Orma lies the data correctly let's run the tests again 82% let's guess train so a sound board doesn't work it's a train everybody and goodnight thank you very much this is the end of this video alright alright well let's go back and do that again I mean I thought I'm very happy with it to fail but at least now I have the sound effects it'll be more entertaining okay all right I'm going to draw for myself a cat you know what I think this isn't thick enough one thing I should do let's let's actually let's take a look one thing that I could do here I want to see the resized image so let's make this a little bit thicker when I'm drawing I think that's gonna help where am i drawing again in the draw function let's make this 24 I think this is gonna be oh I don't know that's I'd have to look back at the training I don't know I think it was actually fine let's just make it 16 okay that's a little bit better so I'm gonna try to make a cat but actually one thing that I wanted to is when I press the guest button I kind of want to see that resized image where is that so let me also let's just see if I can I'm just gonna draw it image guess 0 0 I just want to be able to see it like whoops execute draw image on mmm oh not the guess image image I just want to see what it looks like yeah that's the smaller version of it I think that's okay that kind of feels like what the doodles look like so let's try ok I'm gonna draw a cat I really should probably use the rainbow give it some nice whiskers and now I'm gonna guess what is this now I haven't trained the neural network at all so I really I just have like a one out of three chance of getting it right it's a train and look there's my doodle sample down so that's not correct but of course it shouldn't be correct now let's train the neural network and it's gonna have to wet we're gonna train for a bebop here we're training okay we trained let's run the testing just to see 75% okay that's pretty good let's guess it's still a train I do want to point out though whoa what am i console logging here and why was it different something weird is good oh you know what because it's got all these pixels there now in the canvas ah so that was bad idea for me to draw that up there that was sort of just for debugging let's try this again let's draw a rainbow rainbow my people were recognizable okay so I'm gonna draw my rainbow right that's my rainbow I'm gonna guess it's it always thinks it's a train let's run the test data set it got 33 percent correct let's actually train the network not a rainbow probably it's very unlikely that this will work in any way oh we finished okay now here we go I'm now gonna guess again I can't brother look alright fine five five months let's train it one more time you need to e box for it not to just always think it's a train I'm kind of suspicious here that something might be going wrong it always thinks it's a tree it's a conspiracy because its second coding train alright we did two epochs let's run the test again hey art our accuracy went up from 33% to 80% I really should get rid of these unnecessary console logs and I'm gonna guess again here we go definitely gonna just say train it's me oh I get trained by accident you pok3 test 81% okay here we go yeah at least I got cat I mean we got to be happy that we got cat right let's train again I mean 20% of the time it's gonna be wrong and most likely more than that now is it did I do it is my data is the new data formatted exactly right okay did another epoch 81% all right I'm gonna pause for a minute here and investigate to make sure there isn't anything horribly wrong because what could be wrong I mean I'm not surprised as isn't working but if my data the way that I'm passing it and formatting the data is not the way it was trained then we've got an issue hold on everyone there's actually kind of a major problem right here I was being all fancy refactor we got to use this map function but that makes these inputs restricted to you into eight thingies integers only a zero or one I really want to just divide by 255 and make them nice floatingpoint numbers so I could go back to my loop or apparently I could say array from data dot map I believe this will create a new array and let me just check that in the testing I'm gonna say console dot log inputs and let me run test and now we can see yes this is a regular array with numbers that are somewhere in here oh let me look in the middle that are floating point numbers okay this is good this could be the source of a lot of our problems so let me take this and put this also here so that fixes it for the training and now oh and by the way while I was taking that break I added a Clear button and let me just show you the code for that trying to figure out what was wrong in sketch AS there is now a Clear button and all that Clear button does is draw the white background so we are ready to attempt again hopeful let's just see by the way what does it think an empty image is it thinks it's a train because as we know it's always a train maybe I should try drawing a tree let me draw the rainbow I feel like the rainbows got to be the most recognizable and I meet by the way I made the stroke a little bit thinner and I don't know let's make this the rainbow okay so now first of all I haven't trained it yet let's guess it still thinks of to train obviously let's test oh I forgot to have that console.log 31% I want to get rid of that console.log in train test let's get rid of that so let me start over here for a second and let me draw my rainbow and let me guess it is of course a train as it always is let's run the test we got 30% right because we're just guessing let's train for an epoch oh it's finished I get so involved with my dance let's we got 84 85 percent correct this is good let's now guess it's a cat watch look it's got whiskers and a little like little ears and it is totally I catch it has guessed a cat let's clear and let's try drawing a train this is my train it's got a big choochoo thing there's my train this is the coding train so I'm there's so much that could be improved here the real problem is that I am using a tiny data set the other problem is I haven't been really so thoughtful about thinking about this spatially I'm flattening this image into one vector of pixels and you know where where it's the using a so called convolutional layer in advance of this what this is over this like final layer is something that could actually help this to work much more accurately I hope to come back to that in a future video also probably adding softmax and crossentropy are going to be a way to sort of squeeze out a little bit more accuracy but ultimately what i wouldn't be curious for you to do if you're watching this I'm gonna there's gonna be more videos in this playlist but this is if you're watching this you're gonna and they don't exist yet what I would love for you to do is think about a way that you can try this with larger data try this with animation and think about ways to make this a bit more robust make it more creative and goofy and fun but we've got the basic idea here so share with me what you make all the code for this will be published there's so much more to do with it but we've got a basic doodle classifier that mostly thinks things are trains so thanks for watching the coding train after this video ended I went and tried a whole bunch of other drawings and they worked so right now you're going to see a quick montage of those moments where it worked let me draw a cat well I'm hungry I'm tired it's been a long week I'll be back next Friday this is my cat look at this this is getting okay you know I got a 1 out of 3 chance you
