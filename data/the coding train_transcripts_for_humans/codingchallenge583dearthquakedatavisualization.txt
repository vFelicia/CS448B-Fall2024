With timestamps:

00:00 - hello welcome to another coding
00:01 - challenge I'm going to build a 3d
00:03 - earthquake visualization you can see it
00:05 - right there I am going to do this in
00:07 - processing which is a Java based
00:08 - programming environment I'm going to use
00:10 - its 3d rendering capabilities I'm going
00:13 - to load a comma-separated data value
00:16 - data source from the United States
00:18 - Geological Survey with earthquake data
00:19 - I'm going to the image from NASA I'm
00:21 - going to texture it to a sphere I'm
00:23 - going to do all of that to build exactly
00:25 - this in the coding challenge and this is
00:26 - the result that I just did and I'm going
00:29 - to travel back in time the moment it
00:30 - starts decoding challenge there is a big
00:32 - issue with this which is that the actual
00:35 - earthquakes aren't aligned to that
00:36 - particular texture so that I'm leaving
00:38 - as a kind of challenge to the audience
00:40 - and I will come back next week on the
00:42 - live stream and show some solutions to
00:44 - that in addition the most confusing part
00:47 - of this video is probably this the math
00:50 - behind taking getting these almost
00:53 - building like structures to point out in
00:55 - the direction from the center of the
00:57 - sphere of the earth as a globe and to do
00:59 - that I'm using something called the
01:00 - cross product of vectors and so I cover
01:03 - that a little bit I expect that that's
01:05 - probably one of the confusing parts of
01:06 - this video and let me know in the
01:07 - comments it makes sense or doesn't make
01:09 - sense
01:10 - other solutions for the same problem and
01:11 - I'll come back ah I know what I forgot
01:13 - often often if you need to solve this
01:18 - problem you the thing you might want to
01:20 - research on I'll put some links in the
01:21 - description is something called an Euler
01:22 - angles or also quaternion I have to run
01:28 - away really fast whenever I say
01:29 - quaternion so but I'll come back it's
01:33 - just like it's an instinctual thing it's
01:35 - like the way my brain is wired but but
01:37 - in this case I did it in kind because
01:38 - these elements aren't moving and sort of
01:41 - turning I'm able to just kind of like
01:42 - align the rotation so see how that is
01:44 - let me know in the comments how that
01:45 - went
01:45 - enjoyed this coding challenge and maybe
01:48 - you'll still be watching at the end and
01:49 - maybe you'll make a comment maybe you'll
01:51 - share this like it whatever you're
01:53 - supposed to do to help like the videos
01:54 - get more whatever I don't know okay
01:56 - enjoy goodbye take a ride on the coding
01:58 - train oh okay
01:59 - here we are I am now going to attempt
02:02 - I've been probably going to do it in a
02:04 - way that everyone's going to point out
02:05 - how it could be done so much easier way
02:07 - afterwards so I'm already getting some
02:08 - great suggestions from the
02:10 - but I'm going to attempt to redo this
02:14 - previous challenge which was mapping
02:16 - earthquake earthquake data to a two
02:19 - dimensional map of the world and I am
02:20 - now going to map that data to a 3d
02:24 - sphere now you might be thinking to
02:26 - yourself the earth isn't exactly a
02:28 - sphere which is true and there's kind of
02:31 - this distinction between the concepts of
02:33 - latitude and longitude and azimuth moves
02:36 - as in the inclination anyway I'm going
02:40 - to kind of ignore that for the purpose
02:41 - of this video and really just treat the
02:43 - earth as if it were a perfect sphere and
02:46 - then you know perhaps people can in the
02:49 - comments suggest some ways to be more
02:52 - accurate about that or I can come back
02:53 - and do a follow-up video but that's
02:54 - that's going to give me a simple way for
02:56 - us to get started with the concept so so
02:58 - what I'm going to use to do this
03:00 - challenge is a tool called processing
03:02 - and processing is a programming language
03:05 - and environment built on top of Java all
03:08 - the syntax that I'll be writing in this
03:09 - code will be Java syntax and the
03:12 - libraries for drawing come from
03:14 - processing itself and there's a code
03:15 - editor with processing and I'm going to
03:17 - use so I'm going to first just make a
03:18 - saw a window on size 600 600 and I'm
03:22 - going to say P 3d so P 3d is allowing me
03:25 - to now have a 3d renderer so I can start
03:27 - to use functions that are available in
03:29 - processing for rendering 3d yay I'm
03:32 - going to make a background with my
03:35 - favorite grayscale color of 51 then I am
03:39 - going to say translate because I want
03:41 - the scent I want the center of my world
03:43 - weed center of the window and even in 3d
03:45 - and processing the default is the top
03:47 - left corner I'm gonna say translate I
03:49 - could say 300 300 but I'm going to say
03:51 - width / 2 height divided by 2
03:53 - by the way I was I've noticed some
03:55 - people mentioning that it's often better
03:58 - practice by the way I'm all about bad
04:00 - practice bad practice I'm in favor of
04:02 - them to go back to multiply by 0.5 and
04:05 - seda divided by 2 since the division
04:07 - operation is you know trivially slower
04:10 - perhaps but anyway the point is I want
04:13 - to go to the center and then I'm just
04:14 - going to say steer and I'm going to say
04:16 - sphere 200 let's run this so look there
04:21 - we have our sphere so this is going to
04:23 - be the earth
04:23 - and what I want to do is I'm going to
04:26 - say fill 200 no stroke and by the way if
04:30 - I do that what you're going to see is it
04:33 - looks just like a circle so things in 3d
04:35 - can appear very flat unless you start to
04:38 - change your view the world and how
04:40 - you're looking at things so what I'm
04:42 - going to do here also something that I
04:43 - can do in processing is I could just say
04:45 - lights now there are a lot of functions
04:47 - in processing and I got a move over
04:49 - there's a lot of functions in processing
04:50 - for specific kinds of lights ambient
04:53 - lights and I can control the color
04:54 - directional light spotlight so I
04:57 - encourage you to investigate that but
04:58 - just lights is just kind of like hey
05:00 - there's some general lighting and I
05:02 - don't know how well you can see this but
05:03 - now there's some nice shading on this
05:05 - and other thing I'm going to do is I'm
05:07 - going to create a variable I'm going to
05:10 - call it just angle and I'm going to
05:14 - right after translate I'm going to
05:15 - rotate along the y-axis so one of the
05:18 - things about being in P 3d is that I can
05:20 - now move this over a little bit I can
05:23 - now I can not just wrote call rotate
05:26 - which rotates along rotates just in a 2d
05:30 - plane I can rotate around the y axis
05:33 - rotates the x axis or the z axis so
05:38 - rotate Y by angle and then I can just
05:42 - say you know angle plus equals zero
05:45 - point you know five or something what we
05:47 - would what we should see here is to be
05:49 - very hard to see as you can see now I
05:50 - have my sphere which I'm using to
05:52 - represent the earth kind of rotating
05:55 - around and you spinning around you can
05:56 - kind of see the shadowing so now what do
05:59 - I want to do I want to place a point on
06:02 - the sphere and I want to place that
06:05 - point based on a latitude longitude
06:08 - so let's if you recall I could I'm just
06:11 - going to just what I did the previous
06:13 - challenge is I I just kind of looked up
06:15 - something like latitude longitude pick
06:20 - city out of a hat Melbourne I like to
06:25 - pick cities I've never been to but hope
06:26 - you visit someday I can pick this
06:29 - latitude and longitude
06:30 - and I'm going to just put it up here now
06:34 - and I'm going to say float latitude
06:36 - equals okay now I always have to
06:39 - remember longitude are the lines on the
06:43 - skier that goes up top to bottom and go
06:46 - all the way around so that's really like
06:48 - the X what I'm thinking about as the X
06:50 - so longitude is east-west one forty four
06:55 - point nine six thirty one latitude is
06:59 - north-south thirty-seven point point
07:03 - eight one three six and when itself is
07:06 - negative when it's North it's positive I
07:08 - think let me make that negative again
07:11 - this is kind of irrelevant because it's
07:12 - just going to appear somewhat of the
07:13 - sphere there's no I won't be able to see
07:15 - if it's actually in Australia but just
07:16 - to get started let me do this now how do
07:18 - I convert longitude and latitude to an
07:22 - XY location okay interesting question
07:30 - now there are some ways that I could do
07:33 - it leave beaver expressed in angles so I
07:35 - probably could do some kind of rotation
07:37 - based on them and translation and this
07:40 - would be a valid strategy and I
07:41 - encourage you to maybe try that and post
07:43 - about it in the comments I'm going to do
07:44 - it using Mac's
07:45 - which is by that I mean I want to look
07:49 - at what is the formula to convert a
07:51 - latitude and longitude the angle for
07:55 - horizontal and vertical angle location
07:57 - into XYZ coordinates and this is what's
08:00 - known as spherical coordinates now again
08:02 - if I look I had this page open and then
08:06 - I went to a different web page so if I
08:09 - go to the Wikipedia page we can find
08:12 - where where where where here we go right
08:15 - here we can find these formulas so I
08:17 - encourage you to read up and look at the
08:19 - derivation of these formulas and how it
08:21 - works but essentially here I can look at
08:23 - the radius times sine of the latitude
08:27 - times cosine of the longitude
08:28 - now notice latitude it should be between
08:31 - 0 and PI and longitude should be between
08:34 - 0 and 2pi so one thing I'm going to need
08:37 - to do is adjust that range in order to
08:39 - get that full the full
08:42 - fear and because the values I'm getting
08:44 - her between negative you know negative
08:47 - pi divided by two pi divided by two so
08:49 - what I want to do now is I'm going to
08:51 - say right here I'm estate float latitude
08:55 - equals firstly I need to say like Donna
08:57 - called latitude so I'm going to call
08:59 - this what I'm gonna call this theta for
09:02 - latitude radians of latitude Plus and
09:08 - what did I say plus up high divided by 2
09:11 - because I want to go from negative 92 92
09:13 - zero to 180 and then I'm going to say
09:16 - float fee equals radians of longitude
09:20 - plus PI then I can literally apply these
09:24 - formulas x equals x equals where is this
09:29 - formula R times sine of last two times
09:32 - cosine of longitude R times sine of
09:34 - latitude times cosine of 1 to 2 oh and
09:39 - this should be theta and V and y is what
09:47 - sign sign sign sign and Z is R times
09:56 - cosine of theta R times cosine of theta
10:02 - theta and now what I can do is I can
10:06 - offer them what are R is the radius how
10:09 - far from the center am I going to
10:12 - position this point and in this case I
10:14 - made a sphere 200 so why not actually
10:17 - say R equals 200 make the sphere with
10:21 - that radius and then I'm going to say
10:23 - translate X comma Y comma Z and I'm
10:27 - going to say box make a box that's like
10:30 - box is a function in processing that
10:33 - will make a 3-dimensional box and I'm
10:35 - going to make it 10 by 10 by 10 by 10 by
10:37 - 10 I guess it's just the only three
10:38 - dimensions with the height yep 10 by 10
10:41 - by 10
10:42 - okay well let's run this and see what I
10:44 - get where's that box there it is so you
10:50 - know is this in the right place
10:51 - loud and clear maybe my axes are flipped
10:54 - you know
10:56 - um there's really the question of like
10:58 - well what you know am I looking at the
11:00 - earth upside down right side up what's
11:02 - up so I mean there's no of having this
11:04 - discussion really hub coffee for my
11:07 - children like we're standing on the
11:08 - upside down part of the earth it's like
11:11 - what do you mean the upside down part of
11:12 - the earth it really depends on which way
11:14 - you're looking at it right so sort of
11:16 - interesting philosophical questions that
11:17 - I'm not going to get into but you can
11:19 - see I have now mapped a point yeah and
11:22 - my axes are flipped to to the to the
11:25 - earth itself so I could if I wanted to
11:28 - probably what would I do is make
11:31 - something negative
11:33 - maybe the Y value negative would put it
11:35 - on the bottom let's try that there we go
11:40 - so that's probably all I need to do to
11:41 - sort of flip the axes at least in this
11:42 - point right now and that's you know
11:44 - somewhere if we were looking we if we
11:46 - mapped earth we've got um we've got
11:49 - Australia down there we've got Melbourne
11:50 - okay so now now that we have this
11:52 - working it's just time to go get the
11:54 - data whoo yay let's go get the data so
11:57 - one thing I'm going to do in processing
11:59 - that thrills me to no end is there is a
12:01 - there's a whole set of data classes in
12:04 - processing and you can there's there's
12:06 - classes for working with a JSON based
12:10 - data XML based data just raw text data
12:13 - but the particular class that I want to
12:15 - use is called table and the table object
12:17 - is an object that can load on tabular
12:20 - data and some formats might be on
12:22 - spreadsheet formats like a tab delimited
12:24 - file a comma separated file and it so
12:27 - happens that the earthquake data is
12:30 - comma separated data and you might
12:32 - remember this if you watch the previous
12:33 - challenge what's comma separated data
12:35 - I'll show you so so if I go back to the
12:39 - US Geological Survey website and I just
12:44 - get let me just get the earthquakes for
12:47 - the past day I'm going to click on this
12:50 - link and then what I'm going to do my
12:55 - chat here is not scrolling when we go
12:57 - down here oh great I'm going to give me
12:59 - some world texture links I'm going to
13:00 - come back to that in a second so what
13:03 - I'm going to do here is
13:05 - I'm going to say and setup table equals
13:09 - load table books and I need to put
13:13 - double quotes and then I'm going to
13:15 - paste that link to the CSV right there
13:17 - in the code so let's look at processing
13:22 - gorg load table I think I spelled that
13:26 - wrong but you found it anyway so this is
13:28 - what comma separated data looks like it
13:31 - is it's often has a first a text file
13:35 - that has a first row which is header
13:37 - information so an ID followed by a
13:39 - species followed by a name and then each
13:42 - of the next row would be rows of data so
13:45 - there's a goat with an ID a 0 and a
13:48 - species a leopard with an ID of 1 a
13:50 - zebra with an ID of 2 so so this is the
13:54 - kind of data now what what does the
13:57 - earthquake data look like I can actually
14:00 - just paste whoops I can just paste that
14:02 - URL into the browser it's not it's going
14:04 - to download that CSV file and then I can
14:07 - open it in Mac preview oh look there's
14:09 - only one earthquake I better get some
14:10 - more data so in fine we'll use this just
14:13 - to start with and you can see what what
14:15 - the data is it's got a header row time
14:18 - latitude longitude depth magnitude and
14:20 - then it's got the data itself in the
14:21 - next row and if there were many more
14:23 - earthquakes there would be many more
14:25 - rows so I did only significant today so
14:30 - I did only have a significant which is
14:32 - only been one so far but this is good
14:33 - for us to start with ok because so now
14:36 - what I'm going to do is one thing I need
14:38 - to do in the load table function is I
14:42 - need to go to the end and add comma
14:44 - header this is a second optional
14:46 - argument to the load table function that
14:48 - tells processing that tells load table
14:51 - function that back CSV file has a header
14:53 - row and this is incredibly useful
14:55 - because now we can start to ask for data
14:58 - by Nate it will parse that test little
15:01 - partially tabular data with the
15:02 - knowledge of that header row so in in
15:06 - the draw loop what I want to do now is
15:10 - say for and I want to iterate over all
15:15 - of the rows of data
15:18 - each row is can be accessed in an object
15:21 - called a table row sink for table row
15:26 - row in table get rows so this is kind of
15:33 - a fancy maybe that's not right
15:35 - table Road table dot rows so this is a
15:38 - very fancy kind of loop this is a loop a
15:41 - Java enhanced loop that's like a for
15:44 - each kind of loop that says tables at
15:46 - Rose returns this iterator objects that
15:49 - kind of provide you all of the roads and
15:51 - this Luke says I want to look at each
15:53 - row one at a time and then for each row
15:56 - I can start to get data like I can say
15:58 - float lat equals row get float latitude
16:04 - so this is what's so incredibly useful
16:06 - if I load a CSV with etter information I
16:09 - can just access the data in each row
16:12 - based on what the headers name is and I
16:14 - can also if I know what kind of data it
16:16 - is whether it's a float or an int or a
16:18 - string I can call a particular get
16:20 - function and I can say float longitude
16:23 - equals row get float and you can see by
16:25 - the way I have code completion turned on
16:27 - the processing IDE so this is a feature
16:29 - of processing tree so it's and a
16:31 - longitude and then another thing I might
16:34 - want is a magnitude so let's just do
16:41 - print line lat/long magnitude just to
16:44 - see that that that data came out so if I
16:48 - now run this sketch I should see in the
16:52 - console loop there is no column name
16:55 - magnitude so I didn't pay close enough
16:57 - attention the the column name is
16:59 - actually just ma G format for magnitude
17:02 - so if I come back here and change this
17:04 - to mag and now if I run it there we go
17:08 - it's prettier over and over again but
17:10 - you can see that data is coming in
17:12 - latitude longitude and magnitudes so now
17:15 - what I could do is take we don't really
17:19 - need this this was just for testing I'm
17:21 - going to remove that I'm going to come
17:23 - down here and I'm going to take this
17:25 - code
17:29 - and I'm going to put it right here so
17:32 - now I can whatever I get from the data
17:35 - source I can now apply my conversion to
17:37 - XYZ now here's the thing if this is
17:42 - going to work now with just one box but
17:45 - ultimately I'm probably going to want
17:47 - many boxes so these translations that
17:49 - translated to XYZ needs to apply to each
17:53 - individual earthquake that I'm accessing
17:55 - so in order to not have the translates
17:58 - accumulate I need to add push matrix
18:01 - which is saving the current
18:02 - transformation state then I translate
18:04 - that I draw the box pop matrix which
18:07 - restores it so when it comes back in to
18:08 - the next one that previous translate
18:10 - won't affect it okay here we go we
18:13 - should see an earthquake somewhere now I
18:17 - you know I probably should number one
18:20 - make this box quite a bit larger maybe
18:22 - what I want to do is say fill 255 -
18:25 - because that's the same color I have for
18:27 - the sphere I don't know what the spheres
18:29 - but yes so you can see there it is there
18:31 - it is on the sphere itself now let's go
18:35 - grab a lot of earthquakes from the last
18:38 - month and I'm going to go back to the
18:42 - USGS website and I'm going to go to past
18:45 - 30 days
18:46 - all earthquakes it's probably a terrible
18:49 - idea but I'm going to do it anyway and
18:51 - I'm now going to put that in here look
18:56 - I'm going to one thing I want to do is I
18:58 - want to just leave both case I need to
19:00 - do testing at some point I'll comment
19:03 - out the one day significant I will paste
19:08 - this in here and save now I'm getting
19:12 - everything for a month and then I'm
19:15 - going to run it we're gonna see a lot of
19:17 - spheres look at this there are all the
19:19 - earthquakes maps all over the sphere
19:23 - yeah that looks kind of reasonable let
19:28 - me let me change that now to make the
19:33 - box a little bit smaller okay so this
19:37 - looks more regional now there's a couple
19:39 - things I want to do
19:40 - I want to now angle I what I want is for
19:46 - the boxes to be extruded out based on
19:50 - the magnitude now I could just make the
19:54 - hole size I could just so I have a like
19:58 - a cube right the Box function only will
20:05 - ever draw a cube for me what I actually
20:08 - want to draw is something that can be
20:11 - like this boy I can't draw at all but
20:15 - you get the idea
20:16 - well what did I do you get the idea
20:18 - right I want to make there we go
20:21 - what am I making it worse I want to make
20:25 - a like a tower so box is a really
20:29 - convenient function to use because it
20:30 - gives me food just a box but for to make
20:33 - this kind of tower thing what I need to
20:35 - do is design my own shape so this
20:38 - particular shape I can create myself by
20:42 - saying begin shape and shape and then I
20:48 - could set a whole lot of vertices so I
20:50 - think about one of these planes just in
20:52 - the bottom this could be like the point
20:54 - negative 1 comma negative 1 comma
20:57 - negative 1 like if it and then this
21:00 - could be the point over here 1 comma
21:02 - negative 1 comma negative 1 right if
21:04 - this is sort of Z I could kind of just
21:06 - figure out and I could I could make a
21:08 - quad for this part of the of the I hope
21:11 - to call this tower it's almost like a
21:13 - cylinder but a box cylinder rectangle
21:15 - what if I call that's why gotta have a
21:16 - name looking to take here everyone's
21:19 - room above I'm seeing all the YouTube
21:21 - comments now so I could set all the
21:25 - points for this quad the miss quad miss
21:26 - quad miss quad miss quad miss quad how
21:28 - many quads with that it's 6 so what I'm
21:30 - going to do I'm going to come back over
21:32 - here and a box takes three arguments
21:37 - Thank You chat so I couldn't could do
21:40 - that but let's take a look oh thank you
21:42 - that's wonderful
21:43 - let's look at box processing cuddly so
21:46 - that's how you would have to do your own
21:47 - shape
21:49 - but and now seeing that I can actually
21:51 - give it three arguments and the three
21:53 - arguments are with height and depth so I
21:57 - think what I'm going to do is okay so
22:00 - let's just do I have the magnitude here
22:03 - I have it in mag and remember a
22:05 - magnitude for earthquake is based on the
22:09 - Richter scale
22:10 - so what I need to do is and then of
22:14 - course I have to think about the volume
22:15 - of but let's not worry about that too
22:18 - much let's just think about the height
22:19 - map to magnitude so what I'm going to do
22:22 - is say float H equals power 10 to the
22:27 - magnitudes 10 to the power of magnitude
22:30 - and then I can do a mapping which is if
22:34 - I say like max H is I think I used you
22:37 - know 10 to the 10th power I can actually
22:40 - just say H equals map itself from zero
22:43 - to max H to between you know 10 and 100
22:49 - so now what I'm going to do is I could
22:52 - say maybe the width and height are
22:54 - always going to be maybe I want the
22:56 - height to be H and the X and z dimension
23:00 - the sort of width and depth will always
23:02 - be 5 so let's see what I get there okay
23:08 - oh so I can't tell if this work let me
23:14 - write let me not worry about this
23:16 - actually for a second let me just see if
23:18 - I can make some tall one so I'm going to
23:21 - make some with like a height of 100 and
23:23 - width
23:24 - okay so this is doing something but
23:27 - they're all pointing straight up so
23:28 - here's the next issue I want them to be
23:31 - pointing so then this is like a hard
23:33 - problem so if this is my sphere and I
23:41 - have something right on the edge of the
23:43 - sphere it's right now it's just pointing
23:45 - straight up I wanted to point out as if
23:48 - there was a ray shooting from the center
23:50 - of the sphere to the edge and continuing
23:52 - straight out so I have that ray the
23:55 - vector its position relative to the
23:56 - center I need to rotate this box to
23:59 - align it with that
24:01 - ray I probably could apply the rotation
24:04 - and translate out again but I'm going to
24:06 - have to do this with some math so one
24:09 - thing that I need I think math wise to
24:11 - do this is I need a vector which is just
24:17 - the axis like a kind of like let's sort
24:20 - normalized access that I can relate
24:22 - everything to and I'm going to make use
24:24 - it at the x-axis so I'm going to make a
24:26 - new vector which is the x-axis so a
24:29 - vector that the unit vector pointing
24:31 - along the x axis x axis is just 1 0 for
24:40 - y 0 for Z ok now where where am I here
24:44 - now what I'm going to do is I want to
24:48 - look at the angle between the x-axis and
24:56 - the vector itself so if this is my
25:00 - vector I want if I'm going to rotate
25:03 - kind of relative to the x axis I want to
25:05 - rotate it like this based on that angle
25:08 - so the nice thing is there's a function
25:11 - in p5 that use I'm sorry in processing
25:13 - but also p5 that uses the dot product
25:16 - behind-the-scenes another vector
25:17 - operation that I have some video
25:19 - tutorials about that give you that angle
25:21 - between so what I want to do here what I
25:26 - want to do here is say P vector and
25:30 - angle B for angle between but that's it
25:34 - really that's really like the I don't
25:37 - use angle because I'm using it already
25:38 - like yes angle between equals P vector
25:43 - dot angle between the x-axis and pause
25:49 - now remember pause is that oh there is
25:52 - no pause I'm saying cause I have to make
25:54 - a pause P vector equals new P vector
25:58 - pause X pause why pause V that position
26:02 - vector is the vector that points out
26:04 - from the center pause know what I think
26:07 - cause I'm doing this like I'm losing my
26:09 - mind
26:09 - XYZ so pause equals that P vector X Y Z
26:13 - okay this is good this is good so now I
26:16 - want an angle between the x-axis and
26:19 - pause what could you possibly be
26:21 - complaining about errors slope does not
26:26 - match oh yeah
26:27 - the angle between is a float not a
26:29 - vector it's just a float so by the way
26:30 - what did I let me just so you can see
26:33 - that it gave me this error type mismatch
26:36 - float does not match with cross link or
26:39 - P vector so you get an error like that
26:41 - it's because this function angle between
26:43 - returns a float and I said to set into a
26:45 - P vector which makes no sense what I
26:48 - want to do is establish a vector which
26:52 - is what I'm going to rotate around so
26:56 - for example this is the x-axis this is
26:58 - me rotating around the x-axis and what I
27:01 - want to do if I come back to over here
27:04 - right what I want to do if I want to
27:07 - rotate if I want to take this and I
27:11 - essentially want to I don't I want to
27:13 - rotate it to this point I want to rotate
27:16 - around the axis that's actually
27:19 - perpendicular out from these two vectors
27:22 - I'm not doing a very good job of
27:23 - explaining that this really needs a more
27:25 - thoughtful diagram I'm going to try to
27:30 - explain why we need the cross products
27:32 - here so let me diagram out what we have
27:35 - so far we have the x-axis and then we
27:42 - have a vector I'm going to use dot to
27:44 - note that this is coming out as if it
27:46 - were coming out like this this is the
27:49 - position but actually a way to think
27:53 - about that let's say the position is on
27:55 - a two-dimensional plane like the x-axis
27:57 - right so what I ultimately need is to
28:00 - roll this is so good this is good
28:02 - what I need is to rotate this like this
28:05 - right this is what I'm drawing a box
28:08 - that's pointing straight up and I want
28:10 - to rotate it like this to match that
28:12 - direction so I need an angle to rotate
28:15 - it by and I'm going to be able to get
28:17 - that with this angle between that's the
28:23 - angle that I need to rotate it by maybe
28:26 - if I'm actually drawing
28:27 - this way is a better way to think of it
28:29 - so I might actually need to fix the box
28:30 - to be drawn this way and I want to
28:32 - rotate it like this so what access do I
28:34 - need to rotate it around this axis right
28:38 - I need to rotate it around this X now in
28:40 - this case if it was just 2d I know it
28:42 - just rotated around perfectly the z axis
28:45 - but what I want to do is called rotation
28:47 - around an arbitrary axis so let's say
28:49 - this was actually so instead of the
28:51 - position being on the same plane as the
28:54 - x axis what is the position we're
28:56 - pointing out here the axis that I want
28:57 - to rotate out is now perpendicular out
28:59 - maybe this way the way I get a vector
29:03 - that is perpendicular to two vectors
29:07 - that are connected is with something
29:09 - called the cross-product okay so let's
29:12 - look at a diagram that I think will help
29:14 - explain this this is if this is vector a
29:18 - and this is vector V B this is showing
29:21 - you a and those vectors make a plane the
29:24 - cross-product is the vector a cross B
29:27 - points out perpendicular from that plane
29:29 - so this is exactly the operation that I
29:32 - need to do to get that rotation axis so
29:36 - if I come back to my code I should be
29:39 - able to say now rotation axis I'll just
29:45 - call it our axis our axis equals x axis
29:51 - dot cross position and now here what did
29:57 - I get wrong oh and that's the vector
30:00 - right so the cross product returns a
30:03 - vector the angle between function
30:05 - returns an angle so now that I have the
30:07 - rotation axis I want to rotate around an
30:10 - arbitrary axis now how do you do that
30:12 - let's go look in the processing
30:14 - reference about rotate oh this is
30:17 - exciting
30:18 - processing morgue because distance might
30:21 - be a feature you weren't aware of
30:23 - there's this rotate function rotate is a
30:26 - function that you give it an angle look
30:27 - it rotates now it only says only thing
30:32 - you can give it as an angle but there's
30:34 - also like rotate X and that you can give
30:38 - it an angle and rotate Y so
30:41 - built into processing our rotation
30:45 - function for specific axis to x axis the
30:49 - y axis the z axis x y z ok so those are
30:55 - built into processing but I want to
30:57 - rotate around an arbitrary axis well
30:59 - this is not documented here in the in
31:02 - the main reference but this is actually
31:04 - a feature of the rotate function you
31:06 - could find it if you look at the Java
31:07 - Docs for processing for certain like
31:09 - advanced more advanced features what I
31:11 - can actually do is I can say rotate and
31:15 - I want to rotate by that angle remember
31:18 - I want to rotate by that angle around an
31:20 - arbitrary axis I could say our axis X or
31:23 - x sy our axis Z so the rotate function
31:28 - can actually take four arguments which
31:30 - is the angle of rotation and the XYZ of
31:33 - a vector of an axis of rotation and I
31:35 - think I got that right it could be that
31:37 - the egg the Angeles laughs I'm pretty
31:39 - sure the angle is first so let's now run
31:42 - this oh but I don't want to do the
31:44 - rotation here I want to do the rotation
31:48 - right here so after I translate to that
31:50 - location I want to rotate so let's now
31:52 - do that and we said oh that doesn't look
31:56 - right it's certainly rotating but it
31:58 - doesn't look right so I think the issue
32:00 - here is that I didn't draw what it what
32:04 - I did is I drew my looks wrong long I if
32:09 - I have that earth and I had that I kind
32:13 - of drew my boxes pointing up but then
32:15 - rotated to the x axis I mean I think I
32:17 - need to draw the boxes with the
32:19 - extrusion along the x axis for this to
32:21 - make sense so let me change that to the
32:25 - boxes the extrusion the value that's
32:27 - larger being the x value and there we go
32:32 - ah it works
32:33 - oh my god I'm so pleased oh that was
32:37 - really painful but totally work and I'm
32:40 - very pleased to see that Network so now
32:42 - in theory what I should be able to do is
32:44 - have the height be mapped to the
32:48 - earthquakes magnitude so let's put that
32:50 - back in
32:53 - and make this each and there we go now I
33:00 - guess I don't have okay so I'm not
33:05 - really able to see the distinctions very
33:08 - well between the particular earthquakes
33:10 - so I'm going to kind of fudge it here
33:12 - and I'm going to say like well I'm
33:13 - probably actually not there's really not
33:15 - any earthquakes right now in my data I
33:18 - have a magnitude of 10 so I'm going to
33:20 - just really consider the maximum that is
33:22 - like on the Richter scale of seven and
33:24 - then I'm going to map those ones that
33:25 - have a of a magnitude of seven to 100
33:29 - pixels and the lower ones to ten and if
33:31 - I do that we should see here on getting
33:35 - some variations you can see there was
33:36 - one particularly really large earthquake
33:38 - and the other thing that's going on here
33:40 - is I've drawn these boxes actually be as
33:43 - a center the center is on the edge of
33:45 - the sphere so there's actually a rain
33:46 - going all the way inside - that's
33:48 - probably cuing the stuff so I think we
33:50 - have to be more thoughtful about the
33:51 - relative scaling of these but you know
33:54 - we're getting something you know
33:55 - whatever that data might be you might
33:57 - not have earthquake data you could sort
33:59 - of see what the possibilities are here I
34:01 - could add color I could add textures I
34:03 - could be much more thoughtful let's do
34:04 - one thing just to see how kind of
34:07 - problematic what I've done is in a way
34:10 - if I want to actually see the you know
34:13 - what what we typically look like as the
34:15 - earth so I need to find a nice texture
34:18 - image to texture that sphere so let me
34:21 - go look for that okay I'm back
34:23 - I found there's a lot of places on the
34:26 - internet to get images of the earth I
34:29 - would attempt to use one from NASA NASA
34:33 - visible Earth I you know there's so many
34:36 - possibilities here I'm just going to
34:39 - grab November or
34:42 - I don't know December blue marble next
34:45 - generation and I'm going to download the
34:47 - image here I want just sort of the
34:49 - smallest one right now from the download
34:51 - this one and I'm gonna hit save and I'm
34:54 - going to go to my where is this project
34:58 - saved earthquakes 3d let me save this to
35:02 - the desktop earthquake 3d and then I'm
35:06 - going to save this to earthquake 3d I'm
35:08 - going to make a data folder and I am
35:11 - going to save this image I'm just going
35:13 - to call it a world
35:15 - earth earth JPEG alright now one thing I
35:20 - want to do is I want to check the
35:21 - dimensions of this image so I want to go
35:25 - to processing and go to look at that
35:27 - image and do it get info 5400 by 2700
35:32 - sure why not let's just see if that
35:36 - works what not I said I wanted to check
35:38 - it and I'm like whatever it is is fine
35:39 - so here's the thing I can actually
35:42 - texture this sphere very very easily I
35:46 - think I might need to bring in a pshape
35:48 - object so let's just see first I want to
35:50 - I need an image and I'm going to call
35:52 - that image earth and then in setup I am
35:55 - going to say earth equals load image
35:59 - Earth's JPEG so now I have access to
36:03 - that image in the computer's memory just
36:05 - to be sure that this is working I'm
36:06 - going to say image earth 0 0 so now I'm
36:10 - just going to kind of draw that image in
36:12 - the background and we can see there it
36:14 - is there's an image of the earth so in
36:16 - the background I've got that image
36:17 - loaded now in theory what I would want
36:19 - to be able to do is just say texture
36:21 - earth right before I draw the sphere but
36:28 - that doesn't work so the way that I you
36:32 - can't I don't I don't believe in
36:33 - processing it works to automatically
36:36 - texture one of these primitive shapes of
36:38 - sphere actually is a shape that's built
36:41 - up by many different triangles but what
36:44 - I can do however is create a P shape and
36:48 - I'm going to call that globe this is
36:51 - already called something earth and I'm
36:52 - going to say globe E
36:55 - we'll create shape and then I think all
36:59 - I need to do is say fear and then give
37:01 - it let's make the radius a global
37:05 - variable and then give it a radius
37:08 - I think this now just create shapes this
37:11 - is a shape object that is a sphere and
37:13 - that has a radius now I should be able
37:16 - to say here where I'm drawing the sphere
37:19 - now I should be able to say and let me
37:21 - get rid of this texture I should be able
37:25 - to say shaped shape globe so I'm drawing
37:32 - instead of drawing the sphere as like
37:34 - and actually this is much more efficient
37:36 - but instead of computing for your
37:38 - geometry over and over again I have this
37:39 - work saved see your object that I'm just
37:42 - drawing into the into the scene so there
37:47 - we go now you can see the sphere that
37:48 - now I have it now it has a default
37:50 - stroke and it has a which is black and
37:54 - it also has a default fill so what I
37:56 - want to do first of all is I want to get
37:59 - rid of drawing me in that image and I
38:01 - want to I think I could say no stroke
38:06 - and then I think I can say just globe
38:09 - texture and then that Earth image so I
38:13 - think now this will give me that image
38:17 - of the earth actually the function is
38:21 - not called texture I forgot it's called
38:23 - set texture that's the way to set it set
38:27 - a particular image to auto texture that
38:30 - particular shape so now let's try
38:32 - running this and there we go so now you
38:36 - can see my earth is textured with that
38:39 - image from NASA and the earthquakes are
38:41 - on it however I have done something
38:45 - rather incorrect which is that if I kind
38:48 - of zoom in and look at this these
38:49 - earthquakes are just not in the right
38:51 - place if I slow down we slow down this
38:53 - rotation and because if you remember
38:57 - from that there's a lot of earthquakes
38:58 - that happen along at least along the
39:00 - California coast of the United States
39:02 - and up into Alaska and I think we'll be
39:06 - able to kind of see that collection of
39:07 - earthquakes
39:08 - here it is that's that collection of
39:10 - earthquakes that kind of goes along
39:12 - I haven't aligned the texture with this
39:15 - or XYZ transformation so this I'm going
39:18 - to leave as a challenge it's code will
39:20 - get published to figure that out and you
39:23 - know number one is I probably don't need
39:25 - to flip this why maybe flipping this why
39:27 - I might need to do something where I
39:29 - kind of rotate the earth into the right
39:31 - position to align so I'm not really I'm
39:34 - gonna research this I'll come back next
39:35 - week and show on the livestream
39:39 - solutions to this particular problem but
39:42 - but and also here's the thing regardless
39:45 - of that earth texture there's so much
39:47 - that you could do with this what other
39:49 - kind of data could you map to a 3d
39:51 - version of the earth what other what
39:55 - other ways could you visualize the
39:56 - earthquake data color you could
39:57 - certainly use you know particles
39:59 - emanating you know you could time-lapse
40:02 - and show earthquakes over time or a very
40:04 - long period of time might be interesting
40:06 - are other kinds of data so hopefully
40:08 - this gives you this this tutorial gives
40:10 - you a sense of how to work with 3d how
40:13 - some of the math can get kind of tricky
40:15 - when you start in with vectors and
40:16 - rotations and also just we're a little
40:19 - bit about working with data in
40:20 - processing okay thanks very much and
40:22 - I'll see you in the future Cody Johnson
40:25 - [Music]

Cleaned transcript:

hello welcome to another coding challenge I'm going to build a 3d earthquake visualization you can see it right there I am going to do this in processing which is a Java based programming environment I'm going to use its 3d rendering capabilities I'm going to load a commaseparated data value data source from the United States Geological Survey with earthquake data I'm going to the image from NASA I'm going to texture it to a sphere I'm going to do all of that to build exactly this in the coding challenge and this is the result that I just did and I'm going to travel back in time the moment it starts decoding challenge there is a big issue with this which is that the actual earthquakes aren't aligned to that particular texture so that I'm leaving as a kind of challenge to the audience and I will come back next week on the live stream and show some solutions to that in addition the most confusing part of this video is probably this the math behind taking getting these almost building like structures to point out in the direction from the center of the sphere of the earth as a globe and to do that I'm using something called the cross product of vectors and so I cover that a little bit I expect that that's probably one of the confusing parts of this video and let me know in the comments it makes sense or doesn't make sense other solutions for the same problem and I'll come back ah I know what I forgot often often if you need to solve this problem you the thing you might want to research on I'll put some links in the description is something called an Euler angles or also quaternion I have to run away really fast whenever I say quaternion so but I'll come back it's just like it's an instinctual thing it's like the way my brain is wired but but in this case I did it in kind because these elements aren't moving and sort of turning I'm able to just kind of like align the rotation so see how that is let me know in the comments how that went enjoyed this coding challenge and maybe you'll still be watching at the end and maybe you'll make a comment maybe you'll share this like it whatever you're supposed to do to help like the videos get more whatever I don't know okay enjoy goodbye take a ride on the coding train oh okay here we are I am now going to attempt I've been probably going to do it in a way that everyone's going to point out how it could be done so much easier way afterwards so I'm already getting some great suggestions from the but I'm going to attempt to redo this previous challenge which was mapping earthquake earthquake data to a two dimensional map of the world and I am now going to map that data to a 3d sphere now you might be thinking to yourself the earth isn't exactly a sphere which is true and there's kind of this distinction between the concepts of latitude and longitude and azimuth moves as in the inclination anyway I'm going to kind of ignore that for the purpose of this video and really just treat the earth as if it were a perfect sphere and then you know perhaps people can in the comments suggest some ways to be more accurate about that or I can come back and do a followup video but that's that's going to give me a simple way for us to get started with the concept so so what I'm going to use to do this challenge is a tool called processing and processing is a programming language and environment built on top of Java all the syntax that I'll be writing in this code will be Java syntax and the libraries for drawing come from processing itself and there's a code editor with processing and I'm going to use so I'm going to first just make a saw a window on size 600 600 and I'm going to say P 3d so P 3d is allowing me to now have a 3d renderer so I can start to use functions that are available in processing for rendering 3d yay I'm going to make a background with my favorite grayscale color of 51 then I am going to say translate because I want the scent I want the center of my world weed center of the window and even in 3d and processing the default is the top left corner I'm gonna say translate I could say 300 300 but I'm going to say width / 2 height divided by 2 by the way I was I've noticed some people mentioning that it's often better practice by the way I'm all about bad practice bad practice I'm in favor of them to go back to multiply by 0.5 and seda divided by 2 since the division operation is you know trivially slower perhaps but anyway the point is I want to go to the center and then I'm just going to say steer and I'm going to say sphere 200 let's run this so look there we have our sphere so this is going to be the earth and what I want to do is I'm going to say fill 200 no stroke and by the way if I do that what you're going to see is it looks just like a circle so things in 3d can appear very flat unless you start to change your view the world and how you're looking at things so what I'm going to do here also something that I can do in processing is I could just say lights now there are a lot of functions in processing and I got a move over there's a lot of functions in processing for specific kinds of lights ambient lights and I can control the color directional light spotlight so I encourage you to investigate that but just lights is just kind of like hey there's some general lighting and I don't know how well you can see this but now there's some nice shading on this and other thing I'm going to do is I'm going to create a variable I'm going to call it just angle and I'm going to right after translate I'm going to rotate along the yaxis so one of the things about being in P 3d is that I can now move this over a little bit I can now I can not just wrote call rotate which rotates along rotates just in a 2d plane I can rotate around the y axis rotates the x axis or the z axis so rotate Y by angle and then I can just say you know angle plus equals zero point you know five or something what we would what we should see here is to be very hard to see as you can see now I have my sphere which I'm using to represent the earth kind of rotating around and you spinning around you can kind of see the shadowing so now what do I want to do I want to place a point on the sphere and I want to place that point based on a latitude longitude so let's if you recall I could I'm just going to just what I did the previous challenge is I I just kind of looked up something like latitude longitude pick city out of a hat Melbourne I like to pick cities I've never been to but hope you visit someday I can pick this latitude and longitude and I'm going to just put it up here now and I'm going to say float latitude equals okay now I always have to remember longitude are the lines on the skier that goes up top to bottom and go all the way around so that's really like the X what I'm thinking about as the X so longitude is eastwest one forty four point nine six thirty one latitude is northsouth thirtyseven point point eight one three six and when itself is negative when it's North it's positive I think let me make that negative again this is kind of irrelevant because it's just going to appear somewhat of the sphere there's no I won't be able to see if it's actually in Australia but just to get started let me do this now how do I convert longitude and latitude to an XY location okay interesting question now there are some ways that I could do it leave beaver expressed in angles so I probably could do some kind of rotation based on them and translation and this would be a valid strategy and I encourage you to maybe try that and post about it in the comments I'm going to do it using Mac's which is by that I mean I want to look at what is the formula to convert a latitude and longitude the angle for horizontal and vertical angle location into XYZ coordinates and this is what's known as spherical coordinates now again if I look I had this page open and then I went to a different web page so if I go to the Wikipedia page we can find where where where where here we go right here we can find these formulas so I encourage you to read up and look at the derivation of these formulas and how it works but essentially here I can look at the radius times sine of the latitude times cosine of the longitude now notice latitude it should be between 0 and PI and longitude should be between 0 and 2pi so one thing I'm going to need to do is adjust that range in order to get that full the full fear and because the values I'm getting her between negative you know negative pi divided by two pi divided by two so what I want to do now is I'm going to say right here I'm estate float latitude equals firstly I need to say like Donna called latitude so I'm going to call this what I'm gonna call this theta for latitude radians of latitude Plus and what did I say plus up high divided by 2 because I want to go from negative 92 92 zero to 180 and then I'm going to say float fee equals radians of longitude plus PI then I can literally apply these formulas x equals x equals where is this formula R times sine of last two times cosine of longitude R times sine of latitude times cosine of 1 to 2 oh and this should be theta and V and y is what sign sign sign sign and Z is R times cosine of theta R times cosine of theta theta and now what I can do is I can offer them what are R is the radius how far from the center am I going to position this point and in this case I made a sphere 200 so why not actually say R equals 200 make the sphere with that radius and then I'm going to say translate X comma Y comma Z and I'm going to say box make a box that's like box is a function in processing that will make a 3dimensional box and I'm going to make it 10 by 10 by 10 by 10 by 10 I guess it's just the only three dimensions with the height yep 10 by 10 by 10 okay well let's run this and see what I get where's that box there it is so you know is this in the right place loud and clear maybe my axes are flipped you know um there's really the question of like well what you know am I looking at the earth upside down right side up what's up so I mean there's no of having this discussion really hub coffee for my children like we're standing on the upside down part of the earth it's like what do you mean the upside down part of the earth it really depends on which way you're looking at it right so sort of interesting philosophical questions that I'm not going to get into but you can see I have now mapped a point yeah and my axes are flipped to to the to the earth itself so I could if I wanted to probably what would I do is make something negative maybe the Y value negative would put it on the bottom let's try that there we go so that's probably all I need to do to sort of flip the axes at least in this point right now and that's you know somewhere if we were looking we if we mapped earth we've got um we've got Australia down there we've got Melbourne okay so now now that we have this working it's just time to go get the data whoo yay let's go get the data so one thing I'm going to do in processing that thrills me to no end is there is a there's a whole set of data classes in processing and you can there's there's classes for working with a JSON based data XML based data just raw text data but the particular class that I want to use is called table and the table object is an object that can load on tabular data and some formats might be on spreadsheet formats like a tab delimited file a comma separated file and it so happens that the earthquake data is comma separated data and you might remember this if you watch the previous challenge what's comma separated data I'll show you so so if I go back to the US Geological Survey website and I just get let me just get the earthquakes for the past day I'm going to click on this link and then what I'm going to do my chat here is not scrolling when we go down here oh great I'm going to give me some world texture links I'm going to come back to that in a second so what I'm going to do here is I'm going to say and setup table equals load table books and I need to put double quotes and then I'm going to paste that link to the CSV right there in the code so let's look at processing gorg load table I think I spelled that wrong but you found it anyway so this is what comma separated data looks like it is it's often has a first a text file that has a first row which is header information so an ID followed by a species followed by a name and then each of the next row would be rows of data so there's a goat with an ID a 0 and a species a leopard with an ID of 1 a zebra with an ID of 2 so so this is the kind of data now what what does the earthquake data look like I can actually just paste whoops I can just paste that URL into the browser it's not it's going to download that CSV file and then I can open it in Mac preview oh look there's only one earthquake I better get some more data so in fine we'll use this just to start with and you can see what what the data is it's got a header row time latitude longitude depth magnitude and then it's got the data itself in the next row and if there were many more earthquakes there would be many more rows so I did only significant today so I did only have a significant which is only been one so far but this is good for us to start with ok because so now what I'm going to do is one thing I need to do in the load table function is I need to go to the end and add comma header this is a second optional argument to the load table function that tells processing that tells load table function that back CSV file has a header row and this is incredibly useful because now we can start to ask for data by Nate it will parse that test little partially tabular data with the knowledge of that header row so in in the draw loop what I want to do now is say for and I want to iterate over all of the rows of data each row is can be accessed in an object called a table row sink for table row row in table get rows so this is kind of a fancy maybe that's not right table Road table dot rows so this is a very fancy kind of loop this is a loop a Java enhanced loop that's like a for each kind of loop that says tables at Rose returns this iterator objects that kind of provide you all of the roads and this Luke says I want to look at each row one at a time and then for each row I can start to get data like I can say float lat equals row get float latitude so this is what's so incredibly useful if I load a CSV with etter information I can just access the data in each row based on what the headers name is and I can also if I know what kind of data it is whether it's a float or an int or a string I can call a particular get function and I can say float longitude equals row get float and you can see by the way I have code completion turned on the processing IDE so this is a feature of processing tree so it's and a longitude and then another thing I might want is a magnitude so let's just do print line lat/long magnitude just to see that that that data came out so if I now run this sketch I should see in the console loop there is no column name magnitude so I didn't pay close enough attention the the column name is actually just ma G format for magnitude so if I come back here and change this to mag and now if I run it there we go it's prettier over and over again but you can see that data is coming in latitude longitude and magnitudes so now what I could do is take we don't really need this this was just for testing I'm going to remove that I'm going to come down here and I'm going to take this code and I'm going to put it right here so now I can whatever I get from the data source I can now apply my conversion to XYZ now here's the thing if this is going to work now with just one box but ultimately I'm probably going to want many boxes so these translations that translated to XYZ needs to apply to each individual earthquake that I'm accessing so in order to not have the translates accumulate I need to add push matrix which is saving the current transformation state then I translate that I draw the box pop matrix which restores it so when it comes back in to the next one that previous translate won't affect it okay here we go we should see an earthquake somewhere now I you know I probably should number one make this box quite a bit larger maybe what I want to do is say fill 255 because that's the same color I have for the sphere I don't know what the spheres but yes so you can see there it is there it is on the sphere itself now let's go grab a lot of earthquakes from the last month and I'm going to go back to the USGS website and I'm going to go to past 30 days all earthquakes it's probably a terrible idea but I'm going to do it anyway and I'm now going to put that in here look I'm going to one thing I want to do is I want to just leave both case I need to do testing at some point I'll comment out the one day significant I will paste this in here and save now I'm getting everything for a month and then I'm going to run it we're gonna see a lot of spheres look at this there are all the earthquakes maps all over the sphere yeah that looks kind of reasonable let me let me change that now to make the box a little bit smaller okay so this looks more regional now there's a couple things I want to do I want to now angle I what I want is for the boxes to be extruded out based on the magnitude now I could just make the hole size I could just so I have a like a cube right the Box function only will ever draw a cube for me what I actually want to draw is something that can be like this boy I can't draw at all but you get the idea well what did I do you get the idea right I want to make there we go what am I making it worse I want to make a like a tower so box is a really convenient function to use because it gives me food just a box but for to make this kind of tower thing what I need to do is design my own shape so this particular shape I can create myself by saying begin shape and shape and then I could set a whole lot of vertices so I think about one of these planes just in the bottom this could be like the point negative 1 comma negative 1 comma negative 1 like if it and then this could be the point over here 1 comma negative 1 comma negative 1 right if this is sort of Z I could kind of just figure out and I could I could make a quad for this part of the of the I hope to call this tower it's almost like a cylinder but a box cylinder rectangle what if I call that's why gotta have a name looking to take here everyone's room above I'm seeing all the YouTube comments now so I could set all the points for this quad the miss quad miss quad miss quad miss quad miss quad how many quads with that it's 6 so what I'm going to do I'm going to come back over here and a box takes three arguments Thank You chat so I couldn't could do that but let's take a look oh thank you that's wonderful let's look at box processing cuddly so that's how you would have to do your own shape but and now seeing that I can actually give it three arguments and the three arguments are with height and depth so I think what I'm going to do is okay so let's just do I have the magnitude here I have it in mag and remember a magnitude for earthquake is based on the Richter scale so what I need to do is and then of course I have to think about the volume of but let's not worry about that too much let's just think about the height map to magnitude so what I'm going to do is say float H equals power 10 to the magnitudes 10 to the power of magnitude and then I can do a mapping which is if I say like max H is I think I used you know 10 to the 10th power I can actually just say H equals map itself from zero to max H to between you know 10 and 100 so now what I'm going to do is I could say maybe the width and height are always going to be maybe I want the height to be H and the X and z dimension the sort of width and depth will always be 5 so let's see what I get there okay oh so I can't tell if this work let me write let me not worry about this actually for a second let me just see if I can make some tall one so I'm going to make some with like a height of 100 and width okay so this is doing something but they're all pointing straight up so here's the next issue I want them to be pointing so then this is like a hard problem so if this is my sphere and I have something right on the edge of the sphere it's right now it's just pointing straight up I wanted to point out as if there was a ray shooting from the center of the sphere to the edge and continuing straight out so I have that ray the vector its position relative to the center I need to rotate this box to align it with that ray I probably could apply the rotation and translate out again but I'm going to have to do this with some math so one thing that I need I think math wise to do this is I need a vector which is just the axis like a kind of like let's sort normalized access that I can relate everything to and I'm going to make use it at the xaxis so I'm going to make a new vector which is the xaxis so a vector that the unit vector pointing along the x axis x axis is just 1 0 for y 0 for Z ok now where where am I here now what I'm going to do is I want to look at the angle between the xaxis and the vector itself so if this is my vector I want if I'm going to rotate kind of relative to the x axis I want to rotate it like this based on that angle so the nice thing is there's a function in p5 that use I'm sorry in processing but also p5 that uses the dot product behindthescenes another vector operation that I have some video tutorials about that give you that angle between so what I want to do here what I want to do here is say P vector and angle B for angle between but that's it really that's really like the I don't use angle because I'm using it already like yes angle between equals P vector dot angle between the xaxis and pause now remember pause is that oh there is no pause I'm saying cause I have to make a pause P vector equals new P vector pause X pause why pause V that position vector is the vector that points out from the center pause know what I think cause I'm doing this like I'm losing my mind XYZ so pause equals that P vector X Y Z okay this is good this is good so now I want an angle between the xaxis and pause what could you possibly be complaining about errors slope does not match oh yeah the angle between is a float not a vector it's just a float so by the way what did I let me just so you can see that it gave me this error type mismatch float does not match with cross link or P vector so you get an error like that it's because this function angle between returns a float and I said to set into a P vector which makes no sense what I want to do is establish a vector which is what I'm going to rotate around so for example this is the xaxis this is me rotating around the xaxis and what I want to do if I come back to over here right what I want to do if I want to rotate if I want to take this and I essentially want to I don't I want to rotate it to this point I want to rotate around the axis that's actually perpendicular out from these two vectors I'm not doing a very good job of explaining that this really needs a more thoughtful diagram I'm going to try to explain why we need the cross products here so let me diagram out what we have so far we have the xaxis and then we have a vector I'm going to use dot to note that this is coming out as if it were coming out like this this is the position but actually a way to think about that let's say the position is on a twodimensional plane like the xaxis right so what I ultimately need is to roll this is so good this is good what I need is to rotate this like this right this is what I'm drawing a box that's pointing straight up and I want to rotate it like this to match that direction so I need an angle to rotate it by and I'm going to be able to get that with this angle between that's the angle that I need to rotate it by maybe if I'm actually drawing this way is a better way to think of it so I might actually need to fix the box to be drawn this way and I want to rotate it like this so what access do I need to rotate it around this axis right I need to rotate it around this X now in this case if it was just 2d I know it just rotated around perfectly the z axis but what I want to do is called rotation around an arbitrary axis so let's say this was actually so instead of the position being on the same plane as the x axis what is the position we're pointing out here the axis that I want to rotate out is now perpendicular out maybe this way the way I get a vector that is perpendicular to two vectors that are connected is with something called the crossproduct okay so let's look at a diagram that I think will help explain this this is if this is vector a and this is vector V B this is showing you a and those vectors make a plane the crossproduct is the vector a cross B points out perpendicular from that plane so this is exactly the operation that I need to do to get that rotation axis so if I come back to my code I should be able to say now rotation axis I'll just call it our axis our axis equals x axis dot cross position and now here what did I get wrong oh and that's the vector right so the cross product returns a vector the angle between function returns an angle so now that I have the rotation axis I want to rotate around an arbitrary axis now how do you do that let's go look in the processing reference about rotate oh this is exciting processing morgue because distance might be a feature you weren't aware of there's this rotate function rotate is a function that you give it an angle look it rotates now it only says only thing you can give it as an angle but there's also like rotate X and that you can give it an angle and rotate Y so built into processing our rotation function for specific axis to x axis the y axis the z axis x y z ok so those are built into processing but I want to rotate around an arbitrary axis well this is not documented here in the in the main reference but this is actually a feature of the rotate function you could find it if you look at the Java Docs for processing for certain like advanced more advanced features what I can actually do is I can say rotate and I want to rotate by that angle remember I want to rotate by that angle around an arbitrary axis I could say our axis X or x sy our axis Z so the rotate function can actually take four arguments which is the angle of rotation and the XYZ of a vector of an axis of rotation and I think I got that right it could be that the egg the Angeles laughs I'm pretty sure the angle is first so let's now run this oh but I don't want to do the rotation here I want to do the rotation right here so after I translate to that location I want to rotate so let's now do that and we said oh that doesn't look right it's certainly rotating but it doesn't look right so I think the issue here is that I didn't draw what it what I did is I drew my looks wrong long I if I have that earth and I had that I kind of drew my boxes pointing up but then rotated to the x axis I mean I think I need to draw the boxes with the extrusion along the x axis for this to make sense so let me change that to the boxes the extrusion the value that's larger being the x value and there we go ah it works oh my god I'm so pleased oh that was really painful but totally work and I'm very pleased to see that Network so now in theory what I should be able to do is have the height be mapped to the earthquakes magnitude so let's put that back in and make this each and there we go now I guess I don't have okay so I'm not really able to see the distinctions very well between the particular earthquakes so I'm going to kind of fudge it here and I'm going to say like well I'm probably actually not there's really not any earthquakes right now in my data I have a magnitude of 10 so I'm going to just really consider the maximum that is like on the Richter scale of seven and then I'm going to map those ones that have a of a magnitude of seven to 100 pixels and the lower ones to ten and if I do that we should see here on getting some variations you can see there was one particularly really large earthquake and the other thing that's going on here is I've drawn these boxes actually be as a center the center is on the edge of the sphere so there's actually a rain going all the way inside that's probably cuing the stuff so I think we have to be more thoughtful about the relative scaling of these but you know we're getting something you know whatever that data might be you might not have earthquake data you could sort of see what the possibilities are here I could add color I could add textures I could be much more thoughtful let's do one thing just to see how kind of problematic what I've done is in a way if I want to actually see the you know what what we typically look like as the earth so I need to find a nice texture image to texture that sphere so let me go look for that okay I'm back I found there's a lot of places on the internet to get images of the earth I would attempt to use one from NASA NASA visible Earth I you know there's so many possibilities here I'm just going to grab November or I don't know December blue marble next generation and I'm going to download the image here I want just sort of the smallest one right now from the download this one and I'm gonna hit save and I'm going to go to my where is this project saved earthquakes 3d let me save this to the desktop earthquake 3d and then I'm going to save this to earthquake 3d I'm going to make a data folder and I am going to save this image I'm just going to call it a world earth earth JPEG alright now one thing I want to do is I want to check the dimensions of this image so I want to go to processing and go to look at that image and do it get info 5400 by 2700 sure why not let's just see if that works what not I said I wanted to check it and I'm like whatever it is is fine so here's the thing I can actually texture this sphere very very easily I think I might need to bring in a pshape object so let's just see first I want to I need an image and I'm going to call that image earth and then in setup I am going to say earth equals load image Earth's JPEG so now I have access to that image in the computer's memory just to be sure that this is working I'm going to say image earth 0 0 so now I'm just going to kind of draw that image in the background and we can see there it is there's an image of the earth so in the background I've got that image loaded now in theory what I would want to be able to do is just say texture earth right before I draw the sphere but that doesn't work so the way that I you can't I don't I don't believe in processing it works to automatically texture one of these primitive shapes of sphere actually is a shape that's built up by many different triangles but what I can do however is create a P shape and I'm going to call that globe this is already called something earth and I'm going to say globe E we'll create shape and then I think all I need to do is say fear and then give it let's make the radius a global variable and then give it a radius I think this now just create shapes this is a shape object that is a sphere and that has a radius now I should be able to say here where I'm drawing the sphere now I should be able to say and let me get rid of this texture I should be able to say shaped shape globe so I'm drawing instead of drawing the sphere as like and actually this is much more efficient but instead of computing for your geometry over and over again I have this work saved see your object that I'm just drawing into the into the scene so there we go now you can see the sphere that now I have it now it has a default stroke and it has a which is black and it also has a default fill so what I want to do first of all is I want to get rid of drawing me in that image and I want to I think I could say no stroke and then I think I can say just globe texture and then that Earth image so I think now this will give me that image of the earth actually the function is not called texture I forgot it's called set texture that's the way to set it set a particular image to auto texture that particular shape so now let's try running this and there we go so now you can see my earth is textured with that image from NASA and the earthquakes are on it however I have done something rather incorrect which is that if I kind of zoom in and look at this these earthquakes are just not in the right place if I slow down we slow down this rotation and because if you remember from that there's a lot of earthquakes that happen along at least along the California coast of the United States and up into Alaska and I think we'll be able to kind of see that collection of earthquakes here it is that's that collection of earthquakes that kind of goes along I haven't aligned the texture with this or XYZ transformation so this I'm going to leave as a challenge it's code will get published to figure that out and you know number one is I probably don't need to flip this why maybe flipping this why I might need to do something where I kind of rotate the earth into the right position to align so I'm not really I'm gonna research this I'll come back next week and show on the livestream solutions to this particular problem but but and also here's the thing regardless of that earth texture there's so much that you could do with this what other kind of data could you map to a 3d version of the earth what other what other ways could you visualize the earthquake data color you could certainly use you know particles emanating you know you could timelapse and show earthquakes over time or a very long period of time might be interesting are other kinds of data so hopefully this gives you this this tutorial gives you a sense of how to work with 3d how some of the math can get kind of tricky when you start in with vectors and rotations and also just we're a little bit about working with data in processing okay thanks very much and I'll see you in the future Cody Johnson
