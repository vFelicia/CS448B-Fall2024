With timestamps:

00:00 - (upbeat piano music)
00:04 - - Ah!
00:05 - Okay, hello and welcome
to a coding challenge,
00:08 - Google Chrome dinosaur game edition.
00:10 - Unfortunately I don't
have my train whistle.
00:12 - I didn't bring it with me today,
00:13 - so this is definitely not gonna go well.
00:15 - Not that any of my coding
challenges ever go well,
00:17 - but I'm gonna give this a try.
00:18 - I'm gonna attempt to program, quickly,
00:22 - the Google Chrome dinosaur game.
00:23 - I'm gonna use my own images and stuff,
00:24 - so it will be the unicorn game, of course.
00:27 - I'm gonna use p5.js, the
JavaScript library p5.js,
00:30 - and I'm going to interact
with it in a unique way
00:33 - that you have to stick around
for the end of the video.
00:35 - I'll just tell you now.
00:36 - I'm gonna try to control it with my voice.
00:37 - (laughing)
00:38 - Okay, so you skip to the end,
maybe I'll be doing it there.
00:41 - Okay, so here we go, let's get started.
00:44 - So, what do I need to do?
00:46 - So, first I'm gonna make a, I'm gonna add,
00:49 - I'm in the p5 web editor,
and I'm gonna add a file,
00:52 - I'm gonna call it dino.js,
even though it's not,
00:55 - no, let's call it unicorn, unicorn.js.
00:59 - And that's gonna be my unicorn.
01:02 - And what do I need?
01:02 - I also need to have, those
are like cactus thingies,
01:05 - those are gonna be
trains, so I'm gonna make
01:07 - a train.js, add file.
01:10 - So, let's start by creating
the unicorn, class Unicorn.
01:15 - So, I'm gonna use object-oriented
programming because,
01:16 - you know, I do, this, by the way,
01:18 - is exactly the same as Flappy
Bird, so I'm really just doing
01:21 - the same thing over again, but whatever.
01:22 - This is a nice,
beginner-friendly challenge,
01:26 - and maybe using
object-oriented programming
01:27 - is a little bit overkill,
but let's give the unicorn
01:31 - an x location at 50 and a y location,
01:34 - which will be height, 'cause it's sitting
01:35 - at the bottom of the window,
but maybe I'll say, like,
01:38 - height minus 50 right now,
01:40 - and then I'm going to create
a function called show,
01:44 - and I'm going to draw it,
I'm just gonna draw it
01:46 - as a rectangle right
now at this.x, this.y,
01:50 - and I'll make it 50, 50.
01:53 - So, this is the Unicorn class.
01:55 - A Unicorn object has an x and a y,
01:58 - and when I draw it, it's a rectangle
01:59 - at that x and y with a height of 50,
02:01 - and those'll probably need
to be variables eventually.
02:04 - So, let me make a variable called unicorn.
02:08 - I'm gonna say unicorn is a new Unicorn,
02:11 - and I'm gonna say here, unicorn.show.
02:17 - And let's run this, there we go.
02:20 - Oh, okay.
02:21 - So of course, I forgot
what I always forget,
02:23 - which is that I've added
some new JavaScript files,
02:25 - and I need to reference them in my HTML.
02:29 - Unicorn, and what was
the other thing called?
02:32 - Train.
02:33 - All right, so that's a
unicorn, and what I want is,
02:37 - wait, let me play that game again.
02:38 - How does it work?
02:40 - It just sits there, so every time
02:42 - I press the space bar, it jumps.
02:44 - So, let's get it to do that first,
02:46 - let's get it to do that first.
02:47 - Okay, so what does it need
in order to be able to jump?
02:52 - It needs a velocity, a
speed along the y axis,
02:56 - so let's call this vy,
and we'll say that's zero.
03:01 - And we'll write a function called jump,
03:04 - which we will give it kind
of this instant force.
03:08 - So, we're gonna, like, push it up.
03:10 - So, I'm gonna say this.vy
equals, let's say negative five.
03:16 - That's moving it up.
03:18 - And then I'm gonna write
a function called move,
03:20 - which says this.y += this.vy.
03:27 - So, what we should see now is,
03:29 - if I say unicorn.move, and then if I add
03:34 - function keyPressed and say
if the key is the space bar,
03:42 - unicorn.jump, this really is basically
03:46 - the same as Flappy Bird so far,
03:47 - then we should see that velocity kick in.
03:51 - So, I'm always moving it based on
03:53 - whatever that velocity is,
03:55 - but the velocity is
zero, the speed is zero.
03:57 - But as soon as I say
jump, it sets the speed
04:01 - to negative five and we should
start to see it move up.
04:04 - Okay, here we go.
04:05 - Moving along here, I'm gonna
press space, there we go.
04:07 - Ah!
04:08 - Goodbye, unicorn, see you later!
04:11 - All right, so we need gravity,
04:13 - so we need some form of gravity,
04:15 - which probably makes sense
as a global variable,
04:17 - but I'm just gonna, since the gravity's
04:19 - really only gonna affect the unicorn,
04:21 - I'm gonna put it in here.
04:22 - Let's say it's a 0.5.
04:24 - So, gravity is, in a way,
a counteracting force,
04:28 - so no matter what it's
doing, the gravity is always
04:33 - adjusting the speed of the unicorn,
04:36 - the acceleration, basically.
04:38 - So, what I could do now, also in move,
04:40 - is say this.vy += this.gravity, however,
04:44 - I don't want to ever let,
because see, now it's gone.
04:48 - I don't wanna ever let the unicorn
04:51 - fall off the bottom.
04:52 - There should be basically a ground level.
04:54 - So, I'm gonna, to do that, let's say,
04:59 - so let's make this 50 a size.
05:01 - Let's say r = 50.
05:03 - So, we're going to kind of use that
05:08 - for all the parts where we're drawing.
05:13 - And then I'm also going to say,
05:16 - I'm gonna have a constraint.
05:17 - So, I'm gonna say this.y = constrain.
05:22 - Its current y value
between zero and, really,
05:29 - where it's sitting at the bottom,
05:30 - which is also height - this.r.
05:33 - So, it's stuck there,
and now if I press, oops,
05:35 - press space, you can see it jumps.
05:38 - Now, that's a very measly little jump.
05:41 - We need to be able to jump much more,
05:44 - so let's set this to, like,
25, and let's see what happens.
05:49 - Okay, that's too much.
05:53 - Let's just set it to 10.
05:55 - Maybe I need to make the
gravity stronger too.
06:00 - So, there's gonna be a lot
of fine tuning of this,
06:03 - but let's just do that.
06:06 - And let's set this to 25.
06:09 - Oops.
06:11 - Maybe let's set the gravity to two.
06:13 - There we go, this feels a bit more
06:15 - like the dinosaur game.
06:17 - So, this is kind of sad.
06:18 - Let's make our unicorn look
a little bit more exciting.
06:24 - Let's load an image.
06:25 - So, I have on the desktop
here, I have some images.
06:29 - I have a background, which will be
06:30 - the background of the game.
06:31 - I have a unicorn.
06:33 - This'll be the character with a little
06:35 - angry equal sign sitting on it.
06:37 - And then the train will be the thing
06:38 - it has to jump over.
06:40 - So, let's, so what I'm gonna do here
06:43 - is I'm gonna add these
files, I'm gonna do add file,
06:46 - and I'm going to drag
them into the web editor.
06:49 - It uploaded all of them.
06:52 - And then, in here, I'm gonna add preload,
06:59 - and I'm gonna have let uImg,
let tImg, and let bImg,
07:08 - and let's load all of those.
07:09 - uImg = loadImage unicorn.png,
and we'll do the same
07:17 - for tImg and bImg.
07:19 - This is train and this is background.
07:22 - Let's change the background to,
07:23 - ooh, what I'd get wrong here?
07:25 - Background is actually a jpg.
07:28 - So, let's have the background
now be bImg, there we go,
07:33 - and let's have the unicorn, where is it,
07:36 - be, I'm gonna say image,
uImg, there we go.
07:41 - Ooh, it's so tiny!
07:42 - And it's all pixelated, it so sad!
07:45 - Let's change this to 150.
07:50 - Its x value shouldn't
be, it should be here.
07:54 - There we go, so there's
our jumping unicorn.
07:58 - This is not a lot of screen
real estate to work with,
08:00 - so let me actually load a background image
08:02 - that's 800 pixels wide, which
I think will be a little more,
08:05 - which I think will be a
little better than 600.
08:07 - All right, my unicorn can jump
08:08 - and I've made the
background a little wider,
08:10 - which means now I need
obstacles for it to jump over,
08:13 - and those are going to
be little train things.
08:16 - So, I'm gonna make another
class, call it a Train.
08:20 - Choo-choo.
08:22 - I'm gonna give that a constructor.
08:24 - These will have also an x and a y,
08:30 - so the x will be, it's
gonna start off the edge,
08:34 - and the y will be actually
also at the bottom.
08:39 - So, height minus, I'll give it a size,
08:43 - and this.r will be 100, and then,
08:48 - so now I need a show function,
08:51 - and that, I'm going to draw as an image.
08:57 - (laughing)
08:58 - My fingers are in the wrong place.
09:00 - The train image at x and y,
09:06 - this.r, this.r, and let's
also add a move function,
09:14 - and we'll say this.x -=, and so,
09:17 - the train, so this is a weird thing.
09:20 - It's supposed to be, oh,
this is gonna be a problem.
09:22 - (laughing)
09:24 - My fixed background is gonna
make this visually a problem,
09:27 - and people on the chat are saying
09:28 - paralaxed background, please.
09:30 - All right, so maybe I'm gonna get to that.
09:32 - This is gonna end up being a longer video
09:33 - if I implement that, but really,
09:35 - the unicorn is moving,
so the unicorn is moving,
09:38 - but the x stays fixed.
09:40 - The trains, well, the
trains could be moving
09:43 - if they're trains, that's weird,
09:44 - but they're supposed
to be cactuses, cacti.
09:46 - They're standing still and the unicorn's
09:47 - just approaching them, but we're seeing it
09:49 - from the unicorn's point of view.
09:50 - Boy, I've really botched this.
09:52 - But what I'm gonna do
is just move them by,
09:56 - the whole scene is
scrolling by three pixels,
09:59 - and we'll figure out if we can
10:00 - paralax the background maybe later.
10:02 - What do I even mean by paralax?
10:03 - To make it appear as if
the background is changing,
10:06 - but off in the distance, so it's sort of
10:08 - moving at a different speed.
10:09 - But for now, let's just do this.
10:12 - Let's create an array called trains,
10:17 - and we're going to say, in setup,
10:20 - well actually, you know
what we're gonna do?
10:21 - In draw, we're just going to randomly,
10:26 - we're going to pick a random number
10:28 - between zero and one, and we'll say, like,
10:30 - one percent of the
time, we're going to say
10:34 - trains.push, we're gonna add a new train,
10:38 - so it's gonna be irregular.
10:39 - This is different than
the Flappy Bird I made,
10:41 - where I think the pipes,
maybe it was irregular.
10:43 - I think the pipes were
at regular intervals.
10:46 - Now there's a random chance
of adding a new train,
10:49 - and then all the trains that exist,
10:51 - we're gonna say for all of the trains,
10:54 - I'll just say t in trains,
10:57 - I'm gonna say t.move, t.show.
11:00 - All right, let's see what happens.
11:03 - Do we have a train?
11:05 - Maybe I'd better increase it.
11:07 - There we go, oh, look at that.
11:09 - All right, they're moving.
11:10 - They're kinda slow.
11:12 - I'm gonna jump over it, oops, okay.
11:14 - (laughing)
11:16 - Let's make them move a little faster.
11:19 - So, we've got some
tweaking we've gotta do.
11:23 - Whoa, this is a, oh, this is a nice way.
11:25 - Oh, look, my unicorn can fly.
11:27 - So, I need to fix the fact,
11:28 - I need to, like, not allow
my unicorn to fly, right?
11:30 - It should only be able to
jump if I'm a the bottom,
11:34 - so let's fix that.
11:35 - So, to do that, I need to go into Unicorn,
11:40 - and in jump function, I
should only be allowed to jump
11:45 - if I'm sitting at the bottom.
11:48 - So, in other words, if y is,
11:52 - oh well, if I'm at the bottom,
11:54 - so as long as y is equal to,
11:56 - is this really gonna work?
11:57 - I don't like to use equal checks,
12:00 - but this is, by definition,
sitting at the bottom,
12:03 - so only if I'm sitting
at the bottom can I jump,
12:06 - so if y is equal to that spot.
12:08 - Let's see if that works.
12:10 - So, jump, oops, jump.
12:13 - Oh, this.y.
12:16 - Come on, trains.
12:19 - Oh, yep, I can only jump
when I'm at the bottom.
12:22 - All right, so that works, so that's fixed.
12:24 - I think I need to be able
to jump quite a bit higher.
12:26 - Let's try 35.
12:28 - I should really use a slider or something.
12:30 - There we go, I think this
is gonna make the game
12:32 - more possible to win.
12:33 - There's too many trains, too many trains!
12:37 - One thing that's bothering me is
12:38 - the trains are going in
front of the unicorn.
12:40 - I know that doesn't really matter so much,
12:42 - it certainly doesn't matter,
12:43 - but I kind of would
prefer them to be behind,
12:45 - so I'm gonna move this here.
12:50 - I'm also gonna make the game
a little easier to play.
12:53 - I'm gonna reduce the number of trains,
12:54 - so there's gonna be a
much lower probability
12:57 - of there being a train.
12:58 - Let's see if I can actually play this game
13:00 - somewhat successfully,
even though I'm not doing
13:01 - the collision checking yet.
13:04 - (laughing)
13:05 - No!
13:07 - I think if the trains moved faster,
13:08 - it would actually make it easier,
13:10 - so let's actually double
the speed of the trains.
13:13 - All right, this looks like this game
13:15 - is now possible to play.
13:20 - But I need to add collision detection.
13:23 - So, I've done this before
13:24 - in plenty of other coding challenges.
13:26 - There's a pretty simple algorithm
13:28 - to just check if two rectangles
13:29 - are intersecting with each other or not.
13:31 - I can just check their x's and y,
13:33 - basically all the edges,
the left, the right,
13:35 - the top, the bottom, against each other,
13:37 - but this is a nice opportunity
13:38 - for me to just explore a library
13:39 - that's out there in the world,
13:41 - and this library is called p5.collide2D,
13:44 - and it actually has a function in it
13:45 - called collideRectRect, and it'll give me
13:48 - a Boolean variable if I give it
13:50 - the x, y, width, height of one rectangle
13:53 - and the x, y, width, height
of another rectangle.
13:55 - So let's actually just use this library.
13:58 - This is also a nice
excuse for me to show you
14:00 - that GitHub is now integrated
14:03 - with something called jsDelivr.
14:05 - This is an Open Source
content delivery network,
14:08 - meaning if a JavaScript
file is hosted on GitHub,
14:10 - I don't have to download that file
14:12 - and then add it to my project,
14:14 - I can just link to it.
14:15 - So, I'm gonna go over here to GitHub.
14:18 - There's lots of different ways here
14:19 - that I can reference a file on GitHub.
14:21 - I think the easiest way for
what I'm doing right now
14:23 - is just to reference its path,
14:26 - and here's an example path,
14:28 - so I'm gonna go over here to index.html,
14:31 - I'm gonna add another script tag.
14:33 - I'm gonna say script src equals,
14:37 - I'm gonna paste that in, close script,
14:40 - but this is not the path that I want.
14:43 - I want the username, which is B-M-O-R-E-N,
14:50 - and then I want the path to,
14:52 - let's get the minified
version of the library,
14:55 - and that would just be this
14:58 - right there in the root directory.
15:00 - So, now I'm just referencing that file.
15:02 - Let's see if that works.
15:04 - This is actually not correct.
15:05 - I'm referencing the cdn URL, the username,
15:09 - but I also need the repo name,
15:11 - so that should be p5.collide2D slash this,
15:17 - so this should now work, okay,
15:21 - and I should be able to
use the collide function.
15:28 - So, I'm gonna use this collideRectRect.
15:32 - Let me just call this in
draw to see if that works
15:36 - and doesn't give us an error.
15:39 - Great, no error.
15:42 - And so now, I can check,
when I'm going through
15:44 - all of the trains, if unicorn hits t,
15:52 - console.log game over, okay.
15:57 - So, console.log game over,
16:00 - and then I'm actually gonna say no loop,
16:03 - so I'm just gonna
actually stop the sketch,
16:05 - shut down the sketch completely,
16:06 - which isn't a really thoughtful
16:08 - user experience design choice,
16:10 - but it's what I'm gonna do for right now.
16:12 - And then, I just need
to add a function here
16:16 - called hits, and receives a train,
16:21 - and I can say, I can use this function,
16:26 - which I need this.x,
this.y, and this.r, this.r,
16:34 - and then I need exactly the same thing,
16:36 - but with that particular train.
16:38 - So, instead of this, I'm
checking this rectangle
16:42 - with this train's rectangle,
16:44 - and I'm going to put this in
a variable called collide,
16:49 - and I'm gonna say, if,
I'm gonna return that.
16:52 - Actually, you know what,
I'm just returning this.
16:55 - Return that, so return
the true or false results
16:58 - of this collide function
from that library,
17:01 - and now let's run the game.
17:04 - We'll wait for our first train.
17:06 - Game over!
17:07 - Let's see if I can play it now.
17:10 - Oh, there were so many trains a while ago.
17:13 - Oh, shoot!
17:15 - Let's make the train a little bit smaller,
17:18 - and actually, let's make
the unicorn smaller as well.
17:23 - Hopefully this will help.
17:27 - (laughing)
17:29 - All right, let's draw the,
let's debug this a little bit
17:33 - by drawing the box, like, very subtly.
17:37 - So, let's draw a very slight rectangle.
17:42 - This is what we're actually checking.
17:44 - There we go, woo-hoo!
17:46 - It helps to see the full box.
17:49 - Come on, trains.
17:51 - Spawning a train with a mouse
click would be a good idea.
17:54 - Okay, we lost.
17:55 - All right, so there's obviously
17:57 - a lot of gameplay improvements
17:58 - that need to happen here.
17:59 - One is I could be more thoughtful about,
18:02 - and you can see how there's
some wasted space here.
18:04 - I should crop the image
and the actual rectangle
18:07 - a little bit smaller.
18:08 - I could consider using a circle,
18:09 - I could use a more complex shape.
18:11 - But this is good enough for right now.
18:14 - Let's actually make it, you know,
18:17 - I could also just click the mouse
18:18 - in order to start a train,
18:20 - that might actually help things.
18:22 - But let me comment out this,
18:24 - and what I wanna do, just before I go,
18:26 - before I finish it, and you're gonna make
18:27 - a version of this with a score
18:29 - and all sorts of nicer things, and sounds,
18:32 - but I gotta finish this off,
I gotta finish this video.
18:35 - I want to control the train with my voice,
18:38 - so to do that, I'm gonna do this ml5.js,
18:41 - which has a speech commands
machine learning model
18:45 - built into this JavaScript library.
18:48 - So, I made a whole separate video
18:49 - about this particular pre-train
model and how it works,
18:52 - so I'm just going to add it
pretty quickly into this video.
18:55 - You can go watch the other
one for more details.
18:57 - But if you're looking
for the documentation,
18:59 - if I click on reference
and go to soundClassifier,
19:01 - this is what I'm looking at doing.
19:03 - So, all I'm doing, first
thing I need to do is,
19:05 - well, actually, one thing I need to do
19:06 - is I need to go to get started,
19:08 - and I need to get a script tag
19:11 - to be able to reference the library.
19:12 - So, I wanna add the ml5
library, so I'm copying this,
19:16 - I'm going here to index.html,
19:18 - and in addition to p5.collide2D,
I'm now adding ml5,
19:23 - and I'm going to go here,
and I'm gonna, in preload,
19:27 - I'm gonna do let soundClassifier,
19:30 - I'm gonna create a variable.
19:31 - In preload, I'm gonna say soundClassifier
19:35 - equals ml5.soundClassifier,
19:38 - and the model I'm loading
is called SpeechCommands18w,
19:45 - because this is a model
that's been trained
19:48 - to recognize 18 particular words,
19:53 - the digits zero through nine,
19:55 - up, down, left, right,
and a few other ones
19:58 - that are documented on this ml5 webpage.
20:01 - Let's go look that up real quick.
20:02 - So, if I go back to soundClassifier,
20:05 - up, down, left, right, go, stop, yes, no.
20:08 - So, those are the words
it's trained to recognize,
20:10 - and I actually also wanna get
20:11 - this probably threshold, so
I'm gonna add this in here,
20:16 - because I want it to be
really sure I'm saying jump,
20:19 - so I'm gonna make this 95.
20:21 - This means it's gotta be 95% sure
20:24 - the confidence score that's coming
20:25 - from that particular model,
and how that model was trained,
20:29 - and there's a paper you can read,
20:31 - and I talk about that
more in the other video.
20:32 - Okay, so now that I have that,
20:35 - in setup, I can say
soundClassifier.classify.
20:42 - Then I can get a function.
20:44 - I'm just gonna call it
gotWord, so it's got a word,
20:47 - gotCommand, let's call it gotCommand.
20:49 - So, this is a callback function
20:51 - that is going to trigger
any time it gets a command.
20:54 - It gets an error first,
error first callbacks,
20:57 - and then the results.
20:59 - So, just say if there's an error, console,
21:04 - I'm just gonna console.error the error.
21:07 - Otherwise, if results index zero.label.
21:11 - So, results is an array with
labels and confidence scores,
21:15 - and the labels are the words,
21:17 - and what I'm looking for is the word up.
21:19 - If that label is up, then unicorn.jump.
21:24 - So, this is a really quick way
21:26 - of me looking for a particular keyword
21:30 - from that library,
21:33 - and I'm also just gonna
console.log results[0].label,
21:41 - just to see if I'm
getting other words also.
21:44 - And we might as well log
the confidence score,
21:47 - just so we can see that.
21:48 - That might be good for debugging as well.
21:52 - So now that I've logged those two things,
21:56 - I'm gonna run this sketch.
22:00 - Up!
22:02 - (laughing)
22:03 - Up!
22:08 - Up!
22:09 - (laughing)
22:10 - Shoot!
22:10 - But you can see, it got up 95%.
22:15 - I'm gonna add the thing
where I click the mouse
22:17 - and I can give myself a train.
22:20 - And in fact, let's comment
out the random trains.
22:23 - Also, I really should be more thoughtful
22:25 - about how I'm picking when
the trains should come.
22:28 - Like, maybe there's a minimum
distance between them.
22:30 - If I've just added one,
can I have a longer train
22:34 - with other train cars?
22:36 - I don't know what's going on here.
22:37 - There's a lot of narrative flaws
22:38 - in what's going on here,
22:39 - but I'm just gonna add one myself.
22:43 - Up!
22:45 - (laughing)
22:47 - Up!
22:48 - Shoot.
22:49 - All right, everyone is making
the suggestion in the chat
22:52 - that I should change it to a circle,
22:54 - so that'll actually kinda be like a round,
22:56 - it'll give me a little
wiggle room along the edges
22:58 - and make the intersection
happen a little less often,
23:01 - so let's actually go ahead and do that.
23:02 - So, I'm gonna go into,
where the only place
23:05 - where I'm doing this
collision detection is where?
23:08 - In the unicorn under hits.
23:11 - So, I'm gonna change this
to collideCircleCircle.
23:16 - collideCircleCircle, and circle to circle
23:21 - assumes ellipse mode center,
23:23 - so I'm gonna have to think of the circle
23:25 - as the center point of the object,
23:28 - which is not a big deal. So,
the way that I'm gonna do that,
23:30 - let's make some separate variables.
23:32 - Let's say x1 = this.x + this.r * 0.5.
23:36 - So, this would be the middle.
23:39 - This is the middle, and then r
23:43 - is the diameter of the
circle, so that's fine,
23:46 - and this is y.
23:48 - And then, x2, y2 is the train.
23:54 - Train.x, train.y, train.r, train.r.
23:59 - And so now, I want
collideCircleCircle, x1, y1,
24:07 - and then x2, y2.
24:10 - The question is, is r actually the radius
24:13 - or is it the diameter?
24:14 - Does it say?
24:16 - CircleDiameter,
circleDiameter, so I'm good.
24:18 - All right, so let's try this,
24:19 - and then this should really be,
24:21 - oh, this is kind of unfortunate.
24:23 - This should now be an ellipse.
24:25 - Oh, you know what I can just do?
24:26 - I can say ellipseMode CORNER.
24:30 - Perfect, so let's draw this hit circles,
24:34 - and under Train, let's
do the same thing here
24:37 - and say ellipse, there.
24:39 - So this should now, we
should see, here we go.
24:45 - That's what it's gonna do.
24:46 - Okay, here we go!
24:47 - Oh, I have to click.
24:51 - Oh, whoa, what happened?
24:53 - (dinging)
24:53 - All right, I passed r in twice,
24:56 - which is very unnecessary.
24:58 - you just give it the
diameter, not the radius,
25:00 - even though I'm calling in r once.
25:02 - And let's see what
happens, okay, here we go.
25:05 - Jump!
25:07 - Wait, why is my browser
really freaking out?
25:11 - Let's comment out the debugging.
25:13 - We're just gonna go for it now,
25:14 - we're gonna play this game.
25:16 - Let me close this tab.
25:18 - Quit Chrome.
25:24 - We're about to play this game!
25:27 - Oh, up, it's up, I'm saying jump.
25:30 - (laughing)
25:32 - Oh, up, there we go, up!
25:36 - Up!
25:38 - Up!
25:39 - All right, you ready everyone?
25:41 - (upbeat piano music)
25:44 - Up!
25:45 - (laughing)
25:50 - Up!
25:52 - Oh, maybe, I guess I can't use the music.
25:57 - Up!
25:59 - Up!
26:02 - Up!
26:03 - (laughing)
26:04 - Oh!
26:05 - All right, everyone, thus
ends this coding challenge.
26:08 - There are so many things that
need to be added to this.
26:10 - Number one, the narrative
just makes no sense.
26:13 - Why is there this unicorn standing still
26:15 - without any animation?
26:17 - The trains are coming at it.
26:19 - The background should be
sort of in paralax moving.
26:22 - So probably it should be jumping over,
26:23 - I should've just used cacti.
26:25 - That's the plural of cactus, right?
26:27 - There's no score, there's no birds flying.
26:32 - You could add a flying asterisk.
26:33 - I'm gonna, when I upload this,
26:35 - I'm gonna include, when
this video publishes,
26:39 - with the code, I will include a lot of
26:40 - the Coding Train characters,
26:42 - which are designed by Jason Heglund,
26:44 - illustrated and designed by Jason Heglund,
26:46 - so I'm gonna include
a whole bunch of those
26:48 - if people wanna make
a version of this game
26:50 - that we can all play online
with speech commands.
26:53 - Let me try this.
26:54 - I'm gonna just say goodbye
by trying this one more,
26:57 - and yes, Alka is pointing out
26:58 - that speech detection API in the browser
27:01 - might be lower latency, but
let's try this one more time.
27:05 - Up!
27:07 - Up!
27:10 - Up!
27:12 - Up!
27:14 - Up!
27:16 - Up!
27:18 - Up!
27:19 - Oh, okay, goodbye everyone!
27:22 - Thank you very much and see you later
27:23 - on a future coding challenge.
27:24 - (dinging)
27:25 - (upbeat techno music)
27:32 - (dinging)

Cleaned transcript:

(upbeat piano music) Ah! Okay, hello and welcome to a coding challenge, Google Chrome dinosaur game edition. Unfortunately I don't have my train whistle. I didn't bring it with me today, so this is definitely not gonna go well. Not that any of my coding challenges ever go well, but I'm gonna give this a try. I'm gonna attempt to program, quickly, the Google Chrome dinosaur game. I'm gonna use my own images and stuff, so it will be the unicorn game, of course. I'm gonna use p5.js, the JavaScript library p5.js, and I'm going to interact with it in a unique way that you have to stick around for the end of the video. I'll just tell you now. I'm gonna try to control it with my voice. (laughing) Okay, so you skip to the end, maybe I'll be doing it there. Okay, so here we go, let's get started. So, what do I need to do? So, first I'm gonna make a, I'm gonna add, I'm in the p5 web editor, and I'm gonna add a file, I'm gonna call it dino.js, even though it's not, no, let's call it unicorn, unicorn.js. And that's gonna be my unicorn. And what do I need? I also need to have, those are like cactus thingies, those are gonna be trains, so I'm gonna make a train.js, add file. So, let's start by creating the unicorn, class Unicorn. So, I'm gonna use objectoriented programming because, you know, I do, this, by the way, is exactly the same as Flappy Bird, so I'm really just doing the same thing over again, but whatever. This is a nice, beginnerfriendly challenge, and maybe using objectoriented programming is a little bit overkill, but let's give the unicorn an x location at 50 and a y location, which will be height, 'cause it's sitting at the bottom of the window, but maybe I'll say, like, height minus 50 right now, and then I'm going to create a function called show, and I'm going to draw it, I'm just gonna draw it as a rectangle right now at this.x, this.y, and I'll make it 50, 50. So, this is the Unicorn class. A Unicorn object has an x and a y, and when I draw it, it's a rectangle at that x and y with a height of 50, and those'll probably need to be variables eventually. So, let me make a variable called unicorn. I'm gonna say unicorn is a new Unicorn, and I'm gonna say here, unicorn.show. And let's run this, there we go. Oh, okay. So of course, I forgot what I always forget, which is that I've added some new JavaScript files, and I need to reference them in my HTML. Unicorn, and what was the other thing called? Train. All right, so that's a unicorn, and what I want is, wait, let me play that game again. How does it work? It just sits there, so every time I press the space bar, it jumps. So, let's get it to do that first, let's get it to do that first. Okay, so what does it need in order to be able to jump? It needs a velocity, a speed along the y axis, so let's call this vy, and we'll say that's zero. And we'll write a function called jump, which we will give it kind of this instant force. So, we're gonna, like, push it up. So, I'm gonna say this.vy equals, let's say negative five. That's moving it up. And then I'm gonna write a function called move, which says this.y += this.vy. So, what we should see now is, if I say unicorn.move, and then if I add function keyPressed and say if the key is the space bar, unicorn.jump, this really is basically the same as Flappy Bird so far, then we should see that velocity kick in. So, I'm always moving it based on whatever that velocity is, but the velocity is zero, the speed is zero. But as soon as I say jump, it sets the speed to negative five and we should start to see it move up. Okay, here we go. Moving along here, I'm gonna press space, there we go. Ah! Goodbye, unicorn, see you later! All right, so we need gravity, so we need some form of gravity, which probably makes sense as a global variable, but I'm just gonna, since the gravity's really only gonna affect the unicorn, I'm gonna put it in here. Let's say it's a 0.5. So, gravity is, in a way, a counteracting force, so no matter what it's doing, the gravity is always adjusting the speed of the unicorn, the acceleration, basically. So, what I could do now, also in move, is say this.vy += this.gravity, however, I don't want to ever let, because see, now it's gone. I don't wanna ever let the unicorn fall off the bottom. There should be basically a ground level. So, I'm gonna, to do that, let's say, so let's make this 50 a size. Let's say r = 50. So, we're going to kind of use that for all the parts where we're drawing. And then I'm also going to say, I'm gonna have a constraint. So, I'm gonna say this.y = constrain. Its current y value between zero and, really, where it's sitting at the bottom, which is also height this.r. So, it's stuck there, and now if I press, oops, press space, you can see it jumps. Now, that's a very measly little jump. We need to be able to jump much more, so let's set this to, like, 25, and let's see what happens. Okay, that's too much. Let's just set it to 10. Maybe I need to make the gravity stronger too. So, there's gonna be a lot of fine tuning of this, but let's just do that. And let's set this to 25. Oops. Maybe let's set the gravity to two. There we go, this feels a bit more like the dinosaur game. So, this is kind of sad. Let's make our unicorn look a little bit more exciting. Let's load an image. So, I have on the desktop here, I have some images. I have a background, which will be the background of the game. I have a unicorn. This'll be the character with a little angry equal sign sitting on it. And then the train will be the thing it has to jump over. So, let's, so what I'm gonna do here is I'm gonna add these files, I'm gonna do add file, and I'm going to drag them into the web editor. It uploaded all of them. And then, in here, I'm gonna add preload, and I'm gonna have let uImg, let tImg, and let bImg, and let's load all of those. uImg = loadImage unicorn.png, and we'll do the same for tImg and bImg. This is train and this is background. Let's change the background to, ooh, what I'd get wrong here? Background is actually a jpg. So, let's have the background now be bImg, there we go, and let's have the unicorn, where is it, be, I'm gonna say image, uImg, there we go. Ooh, it's so tiny! And it's all pixelated, it so sad! Let's change this to 150. Its x value shouldn't be, it should be here. There we go, so there's our jumping unicorn. This is not a lot of screen real estate to work with, so let me actually load a background image that's 800 pixels wide, which I think will be a little more, which I think will be a little better than 600. All right, my unicorn can jump and I've made the background a little wider, which means now I need obstacles for it to jump over, and those are going to be little train things. So, I'm gonna make another class, call it a Train. Choochoo. I'm gonna give that a constructor. These will have also an x and a y, so the x will be, it's gonna start off the edge, and the y will be actually also at the bottom. So, height minus, I'll give it a size, and this.r will be 100, and then, so now I need a show function, and that, I'm going to draw as an image. (laughing) My fingers are in the wrong place. The train image at x and y, this.r, this.r, and let's also add a move function, and we'll say this.x =, and so, the train, so this is a weird thing. It's supposed to be, oh, this is gonna be a problem. (laughing) My fixed background is gonna make this visually a problem, and people on the chat are saying paralaxed background, please. All right, so maybe I'm gonna get to that. This is gonna end up being a longer video if I implement that, but really, the unicorn is moving, so the unicorn is moving, but the x stays fixed. The trains, well, the trains could be moving if they're trains, that's weird, but they're supposed to be cactuses, cacti. They're standing still and the unicorn's just approaching them, but we're seeing it from the unicorn's point of view. Boy, I've really botched this. But what I'm gonna do is just move them by, the whole scene is scrolling by three pixels, and we'll figure out if we can paralax the background maybe later. What do I even mean by paralax? To make it appear as if the background is changing, but off in the distance, so it's sort of moving at a different speed. But for now, let's just do this. Let's create an array called trains, and we're going to say, in setup, well actually, you know what we're gonna do? In draw, we're just going to randomly, we're going to pick a random number between zero and one, and we'll say, like, one percent of the time, we're going to say trains.push, we're gonna add a new train, so it's gonna be irregular. This is different than the Flappy Bird I made, where I think the pipes, maybe it was irregular. I think the pipes were at regular intervals. Now there's a random chance of adding a new train, and then all the trains that exist, we're gonna say for all of the trains, I'll just say t in trains, I'm gonna say t.move, t.show. All right, let's see what happens. Do we have a train? Maybe I'd better increase it. There we go, oh, look at that. All right, they're moving. They're kinda slow. I'm gonna jump over it, oops, okay. (laughing) Let's make them move a little faster. So, we've got some tweaking we've gotta do. Whoa, this is a, oh, this is a nice way. Oh, look, my unicorn can fly. So, I need to fix the fact, I need to, like, not allow my unicorn to fly, right? It should only be able to jump if I'm a the bottom, so let's fix that. So, to do that, I need to go into Unicorn, and in jump function, I should only be allowed to jump if I'm sitting at the bottom. So, in other words, if y is, oh well, if I'm at the bottom, so as long as y is equal to, is this really gonna work? I don't like to use equal checks, but this is, by definition, sitting at the bottom, so only if I'm sitting at the bottom can I jump, so if y is equal to that spot. Let's see if that works. So, jump, oops, jump. Oh, this.y. Come on, trains. Oh, yep, I can only jump when I'm at the bottom. All right, so that works, so that's fixed. I think I need to be able to jump quite a bit higher. Let's try 35. I should really use a slider or something. There we go, I think this is gonna make the game more possible to win. There's too many trains, too many trains! One thing that's bothering me is the trains are going in front of the unicorn. I know that doesn't really matter so much, it certainly doesn't matter, but I kind of would prefer them to be behind, so I'm gonna move this here. I'm also gonna make the game a little easier to play. I'm gonna reduce the number of trains, so there's gonna be a much lower probability of there being a train. Let's see if I can actually play this game somewhat successfully, even though I'm not doing the collision checking yet. (laughing) No! I think if the trains moved faster, it would actually make it easier, so let's actually double the speed of the trains. All right, this looks like this game is now possible to play. But I need to add collision detection. So, I've done this before in plenty of other coding challenges. There's a pretty simple algorithm to just check if two rectangles are intersecting with each other or not. I can just check their x's and y, basically all the edges, the left, the right, the top, the bottom, against each other, but this is a nice opportunity for me to just explore a library that's out there in the world, and this library is called p5.collide2D, and it actually has a function in it called collideRectRect, and it'll give me a Boolean variable if I give it the x, y, width, height of one rectangle and the x, y, width, height of another rectangle. So let's actually just use this library. This is also a nice excuse for me to show you that GitHub is now integrated with something called jsDelivr. This is an Open Source content delivery network, meaning if a JavaScript file is hosted on GitHub, I don't have to download that file and then add it to my project, I can just link to it. So, I'm gonna go over here to GitHub. There's lots of different ways here that I can reference a file on GitHub. I think the easiest way for what I'm doing right now is just to reference its path, and here's an example path, so I'm gonna go over here to index.html, I'm gonna add another script tag. I'm gonna say script src equals, I'm gonna paste that in, close script, but this is not the path that I want. I want the username, which is BMOREN, and then I want the path to, let's get the minified version of the library, and that would just be this right there in the root directory. So, now I'm just referencing that file. Let's see if that works. This is actually not correct. I'm referencing the cdn URL, the username, but I also need the repo name, so that should be p5.collide2D slash this, so this should now work, okay, and I should be able to use the collide function. So, I'm gonna use this collideRectRect. Let me just call this in draw to see if that works and doesn't give us an error. Great, no error. And so now, I can check, when I'm going through all of the trains, if unicorn hits t, console.log game over, okay. So, console.log game over, and then I'm actually gonna say no loop, so I'm just gonna actually stop the sketch, shut down the sketch completely, which isn't a really thoughtful user experience design choice, but it's what I'm gonna do for right now. And then, I just need to add a function here called hits, and receives a train, and I can say, I can use this function, which I need this.x, this.y, and this.r, this.r, and then I need exactly the same thing, but with that particular train. So, instead of this, I'm checking this rectangle with this train's rectangle, and I'm going to put this in a variable called collide, and I'm gonna say, if, I'm gonna return that. Actually, you know what, I'm just returning this. Return that, so return the true or false results of this collide function from that library, and now let's run the game. We'll wait for our first train. Game over! Let's see if I can play it now. Oh, there were so many trains a while ago. Oh, shoot! Let's make the train a little bit smaller, and actually, let's make the unicorn smaller as well. Hopefully this will help. (laughing) All right, let's draw the, let's debug this a little bit by drawing the box, like, very subtly. So, let's draw a very slight rectangle. This is what we're actually checking. There we go, woohoo! It helps to see the full box. Come on, trains. Spawning a train with a mouse click would be a good idea. Okay, we lost. All right, so there's obviously a lot of gameplay improvements that need to happen here. One is I could be more thoughtful about, and you can see how there's some wasted space here. I should crop the image and the actual rectangle a little bit smaller. I could consider using a circle, I could use a more complex shape. But this is good enough for right now. Let's actually make it, you know, I could also just click the mouse in order to start a train, that might actually help things. But let me comment out this, and what I wanna do, just before I go, before I finish it, and you're gonna make a version of this with a score and all sorts of nicer things, and sounds, but I gotta finish this off, I gotta finish this video. I want to control the train with my voice, so to do that, I'm gonna do this ml5.js, which has a speech commands machine learning model built into this JavaScript library. So, I made a whole separate video about this particular pretrain model and how it works, so I'm just going to add it pretty quickly into this video. You can go watch the other one for more details. But if you're looking for the documentation, if I click on reference and go to soundClassifier, this is what I'm looking at doing. So, all I'm doing, first thing I need to do is, well, actually, one thing I need to do is I need to go to get started, and I need to get a script tag to be able to reference the library. So, I wanna add the ml5 library, so I'm copying this, I'm going here to index.html, and in addition to p5.collide2D, I'm now adding ml5, and I'm going to go here, and I'm gonna, in preload, I'm gonna do let soundClassifier, I'm gonna create a variable. In preload, I'm gonna say soundClassifier equals ml5.soundClassifier, and the model I'm loading is called SpeechCommands18w, because this is a model that's been trained to recognize 18 particular words, the digits zero through nine, up, down, left, right, and a few other ones that are documented on this ml5 webpage. Let's go look that up real quick. So, if I go back to soundClassifier, up, down, left, right, go, stop, yes, no. So, those are the words it's trained to recognize, and I actually also wanna get this probably threshold, so I'm gonna add this in here, because I want it to be really sure I'm saying jump, so I'm gonna make this 95. This means it's gotta be 95% sure the confidence score that's coming from that particular model, and how that model was trained, and there's a paper you can read, and I talk about that more in the other video. Okay, so now that I have that, in setup, I can say soundClassifier.classify. Then I can get a function. I'm just gonna call it gotWord, so it's got a word, gotCommand, let's call it gotCommand. So, this is a callback function that is going to trigger any time it gets a command. It gets an error first, error first callbacks, and then the results. So, just say if there's an error, console, I'm just gonna console.error the error. Otherwise, if results index zero.label. So, results is an array with labels and confidence scores, and the labels are the words, and what I'm looking for is the word up. If that label is up, then unicorn.jump. So, this is a really quick way of me looking for a particular keyword from that library, and I'm also just gonna console.log results[0].label, just to see if I'm getting other words also. And we might as well log the confidence score, just so we can see that. That might be good for debugging as well. So now that I've logged those two things, I'm gonna run this sketch. Up! (laughing) Up! Up! (laughing) Shoot! But you can see, it got up 95%. I'm gonna add the thing where I click the mouse and I can give myself a train. And in fact, let's comment out the random trains. Also, I really should be more thoughtful about how I'm picking when the trains should come. Like, maybe there's a minimum distance between them. If I've just added one, can I have a longer train with other train cars? I don't know what's going on here. There's a lot of narrative flaws in what's going on here, but I'm just gonna add one myself. Up! (laughing) Up! Shoot. All right, everyone is making the suggestion in the chat that I should change it to a circle, so that'll actually kinda be like a round, it'll give me a little wiggle room along the edges and make the intersection happen a little less often, so let's actually go ahead and do that. So, I'm gonna go into, where the only place where I'm doing this collision detection is where? In the unicorn under hits. So, I'm gonna change this to collideCircleCircle. collideCircleCircle, and circle to circle assumes ellipse mode center, so I'm gonna have to think of the circle as the center point of the object, which is not a big deal. So, the way that I'm gonna do that, let's make some separate variables. Let's say x1 = this.x + this.r * 0.5. So, this would be the middle. This is the middle, and then r is the diameter of the circle, so that's fine, and this is y. And then, x2, y2 is the train. Train.x, train.y, train.r, train.r. And so now, I want collideCircleCircle, x1, y1, and then x2, y2. The question is, is r actually the radius or is it the diameter? Does it say? CircleDiameter, circleDiameter, so I'm good. All right, so let's try this, and then this should really be, oh, this is kind of unfortunate. This should now be an ellipse. Oh, you know what I can just do? I can say ellipseMode CORNER. Perfect, so let's draw this hit circles, and under Train, let's do the same thing here and say ellipse, there. So this should now, we should see, here we go. That's what it's gonna do. Okay, here we go! Oh, I have to click. Oh, whoa, what happened? (dinging) All right, I passed r in twice, which is very unnecessary. you just give it the diameter, not the radius, even though I'm calling in r once. And let's see what happens, okay, here we go. Jump! Wait, why is my browser really freaking out? Let's comment out the debugging. We're just gonna go for it now, we're gonna play this game. Let me close this tab. Quit Chrome. We're about to play this game! Oh, up, it's up, I'm saying jump. (laughing) Oh, up, there we go, up! Up! Up! All right, you ready everyone? (upbeat piano music) Up! (laughing) Up! Oh, maybe, I guess I can't use the music. Up! Up! Up! (laughing) Oh! All right, everyone, thus ends this coding challenge. There are so many things that need to be added to this. Number one, the narrative just makes no sense. Why is there this unicorn standing still without any animation? The trains are coming at it. The background should be sort of in paralax moving. So probably it should be jumping over, I should've just used cacti. That's the plural of cactus, right? There's no score, there's no birds flying. You could add a flying asterisk. I'm gonna, when I upload this, I'm gonna include, when this video publishes, with the code, I will include a lot of the Coding Train characters, which are designed by Jason Heglund, illustrated and designed by Jason Heglund, so I'm gonna include a whole bunch of those if people wanna make a version of this game that we can all play online with speech commands. Let me try this. I'm gonna just say goodbye by trying this one more, and yes, Alka is pointing out that speech detection API in the browser might be lower latency, but let's try this one more time. Up! Up! Up! Up! Up! Up! Up! Oh, okay, goodbye everyone! Thank you very much and see you later on a future coding challenge. (dinging) (upbeat techno music) (dinging)
