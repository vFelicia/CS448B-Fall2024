With timestamps:

00:03 - whoo-hoo
00:05 - hello I'm making a video coding
00:07 - challenge today to celebrate some large
00:09 - amount of subscribers which is kind of
00:12 - insane and then right after this I'm
00:13 - going to go to the barber shop so please
00:15 - I beware I've really let this go here
00:18 - I'm gonna deal with it all right what am
00:20 - I gonna do today I'm going to celebrate
00:22 - the subscribers the viewers of the
00:25 - coding train with a visualization and
00:27 - I'm going to use a library that I've
00:29 - been meaning to use for quite a while
00:31 - called mapa is it was a google Summer of
00:34 - Code project last summer 2017 with the
00:38 - processing foundation created by
00:39 - Cristobal Valenzuela so there if you go
00:43 - to the mapa j/s org website there's a
00:47 - ton of tutorials introduction to web
00:49 - maps a history of different projections
00:52 - so there's so much interesting good
00:54 - stuff here I also if you scroll down
00:55 - here I'd really recommend taking a look
00:57 - at Mimi Onew OHA's everything is spatial
00:59 - data and digital mapping work so I love
01:03 - to get into all this but I'm just gonna
01:05 - try to do something really basic I have
01:07 - on my computer if I could find it why
01:12 - didn't I get organized before I started
01:14 - this YouTube here we go I have some CSV
01:17 - files these CSV files I downloaded
01:20 - through the creator studio so I logged
01:23 - in with my account in the creative
01:24 - studio I went to the analytics and
01:25 - there's an export to CSV so presumably
01:28 - there is some way for me to get this
01:29 - data with the YouTube API and I would
01:32 - encourage you hopefully I'm hoping
01:33 - people will make stuff either with their
01:35 - own YouTube channels or I think it's
01:37 - okay for me to publish this data there's
01:39 - no user information in it so I will
01:41 - check but I'll probably I'll I will also
01:43 - publish this data as well people want to
01:45 - revisit and interesting ways for me or
01:47 - not for me for you but anyway whatever
01:50 - the point is this is not going very well
01:54 - why have you subscribed to this channel
02:00 - tutorial things for you to watch out
02:02 - there what I was what I was going to
02:04 - show you is I have all of subscribers by
02:07 - country and I have also all of I
02:13 - have watch time alibi country this is
02:16 - the watch time in minutes apparently
02:18 - people have watched a candy I can't even
02:22 - read that that number it's 41 million
02:25 - 100 in the US some 41 million minutes
02:28 - that's really it's really hurt I mean
02:32 - wasn't just one person I hope it's gonna
02:36 - this is a mapping visualization tutorial
02:38 - isn't it okay let's go okay so how what
02:40 - am I gonna do here well first so I'm
02:42 - going to come back to mapa the github
02:46 - for mapa is here by the way that all
02:47 - these URLs will be in the video's
02:48 - description if you're still watching or
02:51 - if you just left and I'm reading the
02:52 - description however watching some other
02:54 - machine learning tutorial but I'm gonna
03:00 - I'm gonna use this I'm basically gonna
03:01 - follow this tutorial by Chris called
03:04 - simple map a map ax is an interface to
03:07 - other mapping API is like Google Maps
03:10 - map box leaflet and maybe I'm missing
03:16 - MapQuest
03:16 - wow that quest still exists that's
03:18 - amazing I'm staying over here look
03:19 - MapQuest so I'm gonna use leaflet just
03:24 - because from you don't need an API key
03:27 - for leaflet so it makes it a little
03:28 - easier for me to just roll on in and
03:30 - make this project but I encourage you to
03:32 - try this with Google Maps or map boxed
03:34 - yourself ok bye well let's get started
03:36 - here so the first thing I don't want to
03:38 - do actually is nothing to do with
03:39 - mapping I want to say function preload
03:43 - because I want to load in all the data
03:45 - so I want to say to celebrate I'm going
03:50 - to use Const Const is a way of declaring
03:54 - a variable that you're not allowed to
03:57 - that you're saying I'm never going to
03:58 - reassign this variable to a new value
04:01 - there's some nuance to that but that's
04:03 - the basic idea so I'm gonna pretty
04:04 - really a means to protect myself here so
04:07 - I'm gonna say Const subscriber
04:09 - subscriber data then in preload I'm
04:13 - gonna say I can't spell subscriber
04:16 - subscriber data equals load table whew
04:22 - now load table is a function inside of
04:25 - p5 as part of
04:27 - the p5.js library that is specially
04:29 - suited for loading csv data tabular data
04:32 - some other videos where i use that and
04:34 - describe that in more detail so I want
04:37 - to just let's start with subscribers
04:38 - underscore geo subscribers underscore
04:42 - geo dot CSV then I just want to in set
04:46 - up and say console.log subscriber data
04:50 - so let's first make sure I can actually
04:52 - load the CSV in the first place and I'm
04:55 - gonna go over here hit refresh this
04:59 - thing initializer in constellation oh
05:02 - okay I can't use Const here this is such
05:06 - a failure you already so I can't use
05:08 - Const why because this is being
05:11 - reassigning it I didn't assign it up
05:13 - there that somebody's let something
05:17 - other day I'll find it perfect because
05:18 - I'm gonna use kaan somewhere else in
05:20 - this you'll see it's constants vary hard
05:22 - to say alright so now we're loading hmm
05:25 - it's still loading it really is not
05:27 - going very well I don't think it's
05:30 - taking all this time to load I think
05:32 - that I have a mistake load table
05:37 - subscribers giotto let me just see here
05:40 - what version I'm in the recent version
05:42 - of p5 there there was at some point an
05:45 - issue with using load table in preload I
05:47 - thought that had been ironed out by now
05:50 - let me make a let me just make let's do
05:53 - a little test here well this by the way
05:58 - this videos gonna have lots of extra
06:00 - stuff in it I'm just letting this go no
06:01 - editing no editing I'm gonna make a test
06:06 - dot CSV file so you know it's like an
06:08 - hour or 500 minutes that would be
06:10 - appropriate
06:11 - alright so abc123
06:14 - so I'm just gonna make a test this how I
06:18 - like to debug things I'm gonna make a
06:19 - test CSV file just try loading that oh I
06:24 - saw something there for a second look
06:26 - it's like they're pre load setup hmm
06:30 - hold on what is going on what craziness
06:36 - see here subscriber data it's there huh
06:41 - alright I had to edit this there there
06:45 - was no way around editing it there I did
06:47 - however I think I have a path to move
06:50 - forward and I've learned something new
06:51 - inside the developer tools I usually
06:53 - just look at this console thing there is
06:55 - this tab called Network and what we can
06:57 - see here look at this the test dot CSV
07:00 - file is just pending pending pending
07:03 - it's never loading oh it finally loaded
07:07 - it took uh I can't I want to be able to
07:13 - see it took 26 seconds 26 seconds to
07:16 - load that file that file test dot CSV is
07:20 - exactly 12 bytes meaning that's like two
07:24 - seconds per bytes this is very byte very
07:26 - unreasonable so I don't know what's
07:27 - going on but I I don't I don't want to
07:30 - blame anybody nobody's fault things just
07:33 - work if they work sometimes but I'm
07:35 - getting some weird behavior with this
07:36 - Python server that I'm using and
07:38 - actually if I change and use I have a
07:41 - node server HTTP - server also available
07:46 - on my computer so I'm going to run that
07:47 - be a terminal HTTP - server and then I'm
07:50 - going to go back over here oh wait no I
07:53 - have to go to a different yes different
07:55 - port and look at this three milliseconds
07:58 - test CSV so now we can go back we're
08:00 - getting somewhere we're getting
08:02 - somewhere
08:02 - I can go back to subscribers underscore
08:06 - geo dot CSV there we go
08:10 - okay now we've got that file I'm gonna
08:14 - go back to the console I'm gonna look at
08:15 - subscriber data and I can see there we
08:17 - go I've got an array with a 237 rows
08:22 - that means there's 237
08:26 - oh there's fifty three columns there's
08:27 - lots of extra data in there
08:29 - other and there's 237 rows now one thing
08:32 - is all the cop none of the columns have
08:33 - a name so one of the things I want to do
08:35 - is p5 if I give it this nice little
08:38 - second argument and say header I think
08:41 - that says the first row in the CSV file
08:45 - is the header and we can see that if I
08:47 - click on here you can see these are all
08:48 - the headers that are
08:49 - actually there in that first row so now
08:52 - let me go back and refresh I'm gonna
08:54 - look at the subscriber data again go
08:55 - look at here we can see ah there it is
08:57 - so country name country ID and
08:59 - subscribers and then there's other all
09:01 - sorts of other columns transactions and
09:05 - ad revenue and all sorts of stuff so I'm
09:07 - probably going to clean up this data
09:09 - when I publish this just to have only
09:12 - the first three columns country name
09:15 - country ID and subscribers that's all
09:18 - that I'm gonna use for this example so
09:20 - now what's next I need a way of
09:23 - iterating over every single one of those
09:25 - so let's just look at how I might do
09:27 - that I don't know how but I'll figure it
09:29 - out for let I equals 0 I is less than
09:33 - subscriber data dot I don't know total
09:37 - columns let's look at the API p5.js org
09:40 - let's look at the reference I'm gonna
09:43 - look for p5 table and I guess if I go
09:47 - here to p5 table we're gonna see add row
09:50 - remove row get rogue find row finebros
09:53 - match row i'm looking for total huh Oh
10:02 - columns rows looking for Rose it's just
10:06 - in a field subscriber data dot rows I
10:09 - plus plus then I'm going to say the row
10:13 - is subscriber data get row I and let me
10:17 - just look at the rows go back here let's
10:27 - look at
10:32 - I haven't done this in a while
10:36 - line 10 Oh Rose is an array of all the
10:39 - Rose that's even more convenient so let
10:43 - Rho it's not a number I thought it was a
10:47 - total of subscriber data dot Rho I can
10:49 - use a four of loop and now I can just
10:56 - look at each row one at a time
10:58 - there we go that's each row one at a
11:00 - time then I can say console.log row get
11:04 - column
11:06 - what were the columns again country
11:08 - let's look country oh it's sort of like
11:10 - atom just knows it's what a country ID
11:13 - and let's do this mm get column is not
11:18 - oh maybe it's just get yes there we go
11:23 - yet it's just get and I get the country
11:25 - ID now I want to get a console log row
11:29 - get what was it called subscribers okay
11:38 - awesome
11:41 - there we go so I now have a country ID
11:45 - followed by subscribers country ID
11:47 - followed by subscribers okay
11:49 - we're getting somewhere should probably
11:53 - find the minimum and the maximum and
11:55 - normalized things but we'll worry about
11:56 - that later
11:57 - okay now now let's go back to the
11:58 - mapping tutorial what's been like two
12:01 - hours since I started this so I'm gonna
12:03 - go back to this simple map example and
12:05 - first of all I need to include a
12:08 - reference to this map map a library in
12:11 - my HTML file so I'm gonna just copy
12:14 - paste this here and I'm gonna go to
12:16 - index dot HTML and one of these days
12:19 - I'll learn how all this fancy new module
12:22 - stuff works but there's no way I like to
12:24 - do it right now I'm gonna reference that
12:26 - library let's go back to the tutorial
12:28 - whoo welcome to reading through a
12:30 - tutorial and copying the code over to
12:31 - your code code but thank you to this
12:34 - excellent documentation for the map
12:36 - library so I want to create a look at
12:38 - this there we go
12:40 - Const let's create a new map instance so
12:45 - I want to make a new
12:46 - pulling from the leaflet API just to be
12:50 - clear leaflet is this a jaw open source
12:56 - JavaScript library for mobile friendly
12:57 - interactive maps so again you can use
13:00 - leaflet directly by just going right
13:04 - there looking at how the code works napa
13:06 - provides a layer on top of that also
13:09 - because it you can pick other things
13:11 - besides leaflet as well as it integrates
13:13 - nicely with p5 and probably other
13:15 - JavaScript libraries alright so now
13:17 - let's just refresh let's make sure
13:19 - things are still working things are said
13:22 - well there's an error at the top there
13:26 - because it's mime type is X not
13:30 - executable what did I do wrong here hmm
13:33 - we have a little bit of an issue
13:35 - okay I'm back it turns out that there's
13:38 - just a little bug with this CDN link and
13:40 - so I'm going to use a different CDN link
13:43 - which is this one and it's working check
13:46 - the map web page for whatever the
13:48 - currently working version of this is by
13:50 - the time this video gets published
13:52 - hopefully it'll it'll probably be fixed
13:53 - ok mapa is now loaded excellent ok so
13:57 - now we can go back and we can go to this
13:59 - tutorial once again I was on this simple
14:03 - map tutorial and we can see here what's
14:05 - the next step I want to create now
14:08 - there's different kinds of Maps I can
14:10 - create there's what I'm and the world is
14:13 - broader than just this but I'm gonna
14:14 - talk about 2 right now there's a static
14:16 - map and a tile map a static map is a map
14:19 - that's just give me the map it's the
14:22 - image of the map I'm gonna draw it I'm
14:23 - never gonna change a tile map is one
14:25 - that I want to move around zoom in and
14:27 - out of and the reason why it's called a
14:29 - tile map is because the way that the
14:31 - mapping API is generally load it is
14:32 - they'll over there's a bunch of
14:33 - different tiles because you don't wanna
14:34 - get one big image all at once you get a
14:36 - bunch of different images and they get
14:37 - tiled so I want to create a tile map and
14:41 - this gives that the arguments here is
14:44 - like well what do I want where do I want
14:46 - the map to be centered around and what
14:49 - zoom level do I want to be so let's try
14:51 - map my map equals map a tile tile map so
14:56 - I want to say I'm going to go back to
14:58 - here
14:59 - and I'm gonna say I'm gonna say let
15:03 - train map and I'm gonna say a train map
15:08 - equals mapa tile map and let's just give
15:13 - it a latitude longitude of zero zero and
15:16 - a zoom level of four that was what's in
15:17 - the tutorial and let's see if we see
15:20 - that at all
15:21 - I'm gonna go here and so now one thing
15:27 - is I've let me let me mixing let me get
15:31 - rid of the canvas all right so I
15:33 - probably missing a step here I know that
15:35 - I have to overlay the canvas but let's
15:38 - see I don't see the map yet do I need to
15:40 - overlay the canvas or yes I guess if I
15:44 - don't overlay the canvas the map doesn't
15:47 - show up perhaps creator of map Allah is
15:52 - in the chat right here so I might here
15:54 - in a second what I'm saying that's wrong
15:56 - so I'm going to so I need a reference to
16:02 - the canvas I'm gonna say canvas and I'm
16:04 - gonna say canvas equals create canvas
16:08 - and then I want to say to which do I say
16:12 - which the the map a map I want to say
16:14 - the training map
16:15 - I want the canvas to sit on top of it
16:19 - overlay yeah I do so confirm breaking
16:23 - news
16:23 - I do have to overlay I'm not gonna see
16:27 - the map unless I overlay the canvas on
16:29 - top of it okay so these are the steps
16:31 - here I want a canvas that I can draw on
16:32 - I want a tile map and then I want my
16:35 - canvas to sit on top of it so now if we
16:38 - go here whoops
16:42 - train map overlay is not a function okay
16:45 - what I'm doing a terrible job here let
16:48 - me go to the tutorial my map dot overlay
16:51 - canvas did I take overlay with a capital
16:53 - L yes I did overlay is one word people
16:57 - lowercase L okay here we go
17:02 - unload setup sketch mmm what did I get
17:06 - wrong now
17:08 - so much for my no editing Oh is there
17:10 - was another edit there unfortunately
17:12 - whatever reason whatever I'm doing is
17:14 - throwing giving me an error
17:16 - I discovered if I revert back to one
17:18 - version earlier of the map a library
17:21 - then the error goes away so I can
17:23 - refresh oops I have to hit save and then
17:26 - I can refresh aha now okay so first of
17:29 - all if you're watching this video
17:31 - hopefully the source code is hopefully
17:33 - going to by the time you're watching
17:34 - this be using the most recent version of
17:35 - map but maybe I'll have to figure that
17:36 - out but for now I'm going to keep going
17:38 - now interestingly enough it says you are
17:40 - not using any tiles for your map try
17:43 - with so one of the things is I have to
17:46 - specify a particular set of tiles that I
17:49 - want to load and I would have just read
17:52 - further down in the tutorial it would
17:54 - show me that actually one way to do that
17:56 - is to put all of those things like I was
18:00 - saying I want the center to be zero zero
18:01 - and the zoom level to be four now I need
18:03 - to also give it a style all those can go
18:05 - into a JavaScript object so I'm just
18:07 - gonna copy pasted this from here this is
18:11 - a YouTube video where I am copy pasting
18:13 - code from a tutorial and like making
18:15 - lots of mistakes still somehow anyway
18:17 - and then I'm going to put this here and
18:20 - then I'm going to put instead of putting
18:23 - the arguments directly in the function
18:25 - I'm just gonna write the variable named
18:26 - options we are now going to refresh
18:29 - again and now I look at this there is my
18:34 - map so one thing I really want to do is
18:36 - I want to give myself more space to work
18:38 - with so let's try like 800 by 600 and I
18:43 - think I want to zoom out by default a
18:45 - lot more so what I know I think a lower
18:48 - number would be zooming out yeah
18:51 - that's maybe too much 1.5 all right
18:54 - that'll do to start okay so this is what
18:56 - how I want it to load initially and
18:58 - again maybe zero zero isn't the best
19:01 - middle point and there's all sorts of
19:02 - other things I could do but know we've
19:04 - got the map there now I just want to do
19:07 - something I just want to say ellipse
19:12 - 100-150 let's just see what happens if I
19:14 - draw and I'm gonna do a nice purplish
19:19 - color which is my favorite color do
19:22 - look at this there's that ellipse now
19:24 - that ellipse is staying where it is so
19:26 - they're at a minimum what I have right
19:28 - now is the ability to draw over the map
19:32 - and I can do all of the map interactions
19:35 - and my p5 canvases right there now I
19:37 - have to be careful if I were to put this
19:39 - background here I don't see that map
19:42 - anymore
19:42 - and what I really should be doing is
19:44 - using the clear function the clear
19:46 - function is like putting a background
19:48 - that's fully transparent so this now you
19:50 - can see I don't know if you could notice
19:51 - this before without the clear function
19:53 - there was some funny anti-aliasing going
19:55 - on because I was drawing the circle
19:56 - actually on top of itself multiple times
19:57 - okay but the point is what I want to do
20:00 - is let's say I have a circle that's on
20:01 - the map over here if i zoom in I want
20:04 - that circle to stay where it is and grow
20:07 - with the map okay so how do we do that
20:10 - let's go back to the tutorial and I'm
20:13 - not gonna worry about lat/long but oh
20:17 - yeah no no I do want to worry about that
20:18 - so this is the key here lap map lat/long
20:23 - to pixel so the idea here is that I have
20:26 - a latitude and longitude and I want to
20:29 - find the pixel location of that no
20:31 - matter where the map is
20:33 - so let's let's just take this no matter
20:37 - what the zoom is let's take this and
20:40 - copy it into our code and I should now
20:48 - see it refresh
20:51 - oops I got an error again lat oh my map
20:55 - I called a train map so we can see there
21:03 - is now a circle here hopefully on top of
21:06 - the country of Nigeria looks right to me
21:09 - and I can zoom in and we can see that
21:13 - circle is continuing to move as I move
21:16 - the map around now here's the thing
21:21 - so I happen to find that from the
21:23 - example thankfully I just got a message
21:25 - in the chat for the next thing was about
21:27 - to look for which is a data set that has
21:30 - the lat longitude value for every single
21:33 - country
21:34 - so I'm just gonna I think I could
21:35 - probably google for it canonical
21:38 - countries CSV lat/long something like
21:41 - that would probably yes this is what I'm
21:43 - looking for I'm looking for the
21:44 - countries dot CSV data set and this now
21:48 - has a country every country with a
21:51 - latitude and longitude associated with
21:52 - it so how do i download this okay if
21:56 - somebody can figure out for me you can
21:59 - figure out how you download this file
22:01 - sure I could copy paste it I can't buy
22:03 - anywhere on this page of how to download
22:06 - this file and Nora in the chat seems to
22:08 - be telling me so I'm moving on
22:09 - I got a nice suggestion there is this
22:11 - github gist and I can just click over
22:13 - here to raw and this is now every single
22:15 - country code with the lat/long I'm going
22:19 - to assume that this is correct I'm going
22:21 - to copy paste this into a new file I'm
22:24 - gonna call this country's dot CSV and
22:30 - I'm gonna paste it in here so now I have
22:33 - oh not CSV it's JSON excuse me
22:37 - countries JSON and so good so now I have
22:43 - all the countries and they're lat/long
22:45 - by a and JSON so now I need to go back
22:46 - to my code and I am going to say let me
22:52 - have another variable called countries
22:53 - and I'm gonna say countries equals load
22:58 - JSON and countries dot JSON so now I
23:03 - want to just make sure that that came in
23:05 - okay console dot log countries well I'm
23:13 - gonna be going away for a couple weeks
23:15 - after I record this video let me get
23:16 - back everything's gonna make sense and
23:17 - work again in my tutorials I'm not going
23:20 - to make all these mistakes and never get
23:22 - anything that okay so there we go so now
23:24 - I can see excellent so I have one-half
23:27 - beautiful the object I can actually look
23:29 - up by the country code great I can look
23:34 - up by the country code which is exactly
23:36 - what I want so now let us let me take
23:40 - this loop I'm gonna go over here kind of
23:46 - it
23:47 - I think that in a moment I am going to
23:49 - now get the country ID now I think
23:52 - something a little bit funny is going on
23:54 - here where if I look here the country
23:57 - IDs are in capital letters and in my
24:00 - countries JSON file they're a lowercase
24:03 - letter so I'm gonna need to be
24:05 - conscientious about that so I want to
24:07 - say let country equal Rho get country ID
24:13 - and I'm gonna say I'm think I could just
24:16 - say to lower case is that a JavaScript
24:20 - function in Java there's definitely a
24:23 - string function that sends thing to
24:24 - lowercase so I think that's right then I
24:27 - can get the lat/long is is what I want
24:34 - to look at the countries by country and
24:41 - so now that's going to give me that
24:43 - array with lat/long and then the
24:46 - latitude is the lat/long index 0 and the
24:54 - longitude is the lat/long index 1 and
24:57 - now I'm gonna say I want to say the
25:03 - pixels pixel coordinate is train map and
25:09 - now I not hard-coding it I'm getting it
25:12 - from that so now I say getting it from
25:16 - that C JSON file lat/long and then now
25:20 - well let's draw an ellipse at and I'm
25:25 - just going to call this pics at pics X
25:28 - pix dot Y 2020 so now I should see a
25:34 - circle at every single country where
25:37 - there is at least one person who
25:39 - subscribes to the channel and here we go
25:42 - what did I get wrong here cannot read
25:45 - you know interestingly enough this is
25:48 - live this is like this very generic
25:51 - error that's coming up no matter what if
25:54 - I do something wrong sketches yes line
25:56 - 41 what have I done wrong
25:57 - let me look
26:01 - let's look at these first console dot
26:04 - log country let's take a look to make
26:07 - sure my countries are actually correct
26:08 - those look right
26:10 - those look like reasonable country codes
26:12 - let's say no loop by the way because
26:15 - right now I just want to do it once okay
26:20 - so those look like the country codes now
26:26 - let's see so this is countries countries
26:34 - dot ad is that and so I should be saying
26:40 - a console.log lat/long let's look at
26:44 - that okay oh there's some that are
26:48 - undefined so first whatever reason I
26:51 - have some countries in my dataset that I
26:54 - don't have a lat long for so I that's
26:56 - why I got that error message so I just
26:59 - need to be careful about that and I need
27:02 - to say only if lat/long exists like
27:06 - there's some that are undefined then I
27:09 - should be able to pull the lat longitude
27:11 - out and draw a circle and let me get rid
27:16 - of no loop now let me say fill 255 0 200
27:23 - let me put my semicolon there oh yes so
27:30 - look at this look at all of you
27:32 - beautiful people all over the world who
27:34 - are subscribed to this channel from all
27:36 - these different countries this is
27:38 - amazing oh and I got this horrible thing
27:40 - going on where I'm console logging got
27:43 - to get rid of that you do not want a
27:45 - console log from within a loop within a
27:47 - loop a zillion things that'll really
27:49 - mess stuff up let's go find Australia
27:53 - Australia look at this let's can we find
27:58 - a country with nobody I'm not sure the
28:01 - country that I need to so we've really
28:03 - got the center of everything this is
28:05 - great ok so now we're getting somewhere
28:09 - I can see everything there and
28:15 - now what I want to do is actually size
28:17 - the circles according to the total
28:20 - number of subscribers okay hmm all right
28:25 - here's the thing I want to talk you
28:26 - through something that's a really
28:27 - important little crucial detail here and
28:29 - I want to dive in for you but this may
28:32 - be what I could do is just turn the
28:33 - camera I'm working on this tensorflow J
28:36 - s color classifier and I didn't want to
28:39 - race my notes for it so now I think I
28:41 - have some extra space over here so sorry
28:43 - for being completely like a crazy person
28:44 - not like whatever I'm gonna diagram this
28:47 - for you here so here's the thing I am
28:49 - drawing circles in p5 with the ellipse
28:52 - function can you see that
28:54 - I think you can the ellipse function so
28:56 - let's say this is a circle with a diet
28:59 - with a diameter of 10 and this is a
29:03 - circle with a diameter of 5 okay
29:07 - circle with a diameter of 10 circle the
29:09 - diameter 5 let's say this is a country
29:10 - with 10 subscribers and this is the
29:12 - country with 5 subscribers have I
29:14 - visualized this accurately no the answer
29:18 - is no why think about this for a second
29:19 - if I were to do this this is a bar chart
29:23 - 5 and this is 10 you know this is
29:26 - accurate this is twice the size of this
29:28 - is this twice the size of this well the
29:30 - radius here is 5 oh I make these like 8
29:33 - and for the point let me make these 8 in
29:36 - for just just please please please
29:39 - please allow me to make them 8 and 4 so
29:42 - the radius is 4 and the radius here is 2
29:45 - right so what is the area of this pi
29:49 - r-squared 16 pi the area of this PI R
29:53 - squared 4 PI this is actually four times
29:56 - the size as this so I need to be
29:58 - conscientious about this what I actually
30:00 - want to do is take the total number of
30:01 - subscribers and apply the square root to
30:04 - it so that when I when when it's being
30:07 - visualized into a circle it will
30:10 - actually be representative the area of
30:13 - that circle will represent the total
30:15 - number of subscribers okay well you go
30:18 - we can come back over here now all right
30:22 - so here we go this is where I am let me
30:23 - see what was the zoom level when I open
30:25 - it up great so now what I want to do is
30:27 - I should be able to
30:28 - right here say let subscriber like let's
30:35 - say like sub count equal Roget and I
30:39 - already forgot what's in the CSV file if
30:42 - I quickly look at it here it is just the
30:45 - word subscribers subscribers and I'm
30:51 - going to say let diameter equal the
30:56 - square root of the sub count and I
30:59 - definitely should do some sort of
31:01 - napping but I'm not going to worry about
31:02 - that right now
31:02 - and then I'm just going to then put
31:05 - diameter here and I'm gonna give this
31:08 - some alpha because I have a feeling I'm
31:09 - gonna have some really big circles and
31:11 - now I'm going to refresh there we go
31:14 - look at this we have now visualize the
31:17 - subscribers and we can see here this
31:20 - makes sense like there is a lot of
31:22 - subscribers in India and we can look at
31:27 - we can look at Africa we can see that
31:29 - South Africa and Kenya and Nigeria if we
31:33 - look up here in Europe we can kind of
31:36 - see here that Deutschland Germany and
31:42 - England over here we can see the
31:44 - different countries France so this is
31:45 - actually and this should be accurate I
31:47 - could write the number there's so much I
31:48 - could do here visualization wise this
31:50 - really isn't like a tutorial in the end
31:54 - about you know the visualization I'm
31:56 - really just try to get the mechanics of
31:58 - it to work and one thing I might want to
32:01 - do I mean that the circles are just
32:02 - sweet why are they oh they should be
32:06 - sized according to the zoom level Oh
32:08 - weird umm I just realized something
32:12 - the circles are not resizing according
32:17 - to according to the zoom level so how do
32:22 - I do that there's got to be a way in the
32:25 - map a library let's look at let's look
32:30 - at the API so if I go under leaflet we
32:35 - can see look this is actually changing
32:37 - right we can see this example the
32:39 - circles are changing and let's see how
32:41 - that's done
32:43 - math dot zoom so map dot zoom so this is
32:48 - a way that I can use the zoom level of
32:50 - the map to change the size of the
32:52 - circles so one way I could do that is by
32:55 - saying something like diameter divided
32:57 - divided by train map dot zoom is it just
33:02 - dot zoom oh it's a function dot zoom so
33:07 - let's see what happens there where do I
33:11 - go now
33:12 - oops where was I come back did I lose it
33:16 - no I'm over here okay so now oh no I
33:24 - think I need to multiply it by zoom all
33:30 - right if you think about it the zoom
33:32 - level right I come back to my crazy
33:35 - little place over here if you can bear
33:38 - with me for a second if I have a circle
33:41 - like this a higher zoom number is me
33:45 - zooming in so I don't want to divide by
33:50 - the zoom level I want to multiply by the
33:52 - zoom level because the size of the
33:55 - circle is going to be what it is at zoom
33:57 - level one if i zoom in by two
33:59 - that circle should grow twice the size
34:02 - so I don't know why I didn't really need
34:03 - to walk over there but mentally I needed
34:05 - to take a break okay
34:10 - mentally I just needed to take a break
34:12 - here so I uh so what I need to do is say
34:13 - times zoom and then now look at this
34:18 - it's everything's way too big so now I
34:20 - need to figure out an effective way to
34:22 - to lower everything so one thing I could
34:24 - do is I could find that I probably
34:26 - should just like pre-process the data in
34:28 - setup right there's no reason for me to
34:30 - like do all this parsing over and over
34:32 - again
34:33 - so let me pre-process the data in setup
34:36 - and I'm going to create my own array so
34:42 - I'm gonna say I'm gonna say data is an
34:45 - array then I'm going to go to setup I'm
34:50 - gonna paste in that loop I'm gonna get
34:53 - the country
34:55 - and then here I'm gonna get the pixel Oh
34:58 - I don't want the pixel location I just
35:00 - want the lat/long and the sub count so
35:03 - then I'm going to say what am I gonna
35:08 - say here I'm gonna say data dot push I'm
35:12 - just gonna make an object now guess what
35:17 - what's that thing called in the new
35:20 - what's that thing called a new
35:22 - JavaScript where you I want to make an
35:24 - object and what I want to do is I want
35:26 - to say lat lat long long long sub count
35:34 - sub count this is how I this is how I
35:37 - always have written my code I want to
35:39 - create an object with these properties
35:41 - and the properties have the same name of
35:42 - the variables you don't have to do that
35:44 - anymore JavaScript new fancy JavaScript
35:46 - yes something or other
35:47 - allows me to just do this lat/long
35:52 - sub-account and by definition it's going
35:57 - to assume that if I generate an object
35:58 - this way that I want the property name
36:01 - to be the same name I want the property
36:05 - name to be the same name as as the
36:08 - actual variable name itself apparently
36:11 - it is known as enhanced object literals
36:14 - so this is an I want to create an object
36:16 - literal and I want to create it in an
36:18 - enhanced fashion so now that I have this
36:21 - now that I've done this now I'm gonna do
36:22 - a little thing here I'm gonna say max
36:25 - subs equals zero and min subs equals a
36:34 - hundred infinity now I know I know I did
36:40 - I am using enhanced object literals and
36:42 - I know there's a higher-order function
36:44 - sort of fancy way that I could just do
36:46 - this instantly but I'm just going to
36:48 - since I already have this loop anyway
36:50 - I'm just gonna say if sub count is
36:53 - greater than what was it max subs then
36:57 - max subs equals sub count I just want to
37:00 - find what was the largest number of
37:01 - subscribers and I also want to find out
37:05 - what was the minimum number of
37:08 - subscribers
37:10 - so now that I have the minimum and the
37:13 - maximum if I come down here and I can
37:17 - now I can just say for country let
37:21 - country of data and oh oh I want the
37:26 - country ID I need that Oh No look at
37:30 - that I don't I guess I don't need the
37:31 - country idea anymore
37:33 - okay I mean I want to save the country
37:35 - ID so now I just want to say I don't
37:38 - need this if any more I don't need this
37:40 - lat/long all the parsing has to be done
37:42 - I just want to say now I just want to
37:45 - say country dot lat
37:47 - country that long and then I don't need
37:52 - to the sub count is right country dot
37:57 - sub count and I want to say that and
38:01 - this should be a constant so should be
38:04 - I'm gonna say the square root of mmm boy
38:10 - I'm having a lot of extra square roots
38:11 - here let me let me actually add let me
38:15 - do this let square let me do square
38:22 - squirt square root I'm gonna I'm gonna
38:26 - just put the diameter in here square I'm
38:28 - gonna calculate it up here just once and
38:30 - I'm gonna add this in here and then you
38:38 - know what I'm gonna do let's just do all
38:40 - this up here I'm gonna just do this
38:43 - parsing up here too then I'm gonna go
38:45 - through it again one more time yeah yeah
38:47 - I know I could use a higher order
38:48 - function expect many pull requests and
38:51 - comments about that and I'm gonna say
38:53 - and now I'm gonna say let country of
38:58 - data and I'm gonna say country dot
39:02 - diameter equals map the country's
39:05 - diameter between the switch goes between
39:10 - the square root right right right right
39:13 - right I don't want to put the diameter
39:15 - in here I'm going to add I'm going to
39:17 - add a new probe there's no reason I'm
39:19 - going to add this property here and
39:21 - map I'm going to say min diameter is the
39:28 - square root of the men's subscribers and
39:33 - the max let's just say mindy and the max
39:37 - d is the square root of the maximum
39:40 - number of subscribers and now i'm going
39:42 - to map the countries the square root of
39:48 - the country's subscribers which has a
39:53 - range between mindy and max D and I'm
39:57 - going to map that between 10 and 100 and
40:00 - that's the country's diameter so I
40:02 - wanted I want to process I want to just
40:04 - sort of like normalize the data within
40:06 - some range add the diameter property and
40:09 - then right down here I don't need to do
40:11 - any calculations I'm just gonna say pics
40:15 - X pics y country dot diameter and you
40:21 - know with the ellipse function by the
40:23 - way you don't need to do the width and
40:24 - height if they're equal and then I'm
40:26 - gonna say train map dot zoom okay I
40:30 - think we might have gotten somewhere
40:31 - here I don't need this anymore and now
40:34 - here we go let's refresh Oh max slope is
40:38 - not defined
40:39 - okay where do I call max subs max subs
40:44 - hmm we're all all of you where are all
40:48 - of you subscribers
40:49 - Oh did everybody unsubscribe all of a
40:51 - sudden because of how long it's taking
40:53 - me to do this and what a mess this video
40:56 - is okay oh not yep nope
40:59 - okay let's do console.log data let's
41:05 - take a look at this let's see what's in
41:08 - that object
41:09 - okay the object is an array with
41:12 - lat/long sub count ooh diameter equals
41:14 - not a number so I messed something up
41:17 - there so let's see oh this has to be
41:24 - outside of here why is that in there oh
41:27 - so this is something I want to do right
41:29 - before I do this mapping I don't know
41:31 - why I had that in there well you've
41:33 - still should have worked
41:35 - let's console.log min subs and max subs
41:42 - see does that getting a real zero and 98
41:47 - that doesn't seem right
41:49 - more than I have more so max subs is
41:56 - zero min subs is infinity if sub count
41:59 - is greater than max subs hmm that seems
42:03 - weird oh yeah my sizes are probably way
42:12 - too small but hold on those seem like
42:16 - strange numbers to me zero and 98 I have
42:21 - more than 9 subscribers
42:22 - oh they must their strings they're not
42:27 - numbers look at this if they're strings
42:31 - in alphabetical order 9 8 is greater
42:34 - than 9 79 I was not being careful the
42:38 - value that I'm getting out of the table
42:40 - is not a number I need to convert it to
42:43 - a number it's by default and I think
42:47 - probably I might have been he'll say
42:48 - something like get number in with the p5
42:51 - API or I'm not sure let's see get number
42:54 - is that part of p5 no but I could say
42:58 - get and then convert it write a CSV
43:01 - everything is by default text and these
43:05 - should probably I don't know why these
43:07 - sort of work somehow oh because it came
43:10 - in as an array and somehow oh no because
43:15 - I I'm pulling it I'm that's coming from
43:18 - the JSON file and they are numbers in
43:20 - the JSON file the CSV it was only text
43:22 - so now there we go that's the maximum
43:26 - number of subscribers that makes sense I
43:30 - can get rid of this I have I should see
43:34 - right there we go so now if i zoom in
43:39 - the sizes aren't changing right the size
43:45 - no but I want it to
43:50 - I'm learning a lot from doing this video
43:53 - it turns out and this shouldn't have
43:56 - been a surprise to me I have encountered
43:57 - this before I think that it's not a
43:59 - linear relationship when i zoom from 1
44:02 - to 2 or 2 to 4 I'm not just doubling the
44:06 - size in fact so multiplying by the zoom
44:09 - isn't really getting me a consistent
44:11 - size circle as I'm moving and zooming
44:13 - around so what I really actually want to
44:15 - do is not multiply by the zoom value and
44:18 - I think it's going to be a little easier
44:19 - to see if I say constant zoom equals so
44:22 - just put it in a variable train map zoom
44:25 - and what I want to do is the scale the
44:30 - scale I'm just gonna say SC L because
44:32 - there's a function in p5 called scale is
44:35 - 2 to the zoom power now this I don't
44:38 - know if this is a hundred percent
44:39 - exactly right but so I'd have to maybe
44:43 - do some research on this and maybe
44:45 - someone in the comments can give me some
44:46 - help here if I'm if I'm getting this
44:47 - right but let me just put this in now
44:49 - scale now now the problem is now I'm
44:52 - multiplying by a very large number so
44:55 - this is kind of looks a little bit out
44:56 - of control so let me go back to my
44:59 - values up here where I was doing this
45:01 - mapping and I'm actually gonna have I'm
45:03 - gonna map between 2 and 10 so the
45:06 - minimum number of subscreen one pixel
45:09 - and 10 pixels so now if i refresh here
45:12 - we can move around and we can see like
45:14 - look at this you can see here if i zoom
45:19 - in on Brazil you can sort of see look
45:20 - look at the size of this circle right
45:23 - and then we keep zooming in it's kind of
45:25 - staying the same size relative to the
45:27 - country so this is the effect that I
45:28 - wanted and again me been off by a slight
45:31 - amount and now I could potentially say
45:32 - like okay well actually I'm happy to go
45:34 - I mean all the way up to 50 50 and we
45:37 - can kind of see here maybe this helps a
45:39 - little bit but now everything's kind of
45:41 - on top of everything else so I liked it
45:43 - maybe let me go back to 20 you know
45:46 - anyway so the point is this isn't
45:49 - necessarily the best way to visualize
45:50 - this data maybe what I actually want to
45:52 - do is visualize something about the
45:54 - number of subscribers per like relative
45:56 - to the population or maybe what I
45:58 - actually want to do is get the sort of
45:59 - geo JSON data which is like
46:01 - outline of all the countries to fill
46:03 - them in but I at least have done this
46:05 - and guess what
46:07 - just as a quick little extra thing to
46:11 - add to the end of this video and by the
46:13 - way look at all these subscribers down
46:16 - here in the Virgin Islands is that where
46:19 - I'm looking at I take the wrong plates
46:25 - that's kind of amazing to me I'm gonna
46:29 - swap out my CSV file let's quickly look
46:33 - at the watch time file the watch time
46:37 - also has country ID and watch time in
46:41 - minutes now the nice thing is the nice
46:46 - thing is I already built in all this
46:48 - stuff to kind of normalize the data
46:49 - between the minimum and maximum I could
46:51 - also look at views maybe I should look
46:52 - at views watch time probably makes more
46:54 - sense so I could really briefly right
46:57 - here change this out and I probably
47:01 - should have just called this I'm going
47:02 - to call this instead of subscriber data
47:04 - I'm gonna just do a find and replace
47:06 - subscriber data with like YouTube data
47:09 - replace all and I'm now going to swap
47:13 - this out and say watch time Gio I'm
47:18 - gonna comment this out and the only
47:19 - thing I need to change is I also want to
47:22 - get here now instead of subscribers I
47:26 - want what was it called again a watch
47:29 - underscore time underscore minutes watch
47:32 - underscore time underscore minutes also
47:36 - by the way had one in sub count I should
47:39 - change also which was views let me just
47:41 - change this everywhere it's a sub count
47:43 - let me just change this to count just to
47:49 - be more generic about it and let's make
47:52 - sure the okay and so where it where am I
47:57 - here sorry views let's see if this works
47:59 - with views there we go so now we're
48:03 - looking at this map based on views and
48:06 - now let's look at watch time and I can
48:11 - go to switch it out just by commenting
48:14 - it to watch time then
48:15 - it's kind of look the same be
48:18 - interesting to see what's the relative
48:20 - difference these are like watch time per
48:22 - subscriber that's something I could
48:24 - visualize here I'm sure that many of you
48:26 - watching this could come up with a much
48:28 - more stylish or perhaps more effective
48:30 - way of communicating this so here's the
48:32 - thing I will publish does these data
48:34 - files along with the source code for
48:36 - this particular video I would love to
48:38 - see you maybe we can have some rainbow
48:40 - train themed visualizations and try it
48:45 - with other try it with other mapping
48:48 - api's try thinking about it in different
48:51 - ways how can you communicate this data
48:53 - better than I have and I hope you will
48:56 - share that with me so thanks for
48:58 - tolerating this video which is very very
49:01 - long where I struggle with a lot of
49:02 - aspects but to me this is a really
49:04 - exciting that I can have a tiled map
49:05 - that I can zoom in and out of and
49:07 - interactively move around as well as
49:10 - draw on top so by the way these can all
49:12 - be animations this is the other thing
49:14 - like so I've done nothing visually or
49:16 - interesting here really or I'm not
49:18 - animating anything and that's the other
49:19 - thing you should really think about
49:20 - right so just to like quickly make that
49:23 - if I say like frame count module is 255
49:27 - and you know the the scale the size the
49:32 - is the scale is also times you know sine
49:36 - of frame count times 0.01 or something
49:42 - right I'm just gonna add some weird
49:43 - stuff to animate it right you could see
49:46 - that these are now hold on let me have
49:48 - that animate a little faster 0.1 you can
49:53 - see that they're blinking right and that
49:56 - blinking is going to stay consistent as
49:58 - I move around the map and the color is
50:01 - changing so this is the other thing you
50:03 - can do you can animate this stuff so
50:08 - what can you do with this data what can
50:10 - you do with your own data what can you
50:11 - do with maps that look like this with
50:13 - other Maps think about the projection
50:16 - that you're using research about
50:17 - different mapping projections in
50:18 - different ways of showing maps and make
50:20 - something share with me in the comments
50:22 - share with me at Schiffman on twitter
50:24 - and also look for the link in the
50:26 - video's description to the coding trade
50:28 - comp a
50:29 - where you can submit a contribution to
50:31 - link out to one of your contributions as
50:32 - well okay thanks for watching this video
50:34 - thanks for subscribing I mean maybe you
50:36 - didn't subscribe which is fine you don't
50:38 - have to subscribe but for those of you
50:39 - also subscribe thank you thank you for
50:40 - watching thank you for everything it's
50:42 - an honor and a privilege for me to get
50:44 - to make these video tutorials and have
50:46 - and reach people all over the world and
50:49 - let's just have a look one more time at
50:51 - all of you all over the world there you
50:54 - are
50:54 - all of you all over the world thank you
50:56 - [Music]
51:04 - you

Cleaned transcript:

whoohoo hello I'm making a video coding challenge today to celebrate some large amount of subscribers which is kind of insane and then right after this I'm going to go to the barber shop so please I beware I've really let this go here I'm gonna deal with it all right what am I gonna do today I'm going to celebrate the subscribers the viewers of the coding train with a visualization and I'm going to use a library that I've been meaning to use for quite a while called mapa is it was a google Summer of Code project last summer 2017 with the processing foundation created by Cristobal Valenzuela so there if you go to the mapa j/s org website there's a ton of tutorials introduction to web maps a history of different projections so there's so much interesting good stuff here I also if you scroll down here I'd really recommend taking a look at Mimi Onew OHA's everything is spatial data and digital mapping work so I love to get into all this but I'm just gonna try to do something really basic I have on my computer if I could find it why didn't I get organized before I started this YouTube here we go I have some CSV files these CSV files I downloaded through the creator studio so I logged in with my account in the creative studio I went to the analytics and there's an export to CSV so presumably there is some way for me to get this data with the YouTube API and I would encourage you hopefully I'm hoping people will make stuff either with their own YouTube channels or I think it's okay for me to publish this data there's no user information in it so I will check but I'll probably I'll I will also publish this data as well people want to revisit and interesting ways for me or not for me for you but anyway whatever the point is this is not going very well why have you subscribed to this channel tutorial things for you to watch out there what I was what I was going to show you is I have all of subscribers by country and I have also all of I have watch time alibi country this is the watch time in minutes apparently people have watched a candy I can't even read that that number it's 41 million 100 in the US some 41 million minutes that's really it's really hurt I mean wasn't just one person I hope it's gonna this is a mapping visualization tutorial isn't it okay let's go okay so how what am I gonna do here well first so I'm going to come back to mapa the github for mapa is here by the way that all these URLs will be in the video's description if you're still watching or if you just left and I'm reading the description however watching some other machine learning tutorial but I'm gonna I'm gonna use this I'm basically gonna follow this tutorial by Chris called simple map a map ax is an interface to other mapping API is like Google Maps map box leaflet and maybe I'm missing MapQuest wow that quest still exists that's amazing I'm staying over here look MapQuest so I'm gonna use leaflet just because from you don't need an API key for leaflet so it makes it a little easier for me to just roll on in and make this project but I encourage you to try this with Google Maps or map boxed yourself ok bye well let's get started here so the first thing I don't want to do actually is nothing to do with mapping I want to say function preload because I want to load in all the data so I want to say to celebrate I'm going to use Const Const is a way of declaring a variable that you're not allowed to that you're saying I'm never going to reassign this variable to a new value there's some nuance to that but that's the basic idea so I'm gonna pretty really a means to protect myself here so I'm gonna say Const subscriber subscriber data then in preload I'm gonna say I can't spell subscriber subscriber data equals load table whew now load table is a function inside of p5 as part of the p5.js library that is specially suited for loading csv data tabular data some other videos where i use that and describe that in more detail so I want to just let's start with subscribers underscore geo subscribers underscore geo dot CSV then I just want to in set up and say console.log subscriber data so let's first make sure I can actually load the CSV in the first place and I'm gonna go over here hit refresh this thing initializer in constellation oh okay I can't use Const here this is such a failure you already so I can't use Const why because this is being reassigning it I didn't assign it up there that somebody's let something other day I'll find it perfect because I'm gonna use kaan somewhere else in this you'll see it's constants vary hard to say alright so now we're loading hmm it's still loading it really is not going very well I don't think it's taking all this time to load I think that I have a mistake load table subscribers giotto let me just see here what version I'm in the recent version of p5 there there was at some point an issue with using load table in preload I thought that had been ironed out by now let me make a let me just make let's do a little test here well this by the way this videos gonna have lots of extra stuff in it I'm just letting this go no editing no editing I'm gonna make a test dot CSV file so you know it's like an hour or 500 minutes that would be appropriate alright so abc123 so I'm just gonna make a test this how I like to debug things I'm gonna make a test CSV file just try loading that oh I saw something there for a second look it's like they're pre load setup hmm hold on what is going on what craziness see here subscriber data it's there huh alright I had to edit this there there was no way around editing it there I did however I think I have a path to move forward and I've learned something new inside the developer tools I usually just look at this console thing there is this tab called Network and what we can see here look at this the test dot CSV file is just pending pending pending it's never loading oh it finally loaded it took uh I can't I want to be able to see it took 26 seconds 26 seconds to load that file that file test dot CSV is exactly 12 bytes meaning that's like two seconds per bytes this is very byte very unreasonable so I don't know what's going on but I I don't I don't want to blame anybody nobody's fault things just work if they work sometimes but I'm getting some weird behavior with this Python server that I'm using and actually if I change and use I have a node server HTTP server also available on my computer so I'm going to run that be a terminal HTTP server and then I'm going to go back over here oh wait no I have to go to a different yes different port and look at this three milliseconds test CSV so now we can go back we're getting somewhere we're getting somewhere I can go back to subscribers underscore geo dot CSV there we go okay now we've got that file I'm gonna go back to the console I'm gonna look at subscriber data and I can see there we go I've got an array with a 237 rows that means there's 237 oh there's fifty three columns there's lots of extra data in there other and there's 237 rows now one thing is all the cop none of the columns have a name so one of the things I want to do is p5 if I give it this nice little second argument and say header I think that says the first row in the CSV file is the header and we can see that if I click on here you can see these are all the headers that are actually there in that first row so now let me go back and refresh I'm gonna look at the subscriber data again go look at here we can see ah there it is so country name country ID and subscribers and then there's other all sorts of other columns transactions and ad revenue and all sorts of stuff so I'm probably going to clean up this data when I publish this just to have only the first three columns country name country ID and subscribers that's all that I'm gonna use for this example so now what's next I need a way of iterating over every single one of those so let's just look at how I might do that I don't know how but I'll figure it out for let I equals 0 I is less than subscriber data dot I don't know total columns let's look at the API p5.js org let's look at the reference I'm gonna look for p5 table and I guess if I go here to p5 table we're gonna see add row remove row get rogue find row finebros match row i'm looking for total huh Oh columns rows looking for Rose it's just in a field subscriber data dot rows I plus plus then I'm going to say the row is subscriber data get row I and let me just look at the rows go back here let's look at I haven't done this in a while line 10 Oh Rose is an array of all the Rose that's even more convenient so let Rho it's not a number I thought it was a total of subscriber data dot Rho I can use a four of loop and now I can just look at each row one at a time there we go that's each row one at a time then I can say console.log row get column what were the columns again country let's look country oh it's sort of like atom just knows it's what a country ID and let's do this mm get column is not oh maybe it's just get yes there we go yet it's just get and I get the country ID now I want to get a console log row get what was it called subscribers okay awesome there we go so I now have a country ID followed by subscribers country ID followed by subscribers okay we're getting somewhere should probably find the minimum and the maximum and normalized things but we'll worry about that later okay now now let's go back to the mapping tutorial what's been like two hours since I started this so I'm gonna go back to this simple map example and first of all I need to include a reference to this map map a library in my HTML file so I'm gonna just copy paste this here and I'm gonna go to index dot HTML and one of these days I'll learn how all this fancy new module stuff works but there's no way I like to do it right now I'm gonna reference that library let's go back to the tutorial whoo welcome to reading through a tutorial and copying the code over to your code code but thank you to this excellent documentation for the map library so I want to create a look at this there we go Const let's create a new map instance so I want to make a new pulling from the leaflet API just to be clear leaflet is this a jaw open source JavaScript library for mobile friendly interactive maps so again you can use leaflet directly by just going right there looking at how the code works napa provides a layer on top of that also because it you can pick other things besides leaflet as well as it integrates nicely with p5 and probably other JavaScript libraries alright so now let's just refresh let's make sure things are still working things are said well there's an error at the top there because it's mime type is X not executable what did I do wrong here hmm we have a little bit of an issue okay I'm back it turns out that there's just a little bug with this CDN link and so I'm going to use a different CDN link which is this one and it's working check the map web page for whatever the currently working version of this is by the time this video gets published hopefully it'll it'll probably be fixed ok mapa is now loaded excellent ok so now we can go back and we can go to this tutorial once again I was on this simple map tutorial and we can see here what's the next step I want to create now there's different kinds of Maps I can create there's what I'm and the world is broader than just this but I'm gonna talk about 2 right now there's a static map and a tile map a static map is a map that's just give me the map it's the image of the map I'm gonna draw it I'm never gonna change a tile map is one that I want to move around zoom in and out of and the reason why it's called a tile map is because the way that the mapping API is generally load it is they'll over there's a bunch of different tiles because you don't wanna get one big image all at once you get a bunch of different images and they get tiled so I want to create a tile map and this gives that the arguments here is like well what do I want where do I want the map to be centered around and what zoom level do I want to be so let's try map my map equals map a tile tile map so I want to say I'm going to go back to here and I'm gonna say I'm gonna say let train map and I'm gonna say a train map equals mapa tile map and let's just give it a latitude longitude of zero zero and a zoom level of four that was what's in the tutorial and let's see if we see that at all I'm gonna go here and so now one thing is I've let me let me mixing let me get rid of the canvas all right so I probably missing a step here I know that I have to overlay the canvas but let's see I don't see the map yet do I need to overlay the canvas or yes I guess if I don't overlay the canvas the map doesn't show up perhaps creator of map Allah is in the chat right here so I might here in a second what I'm saying that's wrong so I'm going to so I need a reference to the canvas I'm gonna say canvas and I'm gonna say canvas equals create canvas and then I want to say to which do I say which the the map a map I want to say the training map I want the canvas to sit on top of it overlay yeah I do so confirm breaking news I do have to overlay I'm not gonna see the map unless I overlay the canvas on top of it okay so these are the steps here I want a canvas that I can draw on I want a tile map and then I want my canvas to sit on top of it so now if we go here whoops train map overlay is not a function okay what I'm doing a terrible job here let me go to the tutorial my map dot overlay canvas did I take overlay with a capital L yes I did overlay is one word people lowercase L okay here we go unload setup sketch mmm what did I get wrong now so much for my no editing Oh is there was another edit there unfortunately whatever reason whatever I'm doing is throwing giving me an error I discovered if I revert back to one version earlier of the map a library then the error goes away so I can refresh oops I have to hit save and then I can refresh aha now okay so first of all if you're watching this video hopefully the source code is hopefully going to by the time you're watching this be using the most recent version of map but maybe I'll have to figure that out but for now I'm going to keep going now interestingly enough it says you are not using any tiles for your map try with so one of the things is I have to specify a particular set of tiles that I want to load and I would have just read further down in the tutorial it would show me that actually one way to do that is to put all of those things like I was saying I want the center to be zero zero and the zoom level to be four now I need to also give it a style all those can go into a JavaScript object so I'm just gonna copy pasted this from here this is a YouTube video where I am copy pasting code from a tutorial and like making lots of mistakes still somehow anyway and then I'm going to put this here and then I'm going to put instead of putting the arguments directly in the function I'm just gonna write the variable named options we are now going to refresh again and now I look at this there is my map so one thing I really want to do is I want to give myself more space to work with so let's try like 800 by 600 and I think I want to zoom out by default a lot more so what I know I think a lower number would be zooming out yeah that's maybe too much 1.5 all right that'll do to start okay so this is what how I want it to load initially and again maybe zero zero isn't the best middle point and there's all sorts of other things I could do but know we've got the map there now I just want to do something I just want to say ellipse 100150 let's just see what happens if I draw and I'm gonna do a nice purplish color which is my favorite color do look at this there's that ellipse now that ellipse is staying where it is so they're at a minimum what I have right now is the ability to draw over the map and I can do all of the map interactions and my p5 canvases right there now I have to be careful if I were to put this background here I don't see that map anymore and what I really should be doing is using the clear function the clear function is like putting a background that's fully transparent so this now you can see I don't know if you could notice this before without the clear function there was some funny antialiasing going on because I was drawing the circle actually on top of itself multiple times okay but the point is what I want to do is let's say I have a circle that's on the map over here if i zoom in I want that circle to stay where it is and grow with the map okay so how do we do that let's go back to the tutorial and I'm not gonna worry about lat/long but oh yeah no no I do want to worry about that so this is the key here lap map lat/long to pixel so the idea here is that I have a latitude and longitude and I want to find the pixel location of that no matter where the map is so let's let's just take this no matter what the zoom is let's take this and copy it into our code and I should now see it refresh oops I got an error again lat oh my map I called a train map so we can see there is now a circle here hopefully on top of the country of Nigeria looks right to me and I can zoom in and we can see that circle is continuing to move as I move the map around now here's the thing so I happen to find that from the example thankfully I just got a message in the chat for the next thing was about to look for which is a data set that has the lat longitude value for every single country so I'm just gonna I think I could probably google for it canonical countries CSV lat/long something like that would probably yes this is what I'm looking for I'm looking for the countries dot CSV data set and this now has a country every country with a latitude and longitude associated with it so how do i download this okay if somebody can figure out for me you can figure out how you download this file sure I could copy paste it I can't buy anywhere on this page of how to download this file and Nora in the chat seems to be telling me so I'm moving on I got a nice suggestion there is this github gist and I can just click over here to raw and this is now every single country code with the lat/long I'm going to assume that this is correct I'm going to copy paste this into a new file I'm gonna call this country's dot CSV and I'm gonna paste it in here so now I have oh not CSV it's JSON excuse me countries JSON and so good so now I have all the countries and they're lat/long by a and JSON so now I need to go back to my code and I am going to say let me have another variable called countries and I'm gonna say countries equals load JSON and countries dot JSON so now I want to just make sure that that came in okay console dot log countries well I'm gonna be going away for a couple weeks after I record this video let me get back everything's gonna make sense and work again in my tutorials I'm not going to make all these mistakes and never get anything that okay so there we go so now I can see excellent so I have onehalf beautiful the object I can actually look up by the country code great I can look up by the country code which is exactly what I want so now let us let me take this loop I'm gonna go over here kind of it I think that in a moment I am going to now get the country ID now I think something a little bit funny is going on here where if I look here the country IDs are in capital letters and in my countries JSON file they're a lowercase letter so I'm gonna need to be conscientious about that so I want to say let country equal Rho get country ID and I'm gonna say I'm think I could just say to lower case is that a JavaScript function in Java there's definitely a string function that sends thing to lowercase so I think that's right then I can get the lat/long is is what I want to look at the countries by country and so now that's going to give me that array with lat/long and then the latitude is the lat/long index 0 and the longitude is the lat/long index 1 and now I'm gonna say I want to say the pixels pixel coordinate is train map and now I not hardcoding it I'm getting it from that so now I say getting it from that C JSON file lat/long and then now well let's draw an ellipse at and I'm just going to call this pics at pics X pix dot Y 2020 so now I should see a circle at every single country where there is at least one person who subscribes to the channel and here we go what did I get wrong here cannot read you know interestingly enough this is live this is like this very generic error that's coming up no matter what if I do something wrong sketches yes line 41 what have I done wrong let me look let's look at these first console dot log country let's take a look to make sure my countries are actually correct those look right those look like reasonable country codes let's say no loop by the way because right now I just want to do it once okay so those look like the country codes now let's see so this is countries countries dot ad is that and so I should be saying a console.log lat/long let's look at that okay oh there's some that are undefined so first whatever reason I have some countries in my dataset that I don't have a lat long for so I that's why I got that error message so I just need to be careful about that and I need to say only if lat/long exists like there's some that are undefined then I should be able to pull the lat longitude out and draw a circle and let me get rid of no loop now let me say fill 255 0 200 let me put my semicolon there oh yes so look at this look at all of you beautiful people all over the world who are subscribed to this channel from all these different countries this is amazing oh and I got this horrible thing going on where I'm console logging got to get rid of that you do not want a console log from within a loop within a loop a zillion things that'll really mess stuff up let's go find Australia Australia look at this let's can we find a country with nobody I'm not sure the country that I need to so we've really got the center of everything this is great ok so now we're getting somewhere I can see everything there and now what I want to do is actually size the circles according to the total number of subscribers okay hmm all right here's the thing I want to talk you through something that's a really important little crucial detail here and I want to dive in for you but this may be what I could do is just turn the camera I'm working on this tensorflow J s color classifier and I didn't want to race my notes for it so now I think I have some extra space over here so sorry for being completely like a crazy person not like whatever I'm gonna diagram this for you here so here's the thing I am drawing circles in p5 with the ellipse function can you see that I think you can the ellipse function so let's say this is a circle with a diet with a diameter of 10 and this is a circle with a diameter of 5 okay circle with a diameter of 10 circle the diameter 5 let's say this is a country with 10 subscribers and this is the country with 5 subscribers have I visualized this accurately no the answer is no why think about this for a second if I were to do this this is a bar chart 5 and this is 10 you know this is accurate this is twice the size of this is this twice the size of this well the radius here is 5 oh I make these like 8 and for the point let me make these 8 in for just just please please please please allow me to make them 8 and 4 so the radius is 4 and the radius here is 2 right so what is the area of this pi rsquared 16 pi the area of this PI R squared 4 PI this is actually four times the size as this so I need to be conscientious about this what I actually want to do is take the total number of subscribers and apply the square root to it so that when I when when it's being visualized into a circle it will actually be representative the area of that circle will represent the total number of subscribers okay well you go we can come back over here now all right so here we go this is where I am let me see what was the zoom level when I open it up great so now what I want to do is I should be able to right here say let subscriber like let's say like sub count equal Roget and I already forgot what's in the CSV file if I quickly look at it here it is just the word subscribers subscribers and I'm going to say let diameter equal the square root of the sub count and I definitely should do some sort of napping but I'm not going to worry about that right now and then I'm just going to then put diameter here and I'm gonna give this some alpha because I have a feeling I'm gonna have some really big circles and now I'm going to refresh there we go look at this we have now visualize the subscribers and we can see here this makes sense like there is a lot of subscribers in India and we can look at we can look at Africa we can see that South Africa and Kenya and Nigeria if we look up here in Europe we can kind of see here that Deutschland Germany and England over here we can see the different countries France so this is actually and this should be accurate I could write the number there's so much I could do here visualization wise this really isn't like a tutorial in the end about you know the visualization I'm really just try to get the mechanics of it to work and one thing I might want to do I mean that the circles are just sweet why are they oh they should be sized according to the zoom level Oh weird umm I just realized something the circles are not resizing according to according to the zoom level so how do I do that there's got to be a way in the map a library let's look at let's look at the API so if I go under leaflet we can see look this is actually changing right we can see this example the circles are changing and let's see how that's done math dot zoom so map dot zoom so this is a way that I can use the zoom level of the map to change the size of the circles so one way I could do that is by saying something like diameter divided divided by train map dot zoom is it just dot zoom oh it's a function dot zoom so let's see what happens there where do I go now oops where was I come back did I lose it no I'm over here okay so now oh no I think I need to multiply it by zoom all right if you think about it the zoom level right I come back to my crazy little place over here if you can bear with me for a second if I have a circle like this a higher zoom number is me zooming in so I don't want to divide by the zoom level I want to multiply by the zoom level because the size of the circle is going to be what it is at zoom level one if i zoom in by two that circle should grow twice the size so I don't know why I didn't really need to walk over there but mentally I needed to take a break okay mentally I just needed to take a break here so I uh so what I need to do is say times zoom and then now look at this it's everything's way too big so now I need to figure out an effective way to to lower everything so one thing I could do is I could find that I probably should just like preprocess the data in setup right there's no reason for me to like do all this parsing over and over again so let me preprocess the data in setup and I'm going to create my own array so I'm gonna say I'm gonna say data is an array then I'm going to go to setup I'm gonna paste in that loop I'm gonna get the country and then here I'm gonna get the pixel Oh I don't want the pixel location I just want the lat/long and the sub count so then I'm going to say what am I gonna say here I'm gonna say data dot push I'm just gonna make an object now guess what what's that thing called in the new what's that thing called a new JavaScript where you I want to make an object and what I want to do is I want to say lat lat long long long sub count sub count this is how I this is how I always have written my code I want to create an object with these properties and the properties have the same name of the variables you don't have to do that anymore JavaScript new fancy JavaScript yes something or other allows me to just do this lat/long subaccount and by definition it's going to assume that if I generate an object this way that I want the property name to be the same name I want the property name to be the same name as as the actual variable name itself apparently it is known as enhanced object literals so this is an I want to create an object literal and I want to create it in an enhanced fashion so now that I have this now that I've done this now I'm gonna do a little thing here I'm gonna say max subs equals zero and min subs equals a hundred infinity now I know I know I did I am using enhanced object literals and I know there's a higherorder function sort of fancy way that I could just do this instantly but I'm just going to since I already have this loop anyway I'm just gonna say if sub count is greater than what was it max subs then max subs equals sub count I just want to find what was the largest number of subscribers and I also want to find out what was the minimum number of subscribers so now that I have the minimum and the maximum if I come down here and I can now I can just say for country let country of data and oh oh I want the country ID I need that Oh No look at that I don't I guess I don't need the country idea anymore okay I mean I want to save the country ID so now I just want to say I don't need this if any more I don't need this lat/long all the parsing has to be done I just want to say now I just want to say country dot lat country that long and then I don't need to the sub count is right country dot sub count and I want to say that and this should be a constant so should be I'm gonna say the square root of mmm boy I'm having a lot of extra square roots here let me let me actually add let me do this let square let me do square squirt square root I'm gonna I'm gonna just put the diameter in here square I'm gonna calculate it up here just once and I'm gonna add this in here and then you know what I'm gonna do let's just do all this up here I'm gonna just do this parsing up here too then I'm gonna go through it again one more time yeah yeah I know I could use a higher order function expect many pull requests and comments about that and I'm gonna say and now I'm gonna say let country of data and I'm gonna say country dot diameter equals map the country's diameter between the switch goes between the square root right right right right right I don't want to put the diameter in here I'm going to add I'm going to add a new probe there's no reason I'm going to add this property here and map I'm going to say min diameter is the square root of the men's subscribers and the max let's just say mindy and the max d is the square root of the maximum number of subscribers and now i'm going to map the countries the square root of the country's subscribers which has a range between mindy and max D and I'm going to map that between 10 and 100 and that's the country's diameter so I wanted I want to process I want to just sort of like normalize the data within some range add the diameter property and then right down here I don't need to do any calculations I'm just gonna say pics X pics y country dot diameter and you know with the ellipse function by the way you don't need to do the width and height if they're equal and then I'm gonna say train map dot zoom okay I think we might have gotten somewhere here I don't need this anymore and now here we go let's refresh Oh max slope is not defined okay where do I call max subs max subs hmm we're all all of you where are all of you subscribers Oh did everybody unsubscribe all of a sudden because of how long it's taking me to do this and what a mess this video is okay oh not yep nope okay let's do console.log data let's take a look at this let's see what's in that object okay the object is an array with lat/long sub count ooh diameter equals not a number so I messed something up there so let's see oh this has to be outside of here why is that in there oh so this is something I want to do right before I do this mapping I don't know why I had that in there well you've still should have worked let's console.log min subs and max subs see does that getting a real zero and 98 that doesn't seem right more than I have more so max subs is zero min subs is infinity if sub count is greater than max subs hmm that seems weird oh yeah my sizes are probably way too small but hold on those seem like strange numbers to me zero and 98 I have more than 9 subscribers oh they must their strings they're not numbers look at this if they're strings in alphabetical order 9 8 is greater than 9 79 I was not being careful the value that I'm getting out of the table is not a number I need to convert it to a number it's by default and I think probably I might have been he'll say something like get number in with the p5 API or I'm not sure let's see get number is that part of p5 no but I could say get and then convert it write a CSV everything is by default text and these should probably I don't know why these sort of work somehow oh because it came in as an array and somehow oh no because I I'm pulling it I'm that's coming from the JSON file and they are numbers in the JSON file the CSV it was only text so now there we go that's the maximum number of subscribers that makes sense I can get rid of this I have I should see right there we go so now if i zoom in the sizes aren't changing right the size no but I want it to I'm learning a lot from doing this video it turns out and this shouldn't have been a surprise to me I have encountered this before I think that it's not a linear relationship when i zoom from 1 to 2 or 2 to 4 I'm not just doubling the size in fact so multiplying by the zoom isn't really getting me a consistent size circle as I'm moving and zooming around so what I really actually want to do is not multiply by the zoom value and I think it's going to be a little easier to see if I say constant zoom equals so just put it in a variable train map zoom and what I want to do is the scale the scale I'm just gonna say SC L because there's a function in p5 called scale is 2 to the zoom power now this I don't know if this is a hundred percent exactly right but so I'd have to maybe do some research on this and maybe someone in the comments can give me some help here if I'm if I'm getting this right but let me just put this in now scale now now the problem is now I'm multiplying by a very large number so this is kind of looks a little bit out of control so let me go back to my values up here where I was doing this mapping and I'm actually gonna have I'm gonna map between 2 and 10 so the minimum number of subscreen one pixel and 10 pixels so now if i refresh here we can move around and we can see like look at this you can see here if i zoom in on Brazil you can sort of see look look at the size of this circle right and then we keep zooming in it's kind of staying the same size relative to the country so this is the effect that I wanted and again me been off by a slight amount and now I could potentially say like okay well actually I'm happy to go I mean all the way up to 50 50 and we can kind of see here maybe this helps a little bit but now everything's kind of on top of everything else so I liked it maybe let me go back to 20 you know anyway so the point is this isn't necessarily the best way to visualize this data maybe what I actually want to do is visualize something about the number of subscribers per like relative to the population or maybe what I actually want to do is get the sort of geo JSON data which is like outline of all the countries to fill them in but I at least have done this and guess what just as a quick little extra thing to add to the end of this video and by the way look at all these subscribers down here in the Virgin Islands is that where I'm looking at I take the wrong plates that's kind of amazing to me I'm gonna swap out my CSV file let's quickly look at the watch time file the watch time also has country ID and watch time in minutes now the nice thing is the nice thing is I already built in all this stuff to kind of normalize the data between the minimum and maximum I could also look at views maybe I should look at views watch time probably makes more sense so I could really briefly right here change this out and I probably should have just called this I'm going to call this instead of subscriber data I'm gonna just do a find and replace subscriber data with like YouTube data replace all and I'm now going to swap this out and say watch time Gio I'm gonna comment this out and the only thing I need to change is I also want to get here now instead of subscribers I want what was it called again a watch underscore time underscore minutes watch underscore time underscore minutes also by the way had one in sub count I should change also which was views let me just change this everywhere it's a sub count let me just change this to count just to be more generic about it and let's make sure the okay and so where it where am I here sorry views let's see if this works with views there we go so now we're looking at this map based on views and now let's look at watch time and I can go to switch it out just by commenting it to watch time then it's kind of look the same be interesting to see what's the relative difference these are like watch time per subscriber that's something I could visualize here I'm sure that many of you watching this could come up with a much more stylish or perhaps more effective way of communicating this so here's the thing I will publish does these data files along with the source code for this particular video I would love to see you maybe we can have some rainbow train themed visualizations and try it with other try it with other mapping api's try thinking about it in different ways how can you communicate this data better than I have and I hope you will share that with me so thanks for tolerating this video which is very very long where I struggle with a lot of aspects but to me this is a really exciting that I can have a tiled map that I can zoom in and out of and interactively move around as well as draw on top so by the way these can all be animations this is the other thing like so I've done nothing visually or interesting here really or I'm not animating anything and that's the other thing you should really think about right so just to like quickly make that if I say like frame count module is 255 and you know the the scale the size the is the scale is also times you know sine of frame count times 0.01 or something right I'm just gonna add some weird stuff to animate it right you could see that these are now hold on let me have that animate a little faster 0.1 you can see that they're blinking right and that blinking is going to stay consistent as I move around the map and the color is changing so this is the other thing you can do you can animate this stuff so what can you do with this data what can you do with your own data what can you do with maps that look like this with other Maps think about the projection that you're using research about different mapping projections in different ways of showing maps and make something share with me in the comments share with me at Schiffman on twitter and also look for the link in the video's description to the coding trade comp a where you can submit a contribution to link out to one of your contributions as well okay thanks for watching this video thanks for subscribing I mean maybe you didn't subscribe which is fine you don't have to subscribe but for those of you also subscribe thank you thank you for watching thank you for everything it's an honor and a privilege for me to get to make these video tutorials and have and reach people all over the world and let's just have a look one more time at all of you all over the world there you are all of you all over the world thank you you
