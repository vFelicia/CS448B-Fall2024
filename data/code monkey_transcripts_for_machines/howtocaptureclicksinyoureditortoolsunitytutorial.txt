in this video we're going to have a custom editor script and set it up so that we can click on objects this coupled with some gizmos allows us to create some awesome easytouse tools in this case we're going to test it out by quickly building a scripted cutscene for our game once we hello and welcome I'm your code monkey and this channel is all about helping you will learn how to make your own games with enough tutorials made by a professional indie game developer so if you find the video helpful consider subscribing okay so once again I've been working on the code monkey steam app if you haven't done it yet then click the link in the description to add it to your wishlist now I need do a ton of scripting so I started researching how to build a nice and easy tool now in a previous video I already covered how to make a custom editor script in that one we will learn how to create the custom inspector to show the fields exactly as we want it on with some really nice home from gizmos and now here we're going to expand upon that and add a simple button to each film that won't let us click to select our objects okay so let's check out our goal and then we're going to build it now over here is my scene and in this script I have the custom action script and we made in the previous video so with this I can script a whole bunch of different actions so for example let's say I want to make a little scripted cutscene so I want this character here to come here open the door then move here then see something then this one then this one requires and the first one goes away and close the door so it's a relatively simple scripted scene and thanks to the awesome custom inspector it will be very easy to do so first I have my custom action script and right away we see the custom inspector that we made in the previous video now here what's like the type of move action and now there's a field for the unit game object and over here we see a very nice custom button so as I click on it yep there's a message telling me to collect this unlike the unit move position and now the custom editor is in a clickable mode and if I mouse over a valid unit if there you go I can see a nice highlight so this one is valid and I click on it and there you go the unit gets on like automatically and this field is set so using this method I didn't need to look at the hierarchy at all I just looked at the fields click the button then visually clicked on my scene and all the films were set so as you can see this mixer are nice too only extremely simple and easy to use alright so let's continue filming the scene this one will move here okay then let's make another action this one won't be of type door so once again there's a button to visually select door so click on it and now I highlight the door and I click on it yep there you go it's selected this one will open and then the move action also has the own reach position which takes a custom action so once again button visually click on the door action and there you go he goes straight into that one so you can see how all of this is very visual and there's no need to look in the hierarchy at all so now I'm going to very quickly build out the home scripted cutscene all right so here it is in just a few seconds I managed to make a really complex cutscene let's try it out so there it is heard off with down he goes in there opens door now he moves in there he says his message Devon moves up says the other message then down moves away and finally closes the door alright awesome so here we have a really nice simple cutscene and he saw how easy it was to build thanks to our custom editor inspector along with the ability to visually click to select objects you can see how this greatly improves your productivity without this tool it would have taken me something like 30 minutes to script this cutscene but in this case since I took the time to build a custom tool it literally took me just 60 seconds to build this whole cutscene of it thanks to a custom inspector custom gizmos and capturing clicks in the scenery this videos patreon sponsor is bad Adventure bad adventurer is a game development duo currently working on their first game Wayfarers edge it's a RPG focused on exploring and settling unknown frontier lands in a low fantasy and Wild West theme check them out at bat adventure calm thank you to the patreon sponsor and thank you to these awesome supporters for making this video possible go to patreon.com/scishow code monkey to get some perks and help keep the videos free for everyone alright so this our goal let's get to it okay so here we are in our starting theme this is where we left off on the custom inspector video so we already have a custom action with a custom inspector script so by itself this is already very nice and very versatile tool however in order to use it we need to identify objects and drag their references so for example let's say I want to use an action to move this character over here so first I go into the action types and lightly move and now here I have my field so I have to select the unit game object so first I need to identify it so let me click on it and there you I can see that it's this one now have to memorize this name so it's a unit one now select it again now click on this one drag it on and drag it on there alright so this is how it is now let's improve this home process by seeing how we can capture clicks in the editors name that way I can click on some random button in here then visually click on noun and it automatically fills the field okay so to do that let's first open the custom editor script right here the custom action editor okay now in order to do this we're going to need to do it down here on the on scene GUI now this function gets called when the object is selected and the scene GUI updates so here we are already handling with the position handle for the move position so down here you can see it in action when I select this action and it's a move type yep there's a nice move handle to set the move position so that's what this code is doing and here now the first thing we're going to do is grab the current event so we're going to given dot current and now here since we want to capture clicks let's test if the event dot type is of type and I'll here one thing in theory we want the mouse up but just for testing let's first test onmousedown so on let's rock let's test okay now i'm like i said that function only runs when the object is selected so if it's not selected I click yep there's nothing on the console so I need to first unlike the object that contains the custom action and now if I click if there you go there's a mouse down event so just like this we are capturing mouse clicks with our editor script all right awesome now here's the reason why I test with mouse down insert mouse up has to do with how the selection works so if I put mouse up which is how we should capture our clicks except if I do it right here and I can I can now let go and if there's no message that is because first the object gets D selected and then that function no longer runs so we don't have our message so the next thing we need to learn is how to pull up clicks so here let's first test blocking clicks if the e control is down so if we press E control key then we don't want our object to be deselected and now the way that we bought clicks is going into the handle and utility add a default control and we grab the default control all right so this tells the editor to use the default control which causes it to not change selection and if we go back okay so if I sound like the object and click away yep there you go the clicks tongue works as normal but now if I do it well pressing control and nope there you go it no longer decent less the object and right here in the console you can see that our mouse up is now correctly being triggered so this is how we're going to stop unity from decent lightening our objects and instead capture the clicks to do whatever object we want okay so now that we can capture our clicks it's time to actually test if we're collecting on top of something valent now there are mainly two ways that we can find what the object were clicking on if the object has a Collider then we can use the physic system and if it does not have a Collider then we need to do some trickery with positions now in here all the objects that we want are using quieter so let's go with the simplest physics system method so let's fire some recasts back in our code down here on the unseen GUI let's first get our ring so our way we go into the handle utility and we do a GUI point to world break passing the mouse position then we do a normal way cast okay here it is and then we just do a debug log upon the amount of hits so in here dot point all right so we should be constantly doing array and I didn't find what's underneath the mouse position let's see and it right away we can see the console updating so if I aim towards nothing yep there's a zero there's no raise nothing being hit and if I mouse over the ground which does have a Collider yep there you go and I mouse over the wall and there you go and on door and so on all right great so now that we have our recast working let's add a very nice visual now to do that first let's take on through all of our hits and now here let's draw a wire cube around the corner that this hit all right so we should be able to see a weary queue right on top of the camera that was hit okay here we are as I mouse over the ground if there you go there's the water keep on top and there's a wall another wall and a part of the door and so on all right great so just like this you can definitely see the object that I'm hovering over now here if you're following along depending on how you set up your scene you might be seeing a potential issue here so right now as you can see everything is updating nicely however depending on what you have near scene this might not be as responsive meaning maybe you move the mouse around and it takes a while to update the actual drawn wire queue now the reason for that is due to how the scene view works the scene view only renders when something changes so back in this code this function will only get called when it absolutely needs it so if you do have that issue then one simple solution is to call scene view the repaint on this won't force the scene view to repaint and if you do that then the issues with unresponsiveness should be solved right great so now that we know what we're hovering over let's identify and filter our objects for starters let's say we want to capture just the unit's we want to be able to run our move action in order to do that the units need to have the move position component now this is the modular component that we built in the modular character video so let's use this as our filter here when we do our ray cast let's try getting the component so if this succeeds and that means that the game object that were hovering over does have a move position component so in this case it's a valid unit and if it is not then it should not show the wire cue all right so let's test okay here we are and as I move the mouse over the ground yep there's nothing on it since the ground does not have the move position component but if I mouse over a unit if they're gonna I can definitely see it all right so our code is now correctly identifying which objects are about okay so right here we have pretty much over logic nah let's just organize this nice and clean so appear and let's make a nice function okay here is our really nice and helpful function now it does exactly the same thing that we're doing previously and it's also set up to be made to work with any type we want which makes it very versatile now in here it's using generics and if you're not familiar or want to learn more then check the video linked in the description so we do a ray do a ray cast cycle through them check if they have the component and if so then we output with the component and also the collider and then down here we can just use it so instead of doing all this let's replace it with our function call alright so just like this and should be working exactly the same any up here it is it does not show anything on the ground but as I mouse over yep there it is alright great so this code covers our selection now let's also apply this to our clicks so we're going to use the mouse up event and when we do have the mouse up then let's once again test we grab the object over to recast and if there is something and then we need our script instance right here and we just set our parameters all right so that should do it so when we let go of the mouse we are going to set the field if it's on top of a valid position and in here if we are holding ctrl then we are not going to deselect our object okay so here we have our custom action let's make it up move and yep there we go that one is set to null and as I mouse over yep there you go it identifies that that one is a valid unit and if I press on the control key in order to not deselect and I click and there you go and I would correctly selected our unit so by visually clicking on the scene view we correctly set this field all right awesome now instead of having this mode active at all times let's use it by activating a button so in our custom inspector we have our inspector code and down here we have the line that shows all of our property fields so instead of showing the entire move pram see neuralyzed object will show them individually ok so it shows each one now let's put a button right next to the unit game object so for that let's first call the editor GUI in layout and let's begin a horizontal then we add our unicum object property field and then let's add a button so this one's fun a button with a plus sign in the small width and then we and the horizontal alright so just like this we should be able to see the button and if there it is we have our unique geologic film and right in there we got a nice button now let's add some code on the button so this function returns true when the button is pressed and if so then we want to enable our click mode so up here and let's define some signal fields so when we click let's set this one to true and now down here we're only going to highlight some like the ball okay if this one is true and we're also going to block the clicks only when this one is true and after we said there are field and we set this to false all right so this should be working okay here we are with our custom action let's first swap it onto a move action alright and it's set to no okay and if we click yep there you go the clicks are working as normal now we select it again and now it's like on the plus sign and now it should be boiling clicks and as I mouse over if there you go there's a selection now I click on it and there you go it filmed the field and now the Mazda vector no so I can click and yep decent like normal all right awesome so with this we have all of our click logic fully working now we need to do is just expand upon this by handling all of the various types so back in the editor script let's the finding room for all of our types all right so we have an in home for all of our types we store the animal type and then we also have an action so this is an action delegate to set our actual object now if you're not familiar with delegates check the link in the description then down here we set like this all true yes then we set the click to select type in this case we use the same one okay and then for the action we set it to a delegate all right so we didn't like this so this action will receive an object as a parameter and we're going to set in this case the move params that ingame object with our object as a game object so then down here we can make it work with any type first we do a switch on our click to select tank this is where we check the type that we're going to use in here now down here to do the same thing and instead of using this directly we're going to call the click to select action and then passing the object which in this case won't be the collider game object all right so this should still all be working exactly the same ok we have our custom action and no units selected no click on that one now some like don't know any of there go all right awesome it still works now it's applied to of type of another custom action so first we have another plus button on here on the on reach position action so we modify the click select type to select a custom action and then we set the move params on reach position to this object as a custom action and now down here first we handle the selection so this one really just means changing this one all right so we test if the mouse is over a custom action and we show I know down here handling the clicks we call the click to select action and we pass in this one all right so we just need one final thing which is all this is working using the physic system so that means that in this case Northlight something needs to have a cone weather so on the custom action let's also add a basic box Collider so just like that just so it's clickable right so let's make a different action all right so here I have a custom action to open this door so this one moves and now here we have the unreached position we have our nice plus button so click on it and I can click on this action any of there you go it goes from this one on to this one alright so here we have a very versatile very robust system it is built in such a way that we can make it work with any type so here you some how we add the two types now we just need to expand upon this to also enable clicking on doors and other objects and anything we want so I'm just going to finish adding all the rest all right so I've expanded the code to fit all the types so everything should be working so let's first start off with this action let's make it of type move all right here I have the various plus sign so for the NTA I click on plus yeah there you go there's also very nice label click this unlike the unit move position so I'm going to select this one and now I'm going to tell it to move here and now it's like this action let's make this of type door and there give the door also has a plus so click on it and select this door and now let's go from this move position and when reaches let's select two points like the door and there you just like that so very easily just by clicking on the scene view you can see that I have set up all the fields for these various custom actions and if we run our scene yep there's the end right there it goes in there any up opens the door alright awesome so now let's make a complex cutscene so first let's set up on the actions so we have that one moving then this one is also going to be a move it's going to move that unit and I was going to move it in here then we had another move action this time we're going to move this unit and we're going to move it in there and then we're going to have another action this won't be a chat bubble so a click and we're going to say a message on this unit it's going to say something then we have another one and I was going to be this unit generally to have another move action we need to move this one back in there and finally we're also going to have another door action and this time we're going to close all right so there's all the individual actions and now we just need to schedule them so that one moves into this one now this one when the door animation completes goes into this one so he moves there then after moving he moves the other one so he doesn't this one then this one says the chat bubble then this one the other one all right so just like this let's test all right the unit cows goes in there opens door now goes in there another one in there now he says a message no this one says this message now that one he was in there and yep he calls the door right awesome so here we have our very complex behavior working correctly and we built this in just a few seconds thanks to all of our awesome tools so here you will learn how to capture editor clicks and apply them to any tone we want in doing so we created this awesome custom editor script that lets us build some really complex rooted behaviors extremely easy this is just one small example of the use case for a custom script by making a custom inspector with interactive buttons and clicking on the scene you can apply this to any tool you have in your games so go ahead apply this here games to greatly increase your productivity check out the code monkey upon Steam interactive tutorials complete games and more click knowing the description and add it to your wish list this video is made possible thanks to these awesome supporters go to patreon.com/scishow code monkey to get some perks and help keep the videos free for everyone as always you can download the project fountain utilities from unity code Montcalm subscribe to channel for more unity tutorials posting the cursor in the comments and I'll see you next time