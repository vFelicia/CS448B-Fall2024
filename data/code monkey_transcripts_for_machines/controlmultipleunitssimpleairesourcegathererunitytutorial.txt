hello and welcome I'm your code monkey and in this video we're continuing our resource gatherer AI we're going to add support for multiple gatherers let's begin so here's what we have so far here is the gatherer and here are multiple notes if I click on this note in here the other goes to him he minds it three times one two three when the note is depleted he takes it to storage and right now he's waiting for another order now if I tell him to go in mind this note in here he's going to go he's going to mine it one two three that one is a blatant goes to storage and now he automatically searches for another note located near the one that he was told to mine when on the nodes nearby the original order position have been depleted he waits for another order again so yep he finished mining all of these and now he's again waiting for an order and again I can tell him to go somewhere okay great so now let's not support for controlling our gatherer but with multiple gathers we're going to set it up to first select together we want to order and then give him the specific order on the gathering game object let's begin by adding a selected circle so what's going to the gatherer game object here you can see the gatherer is not visible since the animation system only runs when the game is running but you can see by the shadow the character is placed around here okay so we want to add a circle to display when together is selected so let's create an empty game object and let's name this some like the circle going to add a sprite renderer component and drag this circle texture in here yep there you go there's a circle now let's place it to roughly the same thing as his shadow okay alright so we have our selected circumscribe completed so this is the sprite that won't be displayed when together is selected so let's start off with it disabled it won't be enabled when we actually some like together now in order to click on him we need to have a box Collider and a button sprite the same way we did for the resource nodes so let's go up here and to the gatherer and add a box Collider 2d and a button sprite to our character okay great let's shift it to increase to about this just like that the character mesh is only sentient on runtime but I can see the shadow and I know how roughly how tall the character is so about that you did the trick okay so we now have the ability to click on this gather the button sprite is a helper script that helps us click on a box Collider 2d it is part of the code monkey utilities so now that we have together and let's duplicate them and here let's make unit exactly the same let's just push it to the side okay and let's also duplicate some of our resource nodes so put it in there a couple more notes here and a couple more nodes here okay now let's go into the gallery I script and capture our clicks so here's the gatherer AI script and in here we're going to do very much the same thing we did for the resource node so we're going to have an event that won't fire when the gatherer is clicked and that event won't be triggered on the button sprite click func so let's do pretty much the same thing let's copy this go into our gallery alright and let's use it in here alright so on the awake of our gatherer we are going to the transform grabbing the component for the button sprite and on click func we are going to fire this event which is a static event that won't fire whenever together is clicked and here just make sure that everything is working let's do a CMD bug text pop up on the mouse position just say click the CMD bug class is part of the code Mach utilities which you can grow for free from Unity code monkey comm so let's test it out and see if the size of our colliders are correct okay here are both gathers and if I click yep there you go you can see the popup and if I click outside nothing and there click and same thing on this one okay right we can now click on our gathers so now that the clicks are working let's set it up to catch them in the game handler so on the game handler in here just like we did on the resource node we have a function to capture the click so it's also make another function to capture the gatherer on gathered clink let's make this in here okay great and on the objects under we actually have together a I gather a I equal sender as a gather a I so we are now capturing clicks on the game handler and we can actually know who was late let's go to the gathering I and copy the click onto the game handler to make sure the event is working correctly so let's see everything should be working exactly the same but now the events are going through the game Hamlet rather than directly on the click so I can go here I click and yep it's only got the problems okay so events are correctly working great now let's have an array to store all of our gatherers since in here we just have one and now we're going to have an array of gatherers gather AI array okay and in order to control the gatherer we need to know which one has been selected so let's make a private gather AI for our selected together AI so the array contains all of them and this one contains the one currently selected and in here when we click on a resource node we're going to use the selected together a I however if this is known then we're going to do nothing only if it is different from now well you actually do it so if it is something like to gathering AI is no no one is selected in here order the selected gatherer yeah all right so that's our logic for ordering our gatherers now let's set up to be able to set the selected together a I so in here when we're capturing the gatherer clonk events let's first remove this and we want this gather yeah this is the one that was clicked we want him to be the selected together AI so in here let's make the selected equals this one now we need to showcase the selected sprite so let's go into the other AI and make a couple of functions so let's go all the way down here let's make a public void show some like the sprite another one public void hide selected sprite so in here we're going to go into the transform and find the selected circle that is the game object that we set the sprite for the selected circle and in here set the game object that set active to true and on the hide we do the opposite all right so on the game handler when we set this and like together I let stone to show the selected sprite all right let's see if this bride shows up when we click on it alright here are both units and when I click on them yep the sprite is visible now that one is selected and if I click on this one yep this prize is born out this one it's not lighted ok great we can now accurately select and show which one is selected now obviously there's a mistake here we the selected gather is this one but this one is still shown so we need to tell them to hide the selected sprites before showing the correct one so let's go in our code on the game hammer now in here when we show this light sprite before we set the Neely's unlike together a eye let's test if the selected one if it is not known then we're going to tell him to hide his light sprite if it is known that no one is selected so there's nothing we need to do so let's see and now we should correctly only be able to select one gather at a time all right no one is selected so if I click on the nodes nothing happens now I can select this one yep and now if I click on this one yep as you can see that one was hidden and that one was recent liked it so now I can click on this one and this one ok so we are now correctly selecting a specific gatherer and also showcasing the sprite to show which one is currently selected all right so with this gather selected I can click on here and yep I told to go there using mine and keep mining and now one that one is working I can click on this one to select them and now I tell him to go there so now both of them are working completely independent and as you can see the logic of searching for new one is still working I told this one to go here he mined both of them and went back I toned down to go in here he's mining and he's going to stop once all those been depleted so there you have it we added support for controlling our gatherers by selecting them and telling them which node area they should mined from in the next video we're going to add support for multiple resource node types as always you can download the project files and utilities from unity code monkey comm if you have any questions post them in the comments and I'll do my best to answer them subscribe for more videos and I'll see you next time