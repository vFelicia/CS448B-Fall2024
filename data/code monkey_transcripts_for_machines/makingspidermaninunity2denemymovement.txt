hello and welcome I'm your code monkey minute series we're creating spiderman in unity 2d in this video we're adding movement to our enemies let's begin so here's the scene so far we have spiderman and a bunch of enemies I can attack the air and nothing happens or I can move close to an enemy and attack him and as you can see after three hits he dies and when I hit him there is a screen shake and some impact particles so right now as you can see the enemies are simply static they respond to hits but never actually move let's make them move towards spiderman so in order to do that we need a reference for our target now there are many ways to do this but in order to keep things simple and let's make them only capable of attacking spiderman later on we're going to refactor our code to be able to attack other entities as well so let's head into the spiderman class and in here and let's define a static instance so do a public static spiderman call it instance and on awake let's simply set the instance do this okay so this gives us a globally available reference to our spiderman now let's head into our enemy class in here let's define a member variable for our target so make a private spiderman target and let's grab our target on the private void start and set the target to spiderman instance alright so we now have our reference to spiderman well let's test to make sure that our reference is correct so simply make a private void update and on update let's move him towards the target so a vector3 for the target dear equals target dot yet position minus get position dot normalized and so on move the transform that position was equals target dear times a move amount just to check if we are moving towards our spider okay so let's run the code and see and yep as you can see they are slightly moving towards spiderman which means they are correctly accessing the correct reference okay so now let's first go appear and define a constant for our speed so in here make a private cons float for the speed and let's set it to three and down here and let's use the speed to move alright there you go they are now moving at a decent speed so now let's go into our game hammer and make sure we're only spawning one enemy just for testing and there's a single enemy correctly moving towards spiderman okay great now as you can see the enemy is moving but not actually animating essentially we have to do the same thing that we did for spiderman so let's go into the enemy code and in here let's make a private boy to handle movement this won't be the function responsible for moving our character now inside let's move in towards our target but before we do that let's define a minimum distance so we don't get to overlap our target so make a float for the stop moving distance and let's set it for let's say 30 F and in here we're only if vector 3 dot distance if the distance between this enemy and the target dot get position if the distance between both of them is bigger than the stop moving distance then we keep moving if not then we stop moving so too close to target stop and here target is far away move closer now if we are too close then we go into our enemy base and play the idle animation if we are not too close and we want to play the move animation and again let's grab the target direction and the move code so in here play the move animation towards the target direction and then our update let's call this function alright so on update we are calling this function we are testing for a stop moving distance if the distance between this enemy and the target is bigger than stop moving distance then we move closer if not we stop and we stay idle when we are moving closer simply calculate the direction to the target move this transform towards him and play the move animation towards that target direction okay let's see on that in action ok there's the enemy and as you can see his stop because he's within 30 and if I move and yep he's moving closer and when he's within range he simply stops and becomes I don't yep exactly now in here we have an issue much in the same that we had with our spiderman movement which is if I attack him you won't see that the head animation no longer plays I hit him and yep there you go he was knocked back but he did not play the head animation again this is the same thing that was happening with our spiderman on attack that is because when we hit he plays the head animation but the very next frame he goes into the idle animation so they are cancelling each other so let's go into our enemy class and we're going to fix it much in the same way go down here make a private in room for our state and the possible states are either normal or busy and store our current state ok let's go down here make some helper functions so a private void set state normal where we simply set the state equal state normal and do the same for that busy okay now on our awake we start off as normal and on the update we do a switch on our current state case we are in state dot normal then you do handle movement just as normal case we are on state dot busy do nothing all right so now all we need is to go down here on the damage when we get hit right here when we play the hit animation we need to also set this to busy so here simply do set state to busy and when the animation is complete instead of going back to idle we're going to call the function to set the state back to normal alright so this way he should remain on the busy state while the hit animation is playing when the hit animation finishes he goes back to normal and he goes back to handling movement so let's see if he does get hit plays the animation and goes back to normal ok there he is if I move away you can see that he is following me ok great now if I hit him you have there you go there's the animation and then he goes back to normal and if I move him away he is don't following me ok and I get him again now he's dead alright great so again let's just with multiple enemies okay so here I am and enemies are currently being spawned I can hit him and kill him and now that I wanna spawn he's chasing me hit him killing him kill him and another one boom boom and yet they keep spawning they keep moving towards me and I keep killing them all right great so there you have it we added simple movement to our enemies in the next video we're going to add web zipping to our spiderman so we can move around very fast as always you can download the project files and utilities from unity code monkey comm if you have any questions post them in the comments and I'll do my best to answer them subscribe for more videos and I'll see you next time