hello and welcome I'm your code monkey and in this video we're going to make the demo man from Team Fortress 2 in unity we're going to start off by creating the grenade launcher it's gonna fire bouncing grenades have them bounce off walls and damage enemies what the third so I have my Demoman character here with a spreadsheet applying some animations already set up I can move them around and when I click my mouse button it plays a firing animation so let's make some bouncing grenades that won't be fired when we shoot our weapon so into our game ml script here and here I've got a very basic setup I've got my player handler handling the movement and playing the animations for my demo man I have a transform for an enemy that we are going to use later I have the camera phone script which was created in a previous video and it's currently being set up to follow with the camera position it is basically just the player Hamlet positioned shifted slightly towards the mouse so on my coin handler script I have an event being fired on shoot this event is fired when the player plays the shooting animation and inside it on our event args we have the gun endpoint position and our shoot position so we're going to want to spawn the grenade on our gun end point position and move it towards our shoot position which is the mouse position on screen so we're going to fire our innate in here so let's create this court to handle that can here create a new C sharp script and name it bouncy grenade now in here let's make a static creator so public static void creates this won't construct our actual your name so in order to spawn the grenade we need a vector3 for our spawn position and a vector3 for our target position and we're also going to need a transform for our 3/5 for our bouncy Cornett so let's instantiate our yea or nay prefab into our spawn position with patern n dot identity we're going to apply this class to our prefab so we can grab it right here the renamed and start get component left i10 net now in here we're going to have a setup function in that setup we are going to receive our target position okay so private point set up inside winter seal vector three for our target position now let us go and create our prefab so make a new prefab name it here bouncy grenade now for that prefab we are going to have a game object with a sprite renderer and we're going to use this sprite right here I'm going to add the bouncy grenade script and we're going to use physics to move our grenade so add a rigidbody 2d and add a capsule Collider 2d make it a bit bigger than the actual visual object okay good let's put on linear drag of two I'm going to drag also to gravity of zero since we're using this on a topdown perspective and we're going to need a material to make it bouncy so create a new physics material 2d conflict bouncy material and it's going to have friction of zero and bounciness of one apply it as our physics material and this is our prefab so back into our code here let's have another serialize field for a transform for our PF bouncy Renee and when we shoot we're going to go into our bouncy grenade dot create we're going to give it this prefab the spawn position won't be the gun end point position and turret positional be the chute position okay let's see for a prefab is being correctly instantiated let's fire and there you go it is spawning exactly on the point that it should okay now obviously let's make it move back into my bouncy grenade and in here on a set up so let us calculate our move the direction which will be the third position our transformed position let's make it normalize we're going to have a move speed and let's say 250 m and we're going to go into game object get component of type rigidbody to Dean and we're going to set the velocity to our move direction x bar move speed and we're also going to make it aim towards our target position so let's make our transform local Euler angles make it at zero zero and here we're going to use the code monkey dot films to go into our get cells class get angle from vector of our move Direction okay so now our bouncing grenade should be correctly being spawned it should be rotated towards our target position and move towards it let's test it out okay boom there you go it is moving towards there okay great now obviously we don't want them to live forever so let's add some time to explode here the private will time to explode initialize it in here and let's say two and a half seconds we've had a private boy update on our updates time to explode each one's time Delta time if have to explode is under zero out then destroy our game object and let's see if they vanish after two and a half seconds fire there it is and poof vanished okay great now let's add a wall to test our grenade bounciness so adding you just for test the game object called wall add a sprite renderer add a basic white pixel let's make it in a dark grey and let's increase scale our height and move it around here and add a box Collider 2d okay let's see if it is bouncing off of our walls and yep they're your weekend fire grenades goes into all and bounced the back okay great now let's add a basic bounce effect to make it seem like the grenade is going up and down so at a private int bounce state and to start off at zero and in here we can do a switch on our about state and Cays 0 if it is 0 we're going to increase our local scale so transform dot local scale plus equals vector $3 1 times let's say 7f x times down the top now if our transforms out local scale that X if it is bigger than a let's say 2.5 F then change the bound state 1 and here if we have bound state of 1 we're going to reduce it to go down therefore were transformed on scale dot X if it isn't less than 1 F set the bound state to 2 and here case to do nothing okay so it should be increasing and decreasing the scale adding a basic effect simulating vertical up and down yep there you go okay now obviously our grenades need to explode someone set a next motion effect go back into our game hammer and we're going to need another transform what's called TF explosion and then here when we were creating our bouncy grenade we're going to add another parameter for a function that will be called when the bounty grenade actually explodes and we're going to call it on the grenade explode private void on grenade explode and inside we're actually going to receive vector 3 for the position where the grenade exploded so what's going to here and here first we're going to be using system and we're going to receive an action though have friends at four vector3 oh it's on exploded action we're going to add it to our members very lumps here and we're going to add it to the setup okay and now when we actually explode what's making you function phone explode her name and have a private boy explode her name and when you explode we're going to trigger our action sending our current position and destroy this game object okay so now back into our game Hamill or this won't be called when our grenade actually explodes so it's in here that we want to instantiate our explosion prefab so insatiate our PF explosion into our position with what there and our identity ok great for my explosion prefab I am using a free asset from the asset store and let's test it out and see if it is correctly being instantiated I can fire and after two and a half seconds boom there we go it exploded okay great now we also want our grenade to explode after some time but also when they hit certain objects like for example an enemy so in order to do that we are going to create a dummy component to identify which objects should explode on contact going to our scripts and let's create a new C sharp script and just call it exploit on contact open it and just leave it completely blank since we're only using this to tag objects and in here let's create a different wall just for testing purposes drag it to the side make it a different color and we're going to add our explode on contact and we're going to make it a trigger so back into our Vaughn C grenade code here and we're to add a private void on trigger enter to dean very test if the collider that we have that game object contains our component for explode on contact if it is not known if it does contain that component then we are going to explode our grenade so exploit grenade back into our scene and let's see if the grenades explode as soon as they touched this object and boom there you go I can hit that one and nothing happens it says normal and if I hit that one then they explore this and as a touch ok great so let's add some enemies to our scene I have a prefab here with an enemy that simply moves towards the player and I'm going to add the component for explode on contact and back into my game land when I'm here I'm going to use the code monkeytales function periodic which is always you can grab from Unity code monkey comm I'm going to create I'm going to create with the action spawn enemy and let's say every one second spawn an enemy no it says that out and see if enemies are being spawned and if they get hit by the grenades as soon as a touch seen here there's an enemy and I hit him boom he explodes it's not taking damage but it is exploding exactly when they touch okay great so let's actually cause some damage to our enemies so I have the list of my enemies in here and it's when the grenade actually explodes I want to see which enemies are within range of this position so in here I want to do damage units and blast radius so I'm going to have a float for my damage radius and let's say 20 F so here let's create a new temporary list for our enemy handler so we call the original list so 10 enemy and we're list equals a new one of the enemy handler lists way to go for each enemy handler and in enemy in my temp any cameras and then here if my like the three dot distance between the explosion position and the enemy handler get the position if the distance is less than the damage radius and I'm going to damage the enemy I'm going to do enemy handler doc die you're going to die in just one hit and I'm going to remove him from the original and the handler list okay let's see if the enemies are being killed by our grenades there you go there's an enemy I can hit him boom he vanishes okay great and the grenades don't bounce and they can hit okay so now just for fun let's add some screen shake when the grenade actually explodes to our code and have a shake camera and what sane to see one okay so we now have some basic screen shake and now for another effect let's make the enemies fly off screen like we did in a previous video for the flying enemy dead body so I have here this quirk that we created in that previous video and as well as the prefab so let's spawn this first I have a reference to our TF enemy dead body and when the grenade explodes when we kill an enemy trying to go into our flowing body class we're going to create it give it to PA and meet that Bonnie spawn it on this enemy position so enemy hammer god get the position and we're going to move away so let's calculate our effector three for our direction which will be the enemy camera dot get the position our current position dot normalized now we're going to send that direction okay let's see if we correctly apply the script from previous video okay so here I am there's an enemy and boom there he goes alright so now we have our grenade launcher firing grenades they bounce off of walls and they kill enemies when they touch him even if they don't touch them they explode after two and a half seconds and damage anyone within range okay great and there you have it we have built a grenade launcher with power bouncing grenades on the next video we're going to cover this sticky grenade launcher as always you can grab the project files from unity code monkey comm if you have any questions post them in the comments and I'll do my best to answer them alright see you next time