in this video we're going to look at a nice simple game I made called wash your hands it's a concept that's pretty relevant nowadays so here I won't play through the game and go through an overview of how the game works you can also play it for yourself on the website let's begin hello and welcome I'm your code monkey and this channel is all about helping you will learn how to make your own games with indepth tutorials made by a professional indie game developer so if you find the video helpful consider subscribing okay so this last week I was dealing with these recent events I came up with an idea and start working on this game now one thing that I love about game development is creating systems with specific roles if you've played my games and you've certainly noticed that they are all very mechanically focused so what I built here is a simple game where we have a nice level and our goal is to contain and eliminate the spread now needless to say this game is obviously not medically accurate or medical advice it's a very very oversimplified simulation of how germs can spread so first of all if you'd like to play to yourself before watching the rest of this video then check the link in the description it goes to a page where you can play the game and below it you'll actually see links to the various systems and elements that are used to make this game that I covered in separate videos so go ahead play for yourself and come back here all right so now that you're back let's look at the game let's play through it and I'll do an overview of how it works so here we are at the start of the game I have my player character and I can just move around now as I always mention in my videos it's very important to write clean code now the reason why I was able to make this pretty complex minigame in such a short amount of time is because I reuse tons of systems that I made previously again check the game page linked in the description which contains links to all of the various systems for example the player movement was made in a previous video the difference is since here I'm working in 3d the character moves in the X and Z instead of the X and one so just one tiny change and I'm using the rest of that class and since I'm using that one sounds so happy Dodger all that we implement so this move probably doesn't make any sense in this minigame but so I left it because it's just fun this video is made possible thanks to these awesome supporters go to patreon.com/scishow to code monkey to get some perks and help keep the videos free for everyone so again here I am in this nice level I can move around the map and you can see there are essentially three areas so there's this down here this one here and this one on the right and then over here we have a bathroom three sinks so the workers are just doing their thing so they go to a desk like this one here then they go to a bookshelf they were around and they roam around randomly so essentially they are moving around all over the place now the goal of the game is to contain the spread so right now as you can see everyone is healthy there are no germs anywhere and all the workers are perfectly healthy and then down here I can access my nice menu and I can make someone sick by pressing a button so click on this and a random one yep there you go that one has just become infected now wherever he is going here you can see that he's spreading some germs and now whenever someone goes through the area where that one has been they also started to get sick and after they spend a long time surrounded by germs and they themselves also become sick they become caries and they start spreading the germs there you go now this one is starting to spread so the infection started with just one worker now there are two and there's a bunch of in fact there is and now there are almost three and so on and so on now as the player we have two actions using the left mouse button we can use a spray so this one kills the germs so as I spread around I can clean up some areas so doing so eliminates the germs on certain positions on the map however he is still sick so he still spreading the germs so the other action that I have is approaching him and pressing the right mouse button and there you go I tell him to wash his hands place a nice cinematic and there he goes onto the toilet onto the sink and starts washing his hands then once he's done washing the hands he can look at the sprite yep you can see that now he's clean and no longer infected so this is the core game loop at work all the systems work nicely together so you can see how just by starting with a single sick worker we can end up with everyone sick so all this started with just one and there you go lots of germs everywhere again this game is obviously not medically accurate washing your hands won't actually cure any sickness but so this is an interesting way of seeing how washing your hands can help reduce the spread now all of these systems working together might seem complex but that complexity comes from combining some very simple rules so I'm looking at how the game was made the first thing you've noticed is the visuals normally I work strictly in 2d but here I went with an interesting different approach what I have here is a 3d world so all of the meshes on the level everything is 3d but the characters are my normal 2d characters so if I pause the game so here I am in the scene view and I can rotate the camera and there we go you can see the effect in action so you can see the characters are on Kabuli flat and then the one is made up of nice normal 3d objects so in this case for melanin level I use to unity snaps packs I cover the entity snaps in a previous video and the packs that I'm using here are the office pack with these tables and computers and things and then also the skull pack with some chairs papers blackboards and sinks there's links in the description if you want to get these packs to play it for yourself so we have our 2d characters working around in a 3d world now the other important element is the camera in order to have this effect work the most important thing is keeping the camera field of view very small now in a normal 3d game you would use something like a 60 fov however here if I try to use a similar fov so let's put it at 60 but if you use that type of fov in here you can see there is a lot of distortion on all the various sprites especially when they are on the corner of the screen so right there that one definitely looks like a 2d sprite so this can still look interesting but I prefer to lower the FOV in order to reduce the distortion by keeping the fov small you can see the sprites don't really stretch as much when they're on the edges alright so that's the camera effect then the last one is the depth of field effect so you can see over here on the top of the screen it's slightly bored this is just a basic postprocessing effect that's included in the postprocessing sack so here it is just a basic volume with a depth of field effect then there's the camera as you can see it is always following the player without using any rotation whatsoever so the rotation is fixed looking down it never changes now the foam oh I'm using the same machines virtual camera and I also covered scene machine in a previous video this is actually super simple all I did was make this cinema scene virtual camera and you can see it as the follow following the player character controller and we just see simple offset and that's all you have to do and it's a very nice simple camera now another part of the visuals are the workers these sprites are randomly generated so they are own pretty unique this is pretty much the exact same code that I used when making general Tycoon so they have a random body face hair beard hair color and skin I covered how this system works in the emotional guest spreadsheets video so go check it out also on the workers you can see if they're sick so here only me use the options to infect a random worker no let's look at that in fact work where is yep there you go you can see he has some green things on top of him and on the other ones you can see they have nothing so the spreads no and this is also increasing so as that one becomes more and more sick you can start to see some green parts appear on top of them now this is him through a very simple shader so I have a point the same shader onto here onto my player character and here you can see on the sheeter oh it has is a simple texture that contains all of those green positions and as I increase this value you can see the green part showing up and starting to glow so it goes up lots of green germs and it goes down it goes back to zero so a very nice and pretty simple effect I've covered a bunch of effects before so check out the phone playlist then over here on the UI I'm showing some stats so in here is the number of infected workers then the number of areas with germs and finally this is the number of empty sinks of ailments so there you go send this one to a sink and it goes down from 3 to and clean up some areas and that one goes down all right so that's the visuals for the game now let's check out the various systems the germ spread is composed of two systems there's the map and then the workers the map is built using the grid system that I made quite a while ago so yet another example of the power of writing clean code when we made a class we made it work with generics so we could use it with any object and that's exactly what I'm doing here I can turn on gizmos and yep just like that you can visually see how the grid is located so all these great positions this is how the map is set up and again I did the same thing that I did with the character control so just instead of having an XY grid I just swapped it for an X at grid so one tiny change and now I can use my nice grid system in a 3d world now each one of these word positions holds an object that has a certain level of infection so here is the code where we are in sin shading a new grid as well as a new grid object so here is our grid object class first when you make our grid we just have our lower left and upper right corners then we come with the width and height in integers our grid size then we instantiate our grid using our nice squared object and then here our grid object pretty much just contains a fault for the various amount then a bunch of functions in order to add or remove that amount then there's the vision which is hemant by a particle system here it is it's just some particles in a cube being spawned moving around randomly and disappearing so there's one of these particle systems spawn per each grid position and then through code we set our emission rate over time based on the virus amount on this great object so if that grid position has zero then this one is set to zero and we have nothing and if it is formed then we set it to value and we have lots of particles just walking around so here in the game I can turn on some nice grid visuals there you go we have some nice debug visuals so here we can see the internal values on each grid position so let's locate one that is infected and there you go as he walks around you can see that the value behind them is increasing so wherever they go they are spreading their germs so like this one is infected and as he moves yep there we go he increases the position underneath them and as the amount increases so do the number of particles so over here one weights 78 they're going lots of particles and here with under one and there you go just tiny amount now the player has a special spray to clear the germs and as I click I can use it and there you go you can see the numbers constantly going down so as I hit the areas that I hit they go down and as they go down the particles also go down so the visual disappears so that's mechanics let's look at how the spray works so here is now the first thing is we're working in 3d and not in 2d meaning that in order to get the spray position we need to actually do array from the camera position so that's what we're doing in here we get array using the input Mouse position then we do a ray cast and we do that ray cast make sure that we hit on the form layer and after we collide we can get the mouse position then here you can also see underneath the mouth there is a nice indicator showing where the mouse is on the world position so for here as I go up you can see that the mouse is not interact with the wall but rather it just hits with the floor so we take our mouse position and the point position then you come later it direction towards the mouse and we use that in order to trigger our spray now the spray also has a nice Perkin system so in here were just setting the position the rotation and we're manually emitting some particles once the input mouse button is down then here in our spray function now this looks complex but it's actually pretty simple again the core of this system is based on the grid system so what we're doing here essentially just calculating a bunch of positions we get those positions in a cone so we apply some rotation to our basic spray direction then we take all of these positions and we convert them into grid positions and then we simply reduce the virus on that grid position so that's how the spray works in a nice cone so there you go I can walk around and clean up all these areas and you can see debug with the numbers all going down down down so that's how this works so here is how the map terms are set up we have a grid system behind it then a grid object holding a simple value and then based on that value we have the particle system visuals then these sick workers increase the underlying map value and the player spray reduces that value all right so now for the workers they're low pretty complex but they're actually quite simple the workers here are using the modular character system that I made in a previous video now in that video I made a module that works with my custom pathfinding system however in here I didn't want pathfinding to be limited to just great positions so instead of that custom pathfinding system I'm using the unities navmesh system so I made a new model that works exactly with that so here is a worker and if you saw the modular character system video then this looks familiar so we're here is the new module that I made using the move position pathfinding on the navmesh then we have the basic move masa T except this one just converted to use 3d and then finally the work in logic module that handles all the various logic now the navmesh is very simple so we can go open our navigation tab and here we can see how our nav mesh is baked it's just a basic unity nav mesh so it's baked and all the walking position so it works pretty well now the only thing that I made was make the toilet have a very high move cost so this is so that the workers don't use the toilet as a shortcut rather go down here instead of through here so to set it I just set the areas an area for toilet and put a very high move cost so that's pretty much it just a very navmesh and here is the pathfinding navmesh move position script and it's pretty simple to the path fighting that I used in that video so the only difference is instead of using my custom path finding over here we're using the navmesh so going to the navmesh come later path then it gets a path and in here it simply follows that path so it's pretty similar to our using modular care system just using a different path filing system then we have the working logic so this one is also pretty simple we just have a basic state machine so it's similar to what I covered in the simple enemy AI video all we have is a handful of states so I don't when his waiting somewhere moving when he's moving to an interaction point then going to tell it when he's going there then while he's washing his hands and you see general busy so that's it we have some very simple behavior when he's eyes only he comes on a timer and then sets a random move position when he's moving he's setting the move position using that other component and then when he gets there he decides what to do and now the interesting thing is over here on the random move position so this is set up in a very interesting way over here I'm looking at the map we can see a bunch of interaction points you can see all of them with this nice diamond icon now we have three types of interaction points we have the desks over here in blue so some desks here and that's here that's here then we have in green the miscellaneous so this one's just looking at that bookshelf looking at that plant at these lockers and so on and then finally the yellow ones which are the sinks so they are all inside of this interaction points game object and here we just have this script so it goes through all these children and fills up the list with all the points now the points also have the type in a simple script so just the base genome so that's misc and toilet and all I did was manually place all of these game objects I rotated them to face the correct direction and that's pretty much it so this is a very designer friendly workflow so then the worker simply requests to the interactions point handler he asks for a specific type that is close to his position and then he gets the interaction point where he's going to go to so then he just swaps out the things so if he's currently on a desk then he's going to look for a miscellaneous and if he's on a miscellaneous or a toilet then he's going to look for a desk so they're constantly bouncing back and forth between the two different types so that's pretty much it for their logic for walk me around now the worker also has a nice object down here and again pretty much all this does is just hones a simple value so if the value is max then he sick and starts spreading and the spread is handled by another class so over here the way that it's set up we have a nice stick update so I'm using the function periodic from the code monkey Tony's so this triggers this function every certain amount of time so every point one seconds we're going to run this function and then here we're just going to do two things first of all at the virus on the position so we go through all the workers and we add a certain amount right where the worker is standing if the worker is in fact and then we go through the workers we check if we have a virus where the worker is standing and if so then we add the virus amount onto the worker so here is in the game and we can open up the debug view so both for the map and for the workers so there give that one it has a hundred so he's come all infected and there you're worried he walks he's spreading and then these ones as they walk over areas that are infected you can see yep their number goes up and as they go up they start showing more and more of those green things and as they go up to a hundred then now they are infected so now as this one moves you can see that he's starting to infect that area and as he moves away yep now he's running so just like that that's how the logic works it's a pretty basic interaction but it seems pretty complex since it's working with other systems now finally we have the action to tunnel worker to wash his hands so from the worker it's very simple he just gets an interaction point of type toilet and then he goes there plays animation and clears his German mount and on the player first we check if there's a worker nearby if so then we show this nice visual and when we rightclick if there we go we have a very nice cinematic it was animation and there he goes in there so this nice cinematic is made using another syn machine virtual camera so we have the camera we zoom in play the animation and do a bunch of things so it's a pretty nice simple cinematic and there you go he goes in there and he does his thing washed his hands and when he goes out yep there you go now he's clean so pretty much here the goal of the game is to get all the workers cleaned up and clean up on the so time to go and then he goes now that one is going to be clean and meanwhile I'm clearing up these areas so it's a nice immolation showing of how if they're always washing their hands and the virus is easily contained but if you let it run around like it is in here then all of a sudden becomes very very difficult to get it under control so right now with 500 areas infected and 23 yep right now it's almost impossible to get back and take everything under control then here if you're playing for something you want to get at this point then over here we have two buttons hardly the default mode but I can turn on and easy and that won't slow down the rate of infection so I can now go through and start clearing up things more easily send them towards their hands and now with easy mode it has become a bit more manual alright so this is the mini game I made given current recent events now obviously this game isn't medical advice or even medically accurate but still one of these simplest things you can do is just wash your hands to prevent yourself from being sick or spreading germs onto others so I really hope you enjoyed this nice little minigame and remember to stay safe during these difficult times this video is made possible thanks to these awesome supporters go to patreon.com/scishow to code monkey to get some perks and help keep the videos free for everyone as always you can download the project files in a Tonys from unity karma comm subscribe to the channel for more ent tutorials post any questions I have in the comments and I'll see you next time