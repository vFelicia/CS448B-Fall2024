this video is sponsored by ad mix in this video we're going to make some simple tower defense AI we're going to have our towers that we can place and as enemies get spawned an approach within the attack range the tower will aim and shoot the towers are also upgradable with expandable range and damage let's begin okay so here is what we're trying to make over here is my tower placed in the map and when I mouse over I could see the attack range of this tower and by pressing a button I can start the enemy wave so the enemy start being spawned and they're going to follow their own path and as they get within the range of the tower the tower starts attacking and firing arrows and the arrows hit the enemies and they get damaged with enough hits the enemies die so I have one tower but I can also easily spawn a whole bunch more towers and the spawning is correctly placed on a grid so we're using the grid system that we created in a previous video and we can visualize it by enabling gizmos there it is here's our grid so it's one another tower right down here and yet there you go now we have our two towers and now we can spawn some more enemies and here they come and as you see the towers are also upgradable so here on the left side we can increase the range and on the right side we can increase the damage so it spawned a bunch more enemies and let's see and yep as soon as I get within range they start getting hit and now they're taking 4548 damage the damage pop ups we're also made in a previous video so check it out and just like this we have some very simple tower defense AI working so you can rightclick to place a whole bunch more towers and now spawn a bunch more enemies and they start coming as they get within range of any of the towers the towers start hitting them and if I want I can upgrade them and so on and so on in order to continue building your games in the long run you need to think about monetization AB mix is a great tool to help you solve that with AD mix you can place unintrusive integrated ads inside of your game so instead of an ugly banner ad you have a billboard right inside your game this is especially useful for monetizing AR and VR content without breaking player immersion and since the ads are less intrusive that leads to a better player experience which leads to higher retention which allows you to make more money so you can keep building your awesome game the tool is extremely easy to use just download the unity plugin and import into your scene you'll see this window where you can select from a variety of sizes and drag and drop the ad mix object into your scene the object is very adaptable so it can fit any surface like something flat or put it around as you can see it's extremely simple to use and having ingame ads is a lot better than annoying banner ads once you've set up all your ads click this button to your website to validate your app once you do don't start generating revenue in under 24 hours so ad mix is an extremely easy to use tool that works better than standard ads unless you start earning revenue immediately go to ad mix start in and download the n mix unity plugin to start earning revenue today thank you to add mix and also thank you to these awesome supporters for making this video possible go to patreon.com/scishow code monkey to get some perks and help keep the videos free for everyone alright so this circle let's get to it okay so here we are in our starring scene all we have is the basic map setup so as you can see the path where they won't take by pressing a button I can spawn some enemies and there you go they get spawned on the corner there and they finally start moving the enemies go through the power through there there and out through there also in here I have a grid setup so if we enable gizmos there you go we can see all of the various grid positions the grid system was fully made in a previous video so check that out and in this case we're just going to use the grid in order to stamp the towers into their position so for example we'll be able to place a tower here one here one here and so on alright so let's begin by making the tower visual here in the project files I have some textures for example this one with a tower let's drag it onto the scene and now let's make a empty game object this will be our main tower and we drag the tower sprite inside of our tower game object so this way we can now easily locate the sprite in order to make sure that it matches with the grid position now let's also add another empty channel game object so an empty one yep and let's call this the projectile suit from position so this is the position where the projectiles will be fired from so in this case let's just locate it right up there at the top of the tower ok so just like this we have a very basic visual setup now let's make the script to handle so let's create a new C sharp script and come with just our tower let's drag it on to the game object and open ok now first let's grab reference to our shoot front position so there it is we just do a transform file and we get the position of that game object so this way we can visually locate it and then we get the position through code and now here let's also capture the mouse click so let's do a perfect boy update inside of our update you just do a simple input get mouse button down left mouse button and just for testing when we click let's use a function from the utilities to spawn a pop up as long as you can download the utilities for free from unity code monkey calm so just like this let's see if it's working okay here we are there's the tower and click and there you go we have our clicks correctly working all right so the tower script is correctly running so now that we have our tower let's fire off a projectile first let's create our projectile so over here I have a simple sprite of a arrow so just drag it onto the scene and yep there's the projectile arrow now let's make a script to control it so we create the new csharp script for projectile arrow and drag the script straight onto it ok now we want to spawn our arrows during runtime so in order to do that let's make our arrow into a prefab so first let's create a folder to form our prefabs and we simply drag the arrow onto it let's rename it PF projectile arrow alright so far so good we have a prefab for the projectile arrow now we want to spawn arrows when we shoot so let's open up the projectile arrow class and in here let's make a simple static function in order to spawn a arrow so private static void called create and in here we want to instantiate you're going to instantiate our PF projectile arrow so naturally in here we need a reference to our prefab and for that over here in the scene I already have a very home phone game assets class this was made in a previous video so this object as you can see it has a bunch of fields a bunch of references and it has this script and this script what it does is we have a static instance and then we have a whole bunch of public fields so in here I can simply add a pony transform for the PF projectile arrow and now back in the arrow script in here I can now access the game assets access these static instance and gravity projectile arrow again I cover the game asset script in detail in another video so check the link in the description so here we can spawn an arrow and let's also receive a vector 340 spawned position so we spawn in there with quaternion identity all right so this should spawn a projectile arrow so for testing let's try to spawn it on the mouse position so first instead of private let's make this public and now go into the tower and then here when you press on your left mouse button let's go into the project down arrow script in order to create a new arrow and a free position let's use the mouse position so here again using another function from the utilities in order to get the mouse little position here is the function in case you want to make it yourself as you can see very simple just grab the world camera and do a screen twirl point on the screen position all right so let's test and see if we see an arrow being in Senshi ated when are you pressing left mouse button the last thing we need is just to film with this reference so we just drag the prefab right in there okay let's test okay here we are and click and there you go there's the arrow correctly spawned right awesome so we have the arrow prefab being correctly spawned in the correct Mouse position now we don't want to spawn it on the mouse position but rather we want to spawn it on the tower and shoot towards a certain position so in this case shoot towards the mouse position so back in the arrow script let's receive a spawn position and then also a vector3 for the target position and now here in our object let's make a setup function just so that we can receive our vector three for the target position and when we create to instantiate and grab the arrow transform then we do get component of this type projectile arrow and then we can call setup and pass in our target position all right so now when we call this function we're going to pass in the spawn and Atari position and now that we have this position all we need to do is make sure that our project our arrow moves towards it so now here we need to ask a question which is how should we move the projector essentially we have two options we can move it manually or we can use the physics system so that's going to depend on your design goals and what you're trying to do with your game here we're going to do the simplest way possible so just manually moving the transform with no physics so just on our private boy update we calculate the direction towards the target position so we have the move direction we move towards the move direction by a certain move speed and after we do let's just check the distance so if we are close enough to the target position then we simply destroy this game object all right so there it is some very simple very basic movement code now we can go back into our tower script and in here now we have two parameters in our function the first one is a spawn position so we're going to use our projectile shoot from position and as the target let's shoot towards the mouse all right so let's test okay so here we are and click any of there you go there's the arrow and correctly goes so let's say click in here and it says it reaches yep it gets the strike all right awesome now we need to fix the speed as well as the rotation so let's do that for the speed let's just increase it and for the rotation let's get the oiler angles all right so there it is for the angles we're using a function to transform a vector three into a Euler angle and here is the function in case you want to make yourself and we just set the Euler angles and since we were working in 2d we only set on D Z okay let's see okay and click any of their yo now we have errors correctly being fired from the tower and towards the target mouse position all right awesome okay so we have our basic tower functionality now let's make it work with enemies now if I'm already set up a simple script in order to spawn some enemies so by pressing a simple key there you go the enemies start being spawn and they start showing up so the script is on this game object here it is here is the script it's very simple all we're doing is first of all making the grid so we have the function to validate it this is just so we can later snap our towers into position and then we just have three different types of waves in different difficulties and on each wave we just find a whole bunch of enemies and in terms of logic all they're doing is blindly following a simple Waypoint so there it is very simple now the enemies are created through this function here it is we're doing pretty much the same thing that we're doing on the projectile arrow so we insensate the enemy prefab and then we do a basic set up and now as the enemies are created here on awake they are added onto a certain enemy list so this is a static list which contains all of the alive enemies and with that over here I have a simple function to get the closest enemy it takes a position and a max range and simply cycles through all the enemies ignores if any of them are still dead and looks for the closest enemy within range so this function is what we're going to use in order to look for the closest enemy to our tower so let's go into our tower script and here let's stop manually firing our projectiles and in here and let's make a function to get the closest enemy now we're going to use the function on the enemy class so get closest enemy for the position passing this transform dart position and now for the max range let's store it in a field so just like this all right so now in our update we can try to get the closest enemy and if it is not know then we have a valid enemy so it's in here that we want to spawn our projectile arrow going to spawn from our shoot position towards the enemy position all right so there it is however like this we're going to have an issue but let's try it out just to see okay here we are and so far it seems good but let's spawn some enemies and here they come and now let's see what happens as they get within range and yep they're going with that that is insane all right so here we are seeing essentially one arrow being fired by every single friend so obviously we don't want to shoot that many arrows so let's add a simple shoot timer so let's make a phasic shoot timer all right so we have a very basic shoot timer coming down with our delta time and if we go under zero then we test if we have an enemy and we reset our shoot timer so there it is very simple let's see okay so here we are now let's spawn some enemies and here they come and as they are within range and there you go the tower start shooting a more manageable amount of arrows all right so far so good so right now there's no damage but the logic is actually working so let's damage our enemies now the enemies already have this damage function it takes in an int for a damage amount and simply spawn some particles and a bunch of things and reduces on the health system so let's use this function let's go back in our projectile and in here we have when the projectile reaches the target position so it's in here that we need to essentially call enemy damage so that means we need to receive a reference to our target enemy so let's go up here and our create instead of receiving a target position let's receive a enemy and we pass around each setup and here we define the target position as the enemy position and now here we can actually call our damage function so here we need the damage amount so let's also receive that all right so we also get the damage amount and in here we use it all right that should do it now back in the tower all we need is the person the enemy reference when spawning our freak out and now we also need the damage amount so let's the final like we did with the range okay we have a damage amount and here just for fun let's randomize it a bit all right that should do it let's test okay here we are and let's spawn some enemies and here they start to come and as the approach yep they start getting shot and there you go just like that they're all being shot and some of them are actually living but yep there we go we have the arrows working awesome okay so here we have our Tower and it's correctly shooting at nearby enemies now let's make a simple mini great system alright so here in the tower we already defined a field for the range and on for the damage amount so it's going to be very easy to manipulate these let's make some functions to do that all right so here let's do very simple functions just modifying our simple fields which again are then using this function and up here in this function now let's go into the editor to make our upgrade visual okay so in here let's create an empty game object let's call this the upgrade openly so this is the object that we're going to place on top of the tower in order to upgrade and inside let's add a sprite with this section here now it's made two buttons to upgrade and one button to close all right so there it is now here for the buttons I'm using the button scrap script which is also part of the code mock utilities it's just a simple sprite base button in order to capture Mouse interactions since this is a sprite it's based on doing breakins so we require a simple Collider alright so here we have our upgrade overlay game object we're essentially going to place this right on top of a tower in order to upgrade that tower now let's make a script for this so a new script and just attach it okay now open it first let's make some very basic show and hide functions so just set the game object to true or false okay and now on the show let's also receive a tower that we're going to show on and when we set it to true we also set the transform doubt position to the tower transform position so it's right on top of the tower and now in order to make this script easy to use and let's make a static show function all right so here it is we just have a static instance we set it on awake and we have our show static function which in calls the instance oh this is just so we have this function that is very easy to use now we need to do is call this when we pass the mouse over the tower so back in the editor let's unlike the tower and apply a box Collider onto it all right there's the collider and now we can go into the tower script and in here we can implement our own mouse enter function this gets triggered when the mouse passes over the collider attached to this object so in here let's just go into the upgrade overlay in order to call our show function and pass in our tower alright so just like this it should be working let's test okay here we are as I passed the mouse over any of there you go the overlay shows up alright good now let's just implement the functions for the buttons all right so here it is but awake we simply get the button sprite component and we set the colic function to these connect functions so in the hide reason behind on the upgrade range you simply call the functions to upgrade our tower and then we just have another function or to update the visuals all right so let's test okay so if you're and there's the tower and now place the mouse over yep there you go now we can see the home range all right very nice and we can also increase the range so by clicking the button and there you go the range actually does increase and this one also increases damage so if I spawned some enemies right now and we look at them and here they come and as soon as they get within range yep there you go they start getting shot and they take tons of damage let's keep increasing and there you go a lot more damage and a much bigger range all right so just like this we have our tower fully functioning with its own upgrade overlay awesome now finally let's just make our basic tower spawner now in order to spawn our tower it's going to be very simple we already have our tower all we need new is convert this into a prefab and then spawn that prefab so to make it a prefab just drag it on to the prefabs folder yep there you go and now it's going to the script that we're using to spawn our enemy so this one and in here we can easily add a spawn Tower function so first let's test for the input get mouse button down what's this for the right mouse button and we spawn a tower all right so there it is just like that so we're doing pretty much the same thing that we're always doing so we're in San Shi a ting grabbing the reference by the game assets and responding it on the mouse position which is being validated using our grip okay so that's it very simple and it should be working let's test okay so here we are and we have no towers now let's place the mouse in here and right click any of there we go we have our tower correctly spawned and if we spawn some enemies you don't see that tower is fully working so here they come and as they get within range if there you go the tower starts firing and there you go taking down enemies all right great and again this is working with our nice grid so there you go it's perfectly located in there now let's place another tower right here so rightclick and if there you go now we have these two towers and they are individually upgradeable so let's find some more enemies and we hide our gizmos and there you go now taking out that and me that in me and so on any of their going with that very nice so now just two towers are enough to handle these enemies we can spawn a whole bunch more enemies and then we can try upgrading the tower so let's increase the range on this one and this one as well increase damage by quite a bit and these are way too many but yep there you go over here we have our system working so here we have a very nice simple tower defense AI working so we can place towers just by rightclicking and there you go we can place a whole bunch of towers the towers get placed don't look for enemies within range and if there are some then we simply attack them the towers also have a very nice mini upgrade system in order to increase the range as well as the damage so again here it is a very simple tower defense ai mini game thank you to add mix and also thank you to these awesome supporters for making this video possible go to patreon.com/scishow t code monkey to get some perks and help keep the videos free for everyone as long as you can download the project files in utilities from unity code monkey comm so start to the channel for more unity tutorials post any person have it accounts and I'll see you next time