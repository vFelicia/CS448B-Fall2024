this video is sponsored by hosting er in this video we're going to make a very simple bus fight it will have multiple stages and increasing difficulty I've used this system in both the FPS game and the topdown shooter games and make reasonable let's begin our goal here is to make a really cool phosphite with various stages boss fights can be really unique so after you follow this video and make your own super cool unique bus fight then you can make a WebGL film to share it with your friends and host it on a website which you can get through hosting her hosting er provides bestinclass hosting services that are extremely fast and very affordable with excellent customer support to help you succeed choose from a variety of plans and pick the one that best suits your needs making your website from scratch can be hard but hosting er makes this much easier by supporting WordPress which is a few clicks you can use the auto installer to get WordPress installed on your website then you can pick from a giant selection of templates to quickly get started and then customize the website to exactly as you want it here for example I have easily built a simple website by customizing a template when excellent WordPress feature is how you have these buttons to swap between desktop table and phone this points so you can rest assure that your website will look great on any device also if you're making some really cool online integration for your game then check out their super fast and affordable cloud hosting solutions all the plans come with a 30day moneyback guarantee so you can try out the services without any risk go to hosting air.com slash code monkey and use the coupon code monkey to get up to 91 percent off yearly web hosting plants click the link in the description and succeed faster using the link help support the channel so thank you to hosting her and also thank you to these awesome supporters for making this video possible go to patreon.com/scishow to code monkey to get some perks and help keep the videos free for everyone ok so here's what we want to make I have my player character that I can move around and shoot and now inside this door I have the boss battle area so as I go in there we go there's the boss battle he's a nice turret and as soon as I go in the door closes behind me and he starts aiming at me and tries to shoot me some enemies also get spawn as you can see and if I deal enough damage shoot and their yo now we enter into the second stage of our bus battle and we have more and more enemies being spawned as well as some shield transformers in order to stop the possible being shot ok so I took out all the Transformers and now the boss battle is vulnerable so now I shoot him and now there go now we have another shield that we need to take care of so we are now on the third stage ok so as I take out this transform there you go now he's vulnerable in the final stage and as I shoot him and shoot him again and there you go all the enemies die instantly and the battle is over alright so that's very intense but it's very nice and now in here the enemy drops a key as he is dead so now I can pick up the nice blue key and I go in I open the door and I go in I have my nice trophy I pick it up and I've won this nice mini game alright awesome if you haven't seen it yet then go play the topdown shooter game I made recently to see this must fight in action in a complete game in the page where you play the game you can also see links to all of the elements used for example you saw me using the key door system as well as the animated alpha line effect so what we're going to build here is similar to the battle system we made previously this boss battle is essentially a more expanded version of that concept now boss fights are very tricky to show in a tutorial video because each is so unique so here we're going to make a specific type of boss fights but what I want you to learn from this is how to think through the logic rather than follow this exact format as long as you understand the core logic behind how to set up multiple stages you can then apply it to your own unique boss fights alright so this is our goal let's get to it okay so here's our starting scene I have my player character and I can walk around I can aim and shoot over here is the enclosed enemy bus area so this is where we're going to have our nice boss fight okay so first of all let's just place the enemy turret prefab over here I have the prefabs and let's just play see turret right down the middle alright let's see this in action ok so here I am and as I approach the turret yep there you go he sees me starts aiming any start shooting all right so far so good now let's make our boss battle so here let's make a new csharp script call this our boss battle and let's make a new game object and attach the script on to it okay now here let's start off by just identifying when the battle should start so for that we can use the same logic that we use in the battle system video so checking the description if you haven't seen it yet in that video we created a simple script to capture physics triggers so here we're going to use the exact same logic so here is the script we made in that video as you can see it's very simple we just have a ontriggerenter 2d to test if the player enter the trigger and if so then we fire off this event so back in the editor let's make a game object to hold our trigger so let's drag the script onto it ok and now we just need to add a box Collider 2d and make it is trigger and let's also set the lair to ignore recast so it doesn't walk our shooting and just like that we have our trigger working so the player Center is this area it won't trigger that event on that script so now we can go back into the boss battle script and here let's have a feel for our trigger and we simply subscribe to that event and in that event let's start a battle and after we start let's unsubscribe to that event so we don't start the battle multiple times alright so this should be working we just need to drag our reference so here in the editor with the boss battle we just try V reference in there ok alright so let's test so here I am and as I approach and enter the trigger if there you go we have our star town alright awesome so here we have another great example of the power writing clean code this script is very basic and only focused on a single task which allows us to easily use it and reuse it in many scenarios ok so we have our start baton working now when we start and let's spawn some enemies so we're here already have a bunch of enemy so let's add a film to reference our prefabs so here in our script with certainly just one and here in the editor and let's drag our reference let's use the archer enemy okay now let's make a simple spawn enemies function and now we need the position so for now let's just try a specific point and after spawning we need to do them like we did on the battle system video which is they have this enemy spawn script this is what enables a nice the some of effect and then makes them active so we simply call the spawn in order to actually spawn it okay so now when we start our battle let's also spawn an enemy so as we enter our trigger we should be able to see an enemy being spawn let's see okay here we are and as I move up and enter the trigger and if there we go there's the enemy being spawn and now he's fallen chasing an attacking right great so now that we can spawn and me in a specific position let's spawn it in a random position instead so back in the editor let's use some simple game objects to identify our various spawn positions so inside the boss battle game object let's make a new empty game object call this our spawn positions and inside let's add a bunch of game objects which won't represent the various spawn positions that the enemies can spawn so just one so for example let's say an enemy can spawn in here in order to visually see them we can go all the way appear to the inspector and select an icon so let's say this one and there you go now we can visually see and now let's place all of the spawn positions alright so just like this we have a whole range of spawn positions now that we have them all placed let's grab them through code so in our boss battle script let's make a list of vector threes for our spawn positions all right so first we construct our list and then we cycle through all the children inside our spawn positions container and we simply add them to the list all right so now we have a nice list of vector threes for all of our spawn positions and then down here when we are spawning an enemy let's grab a villain spawn position all right so we simply grab a random position from inside of our list so just like this we should be able to have our enemy spawning in random positions and now just for testing let's try spawning a bunch of enemies constantly so for that we can use a class in the utilities as always you can download the utilities for free from unity code monkey comm and in the utilities we have the function periodic which automatically triggers a function every certain amount of time so this is perfect in this case let's call the function spawn enemy and let's call it every let's say half a second so every half a second this function will be triggered which won't spawn an enemy on a random position okay let's test okay here we are and as I move up and there you go the battle has started side in here and see if enemies are being spawn any up there's one there one there on there and they're spawning all over the place not one down here and there and there all right so awesome now we have way too many enemies but if they are all being strong automatically in random positions all right so now that we have the start of the battle and the enemies beings fun let's handle these stages for our boss battle so the first thing we need to do is define what stages are based on so in this case we're going to make it based on the torrent health now one of the elements that make up the turret is the health system this was actually my very first video on the channel and I'm using that class here so again that tells you the power of writing clean code so first in our boss battle let's add a field to grab our turret so then we access the turret we get the health system and now let's subscribe to the on damage event so this event is fired whenever the Torah takes damage so when that happens let's see if we should go into the next stage so the handle our stages let's make a simple state machine so all the way up here and let's define a new alright so we have an enone for all of our stages including our waiting to start stage we store them in a field and by default we start on waiting to start and when it takes damage and let's see if we should go into the next stage so here if the turret is under 70% health then we want to go into the next stage so let's make a function to handle moving to the next stage all right so here we're doing a simple switch on the current stage and we're going to the next one so if we're waiting we go to stage 1 for stage 1 go to 2 to 3 and so on so on the start button we can also use this function since when we start we're going to be on waiting to start so we start the next stage and we go from start to stage 1 and then here when the enemy is under 70% health then we go into the next stage do the same for all the others and actually we don't have on the stage 3 since that's when the enemy has died so here we cannot subscribe to the other than so when the turret dies we have the boss battle being over all right so here our logic should all be working let's just add some debug long so we can test the sound now so here we should not have defaults since we don't want anything to happen on stage three so get rid of that one and down all right this should be working let's test okay so here we are and as soon as we enter the trigger yep there yo starting battle so we start battling we went to stage one now as I shoot him and once he goes under 70% there you go Stage two and now shoot him some more and under thirty and he's on stage three and now killing and there we go he's done and the boss battle is over all right now let's also make sure we destroy all the enemies when the battle is over so let's make that function in here just call it destroy all enemies now in order to destroy them that means we also need to store a list of every time we spawn an enemy so over here we have a list of our enemy spawns and down here we cycle through it alright so here we just cycle through the enemy list and we kill the enemy and we make sure that we added when we spawn an enemy so we just need to call destroy all enemies over here when the boss battle is for all right that should be working let's see if all the enemies die when the boss also dies okay here we are let's move up and there you go the battle on starting enemies are spawning there's the enemy push it down to 79 15 keep shooting and once he goes boom there you go all the enemies died instantly alright awesome now we still got another issue which is enemies are still being spawned so let's stop that over here on sarvatma we're creating a function periodic in order to spawn every enemy once per second now this class already has a very easy way to stop it which is I can assign a function name and then when the battle is over I can call stop all functions with a certain name so that should stop the other function let's see okay so here we are and we go in and there you go the battle start shooty turret and just one more there you go they all died and now let's see and yep no more enemies are being spun alright awesome okay so our boss fight is coming along nicely now let's have the shield system to stop the player between stages all right so I've had this yield now I covered how the shield vision works in a shader graph tutorial so go check that out so as you can see we have the shield and connected to it we have two transformers and in the shield we have the shield field script this one contains the links to the Transformers as well as the lines that go to it so here is the code for the shield field as you can see it's pretty small just 18 lines long one start we subscribe to the on destroyed functions so whenever a shield transformer is destroyed it goes into this function it destroys all of the power lines connected to that transform and we test the form of them are dead and if all of them are dead then we destroy the shield so that's it's some very simple logic so here in the editor I have to shield setups so the first one only has two transformers and the second one has four transformers so what we're going to do is enable the shield whenever a stage changes so let's go into the code here in our boss battle script let's go all the way up here add some references for our heels so I have a reference for the shield one the co2 and onstart and let's start them hidden so both shields are disabled and then down here when we have the start next stage when you go from stage 1 into stage 2 let's enable the first shield and from 2 to 3 in a only second one all right so all this should be working we simply set the game object to active and then all DC logic is handled by itself and when transformers are destroyed the shell gets destroyed and platon and continue shooting the turret which goes into the next stage ok let's test ok here we are and let's go in and there you go the battle starting no after I take him under 70% there you go the shield pops up now we have transformers now shut down and yep he's gone now I can shoot the turret again once he goes under 30% there we go now we got some more some more and way too many enemies but let's keep and yep they're all gone no she don't and there you go they all died and I won the nice boss battle alright so here we have multiple stages working with our nice shield system awesome so as you saw the game became quite a lot difficult that's mainly because the enemies are being spawned every second so after a while the player can get massively overwhelmed so let's make it more of a smoother difficulty curve first of all let's set a maximum to how many enemies can be spawned so on the spawn enemy function well let's cycle through the enemy list to count how many are alive all right so here we have some very simple magic we're just going through the enemy spawn list seeing how many are alive and if more than a certain amount are alive then we're not going to spend any more and we simply return from this function okay so for testing let's put this lower and see if we can no longer spawn more than three enemies let's test okay let's go up and there's one there's two there's three okay let's see if any more get spawn and nope you don't have any more spawn enemies all right awesome so we can now limit how many enemies we have at once in order to make sure that our difficulty stays more stable okay now let's set a limit back to something more reasonable so let's say like seven and then down here let's also randomize the type of enemy so to do that let's add two more films for over here so we have the enemy shooter archer and charger and now let's spawn them at different rates depending on the difficulty so let's get a random number between 0 and 100 okay so here we have some very based logic we get random between 0 and 100 by default we choose a Archer then if a number is under 65 then we choose a charger and if it's under 15 then we choose a shooter so we have a 15% chance of a shooter than a 50% chance of a charger and a 35% chance of an archer all right let's test okay let's go up and start the battle and there you go there's a charger there's an archer and let's see if we there's a shooter right there alright so we now have three different enemy types between spawn awesome now the game is still very difficult so let's add some health pickups I already have a simple prefab in here very simple just has a script for a health pickup as well as the circle monitor set to trigger so we need to do is in Senshi 8 this prefab so for that let's go up here add another reference okay we have our reference to our health pickup and now let's make a function to spawn it and we're going to do pretty much the same thing that we did with the enemy so we're going to get a random spawn position and we're going to instantiate our prefab all right so we just want it on a random position and now let's also make a function periodic to trigger this one all right this should be working let's test okay here we are let's go up and there's an enemy there's our turret and let's see any of there we go there's our home and if I pick it up and there you go I get some home right awesome so we now have random home pickups being spawned in order to keep our difficulty a bit better but it still is quite insane so let's make sure that difficulty starts off slow and increases as we move on to different stages so here for example on start let's spawn two enemies as soon as it starts and let's spawn the enemies much slower so in here on let's say every four seconds then here we have the next stage from stage one to two let's find a bunch more all right so here we have a bunch of enemies being spawned make me a nice increasing difficulty curve so the first one we spawned to you directly then one every four seconds as well as the nice health pickup then until we serve the health pickup then the enemy then we spawn an enemy after a half second one and a half four point five and so on and on the end one we spawned this much okay let's test ok so here we are let's see and since I go up there you go the battle has started and now we have one enemy in there and another one in there so as you can see now it's much easier so now I can try taking them all out there we go now we are on stage two and we got more enemies being spawned ok so it's getting more difficult okay so here we are on stage two and as I take him down and we go into stage three and there you go more she owns more enemies more things so now it's getting a lot more difficult there we are and we have a ton of enemies and as I take out the sentry gun and there you go they all die instantly and we went a nice boss battle alright awesome so everything is pretty much working knowledge is polish this up a bit at the door on start and a door on exit as well as a nice trophy okay so here in the editor I had this door down here then this door then we also have a key let's place the key on top of the enemy and then we have a nice trophy the door and Q are made in the door key system video so check that out and now let's make some logic for example for this door to close as soon as the battle starts to do that let's go into our bus battle and make some events okay here we have when the boss battle started and on the bus battle over okay now let's make a script to connect these onto our doors so let's make a new script all right so here we have a very simple script we have a reference to the door the key game object and the boss battle on start we hide the key game object then we subscribe to both the events on our bus battle when the boss battle starts we close the door and we set the call to red then when the boss battle ends then we show our key game object so again this is how we're doing a lot of connections between a lot of different types of objects without any of them knowing about the other so the boss battle knows absolutely nothing about doors or keys or anything okay let's test okay so here we are and there's our nice door being open and as soon as I go in the battle starts there you go the door closes automatically now we have our boss battles so let's take care of it all right let's go kill him and boom there you go he's dead and yep there's the key and spawn automatically and now I pick up the key now I have the blue key and over here we have the blue door let's use it open it and now we have our nice trophy and go in and we won this nice mini game all right awesome so just like this we have our complete nice and simple and boss fights again as I said boss fights are very specific and each is completely unique so instead of following this directly I hope you learn the logic for how to create your own custom boss fights so the logic for how to set out multiple stages with multiple actions multiple events and everything so now go ahead and make your own unique boss fight thank you to hosting er and also thank you to these awesome supporters for making this video possible go to patreon.com/scishow t code monkey to get some perks and help keep the videos free for everyone as long as you can download the project from Zinni some buddies from unity called monkey comm subscribe to the channel for more unity tutorials post any quick