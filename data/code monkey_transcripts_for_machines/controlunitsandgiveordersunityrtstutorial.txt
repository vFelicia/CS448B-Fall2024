in this video we're going to make a simple RTS control system we're going to handle unit selection and control draw a selection area and give the unit some orders let's begin hello and welcome I'm your code monkey and this channel is all about helping you will learn how to make your own games with enough tutorials made by a professional indie game developer so if you find the video helpful consider subscribing okay now I already cover this topic once before however it was in a video focused on the dots and ECS in here we're going to make this internally using game objects so here's what we're going to make over here I have a bunch of Units some of them sending I don't know I can leftclick and yep there you go you can see that this unit is selected and I can right click in order to give them a move order I can also click on empty space and if there you go it's is selected and I can no longer give orders I can also click and drag in order to select multiple units so now all of these are selected and I can recollect any of there you go they own winter and as you can see they all go into different positions so I can some like the whole ten of them tell them to move and they all go into a dynamically calculated position so each position is calculated depending on the number of units that are selected so I can select any group that I want and if there you go they're not overlapping so here is a nice base for a simple RTS you can expand upon this to add any type of order that you want like for example grabbing items attacking enemies constructing buildings and so on so here we're going to handle our basic RTS controls and then c2 in for an upcoming video we're going to add some actions and really cool custom animated cursors based on what the mouse is hovering this videos patreon sponsor is bad adventure bad adventurer is a game development duo currently working on their first game Wayfarers edge it's a RPG focused on exploring and settling unknown frontier lands in a low fantasy and Wild West theme check them out at bat adventure comm thank you to the patreon sponsor and thank you to these awesome supporters for making this video possible go to patreon.com/scishow code monkey to get some perks and help keep the videos free for everyone alright so over here is our cone let's get to it okay so here we have our starting just the simple character standing around I don't so I cannot select it or do anything all right so first of all let's make our script so a new C sharp script let's call this our game RTS controller and let's make a game object same name and attach the square okay now in here let's first do a private void update and then update and let's test for get mouse button down on the Left mouse button so button 0 and in here we're going to grab the mouse wheel on position so for that I can use a function from the utilities which is almost I can download from unity calm calm so using the utilities and in there there's a function to get the mouse warm position so we get it and then let's just store it on a simple T all right just like that and then we do a input get mouse button up on the same left mouse button and then in here and let's do a debug log on both positions all right so we should be able to see the wall with the correct positions let's test okay so here we are and what's pressing here move to here and release and you've there you go there's our two correct positions awesome alright so back in our code now since we have our positions we can now do a simple test to test if something is inside of that position and for that we're going to use the physics so we're going to go into physics 2d in order to call overlapped area on so this will return all the 2d colliders within a certain area so in here we can pass the start position and this current mouse born position now this returns an array of toilet or 2d so these are all the colliders within that area and now let's just the way for each alright so we just suck on through it and do a lot so we should be able to find out all the objects within our selection area what's test okay here we are so if I press here and let go in here yep it's empty so nothing but if I press here and let go in here if there you go we found our unit here in the editor you can see that the unit has a box on either so this is how we are detecting it so with this our logic is working click here and let go in here and yep it's empty but click here and let go in here and you've there you go there's the unit ok great so we now have our game objects within the solution area however we also need to identify them for example here is a rock which also has a Collider and if I press in here and let you in here if they're your we identified both of them now obviously we only want to select units so let's identify our objects for that let's create a new C sharp script and this one we're going to call our unit urk yes let's select the unit prefab and drag the script on to it okay so for now let's leave this script just like this and back in our control over here when we are cycling let's set up a list of all our selected units so up here let's make a private list of type unit RTS this will be our selected unit RTS list and we're going to initialize it on our awake and now in here when we are cycling through all of our colliders now the first thing we're going to do is clear our list then we cycle through them we try to get the unit RTS component so we do a get component of type unity RTS on each Collider and then we simply test if the unit RTS if it is not known then that means this commander has our components so we add it to the list all right so just like that then for testing let's do a debug log on the selected count and for testing in here and let's also duplicate our prefab put it in here ok let's see ok so here we are with our two units in our Rock now first of all I click here and what's going here and yep zero nothing is selected now click here am I doing here yep we have one selected now let's also include the rock and yep just one so it correctly identified that the rock is not a unit and I'll click here and let go in here any of their ego we have to alright so far so good we have our unit selection working now let's add a nice visual so for that let's open up the unit prefab and in here let's add a new sprite renderer call it our selected and in here I have a nice texture yep just like this so we're going to show or hide this depending on whether the intestine lighten now let's go back to our unit RTS component and in here we're going to have a simple game object filmed for our selected game object and then we're going to grab it on our away alright so we grab it by doing a transform file and we get game object and then we have a function to set the eave is ability and we simply set the game object whether active or inactive now we need this go back into our RTS controller script and in here before we clear our own list let's firstly select all of our objects so we cycle through all the unit Arceus in our selected list so we deselect all of our units and then we select all the units within the selection area so here we set this unlike visible to true alright so that should be working now finally by default let's just keep it on hidden so on awake we also do sets unlike the two phones okay let's test ok so here we are and they're all normal now click in here and let's go in here yep nothing now coming here and let go here yep so like now and click here and let go here yep some like that one now click on empty any of their go both the selected all right so we can now visually see which units are selected awesome now let's get to work on actually making the selection area visible so back in the editor let's create a new empty game object let's call this our selection area and then inside it we're going to create a new sprite and for the sprite version let's select the white pixel so here is as you see it's literally just a onebyone white pixel and now in here with the child we're going to offset it to the side and upwards by doing this we're essentially modifying the apparent pivot so now the parent pivot is on the only one left side so we're going to do is we're going to place this object on the lower left side of the selection area and then we're going to scale it in order to find the correct size okay so let's do that now back in our RTS controller the first thing we need is a reference to that selection area transform so let's add a sterilized film we have our field and back in the editor we just write the reference okay and now first of all we're going to start off with it hidden so on a week let's go grab the game object to set active to false in order to hide it okay and then when we press the left mouse button down we're going to show it so set active to true and when we release then we're going to hide it again okay so that's the visibility now we need to scale and position that accordingly so let's do a if our input get mouse button so this one returns true for every single frame whilst the mouse is held down so it's in here that we're going to take our selection area transform now we're going to set the position and the scale so for that we need to come late the in lower left and the upper right positions okay so we're common leaning the in lower left we're essentially doing a method min on the start position X and the current Mouse position X so we get in lower left and the upper right then we're going to position it on the in lower left and we're going to scale it based on the difference all right that should be working let's test okay so here our and the selection area starts off invisible okay now I click here and drag and yep there you go there's a selection area perfectly fitting the correct position and I can drag from left to right and right to down and if I go and I select these to give their yo correctly selected right awesome now let's just make the selection area top and tinted in green alright so here it is now it's in green and shows up on top all right awesome so here we have our nice selection area so now that we can select various units now let's give them some orders so let's give them a move order now here in the unit game object the setup for this unit is based on a modular character controller that I covered in a previous video so here you can see the various modules that this character has so it has a movie any movie ssin direct component we're going to use this module which won't take our character move it to a position directly and we're just going to call this function so on our unit RTS script let's do a public void call it move to so we get the component of type move position and then we set our move position again go check out that video which covers in detail how we made this nice modular system so all we need to do is simply call this function so let's go back into the RTS controller and in here let's add another if for if in this case input get mouse button down on the right mouse button so button 1 and in here let's I go through all of our selected units and we're simply you need to tell them to go towards the mouse position all right so just like that so let's test ok here we are and first of all if I right click yep nothing happened since no Yenta selected now let me select this one and right click any up there you go he gets the order and he moves to the target position now some like this one itself give the earth any of there they go correctly in there now some like both of them quick and yep they both go to the same position right great now as you can see we have one issue which is that both of them are going in to the exact same position so let's solve that by calculating multiple valid positions so let's first test that out with some fixed positions so let's make a list of vector three all right so here we have a simple list of positions all in a nice line and now when we second through them let's send them to a specific position all right so we cycle through them and we give each of them a different position on the list so let's test so here we are and select both them and tell them to go any of their ego they went to different positions all right great now let's add some more units all right so we have a bunch of units now select them all click any of their ego they each went to account elated position all right so when we really need to do is dynamically commonly in a bunch more positions so let's do that now we're going to come late valid positions around a certain circle all right so here it is essentially we take a start position along with a distance for the circle and eternal number of positions then we second through all of our positions we can lead a different angle for each of them depending on the index then we apply a simple rotation in order to convert that angle into a direction and then we construct our final position based on the start position was the direction times the distance so now up here we can use this in order to complete our target position list so we get position list around our move to position within this and seven let's say ten F and let's come late five positions all right so let's test alright here we are let's select all of them and right click and if they're going like that all of them went to a different generated position around a nice circle awesome okay so here we have valent positions now let's just make a bunch more circle so we can control tons of Units all right so just like that we receive an array of all the ring distances an array of all the ring positions and then we simply do an ad range and we use our function so up here and let's use this one instead so we're going to have a ring at a distance of ten lists of 20 and distance of 30 and 40 positions all right so this should be working let's test back in the editor and let's generate a ton more Guinness okay so here we are and we can sell some like just one and just move it around and now select all of them and put them all in the same position and yep there you go they all go go go and if they're this alright so each of them went to a different position and here we have all of them and it works very nice so I can select all of them some like just a bunch just ease so like just one just one and move them and yep there you go nice controls all right so here's our RTS controls all fully working we can click the select a single unit and then right click the town to move somewhere then we can click on empty space in order to deselect and then we can click and drag in order to make a selection area to select multiple units and rightclick to tell them all to go and they each go into their own calculated position so just like that over here we have a very nice RTS control system so I can select whatever units I want and give them some move orders you can expand upon this system to add any type of order you want like for example grabbing items attacking enemies constructing buildings and so on stay tuned for an upcoming video where we're going to add some actions and some really cool custom animated cursors based on what the mouse is hovering this video is made possible thanks to these awesome supporters go to patreon.com/scishow natee code monkey to get some perks and help keep the videos free for everyone as always you can download the project fanzini tony's from unity karma comm subscribe the channel for more unity tutorials post any personal incomes and I'll see you next time