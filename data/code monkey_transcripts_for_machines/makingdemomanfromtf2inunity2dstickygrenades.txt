hello and welcome I'm your code monkey and in this video we're continuing to make the demo man from Team Fortress 2 in unity we're going to recreate the sticky grenade launcher it will fire sticky grenades that we can then manually trigger to explode let's get started so I have the scene here from the previous video with my given man walking around and firing bouncing grenades they bounce off walls and they explode when they hit enemies we're going to replace that with sticky grenades that we can explode on command okay so let's start off by creating a new prefab and name it PF sticky grenade we're going to add first a sprite renderer and drag the sticky grenade sprite then we're going to add a rigidbody to Dean leave it with no physics material set the mast to one when you're dragged to three angular to gravity to zero since this is in topdown perspective add a circle Collider 2d set the radius to about one point three yeah about that a little but smaller than the actual sprite and let's make it a trigger so it doesn't constantly fire events okay so we have our basic prefab want to make the script new csharp script name it sticky renamed now in here our code is going to be very similar to our bouncy grenades so we're going to start off with a static creator and we can actually just copy it from here copy it instead of getting a prefab for Consular now and let's say it's the prefab for sticking her name we're also going to receive a spawn position a target position and using system an action that won't take the factor 3 that won't be triggered on explode this won't be a sticky grenade and rename all this too sticky or night ok great now let's create our setup function so going here where I have all this let's make our member variables so an action which won't take a vector3 called on explode action okay so in here we have our target position the action that will trigger an explode we have the move direction point it towards the target position based on our transform position and we got our move speedin we are setting the velocity now for our bombs grenades we were just setting a basic mu speed but for our sticky grenades we want to have a bit more control over where they're going so we're going to set the move speed dependent on the distance to our target so let's calculate hello distance will be vector 3 dot distance between our transform dot position and the target position and for our move spin we're going to make it based on the distance and let's say multiply it by 4 that makes it a very nice number now we want this to have a minimum and a maximum Cemetery math F dot clamp and we're going to clamp this value between let's say a minimum of 50 and a maximum of 250 okay so this way if we click close to the character it's only going to fire for a short distance if we click very far away to into fire with a high speed and let's also add some angular velocity so game object I'll get component a type rigidbody and let's set the angular velocity let's say 1000 F so it's going to go in clockwise motion since this is a sticky grenade we wanted to stop moving when it actually hits something we set up our circle Collider as a trigger so we're going to go into private void on trigger enter 2 D now when we actually hit something we want to stop moving so let's make a private void stop moving and in here in order to stop moving we're simply going to destroy our physics object destroy the rigidbody2d and also the circle Collider 2d so this way when the trigger is called it won't destroy the physics objects and don't just stop in place and there's an effect let's also add the simulated vertical movement from our bouncy grenades so we can grab exactly the same code go in here and so just set the private ins bomb state set the bomb state to zero and there you go okay so this won't just simulate vertical movement so let's go into our Kim Hanul script and spawn a sticky renamed I have here the same thing from the last video and in here on shoot instead of spawning a bouncy grenade I want to spawn eight stick you learn it it takes in the same parameters but let's switch out the prefab so the prefab for the sticky or name and go up here now the precon for the sticky for a name go back into our scene at the reference to our sticky grenade prefab and on the prefab let's add our sticky grenade script okay good let's test it out and see if the green is being spawned okay so as you can see the C grenades are being correctly spawned when they hit an enemy they stop in their current position if they had a wall they do the same thing and we have the vertical simulated movement we've got some angular rotation and works great and as you can see if I can look very far away it gets fired quite far but if I click close to my character it only fires a little bit okay now we actually want it to explode so let's do that back into our code here we're going to trigger the explosion on a right mouse button click so in here let's set up a private void update and if input dot get mouse button down of mouse button one which is the right mouse button when you hit that in here we want to explode so in order to explode all our grenades we're going to leave that responsibility to this sticky grenade class so we're going to go into the see grenade and create a new function that won't trigger the explosion on every single grenade so we're going to call it something like explode all grenades okay so let's go and make that back in here we're going to make a poly static void explode all our names so in order to explode we near the reference for all of our grenade so let's make a profit static list of sticky grenade and call it sticky grenade lists and in here when we create our grenade we're going to first of all initialize the list if it is no equals in you list and we're going to add our new sticky grenade now in our explode we are simply going to do a for each for each sticking our name and our sticking with name list you're going to have a function called explode grenade and then we're going to clear our list okay let's make our a close we renamed go down here private void exploit grenade and here we want to destroy our game object and we want to trigger our function on explode action with our transform.position okay so when we call this function it's going to trigger exfoli grenade on every single grenade and then reset the list and every time it's created it gets added to the list and own least itself gets instantiated if it doesn't exist yet okay great everything is looking good so let's go and test it out back into our scene and see if it's working exactly as intended I have my wall there I can fire the wall and boom my exponents in fire the enemy boom there he goes okay as you can see we can now spawn and trigger boom and they all explode okay so there you have it we have created our sticky grenade based on our previous bouncy grenade we made it stopped moving when it hit something set to move this and stays on where we click and make home grenades explode on command on the next video we're going to cover weapon reloading and limited ammo as always you can download the project files and utilities from Unity code monkey comm if you have any questions post them in the comments and I'll do my best answer okay see you next