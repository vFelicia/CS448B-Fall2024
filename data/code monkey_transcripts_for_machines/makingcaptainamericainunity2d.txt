in this video we're going to create Captain America and his shield in unity 2d let's begin hello and welcome I'm your code monkey and this channel is all about helping you learn how to make your own games with nf2 torrents made by a professional indie game developer so if you find the video helpful consider subscribing so this is our goal I'm currently controlling Captain America here I can kick and punch enemies to kill them and I can also do a nice dodge roll so I kill them do a dodge roll and obviously I can throw my shield I can throw it I can recall it and punch them dodge out of the way and throw it again as you can see the shield is somewhat smart and if I hit one enemy it automatically tries to target different enemies it also is using physics so I can throw it into the wall and it bounces off of it just like that and the whole thing looks very nice very satisfying and the code is very simple alright so let's get to it here we are in our starting scene so I'm controlling Captain America with some simple movement and there are enemies being spawned I can also do a dodge roll to dodge out of damage I've done videos on the character movement and dodge roll so check my links in the description to see how it works and all these enemies they move towards me and they try to attack me ok so this is the starting point now let's get to work on making the shield so here in the editor room let's first make the shield game object so an empty game object call this the shield add a sprite renderer need to drag the Shum sprite I have in here ok now let's add a circle Collider 2d make sure that it matches the size of the shield and a rigidbody 2d since we are in topdown we set the gravity scale to zero okay so this is the basic setup for our shield now let's make the code in order to throw it so here we are on the Captain America player code here is a bunch of code to handle the simple character in order to handle move dodge rolling and so on so we don't need to worry about any of this we just need to be able to test when we should throw our shield so we go here into our update and in here and let's just do a simple if to test for a right mouse button click so we do it input dot get mouse button down and we need an index for the right mouse button so in here the left one is on zero and the right one is on one okay so when we press on the right mouse button let's throw our shield so for that we need a reference so let's go up here make a civilized feel for a private transform for the shield transformer so here in the editor just drag the shield reference okay now back in here when we go on our rightclick lets first place the shield on top of the players so we take the shield transformed our position and we put it on this transform that position okay and then we want to use the rigidbody that force in order to throw it towards the mouse so first we go into the shield transform in order to get the component of type rigidbody 2d on the rigidbody we have our add force function and now in here we need a vector two for the direction that we're going to throw so we want it to be towards the mouse so for that I'm going to go into the utens class which is part of the code monkey Tonys that you can grab for free from unity code monkey comm so in that there's a very nice function in order to get the mouse world position so our vector three for the throw direction will be the mouse world position minus the current transform dot position so in here we need the force so the throw direction was we also need a float for the throw force let's s the number can we add it as impulse okay so that should do it and we should be able to now throw our shield whenever we press on the right mouse button let's see okay so here I am now if I right click and let's see the shield and if there you go it went towards new maps okay awesome so far so good now the shield is going to have some logic to it so let's make a simple class instead of heart everything on the player class so in here we make a new csharp script this will be our shield and let's drag it onto our game object so just drag it in there okay so here on the shield code and let's start off by making a function in order to throw it so we make a public boy throw shield and we receive a vector3 for our direction now in here we're going to do very much the same thing we were doing in our testing so let's go here and copy this so we modify our transform position then we use this as our throw direction and we use our transform getcomponent now in here this is meant to be the player position so let's go here define a serialize film for our Captain America reference now we set it in the editor just drag it on there okay so with that we can simply go in there and get the position and now back onto the Captain America class in here we need a reference for the shield so let's do that instead of having a reference to the French roll we have a reference to a shield now we drag this on the editor track the reference okay and now down here on the right mouse button we go to the shield and we call throw shield and now we need a direction so let's calculate that and that's pretty much it so let's s and we should be able to see the exact same thing that was happening previously so here we are and right click and if there goes this yield okay great now that we have the shield being thrown let's also add a nice little effect so we want to add a nice trail so for that we can simply add the trail renderer and here we just modify this okay so here's our trail runner we just keep it visible for half a second it starts off very big and then it becomes very small and starts off only white and becomes transparent so let's see it in action so here we are and when I throw the shield yep there you go a nice trail follows it okay awesome now that we have our trail looking very nice let's make our shield Rico so we can throw this young and then get it back so here on the shell script let's make a recount function so a totally quiet recon and now in order to recon we need to move the xian towards the player so to do that we're going to set the velocity pointing towards a player on update however we need to know when we should do that we don't want the Recon code to run while the shield is being thrown so let's go up here to define a new for all of our various states so in privately known for the state and the various states this can be used with player so when the shield is on top of the player throne which is when the shin has been thrown and finally recalling now let's use these states so when we call throw shield let's put the state so we go up here to define a variable for a private state state and here we set these states to be staked out wrong okay and when we recall we started to state that recall now let's do a prayer void fixedupdate since we're dealing with our physics do a switch on the current state case we are on state dog recalling then we want to set the shell velocity towards the player so let's also go up here make a front boy to wake in order to grab our reference to the rigidbody so a private rigidbody 2d and we grab it in here and here on the throw shield we use this instead of always grabbing the reference okay and here we set the velocity and now we need direction for the player so a vector three for the clear to player we also need a smooth for the you recall speed and finally we need to test when we are close enough to the player so we do a if vector 3 dot distance compliment the distance between this transform dog position and Captain America Valiquette position if that distance is under the grab distance up here a float for the grabbed distance if we are within grab distance then we grab our film so we set the state to be state dot with player when we do we also set the velocity back in to zero so it stops moving and we set the original to Kin ematic so it doesn't collide with anything so rigid body ok so this is our code for recalling our script and then let's also do a friend void late update so this runs out there every update so we do a switch on our state in case we are on the state with the player then we want to shyam to be on top of the point so we move the transform position specifically we're going to put the shield on top of the body sprite so in here we go into the Captain America and we get the body position all right so this should be working just one last thing is when we do through our shield we need to set is kinematic back into Thomas so the body becomes dynamic ok so on the player we call through shield it throws the shield from Captain America towards this direction then on the player we can also call recon when we do we set the state to be recalling then on the fixed update if we are recalling then we complete the direction towards the player we moved the rigidbody towards it and when he's within grab distance then we simply grab it and keep following the player now let's see how we're going to come recon from the player so here we are on Captain America's class and we have our right mouse button in order to throw our shield however instead of always drawing let's use the same button to work for both throwing and recon so in order to do that we need to ask the shield if it's with a player or it has been thrown so here on the shield let's add a public ball is with player as in will return if the state equals state that with player and also appear on our awake let's set our scoring state we start off recalling solution automatically goes to the player okay and back in this class so here first we asked if the she on that is with player if it is with the player that means it can be thrown so we throw the shield and if not we go into the shield and we call recon all right that should do it so let's test and see if we can recall the shield okay so here I am controlling Captain American as you can see the shield is indeed on his back now here we have an issue with regards to the trainer it shouldn't be active while stationed this flying so we will sort that later but for now let's try to throw the shield so here I am I press on the right mouse button and there you go there goes the shield notice you on the stop now I press again and yep the shield is being recon so I can throw it and I can recall it and it's constantly phone ok awesome another issue that we can also see is with these sprites we want the shield to look like it's always on its back so in here right now it's correct it's on its back however if I go up it's still behind sprite so we need to modify the sorting order depending on whether the character is facing down or up so let's on that first the trail renderer so we go up here and we grab a reference to our private trainer renderer here when the player grabs it we set the trail render not enabled into phones and when we throw it we set it to true okay so that should do it for the trail runner now for the sprite sorting order let's go into our lake update and here on the whit player well let's modify the sorting order so first we ask the Captain America class if it is facing down so if Captain America dot is sprite facing down if the sprite is facing down then we want this bright to be behind it so we need a reference to the sprite renderer and here we set the sorting order to be on the Captain America that gets sorting order in this case we want to be behind so minus ten and if not we want to be in front so what Stan okay son let's see if the shield is always on its back and if the trail render is disabled once he's with the player so here we are in first move and yep there's no trail render and now I found facing upwards if there you go there's the shield one is back and facing down and yep it's on its back okay great now one issue we do have right now is with regards to the recon so if I throw the shield there you go see shield is in there and if I go right on top of it as you can see he does not grab shield I still need to press the recon in order for him to come back let's make the grab automatic if Captain America is close enough to the shield so for that let's go here test case state throne so if the she own has been thrown let's do a Sencha the same tests that we're doing here on our recon where we test the grab distance in order to ground so in order to not have duplicated code and let's put this in another function so here a prep boy try grab shield and we're just going to copy this code and we call this function so again here we define a graph distance we test the distance between this transform and Captain America's position if we are within the graph distance then we simply ground so we run it on recon and also when the player has thrown the shield now another issue we might have with this is that maybe he grabs it the second that he throws it so when we throw we can simply push it further away than the graph distance so in here before we do this we put position on the get position well as the throw Direction multiplied by a grab distance so let's define the grab distance up here so a private consult for the grab distance and here we use that one instead and here we use that one as well so this will make sure that on the same frame that we throw this young but we don't grab it okay that should do it let's see okay so here we are now let's throw the shield there he goes now I go near it and if there yogi grab the shield now I can throw it again and if I want recon and if I don't I can just go to it and grab it manually and throw it again okay awesome now since we are using physics to move our he own that means we can easily add some walls to bounce around so here in the editor and let's make some walls over here I have one as you can see it's just a simple sprite renderer with a box Collider so let's put it here and try throwing the shield directly onto the wall okay so here we are with one let's throw the shield onto it and see if it goes there and bounces away and throw and yep it didn't work the shield went towards the wall and then slid alongside it so that means we need to make our shield bouncing so for that we go in here we create a new physics material 2d let's call it bouncy and in here you can check the friction and bounciness so we set the friction to zero and botanist to one and we just drag it as a physical material on the original for our heel just like that okay let's see here we are let's throw and if there you go I can throw the shoe and it bounces back okay so just like that we can also do some really complex throw okay great and the Recon was also using physics so if I go into the other side of this wall and I try to recall as you can see the shield can't quite make it this is very much a design choice maybe you want the recall to go through the walls maybe not if you do then you would simply do the recall the same way that we did with the player make it kinematic and modify the transfer on that position directly but in this case I like this behavior it feels good if it's a way I need to make sure that you can reach me okay great so now let's add our enemies again and try to take them out with a shield so here is the enemy prefab that we're using as you can see they already have a box Collider with is trigger enabled so we can use that trigger in order to trigger collisions and damage the enemy so let's go into the shield code and here we add a private void ontriggerenter 2d so this function is called whenever this shield is colliding with another Collider now in here on let's test if we are colliding with the enemy so we try to grab the enemy reference from the collider and if it is not now then we have hit an enemy so in here let's knock him out okay so this should be working in order to make sure our enemy dies when he gets hit with a shield let's test okay here we are and there's an enemy let's try to take him out and I throw the shield any of their ego the shield hits him and he gets knocked down and I can grab the shield again well it's right hitting on the wall so here on the wall throw bounced around yep there you the enemy done okay great so we can now through the shield the shield collides with the enemies and causes them damage which causes them to die so here we have a bunch of enemies I can punch them I can kick them I can throw the same there they go I can still take them out or the shield that won't recall punch this one punch this one get it and yep quick and you also dies on the recall if I throw recall any of there you go okay great now it would be quite awesome if we could make the shield hit several enemies at once so some sort of auto target let's do that so here in the shield when we hit an enemy let's look for enemies that are near down so for that one the enemy handler class has a function where I can get the closest enemy so the calls us to this position and within a certain range so if there is another enemy near this one let's modify the shield velocity in order to go towards down one so first we grab the magnitude of the current velocity so it keeps going at the same speed so it float throw spin which will be the current rigidbody2d dot velocity dot magnitude then let's complete the new direction and then we set the rigidbody 2d dot velocity to be the new throw direction multiplied by the same throw speed okay so let's see if we can hit several enemies we just want throw okay so here we have three enemies now if I throw my shield onto this one the shield should then automatically target one of the others so I see I throw any of their ego he went from now on down and then didn't have enough speed nor to reach the last one but yep exactly as soon as he goes he hits one and he tries to hit some more so here for example there behind the wall now I throw it any if they're going headon three by doing a nice bounce of that won't hit the first one then automatically target the others okay so we have successfully made sure that our shield can hit multiple enemies at once however here we have another issue which is that the shield is currently acting kind of like a mine so if I throw this yelled in here and then I wait for the enemies to go through it as soon as they step on it they die that is not what we want so let's work on essentially we only want the shield to cause damage if it has a certain amount of speed if it's just standing there we don't want it to damage so in here on the on trigger enter function all we need is the task the magnitude of the current amasing so we grab the magnitude up here and if we do hit an enemy we're only going to run this if we are within a certain threshold so shield won't cause damage if it's going at a bigger spin than this if not then it's considered to be idle just standing around the map and it doesn't cause damage let's see here we are they're chasing me let's throw the shield in there and let's see if they step on it and what happens and they step on it and nothing happened because the shield is idle now I grab the shield now if I throw it if they go on three of them to damage since the shield was moving fast when you touch them so we have pretty much all of our shield logic working now let's build a nice simple map and randomly spawn our enemies okay so here we have a nice simple map with a bunch of walls let's test and here we are with our nice character moving him around I can punch the enemies and there you go I can throw the shield if you don't hit that one then it went that one I know there's another enemy and I can still roll out of the way so punch this one punches when wrong the right punch throw Rico throw again recall throw again and yep everything looks very nice everything is a nice system the logic for the shield is working perfectly fine throw multiple and it feels quite satisfying and the whole system is quite nice so as you can see here we have created a very nice simple mechanic that is quite satisfying to play with and as you saw at the illogic isn't very complicated we just throw the shield move it in certain directions recall it into a certain direction and we also have basic attacks basic movement and so on as long as he can download the project on Zinni tony's from unity code monkey calm if you liked the video subscribe to the channel for more ent tutorials post any questions you have in the comments and I'll do my best answer me alright see you next time you