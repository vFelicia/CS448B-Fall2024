in this video we're going to look at how layers and bit masks work how they're relevant to physics and cameras and how to use them we're also going to look at the userfriendly version that is the layer mask let's begin hello and welcome I'm your code monkey and this channel is all about helping you will learn how to make your own games with indepth tutorials made by a professional indie game developer so if you find the video helpful consider subscribing okay so here's what we want to learn in this video I have this nice character here that I can move him around and as you can see he is pointing towards the in Mouse position if I click I can shoot and over here on the floor you can see some debris and if I move towards it you can see that I can push it around okay then over here there's a crate which acts like a solid object so I cannot go through it and if I should you can see that my shooting interacts with the crate however in here in the debris my shooting goes past the debris since it is on the floor and then in here I have a nice teammate and in front of him a zombie and if I shoot there you go I don't want my game to have friendly fire so my shooting is correctly ignoring him and only hitting the zombie alright so these are all the interactions that we want to make so let's learn about layers physics bit masks and layer masks so game objects are placed in layers and that impacts various systems in unity over here I have the player game object and if we go here in the inspector you can see that it is currently on the layer player if I click on the drop down you can see all the layers that are defined in this project layers are used for many things like for example for camera rendering soon here I have my main camera and in here you can see the culling mask and if we click it we can see all the layers that the camera is currently rendered so right now it's rendering everything as you can see over here my player D friendly the enemy the crate and debris and if I go here and I untape the player there give another player he's still there but he's now completely invisible so the camera no longer renders anything that is on the layer called player so with this you could have for example different cameras rendering different objects and doing some sort of postprocessing or catching a screenshot without a background so that's one of the possible uses for layers another one that is very important is when dealing with physics so we're here I have this great object and if we inspect we can see that this one is on the layer objects and here if I move my play which is using the physics system and I try to move and there you go I cannot go through the box however I can go into edit project settings and over here is the physics 2d and in here you can see a very nice layer collision matrix so this is what the finds if a specific layer interacts with another layer so in this case let's go down here and locate the player and then in here and locate the objects and now one take and let's say that the player and the objects should not come on so let's see that Here I am and I move any of their yo now I can go straight through the box so with this you can customize layer of physics interactions as much as you need right awesome so that's the basics of layers now let's see how we can interact with them through code over here is my player script how it works isn't relevant to this video but it's relatively simple all that matters is over here an update function and all its doing is handling the movement and the shooting so here you can see when I press the left mouse button down I play the shooting animation and I do some effects so I see that so here I am and I press an yup there you go there's my player shooting now in here let's try to shoot the crate and there yo I'm shooting right over the crate the reason is because we're not doing any ray casts we're just showing the sprite directly towards the mouse position however we do want our bolts to hit something so let's deal with that over here in the shooting code let's do a nice spray cast so ray cast we go into the physics 2d and we simply call ray cast this one takes an origin so let's use the gun endpoint position then takes the direction so let's use the aim direction and finally takes a distance so here on which calculate the distance between the gun endpoint position and the target position alright so here we have our recast being done and this one returns a ray cast hit 2d which contains information on what happened with the right so one of the things that it contains is the ray casted 2d we can check if it has a compiler so if the colonizer is not known then that means that we hit something and if it is known then we hit nothing so if we did collide into something let's make sure we modify our target position to match where it actually hits them so we set the target position to be on where we hit so on the rake has hit and we can use the point this contains the point on the collider that the rake has hit all right so just like this we should be able to see our shooting correctly hit the crate let's see okay here we are now she's normal yep stonework should the crate any of there you go as you can see I cannot shoot past the crate if I click behind the crate there you go all in there down here you know goes and hit okay awesome however you can already see an issue which is yeah it works right on the crate but over here I have some debris and the goal is just to step on it and push it away what if I shoot and there you go they are acting as hit boxes as well now the Brie are meant to be on the ground so they're just visual so that I can push them and the bullets are meant to go past them so this is where only your interactions come in we want to be able to hit the crate since it is a high object but the debris on the floor we want to be able to shoot over it over here you can see the layers aren't really nicely set up so the creighton here is on the objects layer but the debris is on the either Brina layer so we want our ray cast to hit things on the object layer but ignore the ground debris layer now back in the code in order to do that we can go here inspect the other versions of the raycast and there yo one of them takes a layer mask so this is what we need to use in order to identify which layers we should collide with and now in here there are two ways we can do this one is very simple and editor based and another is more complex and code based so let's start with the simple all the way up here let's define a serum ice field and this will be of type layer mask and let's call it a layer mask so this is the default unity stroke that already contains a default editor script so we can go back to the editor and in here on the player script we can see right here the in layer mask and if we click there you go we have a nice dropdown where we can select a bunch of layers so here we can someone just like we did for the camera so in this case let's hit everything except the debris layer alright that should do it let's test ok here we are now let's click and okay shooting normally still works click on the crate and yep I'm hitting the crate and out debris any of there you go I am shooting over the debris so there you go I can push it around I can shoot over it and it hits on the crate and if we pause we can go here and modify it now let's say hit the debris but do not hit the objects and we see and there you go the debris is hitting and the objects are going past right awesome so here you can see how the own layer mask is extremely useful for easily setting the layers that you want to test however it definitely helps to understand what sort of magic is happening behind here now the way it works is with what is called a bit mask so essentially this layer mask gets converted into an int you can see here on this function that indeed we require an int now an int as you may know is made up of four bytes which equals 32 bits and if we go here onto the layer inspector you can see it's not a coincidence that we have exactly 32 layers so this is the reason why an int as 32 bits which means 32 ones and zeros and the math simply set certain bits to one and leaves the others at zero so over here we can add a nice debug log to see the binary representation of our current layer mask so we do a debug down log so let's visualize the own layer mask in binary and there it is exam like that you can see only one bit is set to one and that is the objects layer so we can count it from the right so 0 1 2 3 4 5 6 7 8 9 and if we pause and go in here there go our objects are need only or not so you can see exactly how a layer mask works behind the scenes so now that we know how they work let's see how we can do them manually now the way we're going to do it is by using the bitwise operators you have or and not exclusive or and shared these allow us to do logic working with the underlying bits so in this case let's define an int for a bit man and the easiest way to collide with a single layer is we take the value 1 and we shift it to the left by the number of the layer so our objects were on layer 9 so we shift to the left by nine okay so let's test this and use it in here okay let's see and here you can see the in layer mask is indeed correct exactly as previously and if we shoot we can shoot past that and we hit on the quick right awesome now let's set up the bit mask to hit both the crate and eat debris so in here you can see the crate is on layer 9 debris is on layer 10 so in here the way that we hit multiple layers is by doing an or so we shift the one by 9 or we shift the one by 10 so if you know how binary works or just basic logic gates you know that an or won't return a one if either position is one so that means that using a 1 we are essentially adding to our bit mask so we're going to have a 1 on the position 9 and 1 on the position 10 let's see ok so here it is and you can see indeed we have two ones example like that so we can shoot and hit the crate and shoot and hit the debris all right awesome so now let's see how we can make shooting everything except the crate and debris so the way that we do that is by using the nut bitwise operator which is a tilde so what essentially this does is flip all the bits so we're first going to do what we were doing previously which is the objects layer or the debris layer and then we are simply inverting the whole thing so we should be able to see our bit mask form of ones except for two zeros let's see and there it is exactly as intended we have everything for ones except those two zeros so we are not going to hit the crate not going to hit debris but we are going to hit our teammate and also our zombie all right great so this is pretty much how you create layer masks using bitwise operators so now that you understand this you should be able to understand how the only your mask works behind the scenes as always it's programming there is no magic involved everything has a logic to it now in here let's define our rooms so in here I have to find it in order to hit everything except on the debris later so let's see and here it is and if I shoot yep I'm hitting the crate okay everything's good now on debris and yep I'm shooting over the debris so I can push for the debris and hits the crate okay great however we have one issue over here I have my teammate and I don't actually want to have friendly fire however if I click yep there you go my poor teammate is getting hit before I can hit the zombie so for our rules we want to hit the crate but not to debris and the enemy but not be friendly so we're here we have our layers so we want to hit layer 9 the objects but not hit layer 10 which is the Bree and then we want to hit layer 12 which is the enemy but not differently which is 11 so here we want to make sure that our recast hits everything except on the debris layer and the friendly layer so let's try doing this using the and bitwise operation so let's first start off by hitting everything except on the debris layer so we do one shifted by the brain layer and we invert this alright so here we have a bit mask with one on everywhere except on the debris layer and now we also want to not hit on different layer so we use the end and again we do the same thing we invert a1 shifted by the friendly layer so when doing an end as you know it only returns one if both are one so we're either one is zero they won't have 0 all right so let's see if this is working we should be able to hit everything except the debris layer and the friendly layer ok here we are moving on let's see the crate yep we are correctly hitting the crate let's see the debris and we are correctly going above the debris all right and we getting so push great and on let's see here if we're going to shoot our friendly or the enemy and click and there you go we are now hitting the enemy and our shooting is ignoring our friendly right awesome so here we have all our room set up now again let's just use the Unity provide molar mass to achieve the same result so here on the player on layer mask let's make sure that we hit everything except on to the brain and except on the friendly so here's our own layer mask and let's see and yep we can shoot the crate yup we shoot above it and let's see here my friendly and there you go I can shoot Class D friendly so just like that all of our rooms are correctly working so the owner masks are really easy to use and now you know how they work behind the scenes with knowledge of layers layer masks and bit masks you can now play around and meet some really interesting physics interactions or really cool effects using cameras and separate layers as always you can download the project files in utilities from in Tacoma comm subscribe the channel for more unity to terms post any questions you have in the comments and I'll see you next time