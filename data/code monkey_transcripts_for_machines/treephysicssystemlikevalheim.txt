hello and welcome i'm your code monkey so lately i've been playing valheim this is the huge hit of the moment i even made a video on 14 game design lessons you can learn from it and one of the reasons why the game is so successful is because the simple actions are so satisfying one of those actions is chopping down trees you hit the tree with the axe and after enough hits the tree gets cut and split into a stump and a log and then the log starts falling down with accurate physics then as it falls down it can also hit other trees and damage them and if there's enough damage then those also fall down and so on and so on and of course if you happen to be unlucky enough to be below the tree as it falls then you're a goner this is actually really easy to make and it greatly improves the feel and believability of your game so let's see how we can do that in this working demo that i have here let's see it in action and then inspect the code that makes this work it's super simple but before that do you want to learn how to make games from a veteran in the games industry then check out this video's sponsor jason wyman who makes some great game development courses they are all extremely detailed and very well planned with expert life support whenever you need help as a special deal you can get the code monkey course bundle which includes not one but all three courses for the price of one it's a great guided path that will teach you how to make games from beginner to advanced learn all about csharp with the programmer course then master unity along with all of its tools and finally dive deep into the code architecture course where you will learn how to structure your games and write good clean code to help you make even better games jason is a veteran in the industry with many years of experience working on large teams and very complex triplea projects through the course you also gain access to an exclusive discord server where you can chat and share ideas with fellow students also as a bonus if you pick up the course bundle through the link you get steam keys for all of my games as a nice free bonus along with a mug hoodie and discount on future courses so if you want to learn how to make games check out the link in the description so here is my working demo showcasing this system i've got my basic character with some simple actions making the logic for all of this was actually very simple what took the most time to build this demo was really just finding the assets and animations to make it look good so i can see all the trees around me and if i approach them and i attack i can start chopping them as soon as i hit you see the damage popups i actually cover that in another video and when i deal enough damage the stump gets separated from the log and now look at that it starts falling down so the tree fell down as you can see it's using accurate physics so i've got the stump i've got the log and the log is now stuck on another tree and now if i hit the log it won't break into two pieces so hit it hit it again there you go the log breaks in two pieces those fall and so on and now if i hit one of these pieces now they get completely destroyed and the stump as well if i hit it i can also hit it and just basically destroy it so all this is really just some super simple interactions and a bunch of prefabs so i hit it i deal enough damage and then the tree gets cut they start falling down they start dealing more damage following some more and there you go so it's just some basic interactions but it looks pretty great here is the exact same demo just without the visuals so you can see just the logic in action without any distractions so i've got my linux character i can move around i can approach and i can attack this stream and since i do it gets cut and split between the stump and the log and the log starts falling and as it falls down any collisions that happen deal damage so i cut it down and if it happens to hit another tree then deals damage to that tree and if they hit enough they might cause that other tree to fall down and so on then on the unlock parts if i hit them and the unlock half just vanishes and same thing for the stumps if i don't damage then they just vanish so super simple logic okay so let's see how it works by the way if you find the video helpful please hit the like button it's a tiny thing but it really does help thanks the first thing to do is to identify where i'm actually hitting so for that here is my player script it plays the animation and at a certain point in the animation i have this function being called so what this does is it finds objects within a hit area for the hit area it uses a game object reference right here this is how i can position it in the world so here in the editor i've got my player game object then inside i've got the actual character and then inside i've got the root and i've got my hit area right in here so i can move this around if i want to have the player damage a different position then on the logic as you can see i'm doing a simple physics overlap box which returns an array of all the colliders within this area and then i simply cycle through all the colliders and then i try to get a component of this type i3 damageable this one is an interface and here it is it really just has one function i covered the interface in detail in another video so go check it out they are super useful essentially they let your code work with the interface instead of a specific object type so on the logic that i have here works both for the tree as well as for the tree log the tree stump the tree and log part and so on as long as the object implements that interface then it works with it so the physics cast looks for all the objects with that interface and then simply calls the damage function then just spawn some particles make them look good and also a damage popup which i covered in a previous video so that's pretty much it for the players you can see just a physics cast and then calling a simple function then over here in the editor i can inspect each three individually so there you go this is my scene and then on each three it has a simple capsule collector just a solid object a solid collider and then it has this tree script let's see it so here the first thing you see is that it implements that interface and then you also see that this tree has a health system this is the same system that i made on the very first video on this channel so i've got the health system then i also have the type so these are the various types that make up the whole tree system so there's a full tree there's a log there's the logs turned in half and there's a simple stump so i'm just using these types just to be able to reuse this script on every single one of those objects and for the health system itself then down here we simply have the function from the interface so just damage and pass it on to the health system then when it takes enough damage the health system fires the on that event and over here for the normal tree just spawn some particle effects then spawn the tree log as well as the tree stump so here in the editor we can see how the prefabs are set up so here i've got my prefabs and for example let's see the three so there you go it's got the tree visual it's got the things that we just saw then i've got the tree log so this is essentially the fog log as you can see it has the same tree script just has a different tree type over here just a basic gnome it's got a rigid body and a capsule collider so this is how it falls down with physics then there's a prefab for just a stump and another one for the unlock split in half so as soon as the tree is hit it gets converted into a tree log and a tree stump and essentially just the particles act like smoke so they kind of hide the transition so here in front of me i got a tree and as i hit it i hit it once twice and three times and there you go you see the particles they had transition and it gets constructed into those two prefabs so here that's really all it does just spawn the log above a certain offset using the transform up so just it's a bit above and then just adding a bit of randomness to the rotation so it actually falls down if it is perfectly on top then it doesn't actually fall so just a bit of randomness and that's pretty much it so next the tree log here as you can see it has a capsule collider and the rigid body and then it also has a physics material this is in order to give it just a bit of mounting so if i select there you go bounciness is set to one we can see what it looks like if i just remove it so if i remove this and see so if i go and i try to chop down the dream and as it falls down let's see the difference that the bounciness does so as soon as it falls down yep with that that's not very satisfying so as it goes down yeah it falls just like that whereas with it on if i chop down the tree there it is it falls down has a little bit of a bounce it looks a bit more natural then again the log has this same script so the log the tree and the stump they all have the health system and they all implement the interface and then down here there's a bit more to this system this is the on collision enter so this is the function that is fired when a collision happens between two objects so here when a collision happens it checks if the object that it collides with also has the tree damageable interface if so then it also tests for the relative velocity magnitude so this is how fast was that collision just so that if it's a light tap it doesn't actually cause damage so it needs to hit with a bit of velocity so when that happens just randomize the damage amount spawn a damage popup and deal damage based on the interface so using this function it can deal damage to another tree another log or another stump or anything and then up here when it dies that's the only thing that changes based on the tree type so if it's a tree it spawns a log in a stump if it's a log it simply spawns two half logs if it's a half log then it just gets destroyed and the stump just gets destroyed so here as i chop down the trim it gets spawned into a log and a stump and as that log starts falling down if it takes enough damage if i hit it and yep there you go it converts into two hot logs and then the halfway takes damage and just gets us right simply for the stump hit it and it simply gets destroyed and over here for the player it is also implementing that interface so that's how that works as the tree when it hits with a collision the player also has this so it also deals damage to the player so if i'm here and i start chopping down a tree then i put myself below it okay so let's see as it falls down and yep it also damages the player so here you can see the power of using interfaces so i've got about five different object types in here and they all use the same interface so they all work as part of the same system without having to rewrite too much code and with this you can see just how simple this whole system is it's just an interface to make it work and it just has some very basic rules just spawning a bunch of prefabs and a bunch of particle systems just to hide the transitions and yep look at this so here we've got a forest and it all works pretty great then some more things over here on the player for the animation it's got a simple animator and then over here on the attack just listening to the mouse button and sets the trigger on the animation and since i also wanted to make this demo work without any animations i made the hit function based on a timer instead of directly linked to the animation then for the camera shake as you can see over here i've got a serialized field of type cinemachine impulse source so this is the tree shake and over here when i've got a hit i do tree shake and generate an impulse so that screen shake is over here on the player and inside i've got this object and as you can see it has the same machine impulse source so this is how you can very easily make some screen shake using cine machine and for the camera itself over here is the syn machine free look this one is set up using orbit so that i have a really nice third person camera and then down here it simply has a cinemachine impulse listener so everything here is pretty standard and then of course there are all the visuals so this is what took the most amount of time in doubling this demo so most of it is from an environment asset pack so all the trees on the floor the rocks in the background and so on then i use another one for the character itself there's links in the description in case you want to see the asset packs that i use here and then finally there's the post processing volume so here it is the volume with all of these effects so everything is pretty standard so here with all the effects on and with all the posts crossing off so as you can see post processing by itself does a huge huge difference so just put it all together and over here is the working demo i've got my character i can move around i can attack and start chopping a tree i deal some damage and with enough damage if there you go the tree starts falling down it falls down with accurate physics then if it hits something else then it also causes some more damage and if there's enough damage then the other trees also fall and so on so i can chop it all down and the whole forest starts falling down and looks pretty satisfying certainly a lot more satisfying than if you just hit a tree and suddenly you get some wood in your inventory so i can cut it i can destroy it and yep this whole system is very simple and it works pretty great so if you just add a simple item inventory system on top of this then you would have a nice working minigame so as you can see adding all of this is actually a very simple thing all the logic is very easy but if you've played valheim then you know what a difference it makes if that game just had trees vanish instantly it would not be as satisfying as it is and it would not have found as much success as they did and don't forget to check out jason wyman's courses with the link in the description get the code monkey bundle and enjoy all of my games as a free bonus alright hope that's useful check out these videos to learn some more thanks to these awesome patreon supporters for making these videos possible thank you for watching and i'll see you next time