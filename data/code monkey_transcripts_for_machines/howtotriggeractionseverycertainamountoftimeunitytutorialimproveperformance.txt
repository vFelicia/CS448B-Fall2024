hello and welcome I'm your code monkey and in this video we're going to create a time text system let's get started all right so a time Tech system is an easy way to run game logic periodically but less often than on update for example let's say you are making an RTS where buildings say time to construct or they generate resources after some time you could do all the time where calculations in each specific object which would be somewhat wasteful or just subscribe to a on take event and store the number of ticks that way you only have the update time or logic on one object which helps performance so in here I have my empty scene and in my code I have a simple building object class in here in the constructor it takes a position it creates a game object as a sprite renderer gives it a basic sprite and it spawns a construction bar that we're going to use to display the construction stats the world bar is part of the code monkey utilities that you can grab from unity code monkey comm and in my game handler I am simply spawning a building on 0 so let's see how it looks ok there you go you see a basic tower sprite and a construction bar all right so now on our game handler let's make a building on mouse click so let's come this out and here do a private voice update and if input I get mouse button down mouse button 0 so on left mouse click let's make a new building on the mouse position in order to do that I'm going to go into the UTS class which is part of the code monkey utilities and get the mouse world position all right so let's see if we are spawning buildings on mouse click ok there it is one building now that another and so on ok I can now spawn buildings good so now let's make our time.take system go into the scripts and make a new C sharp script name it time tick system so in here let's write our code first of all we're going to need a private end for our current tick we're also going to need to store the time during this tick so a private float take timer and let's also make a timer max which will be a private cons well tick timer Max and let's put it at point point two F equals 200 milliseconds which would mean five ticks per second we're making it Const since we want this to be a constant and never change so on our private void awake let's set the tick to zero and no one private boy update let's increase the tick timer by time.deltatime if the tick timer is bigger than tick timer max then we're going to reduce it by tick timer max increase the tick and just for testing let's go up here do using code monkey so we can go down here and do CMD bug text pop up which will pop up a text object on the mouse position and let's say tick and display the current tick all right so we are increasing the TEC timer by the delta time which is the amount of time that has passed in this frame once it goes over take time or max so every 200 milliseconds we reset the TEC timer we increase the tick and we make it pop up just to see what the value it is ok so now we can go back into our scene and make a new game object and let's name it time tick system and let's drag the script on to it all right so let's test and we should see the pop ups yep there it is you can see the pop ups we're getting a tick every 200 milliseconds so 5 ticks per second ok great now let's make an event that won't trigger every time they take increases go into our code and we're going to make a public static so we can subscribe to the event from the class name and it will be an event of type event handler and we're going to call it on tick the event handler is part of the system namespace and we want to send the tick as the event arguments so let's go here make a public class on tick event args which implements event args and inside we're simply going to have the public and for our tick and this event handler won't send of the subtype Quantic event arts so we can send the current tick okay great so now down here when we are creasing the tick letters fire that event so if it is different from now so if we have subscribers to this event let's send it with this sender and nuan tick event arts with the tech equals this tick alright so the event is set up when the tech increases it fires this event so that someone can listen and do something about it like for example let's remove the popup from here and we're going to put it on the game handler so here let's subscribe to the event going to the time tech system dot on Tech we're going to subscribe it gets an object sender and a time take system dot on tick event args and the on take event args has the tech inside the on take event are so Y dot Tech in here all right so let's s and we should be seeing the exact same thing as before yep there you go the time tech system is firing off the events the game handler is capturing it and displaying a popup all right so now let's make the construction code to see the time tech system in action in the building coding here let's also receive an end for the ticks to construct this is the amount of ticks that it takes to construct this object let's store it as a very long so private and build tick and private in bill tick max we're going to set the max till it takes to construct and the bill tick we're going to set it to 0 let's also store a boolean while it is in construction so a private ball is constructing and in here let's subscribe to the time tech system on tick so in here on tick if we are constructing so if is constructing which up here is going to start off by default apps true so if you are constructing let's increase the bill take what is equal to 1 and here what's test if it is fully constructed so if bill tick is bigger than bill take max then the building is fully so let's change is constructing two phones and let's hide the constructing world bar so let's first store a reference in here constructing world bar if it is not fully constructed then the building is still under construction so we're going to update the world barn set the size which takes a normalized value and normalize value will be the belltech divided by film tick max since both of them are integers let's multiply it by one F so here we are calculating a normalized value between belltech and Ville Tech max we are setting the construction world our size and when it is completed the bar gets hidden and is constructing sets to folks so just for fun let's also change the sprite once it is in construction alright so in here I'm simply setting the sprite to a different state based on the percentage that it is being built so in here when we construct a building let's say that it's going to take three ticks to construct so let's see if everything is working fine alright it takes our still increasing right I click in there and that one starts constructing it changes the sprite changes again and boom gets completed the bar hides and everything is perfect so I can create multiple each of them are independent but the code for the timer is only executing once on the time.take system alright great everything is working exactly as we want it now depending on your game there might be some actions you want to perform less often than the actual tick rate for example if you're storing stats to display a graph at the end of the game you probably don't need one data point per tick since each tick is only 200 milliseconds so for these cases it's useful to have other less frequent tick events so on our time tech system let's make another event in here called on tick 5 and down here when we increase the tick let's do a mod calculation so if tick mod 5 equals zero then we're going to fire the on tick 5 event so this tick won't fire every time tick is a multiple of five mod is a remainder of the division so when it is zero it means that tick is a multiple of five so this won't take on five ten fifteen and so on so on our game handler let's subscribe to the on take five event and let's say make it tick okay so let's test and there are your multiple takes when it gets to five you get a mega tick and we can still construct buildings and everything is not working perfectly fine so there you have it we created a time tick system that we can use to run logic less often then on update without having loads of timers scattered throughout our again this enables you to have time based logic on any object even without using monobehaviour if you have any questions post them in the comments and I'll do my best to answer them subscribe for more videos and I'll see you next time you