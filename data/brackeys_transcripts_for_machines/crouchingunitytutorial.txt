hello everyone and welcome to the crouching tutorial done by brackets I am the CEO of Brad keys and in this video we are indeed gonna talk about crouching functionality in the last video we did we talked about how to do sprinting and program that and so in this video we are both going to talk about how to script the crouching itself and how to merge the crouching script with the sprinting script so that they will function together the right way and so if you missed the sprinting video you can always go ahead and look in the description that will be a link and if you're interested in getting either the Sprint the Crouch or the sprinting Crouch script you can go to our website brakus come and download the survival game assets and in there they will be included so that was it for the long intro as always I have opened up unity and as you can see currently our player has this sprint script applied to him let's go ahead and just disable that for now let's go down to the project pane hit create and then JavaScript and oops rename this to rename so there we go rename this to crouch or crouching whatever you want just going to Crouch double click it to open it up in monodevelop and remember to always drag it onto the player so that we have the script applied and now we can see monodevelop popping up and if we just give it a second I'm rendering a video in the background so it might be a little slow now that was the sprint script let's go ahead and minimize that and we are going to keep both the function star and the function update so you can go ahead and space down the brackets I just like it that way first of all we're going to make some variables the first one we are going to make is going to be called walk speed and it's going to be a type float and it's going to be equal to let's say seven so this is our regular speed next one is going to be called Crouch speed it's going to be a type float again and it's going to be equal to about three this is a speed while crouching so basically we only need these because we want to change our speed when we are down on our knees when we're crunching so on that's it for that that is for the user to declare in unity now let's make some private variables in these we are going to cash a lot of data store a lot of data there that we can data access so the first one is going to be called char motor and it's going to be a type character motor the next one is going to be tire called private bar chart controller and it's going to be a character controller the next one is going to be another private bar the transform and it's going to be a type transform and the last one is going to be called again private one then char heights float and we don't need to declare variable air or a number to this yes yet so this is going to be the initial height now the reason why we are creating all of these is because in the start function we want to store a lot of information in these and you could exclude these variables though it would make it a lot harder on the computer because then we would have to find the character motor every time we needed to adjust something in it and we would have to find the character controller find the transform and look after the height and so on so instead of doing that every frame or at least every time we click a button we'll just do it once and that's in the start function so we'll type char motor equals get component and then in the parenthesis we're going to type character motor next one we're going to type the transform equals transform then you're going to type charge controller equals get component character controller and then we're going to type char height equals char controller dot height and you can mix up the ordering of these as much as you like as long as the char height is beneath the char controller and so let me just quickly explain what we are storing in these variables the term motor is the one that we are going to access whenever we want the to change the speed of our our player the transform is what we access every time we want to get stuff like the position the size the rotation and such so every time we want to manipulate this object we want to use the transform the char controller is the character controller and it's the one that we are going to be using for check stuff like if the the the what Hightower player is and finally we have the char heights which is which is going to store the height so now we can go down to a function date and then here you're going to type VAR h and then char height and semicolon we're going to make another one VAR speed equals walk speed now the H is going to be by default or char height which means our initial height the speed is going to be by default our regular speed now we want something that could change these so in case of our in case of the player pressing X for example the C button to crouch we want to change the height we want to change the speed and so let's create an if statement to find out if the play is pressing anything so let's go input if input that get key and I'm going to type C and again if this isn't working for you the C in the doing it like this you can always type key code and then dot whatever you want then you're sure it's going to work I'm just going to do it like this so C and then end up the parenthesis and open up some curly brackets whoops curly brackets and inside of the curly brackets I'm going to type H so the character height equals character height times 0.5 and so we are going to have the height of our character we're simply going to make him half as big or as tall then we're going to type speed equals crowd speed and there you go so whenever the player presses the C key we want this variable to be high half of what it was before and we want the speed to be equals to Crouch speed so now we can move slower but this only changes variables now we are going to make these variables take effect inside of the character so we are going to write write char and this is outside of the if statement you're going to write char motor movement dot max forward speed equals speed and then semicolon and here we are setting the max speed so this action this makes it so that our speed variable which is the one changing depending on whether we are crunching or not so here we are making sure that that speed variable will actually influence the speed and now we want to create a variable so our last height equals char controller dot height and this is going to make sure that we can stand up or Crouch smoothly by starring the last hide the the height that we have right now we are we can use the lip function inside of unity to smoothly transition between the two heights now you're going to write chart controller dot height equals oops try controller dot height equals math dot lab and inside of the lip inside of the parenthesis we are going to write character or char controller dot height comma H comma five times time dot Delta time and I want explain how the math that loop actually works though I can say that it will transition from the current character controller height to the H and so that's how that works we could also do the last height equals math dollar but you get the idea and so we are going to write the transform dot position dot y plus equals char controller dot height minus last height divided by two and this is going to help us fix the vertical position so that we want fall through the fourth floor now this is how our script looks and that's basically it for the scripting part now let me try to explain what happens so we have all of these variables stored and we want to do it so that if the player presses the C key the character height goes becomes half of what it was before in a smooth transition and the speed gets to be the Crouch speed and then of course we want to fix all of the box with the vertical position that's basically what this script is doing and now let me show you how this actually works in game and also the reason why we aren't only changing the capsule Collider and the character controllers Collider and not the entire size of a game object is that if we scale it down like this weapons and other things attached will also be scaled down so that if you so if you want to actually make it look like the players coaching in game you need to create a crouching animation for him and make that play whenever we hit the C key so now let's hit play and let's try to hold down these control oh no I'm sorry the C key and there you go you can see that the graphics is indeed like it was before but the capsule Collider itself scales down you can see the height variable changing over here on the right hand side so that's it for making the crunching functionality though if we try to also enable this print script and hit play and I then hold down the C key to crouch you can see that my my my speed actually doesn't change and when I then hold down the shift key I can even sprint while crouching and that is indeed only because of the sprint script so they can interact weirdly so let's match these two scripts to make sure that they will work perfectly together so now let's duplicate this crowd script and call this call this rename call the sprint and Crouch like that double click to open up in monodevelop let's go ahead and minimize the crunch so now we want to add some more variables we want to add the sprint speed and I won't explain how the sprinting pod works in this tutorial since I've already done that in the last one I will just show you how you can match them so they work fine together so our sprint speed of type float is going to be equal to about 13 and it's going to be the speed while sprinting then we are going to need a we have the speed variable so I guess we are going to need the sprinting parts down here so we want to change the speed variable and that is done by saying if char controller dot is grounded and oops and input dot get key left shift or I'll just get the signs or input dot get key get key right shift and close up the parentheses open up some brackets and inside of here we're just going to write speed equals sprint speed and so when our computer runs through this we are able to check whether or not the character is sprinting or crouching the way it works is that first of all we make a variable and if we're not doing anything it's just going to be walk speed so if the character controller is grounded and we aren't pressing down the key here and we are not crouching it's just going to go down here and change the speed to the ordinary walk speed if we though are sprinting it's going to change it to the sprint speed and go down here and actually make the change if we are sprinting but also crouching it's going to change it to crouch at the end and then change it in the character motor and so the crouching will override the sprinting now let's see if it works if we go ahead and hit save and go back into unity and hit play we can hold down the shift key and nothing happens let me see if I have applied yes I need to apply the script to a player in order for it to work now let's hit play again hold down the shift the play is sprinting Crouch they play crunches and move slowly and when I hold down the shiftkey nothing happens so that is it for the sprinting and crouching tutorials I hope you enjoyed it and I'll see you in the next video member