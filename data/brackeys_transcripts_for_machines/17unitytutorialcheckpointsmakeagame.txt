thanks for tuning in at braies hello everyone and welcome to video number 17 in make a game a cool series on making a video game in unity So today we're going to be taking a look at something that has been requested quite a lot which is U player spawn points more specifically we're going to take a look at checkpoints so until now whenever our player has died we've simply restarted the scene but what I want to do now is I want to uh have some points scattered out throughout our level which our player will respawn on if he's reached that point then later we can expand and maybe have um some kind of of Life limit uh before the score runs out and all that uh but right now we're just going to set up the checkpoint system itself as always if you have any questions throughout this video I suggest you head over to forum. bra.com where there are many people who are just waiting to answer your questions um I'm also often here as much as I can be and uh you can see that there are a lot of replies on each thread so it's it's very rare that a thread go unanswered cool so as always I've opened up unity and uh I've uh I'm currently using a Unity 4.6 it's out of beta and and now just available uh so as you can see my current version is 4.6 just so you know uh 4.6 also introduces this 2D view up here uh which I've just clicked because we are going to be using or placing some spawn points and uh it makes sense to place them in a 2d view because we are not really using the zaxis when it comes to stuff like that cool so the first thing I want to do here is just select our ball and have a look at how it's currently set up so if we go under a ball Health script which currently handles our health and are respawning uh we can double click that to open it up in mono develop and will open up here I'm just going to zoom in on the code here so you have an easier time reading this and uh let's just maximize it also cool so what we can see here is that we currently have an update function that checks if re is restarting is uh true uh or is false and if it is uh it it starts our level so uh you can see we have an if statement that's checks if we fell below our Max fall distance and uh if if we have it's going to restart our level and make sure to do it just once using this Boolean and inside of the restart level function uh we set first of all is restarting to true we then do some audio work we then work uh wait for the audio clip to stop playing and load the new level and this right here is basically where we can replace uh is is basically what we're going to be replacing so instead of using application. load level and just restarting the level we are going to teleport our player to the nearest spawn or to the furthest spawn point that the player has reached so right here I'm just currently going to say debug.log teleport player like this and it's save so just so we know that that's where we're going to teleport our player but first we need a place to teleport him to so in order to do this let's create an empty game object by pressing control shift n or command shift n if you're on a Mac let's rename this to check point let's zero out the transform by right clicking and hitting reset so a position of zero and a rotation of zero now let's make sure that we're not using the 2D editing tools but instead using the normal transform tools here so we can see and place our object as we want to and let's just move it over here on the third block just somewhere around here it's going to be fine now uh we can go ahead and Mark our checkpoint so we can easily find it in our scene and in order to do this we simply use this drop down menu uh right to the left of our uh of our object name and we can select some different icons so I'm simply going to select maybe a blue one and you can see that it automatically inserts the checkpoint name uh you could also do some kind of of uh icon like a star or something but I think that uh having descriptive names is often best what we can then do is add a component and this is going to be a physics component and it's going to be a box collider you can go ahead and use a sphere collider but what is awesome about the Box collider is that we can stretch it a lot along the wire and this is simply going to act as a trigger uh that checks if our uh our ball has passed through this point let's say you had a ball that went over here and then down and then around and all that then I would suggest you either um uh didn't stretch this box collider out so much and maybe just made it smaller or you could just go ahead and use a sphere collider instead so if we remove this component and add a physics V collider and then simply bump up the radius here you can see that's going to work just fine as well I'm just for this game as is um actually let's just keep the sphere component I almost like that better so let's just change the radius here to something like 3.5 maybe just four I don't mind this being uh too large uh it's going to save our checkpoint as soon as we inser the radius uh so let's just do three and uh move it up a bit so if we pass through this point uh we want of course to set this uh place we want to spawn to this checkpoint right here um so what we want to do is we want to hit add component new script and then it's going to be of type JavaScript and we're going simply going to call this checkpoint because it's going to store all of the stuff that we need to do with checkpoints now we create an ad double click it to open it up in mono develop and we can just go ahead and delete our both our function start in our function update we're going to be making our own function and this is going to be a ont trigger enter and this is very important that you type it in exactly like this because uh if you get this wrong it's not going to be called and it's going to be very hard to debug because you're not going to get an error if you don't Ty it right it's just not going to work so please check your spelling uh then in inside of these parentheses we are first going to um or what we're going to do inside these parentheses is we're going to store some information about what has entered our trigger and uh then we're going to call it something so we can reference it later so what we're going to call this information um maybe we could do call for collider because some kind of collider has obviously enter that trigger so I'm just going to call it call and it's going to be of type Ider and the collider class here stores all kinds of information it has the transform and therefore the position and rotation it has the name the tag all of the uh components um on the object is also something we can get so we can basically excuse me we can basically use this class to to get all of the information that we want from the uh object that has ins trigger and then I'm going to open up these uh brackets here cool and inside of this function what we want to do is we want to set this kind of global variable to this specific point so let's first go ahead and create a global variable that uh it's it's just going to be one of so we we're going to make make it static and what static means is that it's not bound to any specific version of the checkpoint but it's just one single a global variable that all the checkpoints and other objects can access so if that's confusing to you please bear with me but uh just see how uh I write this out and you might understand it later so let's write static V and we are going to call this um reached point maybe because it's going to store the furthest point that we've reached and uh it's going to be of type Vector 3 and a vector 3 just stores three values and that's going to be our X Y and Z so a vector 3 basically just looks like this um just like uh cartisian coordinates so 2 comma 0 comma 4 for example that's an example of a vector 3 so inside of this on trigger entry first thing we want to do is we want to check if it's the player that has entered our collider and not something like the ground so in order to do this we're going to type if call because that's the information about what has entered dot tag is equal to player so if the collider that has entered uh has a tag call player then it's going to call the code that we insert down here and therefore we need to make sure that our ball is indeed tagged as player if not go ahead and add the tag and make sure to tag it here great great so now we know that it's the player that we are colliding with then what we can go ahead and do is simply uh say that our reached point is going to be equal to this collider's position so collider do transform.position oops um or even easier maybe because uh we could just set this to transform that position I actually like that better so if uh what is colliding is the player then we're going to set the point that we reach reached to the current position of our checkpoint but there's one issue with this and I'll just go ahead and show it to you so if we go under our ball Health script instead of uh calling teleport player here we are simply going to say checkpoint Dot and now we can access are static varibles so we're going to just say checkpoint do reached Point like this and then we can simply set our pos position equal to that so transform. position equals checkpoint do reached point this way we don't need to access a specific checkpoint we can just say any checkpoint has this variable called reached point and we're going to set our position equal to that so now let's save this let's also save the checkpoint and let's head into unity and what we can do is uh simply jump over here and uh try and uh fall down so jump over here and this is where our collider should be uh but you can see that that's currently an issue uh and the the reason why we just fell off there is we need to select our checkpoint and then uh check the is trigger this will actually make it into a trigger so we don't collide with it but it's just going to notice whenever we touch it so what we can do is make this checkpoint into a prefab and I just want to quickly go ahead and Scatter two of these so we're going to place one here and then I'm going to uh drag another checkpoint in and place one over here uh then what we can do is we can simply jump over here so now we've passed the the first checkpoint you can see in the scene view we've passed the first one uh and then I'm going to jump over to the next one and you can see that we've passed the next one and then I'm going to jump back again let's see we are backtracking here to find a Coin or something and now I've passed the first one again and if I now jump down our position should reset to the first one so if I jump down here you can see see that we respawn on the first one and that's not what we want we want to only change our checkpoint position if it's greater than what we've before achieved so what we can do inside of the script here is we can make another if statement it says if uh and then we can say transform oops transform. position do X because we're only getting our x value because we are always traveling along the x axis uh if again you have some kind of game where it goes around I suggest you look at how to store these checkpoints in a list so you can just check if it's number two or number three you could also just make a variable on the um uh on the um checkpoint that says that has like the number so the order of the checkpoint um but again I'm I suggest you look up what is called an array or a list if you're interested in some more advanced checkpoint mechanics cool so if our transform.position dox is larger than uh the reached point dox so if uh our position here the checkpoint position is uh greater than the uh point that we reached last then we want to change uh the reached point and only then so now let's save this and now if we head in here hit play jump up here now we've pass the first one jump over here pass the second one now go back and pass the first one again and now we jump down see maybe maybe we can jump down here nope oh now we are stuck that's annoying so I'm just going to get the ball here move him up so and now we jump down over here you can see that our position is set to the second one so it's over here and that's perfect and you can see that we can just do this infinitely it will just fall down and then jump to the checkpoint over there or not what's going on here let's see so it looks like we have a bug with our ball health and that's probably because of the is restarting mechanic that we have going on here so let's just check this out so um if we fall down here we check if is restarting is equal to false by default it's going to be equal to false if it is we restart our level when we restart our level we said is restarting to true and then we fall down and all that so there you see we have our issue our issue is simply that is restarting is never equal to false again so instead what we want to do is maybe when we go down here set is restarting restarting back to false let's just go ahead and try that out so now when we hit play and I'm just going to turn up the volume on my computer here so I can hear whether or not the music uh is is playing correctly too so hit play and we're just going to pass the first one and then we're going to jump down game over it says game over and we respawn now we can try that again game over and it does so again so now we can do that infinitely and that's perfect cool so I'm just going to turn off my music again here you should still be able to hear it cool so that's how you solve bugs that's a great example of an annoying bug and I just wanted to show you kind of the process behind how to resolve some of these bugs cool so now we actually have a checkpoint system that is uh working as it should we have uh these checkpoints that we can SC throughout as prefabs and uh we have some method of uh checking whether or not we've actually reached a further point of we just gone back and we also have a way for the ball Health script we can delete this comment now to set its position to the checkpoint that we've reached so that's basically all I wanted to show you in this video I hope you enjoyed it and uh before I go ahead and turn this off I just quickly want to drag our ball here down to prefab too because it's been annoying me that we didn't have a player prefab also I just wanted to quickly clean some of this up so we can take our ball Health our checkpoint our coin pickup game master and main menu script drag them under the scripts folder then we can maybe make a separate folder create folder called um textures and we can drag them uh the different textures and normal maps onto there then another one called prefabs where we can drag our GM music ball chain Hammer checkpoint coin coin effect all of that just drag it under the prefabs folder then we drag our glow particle under the materials folder uh and uh I can see there are two more prefabs here which should go into the prefabs folder then we have the coin rotate that's an animation so let's just go ahead and create an animations folder also animations and uh I think we're just going to leave our scenes in here so now everything is just a bit nicer to look at so that's basically it for this video I hope you enjoyed it and I'll see you in the next one oh