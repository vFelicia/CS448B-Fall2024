thanks for tuning in at brakus hello everyone and welcome to the last video where we're going to be focusing on our upgrade menu within a 2d platformer course so today we are going to be finishing off the system by adding some audio to it we are also going to be adding a way for us to actually spend money and we are also going to be adding a way for us to earn money by killing enemies so they will have some kind of money drop so that's going to be very exciting but we'll actually start off by fixing a small bug with our enemies still spawning whenever we have the upgrade menu open so that's the first thing we are going to do also if you haven't seen the latest videos I've published I'm non patron I've gone full time with brackets so if you want to support me in making these videos along with the other courses you can go there and donate any monthly amount and it really helps out a lot so check that out if you want to and without further ado let's dig right into today's video so you can see that I'm pure unity and the first thing that I want to do is go to our armed UI overlay and then upgrade menu and double click this to open it up in visual studio and basically we've already implemented this static int variable that sits on our game master object that stores our current amount of money so all we need to do within this here is simply edit that amount so under our upgrade health and upgrade speed which are called whenever we press the two buttons we will simply go in and say money or a game master dot money and then subtract that by some amount and this amount I want to be specified by a variable up here you can of course have different amounts depending on what you want to upgrade but in our sake for simplicity I'm just going to have one fixed amount you can make multiple variables if that's something you desire so I'm going just going to have a private int which is going to be the upgrade cost and set that to a default of 50 then we can go down here and say the amount we want to subtract is the actual upgrade cost and we can then duplicate this statement there to put it down here and now we're subtracting money and if we go into our game year we can actually see that this should work so if I press you here and now I'm just going to wait a second because you can see down here it says that if spawn some enemies and if we wait you can actually hear those hitting our player and that's definitely an issue and you can hear there that we died and we are now respawning so that's actually what I really wanted to fix before moving further with the upgrade menu however you can see that we've already made some progress now we can spend money but we can also go below zero so there's some stuff here that we need to clear up so let's just save this and leave the upgrade menu itself for just a moment and let's find the place in our game master code where we are enabling and disabling this upgrade menu so that we can enable and disable the wave spawner as well so if we open up our game master here and find the place that says toggle upgrade menu you can see here that we are toggling whether or not the upgrade menu objects should be active and then we are invoking a delegate method that will call a different bunch of different methods subscribe to that delicate and make sure that stuff like the enemies stop moving and on the player cannot shoot anymore or move anymore however this doesn't include enemies that have not yet been spawned and since enemies keep spawning well then they are going to move and then kill us while we're in pass mode and that's really annoying so what we want to do is simply add some kind of reference up here and this is going to be another serialized field oops didn't meant to delete that so this is going to be another serialized field and we can call this a private and let's just make it a let's make it a game object actually let's just do the wave spawner here so a private wave spawner and we're just going to call this one wave spawner and we can take this here and put it down here on a new line and set wave spawner dot enable to be equal to the opposite of our current act of grade men use active self so if our upgrade menu is enabled we want our wave spawner to be disabled and in the same the other way around so let's try and save that and let's remember inside of unity to actually drag in the wave spawner we could also use getcomponent but these might sit on different objects so it's good just to do this it's very simple and when we hit play now and we press upgrade here you can see that our wave spawner gets disabled and nothing is happening in the background and when I now press this again you can see continues counting from where it left off that is however a smaller problem with this and that is if we are so unlucky as to pause right when the wave has started spawning but it um and and the countdown timer has reached zero well then it will actually continue you can see here if I pause right now actually that was a big too quick so right now you can see it spawns an enemy why I'm in the upgrade menu and the reason for this is that disabling an object will not stop if I just find our wave spawner here this labeling an object will not spawn or stop any corrode teens that is currently going on that object and that's what we have here we have this Kuro teen with a for loop that simply yields and waits for a certain amount of seconds between spawning each enemy and you might go in here and add some custom code that checks whether or not it should spawn an enemy and if it shouldn't it might either just wait or add it to some queue that is then spawned in afterwards but I think that would be too much for this video right now I've just showed you what kind of problem we have going on here and I think it would be a great challenge for you to solve that on your own if you can figure it out I definitely recommend you check out the forum that's definitely going to be a thread on there explaining how to do this stuff so without further ado let's continue with our upgrade menu now that we've fixed this issue so let's save this and on let's find our create menu again and we are now subtracting money however we are actually able to spend money that we don't have it's almost like real life right so can go up here we can add an if statement that says if our current amount of money which is gamemaster done money is less than the upgrade cost well then we shouldn't be able to spend anything so we are going to hit return and right above that we are going to add in some kind of sound that's there's something about the money not being there you could say need more money or anything have a voiceover it could just make some kind of sound that gives off the impression that something isn't working so that's what we're going to do here and let's actually add in these sounds right now so I'm going to call our audio manager here dot instance and then dot play sound and remember we've done this a lot of times before in some of the earlier videos and this audio manager we of course made ourselves and we know that it takes in a string with the name of the audio sound that we want to display or it to be played of course and I'm going to we haven't made this sound yet but I'm going to call this ah no money and then we can also play a sound for when we are successful so on upgrade complete we can call this one or we could just call it something like money actually let's just call this one money and then we'll have some kind of generic sound you could also call it bonus or upgrade or something but we're actually going to have the same sound played for when we upgrade and for when we gain money from an enemy so let's just call that one money and we can do the same down here so we can add the if statement down here like that and we can actually add the money sound as well and now we can go into unity and we can find our audio manager and we can add two new slots here and the first one is going to be um no money and the second one is going to be money and then we can find some audio clips that we want to use on your audio folder and if there isn't one that you would like to use you can go ahead and find our to see 2d assets pack which is downloadable from practice calm and you can go on the audio and find the bonus and click audio files I really liked those two and let's drag those under unity here and we can just preview them quickly so this is a bonus so and this is our click so our bonus is going to be the money sound and you don't need to rename these and our click is going to be the no money sound so if we have our audio manager we can drag the no money under no money and the money under money and then we can maybe turn down the volume just a bit on these sounds especially on the money sound that's a bit loud and you don't want this to be too crazy and you can of course adjust the pitch randomness and all that so that's going to be fine for now and on that should indeed be working so if we hit play here bring up the upgrade menu and upgrade we are going to hear that going up and our money is not zero so now we are going to be hearing the known money sound great so that is working and we should see actually that when we spend some money and then go out of this view the money our amount here will have updated as well and what we can do now is simply allow us to gain some money from the enemy so we'll add some kind of money drop so if we find our our enemy script on the scripts and then enemy doubleclick to open this up we're going to add a new variable here just like we have the public string death sound name we're also going to have a public end which is going to be the money drop and I'm going to set that as a default to ten and you can of course randomize this and then we can go on to the GM object on our game master and we can find the place that says kill enemy here and we want of course the local kill enemy and it takes in an enemy so why not use the money drop on that enemy you could of course just have hardcoded the value in here but instead I'm going to say money plus equals and then enemy dot money drop and this way different enemies can drop different amounts of money which is definitely something that you want to do for your game remember again I'm just using a single enemy because I don't have time in this tutorial to sit here and play around with different enemies that stuff yet that you can play around with yourself and that I definitely recommend you play around with yourself but on the idea is here so the infrastructure is right there for you to use so we're going to gain some money and we are going to do this with of course a sound so we're going to have our audio manager and we actually have a reference to it here so we don't need to do that instance or anything and then dot play sound and the sound that we want to play is money and again I'm hard coding this in if you want to be really really clean in your code you should make a varial for it above but this is what happens you you are really clean with all your code and then you get into the project and you start being a bit more messy but that's alright so let's say that and let's clear the lock here and the scripts and everything looks great let's hit apply in the GM object we haven't done that in quite a while and I actually also want to bring up the health regen rate to something a lot higher and let's actually hit play now and I actually want to do this in fullscreen mode so play and we can move around here and some enemies spawn in and we should see that when we kill these enemies we can hear the sound and it the money amount goes up by 10 for each enemy so in our case that was 20 and we can kill some more in these I'm going to try not die here and you can see here is the upgrade menu and I'm now able to upgrade my character but not below the amount of zero there so there we go and that's basically on the last part of our upgrade system you should definitely go ahead and add more properties for the player upgrade you should definitely go ahead and actually we can just do that so on a UI overlay and our upgrade menu I just want to add the core the cost of the upgrade to the text here so just select the two text object and add a parentheses and then 50 and you can of course fetch that from the script if you want to you can insert that by simply reference referencing the text object and then changing the text but since it's just a two buttons and a single value we can just change that by hand so now it states that more clearly but play around with this system add more enemies add more waves at different possibilities for spending money and this game should already be a lot of fun to play so that was basically it for this video I think we are coming near the end of this series I still have a few things I want to show you so I'm excited for on getting this finds in the series if you have any things that you're dying to see please let me know and without further ado thanks for watching this video and I'll see you in the next one so I'm going to start mentioning patreon supporters the following month after they donate so that there won't be any difference from donating at the beginning of the month to the end of the month this way everyone will get a full month of mentions and yeah everyone will be happy so just wait for the next month and you will see your name here so thanks for watching and I'll see you soon