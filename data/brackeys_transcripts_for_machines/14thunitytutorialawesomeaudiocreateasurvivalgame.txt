hello everyone and welcome to the 14th video in our create a survival game series done by brais I am the CEO of braies and today we are going to be taking a look at another method for making audio and underlying music for your game so we're going to apply some smooth fading between audio sources so um let's go ahead and open up Unity um this is generally a better method than what I showed you in the last tutorial though um it does have its faults and I'm going to talk about them very very soon so um first off let's talk about what we made last time we had these two audio zones um with a 2d audio attached to them and a script that handled all of the um switching on and off so basically once the player insert these triggers these trigger colliders the music would start playing and when he left them it would stop this didn't uh give the effect of smooth fading and um it was not really nice so um let's go ahead and for now just disable these by selecting them in the hierarch key and hitting uh this check boox so now we can see they great out out they are disabled great um the reason why I showed you these in the first place was so that you can get an understanding out of how audio zones Works inside of unity and also um it's really great to know how to make trigger functionality um it's good for making all different kinds of surprising events or just um make making sure that your game stays alive um Okay cool so let's go ahead and clean up from our last tutorial drag the audio Zone script under the scripts folder and we are ready to go now hit the game object create empty or you can just press contrl shift n to make a an empty game object you can go ahead and right click and rename this to uh audio Zone optimized I'm just going to write opt or uh Source or whatever you want I'm going to write Ops and then Z one so very similar to what we did before I'm going to zero up the transform and place it basically in the center of our village all right so now I'm going to hit the add component on the white right hand side and uh go on the audio and then and hit the audio Source this is going to again add the audio Source component built into Unity into our game now we want something to start playing and this is very similar to the uh tutorial we did last time now though now we are going to start uh to see some changes so if I double click our audio folder I have changed something with these audio files if I select the friendly music first example you can see what I've changed the 3D sound is now enabled this is because I want these to act as a threedimensional sound actually placed in somewhere in the scene um so that Unity can take care of the rollof or the linear fading um uh for us so we don't need to do this through scripting and this is really great for stuff like background music or um or at least if you want to change it based on the player position then it's really great for background music it's great for environmental things um St stuff like wind blowing or um water splashing from the sea you get the idea all right so you can go ahead and check that 3D sound and hit the apply keep in mind that if your file is way too to B for games like mine uh my files is or are um then it could take quite a while for it to convert but um be patient uh it should work so now let's go under our audio Zone optimized and drag in the for example friendly music drag it in um I guess I'll just select it some how my dragon isn't working oh there we go now it's fixed um so we have the friendly music and it says this is the 3D sound exactly how we want it we want the play on awake to be Set uh to true and we could go ahead and uh play around with some of the 3D sound settings so right when you add it it should look like this if we go ahead and expand the 3D sound settings you can see see a whole lot of system uh or audio settings come up there are a lot of things that we can trick here so if we go ahead and just hit play right now the piece starts playing and once we get closer to the source it gets a lot louder and if we rotate around you can hear it coming from different places in the room uh this might not be very clear to you but if you are sitting uh listening to this with a headset or um or multiple speakers uh you will be able to notice this and uh for the most part with music uh you don't quite want it to move between speakers um so we're going to fix some of these problems now first of all uh we want the piece to stay equally loud uh throughout our town we don't want it to uh decrease in its Audio Level or pitch um depending on where we are in the town so therefore we're going to change the minimum distance so let's take the minimum distance and drag it up and you can also see this happening inside of scene view you can also select one of these dots and drag it inside the scene view this gives a very nice visual representation of the minimum distance before the rolloff begins and that's what this is all about this is about creating the rolloff or the fading um in in the audio whether whether it's linear or logarithmic and logarithmic simply means that it's has a curve in its listener whereas if we change it to linear you can see that it changes the volume in a straight line all right so um you can have whatever you want here um I'm going to go ahead and change it to linear just to make this a little easier to explain and show off okay so um now that we have this set um we could go ahead and change the max distance so if we um change bump down the max distance quite a bit we should in a moment start to see the blue sphere and there it is so what this means uh with the current settings that we have is that when uh inside of this smaller sphere the music will be equally loud no matter where we are when we get right outside it it will start decreasing in until we hit this outer sphere then it will be completely gone so if we go ahead and bump up the max distance quite a bit we can make the fading um a lot slower but if we leave it here um I can just illustrate so let me go ahead and hit play the music is very loud and it stays equally loud no matter where we are in the Inner Circle now I start leaving the Inner Circle and you can hear it fading until it's completely disappeared one thing though uh and this is the problem with doing it through the 3D audio handling in unity this is also why I showed you the audio Zone uh done through scripting because yes this has does indeed have a problem and uh it can be quite difficult to hear when especially because I'm recording this with just one microphone but whenever we are inside of our town and we rotate you can hear that we get this feeling of the audio flying by really fast and also the the audio is panning from the left to right speaker so um this is not too great for doing music it can be wonderful for stuff like um splashing of the sea but um especially with music you want to keep it equally loud uh until you want it to fade away so let's go ahead and uh change the doer level and the doler level is um well it it um it adjusts the effectiveness of the doo effect and if you don't know the doo effect it's basically whenever we move or rotate quickly the sound gets pitched up and down so the sound gets adjusted and uh it can sound really weird when we are moving quickly or rotating quickly that's basically the doppo effect so um this will just change how much um the doler effect is going to influence our sound and we want that to stay at zero for the music but we can still hear that uh it's not quite gone it does still pan from one speaker to the other and then you might say well there's a pan level adjustment why don't we just change that to zero let's see what happens so I hit play try to run out of the circle it should fade away it doesn't the pan level is not does not just uh don't doesn't just adjust the um the panning it also adjusts how well uh Unity will handle 3D sounds in general so this is how much this audio source is going to be affected by the the 3D sound engine and that means logarithmic falloff or linear rolloff as well so um that's quite a bummer um though I have come out up with a a technique to uh kind of blur this a little bit so blur the line and not make it quite as um well bad as um it it would be anyways because the pan level can just as the linear rollof in this volume um it can be animated so let's go ahead and do this so here we have the Green Line This is the pan level and I can go ahead and drag this down a little bit um the xaxis here is the distance from the center of this audio source so you can see 0 5 10 this is 0 units 5 units 10 units and so on until we reach um the end or the max distance which is currently set to 32 so that is half far way we are and uh the y axis is the influence of stuff like volume pan level and spread and spread I won't be explaining it's not very necessary for this kind of audio configuration so um let's go ahead and and adjust the pan level uh depending on where we are and how far away we are from the source so if we go ahead and double click this will create a new point and uh you can adjust the curve of this by using um this um this point right here but we are really just going to be messing around with the uh position of the point itself so if we go ahead and drag this up and place it uh right about uh maybe a little after the uh fading Begins the downwards fading uh this will mean that when the audio starts fading out we want to be able to hear this so therefore we want the pan level we want the effectiveness of the 3D audio engine to be full but until then we really don't care about the 3D engine so we are going to take the other point here and drag it all the way down and this way we achieve something like this so when I'm inside the city I can rotate and jump and run all I want it won't change the audio at all but when we start getting out to the fading it will actually Fade Away now this still doesn't change that when you're in the fading Zone you can hear the audio being weird you can hear the actual panning but I think it's a pretty good solution it's definitely better than the very harsh switching you um will most of the time get with uh scripting audio else you have to get into uh the distance from the uh game objects and some volume changing um I'm sure you can come up with an algorithm but for now this will do so let's go ahead and actually try to implement something awesome so uh let's drag out the uh max distance to make the fading a lot um smoother and uh slower and let's hear how this sounds so right now we're inside the city and uh I forgot to do one thing so hit stop I forgot to adjust the um the pan level also so we have to drag this back whenever we drag drag the um uh drag drag the the fall off back so um adjust this also and whoops I made a mistake there so quickly create these key frames one more time and uh let's have a listen oh needs to be a little lower try again indeed no changes inside of the city and then the music will slowly and beautifully start fading away and one thing I actually like about this panning is that you can feel the music coming from the town so if we um if we imagine that our player is coming from over here here from another town or has been in a fight um and we then close up on the village we can start hearing slowly the uh music playing and uh it it let us know that we are back home now I could change this to logarithmic rollof to get quite a nicer effect and create some more uh key frames on this adjust them to get a nicer looking curve uh but this is just some tweaking and I'm pretty sure you can do this on your own so um that's the gist of it we could go ahead and duplicate this audio Zone and call it audio Zone optimized 2 check off the play on awake um no actually leave that on um my bad and you might also want to set these both to a loop and then we could just drag this over to another part of the map let's say over there so if we follow the road we follow the road um we should hear the first piece fading out and as soon as we get down here we should start hearing the uh second piece fading in and this way you can create uh different feelings to different parts of your environment there we go I forgot to change which pie piece this uh this audio Zone will be playing so we can just drag the enemy territory in here instead and um this should be working so that's basically it for the audio Zone creation one thing though if you want the enemy to send out scary sounds or if you want battle music like The frightening kind of music or um or stuff like that to play whenever we near the enemy you can simply take the audio Zone U with the frightening music and drag it onto the enemy and position it on him and therefore it's parented on him so whenever we get near him we can hear um these uh this piece of music playing so that's a cool tip for engaging and also letting the player know that he's near something uh something bad so uh that's it for audio uh thank you for watching and uh one more thing before we wrap this up um I have asked a question on Facebook for what you would like to see in future tutorials um I'm currently working on a collision mastering Collis tutorial uh it's going to be really really cool and uh I also have a lot of different stuff um on the list you can see here I have written everything down every request I have gotten um but I would like to get some more feedback so if there's something you want to see or something you want to vote vote up uh go ahead and uh type in facebook.com/ braies and you can go ahead and answer the question um let me uh know what you guys want so thanks for watching and I'll see you in the next video n