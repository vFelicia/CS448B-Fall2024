hello one will come to the 21 video in our survival game series done by practice and the sea of Frankie's and in this video we're going to be taking a look at respawning our player so in tutorial number 19 we did the actual respawn menu and now we're going to be taking a look at responding the players so what we will give him some more health we will disable the menu also we're going to fix a back with the AI and stuff so it's going to be really awesome and a little complicated because we're going to switch a lot between scripts and yeah but hang on I'll see how fast and how thorough I will be able to do this so play a respawn whenever I need to add a new function like the play respawn or like firing a gun opening a door or more advanced stuff or even simpler stuff I like to sit down and just brainstorm what needs to be done and so the first thing is that I have gotten a couple of comments saying that the AI still intact when the play is that sound that that seems silly so first of all we're going to just just going to fix that then we want to fix the respawn transform so we are going to make it so that when our play responds he's going to form that position and that rotation is going to be equal to a empty game object then we are going to send a message to the player stats that he that they should be reset and so we are going to go in and edit the health script to handle that then we want to reenable the components that allow us to move and look around the scene then we want to change the play instead variable to false and then we should be left with three modified scripts the AI the health and the respawn menu script and we are going to add them cool so let me just drag this out of screen and we can just follow it in our minds so now as always I have opened up unit C and here we are so let's just quickly clean up from the last tutorial so go ahead and drag the Crouch height the FPS and the FPS Walker enhanced into the scripts folder I also want to grow into the scripts folder and find the one called advanced AI and also the one called player stats and you can select multiple objects or scripts and assets by holding down the control key the key and then clicking again so now let's just select these two and drag them into the assets from tahir cool now let's go ahead and make some duplicates of all these because we're going to edit them all and I thought this would be a good point to make a version two so that people who download the new assets but having come to this tutorial can still follow so let me just go ahead and select one at a time first a respawn menu hit ctrl D or command D if you're on a Mac and then we're going to rename this to respawn menu v2 and that's a couple of e then we're going to take the player stats and then just control be renamed to play stats v2 and we're going to do the same thing with the AI so advanced AI v2 and now we can just go ahead and drag the advanced AI the respawn menu and the player stats the v1 versions into the scripts folder okay so now let's go ahead and first of all edit the advanced AI script and I just want to make some quick comments at the top to make people understand that this was made in tutorial number 21 so input port note two slashes mean comments and this this script was made in video number 21 check out the earlier version not v.24 if you haven't reached that video cool so now that we have cleared a lot let's go ahead and dive into it so what we basically want to do is we want to check whether or not our respawn menu v2 that has a variable so if we open up the player stats also and the respawn menu v2 you can see that inside of here we have the variable created in the tutorial number 19 called Playa playa stat and we want to check whether or not that is true so on let's just go into the function update and then type F and remember we can access this variable because it's static right so if respawn menu v2 remember that that player is dead it's equal to true or false I should say then we want to do all of this so open bracket and close it down here and then we can select all of this right click and toggle line comments oh no I'm sorry just select all of it and then hit tab and it will tab it outputs all right so cool and now we should actually already be able to see this working if we just drag in the scripts already so that let's do that so first of all hit the play and I want to just clean up from the last tutorial delete the sprinting transcript delete the FPS controller and the character motor there now it's just a little more organized and so we can drag in the player stats v2 and the respawn menu v2 onto our player and then we can just disable the player stats and the respawn menu let's see if everything is set up correctly the health is like I want it to be and these will be set at startup so now that we have them on let's select our enemy and if you have been smart enough to make this a prefab sorry if I'm lucky anyone you would just be able to drag on the advanced AI and disable the old advanced AI and then hit apply up here to influence all enemies as you will have to do this with everything every single one you could also just go ahead and rename the advanced AI that is already on it and then save the other duplicate but how do you want to do this it's up to you now let's just read rag the play on asset target and see if there are any variables that doesn't match it looks fine good so not we have that in place we will be able to see this working so hit play and when I run over to our enemy the variable controller of advance the eye has not been assigned let's take a look at that so select the enemy and the IC so we have to just drag down the character controller like that and that should fix it so let's run over to the enemy let him attack us a couple of times and for some reason we don't die so let's go into the advanced AI v2 because I have a feeling of why this is happening so um let's see we have the apply damage we have the attack which sends a message to the damage okay so I think we are applying damage so we can go ahead and collapse the advanced AI but I think down here in the player stats we have the respawn menu dot players dead equals true we have to change that to play a respawn menu v2 that players dead and I know this is a bit confusing but it's just because I want everyone to be able to follow the videos so I just go ahead and change that and of course you can just update your scripts with a reference and everything we're doing here you don't have to follow the v2 and v3 and whatever okay so let's see if it works now so I'm hit play and go to the enemy attacks and yes we get the respawn menu and we should see him turn yellow and we should also see that he is no more Li more calling the attack function so no damage is applied awesome but again nothing happens repress respawn and that's something I want to change now so okay we have the fake say I in place let's fix some respawning so let's start out by creating an empty game object which will be the location of where we will respawn once we are dead and later on we will probably make a system so that the player can influence where he will respawn in some way it might be through different sounds you can speak with the in queue just like in games such as World of Warcraft but we'll take a look at that in another video so a game object create empty and then call this sound let's call it spawn location and then just for good 0 1 and let's drag it up here and so I would say about 3 meters off the ground or units I'm sorry and then just placed it let's say over here just so you can see the influence of it and both the position and the rotation of this will be applied so right now our player will probably spawn facing this way alright so just make sure you don't mess all of that up so he will spawn sideways like that ok now that we have that let's actually make a tag for it so go up under tag add tag call this Reese let's say spawn yeah just spawn location and let's hit the spawn location to run again and then select this ad it s attack just to stay organized alright so let's go into the respawn menu script to double click pad and let's also change this important note to on the we made overviews so I've just pre typed this and I'll just copy and paste it so important note this script was made in video number 21 check out respawn menu to use the one awesome let's just go ahead and delete these lines here I have commented out there's no reason for them to be there and let's now go down to the respawn play function which most of our logic is going to happen in because this function is already called at the right tail time now we want something to actually happen in it so the first thing we are going to do and this would be a good time to take a look at our notes this fixed respawn transform so we want to teleport I'll play to the respawn location and this is done by saying that our transform our current position so transform that position should be equal to so equals and now we want to make a variable that can store our respawn location so make some space bar and let's just say yeah respawn transform and then at type transform close it off and then say transform that position equals and then we can just type respawn transform dot position and we can just remember to close it off and then we can just copy this paste it and change position to rotation and now we should see whenever we play the game that our player will actually teleport to the right place but let's just get some work done before we start testing so the next thing we are going to do is we're going to make sure that our player doesn't die as soon as he respawns and he would do that if we just left it like this because on the health would still be zero oh under and therefore he would instantly die again so we have to send a message over to our player stat script that it should give a new health to the player so as set on the notepad we want to send a message to play your stats so that's type play let's type game object because the script sits on this game object so we don't have to create variables for it or find it or anything we can just reference this dot send message parentheses and then type in as a string type oh let's call this respawn stats because maybe we don't want to reset them completely but only take 80% of the max health you know whatever so I'm just going to call it respawn stats and not really set and ended up and now let's go into our play your stat script and edit this to be compatible so we called it a respawn stats so let let's go down and create a new function called exactly that respawn stats and open up the brackets brackets whoops and inside of here we are going to type health equals and at this point I could do 100 but that would be really annoying because then we would have to change this number every time we changed the variable health in unity and I can't say that health should be good to health because then we would get the edited version so the the health variable that have lost damage and I wouldn't change anything so what I'm going to do is I want to make sure to have a variable called max health that can help me in setting a max and a current so we're going to type up here var and then max health it's going to be equal to and then you can do whatever I'm just going to do 100 and so we're going to change our health variable to just be an int so instead of equal to 100 we're just going to type make it a type int and this way we can make a function called start which is going to be called once and that's when we start the game and inside of here we can just tell that health should be equal to max health and so when we start the game this variable will be equal to whatever we have said inside of unity and then we can later on reference the max health to restore our health so we can say that health equals max health under the response stats and let's see if we get any errors so head back to unity and everything looks fine so if we go under our player you'll see how this looks so we have the max health and the health and this you could just leave it like this for testing purposes or if you want to see how the variables change but you could also go ahead and make this a private if you don't want it appearing inside of unity but I want to actually see how the player is losing damage so this is fine for me now let's go ahead and let's see so we have the respawn stats and we have the max health so let's go and open up our list to see what comes next now we want to reenable the components which we disabled here so let's go ahead and do that let's go ahead and make some room after the game object at send message and here we can just copy the look around that enable equals false and so on and so on down here and just going to remove some space here oops and I'm going to change all of the false to true like this and the very last thing we want to do is we want to tell this script that we are now alive again so we are going to change the play is dead variable to true so player is dead equals false false I'm sorry because we are not dead anymore and then we can change the debug log to respawned player or actually I'm going to type player as player has respond like that now let's go into unity and see if all of this fix Ling and meddling has waked so let's hit play and we probably going to see a couple of errors but let's cross our fingers you get attacked you know unable to move inside of the menu everything works we hit the respawn and yeah something's not working so let's have a look at what it is unassigned reference thought so so of course we need to apply the spawn location to the respawn transform I knew I would forget this so um if you guys could speak to me right now I'm sure you were screaming at the screen not that you are aggressive or anything all right so just drag in the spawn locations to run to the respawn transform and let's try this one more time probably to see another error who knows so let it attack us a couple of times it works hit the respawn and we are over here with max health and this is actually working so um yeah that's pretty much it for now guys I hope you enjoyed you can of course play around with the variables and you can also move the spawn location to wherever you want I'm just going to move it over here and then I'm going to move the enemy away from the town remember that you don't want him any near the spawn location so it's a good idea to maybe build some boil walls or something to shield it off but yeah I hope you enjoyed the tutorial and I'll see you in the next one