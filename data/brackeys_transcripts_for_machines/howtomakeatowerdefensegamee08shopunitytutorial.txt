thanks for tuning in at brakus hello and welcome to this video in creating a tower defense game in unity today we are going to start making our shop we'll be creating the UI for it doing a bit of scripting and also tying it into the build manager script to select what chart to build next we're not going to be creating currency for the game just yet but that is definitely to come so without further ado let's dive right into it so as you can see I'm here in unity and what I want to begin with is kind of sketching out the UI of our shop so there are many ways of creating some kind of shop or purchase menu and one common way is just to overlay a huge UI element on top of the screen but what I want to do is have the current map layout available to the user while he two chooses what to build so I thought that we would instead of just overlaying a huge piece of UI have the different turrets available down here at the bottom of the screen so let's do that start by selecting the canvas and marking it as pixel perfect I've already done this I just noticed a few minutes ago that we hadn't done this when creating the wave countdown timer and it's a good idea to check that just to make sure that your elements will stay crisp at any time now let's rightclick our canvas go on the UI and select arm panel and the panel is just in a wide image that stretches to fit our entire screen now let's select 2d and hit f2 focusing on the panel and let's now scale it down on the Y here just bring it down something like there that looks fine let's also make sure that it scales on the x axis so when every we make our UI smaller on the X or our screen smaller on the X it scales with it but on the Y we don't want it to do that you can see currently it will just get to zero and then have a negative scale and that's not something that we want so instead let's just take these two anchor points here and bring them down or you can just click over here to make sure that they snap to the bottom cool so once we have this in place we can right on the panel go under UI and create a button and the button here is going to act as our turret so we can click on that chart element in order to purchase or select that turd so this is going to be our on shop turret our item and we will have different shop tart items for different turrets at the moment we only have one the standard turret but in the future we'll have a missile turret and maybe something that slows the enemy and stuff like that and for now we'll just use the default look of the button will change that in just a moment but what I want to do is instead of laying out these manually every time we add a new button so we would have to make room for another one here when we made a new one and then keep on doing that let's make unity do this automatically and we do that by selecting the panel and let's just rename it while we add it to shop and adding a component called the horizontal layout group and this will just make sure to stretch all of our different elements parented to the shop to fit the shop object so if I make another shop third item and another one you can see that they are resized and repositioned so that they fill out the entire shop object however we don't necessarily want them to be stretched I just want them to be positioned and then have every item be some kind of fixed size I want them to be about 100 500 pixels and then have unity place them for me so in order to do this we simply disable a child force expand on the width and hide and you can see that makes them super small and the reason why is we need to go into these and I'll just select all of them to edit them all at once and add what is called a layout element and the layout element allows us to choose a preferred width and height in our case that's going to be a hundred by a hundred so you can see that working already excuse me and what we want to do now is just have these snap to the very center of our shop you can see currently they align by the other left corner instead we want the middle Center so you can see that already looks much better then what I want to do is go ahead and just disable the image of our shop you can have some kind of background image some kind of dying if you want to it's completely up to you but I will just go ahead and disable that entirely um so we have these three buttons and let's just let's just delete the two other ones and focus on the first one here and the idea that I had for this is that instead of using the default UI sprite let's have an icon that represents our turd and now a billion different ways of creating icons you could also just use the text as is here and just call it the standard turd and that would be fine you could go in and hand draw something in some kind of art program or you could just take a screenshot of the turret that you've created in our case we have a prefab here called standard turret we could just throw that into the scene take a screenshot and if you want to be really cool about this you can remove the background from that screenshot so we have an arm and a turret on a transparent background and I think that will look super cool for what we're doing here kind of what we have down here actually and this is a very easy way thing to use for screenshot so let's just select the standard turret let's expand this here and you can expand it in any any way you want and get a nice angle on this and then bring up whatever you use to take screenshots and in case you're using Windows we'll be using the snipping tool also commands to do this click new and then click and drag to take a screenshot something like that and you can save that and if you are on a Mac you can use command shift 4 and you can then choose a region of the screen and take a screenshot of that and then you can import it into some kind of image editing software I use Photoshop as my third software and remove the background and I've gone ahead and done that already so you don't have to if you are using the same model as I am and it's in the tower defense assets pack download link is in the description and if we double click that after you downloaded it and unwrapped it and go under sprites you can see that we have this standard turd icon and I've gone ahead and added whoops you cannot see it on the black background but you can see it here and now that turned black of course and we knows why you're doing this but I've actually added a small drop shadow to this as well and just play it around with the lighting to make it look really nice so you can see we have the PNG file here that you can just go ahead and use or in case you're using Photoshop and want to copy my settings or change something I've included the Photoshop document as well so you can edit that if I want to and if you have Photoshop installed I recommend that you just import the Photoshop file into unity that will work just fine and then you can easily edit it so but I'm just going to be using um or you should use PNG if you don't have it and in my case I'll use the Photoshop version let's take this drag it in the unity and let's just drag it into our project here and we can go in here and we can rename this I want to just get rid of the PSD there there's no reason for it to state that inside of unity we can then change the texture type to sprite 2d and you I go down here and select 512 by 512 which the image is already and change this to true color we don't want any compressing a compression on that image then hits let's hit apply and you can see that it's here on a transparent background so that's perfect and now this is ready to use in our game so we can find a shop chart item and we can drag this into our UI sprite here our source image and now boom it's changed so that's a super easy way and a really cool looking way of creating a cool icon to use for pretty much any kind of shop item if you're creating an inventory system or another and RPG or something this is a very common way of creating item icons so we can just take our text here and disable that we might use that lady to display the name or the price but for now we'll just have it disabled and everything else should be working and the cool thing about doing it this way is that if we hit play now you can see that our object will actually get tinted both when we hover over however that is kind of subtle and when we click it it will also notice that it gets highlighted after we click it and then we have to click away in order to dehy light it and that's because we have to change our navigation to none because we're using a mouse to navigate with and we don't want to be able to shift between UI elements using the arrow keys or a controller cool and we can maybe take the highlighted color here which is your hover over color and just make that a bit darker just to make it a bit more apparent to the user that he is able to click this cool so I think that looks super cool and we'll keep on looking cool when we create more of these so let's take this and drag it down into the prefabs folder in order to make a prefab out of it so the next thing that we are going to be doing is hooking this up to some kind of shop script and we'll have to of course create that first let's find our shop let's hit add component and make a new script called shop cool let's double click this to open it up in visual studio and it opened up on my secondary monitor so here it is and let's remove the using system data collections our name space and we can go ahead and remove the two other methods for now at least as well and what we want to do here is have to a public void called mmm let's say purchase standard turret and this will be able to be called from our art UI element because we have it public here and this will communicate with the build manager and also with your currency amount and stuff like that late in order to make sure that you select that turret and we're able to build it do you have enough money for it and will subtract the amount of money that it takes and it will also handle different UI things such as maybe removing or closing down the shop when you have selected a turret until you place that toilet and then it will open back up the shop stuff like that but for now we'll just have it in here as a base and we'll just put a debug block here standard turd purchased okay and we can go ahead and duplicate this if we want multiple turrets so we can just make another one here maybe called purchase another turret and this will very soon be a missile turret or something like that but another turret purchased and you can have multiple on methods in here so let's just use that for now and it's very easy to hook UI elements up to that script here what we simply do is we find a shop chart item we add an onclick event we drag our shop into that and go on to function shop and then find the method that we want to call in our case we want to call the purchase standard turd and everything else look great so let's hit apply on that and now when we are go in here and hit play and click our turret it will say standard turd purchased so that's perfect and we can go ahead and create more of these let's just have two in here and have this be um this is the shop chart item this is the second one so we can make this D maybe a standard third item and we can make this the another third item something like that and we can go in here and make a Col purchase another chart instead and we can maybe just tint this a bit just so we know that it's a different element and you can go in here now and press the first one and it will say standard chart purchased and press the second one and it will say another chareth purchased so that is indeed working and it's very easy now for us to add new charts to the game okay so this the last part of doing this is actually selecting that turret and if we go ahead and find our build manager I actually just want to correct this a bit because I think we should make the distance between these two UI elements a bit greater so let's go in here and select the shop and add a bit of spacing excuse me I have to take a sip of water for this okay and we're ready to go so let's just add a spacing of something like 10 pixels just to move them a bit further apart that's a lot better and I'll just because I don't like looking at it Crane and remove the color there as well and now let's find our game master find our build manager and doubleclick it to open it up in Visual Studio and you can see that we have a bunch of things in here the first one is the awake method that was just for handling the singleton instance and we have all of that up here then we have our public game object which stores are standard toward prefab so that at the start of the game we can make sure we have that selected I think what we should do instead is remove that so that we don't select this at the start of the game and then have it only be selected when you actually go and press that chart item and we can go in here and add another prefab so this will be another turret prefab and we can make sure that we can select that as well so you can actually choose what to build cool and that all seems fine and then what we can do is we can add another method in here one called public void and this will be the set turret to build so this can be called from other methods and it will change what chart we want to build and we want of course to pass in a game object chart and it will set chart to build equal to whatever was passed in and the cool thing now is we can head into a shop and we can create a reference to a build manager and we have that by using build manager that instance but let's just make sure that we cache this up here just to make things a bit simpler simpler to read so we'll add the in the start method we'll set our a private build manager variable equal to build manager instance and then when we purchase this standard turret we will still write out standard toy purchased and then we'll say build manager dot set turret to build and then we'll use the fact that we have access to that chart so we'll say build manager dot standard turret prefab so it will set the turret that we want to build to the standard turret and we will do the same down here so under the another turret purchased will say build manager dot set chart to build build manager dot another charted prefab and this should actually work however currently at the beginning of the game our chart to build will be null and we don't want to build anything that is no and that will just create an error so what we'll do is we'll open up our node script so double click on node script you can see we have a differential bunch of code in here but most importantly under our onmousedown we want to find our tour to build here and then say um actually we can do this at the very beginning here so we can say if and then we want to use the build manager instance so let's store this as well just as we did before so we'll create up here we'll have a build manager and we'll just call this build manager and in the start method will set build manager equal to build manager instance and then here right before we do anything in the on mouse style down we can say that if build manager dot get turret to build is equal to null will then we sit boobs is equal to null well then we simply want to return them we don't want to do anything in here and down here we can simply write build manager now instead of build manager dot instance so we've cashed that once again and another place that we can take this code is down under the on mouse enter to make sure that we will only highlight the different notes when we hover over them we will only do that hover animation when we actually have a turret to build or else the user will be incentivized to press that note and nothing will happen and he will think wow that's weird so we'll make sure to only show the user that that can be done if we have a chart selected we won't do this on the on mouse exit because then we would be able to build something have the chart to build be equal to null and then have that note just be highlighted for the rest of the game that would be weird so we'll make sure to always disable it and that was pretty much it I believe so if we hit play now we should be able to you can see we can hover over these two there's no hover animation here and then uh thing happens when we press the map then if I select the chart say the standard turret we're now able to place that around the map and if I switch to the other chart here you can see that the chart that we just placed where standard turrets well then we can actually are place those as well however one thing is happening and that is it's acting as if the chart to place is no and the reason why is that it is so if we go ahead and find our game master you can see it's because we haven't dragged a prefab under the another chart prefab and therefore when we set our chart to build equal to another chart it became equal to null and so nothing happened so let's just make sure to drag some kind of prefab in here and we'll just take the standard turret and duplicate it and we call this one another turret and all we'll do is we'll change the range to be double and the fire rate to be half just so we can see a difference between the two and then we can find our game master script again and drag the another chart prefab in there so now when we hit play and we find here another chart and click you can see that another chart is built and you can see the difference here it has a super long range whereas the this chart here only has a very short one okay cool so now that we have that in place we should actually go down here and change these debug deadlock statements because we are actually not purchasing on the chart here we're only selecting what we want to build and therefore it might be better to say selected but exactly when we want to subtract the amount of money and stuff like that it's something that will determine in a later video so we'll just keep the method names here for now and then we can maybe change it later but I'll just change the debug log statement for now awesome so the very last thing that I want to do before leaving you is when we have play now and we hover over something that is and select the chart and we hover over something here that is beneath our icon you can see it still gets highlighted and if in fact if I press something beneath the icon the our chart still gets set and I just want to avoid this and the way that we do this very easily is by going into unity finding our node here and right up here we want to use unity engine dot event systems and we want to down here under on mouse enter we want to check if we are currently hovering over a UI element that is in the way and we do that by using if and then event systems or event system dot current dodd is pointer over game object and that's a function so we'll have to open and close some parentheses and if it is well then we want to return okay so on this assembly is the pointer with the given ID over an event system object and if it is then we just exit out of this on mouse enter and we do the same up here with onmousedown so that should actually just get rid of that very easily and now you can see when we select this nothing is highlighted and in fact I can press like crazy here and not thing will get billed and it's the same with the auditory so we will make sure now we have made sure now that the UI actually blocks that kind of behavior so that was all I wanted to show for this video stuff to come is maybe closing and opening the shop or something like that definitely some currency and yeah and some other turrets I definitely want to add a missile launcher to the game that would be so cool so that's pretty much it for now thanks for watching and I'll see you in the next video thank you so much to all of the awesome patreon supporters who donated in July and a special thanks to vixen famous own and UK and Locke's game TV these videos wouldn't be possible without you