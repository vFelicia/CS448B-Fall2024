With timestamps:

00:00 - in this video we're going to create
00:01 - Captain America and his shield in unity
00:03 - 2d let's begin hello and welcome I'm
00:13 - your code monkey and this channel is all
00:15 - about helping you learn how to make your
00:17 - own games with nf2 torrents made by a
00:19 - professional indie game developer so if
00:20 - you find the video helpful consider
00:22 - subscribing so this is our goal I'm
00:24 - currently controlling Captain America
00:25 - here I can kick and punch enemies to
00:28 - kill them and I can also do a nice dodge
00:30 - roll so I kill them do a dodge roll and
00:33 - obviously I can throw my shield I can
00:36 - throw it I can recall it and punch them
00:39 - dodge out of the way and throw it again
00:41 - as you can see the shield is somewhat
00:43 - smart and if I hit one enemy it
00:45 - automatically tries to target different
00:47 - enemies it also is using physics so I
00:49 - can throw it into the wall and it
00:51 - bounces off of it just like that and the
00:56 - whole thing looks very nice very
00:57 - satisfying and the code is very simple
00:59 - alright so let's get to it
01:02 - here we are in our starting scene so I'm
01:05 - controlling Captain America with some
01:07 - simple movement and there are enemies
01:09 - being spawned I can also do a dodge roll
01:12 - to dodge out of damage I've done videos
01:15 - on the character movement and dodge roll
01:17 - so check my links in the description to
01:19 - see how it works and all these enemies
01:21 - they move towards me and they try to
01:23 - attack me ok so this is the starting
01:25 - point now let's get to work on making
01:27 - the shield so here in the editor room
01:29 - let's first make the shield game object
01:31 - so an empty game object call this the
01:34 - shield add a sprite renderer need to
01:38 - drag the Shum sprite I have in here ok
01:40 - now let's add a circle Collider 2d make
01:45 - sure that it matches the size of the
01:46 - shield and a rigidbody 2d since we are
01:50 - in top-down we set the gravity scale to
01:52 - zero okay so this is the basic setup for
01:55 - our shield now let's make the code in
01:57 - order to throw it so here we are on the
01:59 - Captain America player code here is a
02:02 - bunch of code to handle the simple
02:04 - character in order to handle move
02:06 - dodge rolling and so on so we don't need
02:08 - to worry about any of this we just need
02:10 - to be able to test when we should throw
02:12 - our shield so we go here into our update
02:14 - and in here and let's just do a simple
02:17 - if to test for a right mouse button
02:19 - click so we do it input dot get mouse
02:22 - button down and we need an index for the
02:25 - right mouse button so in here
02:27 - the left one is on zero and the right
02:28 - one is on one okay so when we press on
02:32 - the right mouse button let's throw our
02:34 - shield so for that we need a reference
02:36 - so let's go up here make a civilized
02:39 - feel for a private transform for the
02:43 - shield transformer so here in the editor
02:46 - just drag the shield reference okay now
02:48 - back in here when we go on our
02:50 - right-click lets first place the shield
02:53 - on top of the players so we take the
02:54 - shield transformed our position and we
02:57 - put it on this transform that position
02:59 - okay and then we want to use the
03:01 - rigidbody that force in order to throw
03:03 - it towards the mouse so first we go into
03:06 - the shield transform in order to get the
03:08 - component of type rigidbody 2d on the
03:13 - rigidbody we have our add force function
03:15 - and now in here we need a vector two for
03:17 - the direction that we're going to throw
03:19 - so we want it to be towards the mouse so
03:21 - for that I'm going to go into the utens
03:23 - class which is part of the code monkey
03:25 - Tonys that you can grab for free from
03:27 - unity code monkey comm so in that
03:29 - there's a very nice function in order to
03:31 - get the mouse world position so our
03:34 - vector three for the throw direction
03:37 - will be the mouse world position minus
03:39 - the current transform dot position so in
03:44 - here we need the force so the throw
03:46 - direction was we also need a float for
03:48 - the throw force
03:50 - let's s the number can we add it as
03:56 - impulse okay so that should do it and we
03:59 - should be able to now throw our shield
04:01 - whenever we press on the right mouse
04:02 - button let's see okay so here I am now
04:06 - if I right click and let's see the
04:07 - shield and if there you go it went
04:09 - towards new maps okay awesome
04:11 - so far so good now the shield is going
04:14 - to have some logic to it
04:15 - so let's make a simple class instead of
04:17 - heart
04:17 - everything on the player class so in
04:20 - here we make a new c-sharp script this
04:22 - will be our shield and let's drag it
04:25 - onto our game object so just drag it in
04:28 - there okay so here on the shield code
04:31 - and let's start off by making a function
04:32 - in order to throw it so we make a public
04:35 - boy throw shield and we receive a
04:39 - vector3 for our direction now in here
04:43 - we're going to do very much the same
04:44 - thing we were doing in our testing so
04:46 - let's go here and copy this so we modify
04:54 - our transform position then we use this
04:57 - as our throw direction and we use our
05:02 - transform getcomponent
05:03 - now in here this is meant to be the
05:05 - player position so let's go here define
05:07 - a serialize film for our Captain America
05:12 - reference now we set it in the editor
05:17 - just drag it on there okay so with that
05:20 - we can simply go in there and get the
05:22 - position and now back onto the Captain
05:26 - America class in here we need a
05:28 - reference for the shield so let's do
05:29 - that instead of having a reference to
05:31 - the French roll we have a reference to a
05:33 - shield now we drag this on the editor
05:38 - track the reference okay and now down
05:41 - here on the right mouse button we go to
05:43 - the shield and we call throw shield and
05:46 - now we need a direction so let's
05:48 - calculate that
05:53 - and that's pretty much it so let's s and
05:57 - we should be able to see the exact same
05:58 - thing that was happening previously so
06:00 - here we are and right click and if there
06:02 - goes this yield okay great
06:04 - now that we have the shield being thrown
06:06 - let's also add a nice little effect so
06:09 - we want to add a nice trail so for that
06:11 - we can simply add the trail renderer and
06:14 - here we just modify this
06:28 - okay so here's our trail runner we just
06:31 - keep it visible for half a second it
06:33 - starts off very big and then it becomes
06:34 - very small and starts off only white and
06:37 - becomes transparent so let's see it in
06:38 - action
06:39 - so here we are and when I throw the
06:41 - shield yep there you go a nice trail
06:43 - follows it okay awesome
06:45 - now that we have our trail looking very
06:47 - nice let's make our shield Rico so we
06:49 - can throw this young and then get it
06:51 - back so here on the shell script let's
06:53 - make a recount function so a totally
06:56 - quiet recon and now in order to recon we
07:00 - need to move the xian towards the player
07:02 - so to do that we're going to set the
07:04 - velocity pointing towards a player on
07:06 - update however we need to know when we
07:09 - should do that we don't want the Recon
07:11 - code to run while the shield is being
07:13 - thrown so let's go up here to define a
07:15 - new for all of our various states so in
07:18 - privately known for the state and the
07:21 - various states this can be used with
07:22 - player so when the shield is on top of
07:25 - the player throne which is when the shin
07:27 - has been thrown and finally recalling
07:30 - now let's use these states
07:32 - so when we call throw shield let's put
07:35 - the state so we go up here to define a
07:37 - variable for a private state state and
07:40 - here we set these states to be staked
07:43 - out wrong
07:44 - okay and when we recall we started to
07:47 - state that recall now let's do a prayer
07:51 - void fixedupdate since we're dealing
07:53 - with our physics do a switch on the
07:56 - current state case we are on state dog
08:01 - recalling then we want to set the shell
08:05 - velocity towards the player so let's
08:06 - also go up here make a front boy to wake
08:08 - in order to grab our reference to the
08:11 - rigidbody so a private rigidbody 2d
08:16 - and we grab it in here and here on the
08:23 - throw shield we use this instead of
08:25 - always grabbing the reference okay and
08:27 - here we set the velocity and now we need
08:30 - direction for the player so a vector
08:32 - three for the clear to player we also
08:41 - need a smooth for the you recall speed
08:44 - and finally we need to test when we are
08:48 - close enough to the player so we do a if
08:51 - vector 3 dot distance compliment the
08:54 - distance between this transform dog
08:56 - position
08:56 - and Captain America Valiquette position
08:59 - if that distance is under the grab
09:02 - distance up here a float for the grabbed
09:04 - distance if we are within grab distance
09:11 - then we grab our film so we set the
09:13 - state to be state dot with player when
09:16 - we do we also set the velocity back in
09:18 - to zero so it stops moving and we set
09:24 - the original to Kin ematic so it doesn't
09:26 - collide with anything so rigid body ok
09:31 - so this is our code for recalling our
09:33 - script and then let's also do a friend
09:35 - void late update so this runs out there
09:38 - every update so we do a switch on our
09:41 - state in case we are on the state with
09:44 - the player then we want to shyam to be
09:46 - on top of the point so we move the
09:49 - transform position specifically we're
09:53 - going to put the shield on top of the
09:54 - body sprite so in here we go into the
09:57 - Captain America and we get the body
10:00 - position all right so this should be
10:03 - working just one last thing is when we
10:05 - do through our shield we need to set is
10:07 - kinematic back into Thomas so the body
10:11 - becomes dynamic ok so on the player we
10:14 - call through shield it throws the shield
10:16 - from Captain America towards this
10:18 - direction then on the player we can also
10:20 - call recon when we do we set the state
10:23 - to be recalling then on the fixed update
10:25 - if we are recalling then we complete the
10:28 - direction towards the player
10:30 - we moved the rigidbody towards it and
10:32 - when he's within grab distance then we
10:34 - simply grab it and keep following the
10:36 - player now let's see how we're going to
10:38 - come recon from the player so here we
10:40 - are on Captain America's class and we
10:43 - have our right mouse button in order to
10:44 - throw our shield however instead of
10:47 - always drawing let's use the same button
10:49 - to work for both throwing and recon
10:51 - so in order to do that we need to ask
10:53 - the shield if it's with a player or it
10:55 - has been thrown so here on the shield
10:57 - let's add a public ball is with player
11:03 - as in will return if the state equals
11:06 - state that with player and also appear
11:09 - on our awake let's set our scoring state
11:13 - we start off recalling solution
11:16 - automatically goes to the player okay
11:17 - and back in this class so here first we
11:20 - asked if the she on that is with player
11:24 - if it is with the player that means it
11:26 - can be thrown so we throw the shield and
11:30 - if not we go into the shield and we call
11:32 - recon all right that should do it
11:36 - so let's test and see if we can recall
11:38 - the shield okay so here I am controlling
11:41 - Captain American as you can see the
11:42 - shield is indeed on his back now here we
11:45 - have an issue with regards to the
11:46 - trainer it shouldn't be active while
11:48 - stationed this flying so we will sort
11:50 - that later but for now let's try to
11:52 - throw the shield so here I am I press on
11:54 - the right mouse button and there you go
11:56 - there goes the shield notice you on the
11:57 - stop now I press again and yep the
12:00 - shield is being recon so I can throw it
12:02 - and I can recall it and it's constantly
12:04 - phone ok awesome another issue that we
12:08 - can also see is with these sprites we
12:10 - want the shield to look like it's always
12:12 - on its back so in here right now it's
12:15 - correct it's on its back however if I go
12:17 - up it's still behind sprite so we need
12:20 - to modify the sorting order depending on
12:21 - whether the character is facing down or
12:23 - up
12:23 - so let's on that first the trail
12:26 - renderer so we go up here and we grab a
12:28 - reference to our private trainer
12:29 - renderer
12:34 - here when the player grabs it we set the
12:37 - trail render not enabled into phones and
12:40 - when we throw it we set it to true okay
12:46 - so that should do it for the trail
12:47 - runner now for the sprite sorting order
12:49 - let's go into our lake update and here
12:52 - on the whit player
12:54 - well let's modify the sorting order so
12:57 - first we ask the Captain America class
12:59 - if it is facing down so if Captain
13:01 - America dot is sprite facing down
13:05 - if the sprite is facing down then we
13:08 - want this bright to be behind it so we
13:11 - need a reference to the sprite renderer
13:18 - and here we set the sorting order to be
13:25 - on the Captain America that gets sorting
13:27 - order in this case we want to be behind
13:30 - so minus ten and if not we want to be in
13:33 - front so what Stan okay son let's see if
13:37 - the shield is always on its back and if
13:39 - the trail render is disabled once he's
13:42 - with the player so here we are in first
13:44 - move and yep there's no trail render and
13:46 - now I found facing upwards
13:48 - if there you go there's the shield one
13:50 - is back and facing down and yep it's on
13:52 - its back okay great now one issue we do
13:55 - have right now is with regards to the
13:57 - recon so if I throw the shield
13:59 - there you go see shield is in there and
14:01 - if I go right on top of it as you can
14:03 - see he does not grab shield I still need
14:06 - to press the recon in order for him to
14:07 - come back let's make the grab automatic
14:10 - if Captain America is close enough to
14:12 - the shield so for that let's go here
14:15 - test case state throne so if the she own
14:21 - has been thrown let's do a Sencha the
14:24 - same tests that we're doing here on our
14:25 - recon where we test the grab distance in
14:27 - order to ground so in order to not have
14:30 - duplicated code and let's put this in
14:32 - another function so here a prep boy try
14:36 - grab shield
14:40 - and we're just going to copy this code
14:43 - and we call this function so again here
14:48 - we define a graph distance we test the
14:50 - distance between this transform and
14:52 - Captain America's position if we are
14:54 - within the graph distance then we simply
14:56 - ground so we run it on recon and also
14:59 - when the player has thrown the shield
15:01 - now another issue we might have with
15:04 - this is that maybe he grabs it the
15:06 - second that he throws it so when we
15:08 - throw we can simply push it further away
15:10 - than the graph distance so in here
15:12 - before we do this we put position on the
15:14 - get position well as the throw Direction
15:17 - multiplied by a grab distance so let's
15:21 - define the grab distance up here so a
15:24 - private consult for the grab distance
15:31 - and here we use that one instead and
15:35 - here we use that one as well so this
15:37 - will make sure that on the same frame
15:38 - that we throw this young but we don't
15:40 - grab it okay that should do it
15:42 - let's see okay so here we are now let's
15:45 - throw the shield there he goes now I go
15:47 - near it and if there yogi grab the
15:49 - shield now I can throw it again and if I
15:51 - want recon and if I don't I can just go
15:54 - to it and grab it manually and throw it
15:56 - again okay awesome now since we are
15:58 - using physics to move our he own that
16:00 - means we can easily add some walls to
16:02 - bounce around so here in the editor and
16:04 - let's make some walls over here I have
16:06 - one as you can see it's just a simple
16:08 - sprite renderer
16:08 - with a box Collider so let's put it here
16:11 - and try throwing the shield directly
16:13 - onto the wall okay so here we are with
16:15 - one let's throw the shield onto it and
16:17 - see if it goes there and bounces away
16:19 - and throw and yep it didn't work
16:21 - the shield went towards the wall and
16:23 - then slid alongside it
16:24 - so that means we need to make our shield
16:27 - bouncing so for that we go in here we
16:29 - create a new physics material 2d let's
16:33 - call it bouncy and in here you can check
16:35 - the friction and bounciness
16:37 - so we set the friction to zero and
16:38 - botanist to one and we just drag it as a
16:41 - physical material on the original for
16:44 - our heel
16:45 - just like that okay let's see here we
16:48 - are let's throw and if there you go I
16:50 - can throw the shoe
16:51 - and it bounces back okay so just like
16:54 - that we can also do some really complex
16:56 - throw okay great and the Recon was also
16:59 - using physics so if I go into the other
17:02 - side of this wall and I try to recall as
17:04 - you can see the shield can't quite make
17:05 - it this is very much a design choice
17:08 - maybe you want the recall to go through
17:10 - the walls maybe not if you do then you
17:13 - would simply do the recall the same way
17:15 - that we did with the player make it
17:16 - kinematic and modify the transfer on
17:18 - that position directly but in this case
17:20 - I like this behavior it feels good if
17:22 - it's a way I need to make sure that you
17:24 - can reach me okay great so now let's add
17:26 - our enemies again and try to take them
17:28 - out with a shield so here is the enemy
17:31 - prefab that we're using as you can see
17:33 - they already have a box Collider with is
17:35 - trigger enabled so we can use that
17:38 - trigger in order to trigger collisions
17:40 - and damage the enemy so let's go into
17:42 - the shield code and here we add a
17:45 - private void ontriggerenter 2d so this
17:49 - function is called whenever this shield
17:51 - is colliding with another Collider now
17:53 - in here on let's test if we are
17:55 - colliding with the enemy so we try to
17:57 - grab the enemy reference from the
17:59 - collider and if it is not now then we
18:07 - have hit an enemy so in here let's knock
18:11 - him out
18:18 - okay so this should be working in order
18:20 - to make sure our enemy dies when he gets
18:22 - hit with a shield
18:23 - let's test okay here we are and there's
18:26 - an enemy let's try to take him out and I
18:28 - throw the shield any of their ego the
18:30 - shield hits him and he gets knocked down
18:32 - and I can grab the shield again well
18:34 - it's right hitting on the wall so here
18:36 - on the wall throw bounced around yep
18:38 - there you the enemy done okay great
18:41 - so we can now through the shield the
18:43 - shield collides with the enemies and
18:44 - causes them damage which causes them to
18:46 - die so here we have a bunch of enemies I
18:48 - can punch them I can kick them I can
18:51 - throw the same there they go I can still
18:54 - take them out or the shield that won't
18:55 - recall punch this one punch this one get
18:58 - it and yep quick and you also dies on
19:00 - the recall if I throw recall any of
19:03 - there you go okay great now it would be
19:07 - quite awesome if we could make the
19:08 - shield hit several enemies at once so
19:10 - some sort of auto target let's do that
19:13 - so here in the shield when we hit an
19:15 - enemy let's look for enemies that are
19:17 - near down so for that one the enemy
19:19 - handler class has a function where I can
19:25 - get the closest enemy so the calls us to
19:27 - this position and within a certain range
19:37 - so if there is another enemy near this
19:40 - one let's modify the shield velocity in
19:42 - order to go towards down one so first we
19:45 - grab the magnitude of the current
19:46 - velocity so it keeps going at the same
19:48 - speed so it float throw spin which will
19:52 - be the current rigidbody2d dot velocity
19:55 - dot magnitude then let's complete the
19:59 - new direction and then we set the
20:05 - rigidbody 2d dot velocity to be the new
20:08 - throw direction multiplied by the same
20:11 - throw speed okay so let's see if we can
20:15 - hit several enemies we just want throw
20:17 - okay so here we have three enemies now
20:19 - if I throw my shield onto this one the
20:21 - shield should then automatically target
20:22 - one of the others so I see I throw any
20:25 - of their ego he went from now on down
20:26 - and then didn't have enough speed nor to
20:28 - reach the last one but yep exactly as
20:31 - soon as he goes he hits one and he tries
20:33 - to hit some more so here for example
20:35 - there behind the wall now I throw it any
20:38 - if they're going head-on three by doing
20:40 - a nice bounce of that won't hit the
20:42 - first one then automatically target the
20:44 - others okay so we have successfully made
20:46 - sure that our shield can hit multiple
20:48 - enemies at once however here we have
20:51 - another issue which is that the shield
20:53 - is currently acting kind of like a mine
20:54 - so if I throw this yelled in here and
20:56 - then I wait for the enemies to go
20:58 - through it as soon as they step on it
21:00 - they die that is not what we want so
21:03 - let's work on essentially we only want
21:06 - the shield to cause damage if it has a
21:08 - certain amount of speed if it's just
21:10 - standing there we don't want it to
21:11 - damage so in here on the on trigger
21:13 - enter function all we need is the task
21:15 - the magnitude of the current amasing so
21:20 - we grab the magnitude up here
21:26 - and if we do hit an enemy we're only
21:29 - going to run this if we are within a
21:30 - certain threshold so shield won't cause
21:40 - damage if it's going at a bigger spin
21:42 - than this if not then it's considered to
21:44 - be idle just standing around the map and
21:46 - it doesn't cause damage let's see here
21:49 - we are they're chasing me let's throw
21:50 - the shield in there and let's see if
21:53 - they step on it and what happens and
21:56 - they step on it and nothing happened
21:58 - because the shield is idle now I grab
22:00 - the shield now if I throw it if they go
22:02 - on three of them to damage since the
22:04 - shield was moving fast when you touch
22:05 - them so we have pretty much all of our
22:08 - shield logic working now let's build a
22:10 - nice simple map and randomly spawn our
22:12 - enemies okay so here we have a nice
22:20 - simple map with a bunch of walls
22:22 - let's test and here we are with our nice
22:25 - character moving him around I can punch
22:27 - the enemies and there you go I can throw
22:29 - the shield if you don't hit that one
22:30 - then it went that one I know there's
22:32 - another enemy and I can still roll out
22:34 - of the way so punch this one punches
22:36 - when wrong the right punch
22:37 - throw Rico throw again recall throw
22:40 - again and yep everything looks very nice
22:43 - everything is a nice system the logic
22:45 - for the shield is working perfectly fine
22:46 - throw multiple and it feels quite
22:49 - satisfying and the whole system is quite
22:51 - nice so as you can see here we have
22:58 - created a very nice simple mechanic that
23:01 - is quite satisfying to play with and as
23:03 - you saw at the illogic isn't very
23:05 - complicated we just throw the shield
23:07 - move it in certain directions recall it
23:09 - into a certain direction and we also
23:11 - have basic attacks basic movement and so
23:13 - on
23:16 - as long as he can download the project
23:18 - on Zinni tony's from unity code monkey
23:20 - calm if you liked the video subscribe to
23:22 - the channel for more ent tutorials post
23:24 - any questions you have in the comments
23:25 - and I'll do my best answer me alright
23:27 - see you next time
23:31 - [Music]
23:35 - you

Cleaned transcript:

in this video we're going to create Captain America and his shield in unity 2d let's begin hello and welcome I'm your code monkey and this channel is all about helping you learn how to make your own games with nf2 torrents made by a professional indie game developer so if you find the video helpful consider subscribing so this is our goal I'm currently controlling Captain America here I can kick and punch enemies to kill them and I can also do a nice dodge roll so I kill them do a dodge roll and obviously I can throw my shield I can throw it I can recall it and punch them dodge out of the way and throw it again as you can see the shield is somewhat smart and if I hit one enemy it automatically tries to target different enemies it also is using physics so I can throw it into the wall and it bounces off of it just like that and the whole thing looks very nice very satisfying and the code is very simple alright so let's get to it here we are in our starting scene so I'm controlling Captain America with some simple movement and there are enemies being spawned I can also do a dodge roll to dodge out of damage I've done videos on the character movement and dodge roll so check my links in the description to see how it works and all these enemies they move towards me and they try to attack me ok so this is the starting point now let's get to work on making the shield so here in the editor room let's first make the shield game object so an empty game object call this the shield add a sprite renderer need to drag the Shum sprite I have in here ok now let's add a circle Collider 2d make sure that it matches the size of the shield and a rigidbody 2d since we are in topdown we set the gravity scale to zero okay so this is the basic setup for our shield now let's make the code in order to throw it so here we are on the Captain America player code here is a bunch of code to handle the simple character in order to handle move dodge rolling and so on so we don't need to worry about any of this we just need to be able to test when we should throw our shield so we go here into our update and in here and let's just do a simple if to test for a right mouse button click so we do it input dot get mouse button down and we need an index for the right mouse button so in here the left one is on zero and the right one is on one okay so when we press on the right mouse button let's throw our shield so for that we need a reference so let's go up here make a civilized feel for a private transform for the shield transformer so here in the editor just drag the shield reference okay now back in here when we go on our rightclick lets first place the shield on top of the players so we take the shield transformed our position and we put it on this transform that position okay and then we want to use the rigidbody that force in order to throw it towards the mouse so first we go into the shield transform in order to get the component of type rigidbody 2d on the rigidbody we have our add force function and now in here we need a vector two for the direction that we're going to throw so we want it to be towards the mouse so for that I'm going to go into the utens class which is part of the code monkey Tonys that you can grab for free from unity code monkey comm so in that there's a very nice function in order to get the mouse world position so our vector three for the throw direction will be the mouse world position minus the current transform dot position so in here we need the force so the throw direction was we also need a float for the throw force let's s the number can we add it as impulse okay so that should do it and we should be able to now throw our shield whenever we press on the right mouse button let's see okay so here I am now if I right click and let's see the shield and if there you go it went towards new maps okay awesome so far so good now the shield is going to have some logic to it so let's make a simple class instead of heart everything on the player class so in here we make a new csharp script this will be our shield and let's drag it onto our game object so just drag it in there okay so here on the shield code and let's start off by making a function in order to throw it so we make a public boy throw shield and we receive a vector3 for our direction now in here we're going to do very much the same thing we were doing in our testing so let's go here and copy this so we modify our transform position then we use this as our throw direction and we use our transform getcomponent now in here this is meant to be the player position so let's go here define a serialize film for our Captain America reference now we set it in the editor just drag it on there okay so with that we can simply go in there and get the position and now back onto the Captain America class in here we need a reference for the shield so let's do that instead of having a reference to the French roll we have a reference to a shield now we drag this on the editor track the reference okay and now down here on the right mouse button we go to the shield and we call throw shield and now we need a direction so let's calculate that and that's pretty much it so let's s and we should be able to see the exact same thing that was happening previously so here we are and right click and if there goes this yield okay great now that we have the shield being thrown let's also add a nice little effect so we want to add a nice trail so for that we can simply add the trail renderer and here we just modify this okay so here's our trail runner we just keep it visible for half a second it starts off very big and then it becomes very small and starts off only white and becomes transparent so let's see it in action so here we are and when I throw the shield yep there you go a nice trail follows it okay awesome now that we have our trail looking very nice let's make our shield Rico so we can throw this young and then get it back so here on the shell script let's make a recount function so a totally quiet recon and now in order to recon we need to move the xian towards the player so to do that we're going to set the velocity pointing towards a player on update however we need to know when we should do that we don't want the Recon code to run while the shield is being thrown so let's go up here to define a new for all of our various states so in privately known for the state and the various states this can be used with player so when the shield is on top of the player throne which is when the shin has been thrown and finally recalling now let's use these states so when we call throw shield let's put the state so we go up here to define a variable for a private state state and here we set these states to be staked out wrong okay and when we recall we started to state that recall now let's do a prayer void fixedupdate since we're dealing with our physics do a switch on the current state case we are on state dog recalling then we want to set the shell velocity towards the player so let's also go up here make a front boy to wake in order to grab our reference to the rigidbody so a private rigidbody 2d and we grab it in here and here on the throw shield we use this instead of always grabbing the reference okay and here we set the velocity and now we need direction for the player so a vector three for the clear to player we also need a smooth for the you recall speed and finally we need to test when we are close enough to the player so we do a if vector 3 dot distance compliment the distance between this transform dog position and Captain America Valiquette position if that distance is under the grab distance up here a float for the grabbed distance if we are within grab distance then we grab our film so we set the state to be state dot with player when we do we also set the velocity back in to zero so it stops moving and we set the original to Kin ematic so it doesn't collide with anything so rigid body ok so this is our code for recalling our script and then let's also do a friend void late update so this runs out there every update so we do a switch on our state in case we are on the state with the player then we want to shyam to be on top of the point so we move the transform position specifically we're going to put the shield on top of the body sprite so in here we go into the Captain America and we get the body position all right so this should be working just one last thing is when we do through our shield we need to set is kinematic back into Thomas so the body becomes dynamic ok so on the player we call through shield it throws the shield from Captain America towards this direction then on the player we can also call recon when we do we set the state to be recalling then on the fixed update if we are recalling then we complete the direction towards the player we moved the rigidbody towards it and when he's within grab distance then we simply grab it and keep following the player now let's see how we're going to come recon from the player so here we are on Captain America's class and we have our right mouse button in order to throw our shield however instead of always drawing let's use the same button to work for both throwing and recon so in order to do that we need to ask the shield if it's with a player or it has been thrown so here on the shield let's add a public ball is with player as in will return if the state equals state that with player and also appear on our awake let's set our scoring state we start off recalling solution automatically goes to the player okay and back in this class so here first we asked if the she on that is with player if it is with the player that means it can be thrown so we throw the shield and if not we go into the shield and we call recon all right that should do it so let's test and see if we can recall the shield okay so here I am controlling Captain American as you can see the shield is indeed on his back now here we have an issue with regards to the trainer it shouldn't be active while stationed this flying so we will sort that later but for now let's try to throw the shield so here I am I press on the right mouse button and there you go there goes the shield notice you on the stop now I press again and yep the shield is being recon so I can throw it and I can recall it and it's constantly phone ok awesome another issue that we can also see is with these sprites we want the shield to look like it's always on its back so in here right now it's correct it's on its back however if I go up it's still behind sprite so we need to modify the sorting order depending on whether the character is facing down or up so let's on that first the trail renderer so we go up here and we grab a reference to our private trainer renderer here when the player grabs it we set the trail render not enabled into phones and when we throw it we set it to true okay so that should do it for the trail runner now for the sprite sorting order let's go into our lake update and here on the whit player well let's modify the sorting order so first we ask the Captain America class if it is facing down so if Captain America dot is sprite facing down if the sprite is facing down then we want this bright to be behind it so we need a reference to the sprite renderer and here we set the sorting order to be on the Captain America that gets sorting order in this case we want to be behind so minus ten and if not we want to be in front so what Stan okay son let's see if the shield is always on its back and if the trail render is disabled once he's with the player so here we are in first move and yep there's no trail render and now I found facing upwards if there you go there's the shield one is back and facing down and yep it's on its back okay great now one issue we do have right now is with regards to the recon so if I throw the shield there you go see shield is in there and if I go right on top of it as you can see he does not grab shield I still need to press the recon in order for him to come back let's make the grab automatic if Captain America is close enough to the shield so for that let's go here test case state throne so if the she own has been thrown let's do a Sencha the same tests that we're doing here on our recon where we test the grab distance in order to ground so in order to not have duplicated code and let's put this in another function so here a prep boy try grab shield and we're just going to copy this code and we call this function so again here we define a graph distance we test the distance between this transform and Captain America's position if we are within the graph distance then we simply ground so we run it on recon and also when the player has thrown the shield now another issue we might have with this is that maybe he grabs it the second that he throws it so when we throw we can simply push it further away than the graph distance so in here before we do this we put position on the get position well as the throw Direction multiplied by a grab distance so let's define the grab distance up here so a private consult for the grab distance and here we use that one instead and here we use that one as well so this will make sure that on the same frame that we throw this young but we don't grab it okay that should do it let's see okay so here we are now let's throw the shield there he goes now I go near it and if there yogi grab the shield now I can throw it again and if I want recon and if I don't I can just go to it and grab it manually and throw it again okay awesome now since we are using physics to move our he own that means we can easily add some walls to bounce around so here in the editor and let's make some walls over here I have one as you can see it's just a simple sprite renderer with a box Collider so let's put it here and try throwing the shield directly onto the wall okay so here we are with one let's throw the shield onto it and see if it goes there and bounces away and throw and yep it didn't work the shield went towards the wall and then slid alongside it so that means we need to make our shield bouncing so for that we go in here we create a new physics material 2d let's call it bouncy and in here you can check the friction and bounciness so we set the friction to zero and botanist to one and we just drag it as a physical material on the original for our heel just like that okay let's see here we are let's throw and if there you go I can throw the shoe and it bounces back okay so just like that we can also do some really complex throw okay great and the Recon was also using physics so if I go into the other side of this wall and I try to recall as you can see the shield can't quite make it this is very much a design choice maybe you want the recall to go through the walls maybe not if you do then you would simply do the recall the same way that we did with the player make it kinematic and modify the transfer on that position directly but in this case I like this behavior it feels good if it's a way I need to make sure that you can reach me okay great so now let's add our enemies again and try to take them out with a shield so here is the enemy prefab that we're using as you can see they already have a box Collider with is trigger enabled so we can use that trigger in order to trigger collisions and damage the enemy so let's go into the shield code and here we add a private void ontriggerenter 2d so this function is called whenever this shield is colliding with another Collider now in here on let's test if we are colliding with the enemy so we try to grab the enemy reference from the collider and if it is not now then we have hit an enemy so in here let's knock him out okay so this should be working in order to make sure our enemy dies when he gets hit with a shield let's test okay here we are and there's an enemy let's try to take him out and I throw the shield any of their ego the shield hits him and he gets knocked down and I can grab the shield again well it's right hitting on the wall so here on the wall throw bounced around yep there you the enemy done okay great so we can now through the shield the shield collides with the enemies and causes them damage which causes them to die so here we have a bunch of enemies I can punch them I can kick them I can throw the same there they go I can still take them out or the shield that won't recall punch this one punch this one get it and yep quick and you also dies on the recall if I throw recall any of there you go okay great now it would be quite awesome if we could make the shield hit several enemies at once so some sort of auto target let's do that so here in the shield when we hit an enemy let's look for enemies that are near down so for that one the enemy handler class has a function where I can get the closest enemy so the calls us to this position and within a certain range so if there is another enemy near this one let's modify the shield velocity in order to go towards down one so first we grab the magnitude of the current velocity so it keeps going at the same speed so it float throw spin which will be the current rigidbody2d dot velocity dot magnitude then let's complete the new direction and then we set the rigidbody 2d dot velocity to be the new throw direction multiplied by the same throw speed okay so let's see if we can hit several enemies we just want throw okay so here we have three enemies now if I throw my shield onto this one the shield should then automatically target one of the others so I see I throw any of their ego he went from now on down and then didn't have enough speed nor to reach the last one but yep exactly as soon as he goes he hits one and he tries to hit some more so here for example there behind the wall now I throw it any if they're going headon three by doing a nice bounce of that won't hit the first one then automatically target the others okay so we have successfully made sure that our shield can hit multiple enemies at once however here we have another issue which is that the shield is currently acting kind of like a mine so if I throw this yelled in here and then I wait for the enemies to go through it as soon as they step on it they die that is not what we want so let's work on essentially we only want the shield to cause damage if it has a certain amount of speed if it's just standing there we don't want it to damage so in here on the on trigger enter function all we need is the task the magnitude of the current amasing so we grab the magnitude up here and if we do hit an enemy we're only going to run this if we are within a certain threshold so shield won't cause damage if it's going at a bigger spin than this if not then it's considered to be idle just standing around the map and it doesn't cause damage let's see here we are they're chasing me let's throw the shield in there and let's see if they step on it and what happens and they step on it and nothing happened because the shield is idle now I grab the shield now if I throw it if they go on three of them to damage since the shield was moving fast when you touch them so we have pretty much all of our shield logic working now let's build a nice simple map and randomly spawn our enemies okay so here we have a nice simple map with a bunch of walls let's test and here we are with our nice character moving him around I can punch the enemies and there you go I can throw the shield if you don't hit that one then it went that one I know there's another enemy and I can still roll out of the way so punch this one punches when wrong the right punch throw Rico throw again recall throw again and yep everything looks very nice everything is a nice system the logic for the shield is working perfectly fine throw multiple and it feels quite satisfying and the whole system is quite nice so as you can see here we have created a very nice simple mechanic that is quite satisfying to play with and as you saw at the illogic isn't very complicated we just throw the shield move it in certain directions recall it into a certain direction and we also have basic attacks basic movement and so on as long as he can download the project on Zinni tony's from unity code monkey calm if you liked the video subscribe to the channel for more ent tutorials post any questions you have in the comments and I'll do my best answer me alright see you next time you
